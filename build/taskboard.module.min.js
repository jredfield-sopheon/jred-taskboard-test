/*!
 *
 * Bryntum TaskBoard 5.6.2
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
var Mm=Object.defineProperty,Rm=(i,e,t)=>e in i?Mm(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,y=(i,e,t)=>(Rm(i,typeof e!="symbol"?e+"":e,t),t),Ku=(i,e,t)=>{if(!e.has(i))throw TypeError("Cannot "+t)},_m=(i,e,t)=>(Ku(i,e,"read from private field"),t?t.call(i):e.get(i)),Om=(i,e,t)=>{if(e.has(i))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(i):e.set(i,t)},Gu=(i,e,t,r)=>(Ku(i,e,"write to private field"),r?r.call(i,t):e.set(i,t),t),Xu,U=class{static cacheFlags(i=navigator.platform,e=navigator.userAgent){const t=this;t._isLinux=!!i.match(/Linux/),t._isMac=!!i.match(/Mac/),t._isWindows=!!i.match(/Win32/),t._isMobile=!!(e.match(/Mobile|Opera Mini|Opera Mobi|Puffin/)||typeof globalThis.orientation=="number"),t._isWebkit=!!(e.match(/WebKit/)&&!e.match(/Edg/)),t._firefoxVersion=t.getVersion(e,/Firefox\/(\d+)\./),t._isFirefox=t._firefoxVersion>0,t._chromeVersion=t.getVersion(e,/Chrom(?:e|ium)\/(\d+)\./),t._isChrome=t._chromeVersion>0,t._isSafari=!!e.match(/Safari/)&&!t._isChrome,t._isMobileSafari=!!e.match(/Mobile.*Safari/),t._safariVersion=t.getVersion(e,/Version\/(.*).Safari/),t._isAndroid=!!e.match(/Android/g)}static get supportsOverflowClip(){if(this._supportsOverflowClip==null){const i=document.createElement("div");i.style.overflow="clip",i.style.display="none",document.documentElement.appendChild(i),this._supportsOverflowClip=i.ownerDocument.defaultView.getComputedStyle(i).getPropertyValue("overflow")==="clip",i.remove()}return this._supportsOverflowClip}static get supportsSticky(){return!0}static getVersion(i,e){const t=i.match(e);return t?parseFloat(t[1]):0}static get isTouchDevice(){return this._isTouchDevice===void 0&&(this._isTouchDevice=globalThis.matchMedia("(pointer:coarse)").matches),this._isTouchDevice}static get isHoverableDevice(){return this._isHoverableDevice===void 0&&(this._isHoverableDevice=globalThis.matchMedia("(any-hover: hover)").matches),this._isHoverableDevice}static get isBrowserEnv(){return typeof window!="undefined"}static get isMac(){return this._isMac}static get isWindows(){return this._isWindows}static get isLinux(){return this._isLinux}static get isAndroid(){return this._isAndroid}static get isWebkit(){return this._isWebkit}static get isChrome(){return this._isChrome}static get chromeVersion(){return this._chromeVersion}static get isFirefox(){return this._isFirefox}static get firefoxVersion(){return this._firefoxVersion}static get isSafari(){return this._isSafari}static get safariVersion(){return this._safariVersion}static get isMobileSafari(){return this._isMobileSafari}static get isMobile(){return this._isMobile}static get platform(){const i=this;return i._isLinux?"linux":i._isMac?"mac":i._isWindows?"windows":i._isAndroid?"android":i._isMobileSafari?"ios":null}static get supportsPassive(){return!0}static get supportsRandomUUID(){if(this._supportsRandomUUID===void 0)try{this._supportsRandomUUID=globalThis.crypto.randomUUID().length>0}catch(i){this._supportsRandomUUID=!1}return this._supportsRandomUUID}static get storageAvailable(){let i,e;try{return i=localStorage,e="__storage_test__",i.setItem(e,e),i.removeItem(e),!0}catch(t){return t instanceof DOMException&&(t.code===22||t.code===1014||t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&i.length!==0}}static setLocalStorageItem(i,e){this.storageAvailable&&localStorage.setItem(i,e)}static getLocalStorageItem(i){return this.storageAvailable&&localStorage.getItem(i)}static removeLocalStorageItem(i){this.storageAvailable&&localStorage.removeItem(i)}static searchParam(i,e=null,t=document.location.search){const r=new RegExp(`[?&]${i}=?([^&]*)`),n=t.match(r);return n&&n[1]||e}static getCookie(i){const e=encodeURIComponent(i)+"=",t=document.cookie.split(";");for(let r=0;r<t.length;r++){let n=t[r];for(;n.charAt(0)===" ";)n=n.substring(1,n.length);if(n.indexOf(e)===0)return decodeURIComponent(n.substring(e.length,n.length))}return""}static download(i,e){const t=document.createElement("a");t.download=i,t.href=e||i,t.style.cssText="display:none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}static downloadBlob(i,e){const t=globalThis.URL.createObjectURL(i);this.download(e,t),globalThis.URL.revokeObjectURL(t)}static get queryString(){var i;const e=new URL(globalThis.location.href).searchParams;return(i=Object.fromEntries)==null?void 0:i.call(Object,e.entries())}static copyToClipboard(i){let e=!0;const t=document.createElement("textarea");t.value=i,t.style.height=t.style.width=0,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(r){e=!1}return t.remove(),e}static isBryntumOnline(i){return i=Array.isArray(i)?i:[i],!!(/^(www\.)?bryntum\.com/.test(globalThis.location.host)||i!=null&&i.some(e=>this.queryString[e]!=null))}static get isCSP(){const{bryntum:i,document:e}=globalThis;return i.CSP==null&&(i.CSP=!!e.querySelector('meta[http-equiv="Content-Security-Policy"]')),i.CSP}};y(U,"supportsPointerEvents",!!(globalThis.PointerEvent||globalThis.MSPointerEvent)),y(U,"supportsPointerEventConstructor",typeof PointerEvent!="undefined"),y(U,"PointerEventConstructor",globalThis.PointerEvent||globalThis.CustomEvent),y(U,"isPhone",(Xu=globalThis.matchMedia)==null?void 0:Xu.call(globalThis,"(max-height:414px) or (max-width:414px)").matches),U.isBrowserEnv&&U.cacheFlags(),U._$name="BrowserHelper";var Zu,Ju,Qu,ec,tc=/([a-z])([A-Z])/g,Am=/[\n\r]/g,Pm=/[.*+?^${}()|[\]\\]/g,Fm=/[&<]/,Lm=/(^[^a-z]+[^\w]+)/gi,$m=/\s+/,Nm=/^[^a-z]+|[^\w:.-]+/gi,Bm=(i,e)=>Ju[e.toLowerCase()]||String.fromCharCode(parseInt(e.substr(2),10)),Vm=(i,e)=>Zu[e],jm=(i,e,t)=>`${e}-${t.toLowerCase()}`,zm=(i,e,t)=>`${e} ${t.toLowerCase()}`,Wm=i=>i?`_x${[...i].map(e=>e.charCodeAt(0).toString(16)).join("")}`:"__blank__",rc={},ic={},vr=[],Hm=function(i,e){if(e&&typeof e=="object"){for(;vr.length&&vr[vr.length-1]!==this;)vr.pop();if(vr.includes(e))return"[Circular]";vr.push(e)}return e},nc=class mr{static capitalize(e){return e&&e[0].toUpperCase()+e.substr(1)}static uncapitalize(e){return e&&e[0].toLowerCase()+e.substr(1)}static hyphenate(e){const t=rc[e];return t||(rc[e]=e.replace(tc,jm))}static separate(e){const t=ic[e];return t||(ic[e]=this.capitalize(e.replace(tc,zm)))}static createId(e){return String(e).replace(Lm,Wm)}static makeValidDomId(e,t=""){return e==null?null:String(e).replace(Nm,t)}static escapeRegExp(e,t){let r=e.replace(Pm,"\\$&");return t!==void 0&&(r=new RegExp(r,t)),r}static decodeHtml(e){return e&&String(e).replace(ec,Bm)}static encodeHtml(e=""){return e&&String(e).replace(Qu,Vm)}static encodeHtmlBR(e){var t;return(t=mr.encodeHtml(e))==null?void 0:t.replace(Am,"<br>")}static isHtml(e){return typeof e=="string"&&Fm.test(e||"")}static initHtmlEntities(e){e=e||{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};const t=Object.keys(e);Zu=e,Ju=t.reduce((r,n)=>(r[e[n]]=n,r),{}),Qu=new RegExp(`([${t.map(r=>"[-]".includes(r)?"\\"+r:r).join("")}])`,"g"),ec=new RegExp(`(${Object.values(e).join("|")}|&#[0-9]+;)`,"ig")}static safeJsonParse(e){let t=null;try{t=JSON.parse(e)}catch(r){}return t}static safeJsonStringify(e,t=null,r=null){let n=null;try{t==="circular"&&(vr.length=0,t=Hm),n=JSON.stringify(e,t,r)}catch(s){}return n}static joinPaths(e,t="/"){return e.join(t).replace(new RegExp("\\"+t+"+","g"),t)}static split(e,t=$m){let r=e;return typeof r=="string"&&(r=e.trim(),r=r?r.split(t):[]),r}static xss(e,...t){const r=[];let n=t.length;for(r[n]=e[n];n-- >0;)r[n]=e[n]+mr.encodeHtml(t[n]);return r.join("")}static xssBR(e,...t){const r=[];let n=t.length;for(r[n]=e[n];n-- >0;)r[n]=e[n]+mr.encodeHtmlBR(t[n]);return r.join("")}static toJavaScriptValue(e,t){const r=H.typeOf(e);if(r==="boolean"||r==="string"||r==="number"||e===null)return mr.safeJsonStringify(e);if(e===globalThis)return"window";if(r==="date")return`new Date(${e.getFullYear()}, ${e.getMonth()}, ${e.getDate()}, ${e.getHours()}, ${e.getMinutes()}, ${e.getSeconds()}, ${e.getMilliseconds()})`;if(r==="array")return`[${e.map(n=>mr.toJavaScriptValue(n,t))}]`;if(r==="object"||r==="instance")return this.toJavaScriptString(e,t);if(r==="function"){let n=e.toString();return n.match(/^async (\w+?)\(/)?n=n.replace(/^async (\w+?)\(/,"async function("):!n.startsWith("async(")&&n.match(/^(\w+?)\(/)&&(n=n.replace(/^(\w+?)\(/,"function(")),n}if(r==="class")return e.toJavaScriptValue?e.toJavaScriptValue(t):Object.prototype.hasOwnProperty.call(e,"$name")?e.$name:e.name}static toJavaScriptString(e,t={}){var r;const n=(r=t.level)!=null?r:0,s=2;return`{
`+Object.keys(e).map(a=>" ".repeat((n+1)*s)+(a.match(/[- *]/)?`"${a}"`:a)+`: ${mr.toJavaScriptValue(e[a],{...t,level:n+1})}`).join(`,
`)+`
`+" ".repeat(n*s)+"}"}static encodeAttributeSelector(e,t){return`[${e}="${String(t).replace(/["\\]/g,"\\$&")}"]`}static generateUUID(){var e;return U.supportsRandomUUID?globalThis.crypto.randomUUID():(e=globalThis.crypto)!=null&&e.getRandomValues?("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,t=>(t^globalThis.crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)):`${Date.now()}-${++mr.fakeNodeUUIDIndex}`}};y(nc,"fakeNodeUUIDIndex",0);var P=nc;P.initHtmlEntities(),P._$name="StringHelper";var{hasOwnProperty:Ym,toString:Um}=Object.prototype,{isFrozen:sc}=Object,qm=/\s*<\s*/,Km=/\s*>\s*/,ac={},lc={},oc=Object.freeze({}),H=class Le{static assign(e,...t){for(let r,n,s=0;s<t.length;s++)if(r=t[s],r)for(n in r)e[n]=r[n];return e}static assignIf(e,...t){for(let r,n,s=0;s<t.length;s++)if(r=t[s],r)for(n in r)(!(n in e)||e[n]===void 0)&&(e[n]=r[n]);return e}static blend(e,t,r){r=r||ac,e=e||{};const{clone:n=Le.clone,merge:s=Le.blend}=r;if(Array.isArray(t)){if(t.length>1)return t.forEach(a=>{e=Le.blend(e,a,r)}),e;t=t[0]}if(t){let a,l,o;for(l in t)o=t[l],o&&Le.isObject(o)&&(a=e[l],r.key=l,a&&Le.isObject(a)?(sc(a)&&(e[l]=a=n(a,r)),o=s(a,o,r)):o=sc(o)?o:n(o,r)),e[l]=o}return e}static clone(e,t){let r=e,n;if(e&&typeof e=="object")if(t&&typeof t=="object"&&t&&(t=null),Le.isObject(e))if(e.skipClone)r=e;else{r={};for(n in e)r[n]=Le.clone(e[n])}else if(Array.isArray(e))for(r=[],n=e.length;n-- >0;)r[n]=Le.clone(e[n]);else Le.isDate(e)?r=new Date(e.getTime()):t&&(r=t(e));return r}static createTruthyKeys(e){const t=P.split(e),r=t&&{};if(t)for(const n of t)n&&(r[n]=!0);return r}static getPath(e,t){return t.split(".").reduce((r,n)=>(r||oc)[n],e)}static getPathDefault(e,t,r){const n=Array.isArray(t)?t:typeof t=="string"?t.split("."):[t],s=n.length-1;return n.reduce((a,l,o)=>(r&&!(l in a)&&(a[l]=o===s?r:{}),(a||oc)[l]),e)}static hasPath(e,t){return t.split(".").every(r=>e&&r in e?(e=e[r],!0):!1)}static getTruthyKeys(e){const t=[];for(const r in e)e[r]&&t.push(r);return t}static getTruthyValues(e){const t=[];for(const r in e)e[r]&&t.push(e[r]);return t}static isClass(e){var t;return typeof e=="function"&&((t=e.prototype)==null?void 0:t.constructor)===e}static isDate(e){return!!(e!=null&&e.getUTCDate)&&Le.typeOf(e)==="date"}static isPromise(e){if(Promise&&Promise.resolve)return Promise.resolve(e)===e||typeof(e==null?void 0:e.then)=="function";throw new Error("Promise not supported in your environment")}static isEmpty(e){if(e&&typeof e=="object")for(const t in e)return!1;return!0}static isObject(e){const t=e==null?void 0:e.constructor;return!!(t?t===Object||t.getPrototypeOf&&t.prototype&&!Object.getPrototypeOf(t.prototype):e&&typeof e=="object")}static isInstantiated(e){return e?typeof e=="object"&&!Le.isObject(e):!1}static merge(e,...t){return Le.blend(e,t)}static mergeItems(e,t,r){r=r||ac;let n,s,a,l,o,u,c;const{merge:d=Le.blend}=r;if(e=e||{},Array.isArray(t))t.forEach(h=>{e=Le.mergeItems(e,h,r)});else if(t)for(o in t)if(c=t[o],n=null,o.includes(">")?([o,n]=o.split(Km),s=0):o.includes("<")&&([n,o]=o.split(qm),s=1),o in e)c&&e[o]&&d&&(r.key=o,c=d(e[o],c,r)),e[o]=c;else if(!n)e[o]=c,l==null||l.set(o,l.size);else{if(!l){l=new Map,a=0;for(const h in e)l.set(h,a++)}if(a=l.get(n),e[o]=c,a==null&&s)a=l.size;else{u=u||[],a=(a||0)+s;for(const h of l){const[g,f]=h;a<=f&&(u&&(u[l.size-f-1]=g),l.set(g,f+1))}if(u)for(;u.length;){const h=u.pop(),g=e[h];delete e[h],e[h]=g}}l.set(o,a)}return e}static setPath(e,t,r){return t.split(".").reduce((n,s,a,l)=>a===l.length-1?n[s]=r:(n[s]instanceof Object||(n[s]={}),n[s]),e),e}static typeOf(e){let t,r;return e===null?r="null":e!==e?r="nan":(r=typeof e,r==="object"?e.isBase?r="instance":Array.isArray(e)?r="array":(r=lc[t=Um.call(e)])||(lc[t]=r=t.slice(8,-1).toLowerCase()):r==="function"&&e.isBase&&(r="class")),r}};Object.defineProperty(H,"hasOwn",{value:Object.hasOwn||((i,e)=>Ym.call(i,e))}),H._$name="Objects";var ie=class sl{static setVersion(e,t){e=e.toLowerCase(),qe[e]={version:t,isNewerThan(s){return sl.semanticCompareVersion(s,t,"<")},isOlderThan(s){return sl.semanticCompareVersion(s,t,">")}};let r="";typeof productName!="undefined"&&(r=productName);const n=`${r}.${e}${t.replace(/\./g,"-")}`;if(U.isBrowserEnv&&!globalThis.bryntum.silenceBundleException)if(globalThis.bryntum[n]===!0)if(this.isTestEnv)globalThis.BUNDLE_EXCEPTION=!0;else{let s=r||e;s==="core"&&(s="grid");let a=P.capitalize(s);throw s==="schedulerpro"&&(a="SchedulerPro"),new Error(`The Bryntum ${a} bundle was loaded multiple times by the application.

Common reasons you are getting this error includes:

* Imports point to different types of the bundle (e.g. *.module.js and *.umd.js)
* Imports point to both sources and bundle
* Imports do not use the shortest relative path, JS treats them as different files
* Cache busters differ between imports, JS treats ${s}.module.js?1 and ${s}.module.js?2 as different files
* Imports missing file type, verify they all end in .js

See https://bryntum.com/products/${s}/docs/guide/${a}/gettingstarted/es6bundle#troubleshooting for more information

`)}else globalThis.bryntum[n]=!0}static getVersion(e){if(e=e.toLowerCase(),!qe[e])throw new Error("No version specified! Please check that you import VersionHelper correctly into the class from where you call `deprecate` function.");return qe[e].version}static semanticCompareVersion(e,t,r="="){e=e||"",t=t||"";const n=e.split(/[-.]/),s=t.split(/[-.]/),a=r.includes("<"),l=(u,c)=>{const d=["rc","beta","alpha"],h=u.map(g=>{if(d.includes(g))return-d.indexOf(g)-2;const f=Number.parseInt(g);return Number.isNaN(f)?-d.length:f});for(;h.length<c;)h.push(-1);return h},o=()=>{const u=Math.max(n.length,s.length),c=l(n,u),d=l(s,u);for(let h=0;h<u;h++)if(c[h]!==d[h])return a?c[h]<d[h]:c[h]>d[h];return!0};switch(r){case"=":return e===t;case"<=":case">=":return e===t||o();case"<":case">":return e!==t&&o()}return!1}static checkVersion(e,t,r){return sl.semanticCompareVersion(qe.getVersion(e),t,r)}static deprecate(e,t,r){if(qe.checkVersion(e,t,"<"))console.warn(`Deprecation warning: You are using a deprecated API which will change in v${t}. ${r}`);else throw new Error(`Deprecated API use. ${r}`)}static get isTestEnv(){var e,t,r;const n=!!((e=globalThis.bryntum)!=null&&e.isTestEnv);try{return n||!!((r=(t=globalThis.parent)==null?void 0:t.bryntum)!=null&&r.isTestEnv)}catch(s){return n}}static get isDebug(){return!1}},qe=ie;U.isBrowserEnv&&(qe.isTestEnv&&(U._isHoverableDevice=!0),globalThis.bryntum=Object.assign(globalThis.bryntum||{},{getVersion:qe.getVersion.bind(qe),checkVersion:qe.checkVersion.bind(qe),deprecate:qe.deprecate.bind(qe),license:"%LICENSE%"})),ie._$name="VersionHelper";var{defineProperty:zs,getOwnPropertyDescriptor:uc}=Reflect,{hasOwnProperty:cc,toString:hl}=Object.prototype,fl=Symbol("instanceProperties"),dc=Symbol("configuring"),ri=Symbol("lazyConfigValues"),hc=hl.call(new Date),Gm=/\s+/,Xm=(i,e)=>(i[e]=1,i),me=class pn{static get(e,t){const{cache:r}=this,n=r[e]||(r[e]=new pn(e));let s=n,a;return t&&(a=pn.makeCacheKey(e,t),(s=a&&r[a])||(s=n.extend(t),a&&(r[a]=s))),s}constructor(e){const t=this,r=e[0].toUpperCase()+e.substr(1);t.base=t,t.name=e,t.field="_"+e,t.capName=r,t.changer="change"+r,t.initializing="initializing"+r,t.updater="update"+r}get descriptor(){let e=this._descriptor;return(!e||!cc.call(this,"_descriptor"))&&(this._descriptor=e=this.makeDescriptor()),e}get initDescriptor(){let e=this._initDescriptor;return(!e||!cc.call(this,"_initDescriptor"))&&(this._initDescriptor=e=this.makeInitter()),e}equal(e,t){return e===t}extend(e){const t=Object.assign(Object.create(this),e),{equal:r,merge:n}=e,{equalityMethods:s}=pn;return typeof r=="string"&&(r.endsWith("[]")?t.equal=pn.makeArrayEquals(s[r.substr(0,r.length-2)]):t.equal=s[r]),typeof n=="string"&&(t.merge=pn.mergeMethods[n]),t}define(e){const t=uc(e,this.name);let r=this.descriptor;t&&t.get&&(r=Object.assign({},r),r.get=t.get),zs(e,this.name,r)}defineInitter(e,t){const{name:r}=this,n=e[fl];let s,a;!n[r]&&(a=uc(e,r))&&!("value"in a)&&(n[r]=a),zs(e,r,this.initDescriptor),this.lazy&&(s=e[ri]||(e[ri]=new Map),s.set(r,t))}static makeArrayEquals(e){return(t,r)=>{let n,s=t&&r&&t.length===(n=r.length);if(s&&Array.isArray(t)&&Array.isArray(r))if(e)for(;s&&n-- >0;)s=e(t[n],r[n]);else for(;s&&n-- >0;)s=t[n]===r[n];else s=e?e(t,r):t===r;return s}}static makeCacheKey(e,t){const r=Object.keys(t).sort();for(let n,s,a,l=r.length;l-- >0;)if(a=t[n=r[l]],a==null&&a===!1)r.splice(l,1);else{if(s=typeof a,s==="function")return null;s==="string"?r[l]=`${n}:"${a}"`:s==="number"&&(r[l]=`${n}:${a}`)}return r.length?`${e}>${r.join("|")}`:e}makeDescriptor(){const e=this,{base:t,field:r,changer:n,updater:s,name:a}=e;return t!==e&&t.equal===e.equal?t.descriptor:{get(){var l;return(l=this.configObserver)==null||l.get(a,this),this[r]},set(l){var o,u;const c=this;let d=c[r],h,g;if(typeof l=="string"){let f=l;l.startsWith("up.")?f=(o=c.owner)==null?void 0:o.resolveProperty(l.substr(3)):l.startsWith("this.")&&(f=c.resolveProperty(l.substr(5))),f!==void 0&&typeof f!="function"&&(l=f)}c[n]&&(h=(g=c[n](l,d))===void 0,h||(l=g,d=c[r])),!h&&!(e.equal===fc?d===l:e.equal(d,l))&&(c[r]=l,h=!0,(u=c[s])==null||u.call(c,l,d)),h&&!c.isDestroyed&&!c.onConfigChange.$nullFn&&c.onConfigChange({name:a,value:l,was:d,config:e})}}}makeInitter(){const e=this;return e!==e.base?e.lazy?e.makeLazyInitter():e.base.initDescriptor:e.makeBasicInitter()}makeBasicInitter(){const e=this,{initializing:t,name:r}=e;return{configurable:!0,get(){const n=this;return e.removeInitter(n),n[t]=!0,n[r]=n[dc][r],n[t]=!1,n.configDone[r]=!0,n[r]},set(n){e.removeInitter(this),this.configDone[r]=!0,this[r]=n}}}makeLazyInitter(){const e=this,{initializing:t,name:r}=e;return{configurable:!0,get(){const n=this,s=n[ri].get(r);return e.removeInitter(n),n.isDestroying||(n[t]=!0,n[r]=s,n[t]=!1),n[r]},set(n){e.removeInitter(this),this[r]=n}}}removeInitter(e){const{name:t}=this,r=e[fl][t],n=e[ri];r?zs(e,t,r):delete e[t],n!=null&&n.delete(t)&&!n.size&&delete e[ri]}setDefault(e,t){zs(e.prototype,this.field,{configurable:!0,writable:!0,value:t})}merge(e,t){if(t&&e&&H.isObject(e)){if(t.isBase)return t.setConfig(e);H.isObject(t)&&(e=H.merge(H.clone(t),e))}return e}},{prototype:yn}=me,{equal:fc}=yn;me.symbols={configuring:dc,instanceProperties:fl,lazyConfigs:ri},me.cache=Object.create(null),me.equalityMethods={array:me.makeArrayEquals(),date(i,e){return i===e?!0:i&&e&&hl.call(i)===hc&&hl.call(e)===hc?i.getTime()===e.getTime():!1},strict:me.equal=fc},me.mergeMethods={distinct(i,e){let t=e?e.slice():[];if(i!=null)if(H.isObject(i))if(e===void 0)t=i;else{let r,n;for(r in i)n=t.indexOf(r),i[r]?n<0&&t.push(r):n>-1&&t.splice(n,1)}else Array.isArray(i)?i.forEach(r=>!t.includes(r)&&t.push(r)):t.includes(i)||t.push(i);return t},merge:me.merge=yn.merge,classList(i,e){if(typeof i=="string"){if(!i.length)return e;i=i.split(Gm)}return Array.isArray(i)&&(i=i.reduce(Xm,{})),me.merge(i,e)},objects(i,e){return i===!0?e||{}:me.merge(i,e)},replace(i){return i},items(i,e,t,r){return r?H.mergeItems(e,i,{merge:(n,s)=>yn.merge(s,n)}):yn.merge(i,e)}},Object.assign(yn,{_descriptor:null,_initDescriptor:null,lazy:!1,nullify:!1,render:!1}),me._$name="Config";var Zm=class{constructor(i){i&&Object.assign(this,i)}getInherited(i,e=!0){var t;let r=this[i];return i in this||(r=(t=this.super)==null?void 0:t.getInherited(i,e),(r||e)&&(this[i]=r=Object.create(r||null))),r}},{getPrototypeOf:gc}=Object,{hasOwn:lt}=H,{defineProperty:mc}=Reflect,Ws=Symbol("classMetaData"),pc=Symbol("mixinTag"),gl=Symbol("originalConfig"),l0=Symbol("createdAt"),wt=me.symbols.configuring,Jm=me.symbols.instanceProperties,ii=me.symbols.lazyConfigs,Qm={merge:"replace",simple:!0},Hs=()=>{},vc=i=>new Zm(i),yc={},ep=Object.freeze({}),bc=Object.freeze([]),F=class pr{static get isBase(){return!0}get isBase(){return!0}static get declarable(){return["declarable","configurable","defaultConfig","properties","prototypeProperties"]}constructor(...e){const t=this,r=t.constructor;t.$meta.class!==r&&Hs(r.$meta),t.construct(...e),t.afterConstruct(),t.isConstructing=!1}static new(...e){return e=e.filter(t=>t),new this(e.length>1?this.mergeConfigs(...e):e[0])}construct(...e){e[0]!==null&&this.configure(...e),this.afterConfigure()}static destroy(...e){const t=r=>{r!=null&&r.destroy?r.destroy():Array.isArray(r)&&r.forEach(t)};t(e)}destroy(){const e=this,{id:t}=e;e.isDestroying=!0,e.destroy=Hs,e.doDestroy(),Object.setPrototypeOf(e,null);for(const r in e)r!=="destroy"&&r!=="isDestroying"&&delete e[r];delete e[gl],e.isDestroyed=!0,e.id=t}_thisIsAUsedExpression(e){}static get $$name(){return lt(this,"$name")&&this.$name||lt(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}startConfigure(e){}finishConfigure(e){}afterConfigure(){}afterConstruct(){}callback(e,t,r=bc){const{handler:n,thisObj:s}=this.resolveCallback(e,t==="this"?this:t)||ep;return n==null?void 0:n.apply(s,r)}resolveProperty(e){let t=this;for(;t;){if(H.hasPath(t,e))return H.getPath(t,e);t=t.owner}}resolveCallback(e,t=this,r=!0){if(e!=null&&e.substring){if(e.endsWith("?")&&(r=!1,e=e.substring(0,e.length-1)),e.startsWith("up.")){for(e=e.substring(3),t=this.owner;t&&!t[e];t=t.owner);if(!t)return}else e.startsWith("this.")&&(e=e.substring(5),t=this);if(!t||!(t instanceof Object))return;e=t[e]}if(typeof e=="function")return{handler:e,thisObj:t};if(r)throw new Error(`No method named ${e} on ${t.$$name||"thisObj object"}`)}bindCallback(e,t=this){if(e){const{handler:r,thisObj:n}=this.resolveCallback(e,t);if(r)return r.bind(n)}}delay(e,t,r=e.name||e){return e=this.setTimeout?e:e.bind(this),(this.setTimeout?this:globalThis)[typeof t=="number"?"setTimeout":"requestAnimationFrame"](e,t,r)}doDestroy(){const e=this,{nullify:t}=e.$meta;if(t)for(let r=0;r<t.length;++r)e[t[r].field]!=null&&(e[t[r].name]=null)}destroyProperties(...e){var t,r;const n=this;let s;for(s of e)s in n&&(!n[wt]||!n[wt][s])&&((r=(t=n[s])==null?void 0:t.destroy)==null||r.call(t),delete n[s])}configure(e={}){const t=this,r=t.$meta,{beforeConfigure:n}=e,s=r.configs,a=t.getDefaultConfiguration();let l,o,u;t.initialConfig=e,t.isConfiguring=!0,Object.assign(t,t.getProperties());for(o in e)u=e[o],l=s[o],a[o]=l?l.merge(u,a[o],null,r):u;n&&(delete a.beforeConfigure,n(t,a)),t.setConfig(t[gl]=a,!0),t.isConfiguring=!1}getConfig(e){return this[e]}setConfig(e,t){var r;const n=this,s=n[wt],a=s?n.configDone:n.configDone={},l=n.$meta.configs,o=n[ii];let u,c;n[Jm]={},n[wt]=s?Object.setPrototypeOf(Object.assign({},e),s):e;for(c in e)e[c]!=null||lt(e,c)?(u=l[c]||me.get(c),o!=null&&o.has(c)||u.defineInitter(n,e[c]),t||(a[c]=!1)):a[c]=!0;t&&n.startConfigure(e);for(c in e)!a[c]&&!(t&&((r=l[c])!=null&&r.lazy))&&(n[c]=e[c]);return s?n[wt]=s:delete n[wt],t&&n.finishConfigure(e),n}hasConfig(e){var t;const r=this,n=r[wt];return!!(r["_"+e]!=null||((t=r[ii])==null?void 0:t.get(e))!=null||!r.configDone[e]&&n&&(n[e]!=null||lt(n,e)))}peekConfig(e){const t=this,r=t[ii],n=t[wt];if(r!=null&&r.has(e))return r.get(e);if(n&&e in n){if(t.configDone[e])return t[e];if(n[e]!=null||lt(n,e))return n[e]}}triggerConfig(e){const t=this,{configDone:r}=t,n=t[ii],s=t[wt],a=n!=null&&n.has(e)||s&&(s[e]!=null||lt(s,e))?!r[e]:null;return a&&t.getConfig(e),a}triggerConfigs(e){const t=this,r=t.$meta.configs,n=t[ii],s=n?[...n.keys()].filter(a=>r[a].lazy===e):bc;for(const a of s)t.triggerConfig(a);return s.length?s:null}onConfigChange(){}get config(){const e={},t=this[gl];for(const r in t)e[r]=t[r];return e}static processConfigValue(e,t){if(e===globalThis)return globalThis;if(Array.isArray(e))return e.map(r=>pr.processConfigValue(r,t));if(e instanceof pr)return t.visited.has(e)?void 0:e.getCurrentConfig(t);if(e instanceof HTMLElement||e instanceof DocumentFragment)return null;if(H.isObject(e)){const r={};for(const n in e)n!=="owner"&&(r[n]=pr.processConfigValue(e[n],t));return r}return e}getConfigValue(e,t){var r;const n=this,s=n[ii];if(!((r=n.$meta.configs[e])!=null&&r.lazy))return pr.processConfigValue(n[e],t);if(s!=null&&s.has(e))return pr.processConfigValue(s.get(e),t)}preProcessCurrentConfigs(){}getCurrentConfig(e={}){const t=this,r=e.configs==="all"?t.config:H.clone(t.initialConfig),n=e.visited||(e.visited=new Set),s=e.depth||(e.depth=0),a={};if(!n.has(t)){n.add(t),this.preProcessCurrentConfigs(r);for(const l in r){const o=t.getConfigValue(l,{...e,depth:s+1});o!==void 0&&(a[l]=o)}return a}}getConfigString(e={}){return P.toJavaScriptString(this.getCurrentConfig(e))}getTestCase(e={}){const t=this.isGantt?"Gantt":this.isSchedulerPro?"SchedulerPro":this.isCalendar?"Calendar":this.isScheduler?"Scheduler":this.isGrid?"Grid":this.isTaskBoard?"TaskBoard":null;if(t){const r=t.toLowerCase(),n=`../../build/${r}.module.js`;let s,a;e.import==="static"?(s=`import * as module from "${n}";Object.assign(window, module);`,a=""):(s=`import("${n}").then(module => { Object.assign(window, module);
`,a="});");const l=ie.getVersion(r);return l&&(s+=`
console.log('${t} ${l}');
`),`${s}      
const ${r} = new ${t}(${this.getConfigString(e)});
${a}`}}downloadTestCase(e={}){e.output="return";const t=this.getTestCase(e);U.download("app.js","data:application/javascript;charset=utf-8,"+escape(t))}static initClass(){return this.$meta.class}static get $meta(){const e=this;let t=e[Ws];return lt(e,Ws)||(e[Ws]=t=vc(),t.class=e,e.setupClass(t)),t}static onClassMixedIn(){}static mergeConfigs(e,...t){const r=this.$meta.configs,n=H.clone(e)||{};let s,a,l,o;for(a=0;a<t.length;++a)if(s=t[a],s)for(l in s)o=s[l],r[l]?o=r[l].merge(o,n[l]):n[l]&&o&&(o=me.merge(o,n[l])),n[l]=o;return n}static mixin(...e){let t=this,r;for(r=0;r<e.length;++r){const n=e[r],s=n[pc]||(n[pc]=Symbol("mixinTag"));t[s]||(t=n(t),t[s]=!0,lt(t,"onClassMixedIn")&&t.onClassMixedIn())}return t}static setupClass(e){var t;const r=e.class,n=gc(r).$meta,s=r.$$name,a=n.names,l=r.prototype;if(mc(l,"$meta",{value:e}),Object.assign(e,{super:n,config:Object.create(n.config),configs:Object.create(n.configs),declarables:n.declarables,forkConfigs:n.forkConfigs,hierarchy:Object.freeze([...n.hierarchy,r]),names:a.includes(s)?a:Object.freeze([...a,s]),properties:n.properties,nullify:(t=n.nullify)==null?void 0:t.slice()}),a!==e.names){const o=`is${s}`,u=c=>{lt(c,o)||mc(c,o,{get(){return!0}})};u(l),u(r)}for(let o,u,c=0;c<e.declarables.length;++c)o=e.declarables[c],lt(r,o)&&(u=yc[o]||(yc[o]=`setup${P.capitalize(o)}`),r[u](r,e))}static setupConfigs(e,t,r){const n=e.config,s=e.configs,a=e.class,l=e.super;let{nullify:o}=e,u,c,d,h,g,f;for(const m in t)g=t[m],r?(u=s[m])?g=u.merge(g,n[m],e,l):u=me.get(m,Qm):(c=d=h=void 0,g&&typeof g=="object"&&"$config"in g&&(d=g.$config,d&&!H.isObject(d)&&(d=H.createTruthyKeys(d)),h="default"in g,c=h?g.default:c,g=g.value),(u=s[m])?(f=u.nullify,d&&(u=u.extend(d)),g=u.merge(g,n[m],e,l)):(u=me.get(m,d),u.define(a.prototype),h=!(u.field in a.prototype),f=!1),h&&u.setDefault(a,c),u.nullify&&!f&&(o||(o=e.nullify||(e.nullify=[]))).push(u)),g&&(H.isObject(g)||Array.isArray(g))&&!Object.isFrozen(g)&&(e.forkConfigs=!0),s[m]=u,n[m]=g}static setupConfigurable(e,t){e.setupConfigs(t,e.configurable,!1)}static setupDefaultConfig(e,t){e.setupConfigs(t,e.defaultConfig,!0)}static setupDeclarable(e,t){const r=e.declarable;let n=t.declarables,s,a;for(a=0;a<r.length;++a)n.includes(r[a])||(s||(t.declarables=s=n=n.slice()),n.push(r[a]))}static setupProperties(e,t){t.properties=t.super.properties.slice(),t.properties.push(e),Object.freeze(t.properties)}static setupPrototypeProperties(e){Object.assign(e.prototype,e.prototypeProperties)}getDefaultConfiguration(){return this.constructor.getDefaultConfiguration()}static getDefaultConfiguration(){const e=this.$meta,t=e.forkConfigs?pr.fork(e.config):Object.create(e.config);if(ie.isTestEnv&&U.isBrowserEnv&&t.testConfig&&globalThis.__applyTestConfigs)for(const r in t.testConfig)t[r]=t.testConfig[r];return t}static fork(e){let t=e,r,n;if(e&&H.isObject(e)&&!Object.isFrozen(e)){t=Object.create(e);for(r in e)n=e[r],n&&(H.isObject(n)?t[r]=pr.fork(n):Array.isArray(n)&&(t[r]=n.slice()))}return t}getProperties(){const e=this.$meta.properties,t={};for(let r=0;r<e.length;r++)Object.assign(t,e[r].properties);return t}static get superclass(){return gc(this)}classHierarchy(e){const t=this.$meta.hierarchy,r=e?t.indexOf(e):0;return r>0?t.slice(r):t}static isOfTypeName(e){return this.$meta.names.includes(e)}detachListeners(e){let t=this.$detachers;if(t=t==null?void 0:t[e],t)for(;t.length;)t.pop()()}trackDetacher(e,t){const r=this.$detachers||(this.$detachers={});(r[e]||(r[e]=[])).push(t)}untrackDetachers(e){const t=this.$detachers;if(t)for(const r in t){const n=t[r];for(let s=n.length;s-- >0;)n[s].eventer===e&&n.splice(s,1)}}},ml=F.prototype;ml.onConfigChange.$nullFn=Hs.$nullFn=!0,F[Ws]=ml.$meta=vc({class:F,config:Object.freeze({}),configs:Object.create(null),declarables:F.declarable,forkConfigs:!1,hierarchy:Object.freeze([F]),names:Object.freeze(["Base"]),nullify:null,properties:Object.freeze([]),super:null}),Object.assign(ml,{$detachers:null,configObserver:null,isConstructing:!0,isDestroyed:!1,isDestroying:!1}),F.emptyFn=Hs,ie.setVersion("core","5.6.2"),F._$name="Base";var z=class dm{static clean(e){return e.reduce((t,r)=>(r!=null&&!(Array.isArray(r)&&r.length===0)&&r!==""&&t.push(r),t),[])}static from(e,t,r){const n=[];if(e)for(const s of e)(!t||t(s))&&n.push(r?r(s):s);return n}static remove(e,...t){let r,n,s=!1;t=t[0]instanceof Set?[...t[0]]:t;for(let a=0;a<t.length;a++)n=t[a],(r=e.indexOf(n))!==-1&&(e.splice(r,1),s=!0);return s}static findInsertionIndex(e,t,r=this.lexicalCompare,n){const s=t.length;let a,l;return n<s&&(a=n>0?r(t[n-1],e):0,l=n<s-1?r(e,t[n]):0,a<1&&l<1)?n:this.binarySearch(t,e,r)}static findLast(e,t,r){for(let{length:n}=e,s=n-1;s>=0;s--)if(t.call(r,e[s],s,e))return e[s]}static binarySearch(e,t,r=0,n=e.length,s=this.lexicalCompare){const a=e.length;let l,o;for(r instanceof Function?(s=r,r=0):n instanceof Function&&(s=n,n=a),--n;r<=n;)l=r+n>>1,o=s(t,e[l]),o>=0?r=l+1:o<0&&(n=l-1);return r}magnitudeCompare(e,t){return e<t?-1:e>t?1:0}lexicalCompare(e,t){return e=String(e),t=String(t),e<t?-1:e>t?1:0}static fill(e,t={},r=null){const n=[],s=Array.isArray(t)?t:[t];for(let a=0;a<e;a++)for(const l of s){const o=Object.assign({},l);r&&r(o,a),n.push(o)}return n}static populate(e,t,r=!1){const n=[];for(let s=0;s<e;s++)n.push(t(s+(r?1:0)));return n}static include(e,...t){for(const r of t)e.includes(r)||e.push(r)}static unique(e){return[...new Set(e)]}static allowNegative(e){return new Proxy(e,{get(t,r,n){if(typeof r!="string")return Reflect.get(t,r,n);const s=Number(r);return Number.isNaN(s)?Reflect.get(t,r,n):t[s<0?t.length+s:s]},set(t,r,n,s){if(typeof r!="string")return Reflect.set(t,r,n,s);const a=Number(r);return Number.isNaN(a)?Reflect.set(t,r,n,s):(t[a<0?t.length+a:a]=n,!0)}})}static delta(e,t,r=!1){if(!t)return r?{toAdd:e,toRemove:[],toKeep:[]}:{onlyInA:e,onlyInB:[],inBoth:[]};const n=[],s=[],a=new Set,l=new Set(t);for(let o=0;o<e.length;o++){const u=e[o];l.has(u)?a.add(u):n.push(u)}for(let o=0;o<t.length;o++){const u=t[o];a.has(u)||s.push(u)}return r?{toAdd:n,toRemove:s,toKeep:a}:{onlyInA:n,onlyInB:s,inBoth:[...a]}}static asArray(e){return e==null?e:e instanceof Set?Array.from(e):Array.isArray(e)?e:[e]}static identity(e){return e}static keyBy(e,t,r=dm.identity){const n=typeof t=="string"?a=>a==null?void 0:a[t]:t,s=typeof r=="string"?a=>a==null?void 0:a[r]:r;return e.reduce((a,l)=>(a[n(l)]=s(l),a),{})}static aggregate(e,t,r,n,s={}){const a=e.length,l=e[0].length,o=[];s.targetArray=o,s.arrays=e;for(let u=0;u<l;u++)s.entryIndex=u,o.push(n(u,s));for(let u=0;u<a;u++){const c=e[u];s.rowIndex=u;for(let d=0;d<l;d++){s.entryIndex=d;const h=t(c[d],s);o[d]=r(o[d],h,u,d,s)}}return o}static groupBy(e,t){const r=typeof t=="string"?n=>n==null?void 0:n[t]:t;return e.reduce((n,s)=>{const a=r(s);return(n[a]=n[a]||[]).push(s),n},{})}};z._$name="ArrayHelper";var Cc=/,\s*/,pl=Symbol("decompiled"),tp=/^\s*(async\s+)?([a-z_]\w*)\s*=>([\s\S]+)$/i,rp=/^\s*(async\s*)?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)\s+=>([\s\S]+)$/i,ip=/^(\s*async)?(?:\s*function)?(?:\s*([a-z_]\w*))?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)([\s\S]+)$/i,{hasOwnProperty:np}=Object.prototype,ue=class Vu{static after(e,t,r,n,s){const a=typeof r=="string",l=(s==null?void 0:s.return)!==!1,o=(...u)=>{const c=o.$nextHook.call(e,...u),d=n!=null&&n.isDestroyed?void 0:l?a?n[r](c,...u):r.call(n,c,...u):a?n[r](...u):r.call(n,...u);return d===void 0?c:d};return Vu.hookMethod(e,t,o)}static before(e,t,r,n){const s=typeof r=="string",a=(...l)=>{const o=n!=null&&n.isDestroyed?0:s?n[r](...l):r.call(n,...l);return o===!1?o:a.$nextHook.call(e,...l)};return Vu.hookMethod(e,t,a)}static curry(e){return function t(...r){return r.length>=e.length?e.apply(this,r):function(...n){return t.apply(this,r.concat(n))}}}static bindAll(e){for(const t in e)typeof e[t]=="function"&&(e[t]=e[t].bind(e))}static createInterceptor(e,t,r){return function(...n){const s=r||this;return t.call(s,...n)!==!1?e.call(s,...n):!1}}static createSequence(e,t,r){return(...n)=>{const s=e.call(r,...n),a=t.call(r,...n);return a===void 0?s:a}}static createThrottled(e,t,r,n,s){let a=-Number.MAX_VALUE,l,o;const u=()=>{o=0,a=performance.now(),l.push.apply(l,n),e.apply(r,l)},c=function(...d){const h=performance.now()-a;l=d,h>=t?(clearTimeout(o),u()):(o||(o=setTimeout(u,t-h)),s&&(l.push.apply(l,n),s.apply(r,l)))};return c.cancel=()=>clearTimeout(o),c}static createBuffered(e,t,r,n){let s,a;const l=()=>{a=0,o.isPending=!1,s.push.apply(s,n),e.apply(r,s)},o=function(...u){s=u,a&&clearTimeout(a),o.isPending=!0,a=setTimeout(l,t)};return o.cancel=()=>{o.isPending=!1,clearTimeout(a)},o}static decompile(e){if(!(pl in e)){const t=e.toString();let r=tp.exec(t),n,s,a,l,o;r?(n=[r[2]],s=r[3]):(r=rp.exec(t))?(o=r[2].trim(),n=o?o.split(Cc):[],s=r[3]):(r=ip.exec(t))&&(a=r[2],o=r[3].trim(),n=o?o.split(Cc):[],s=r[4]),s=s==null?void 0:s.trim(),e[pl]=l=r&&{args:n,async:!!r[1],body:s!=null&&s.startsWith("{")?s.substring(1,s.length-1).trim():s},a&&(l.name=a)}return e[pl]}static hookMethod(e,t,r){return r.$nextHook=e[t],e[t]=r,()=>{var n;if(np.call(e,t)){let s=e[t],a;if(s===r)((n=Object.getPrototypeOf(e))==null?void 0:n[t])===r.$nextHook?delete e[t]:e[t]=r.$nextHook;else for(;a=s==null?void 0:s.$nextHook;s=a)if(a===r){s.$nextHook=r.$nextHook;break}}}}static noThrow(e,t,r){const n=e[t];e[t]=(...s)=>{try{return n.apply(e,s)}catch(a){return r==null?void 0:r(a)}}}static returnTrue(){return!0}static animate(e,t,r,n="linear"){let s=!1;const a=new Promise(l=>{const o=performance.now(),u=()=>{const c=Math.min((performance.now()-o)/e,1),d=r&&r.setTimeout?r:globalThis;s||t.call(r,this.easingFunctions[n](c))===!1&&l(),s||c===1?d.requestAnimationFrame(()=>l()):d.requestAnimationFrame(u)};u()});return a.cancel=()=>(s=!0,a.cancelled=!0,!1),a}},ne=.5,Bt=1.70158,Ke=7.5625,Ys=1.525,vl=2/2.75,yl=2.25/2.75,bl=1/2.75,Cl=1.5/2.75,Sl=2.5/2.75,wl=2.625/2.75,Dl=.75,Tl=.9375,xl=.984375,sp=1.70158,ap=1.70158;ue.easingFunctions={linear:i=>i,easeInQuad:i=>Math.pow(i,2),easeOutQuad:i=>-(Math.pow(i-1,2)-1),easeInOutQuad:i=>(i/=ne)<1?ne*Math.pow(i,2):-ne*((i-=2)*i-2),easeInCubic:i=>Math.pow(i,3),easeOutCubic:i=>Math.pow(i-1,3)+1,easeInOutCubic:i=>(i/=ne)<1?ne*Math.pow(i,3):ne*(Math.pow(i-2,3)+2),easeInQuart:i=>Math.pow(i,4),easeOutQuart:i=>-(Math.pow(i-1,4)-1),easeInOutQuart:i=>(i/=ne)<1?ne*Math.pow(i,4):-ne*((i-=2)*Math.pow(i,3)-2),easeInQuint:i=>Math.pow(i,5),easeOutQuint:i=>Math.pow(i-1,5)+1,easeInOutQuint:i=>(i/=ne)<1?ne*Math.pow(i,5):ne*(Math.pow(i-2,5)+2),easeInSine:i=>-Math.cos(i*(Math.PI/2))+1,easeOutSine:i=>Math.sin(i*(Math.PI/2)),easeInOutSine:i=>-ne*(Math.cos(Math.PI*i)-1),easeInExpo:i=>i===0?0:Math.pow(2,10*(i-1)),easeOutExpo:i=>i===1?1:-Math.pow(2,-10*i)+1,easeInOutExpo:i=>i===0?0:i===1?1:(i/=ne)<1?ne*Math.pow(2,10*(i-1)):ne*(-Math.pow(2,-10*--i)+2),easeInCirc:i=>-(Math.sqrt(1-i*i)-1),easeOutCirc:i=>Math.sqrt(1-Math.pow(i-1,2)),easeInOutCirc:i=>(i/=ne)<1?-ne*(Math.sqrt(1-i*i)-1):ne*(Math.sqrt(1-(i-=2)*i)+1),easeOutBounce:i=>i<bl?Ke*i*i:i<vl?Ke*(i-=Cl)*i+Dl:i<Sl?Ke*(i-=yl)*i+Tl:Ke*(i-=wl)*i+xl,easeInBack:i=>i*i*((Bt+1)*i-Bt),easeOutBack:i=>(i=i-1)*i*((Bt+1)*i+Bt)+1,easeInOutBack:i=>{let e=sp;return(i/=ne)<1?ne*(i*i*(((e*=Ys)+1)*i-e)):ne*((i-=2)*i*(((e*=Ys)+1)*i+e)+2)},elastic:i=>-1*Math.pow(4,-8*i)*Math.sin((i*6-1)*(2*Math.PI)/2)+1,swingFromTo:i=>{let e=ap;return(i/=ne)<1?ne*(i*i*(((e*=Ys)+1)*i-e)):ne*((i-=2)*i*(((e*=Ys)+1)*i+e)+2)},swingFrom:i=>i*i*((Bt+1)*i-Bt),swingTo:i=>(i-=1)*i*((Bt+1)*i+Bt)+1,bounce:i=>i<bl?Ke*i*i:i<vl?Ke*(i-=Cl)*i+Dl:i<Sl?Ke*(i-=yl)*i+Tl:Ke*(i-=wl)*i+xl,bouncePast:i=>i<bl?Ke*i*i:i<vl?2-(Ke*(i-=Cl)*i+Dl):i<Sl?2-(Ke*(i-=yl)*i+Tl):2-(Ke*(i-=wl)*i+xl),easeFromTo:i=>(i/=ne)<1?ne*Math.pow(i,4):-ne*((i-=2)*Math.pow(i,3)-2),easeFrom:i=>Math.pow(i,4),easeTo:i=>Math.pow(i,.25)},ue._$name="FunctionHelper";var{isArray:Sc}=Array,{hasOwnProperty:lp}=Object.prototype,wc={thisObj:1,detachable:1,once:1,detacher:1,prio:1,args:1,expires:1,buffer:1,throttle:1,name:1,$internal:1},Dc=(i,e)=>e.prio-i.prio,fe=i=>class ju extends(i||F){constructor(){super(...arguments),y(this,"eventsSuspended",null)}static get $name(){return"Events"}static get declarable(){return["deprecatedEvents"]}static setupDeprecatedEvents(t,r){const n=r.getInherited("deprecatedEvents"),s=t.deprecatedEvents;for(const a in s)n[a.toLowerCase()]=n[a]=s[a]}static get configurable(){return{listeners:{value:null,$config:{merge(t,r){if(t!==null){if(!t)return r;r&&(t=t?[t]:[],t.push[Sc(r)?"apply":"call"](t,r))}return t}}},internalListeners:null,bubbleEvents:null}}destroy(){this.trigger("beforeDestroy"),super.destroy()}construct(t,...r){(this.configuredListeners=t==null?void 0:t.listeners)&&(t=H.assign({},t),delete t.listeners),super.construct(t,...r),this.processConfiguredListeners()}processConfiguredListeners(){if(this.configuredListeners){const t=this,{isConfiguring:r}=t;t.isConfiguring=!1,t.listeners=t.configuredListeners,t.configuredListeners=null,t.isConfiguring=r}}doDestroy(){this.trigger("destroy"),this.removeAllListeners(!1),super.doDestroy()}static setupClass(t){super.setupClass(t),ju.prototype.onListen.$nullFn=!0,ju.prototype.onUnlisten.$nullFn=!0}addListener(t,r,n){var s;if(Sc(t)){for(let o=0,{length:u}=t;o<u;o++)this.addListener(t[o],r);return}const a=this,l=a.$meta.getInherited("deprecatedEvents");if(typeof t=="string")return a.addListener({[t]:r,detachable:r.detachable!==!1,thisObj:n});{r=t.thisObj=t.thisObj!==void 0?t.thisObj:r;for(const d in t)if(!wc[d]&&t[d]!=null){const h=d.toLowerCase(),g=l==null?void 0:l[h],f=a.eventListeners||(a.eventListeners={}),m=z.asArray(t[d]);if(g){const{product:p,invalidAsOfVersion:v,message:b}=g;ie.deprecate(p,v,b)}for(const p of m){const v=p.expires||t.expires,b={fn:typeof p=="object"?p.fn:p,thisObj:p.thisObj!==void 0?p.thisObj:r,args:p.args||t.args,prio:p.prio!==void 0?p.prio:t.prio!==void 0?t.prio:0,once:p.once!==void 0?p.once:t.once!==void 0?t.once:!1,buffer:p.buffer||t.buffer,throttle:p.throttle||t.throttle,$internal:t.$internal,catchAll:d==="catchAll"};if(v){const{alt:S}=v,C=S?v.delay:v,T=t.name||d,E=()=>{a.un(h,b),S&&!b.called&&a.callback(S,r)};a.isDelayable?a.setTimeout({fn:E,name:T,cancelOutstanding:!0,delay:C}):globalThis.setTimeout(E,C)}let w=f[h]||(f[h]=[]);w.$firing&&(f[h]=w=w.slice()),w.splice(z.findInsertionIndex(b,w,Dc,w.length),0,b),!a.onListen.$nullFn&&w.length<2&&a.onListen(h),(s=a.afterAddListener)==null||s.call(a,h,b)}}t.relayAll&&a.relayAll(t.relayAll),r&&r!==a&&a.attachAutoDetacher(t,r);const o=t.detachable!==!1,u=t.name,c=t.expires||o||u?()=>{a.isDestroyed||a.removeListener(t,r)}:null;if(c&&(c.eventer=a,c.listenerName=u,u&&(r!=null&&r.trackDetacher)&&r.trackDetacher(u,c),t.expires&&a.delay(c,isNaN(t.expires)?t.expires.delay:t.expires,u),o))return c}}on(t,r,n){return this.addListener(t,r,n)}ion(t){return t.$internal=!0,this.on(t)}un(...t){this.removeListener(...t)}updateInternalListeners(t,r){r==null||r.detach(),t&&(t.detach=this.ion(t))}get listeners(){return this.eventListeners}changeListeners(t){if(this.isConfiguring)this.getConfig("internalListeners"),t&&this.on(t,this);else{if(Array.isArray(t))for(let r=0,n=t[0],{length:s}=t;r<s;n=t[++r])"thisObj"in n||(t[r]=H.assign({thisObj:this},n));else t&&!("thisObj"in t)&&(t=H.assign({thisObj:this},t));return t}}updateListeners(t,r){r&&this.un(r),t&&this.on(t)}removeListener(t,r=t.thisObj,n){const s=this;if(typeof t=="string")return s.removeListener({[t]:r},n);Object.entries(t).forEach(([a,l])=>{var o;if(!wc[a]&&l!=null){a=a.toLowerCase();const{eventListeners:u}=s,c=s.findListener(a,l,r);if(c>=0){let d=u[a];(o=s.afterRemoveListener)==null||o.call(s,a,d[c]),d.length>1?(d.$firing&&(u[a]=d=d.slice()),d.splice(c,1)):(delete u[a],s.onUnlisten.$nullFn||s.onUnlisten(a))}}}),t.thisObj&&!t.thisObj.isDestroyed&&s.detachAutoDetacher(t)}findListener(t,r,n){var s;const a=(s=this.eventListeners)==null?void 0:s[t],l=r.fn||r,o=r.thisObj||n;if(a){for(let u,c=0,{length:d}=a;c<d;c++)if(u=a[c],u.fn===l&&u.thisObj===o)return c}return-1}hasListener(t){var r;return!!((r=this.eventListeners)!=null&&r[t==null?void 0:t.toLowerCase()])}relayAll(t,r,n=!0){this.relayAllTargets||(this.relayAllTargets=[]);const{relayAllTargets:s}=this;t.ion({beforeDestroy:({source:a})=>{a===t&&s.filter(o=>o.through===t).forEach(o=>z.remove(s,o))}}),s.push({through:t,prefix:r,transformCase:n})}removeAllListeners(t=!0){var r;const n=this.eventListeners;let s,a;for(const l in n){const o=n[l];for(s=o.length;s-- >0;){const u=o[s];(!u.$internal||!t)&&(this.removeListener(l,u),a=u.thisObj,(r=a==null?void 0:a.untrackDetachers)==null||r.call(a,this))}}}relayEvents(t,r,n=""){const s={detachable:!0,thisObj:this};return r.forEach(a=>{s[a]=(l,...o)=>this.trigger(n+a,l,...o)}),t.on(s)}onListen(){}onUnlisten(){}destructorInterceptor(){const{autoDetachers:t,target:r,oldDestructor:n}=this;for(let s=0;s<t.length;s++){const{dispatcher:a,config:l}=t[s];a.isDestroyed||a.removeListener(l,r)}n.call(r)}attachAutoDetacher(t,r){const n=t.thisObj||r,s="doDestroy"in n?"doDestroy":"destroy";if(s in n){let{$autoDetachers:a}=n;a||(n.$autoDetachers=a=[]),n.$oldDestructor||(n.$oldDestructor=n[s],n[s]=this.destructorInterceptor.bind({autoDetachers:a,oldDestructor:n.$oldDestructor,target:n})),a.push({config:t,dispatcher:this})}else n[s]=()=>{this.removeListener(t)}}detachAutoDetacher(t){const r=t.thisObj;r.$oldDestructor&&!r.isDestroying&&(z.remove(r.$autoDetachers,r.$autoDetachers.find(n=>n.config===t&&n.dispatcher===this)),r.$autoDetachers.length||(r["doDestroy"in r?"doDestroy":"destroy"]=r.$oldDestructor,r.$oldDestructor=null))}once(t,r){return this.on({[t]:()=>this.callback(r),once:!0})}await(t,r={checkLog:!0,resetLog:!0,args:null}){const n=this;r===!1&&(r={checkLog:!1});const{args:s}=r;return new Promise(a=>{var l;if(r.checkLog&&((l=n._triggered)!=null&&l[t])&&(a(),r.resetLog&&n.clearLog(t)),s){const o=n.on({[t]:(...u)=>{(typeof s=="function"?s(...u):Object.keys(s).every(d=>d in u[0]&&u[0][d]===s[d]))&&(a(...u),r.resetLog&&n.clearLog(t),o())},prio:-1e4})}else n.on({[t]:(...o)=>{a(...o),r.resetLog&&n.clearLog(t)},prio:-1e4,once:!0})})}clearLog(t){this._triggered&&(t?delete this._triggered[t]:this._triggered={})}trigger(t,r){var n,s,a,l;const o=this,u=t.toLowerCase(),{eventsSuspended:c,relayAllTargets:d,callOnFunctions:h}=o;let g=(n=o.eventListeners)==null?void 0:n[u],f;if(o._triggered||(o._triggered={}),o._triggered[t]=!0,c)return c.shouldQueue&&c.queue.push(arguments),!0;if((s=o.eventListeners)!=null&&s.catchall&&((g=g?g.slice():[]).push(...o.eventListeners.catchall),g.sort(Dc)),!g&&!d&&!h)return!0;if(r?"source"in r||(Object.isExtensible(r)?r.source=o:r=Object.setPrototypeOf({source:o},r)):r={source:o},r.type!==u&&(r.constructor!==Object?Reflect.defineProperty(r,"type",{get:()=>u}):r.type=u),r.eventName=t,!("bubbles"in r)&&((a=o.bubbleEvents)!=null&&a[t])&&(r.bubbles=o.bubbleEvents[t]),h){const p="on"+P.capitalize(t);if(p in o){const v=o[p]?o.callback(o[p],o,[r]):!0;let b;if(H.isPromise(v)?(f||(f=[])).push(v):b=v===!1||b,!o.isDestroyed&&lp.call(o,p)&&!((l=o.pluginFunctionChain)!=null&&l[p])){const w=Object.getPrototypeOf(o);if(p in w){const S=w[p].call(o,r);if(H.isPromise(S)?(f||(f=[])).push(S):b=S===!1||b,o.isDestroyed)return}}if(b)return!1}}let m;if(g){let p=0,v=!1;for(g.$firing=!0,p;p<g.length&&!o.isDestroyed&&!v;p++){const b=g[p];if(m===!1&&!b.$internal)continue;let w,S=b.thisObj;if(!S||!S.isDestroyed){if(b.called=!0,b.once&&o.removeListener(u,b),typeof b.fn=="string"){if(S&&(w=S[b.fn]),!w){const T=o.resolveCallback(b.fn);w=T.handler,S=T.thisObj}}else w=b.fn;if(b.buffer){if(!b.bufferFn){const T=Number(b.buffer);if(typeof T!="number"||isNaN(T))throw new Error(`Incorrect type for buffer, got "${T}" (expected a Number)`);b.bufferFn=ue.createBuffered(w,T,S,b.args)}w=b.bufferFn}if(b.throttle){const T=Number(b.throttle);if(typeof T!="number"||isNaN(T))throw new Error(`Incorrect type for throttle, got "${T}" (expected a Number)`);b.throttledFn||(b.throttledFn=ue.createThrottled(w,T,S,b.args)),w=b.throttledFn}const C=w.call(S||o,...b.args||[],r);m!==!1&&(m=C),b.$internal&&C===!1&&(v=!0),H.isPromise(C)&&(C.$internal=b.$internal,(f||(f=[])).push(C))}}if(g.$firing=!1,v)return!1}return d==null||d.forEach(p=>{let v=t;if(p.transformCase&&(v=P.capitalize(v)),p.prefix&&(v=p.prefix+v),p.through.trigger(v,r)===!1)return!1}),r.bubbles&&o.owner&&!o.owner.isDestroyed?o.owner.trigger(t,r):(f=f==null?void 0:f.filter(p=>m!==!1||p.$internal),f!=null&&f.length?new Promise(p=>{Promise.all(f).then(v=>{const b=!v.some(w=>w===!1);p(b)})}):m!==!1)}suspendEvents(t=!1){const r=this.eventsSuspended||(this.eventsSuspended={shouldQueue:t,queue:[],count:0});r.count++}resumeEvents(){const t=this.eventsSuspended;if(t&&--t.count===0&&(this.eventsSuspended=null,t.shouldQueue))for(const r of t.queue)this.trigger(...r);return!this.eventsSuspended}},Us=class{static animationFrame(){return new Promise(i=>{requestAnimationFrame(i)})}static sleep(i){return new Promise(e=>{setTimeout(()=>{e()},i)})}static yield(){return Promise.resolve()}};Us._$name="AsyncHelper";var op=/^(\w+)=(.*)$/,up=function(i){const e={},t=i.split("&");for(const r of t){const[n,s,a]=op.exec(r),l=decodeURIComponent(s),o=decodeURIComponent(a);if(n){let u=e[l];u?(Array.isArray(u)||(u=e[l]=[u]),u.push(o)):e[l]=o}}return e},Tc=class Qr{static get(e,t){return this.fetch(e,t)}static post(e,t,r={}){return!(t instanceof FormData)&&typeof t!="string"&&(t=JSON.stringify(t),r.headers=r.headers||{},r.headers["Content-Type"]=r.headers["Content-Type"]||"application/json"),this.fetch(e,Object.assign({method:"POST",body:t},r))}static fetch(e,t){let r;if(t=H.merge({},Qr.DEFAULT_FETCH_OPTIONS,t),typeof AbortController!="undefined"&&(r=t.abortController=new AbortController,t.signal=r.signal),"credentials"in t||(t.credentials="include"),t.queryParams){const s=Object.entries(t.queryParams);if(s.length){let a=!1;if(t.headers&&t.addQueryParamsToBody===!0){const l=new Headers(t.headers).get("Content-Type");let o;switch(l){case"application/x-www-form-urlencoded":o=URLSearchParams;break;case"multipart/form-data":o=FormData;break}if(o){const u=t.body||(t.body=new o);u instanceof o&&(s.forEach(([c,d])=>u.set(c,d)),a=!0)}}a||(e+=(e.includes("?")?"&":"?")+s.map(([l,o])=>`${l}=${encodeURIComponent(o)}`).join("&"))}}const n=new Promise((s,a)=>{fetch(e,t).then(l=>{t.parseJson?l.json().then(o=>{l.parsedJson=o,s(l)}).catch(o=>{l.parsedJson=null,l.error=o,a(l)}):s(l)}).catch(l=>{l.stack=n.stack,a(l)})});return n.stack=new Error().stack,n.abort=function(){r==null||r.abort()},n}static mockUrl(e,t){const r=this;(r.mockAjaxMap||(r.mockAjaxMap={}))[e]=t,Qr.originalFetch||(Qr.originalFetch=Qr.fetch,Qr.fetch=r.mockAjaxFetch.bind(r))}static async mockAjaxFetch(e,t){const r=e.split("?");let n=this.mockAjaxMap[r[0]],s=null;if(n){typeof n=="function"&&(n=await n(r[0],r[1]&&up(r[1]),t));try{s=(t==null?void 0:t.parseJson)&&JSON.parse(n.responseText)}catch(a){s=null,n.error=a}return n=Object.assign({status:200,ok:!0,headers:new Headers,statusText:"OK",url:e,parsedJson:s,text:()=>new Promise(a=>{a(n.responseText)}),json:()=>new Promise(a=>{a(s)})},n),new Promise(function(a,l){n.synchronous?a(n):setTimeout(function(){a(n)},"delay"in n?n.delay:100)})}else return Qr.originalFetch(e,t)}};y(Tc,"DEFAULT_FETCH_OPTIONS",{});var Vt=Tc;Vt._$name="AjaxHelper";var Dt=typeof self!="undefined"?self:typeof globalThis!="undefined"?globalThis:null,xc=class Ls{static mergeLocales(...e){const t={};return e.forEach(r=>{Object.keys(r).forEach(n=>{typeof r[n]=="object"?t[n]={...t[n],...r[n]}:t[n]=r[n]})}),t}static trimLocale(e,t){const r=(n,s)=>{e[n]&&(s?e[n][s]&&delete e[n][s]:delete e[n])};Object.keys(t).forEach(n=>{Object.keys(t[n]).length>0?Object.keys(t[n]).forEach(s=>r(n,s)):r(n)})}static normalizeLocale(e,t){if(!e)throw new Error('"nameOrConfig" parameter can not be empty');if(typeof e=="string"){if(!t)throw new Error('"config" parameter can not be empty');t.locale?t.name=e||t.name:t.localeName=e}else t=e;let r={};if(t.name||t.locale)r=Object.assign({localeName:t.name},t.locale),t.desc&&(r.localeDesc=t.desc),t.code&&(r.localeCode=t.code),t.path&&(r.localePath=t.path);else{if(!t.localeName)throw new Error(`"config" parameter doesn't have "localeName" property`);r=Object.assign({},t)}for(const n of["name","desc","code","path"])r[n]&&delete r[n];if(!r.localeName)throw new Error("Locale name can not be empty");return r}static get locales(){return Dt.bryntum.locales||{}}static set locales(e){Dt.bryntum.locales=e}static get localeName(){return Dt.bryntum.locale||"En"}static set localeName(e){Dt.bryntum.locale=e||Ls.localeName}static get locale(){return Ls.localeName&&this.locales[Ls.localeName]||this.locales.En||Object.values(this.locales)[0]||{localeName:"",localeDesc:"",localeCoode:""}}static publishLocale(e,t){const{locales:r}=Dt.bryntum,n=Ls.normalizeLocale(e,t),{localeName:s}=n;return!r[s]||t===!0?r[s]=n:r[s]=this.mergeLocales(r[s]||{},n||{}),r[s]}};y(xc,"skipLocaleIntegrityCheck",!1);var We=xc;Dt.bryntum=Dt.bryntum||{},Dt.bryntum.locales=Dt.bryntum.locales||{},We._$name="LocaleHelper";var cp=class extends fe(F){static get defaultConfig(){return{throwOnMissingLocale:ie.isTestEnv}}construct(...i){var e;const t=this;if(super.construct(...i),U.isBrowserEnv){const r=document.querySelector("script[data-default-locale]");r?t.applyLocale(r.dataset.defaultLocale):(e=t.locale)!=null&&e.localeName&&t.applyLocale(t.locale.localeName)}}get locales(){return We.locales}set locales(i){We.locales=i}set locale(i){this.applyLocale(i)}get locale(){return We.locale}registerLocale(i,e){ie.deprecate("Core","6.0.0","LocaleManager.registerLocale deprecated, use LocaleHelper.publishLocale instead"),We.publishLocale(i,e)}extendLocale(i,e){ie.deprecate("Core","6.0.0","LocaleManager.extendLocale deprecated, use LocaleManager.applyLocale instead");const t=We.publishLocale(i,e);return this.applyLocale(t,!0)}applyLocale(i,e,t=!1){const r=this;let n;if(typeof i=="string")if(typeof e!="object"){if(n=r.locales[i],!n){if(t)return!0;throw new Error(`Locale "${i}" is not published. Publish with LocaleHelper.publishLocale() before applying.`)}}else n=We.publishLocale(i,e);else n=We.publishLocale(i);if(r.locale.localeName&&r.locale.localeName===n.localeName&&e!==!0)return r.locale;We.localeName=n.localeName;const s=()=>{r.trigger("locale",n)};return n.localePath?new Promise((a,l)=>{r.loadLocale(n.localePath).then(o=>{o.text().then(u=>{new Function(u)(),U.isBrowserEnv&&(n=r.locales[n.localeName],n&&delete n.localePath),s(),a(n)})}).catch(o=>l(o))}):(s(),n)}loadLocale(i){return Vt.get(i)}set throwOnMissingLocale(i){this._throwOnMissingLocale=i}get throwOnMissingLocale(){return this._throwOnMissingLocale}},dp=new cp,Te=dp,hp=Object.getPrototypeOf(Object),Ec=/L{.*?}/g,kc=/L{(.*?)}/g,Ic=/((.*?)\.)?(.+)/g,fp=i=>i.replace(/{(\d+)}/gm,"[[$1]]"),Mc=i=>i.replace(/\[\[(\d+)]]/gm,"{$1}"),gp=Object.freeze(Object.create(null)),bn=i=>class Ct extends(i||F){static get $name(){return"Localizable"}static get configurable(){return{localeClass:null,localizable:null,localizableProperties:{value:[],$config:{merge:"distinct"}}}}static clsName(t){var r,n;return typeof t=="string"?t:t===hp?"Object":t.$$name||t.name||((r=t.prototype)==null?void 0:r.$$name)||((n=t.prototype)==null?void 0:n.name)}static parseLocaleString(t){const r=[];let n;if(t!=null&&t.includes("L{"))for(t=fp(t),kc.lastIndex=0;(n=kc.exec(t))!=null;){Ic.lastIndex=0;const s=Ic.exec(n[1]);r.push({match:Mc(n[0]),localeKey:Mc(s[3]),localeClass:s[2]})}return r.length>0?r:[{match:t,localeKey:t,localeClass:void 0}]}construct(t={},...r){super.construct(t,...r),Te.ion({locale:"updateLocalization",thisObj:this}),this.updateLocalization()}get localeClass(){return this._localeClass||null}localizeProperty(t){var r,n,s;const a=this,l=H.getPath(a,t),o=((r=a.$meta.configs[t])==null?void 0:r.localeKey)||((s=(n=a.fieldMap)==null?void 0:n[t])==null?void 0:s.defaultValue);let u;return o?(u=Ct.localize(o,a,a.localeClass||a),u&&!(t in(a.initialConfig||gp))&&H.setPath(a.isColumn?a.data:a,t,u)):typeof l=="string"&&(a.originalLocales=a.originalLocales||{},u=H.getPath(a.originalLocales,t),u===void 0&&(H.setPath(a.originalLocales,t,l),u=l),u&&H.setPath(a,t,u=a.optionalL(u,a))),u||l}updateLocalization(){var t,r;this.localizable!==!1&&((t=this.localizableProperties)==null||t.forEach(this.localizeProperty,this),(r=this.trigger)==null||r.call(this,"localized"))}static getTranslation(t,r,n){const s=Te.locale;let a=null,l,o;if(s)for(const{match:u,localeKey:c,localeClass:d}of this.parseLocaleString(t)){const h=f=>{var m;const p=(m=s[f])==null?void 0:m[c];return p&&(typeof p=="function"?a=r!=null?p(r):p:typeof p=="object"||t===u?a=p:a=(a||t).replace(u,p),typeof p=="string"&&p.includes("L{")&&(a=this.getTranslation(p,r,n))),p};let g=!1;for(o=n;o&&(l=Ct.clsName(o))&&!(g=h(l));o=Object.getPrototypeOf(o))if(typeof o=="string")break;!g&&d&&h(d)}return a}static localize(t,r=void 0,...n){(n==null?void 0:n.length)===0&&(n=[this]);let s=null;return n.some(a=>(s=Ct.getTranslation(t,r,a),s!=null)),s}static L(t,r=void 0,...n){(n==null?void 0:n.length)===0&&(n=[this]);const s=this.localize(t,r,...n);if(s==null&&Te.throwOnMissingLocale&&t.includes("L{"))throw new Error(`Localization is not found for '${t}' in '${n.map(a=>Ct.clsName(a)).join(", ")}'. ${Te.locale.localeName?`Locale : ${Te.locale.localeName}`:""}`);return s!=null?s:t}L(t,r){const{localeClass:n,constructor:s}=this;return n&&Ct.clsName(n)!==Ct.clsName(s)?Ct.L(t,r,n,s):Ct.L(t,r,s)}static optionalL(t,r=void 0,...n){const s=Te.throwOnMissingLocale;Te.throwOnMissingLocale=s&&Ec.test(t),(n==null?void 0:n.length)===0&&(n=[this]);const a=Ct.L(t,r,...n);return Te.throwOnMissingLocale=s,a}optionalL(t,r=this,n=!1){const s=Te.throwOnMissingLocale;Te.throwOnMissingLocale=s&&Ec.test(t)&&!n;const a=this.L(t,r);return Te.throwOnMissingLocale=s,a}get localeManager(){return Te}get localeHelper(){return We}},mp={localeName:"En",localeDesc:"English (US)",localeCode:"en-US",Object:{Yes:"Yes",No:"No",Cancel:"Cancel",Ok:"OK",Week:"Week",None:"None"},ColorPicker:{noColor:"No color"},Combo:{noResults:"No results",recordNotCommitted:"Record could not be added",addNewValue:i=>`Add ${i}`},FilePicker:{file:"File"},Field:{badInput:"Invalid field value",patternMismatch:"Value should match a specific pattern",rangeOverflow:i=>`Value must be less than or equal to ${i.max}`,rangeUnderflow:i=>`Value must be greater than or equal to ${i.min}`,stepMismatch:"Value should fit the step",tooLong:"Value should be shorter",tooShort:"Value should be longer",typeMismatch:"Value is required to be in a special format",valueMissing:"This field is required",invalidValue:"Invalid field value",minimumValueViolation:"Minimum value violation",maximumValueViolation:"Maximum value violation",fieldRequired:"This field is required",validateFilter:"Value must be selected from the list"},DateField:{invalidDate:"Invalid date input"},DatePicker:{gotoPrevYear:"Go to previous year",gotoPrevMonth:"Go to previous month",gotoNextMonth:"Go to next month",gotoNextYear:"Go to next year"},NumberFormat:{locale:"en-US",currency:"USD"},DurationField:{invalidUnit:"Invalid unit"},TimeField:{invalidTime:"Invalid time input"},TimePicker:{hour:"Hour",minute:"Minute",second:"Second"},List:{loading:"Loading...",selectAll:"Select All"},GridBase:{loadMask:"Loading...",syncMask:"Saving changes, please wait..."},PagingToolbar:{firstPage:"Go to first page",prevPage:"Go to previous page",page:"Page",nextPage:"Go to next page",lastPage:"Go to last page",reload:"Reload current page",noRecords:"No records to display",pageCountTemplate:i=>`of ${i.lastPage}`,summaryTemplate:i=>`Displaying records ${i.start} - ${i.end} of ${i.allCount}`},PanelCollapser:{Collapse:"Collapse",Expand:"Expand"},Popup:{close:"Close"},UndoRedo:{Undo:"Undo",Redo:"Redo",UndoLastAction:"Undo last action",RedoLastAction:"Redo last undone action",NoActions:"No items in the undo queue"},FieldFilterPicker:{equals:"equals",doesNotEqual:"does not equal",isEmpty:"empty",isNotEmpty:"not empty",contains:"contains",doesNotContain:"does not contain",startsWith:"starts with",endsWith:"ends with",isOneOf:"one of",isNotOneOf:"not one of",isGreaterThan:"greater than",isLessThan:"less than",isGreaterThanOrEqualTo:"greater or equals",isLessThanOrEqualTo:"less or equals",isBetween:"between",isNotBetween:"not between",isBefore:"before",isAfter:"after",isToday:"today",isTomorrow:"tomorrow",isYesterday:"yesterday",isThisWeek:"this week",isNextWeek:"next week",isLastWeek:"last week",isThisMonth:"this month",isNextMonth:"next month",isLastMonth:"last month",isThisYear:"this year",isNextYear:"next year",isLastYear:"last year",isYearToDate:"year to date",isTrue:"true",isFalse:"false",selectAProperty:"Select property",selectAnOperator:"Select operator",caseSensitive:"Case-sensitive",and:"and",dateFormat:"D/M/YY",selectValue:"Select value",selectOneOrMoreValues:"Select value(s)",enterAValue:"Enter value",enterANumber:"Enter number",selectADate:"Select date",selectATime:"Select time"},FieldFilterPickerGroup:{addFilter:"Add filter"},DateHelper:{locale:"en-US",weekStartDay:0,nonWorkingDays:{0:!0,6:!0},weekends:{0:!0,6:!0},unitNames:[{single:"millisecond",plural:"ms",abbrev:"ms"},{single:"second",plural:"seconds",abbrev:"s"},{single:"minute",plural:"minutes",abbrev:"min"},{single:"hour",plural:"hours",abbrev:"h"},{single:"day",plural:"days",abbrev:"d"},{single:"week",plural:"weeks",abbrev:"w"},{single:"month",plural:"months",abbrev:"mon"},{single:"quarter",plural:"quarters",abbrev:"q"},{single:"year",plural:"years",abbrev:"yr"},{single:"decade",plural:"decades",abbrev:"dec"}],unitAbbreviations:[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],parsers:{L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A"},ordinalSuffix:i=>{const e=["11","12","13"].find(r=>i.endsWith(r));let t="th";if(!e){const r=i[i.length-1];t={1:"st",2:"nd",3:"rd"}[r]||"th"}return i+t}}},o0=We.publishLocale(mp),{toString:Rc}=Object.prototype,pp=Rc.call(new Date),qs=new Date,El=1e3*60*60,kl=(i,e)=>isNaN(i)||i==null?e:i,vp=/([ES]){([^}]+)}/g,_c=i=>{const e=["11","12","13"].find(r=>i.endsWith(r));let t="th";if(!e){const r=i[i.length-1];t={1:"st",2:"nd",3:"rd"}[r]||"th"}return i+t},Ie=(i,e,t)=>(zt[i]||(zt[i]=new Intl.DateTimeFormat(jt,e))).format(t),Cn=(i,e,t,r=!1)=>{let n=Ie(i,e,t);return/am|pm/i.test(n)&&(n=n.replace(/^0/,""),r&&(n=n.replace(/:00/,""))),n},yp=(i,e)=>Math.floor((i.getTime()-e.getTime()-(i.getTimezoneOffset()-e.getTimezoneOffset())*$e.minute.millisecond)/$e.day.millisecond)+1,Oc=i=>i>=0?i:i+7,bp=/([^\w])(S+)/gm,Cp=(i,e)=>e+"SSS",Ac=/[:.\-/\s]/,jt="en-US",Tt=_c,Ks={},Sn={},zt={},Il={},Pc=i=>{const e=Ml[i];if(!e)throw new Error("Only international formats should be used here");if(Sn[i]!==void 0)return Sn[i];const t=new Intl.DateTimeFormat(jt,e),r=t.formatToParts(new Date(2001,1,2,3,4,5,6)).map(n=>{const s=n.type,a=e[s];if(s==="literal")return n.value.replace(/,/g,"");if(s==="day")return a==="numeric"?"D":"DD";if(s==="month")return a==="short"?"MMM":a==="long"?"MMMM":a==="numeric"?"M":"MM";if(s==="year")return a==="numeric"?"YYYY":"YY"}).join("");return Sn[i]=r},Fc=2020,Lc=0,$c=1,Ml={l:{year:"numeric",month:"numeric",day:"numeric"},ll:{year:"numeric",month:"short",day:"numeric"}},Ce={M:i=>i.getMonth()+1,Mo:i=>Tt(Ce.M(i).toString()),MM:i=>(i.getMonth()+1).toString().padStart(2,"0"),MMM:i=>Ie("MMM",{month:"short"},i),MMMM:i=>Ie("MMMM",{month:"long"},i),Q:i=>Math.ceil((i.getMonth()+1)/3),Qo:i=>Tt(Ce.Q(i).toString()),D:i=>i.getDate(),Do:i=>Tt(Ce.D(i).toString()),DD:i=>i.getDate().toString().padStart(2,"0"),DDD:i=>Math.ceil((new Date(i.getFullYear(),i.getMonth(),i.getDate(),12,0,0)-new Date(i.getFullYear(),0,0,12,0,0))/$e.day.millisecond),DDDo:i=>Tt(Ce.DDD(i).toString()),DDDD:i=>Ce.DDD(i).toString().padStart(3,"0"),d:i=>i.getDay(),do:i=>Tt(i.getDay().toString()),d1:i=>Ie("d1",{weekday:"narrow"},i).substr(0,1),dd:i=>Ce.ddd(i).substring(0,2),ddd:i=>Ie("ddd",{weekday:"short"},i),dddd:i=>Ie("dddd",{weekday:"long"},i),u:i=>{const e=zt.u||(zt.u=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"})),t=e.formatToParts(i);return`${t[4].value}${t[2].value}${t[0].value}Z`},uu:i=>{const e=zt.uu||(zt.uu=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),t=e.formatToParts(i);return`${t[4].value}${t[2].value}${t[0].value}T${t[6].value}${t[8].value}${t[10].value}Z`},e:i=>i.getDay(),E:i=>i.getDay()+1,W:i=>k.getWeekNumber(i)[1],Wo:i=>Tt(Ce.W(i).toString()),WW:i=>Ce.W(i).toString().padStart(2,"0"),Wp:i=>`${k.localize("L{Week}")} ${Ce.W(i)}`,WWp:i=>`${k.localize("L{Week}")} ${Ce.WW(i)}`,Wp0:i=>`${k.localize("L{Week}")[0]}${Ce.W(i)}`,WWp0:i=>`${k.localize("L{Week}")[0]}${Ce.WW(i)}`,Y:i=>i.getFullYear(),YY:i=>(i.getFullYear()%100).toString().padStart(2,"0"),YYYY:i=>i.getFullYear(),A:i=>i.getHours()<12?"AM":"PM",a:i=>i.getHours()<12?"am":"pm",H:i=>i.getHours(),HH:i=>i.getHours().toString().padStart(2,"0"),h:i=>i.getHours()%12||12,hh:i=>Ce.h(i).toString().padStart(2,"0"),k:i=>i.getHours()||24,kk:i=>Ce.k(i).toString().padStart(2,"0"),K:i=>Cn("K",{hour:"numeric"},i),KK:i=>Cn("KK",{hour:"2-digit"},i),m:i=>i.getMinutes(),mm:i=>Ce.m(i).toString().padStart(2,"0"),s:i=>i.getSeconds(),ss:i=>Ce.s(i).toString().padStart(2,"0"),S:i=>Math.floor(i.getMilliseconds()/100).toString(),SS:i=>Math.floor(i.getMilliseconds()/10).toString().padStart(2,"0"),SSS:i=>i.getMilliseconds().toString().padStart(3,"0"),z:i=>Ie("z",{timeZoneName:"short"},i),zz:i=>Ie("zz",{timeZoneName:"long"},i),Z:i=>_.getGMTOffset(i),LT:i=>Cn("LT",{hour:"2-digit",minute:"2-digit"},i),LST:i=>Cn("LST",{hour:"numeric",minute:"2-digit"},i,!0),LTS:i=>Cn("LTS",{hour:"2-digit",minute:"2-digit",second:"2-digit"},i),L:i=>Ie("L",{year:"numeric",month:"2-digit",day:"2-digit"},i),l:i=>Ie("l",Ml.l,i),LL:i=>Ie("LL",{year:"numeric",month:"long",day:"numeric"},i),ll:i=>Ie("ll",Ml.ll,i),LLL:i=>Ie("LLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"},i),lll:i=>Ie("lll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},i),LLLL:i=>Ie("LLLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"long"},i),llll:i=>Ie("llll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"short"},i)},Sp=Object.keys(Ce).sort((i,e)=>e.length-i.length),wp=`^(?:${Sp.join("|")})`,_e=()=>({}),Dp=i=>_p.test(i),Rl=i=>Dp(i)&&{milliseconds:parseInt(i.padEnd(3,"0").substring(0,3))},Nc={YYYY:i=>{const e=parseInt(i);return{year:e>=1e3&&e<=9999?e:NaN}},Y:i=>({year:parseInt(i)}),YY:i=>{const e=parseInt(i);return{year:e+(e>1968?1900:2e3)}},M:i=>({month:parseInt(i)-1}),MM:i=>({month:parseInt(i)-1}),Mo:i=>({month:parseInt(i)-1}),MMM:i=>{const e=(i||"").toLowerCase();for(const[t,r]of Object.entries(k._monthShortNamesIndex))if(e.startsWith(t))return{month:r.value}},MMMM:i=>{const e=(i||"").toLowerCase();for(const[t,r]of Object.entries(k._monthNamesIndex))if(e.startsWith(t))return{month:r.value}},DD:i=>({date:parseInt(i)}),D:i=>({date:parseInt(i)}),Do:i=>({date:parseInt(i)}),DDD:_e,DDDo:_e,DDDD:_e,d:_e,do:_e,d1:_e,dd:_e,ddd:_e,dddd:_e,Q:_e,Qo:_e,W:_e,Wo:_e,WW:_e,e:_e,E:_e,HH:i=>({hours:parseInt(i)}),hh:i=>({hours:parseInt(i)}),mm:i=>({minutes:parseInt(i)}),H:i=>({hours:parseInt(i)}),m:i=>({minutes:parseInt(i)}),ss:i=>({seconds:parseInt(i)}),s:i=>({seconds:parseInt(i)}),S:Rl,SS:Rl,SSS:Rl,A:i=>({amPm:i.toLowerCase()}),a:i=>({amPm:i.toLowerCase()}),L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A",l:{type:"dynamic",parser:()=>Pc("l")},ll:{type:"dynamic",parser:()=>Pc("ll")},Z:i=>{if(!i||!jc.test(i)&&i!=="Z")return null;let e=0;if(i!=="Z"){const t=jc.exec(i);if(t){const r=t[1]==="+"?1:-1,n=parseInt(t[2])||0,s=parseInt(t[3])||0;e=r*(n*60+s)}else e=-1*new Date().getTimezoneOffset()}return{timeZone:e}}},Tp=Object.keys(Nc).sort((i,e)=>e.length-i.length),Bc=new RegExp(`(${Tp.join("|")})`),xp=new RegExp("^(LL|LLL|lll|LLLL|llll)$"),$e={decade:{decade:1,year:10,quarter:40,month:120,week:520,day:3652,hour:24*3652,minute:1440*3652,second:86400*3652,millisecond:864e5*3652},year:{decade:.1,year:1,quarter:4,month:12,week:52,day:365,hour:24*365,minute:1440*365,second:86400*365,millisecond:864e5*365},quarter:{decade:1/40,year:1/4,quarter:1,month:3,week:4,day:91,hour:24*91,minute:1440*91,second:86400*91,millisecond:864e5*91},month:{decade:1/120,year:1/12,quarter:1/3,month:1,week:4,day:-30,hour:-24*30,minute:-1440*30,second:-86400*30,millisecond:-864e5*30},week:{decade:-1/520,year:-1/52,quarter:-1/13,month:-1/4,day:7,hour:168,minute:10080,second:604800,millisecond:6048e5},day:{decade:-1/3652,year:-1/365,quarter:-1/91,month:-1/30,week:1/7,hour:24,minute:1440,second:86400,millisecond:864e5},hour:{decade:-1/(3652*24),year:-1/(365*24),quarter:-1/(91*24),month:-1/(30*24),week:1/168,day:1/24,minute:60,second:3600,millisecond:36e5},minute:{decade:-1/(3652*1440),year:-1/(365*1440),quarter:-1/(91*1440),month:-1/(30*1440),week:1/10080,day:1/1440,hour:1/60,second:60,millisecond:6e4},second:{decade:-1/(3652*86400),year:-1/(365*86400),quarter:-1/(91*86400),month:-1/(30*86400),week:1/604800,day:1/86400,hour:1/3600,minute:1/60,millisecond:1e3},millisecond:{decade:-1/(3652*864e5),year:-1/(365*864e5),quarter:-1/(91*864e5),month:-1/(30*864e5),week:1/6048e5,day:1/864e5,hour:1/36e5,minute:1/6e4,second:1/1e3}},Vc={ms:"millisecond",milliseconds:"millisecond",s:"second",seconds:"second",m:"minute",mi:"minute",min:"minute",minutes:"minute",h:"hour",hours:"hour",d:"day",days:"day",w:"week",weeks:"week",M:"month",mo:"month",mon:"month",months:"month",q:"quarter",quarters:"quarter",y:"year",years:"year",dec:"decade",decades:"decade"},Ep=/^\s*([-+]?\d+(?:[.,]\d*)?|[-+]?(?:[.,]\d+))\s*([^\s]+)?/i,kp=/^\s*([-+]?\d+)(?![.,])\s*([^\s]+)?/i,ni=["millisecond","second","minute","hour","day","week","month","quarter","year","decade"],Ip=[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],_l=["decade","year","month","week","day","hour","minute","second","millisecond"],Mp=["milliseconds","seconds","minutes","hours","date","month","year"],Rp=i=>{const e=parseFloat(i);return isNaN(e)?null:e},_p=/^[0-9]+$/,jc=/([+-])(\d\d):*(\d\d)*$/,xt={millisecond:0,second:1,minute:2,hour:3,day:4,week:5,month:6,quarter:7,year:8,decade:9},Op={round(i,e=1){return Math.round(i/e)*e},floor(i,e=1){return Math.floor(i/e)*e},ceil(i,e=1){return Math.ceil(i/e)*e}},zc={},Wc=class Pt extends bn(){static get $name(){return"DateHelper"}static set defaultFormat(e){_._defaultFormat=e}static get defaultFormat(){return _._defaultFormat||"YYYY-MM-DDTHH:mm:ssZ"}static set defaultParseFormat(e){this._defaultParseFormat=e}static get defaultParseFormat(){return this._defaultParseFormat||this._defaultFormat||"YYYY-MM-DDTHH:mm:ss.SSSZ"}static buildParser(e){const t=e.split(Bc),r=[];return t.length===1||xp.test(e)?[]:(t.reduce((n,s,a,l)=>{if(a!==0||s!=="")if(Bc.test(s)){const o=this.localize("L{parsers}")||{},u=o[s]||Nc[s];if(s==="Z"&&a<l.length-2)throw new Error(`Invalid format ${e} TimeZone (Z) must be last token`);const c=typeof u=="function"||typeof u=="string"?u:u.parser();if(typeof c=="string"){const d=_.buildParser(c),h=d.pop();delete h.last,r.push(...d),n=h}else n.pattern=s,n.fn=c}else n.splitter=s,r.push(n),n={};else Object.prototype.hasOwnProperty.call(n,"pattern")&&r.push(n);return n},{}),r[r.length-1].last=!0,r)}static makeKey(e){if(e.length===10)return e;e.getTime&&(e=e.getTime());const t=zc[Math.trunc(e/El)];if(t)return t;qs.setTime(e);const r=qs.getMonth()+1,n=qs.getDate();return zc[Math.trunc(e/El)]=`${qs.getFullYear()}-${r<10?"0"+r:r}-${n<10?"0"+n:n}`}static parseKey(e){return _.parse(e,"YYYY-MM-DD")}static parse(e,t=_.defaultParseFormat,r=!1){if(e instanceof Date)return e;if(typeof e!="string"||!e)return null;const n={year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null};t=t.replace(bp,Cp);let s=Il[t],a;if(s||(s=Il[t]=_.buildParser(t)),e.includes("\u202F")&&(e=e.replace(/\s/g," ")),s.reduce((o,u)=>{var c;if(u.last)Object.assign(n,u.fn(o));else{let d;if(u.splitter==="T"&&o.indexOf("T")===-1)d=o.indexOf(" ");else{const f=o.indexOf("+");let{splitter:m}=u;!r&&Ac.test(m)&&(m=Ac),d=u.splitter!==""?o.search(typeof m=="string"?P.escapeRegExp(m):m):((c=u.pattern)==null?void 0:c.length)||-1,f>-1&&d>f&&(d=-1)}let h,g;if(d===-1||u.pattern==="SSS"&&o.match(/^\d+Z$/)){const f=o.split(/([Z\-+])/);f.length===1?(h=o,g=""):(h=f[0],g=`${f[1]}${f[2]}`)}else h=o.substring(0,d)||o,g=o.substring(d+u.splitter.length);if(u.fn){const f=u.fn(h);f?Object.assign(n,f):g=h+g}return g}},e),n.year&&!n.date&&(n.date=1),n.date>31||n.month>12)return null;const l=_.create(n,r);return l?a=l:r||(a=new Date(e)),a}static create(e,t=!1){const r={...e};let n=isNaN(r.year)||t&&(isNaN(r.month)||isNaN(r.date)),s=!1;if(!n){let l=!0;Mp.forEach(o=>{(!(o in r)||isNaN(r[o]))&&(r[o]=0),l=l&&r[o]===null}),n=l}if(n||(r.amPm==="am"?r.hours=r.hours%12:r.amPm==="pm"&&(r.hours=r.hours%12+12),"timeZone"in r&&(s=!0,r.minutes-=r.timeZone),t&&(r.year==null||r.month==null||r.date==null)))return null;const a=[kl(r.year,Fc),kl(r.month,Lc),kl(r.date,$c),r.hours,r.minutes,r.seconds,r.milliseconds];return s?new Date(Date.UTC(...a)):new Date(...a)}static toUTC(e){return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))}static format(e,t=_.defaultFormat){if(!e||isNaN(e))return null;let r=Ks[t],n="";if(!r){r=Ks[t]=[];for(let s=0;s<t.length;s++){const a=t.slice(s).match(wp),l=a==null?void 0:a[0];if(l){const o=this.localize("L{formats}")||{},u=o[l]||Ce[l];r.push(u),s+=l.length-1}else if(t[s]==="{"){const o=t.indexOf("}",s+1);o===-1?(r.push(t.substr(s+1)),s=t.length):(r.push(t.substring(s+1,o)),s=o)}else r.push(t[s])}}return r.forEach(s=>{typeof s=="string"?n+=s:n+=s(e)}),n}static formatRange(e,t){return t.replace(vp,(r,n,s)=>Pt.format(e[n==="S"?0:1],s))}static asMilliseconds(e,t=null){return typeof e=="string"&&(t=e,e=1),_.as("millisecond",e,t)}static asMonths(e){const t=_.as("ms",_.daysInMonth(e),"day"),r=(e.valueOf()-_.startOf(e,"month").valueOf())/t;return e.getYear()*12+e.getMonth()+r}static monthsToDate(e){const t=Math.floor(e),r=e-t,n=new Date(0,t),s=_.as("ms",_.daysInMonth(n),"days");return n.setTime(n.getTime()+r*s),n}static formatDelta(e,t){let r,n;typeof t=="boolean"?r=t:t&&(r=t.abbrev);const s=this.getDelta(e,t),a=[],l=(t==null?void 0:t.separator)||(r?"":" ");for(n in s)a.push(`${s[n]}${l}${n}`);return(t==null?void 0:t.asString)===!1?a:a.join(", ")}static getDelta(e,t){let r,n,s,a,l,o,u;typeof t=="boolean"?r=t:t&&(r=t.abbrev,a=_.normalizeUnit(t.precision),o=t.maxUnit,u=!r&&t.ignoreLocale);const c={},d=r?_.getShortNameOfUnit:_.getLocalizedNameOfUnit,h=o?_l.slice(_l.indexOf(o)):_l;for(l of h)if(n=_.as(l,e),s=a===l,n=Math[s?"round":"floor"](n),(n||s&&!c.length)&&(c[u?l:d.call(_,l,n!==1)]=n,e-=_.as("ms",n,l)),s||!e)break;return c}static as(e,t,r="ms"){return typeof t=="string"&&(t=_.parseDuration(t)),typeof t=="object"&&(r=t.unit,t=t.magnitude),e===r||(e=_.normalizeUnit(e),r=_.normalizeUnit(r),e===r)?t:xt[r]>xt[e]?t*Math.abs($e[r][e]):t/Math.abs($e[e][r])}static formatContainsHourInfo(e){const t=/(\\.)/g;return/([HhKkmSsAa]|LT|L{3,}|l{3,})/.test(e.replace(t,""))}static is24HourFormat(e){return _.format(_.getTime(13,0,0),e).includes("13")}static add(e,t,r="ms",n=!0){let s;if(typeof e=="string"?s=_.parse(e):n?s=new Date(e.getTime()):s=e,typeof t=="string"){const a=Pt.parseDuration(t);t=a.magnitude,r=a.unit}else t&&typeof t=="object"&&(r=t.unit,t=t.magnitude);if(!r||t===0)return s;switch(r=_.normalizeUnit(r),r){case"millisecond":s.setTime(s.getTime()+t);break;case"second":s.setTime(s.getTime()+t*1e3);break;case"minute":s.setTime(s.getTime()+t*6e4);break;case"hour":s.setTime(s.getTime()+t*36e5);break;case"day":t%1===0?(s.setDate(s.getDate()+t),s.getHours()===23&&e.getHours()===0&&s.setHours(s.getHours()+1)):s.setTime(s.getTime()+t*864e5);break;case"week":s.setDate(s.getDate()+t*7);break;case"month":{let a=s.getDate();a>28&&(a=Math.min(a,_.getLastDateOfMonth(_.add(_.getFirstDateOfMonth(s),t,"month")).getDate())),s.setDate(a),s.setMonth(s.getMonth()+t);break}case"quarter":_.add(s,t*3,"month",!1);break;case"year":s.setFullYear(s.getFullYear()+t);break;case"decade":s.setFullYear(s.getFullYear()+t*10);break}return s}static diff(e,t,r="ms",n=!0){if(r=_.normalizeUnit(r),!e||!t)return 0;let s;switch(r){case"year":s=_.diff(e,t,"month")/12;break;case"quarter":s=_.diff(e,t,"month")/3;break;case"month":s=(t.getFullYear()-e.getFullYear())*12+(t.getMonth()-e.getMonth()),s===0&&n&&(s=_.diff(e,t,"day",n)/_.daysInMonth(e));break;case"week":s=_.diff(e,t,"day")/7;break;case"day":{const a=e.getTimezoneOffset()-t.getTimezoneOffset();s=(t-e+a*60*1e3)/864e5;break}case"hour":s=(t-e)/36e5;break;case"minute":s=(t-e)/6e4;break;case"second":s=(t-e)/1e3;break;case"millisecond":s=t-e;break}return n?s:Math.round(s)}static startOf(e,t="day",r=!0,n=_.weekStartDay){if(!e)return null;switch(t=_.normalizeUnit(t),r&&(e=_.clone(e)),t){case"year":return e.setMonth(0,1),e.setHours(0,0,0,0),e;case"quarter":return e.setMonth((_.get(e,"quarter")-1)*3,1),e.setHours(0,0,0,0),e;case"month":return e.setDate(1),e.setHours(0,0,0,0),e;case"week":{const s=e.getDay()-n;return e.setDate(e.getDate()-s),e.setHours(0,0,0,0),e}case"day":return e.setHours(0,0,0,0),e;case"hour":e.getMinutes()>0&&e.setMinutes(0);case"minute":e.getSeconds()>0&&e.setSeconds(0);case"second":e.getMilliseconds()>0&&e.setMilliseconds(0);case"millisecond":return e}}static endOf(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}static clone(e){return new Date(e.getTime())}static clearTime(e,t=!0){return e?(t&&(e=new Date(e.getTime())),e.setHours(0,0,0,0),e):null}static midnight(e,t){let r=_.clearTime(e);return t&&r<e&&(r=_.add(r,1,"d")),r}static getTimeOfDay(e,t="ms"){const r=e.getHours()*$e.hour.millisecond+e.getMinutes()*$e.minute.millisecond+e.getSeconds()*$e.second.millisecond+e.getMilliseconds();return t==="ms"?r:_.as(t,r,"ms")}static set(e,t,r){if(!t)return e;if(typeof t=="string")switch(_.normalizeUnit(t)){case"millisecond":(r!==0||e.getMilliseconds()>0)&&e.setMilliseconds(r);break;case"second":(r!==0||e.getSeconds()>0)&&e.setSeconds(r);break;case"minute":(r!==0||e.getMinutes()>0)&&e.setMinutes(r);break;case"hour":e.setHours(r);break;case"day":case"date":e.setDate(r);break;case"week":throw new Error("week not implemented");case"month":e.setMonth(r);break;case"quarter":e.setDate(1),e.setMonth((r-1)*3);break;case"year":e.setFullYear(r);break}else Object.entries(t).sort((n,s)=>xt[n[0]]-xt[s[0]]).forEach(([n,s])=>{_.set(e,n,s)});return e}static setDateToMidday(e,t=!0){return _.set(_.clearTime(e,t),"hour",12)}static constrain(e,t,r){return t!=null&&(e=_.max(e,t)),r==null?e:_.min(e,r)}static getTime(e,t=0,r=0,n=0){return e instanceof Date&&(n=e.getMilliseconds(),r=e.getSeconds(),t=e.getMinutes(),e=e.getHours()),new Date(Fc,Lc,$c,e,t,r,n)}static copyTimeValues(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),e}static get isDSTEnabled(){const e=new Date().getFullYear(),t=new Date(e,0,1),r=new Date(e,6,1);return t.getTimezoneOffset()!==r.getTimezoneOffset()}static isDST(e){const t=e.getFullYear(),r=new Date(t,0,1),n=new Date(t,6,1);return e.getTimezoneOffset()<Math.max(r.getTimezoneOffset(),n.getTimezoneOffset())}static isBefore(e,t){return e<t}static isAfter(e,t){return e>t}static isEqual(e,t,r=null){return r===null?e&&t&&e.getTime()===t.getTime():_.startOf(e,r)-_.startOf(t,r)===0}static compare(e,t,r=null){return r&&(e=_.startOf(e,r),t=_.startOf(t,r)),e<t?-1:e>t?1:0}static clamp(e,t,r){if(!isNaN(e))return t!=null&&(e=Math.max(e,t)),r!=null&&(e=Math.min(e,r)),new Date(e)}static isSameDate(e,t){return _.compare(e,t,"d")===0}static isSameTime(e,t){return e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds()&&e.getMilliseconds()===t.getMilliseconds()}static isStartOf(e,t){return _.isEqual(e,_.startOf(e,t))}static betweenLesser(e,t,r){return t.getTime()<=e.getTime()&&e.getTime()<r.getTime()}static betweenLesserEqual(e,t,r){return t.getTime()<=e.getTime()&&e.getTime()<=r.getTime()}static intersectSpans(e,t,r,n){return _.betweenLesser(e,r,n)||_.betweenLesser(r,e,t)}static compareUnits(e,t){return Math.sign(xt[_.normalizeUnit(e)]-xt[_.normalizeUnit(t)])}static timeSpanContains(e,t,r,n){return r-e>=0&&t-n>=0}static get weekStartDay(){return _._weekStartDay==null&&(_._weekStartDay=this.localize("L{weekStartDay}")||0),_._weekStartDay}static get nonWorkingDays(){return{...this.localize("L{nonWorkingDays}")}}static get nonWorkingDaysAsArray(){return Object.keys(this.nonWorkingDays).map(Number)}static get weekends(){return{...this.localize("L{weekends}")}}static get(e,t){switch(_.normalizeUnit(t)){case"millisecond":return e.getMilliseconds();case"second":return e.getSeconds();case"minute":return e.getMinutes();case"hour":return e.getHours();case"date":case"day":return e.getDate();case"week":return Ce.W(e);case"month":return e.getMonth();case"quarter":return Math.floor(e.getMonth()/3)+1;case"year":return e.getFullYear()}return null}static daysInYear(e){const t=e.getFullYear(),r=new Date(t+1,0,1)-new Date(t,0,1);return this.as("day",r)}static daysInMonth(e){return 32-new Date(e.getFullYear(),e.getMonth(),32).getDate()}static hoursInDay(e){const t=e.getFullYear(),r=e.getMonth(),n=e.getDate(),s=new Date(t,r,n+1)-new Date(t,r,n);return this.as("hour",s)}static getNormalizedUnitDuration(e,t){let r;switch(t){case"month":r=_.asMilliseconds(_.daysInMonth(e),"day");break;case"year":r=_.asMilliseconds(_.daysInYear(e),"day");break;case"day":r=_.asMilliseconds(_.hoursInDay(e),"hour");break;default:r=_.asMilliseconds(t)}return r}static getFirstDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth(),1)}static getLastDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}static min(e,t){return e.getTime()<t.getTime()?e:t}static max(e,t){return e.getTime()>t.getTime()?e:t}static getNext(e,t,r=1,n=_.weekStartDay){if(t==="week"){const s=_.clone(e),a=s.getDay();return _.startOf(s,"day",!1),_.add(s,n-a+7*(r-(n<=a?0:1)),"day",!1),s.getDay()!==n&&_.add(s,1,"hour"),s}return _.startOf(_.add(e,r,t),t,!1)}static isValidDate(e){return _.isDate(e)&&!isNaN(e)}static isDate(e){return e&&Rc.call(e)===pp}static getStartOfNextDay(e,t=!1,r=!1){let n=_.add(r?e:_.clearTime(e,t),1,"day");if(n.getDate()===e.getDate()){const s=_.add(_.clearTime(e,t),2,"day").getTimezoneOffset(),a=e.getTimezoneOffset();n=_.add(n,a-s,"minute")}return n}static getEndOfPreviousDay(e,t=!1){const r=t?e:_.clearTime(e,!0);return r-e?r:_.add(r,-1,"day")}static getWeekDescription(e,t=e){const r=e.getMonth()===t.getMonth()?Pt.format(e,"MMMM"):`${Pt.format(e,"MMM")} - ${Pt.format(t,"MMM")}`,n=Pt.getWeekNumber(e);return`${n[1]}, ${r} ${n[0]}`}static getWeekNumber(e,t=Pt.weekStartDay){const r=new Date(e.getFullYear(),0,1),n=new Date(e.getFullYear(),11,31),s=Oc(r.getDay()-t),a=Oc(n.getDay()-t),l=yp(e,r);let o;if(s<4?o=Math.floor((l+s-1)/7)+1:o=Math.floor((l+s-1)/7),o){let c=e.getFullYear();return o===53&&a<3&&(c++,o=1),[c,o]}const u=Pt.getWeekNumber(new Date(e.getFullYear()-1,11,31))[1];return[e.getFullYear()-1,u]}static formatCount(e,t){return t=_.normalizeUnit(t),e!==1&&(t+="s"),e+" "+t}static getUnitToBaseUnitRatio(e,t,r=!1){return e=_.normalizeUnit(e),t=_.normalizeUnit(t),e===t?1:$e[e]&&$e[e][t]&&(r||$e[e][t]>0)?1/_.as(t,1,e):$e[t]&&$e[t][e]&&(r||$e[t][e]>0)?_.as(e,1,t):-1}static getShortNameOfUnit(e){return e=_.parseTimeUnit(e),_.unitLookup[e].abbrev}static getLocalizedNameOfUnit(e,t=!1){const r=e.charAt(0)===e.charAt(0).toUpperCase();return e=_.normalizeUnit(e),e=_.parseTimeUnit(e),e=_.unitLookup[e][t?"plural":"single"],r&&(e=P.capitalize(e)),e}static normalizeUnit(e){if(!e)return null;const t=e.toLowerCase();return t==="date"||ni.includes(t)?t:Vc[e]||Vc[t]}static getUnitByName(e){return _.normalizeUnit(e)||_.normalizeUnit(_.parseTimeUnit(e))}static getDurationInUnit(e,t,r,n){return _.diff(e,t,r,n)}static doesUnitsAlign(e,t){return!(e!==t&&t==="week")}static getSmallerUnit(e){return ni[xt[_.normalizeUnit(e)]-1]||null}static getLargerUnit(e){return ni[xt[_.normalizeUnit(e)]+1]||null}static round(e,t,r,n){return _.snap("round",e,t,r,n)}static floor(e,t,r,n){return _.snap("floor",e,t,r,n)}static ceil(e,t,r,n){return _.snap("ceil",e,t,r,n)}static snap(e,t,r,n,s=_.weekStartDay){const a=Op[e];if(typeof r=="string"&&(r=_.parseDuration(r)),H.isObject(r)){const o=r.magnitude||r.increment;switch(r.unit){case"week":{if(!n){const u=t.getDay();n=_.add(_.clearTime(t),u>=s?s-u:-(u-s+7),"day")}return _[e](t,`${o*7} days`,n)}case"month":{t=_.asMonths(t);let u;return n?(n=_.asMonths(n),u=n+a(t-n,o)):u=a(t,o),_.monthsToDate(u)}case"quarter":return _[e](t,`${o*3} months`,n);case"year":return _[e](t,`${o*12} months`,n);case"decade":return _[e](t,`${o*10} years`,n)}r=_.as("ms",o,r.unit)}const l=t.getTimezoneOffset()*1e3*60;if(n){const o=n.getTimezoneOffset()*1e3*60,u=t-n+o-l,c=new Date(n.getTime()+a(u,r)),d=o-c.getTimezoneOffset()*1e3*60;return d&&_.add(c,-d,"ms",!1),new Date(c)}else return new Date(a(t.valueOf()-l,r)+l)}static parseDuration(e,t=!0,r){var n;const s=t?Ep:kp,a=s.exec(e);if(e==null||!a)return null;const l=Rp((n=a[1])==null?void 0:n.replace(",",".")),o=_.parseTimeUnit(a[2])||r;return o?{magnitude:l,unit:o}:null}static parseTimeUnit(e){const t=e==null?null:_.durationRegEx.exec(e.toLowerCase());if(!t)return null;for(let r=0;r<ni.length;r++)if(t[r+1])return ni[r]}static getGMTOffset(e=new Date){if(!e)return;const t=e.getTimezoneOffset();return t?(t>0?"-":"+")+Math.abs(Math.trunc(t/60)).toString().padStart(2,"0")+":"+Math.abs(t%60).toString().padStart(2,"0"):"Z"}static fillDayNames(){const e=new Date("2000-01-01T12:00:00"),t=_._dayNames||[],r=_._dayShortNames||[];t.length=0,r.length=0;for(let n=2;n<9;n++)e.setDate(n),t.push(_.format(e,"dddd")),r.push(_.format(e,"ddd"));_._dayNames=t,_._dayShortNames=r}static getDayNames(){return _._dayNames}static getDayName(e){return _._dayNames[e]}static getDayShortNames(){return _._dayShortNames}static getDayShortName(e){return _._dayShortNames[e]}static fillMonthNames(){const e=new Date("2000-01-15T12:00:00"),t=_._monthNames||[],r=_._monthShortNames||[],n={},s={};t.length=0,r.length=0;for(let a=0;a<12;a++){e.setMonth(a);const l=_.format(e,"MMMM");t.push(l);const o=_.format(e,"MMM");r.push(o),n[l.toLowerCase()]={name:l,value:a},s[o.toLowerCase()]={name:o,value:a}}_._monthNames=t,_._monthShortNames=r,_._monthNamesIndex=n,_._monthShortNamesIndex=s}static getMonthShortNames(){return _._monthShortNames}static getMonthShortName(e){return _._monthShortNames[e]}static getMonthNames(){return _._monthNames}static getMonthName(e){return _._monthNames[e]}static set locale(e){jt=e,zt={},Ks={},Sn={}}static get locale(){return jt}static setupDurationRegEx(e=[],t=[]){const r=this,n={};let s="";for(let a=0;a<t.length;a++){const l=t[a],o=e[a];o.canonicalUnitName=ni[a],n[o.single]=n[o.single.toUpperCase()]=n[o.canonicalUnitName]=n[o.canonicalUnitName.toUpperCase()]=o,s+=`${a?"|":""}(`;for(let u=0;u<l.length;u++)s+=`${l[u]}|`;if(jt=r.localize("L{locale}")||"en-US",jt!=="en-US"){const u=Ip[a];for(let c=0;c<u.length;c++)s+=`${u[c]}|`}s+=`${o.single}|${o.plural}|${o.canonicalUnitName}|${o.canonicalUnitName}s)`}r.unitLookup=n,r.durationRegEx=new RegExp(`^(?:${s})$`)}static applyLocale(){const e=this,t=e.localize("L{unitAbbreviations}")||[],r=e.unitNames=e.localize("L{unitNames}");r!=="unitNames"&&(jt=e.localize("L{locale}")||"en-US",jt==="en-US"?Tt=_c:Tt=e.localize("L{ordinalSuffix}")||Tt,Ks={},Sn={},Il={},zt={},_._weekStartDay=null,_.setupDurationRegEx(r,t),_.fillDayNames(),_.fillMonthNames())}};y(Wc,"MS_PER_DAY",El*24);var k=Wc,_=k;_.useIntlFormat=Ie,Te.ion({locale:"applyLocale",prio:1e3,thisObj:_}),Te.locale&&_.applyLocale(),k._$name="DateHelper";var{hasOwn:Ol}=H,Hc=1.005.toFixed(2)==="1.01"?null:function(i,e){const t=i.toString().split("."),r=+(t[1]?t.join(".")+"1":t[0]);return i.toFixed.call(r,e)},x=class al extends H{static transformArrayToNamedObject(e,t="ref"){const r={};return e.forEach((n,s)=>{const a=n[t]!=null&&n[t].toString().length?n[t]:s;r[a]=n}),r}static transformNamedObjectToArray(e,t="ref"){return Object.keys(e).filter(r=>e[r]).map(r=>{const n=e[r];return n[t]=r,n})}static isEqual(e,t,r=!1){if(e===null&&t!==null||e===void 0&&t!==void 0||t===null&&e!==null||t===void 0&&e!==void 0)return!1;if(e==null&&t==null||e===t)return!0;const n=typeof e;if(n===typeof t){switch(n){case"number":case"string":case"boolean":return e===t}switch(!0){case(e instanceof Date&&t instanceof Date):return e.getTime()===t.getTime();case(Array.isArray(e)&&Array.isArray(t)):return e.length===t.length?e.every((a,l)=>He.isEqual(a,t[l],r)):!1;case(n==="object"&&e.constructor.prototype===t.constructor.prototype):return r?He.isDeeplyEqual(e,t,r):P.safeJsonStringify(e,"circular")===P.safeJsonStringify(t,"circular")}}return String(e)===String(t)}static isDeeplyEqual(e,t,r={}){if(e===t)return!0;if(!e||!t)return!1;const n=He.keys(e,r.ignore),s=He.keys(t,r.ignore);if(n.length!==s.length)return!1;for(let a=0;a<n.length;a++){const l=n[a],o=s[a];if(l!==o)return!1;const u=e[l],c=t[o];if(!(r.shouldEvaluate&&r.shouldEvaluate(l,{value:u,object:e},{value:c,object:t})===!1)){if(r.evaluate){const d=r.evaluate(l,{value:u,object:e},{value:c,object:t});if(d===!1)return!1;if(d===!0)continue}if(!He.isEqual(u,c,r))return!1}}return!0}static isPartial(e,t){return e=String(e).toLowerCase(),t=String(t).toLowerCase(),e.indexOf(t)!==-1}static isLessThan(e,t){return e instanceof Date&&t instanceof Date?k.isBefore(e,t):e<t}static isMoreThan(e,t){return e instanceof Date&&t instanceof Date?k.isAfter(e,t):e>t}static fork(e){let t,r,n;if(e&&e.constructor===Object){t=Object.setPrototypeOf({},e);for(r in e)n=e[r],n&&(n.constructor===Object?t[r]=He.fork(n):n instanceof Array&&(t[r]=n.slice()))}else t=e;return t}static copyProperties(e,t,r){let n,s;for(s=0;s<r.length;s++)n=r[s],n in t&&(e[n]=t[n]);return e}static copyPropertiesIf(e,t,r){if(t)for(const n of r)!(n in e)&&n in t&&(e[n]=t[n]);return e}static entries(e,t){const r=[],n=typeof t=="function";if(e)for(const s in e)(n?!t(s,e[s]):!(t!=null&&t[s]))&&r.push([s,e[s]]);return r}static fromEntries(e,t){if(t=t||{},e)for(let r=0;r<e.length;++r)t[e[r][0]]=e[r][1];return t}static keys(e,t,r){const n=[],s=typeof t=="function";if(e){let a=0;for(const l in e)(s?!t(l,e[l]):!(t!=null&&t[l]))&&(n.push(r?r(l,a):l),++a)}return n}static values(e,t,r){const n=[],s=typeof t=="function";if(e){let a=0;for(const l in e)(s?!t(l,e[l]):!(t!=null&&t[l]))&&(n.push(r?r(e[l],a):e[l]),++a)}return n}static pathExists(e,t){return t.split(".").every(n=>!e||!(n in e)?!1:(e=e[n],!0))}static pathifyKeys(e,t){const r={};for(const n in e)if(Ol(e,n)){const s=t==null?void 0:t[n],a=(s==null?void 0:s.type)==="object"||(s==null?void 0:s.complexMapping)||!t;if(a&&Array.isArray(e[n]))r[n]=e[n].slice();else if(a&&e[n]instanceof Object){const l=this.pathifyKeys(e[n]);for(const o in l)r[`${n}.${o}`]=l[o]}else r[n]=e[n]}return r}static deletePath(e,t){t.split(".").reduce((r,n,s,a)=>{if(r==null)return null;if(Ol(r,n))if(s===a.length-1)delete r[n];else return r[n]},e)}static coerce(e,t){const r=H.typeOf(e),n=H.typeOf(t),s=typeof e=="string";if(r!==n)switch(n){case"string":return String(e);case"number":return Number(e);case"boolean":return s&&(!e||e==="false"||e==="0")?!1:!!e;case"null":return s&&(!e||e==="null")?null:!1;case"undefined":return s&&(!e||e==="undefined")?void 0:!1;case"date":return s&&isNaN(e)?k.parse(e):Date(Number(e))}return e}static wrapProperty(e,t,r,n,s=!0){const a={};let l=Object.getPrototypeOf(e),o=Object.getOwnPropertyDescriptor(l,t);for(;!o&&l&&s;)l=Object.getPrototypeOf(l),l&&(o=Object.getOwnPropertyDescriptor(l,t));o?(o.set?a.set=u=>{o.set.call(e,u),n&&n.call(e,o.get.call(e))}:a.set=n,o.get?a.get=()=>{let u=o.get.call(e);return r&&(u=r.call(e,u)),u}:a.get=r):(a.set=u=>{e[`_${t}`]=u,n&&n.call(e,u)},a.get=()=>{let u=e[`_${t}`];return r&&(u=r.call(e,u)),u}),Object.defineProperty(e,t,a)}static hookProperty(e,t,r){const n=al.getPropertyDescriptor(r.prototype,"value"),s=al.getPropertyDescriptor(e,t),a=`_${t}`,l=class{get value(){return s?s.get.call(this):this[a]}set value(u){s?s.set.call(this,u):this[a]=u}},o=al.getPropertyDescriptor(l.prototype,"value");return Object.setPrototypeOf(r.prototype,l.prototype),Object.defineProperty(e,t,{configurable:!0,get:n.get||o.get,set:n.set||o.set}),()=>delete e[t]}static getPropertyDescriptor(e,t){let r=null;for(let n=e;n&&!r&&!Ol(n,"isBase");n=Object.getPrototypeOf(n))r=Object.getOwnPropertyDescriptor(n,t);return r}static cleanupProperties(e,t=!1){return Object.entries(e).forEach(([r,n])=>{t?n===void 0&&delete e[r]:n==null&&delete e[r]}),e}static removeAllProperties(e){return Object.keys(e).forEach(t=>delete e[t]),e}static assertType(e,t,r){const n=H.typeOf(e);if(e!=null&&n!==t)throw new Error(`Incorrect type "${n}" for ${r}, expected "${t}"`)}static assertObject(e,t){He.assertType(e,"object",t)}static assertInstance(e,t){He.assertType(e,"instance",t)}static assertClass(e,t){He.assertType(e,"class",t)}static assertFunction(e,t){if(typeof e!="function"||e.isBase||e.$$name)throw new Error(`Incorrect type for ${t}, got "${e}" (expected a function)`)}static assertNumber(e,t){const r=Number(e);if(typeof e!="number"||isNaN(r))throw new Error(`Incorrect type for ${t}, got "${e}" (expected a Number)`)}static assertBoolean(e,t){He.assertType(e,"boolean",t)}static assertString(e,t){He.assertType(e,"string",t)}static assertArray(e,t){He.assertType(e,"array",t)}static toFixed(e,t){return Hc?Hc(e,t):e.toFixed(t)}static roundTo(e,t=1){return Math.round(e/t)*t}static round(e,t){if(t==null)return e;const r=10**t;return Math.round(e*r)/r}static getMapPath(e,t,r){const n=Array.isArray(t)?t:typeof t=="string"?t.split("."):[t],s=n.length===1,a=n[0],l=e.has(a)?e.get(a):e.set(a,s?r:{}).get(a);return s?l:He.getPathDefault(l,n.slice(1),r)}},He=x;x._$name="ObjectHelper";var Al,Yc=["border-top-width","border-right-width","border-bottom-width","border-left-width"],Ap=["margin-top","margin-right","margin-bottom","margin-left"],Pp=["padding-top","padding-right","padding-bottom","padding-left"],Wt={t:"border-top-width",r:"border-right-width",b:"border-bottom-width",l:"border-left-width"},Gs={t:"padding-top",r:"padding-right",b:"padding-bottom",l:"padding-left"},Fp=/^([trblc])(\d*)-([trblc])(\d*)$/i,Lp=/^([trblc])(\d*)$/i,Xs=["top","right","bottom","left"],wn={t:0,r:1,b:2,l:3},Pl=["b-t","l-r","t-b","r-l"],$p={bt:1,tb:1,lr:2,rl:2},Uc=Object.freeze([0,0]),Np=["width","height"],Zs=(i,e=i,t=i,r=e)=>Array.isArray(i)?Zs.apply(null,i):[i,e,t,r],Bp=Object.freeze([]);function Vp(i,e){const t=Fp.exec(i),r=t[1],n=t[3],s=parseInt(t[2]||50),a=parseInt(t[4]||50),l=e&&!(wn[r]&1)?100-s:s,o=e&&!(wn[n]&1)?100-a:a,u=$p[r+n];return{myAlignmentPoint:r+l,myEdge:r,myOffset:l,targetAlignmentPoint:n+o,targetEdge:n,targetOffset:o,startZone:wn[n],edgeAligned:u}}function jp(i){return`${Xs[(wn[i.myEdge]+2)%4][0]}${i.myOffset}-${Xs[(wn[i.targetEdge]+2)%4][0]}${i.targetOffset}`}function zp(i){return i==null?Uc:typeof i=="number"?[i,i]:i}var V=class Qe{constructor(e,t,r,n){y(this,"isRectangle",!0),x.assertNumber(e,"Rectangle.x"),x.assertNumber(t,"Rectangle.y"),x.assertNumber(r,"Rectangle.width"),x.assertNumber(n,"Rectangle.height");const s=this;r<0&&(e+=r,r=-r),n<0&&(t+=n,n=-n),s._x=e,s._y=t,s._width=r,s._height=n}static from(e,t,r){if(typeof e=="string"?e=document.querySelector(e):(e==null?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&(e=e.host||e.ownerDocument),typeof t=="string"&&(t=document.querySelector(t)),e==null||e.isRectangle)return e;if(e=e.element||e,r===void 0&&typeof t=="boolean"&&(r=t,t=null),!(t!=null&&t.isRectangle))if(t){let{scrollLeft:u,scrollTop:c}=t;U.isSafari&&t===document.body&&(u=c=0),t=Qe.from(t).translate(-u,-c)}else Al||(Al=new Qe(0,0,0,0)),t=Al;const n=e===document||e===globalThis,s=e===document.body&&document.body.offsetHeight===0,a=s&&e.getBoundingClientRect(),l=s?new Qe(a.left,a.top,a.width,document.body.parentElement.scrollHeight):n?new Qe(0,0,globalThis.innerWidth,globalThis.innerHeight):e.getBoundingClientRect(),o=r||n?[0,0]:[globalThis.pageXOffset,globalThis.pageYOffset];return new Qe(l.left+o[0]-t.x,l.top+o[1]-t.y,l.width,l.height)}static fromScreen(e,t){return Qe.from(e,t,!0)}static inner(e,t,r=!1){const n=this.from(e,t,r);if(document.body.contains(e)){const s=D.getStyleValue(e,Yc);n.x+=parseFloat(s[Wt.l]),n.y+=parseFloat(s[Wt.t]),n.right-=parseFloat(s[Wt.r]),n.bottom-=parseFloat(s[Wt.b])}return n}static content(e,t,r=!1){const n=this.from(e,t,r);if(document.body.contains(e)){const s=D.getStyleValue(e,Yc),a=D.getStyleValue(e,Pp);n.x+=parseFloat(s[Wt.l])+parseFloat(a[Gs.l]),n.y+=parseFloat(s[Wt.t])+parseFloat(a[Gs.t]),n.right-=parseFloat(s[Wt.r])+parseFloat(a[Gs.r]),n.bottom-=parseFloat(s[Wt.b])+parseFloat(a[Gs.b])}return n}static client(e,t,r=!1,n){const s=this.content(e,t,r),a=D.scrollBarWidth,l=n?[...e.children].filter(u=>D.getStyleValue(u,"position")==="sticky"):Bp;let o;a&&!e.classList.contains("b-hide-scroll")&&(e.scrollHeight>e.clientHeight&&D.getStyleValue(e,"overflow-y")!=="hidden"&&(o=parseFloat(D.getStyleValue(e,"padding-right")),s.right+=o-Math.max(o,a)),e.scrollWidth>e.clientWidth&&D.getStyleValue(e,"overflow-x")!=="hidden"&&(o=parseFloat(D.getStyleValue(e,"padding-bottom")),s.bottom+=o-Math.max(o,a)));for(let u=0,{length:c}=l;u<c;u++){const d=l[u],h=this.fromScreen(d);parseFloat(D.getStyleValue(d,"left"))===0?s.x+=h.width:parseFloat(D.getStyleValue(d,"right"))===0?s.right-=h.width:parseFloat(D.getStyleValue(d,"top"))===0?s.y+=h.height:parseFloat(D.getStyleValue(d,"bottom"))===0&&(s.bottom-=h.height)}return s}static outer(e,t,r=!1){const n=this.from(e,t,r);if(document.body.contains(e)){const s=D.getStyleValue(e,Ap);n.x-=parseFloat(s["margin-left"]),n.y-=parseFloat(s["margin-top"]),n.right+=parseFloat(s["margin-right"]),n.bottom+=parseFloat(s["margin-bottom"])}return n}static union(...e){let{x:t,y:r,right:n,bottom:s}=e[0],a;if(e.length>1)for(let l=1;l<e.length;l++)a=e[l],a.x<t&&(t=a.x),a.y<r&&(r=a.y),a.right>n&&(n=a.right),a.bottom>s&&(s=a.bottom);return new Qe(t,r,n-t,s-r)}roundPx(e=globalThis.devicePixelRatio||1){const t=this;return t._x=D.roundPx(t._x,e),t._y=D.roundPx(t._y,e),t._width=D.roundPx(t._width,e),t._height=D.roundPx(t._height,e),t}static get $$name(){return hasOwnProperty.call(this,"$name")&&this.$name||hasOwnProperty.call(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}clone(){const e=this,t=new Qe(e.x,e.y,e.width,e.height);return t.isAlignRectangle=e.isAlignRectangle,t.minHeight=e.minHeight,t.minWidth=e.minWidth,t}contains(e){const t=this;return e.isRectangle?e._x>=t._x&&e._y>=t._y&&e.right<=t.right&&e.bottom<=t.bottom:!1}intersect(e,t=!1,r=!1){const n=this,s=Math.max(n.y,e.y),a=Math.min(n.right,e.right),l=Math.min(n.bottom,e.bottom),o=Math.max(n.x,e.x);return(r?l>=s&&a>=o:l>s&&a>o)?t?!0:new Qe(o,s,a-o,l-s):!1}equals(e,t=!1){const r=t?n=>Math.round(n):n=>n;return e.isRectangle&&r(e.x)===r(this.x)&&r(e.y)===r(this.y)&&r(e.width)===r(this.width)&&r(e.height)===r(this.height)}translate(e,t){return this._x+=e||0,this._y+=t||0,this}moveTo(e,t){return e!=null&&(this._x=e),t!=null&&(this._y=t),this}getDelta(e){return[e.x-this.x,e.y-this.y]}get center(){const e=new ot(this.x+this.width/2,this.y+this.height/2,0,0);return e.target=this.target,e}set x(e){const t=e-this._x;this._x=e,this._width-=t}get x(){return this._x}get start(){return this.left}set left(e){this.x=e}get left(){return this.x}set top(e){this.y=e}get top(){return this.y}set y(e){const t=e-this._y;this._y=e,this._height-=t}get y(){return this._y}set width(e){this._width=e}get width(){return this._width}set height(e){this._height=e}get height(){return this._height}set right(e){this._width=e-this._x}get right(){return this._x+this._width}get end(){return this.right}set bottom(e){this._height=e-this._y}get bottom(){return this._y+this._height}getStart(e,t=!0){return t?e?this.right:this.left:this.top}getEnd(e,t=!0){return t?e?this.left:this.right:this.bottom}get area(){return this.width*this.height}set minWidth(e){const t=this;isNaN(e)?t._minWidth=null:(t._minWidth=Number(e),t.isAlignRectangle||(t.width=Math.max(t.width,t._minWidth)))}get minWidth(){return this._minWidth}set minHeight(e){const t=this;isNaN(e)?t._minHeight=null:(t._minHeight=Number(e),t.isAlignRectangle||(t.height=Math.max(t.height,t._minHeight)))}get minHeight(){return this._minHeight}adjust(e,t,r,n){const s=this;return s.x+=e,s.y+=t,s.width+=r,s.height+=n,s}inflate(e,t=e,r=e,n=t){return Array.isArray(e)&&([e,t,r,n]=Zs(e)),this.adjust(-n,-e,t,r)}deflate(e,t=e,r=e,n=t){return Array.isArray(e)&&([e,t,r,n]=Zs(e)),this.adjust(n,e,-t,-r)}constrainTo(e,t){const r=this,n=r.height,s=r.y,a=r.minWidth||r.width,l=r.minHeight||r.height;if(r.height>=e.height){if(t&&l>e.height)return!1;r._y=e.y,r.height=e.height}if(r.width>=e.width){if(t&&a>e.width)return r.y=s,r.height=n,!1;r._x=e.x,r.width=e.width}return r.translate.apply(r,r.constrainVector=[Math.min(e.right-r.right,0),Math.min(e.bottom-r.bottom,0)]),r.translate(Math.max(e.x-r.x,0),Math.max(e.y-r.y,0)),r}alignTo(e){let t=this.clone(),{target:r,constrainTo:n,constrainPadding:s}=e,a,l,o,u;if(r&&!r.isRectangle&&(r=Qe.from(r.element?r.element:r)),n){if(!n.isRectangle){u=n===globalThis||n===document;const R="ignorePageScroll"in e?e.ignorePageScroll:!u;n=Qe.from(n.element?n.element:n,null,R)}s&&(s=Zs(s),s[0]=Math.min(s[0],r.top),s[1]=Math.min(s[1],n.right-r.right),s[2]=Math.min(s[2],n.bottom-r.bottom),s[3]=Math.min(s[3],r.left),n=n.deflate.apply(n.clone(),s))}const c=this,d=zp(e.offset),{align:h,axisLock:g,anchorSize:f,anchorPosition:m,matchSize:p,position:v,rtl:b}=e,w=Vp(h,b),S=n&&n.clone(),C=[],T=[{zone:l=w.startZone,align:h}],E=p&&Np[w.startZone&1],I=c[E];if(E&&g?t[E]=r[E]:!w.edgeAligned&&p&&(t.width=r.width,t.height=r.height),n&&t.constrainTo(n),n&&w.startZone!=null)if(g)T.push({zone:l=(l+2)%4,align:jp(w)}),g==="flexible"&&(T.push({zone:l=(w.startZone+1)%4,align:Pl[l]}),T.push({zone:l=(l+2)%4,align:Pl[l]}));else for(let R=1;R<4;R++)T.push({zone:l=(l+1)%4,align:Pl[l]});if(m){const R=w.startZone&1?"y":"x";a={[R]:m[R],edge:Xs[(w.startZone+2)%4]}}if(S&&r&&(S.adjust(-r.width,-r.height,r.width,r.height),r.constrainTo(S)),t.minWidth=c.minWidth,t.minHeight=c.minHeight,v)t.moveTo(v.x,v.y),t.translate.apply(t,d),n&&t.constrainTo(n);else{const R=w.myEdge==="c"||w.targetEdge==="c",M=f&&!R?[f[1]+d[0],f[1]+d[1]]:d,O=r.getAlignmentPoint(w.targetAlignmentPoint,M),A=t.getAlignmentPoint(w.myAlignmentPoint);t.translate(O[0]-A[0],O[1]-A[1]);let B=t.intersect(r,!0);if(B)n&&t.constrainTo(n),o=w.startZone,t.translate(...M);else if(n&&!n.contains(t)){const L=t.clone(),Y=[];let K,W;a=null,C[0]=K=n.clone(),K.bottom=r.y-M[1],C[1]=K=n.clone(),K.x=r.right+M[0],C[2]=K=n.clone(),K.y=r.bottom+M[1],C[3]=K=n.clone(),K.right=r.x-M[0];for(let Z=0;Z<T.length;Z++){if(E&&Z==2&&(t[E]=I),K=C[o=T[Z].zone],t=t.alignTo({target:r,offsets:M,align:T[Z].align}),t.constrainTo(K,!0)&&(Y.push({result:t,zone:o}),!W||t.width<c.width||t.height<c.height)){t.align=T[Z].align;break}if(!W||K.area>W.area){const G=t.clone();switch(o){case 0:G.moveTo(null,K.bottom-G.height);break;case 1:G.moveTo(K.left);break;case 2:G.moveTo(null,K.top);break;case 3:G.moveTo(K.right-G.width);break}W={area:K.area,result:G,zone:o}}}Y.length?(Y.length>1&&!g&&Y.sort((Z,G)=>{const he=Math.sqrt((L.x-Z.result.x)**2+(L.y-Z.result.y)**2),ge=Math.sqrt((L.x-G.result.x)**2+(L.y-G.result.y)**2);return he-ge}),t=Y[0].result,o=Y[0].zone):(t=W.result,o=W.zone,u&&t.constrainTo(n))}else o=w.startZone;if(t.zone=o,t.overlap=B=t.intersect(r,!0),f&&!B){if(!a){const L=o&1,Y=L?"y":"x",K=L?"bottom":"right",W=Math.max(r[Y],t[Y]),Z=Math.min(r[K],t[K]);let G=W+(Z-W)/2-f[0]/2;const he=G+f[0];he>t[K]&&(G-=he-t[K]),G<t[Y]&&(G+=t[Y]-G),a={[Y]:G-t[Y],edge:Xs[(o+2)%4]}}t.anchor=a}}return t}getAlignmentPoint(e,t=Uc){const r=this,n=Lp.exec(e),s=n[1].toLowerCase(),a=Math.min(Math.max(parseInt(n[2]||50),0),100)/100;switch(s){case"t":return[r.x+r.width*a,r.y-t[1]];case"r":return[r.right+t[0],r.y+r.height*a];case"b":return[r.x+r.width*a,r.bottom+t[1]];case"l":return[r.x-t[0],r.y+r.height*a];case"c":return[r.x+r.width/2,r.y+r.height/2]}}highlight(){const e=this,t=D.createElement({parent:document.body,style:`position:absolute;z-index:9999999;pointer-events:none;
                            left:${e.x}px;top:${e.y}px;width:${e.width}px;height:${e.height}px`});return D.highlight(t).then(()=>t.remove())}visualize(e,t){const r=this,n=x.merge({style:{left:`${r.x}px`,top:`${r.y}px`,width:`${r.width}px`,height:`${r.height}px`,pointerEvents:"none",...e.class?{}:{position:"absolute","z-index":9999999}}},e);return t?n:D.createElement(n)}toString(e=","){return[`${this.top}px`,`${this.right}px`,`${this.bottom}px`,`${this.left}px`].join(e)}},ot=class extends V{static from(i){const e=i.changedTouches,t=e?e[0].screenX:i.screenX,r=e?e[0].screenY:i.pageY;return new this.constructor(t,r)}constructor(i,e){super(i,e,0,0)}constrain(i){return this.x=Math.min(Math.max(this.x,i.x),i.right-1),this.y=Math.min(Math.max(this.y,i.y),i.bottom-1),this}toArray(){return[this.x,this.y]}};V._$name="Rectangle";var yr=Symbol("value"),qc=Symbol("length"),J=class st{static change(e,t,r,n="string"){r=st.normalize(r,"object");const s=st.normalize(e,"array").filter(a=>!r[a]);if(t){t=st.normalize(t,"array");for(let a=0;a<t.length;++a)s.includes(t[a])||s.push(t[a])}return st.normalize(s,n)}static from(e,t){return e&&(e.isDomClassList?t=t!=null?t:!0:(t=t!=null?t:H.isObject(e)&&!H.isEmpty(e),e=new st(e)),!e.value&&!t&&(e=null)),e||(t?new st:null)}static normalize(e,t="string"){e=e||"";const r=typeof e,n=t==="array",s=t==="object",a=!n&&!s;let l=r==="string",o,u,c;for(r==="object"&&(e.nodeType===Element.ELEMENT_NODE&&typeof e.getAttribute=="function"?(e=e.getAttribute("class")||"",l=!0):e!=null&&e.isDomClassList?e=e.values:e instanceof DOMTokenList?e=Array.from(e):e instanceof Map?e=Array.from(e.keys()).filter(d=>e.get(d)):e instanceof Set?e=Array.from(e):Array.isArray(e)||(e=H.getTruthyKeys(e))),l&&(e=[...new Set(P.split(e))]),u=e.length;u-- >0;)o=e[u],o.length?o.includes(" ")&&e.splice(u,1,...P.split(o)):e.splice(u,1);if(n)c=e;else if(a)c=e.join(" ");else for(c=Object.create(null),u=0;u<e.length;++u)c[e[u]]=!0;return c}constructor(...e){this.process(1,e)}clear(){for(const e in this)this[e]=!1;return this}set(...e){return this.clear().process(1,e)}get isDomClassList(){return!0}clone(){return new st(this)}contains(e){return typeof e=="string"&&e?!!this[e]:!1}toString(){return this.length?`${this.value} `:""}toJSON(){return this.toString()}trim(){return this.value}isEqual(e){const t=st.normalize(e,"array"),r=t.length;if(this.length===r){for(let n=0;n<r;n++)if(!this[t[n]])return!1;return!0}return!1}get value(){let e=this[yr],t;return e==null&&(t=H.getTruthyKeys(this),this[qc]=t.length,this[yr]=e=t.join(" ")),e}set value(e){const t=this,r=Object.keys(t),n=r.length;for(let s=0;s<n;s++)delete t[r[s]];e?t.process(1,[e]):delete t[yr]}get values(){return H.getTruthyKeys(this)}get length(){return this.value?this[qc]:0}process(e,t){for(let r,n,s=0;s<t.length;s++)if(t[s])if(r=t[s],r.isDomClassList||H.isObject(r))for(n in r)this[n]=e?r[n]:!r[n];else for(r=st.normalize(t[s],"array"),n=0;n<r.length;++n)this[r[n]]=e;return delete this[yr],this}assign(e){for(const t in e)!this[t]!=!e[t]&&(this[t]=e[t],delete this[yr]);return this}assignTo(e){const t=e.nodeType===Element.ELEMENT_NODE?e.classList:e,r=st.from(t);r.add(this),t.value=r.value}add(...e){return this.process(1,e)}remove(...e){return this.process(0,e)}toggle(e,t=!this[e]){if(t=!!t,!!this[e]!==t)return this[e]=t,delete this[yr],!0}split(){return H.getTruthyKeys(this)}forEach(e){return H.getTruthyKeys(this).forEach(e)}};J.prototype[yr]=null,J._$name="DomClassList";var Wp=["clientX","clientY","pageX","pageY","screenX","screenY"],Hp={element:1,thisObj:1,once:1,delegate:1,delay:1,capture:1,passive:1,throttled:1,autoDetach:1,expires:1,block:1},Ht=!0,Kc={configurable:Ht,value:!0},Yp={Spacebar:"Space",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},Up={Control:"ctrl",Alt:"alt",Shift:"shift"},qp=/^(ctrl|shift|alt|meta)$/,Kp=["altKey","bubbles","button","buttons","cancelBubble","cancelable","clientX","clientY","ctrlKey","layerX","layerY","metaKey","pageX","pageY","returnValue","screenX","screenY","shiftKey"],Gc=class hm{static normalizeEvent(e){return x.copyPropertiesIf(e,e.changedTouches[0]||e.touches[0],Wp)}static copyEvent(e,t){return x.copyProperties(e,t,Kp)}static getXY(e){return e.touches&&(e=e.touches[0]),[e.clientX,e.clientY]}static getDistanceBetween(e,t){const r=ve.getXY(e),n=ve.getXY(t);return Math.sqrt(Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2))}static getPagePoint(e){return new ot(e.pageX,e.pageY)}static getClientPoint(e){return new ot(e.clientX,e.clientY)}static addListener(e,t,r,n){return e.nodeType?typeof t=="string"?n=Object.assign({element:e,[t]:r},n):n=Object.assign({element:e},t):n=e,ve.on(n)}static on(e){const t=e.element,r=e.thisObj,n=[];for(const a in e)if(!Hp[a]){let l=e[a];typeof l!="object"&&(l={handler:l});const o=l.element||t;n.push(ve.addElementListener(o,a,l,e))}const s=()=>{for(let a,l=0;l<n.length;l++)a=n[l],ve.removeEventListener(a[0],a[1],a[2]);n.length=0};return r&&e.autoDetach!==!1&&(r.doDestroy=ue.createInterceptor(r.doDestroy,s,r)),s}static addElementListener(e,t,r,n){const s=ve.createHandler(e,t,r,n),{spec:a}=s,l=r.expires||n.expires,o=a.capture!=null||a.passive!=null?{capture:a.capture,passive:a.passive}:void 0;if(e.addEventListener(t,s,o),l){const u=r.thisObj||n.thisObj,c=u!=null&&u.isDelayable?u:globalThis,{alt:d}=l,h=d?l.delay:l,{spec:g}=s;g.expires=l,g.timerId=c[typeof h=="number"?"setTimeout":"requestAnimationFrame"](()=>{g.timerId=null,ve.removeEventListener(e,t,s),d&&!s.called&&(typeof d=="string"?u[d]:d).call(u)},h,`listener-timer-${performance.now()}`)}return[e,t,s,o]}static getComposedPathTarget(e){return e.composedPath()[0]||e.path[0]}static fixEvent(e){var t,r,n;if(e.fixed)return e;const{type:s,target:a}=e;if((a!=null&&a.shadowRoot||(r=(t=a==null?void 0:a.getRootNode)==null?void 0:t.call(a))!=null&&r.host)&&e.composedPath){const l=this.getComposedPathTarget(e),o=a;Object.defineProperty(e,"target",{value:l,configurable:Ht}),Object.defineProperty(e,"originalTarget",{value:o,configurable:Ht})}if(Object.defineProperty(e,"fixed",Kc),s.startsWith("key")){const l=Yp[e.key];l&&Object.defineProperty(e,"key",{value:l,configurable:Ht}),e.key===" "&&!e.code&&Object.defineProperty(e,"code",{value:"Space",configurable:Ht})}if(e.metaKey&&!e.ctrlKey&&Object.defineProperty(e,"ctrlKey",Kc),a&&"offsetX"in e&&(Object.getOwnPropertyDescriptor(e,"borderOffsetX")||Object.defineProperty(e,"borderOffsetX",{get:()=>e.offsetX+(U.isSafari?0:parseInt(a.ownerDocument.defaultView.getComputedStyle(a).getPropertyValue("border-left-width")))}),Object.getOwnPropertyDescriptor(e,"borderOffsetY")||Object.defineProperty(e,"borderOffsetY",{get:()=>e.offsetY+(U.isSafari?0:parseInt(a.ownerDocument.defaultView.getComputedStyle(a).getPropertyValue("border-top-width")))})),(a==null?void 0:a.nodeType)===Element.DOCUMENT_NODE&&"clientX"in e){const l=D.elementFromPoint(e.clientX,e.clientY);Object.defineProperty(e,"target",{value:l,configurable:Ht})}if((a==null?void 0:a.nodeType)===Element.TEXT_NODE){const l=e.target.parentElement;Object.defineProperty(e,"target",{value:l,configurable:Ht})}if(((n=e.relatedTarget)==null?void 0:n.nodeType)===Element.TEXT_NODE){const l=e.target.parentElement;Object.defineProperty(e,"relatedTarget",{value:l,configurable:Ht})}return s.startsWith("touch")&&e.touches.length&&this.normalizeEvent(e),e}static createHandler(e,t,r,n){const s=r.delay||n.delay,a=r.throttled||n.throttled,l=r.block||n.block,o="once"in r?r.once:n.once,u="capture"in r?r.capture:n.capture,c="passive"in r?r.passive:n.passive,d="delegate"in r?r.delegate:n.delegate,h=r.handler,g=r.expires,f=r.thisObj||n.thisObj,{rtlSource:m=f}=f||{};let p=(v,...b)=>{ve.playingDemo&&v.isTrusted||f!=null&&f.isDestroyed||(v=ve.fixEvent(v,m==null?void 0:m.rtl),p.called=!0,(typeof h=="string"?f[h]:h).call(f,v,...b),delete v.target,delete v.relatedTarget,delete v.originalarget,delete v.key,delete v.code,delete v.ctrlKey,delete v.fixed)};if(l){const v=p;let b,w;p=(S,...C)=>{const T=performance.now();(!b||S.target!==w||T-b>l)&&(w=S.target,b=T,v(S,...C))}}if(s!=null){const v=p,b=f!=null&&f.setTimeout?f:globalThis;p=(...w)=>{b.setTimeout(()=>{v(...w)},s)}}if(a!=null){let v,b=a;a.buffer&&(v=w=>a.alt.call(ve,ve.fixEvent(w,m==null?void 0:m.rtl)),b=a.buffer),f!=null&&f.isDelayable?p=f.throttle(p,{delay:b,throttled:v}):p=ue.createThrottled(p,b,f,null,v)}if(o){const v=p;p=(...b)=>{ve.removeEventListener(e,t,p),v(...b)}}if(d){const v=p;p=(b,...w)=>{var S;b=ve.fixEvent(b,m==null?void 0:m.rtl);const C=((S=b.target.closest)==null?void 0:S.call)&&b.target.closest(d);C&&(Object.defineProperty(b,"currentTarget",{get:()=>C,configurable:!0}),v(b,...w))}}return r.thisObj&&r.autoDetach!==!1&&(f.doDestroy=ue.createInterceptor(f.doDestroy,()=>ve.removeEventListener(e,t,p),f)),p.spec={delay:s,throttled:a,block:l,once:o,thisObj:f,capture:u,expires:g,passive:c,delegate:d},p}static removeEventListener(e,t,r){const{expires:n,timerId:s,thisObj:a,capture:l}=r.spec;n!=null&&n.alt&&s&&(a!=null&&a.isDelayable?a:globalThis)[typeof n.delay=="number"?"clearTimeout":"cancelAnimationFrame"](s),e.removeEventListener(t,r,l)}static onTransitionEnd({element:e,animationName:t,property:r,handler:n,mode:s=t?"animation":"transition",duration:a=D[`get${s==="transition"?"Property":""}${P.capitalize(s)}Duration`](e,r),thisObj:l=globalThis,args:o=[],timerSource:u,runOnDestroy:c}){let d;u=u||(l.isDelayable?l:globalThis);const h=[e,r,...o],g=()=>{f(),l.isDestroyed||(l.callback?l.callback(n,l,h):n.apply(l,h))},f=ve.on({element:e,[`${s}end`]({animationName:m,propertyName:p,target:v}){var b;v===e&&(p===r||m!=null&&m.match(t))&&(d&&((b=u.clearTimeout)==null||b.call(u,d),d=null),g())}});return a!=null&&(d=u.setTimeout(g,a+50,"onTransitionEnd",c)),f}static async waitForTransitionEnd(e){return new Promise(t=>{e.handler=t,hm.onTransitionEnd(e)})}static createDblClickWrapper(e,t,r){let n,s,a;return()=>{s||(s=ve.on({element:e,touchstart:l=>{n=l.changedTouches[0].identifier,l.preventDefault()},touchend:l=>{if(l.changedTouches[0].identifier===n){l.preventDefault(),clearTimeout(a),n=s=null;const o=V.from(l.changedTouches[0].target,null,!0),u=l.changedTouches[0].pageX-o.x,c=l.changedTouches[0].pageY-o.y,d=Object.assign({browserEvent:l},l),h=new MouseEvent("dblclick",d);Object.defineProperties(h,{target:{value:l.target},offsetX:{value:u},offsetY:{value:c}}),typeof t=="string"&&(t=r[t]),t.call(r,h)}},once:!0}),a=setTimeout(()=>{s(),n=s=null},ve.dblClickTime))}}static toSpecialKey(e,t=U.isMac?"metaKey":"ctrlKey"){let r=!1;return e===!0?r=t:typeof e=="string"&&(e=e.toLowerCase(),e.match(qp)&&(r=`${e}Key`)),r}static specialKeyFromEventKey(e){return Up[e]||"no-special-key"}};y(Gc,"eventNameMap",{mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseenter:"MouseEnter",mouseleave:"MouseLeave",mousemove:"MouseMove",mouseover:"MouseOver",mouseout:"MouseOut",keyup:"KeyUp",keydown:"KeyDown",keypress:"KeyPress"});var $=Gc,ve=$;ve.longPressTime=700,ve.dblClickTime=300,U.isTouchDevice&&ve.on({element:document,touchmove:i=>{i.target.closest(".b-dragging")&&i.preventDefault()},passive:!1,capture:!0}),$._$name="EventHelper";var Gp=14,Xp={align:"t0-t0"},Dn=Node.ELEMENT_NODE,Js=Node.TEXT_NODE,{isObject:Zp}=x,Xc=/[+-]?\d*\.?\d+[eE]?-?\d*/g,ut=Xc.source,Jp=new RegExp(`matrix\\((?:${ut}),\\s?(?:${ut}),\\s?(?:${ut}),\\s?(?:${ut}),\\s?(${ut}),\\s?(${ut})`),Qp=new RegExp("matrix3d\\((?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(-?\\d*),\\s?(-?\\d*)"),Qs=new RegExp(`(?:${Jp.source})|(?:${Qp.source})`),ev=new RegExp(`translate(3d|X)?\\((${ut})px(?:,\\s?(${ut})px)?`),tv=new RegExp(`translate(3d|Y)?\\((${ut})px(?:,\\s?(${ut})px)?`),rv=/\s+/,iv=/\s*;\s*/,nv=/\s*:\s*/,sv=/^-?((\d+(\.\d*)?)|(\.?\d+))$/,av="$bryntum",lv={elementData:"",for:"htmlFor",retainElement:""},ov={tag:1,html:1,text:1,children:1,tooltip:1,style:1,dataset:1,parent:1,nextSibling:1,ns:1,reference:1,class:1,className:1,unmatched:1,onlyChildren:1,listeners:1,compareHtml:1,syncOptions:1,keepChildren:1},Zc={length:1,parentRule:1,style:1},uv={INPUT:1,TEXTAREA:1},cv={BUTTON:1,IFRAME:1,EMBED:1,INPUT:1,OBJECT:1,SELECT:1,TEXTAREA:1,BODY:1},ea=globalThis,Se=document,dv=Object.freeze({}),Fl=Array.prototype.slice,hv=Promise.resolve(),fv=["font-size","font-size-adjust","font-style","font-weight","font-family","font-kerning","font-stretch","line-height","text-transform","text-decoration","letter-spacing","word-break"],gv=i=>i._hidden,mv=i=>i.parentNode||i.host,pv=(i,e,t)=>t.key==="children"?x.mergeItems(i,e,t):x.blend(i,e,t),Ll=i=>{const e=i.ownerDocument.defaultView.getComputedStyle(i);return e.getPropertyValue("display")!=="none"&&e.getPropertyValue("visibility")!=="hidden"},Yt=i=>i&&(i===Se.body||!!i.offsetParent||(i.ownerDocument.defaultView&&"offsetParent"in i&&D.getStyleValue(i,"position")!=="fixed"?i.offsetParent:Yt(i.parentNode))),Jc=i=>i instanceof Node?i:typeof i=="string"?N.createElementFromTemplate(i):N.createElement(i),Tn=Object.create(null),Qc=(i,e)=>{const t=Tn[i]||[P.hyphenate(i),e];return Tn[i]||(Tn[t[0]]=Tn[i]=t),t},vv=i=>i.ownerSVGElement?i.ownerSVGElement.parentNode:i.offsetParent,yv=/b-slide-in-from-\w+/;["top","right","bottom","left","width","height","maxWidth","maxHeight","minWidth","minHeight","borderSpacing","borderWidth","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","letterSpacing","lineHeight","outlineWidth","textIndent","wordSpacing"].forEach(i=>Qc(i,!0));var xn=null,bv=0,br=null,$l,ed,td,D=class $s{static async slideIn(e,t=1){const r=`b-slide-in-${t>0?"next":"previous"}`,{classList:n,parentNode:{classList:s}}=e;s.add(".b-sliding-child-element"),n.add(r),await $.waitForTransitionEnd({element:e,animationName:yv}),n.remove(r),s.remove(".b-sliding-child-element")}static isFocusable(e,t=!1){if(!t&&(!N.isVisible(e)||N.Widget.fromElement(e,gv)))return!1;const r=e.nodeName;return cv[r]||(r==="A"||r==="LINK")&&!!e.href||e.getAttribute("tabIndex")!=null||e.contentEditable==="true"}static isEditable(e){return e.isContentEditable||uv[e.nodeName]}static isInView(e,t=!1,r){if(!Yt(e))return!1;const n=(r==null?void 0:r.positioned)&&$s.getStyleValue(r.element,"position")!=="fixed",s=V.from(globalThis),a=t?"contains":"intersect",l=n&&r.element.offsetParent,o=n&&V.from(l);if(s.height=Se.scrollingElement.scrollHeight,e===Se.body)return s;const u=this.getViewportIntersection(e,s,a);return u&&n&&u.translate(Se.scrollingElement.scrollLeft,Se.scrollingElement.scrollTop),n&&u?u.translate(-o.x+l.scrollLeft,-o.y+l.scrollTop):u}static getViewportIntersection(e,t,r){const{parentNode:n}=e,{parentElement:s}=n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.getRootNode().host:e,a=s.ownerDocument.defaultView.getComputedStyle(s),l=a.overflowX!=="visible"||a.overflowY!=="visible",o=vv(e);let u=V.from(e,null,!0);for(let c=l?e.parentNode:o;u&&c!==Se.documentElement;c=c.parentNode){c.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&c.host&&(c=c.host.parentNode);const d=c===Se.body,h=c.ownerDocument.defaultView.getComputedStyle(c);h.display!=="contents"&&(d||h.overflow!=="visible")&&(u=(d?t:V.client(c,null,!0,!0))[r](u,!1,!0))}return u}static isVisible(e){const t=e.ownerDocument;for(;e;e=mv(e)){if(e===t)return!0;if(e.nodeType===e.ELEMENT_NODE&&!Ll(e))return!1}return!1}static isDOMEvent(e){return e instanceof Event}static merge(e,...t){return x.blend(e,t,{merge:pv})}static normalizeChildren(e,t,r){var n;let s=e==null?void 0:e.children,a,l,o,u,c;if((n=e==null?void 0:e.syncOptions)!=null&&n.ignoreRefs&&(r=!0),s&&!(e instanceof Node))if(Array.isArray(s))for(l=0;l<s.length;++l)N.normalizeChildren(s[l],t,r);else{u=s,e.children=s=[];for(o in u)a=u[o],a!=null&&a.isWidget&&(a=a.element),c=!o.startsWith("$")&&!N.isElement(a),c&&(t==null||t(o,!r)),a&&(a instanceof Node||(a.reference===!1?delete a.reference:c&&typeof a!="string"&&(a.reference=o),N.normalizeChildren(a,t,r)),s.push(a))}return e}static roundPx(e,t=globalThis.devicePixelRatio||1){const r=1/t;return Math.round(e/r)*r}static floorPx(e,t=globalThis.devicePixelRatio||1){const r=1/t;return Math.floor(e*r)/r}static isCustomElement(e){return!!(e!=null&&e.shadowRoot)}static elementFromPoint(e,t){let r=document.elementFromPoint(e,t);return N.isCustomElement(r)&&(r=r.shadowRoot.elementFromPoint(e,t)||r),r}static childFromPoint(e,t,r,n=e){const s=r==null?t:new V(t,r,0,0);let a=null;return Array.from(e.children).reverse().some(l=>{if(V.from(l,n).contains(s))return a=l.children.length&&N.childFromPoint(l,s,null,n)||l,!0}),a}static unitize(e,t,r="px"){const[n,s]=Qc(e);return t!=null&&(t=String(t),t=s&&sv.test(t)?t+r:t),[n,t]}static get activeElement(){let e=document.activeElement;for(;e.shadowRoot;)e=e.shadowRoot.activeElement;return e}static getActiveElement(e){e!=null&&e.isWidget&&(e=e.element);let t=((e==null?void 0:e.getRootNode())||document).activeElement;for(;t!=null&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}static getRootElement(e){var t;const r=(t=e.getRootNode)==null?void 0:t.call(e),{nodeType:n}=r;return n===Node.DOCUMENT_NODE?r.body:n===Node.DOCUMENT_FRAGMENT_NODE?r:e.ownerDocument.contains(e)?e.ownerDocument.body:null}static getOutermostElement(e){var t;const r=(t=e.getRootNode)==null?void 0:t.call(e);if(r!=null&&r.body)return r==null?void 0:r.body;for(;e.parentNode!==r&&e.parentNode;)e=e.parentNode;return e}static isValidFloatRootParent(e){return e===document.body||e.constructor.name==="ShadowRoot"}static getId(e){return e.id||(e.id="b-element-"+ ++bv)}static getCommonAncestor(e,t){var r,n;if(e===t)return e;for(;e&&!((r=e[e.isWidget?"owns":"contains"])!=null&&r.call(e,t)||e===t);)e=(n=e.owner)!=null&&n.isWidget&&e.owner!==e?e.owner:e.parentNode;return e}static getElement(e){return e instanceof Element?e:Se.querySelector(e)}static setAttributes(e,t){const r=N.getElement(e);if(r&&t)for(const n in t)t[n]==null?r.removeAttribute(n):r.setAttribute(n,t[n])}static setLength(e,t,r){return arguments.length===1?r=typeof e=="number"?`${e}px`:e!=null?e:"":(e=N.getElement(e),r=e.style[t]=typeof r=="number"?`${r}px`:r!=null?r:""),r}static percentify(e,t=2){const r=Math.pow(10,t);return e==null||e===""||isNaN(e)?"":`${Math.round(e*r)/r}%`}static getChild(e,t){return e.querySelector(":scope>"+t)}static hasChild(e,t){return N.getChild(e,t)!=null}static children(e,t){return(t[0]===">"||t.startsWith("# "))&&(t[0]==="#"&&(t=t.substr(2)),t=":scope "+t),Array.from(e.querySelectorAll(t))}static getChildElementCount(e){return e.childElementCount}static down(e,t){return e?e.matches&&e.matches(t)?e:(t=":scope "+t,e.querySelector(t)):null}static isDescendant(e,t){const r=N.getRootElement(e),n=N.getRootElement(t);return n&&r!==n&&n.host?N.isDescendant(r,n.host):e.contains(t)}static getEventElement(e,t="target"){return!e||N.isElement(e)?e:e[t]}static isElement(e){return(e==null?void 0:e.nodeType)===document.ELEMENT_NODE&&N.isNode(e)}static isReactElement(e){return(e==null?void 0:e.$$typeof)===Symbol.for("react.element")}static isNode(e){return!!e&&typeof e.nodeType=="number"&&!Zp(e)}static forEachSelector(e,t,r){if(typeof e=="string")throw new Error("DomHelper.forEachSelector must provide a root element context (for shadow root scenario)");N.children(e,t).forEach(r)}static forEachChild(e,t){Array.from(e.children).forEach(t)}static removeEachSelector(e,t){N.forEachSelector(e,t,r=>r.remove())}static removeClsGlobally(e,...t){t.forEach(r=>N.forEachSelector(e,"."+r,n=>n.classList.remove(r)))}static up(e,t){return ie.deprecate("Core","6.0.0","DomHelper.up() deprecated, use native `element.closest()` instead"),e.closest(t)}static getAncestor(e,t,r=null){let n=!1,s,a=e;for(t=z.asArray(t);a=a.parentElement;){if(t.includes(a)){n=!0;break}if(r&&a===r)break;s=a}return n?s||e:null}static getParents(e){const t=[];for(;e.parentElement;)t.push(e.parentElement),e=e.parentElement;return t}static makeValidId(e,t=""){return P.makeValidDomId(e,t)}static createElement(e={},t){var r,n;let s=t,a,l,o,u,c,d,h,g,f,m,p;if(typeof s=="boolean")throw new Error("Clean up");t&&(c=t.ignoreRefs,f=t.refOwner,m=t.refs,s=t.returnAll,p=t.syncIdField,c&&(o=!0,c=c!=="children")),typeof e.parent=="string"&&(e.parent=document.getElementById(e.parent));const v=e.parent||e.nextSibling&&e.nextSibling.parentNode,{dataset:b,html:w,reference:S,syncOptions:C,text:T}=e;if(C&&(p=C.syncIdField||p,u=C.ignoreRefs,u&&(o=!0,c=u!=="children",t={...t,ignoreRefs:!0})),c&&(f=null),e.ns?a=Se.createElementNS(e.ns,e.tag||"svg"):a=Se.createElement(e.tag||"div"),T!=null?N.setInnerText(a,T):w!=null&&(w instanceof DocumentFragment?a.appendChild(w):a.innerHTML=w),e.tooltip&&N.Widget.attachTooltip(a,e.tooltip),e.style&&N.applyStyle(a,e.style),b)for(h in b)g=b[h],g!=null&&(a.dataset[h]=g);v&&this.addChild(v,a,e.nextSibling),f&&(a.$refOwnerId=f.id),S&&!c&&(f?(a.$reference=S,f.attachRef(S,a,e)):(m||(t=Object.assign({},t),t.refs=m={}),m[S]=a,a.setAttribute("data-reference",S)));const E=e.className||e.class,I=Object.keys(e);for(E&&a.setAttribute("class",J.normalize(E)),l=0;l<I.length;++l)h=I[l],g=e[h],(d=lv[h])!=null?a[d||h]=g:!ov[h]&&h&&g!=null&&a.setAttribute(h,g);!e["aria-hidden"]&&!e.role&&!e.tabIndex&&!$s.isFocusable(a,!0)&&!a.htmlFor&&a.setAttribute("role","presentation"),(n=t==null?void 0:t.callback)==null||n.call(t,{action:"newElement",domConfig:e,targetElement:a,syncId:f?S:t.syncIdField&&((r=e.dataset)==null?void 0:r[t.syncIdField])}),s===!0?t.returnAll=s=[a]:Array.isArray(s)&&s.push(a),e.children&&(p&&(a.syncIdMap={}),e.children.forEach(M=>{var O,A,B;if(M)if(typeof M=="string"){const L=document.createTextNode(M);f&&(L.$refOwnerId=f.id),a.appendChild(L)}else if(isNaN(M.nodeType)){M.parent=a,!M.ns&&e.ns&&(M.ns=e.ns);const L=N.createElement(M,{...t,ignoreRefs:(A=(O=e.syncOptions)==null?void 0:O.ignoreRef)!=null?A:o}),Y=(B=M.dataset)==null?void 0:B[p];Y!=null&&(a.syncIdMap[Y]=L),delete M.parent}else a.appendChild(M)})),a.lastDomConfig=e;const R=m||s||a;return e.replaceElement&&e.replaceElement.replaceWith(R),R}static createElementFromTemplate(e,t=dv){const{array:r,raw:n,fragment:s}=t;let a;if(N.supportsTemplate){if(($l||($l=Se.createElement("template"))).innerHTML=e,a=$l.content,s)return a.cloneNode(!0)}else if(a=(ed||(ed=new DOMParser)).parseFromString(e,"text/html").body,s){const l=a.childNodes;for(a=document.createDocumentFragment();l.length;)a.appendChild(l[0]);return a}return n?a=a.childNodes:a=a.children,a.length===1&&!r?a[0]:Fl.call(a)}static triggerMouseEvent(e,t="contextmenu"){const r=this.isInView(e),n=r||V.from(e),s=n.center,a=new MouseEvent(t,{clientX:s.x,clientY:s.y,bubbles:!0});e.dispatchEvent(a)}static insertFirst(e,t){return t&&t.nodeType!==Dn&&t.tag&&(t=N.createElement(t)),e.insertBefore(t,e.firstElementChild)}static insertBefore(e,t,r){return t&&t.nodeType!==Dn&&t.tag&&(t=N.createElement(t)),r?e.insertBefore(t,r):N.insertFirst(e,t)}static insertAt(e,t,r){const n=Array.from(e.children);if(r>=n.length)return N.append(e,t);const s=n[r];return N.insertBefore(e,t,s)}static append(e,t){if(t.forEach){if(Array.isArray(t)&&(t=t.map(r=>Jc(r))),e.append)e.append(...t);else{const r=document.createDocumentFragment();t.forEach(function(n){r.appendChild(n)}),e.appendChild(r)}return t}else return e.appendChild(Jc(t))}static getTranslateX(e){const t=e.style.transform;let r=ev.exec(t);return r?parseFloat(r[2]):(r=Qs.exec(t)||Qs.exec(N.getStyleValue(e,"transform")),r?parseFloat(r[1]||r[3]):0)}static getTranslateY(e){const t=e.style.transform;let r=tv.exec(t);if(r){const n=parseFloat(r[r[1]==="Y"?2:3]);return isNaN(n)?0:n}else return r=Qs.exec(t)||Qs.exec(N.getStyleValue(e,"transform")),r?parseFloat(r[2]||r[4]):0}static getTranslateXY(e){return[N.getTranslateX(e),N.getTranslateY(e)]}static getOffsetX(e,t=null){return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:e.offsetLeft}static getOffsetY(e,t=null){return t?e.getBoundingClientRect().top-t.getBoundingClientRect().top:e.offsetTop}static getOffsetXY(e,t=null){return[N.getOffsetX(e,t),N.getOffsetY(e,t)]}static focusWithoutScrolling(e){function t(n){n.forEach(({element:s,scrollLeft:a,scrollTop:l})=>{s.scrollLeft!==a&&(s.scrollLeft=a),s.scrollTop!==l&&(s.scrollTop=l)})}if(!U.isSafari)e.focus({preventScroll:!0});else{const n=N.getParents(e),s=n.map(a=>({element:a,scrollLeft:a.scrollLeft,scrollTop:a.scrollTop}));e.focus(),setTimeout(()=>t(s),0)}}static getPageX(e){return e.getBoundingClientRect().left+ea.pageXOffset}static getPageY(e){return e.getBoundingClientRect().top+ea.pageYOffset}static getExtremalSizePX(e,t){const r=P.hyphenate(t),n=r.split("-")[1];let s=N.getStyleValue(e,r);return/%/.test(s)?e.parentElement?s=parseInt(N.getStyleValue(e.parentElement,n),10):s=NaN:s=parseInt(s,10),s}static setScale(e,t,r=t){const n=N.getStyleValue(e,"transform").split(/,\s*/);n.length>1?(n[0].startsWith("matrix3d")?(n[0]=`matrix3d(${t}`,n[5]=r):(n[0]=`matrix(${t}`,n[3]=r),e.style.transform=n.join(",")):e.style.transform=`scale(${t}, ${r})`}static setTranslateX(e,t){const r=N.getStyleValue(e,"transform").split(/,\s*/);t=N.roundPx(t),r.length>1?(r[r[0].startsWith("matrix3d")?12:4]=t,e.style.transform=r.join(",")):e.style.transform=`translateX(${t}px)`}static setTranslateY(e,t){const r=N.getStyleValue(e,"transform").split(/,\s*/);t=N.roundPx(t),r.length>1?(r[r[0].startsWith("matrix3d")?13:5]=t,e.style.transform=r.join(",")+")"):e.style.transform=`translateY(${t}px)`}static setTop(e,t){N.setLength(e,"top",t)}static setLeft(e,t){N.setLength(e,"left",t)}static setTopLeft(e,t,r){N.setLength(e,"top",t),N.setLength(e,"left",r)}static setRect(e,{x:t,y:r,width:n,height:s}){N.setTopLeft(e,r,t),N.setLength(e,"width",n),N.setLength(e,"height",s)}static setTranslateXY(e,t,r){if(t==null)return N.setTranslateY(e,r);if(r==null)return N.setTranslateX(e,t);t=N.roundPx(t),r=N.roundPx(r);const n=N.getStyleValue(e,"transform").split(/,\s*/),s=n[0].startsWith("matrix3d");n.length>1?(n[s?12:4]=t,n[s?13:5]=r,e.style.transform=n.join(",")+")"):e.style.transform=`translate(${t}px, ${r}px)`}static addTranslateX(e,t){N.setTranslateX(e,N.getTranslateX(e)+t)}static addTranslateY(e,t){N.setTranslateY(e,N.getTranslateY(e)+t)}static addLeft(e,t){N.setLeft(e,N.getOffsetX(e)+t)}static addTop(e,t){N.setTop(e,N.getOffsetY(e)+t)}static alignTo(e,t,r=Xp,n){t=t instanceof V?t:V.from(t,!0);const s=N.getTranslateXY(e),a=V.from(e,!0);n&&(a.roundPx(),t.roundPx());const l=a.alignTo(Object.assign(r,{target:t}));N.setTranslateXY(e,s[0]+l.x-a.x,s[1]+l.y-a.y)}static getStyleValue(e,t,r,n){const s=r?e.style:e.ownerDocument.defaultView.getComputedStyle(e,n);if(Array.isArray(t)){const a={};for(const l of t)a[l]=s.getPropertyValue(P.hyphenate(l));return a}return s.getPropertyValue(P.hyphenate(t))}static getEdgeSize(e,t,r){const n=t==="border"?"-width":"",s={raw:{}};for(const a of["top","right","bottom","left"])(!r||r.includes(a[0]))&&(s[a]=parseFloat(s.raw[a]=N.getStyleValue(e,`${t}-${a}${n}`)));return s.width=(s.left||0)+(s.right||0),s.height=(s.top||0)+(s.bottom||0),s}static parseStyle(e){if(typeof e=="string"){const t=e.split(iv);e={};for(let r=0,{length:n}=t;r<n;r++){const s=t[r].split(nv);e[s[0]]=s[1]}}return e||{}}static applyStyle(e,t,r=!1){if(typeof t=="string")r?(t.length||e.style.cssText.length)&&(e.style.cssText=t):e.style.cssText+=t;else if(t){r&&(e.style.cssText=""),t.style&&typeof t.style!="string"&&(t=x.assign({},t,t.style));let n,s;for(n in t)Zc[n]||([n,s]=N.unitize(n,t[n]),s==null?e.style.removeProperty(n):e.style.setProperty(n,s));typeof t.style=="string"&&(e.style.cssText+=t.style)}}static getCSSText(e){if(typeof e=="string")return e;let t="";for(const r in e)Zc[r]||(t+=`${P.hyphenate(r)}:${e[r]};`);return t}static addClasses(e,t){ie.deprecate("Core","6.0.0","DomHelper.addClasses should be replaced by native classList.add"),e.classList.add(...t)}static removeClasses(e,t){ie.deprecate("Core","6.0.0","DomHelper.removeClasses should be replaced by native classList.remove"),e.classList.remove(...t)}static toggleClasses(e,t,r=null){t=z.asArray(t),r===!0?e.classList.add(...t):r===!1?e.classList.remove(...t):t.forEach(n=>e.classList.toggle(n))}static addTemporaryClass(e,t,r,n=globalThis,s=t){r>0&&(e.classList.add(t),n.setTimeout({fn:a=>e.classList.remove(a),delay:r,name:s,args:[t],cancelOutstanding:!0}))}static getPropertyTransitionDuration(e,t){const r=globalThis.getComputedStyle(e),n=r.transitionProperty.split(", "),s=r.transitionDuration.split(", "),a=n.indexOf(P.hyphenate(t));let l;return a!==-1&&(l=parseFloat(s[a])*1e3),l}static getAnimationDuration(e){return parseFloat(N.getStyleValue(e,"animation-duration"))*1e3}static highlight(e,t=globalThis){return e instanceof V?e.highlight():new Promise(r=>{t.setTimeout(()=>{e.classList.add("b-fx-highlight"),t.setTimeout(()=>{e.classList.remove("b-fx-highlight"),r()},1e3)},0)})}static get scrollBarWidth(){if(xn===null){const e=td||(td=N.createElement({parent:Se.documentElement,className:"b-scrollbar-measure-element",style:"position:absolute;top:-9999em;height:100px;overflow-y:scroll"}));e.parentNode!==Se.documentElement&&Se.documentElement.appendChild(e),xn=e.offsetWidth}return xn}static get scrollBarPadElement(){return{className:"b-yscroll-pad",children:[{className:"b-yscroll-pad-sizer"}]}}static resetScrollBarWidth(){xn=null}static measureText(e,t,r=!1,n=void 0){const s=N.getMeasureElement(t,n);s[r?"innerHTML":"innerText"]=e;const a=s.clientWidth;return s.className="",a}static measureSize(e,t,r=!0){if(!e)return 0;if(typeof e=="number")return e;if(!e.length)return 0;if(/^\d+(px)?$/.test(e))return parseInt(e);if(t){const n=N.getMeasureElement(t);n.innerHTML="",n.style.width=N.setLength(e);const s=r?n.offsetWidth:n.getBoundingClientRect().width;return n.style.width=n.className="",s}return/^\d+em$/.test(e)?parseInt(e)*Gp:isNaN(e)?0:parseInt(e)}static getMeasureElement(e,t=Se.body){const r=ea.getComputedStyle(e),n=t.offScreenDiv=t.offScreenDiv||N.createElement({parent:t,style:"position:fixed;top:-10000px;left:-10000px;visibility:hidden;contain:strict",className:"b-measure-element",children:[{style:"white-space:nowrap;display:inline-block;will-change:contents;width:auto;contain:none"}]},{returnAll:!0})[1];return fv.forEach(s=>{n.style[s]!==r[s]&&(n.style[s]=r[s])}),n.className=e.className,n.parentElement.parentElement!==t&&t.appendChild(n.parentElement),n}static stripTags(e){return(N.$domParser||(N.$domParser=new DOMParser)).parseFromString(e,"text/html").body.textContent}static sync(e,t){if(typeof e=="string")if(e===""){t.innerHTML="";return}else e=N.createElementFromTemplate(e);return N.performSync(e,t),t}static performSync(e,t){return e.outerHTML!==t.outerHTML?(N.syncAttributes(e,t),N.syncContent(e,t),N.syncChildren(e,t),!0):!1}static getSyncAttributes(e){const t={},r=[];for(let n=0;n<e.attributes.length;n++){const s=e.attributes[n];if(s.specified){const a=s.name.toLowerCase();t[a]=s.value,r.push(a)}}return{attributes:t,names:r}}static syncAttributes(e,t){const{attributes:r,names:n}=N.getSyncAttributes(e),{attributes:s,names:a}=N.getSyncAttributes(t),l=n.includes("dataset"),o=n.filter(d=>!a.includes(d)),u=a.filter(d=>!n.includes(d)&&(!l||!d.startsWith("data-"))),c=n.filter(d=>a.includes(d));if(o.length>0)for(let d=0;d<o.length;d++){const h=o[d];h==="style"?N.applyStyle(t,r.style,!0):h==="dataset"?Object.assign(t.dataset,r.dataset):t.setAttribute(h,r[h])}if(u.length>0)for(let d=0;d<u.length;d++)t.removeAttribute(u[d]);if(c.length>0)for(let d=0;d<c.length;d++){const h=c[d];if(h==="style")N.applyStyle(t,r.style,!0);else if(h==="dataset")Object.assign(t.dataset,r.dataset);else if(h==="class"&&(r.class.isDomClassList||typeof r.class=="object")){let g;r.class.isDomClassList?g=r.class:g=new J(r.class),g.isEqual(s.class)||t.setAttribute("class",g)}else s[h]!==r[h]&&t.setAttribute(h,r[h])}}static syncContent(e,t){N.getChildElementCount(e)===0&&(t.innerText=e.innerText)}static setInnerText(e,t){const{firstChild:r}=e;(r==null?void 0:r.nodeType)===Element.TEXT_NODE?r.data=t:e.textContent=t}static syncChildren(e,t){const r=this,n=Fl.call(e.childNodes),s=Fl.call(t.childNodes);for(;n.length;){const a=n.shift(),l=s.shift();if(a&&a.nodeType!==Js&&a.nodeType!==Dn)throw new Error(`Source node type ${a.nodeType} not supported by DomHelper.sync()`);if(l&&l.nodeType!==Js&&l.nodeType!==Dn)throw new Error(`Target node type ${l.nodeType} not supported by DomHelper.sync()`);if(!l)t.appendChild(a);else if(a.nodeType===l.nodeType)a.nodeType===Js?l.data=a.data:a.tagName===l.tagName?r.performSync(a,l):(t.insertBefore(a,l),l.remove());else if(a.nodeType===Js&&l.nodeType===Dn)t.innerText=a.data.trim();else{const o=a.parentElement||a;throw new Error(`Currently no support for transforming nodeType.
${o.outerHTML}`)}}s.forEach(a=>{a.remove()})}static syncClassList(e,t){const{classList:r}=e,n=typeof t=="string",s=n?t.split(rv):J.normalize(t,"array"),a=s.length;let l=r.length!==a,o;for(o=0;!l&&o<a;o++)l=!r.contains(s[o]);return l&&(e.className=n?t:s.join(" ")),l}static updateClassList(e,t){const{classList:r}=e;let n,s,a=!1;for(n in t)s=!!t[n],r.contains(n)!==s&&(r[s?"add":"remove"](n),a=!0);return a}static setTheme(e,t){e=e.toLowerCase();const{head:r}=document,n=N.getThemeInfo(t).name.toLowerCase();let s=r.querySelectorAll("[data-bryntum-theme]:not([data-loading])"),a=0;if(n===e)return hv;N.removeEachSelector(r,"#bryntum-theme[data-loading],link[data-bryntum-theme][data-loading]");const l={theme:e,prev:n};function o(u,c,d){const h=$s.createElement({tag:"link",rel:"stylesheet",dataset:{loading:!0,bryntumTheme:!0},href:u.href.replace(n,e),nextSibling:u});h.addEventListener("load",()=>{delete h.dataset.loading,br=null,++a===s.length&&(s.forEach(g=>g.remove()),Me.trigger("theme",l),c(l))}),h.addEventListener("error",g=>{delete h.dataset.loading,d(g)})}if(s.length)return new Promise((u,c)=>{s.forEach((d,h)=>{o(d,u,c,h===s.length-1)})});{const u=r.querySelector("#bryntum-theme:not([data-loading])")||r.querySelector(`[href*="${n}.css"]:not([data-loading])`);if(!(u!=null&&u.href.includes(`${n}.css`)))throw new Error(`Theme link for ${n} not found`);return s=[u],new Promise((c,d)=>o(u,c,d))}}static get themeInfo(){return $s.getThemeInfo()}static getThemeInfo(e){if(!br){const t=N.createElement({parent:document.body,className:"b-theme-info"}),r=N.getStyleValue(t,"content",!1,":before");if(r)try{br=JSON.parse(r.replace(/^["']|["']$|\\/g,""))}catch(n){br=null}br=br||(e?{name:e}:null),t.remove()}return br}static async transition({element:e,selector:t="[data-dom-transition]",duration:r,action:n,thisObj:s=this,addTransition:a={},removeTransition:l={}}){const o=new Set,u=Array.from(e.querySelectorAll(t)),c=new Map(u.map(f=>{let m=0,p=f.parentElement;for(;p&&p!==e;)m++,p=p.parentElement;f.$depth=m,f.scrollHeight>f.offsetHeight&&getComputedStyle(f).overflow==="auto"&&(f.$scrollTop=f.scrollTop,o.add(f));const{parentElement:v}=f,b=V.from(f,e),w=V.from(f,v),S=getComputedStyle(v),C=parseFloat(S.borderLeftWidth);return C&&(b.left-=C,w.left-=C),[f.id,{element:f,globalBounds:b,localBounds:w,depth:m,parentElement:v}]}));n.call(s);const d=Array.from(e.querySelectorAll(t)),h=new Map(d.map(f=>{const m=V.from(f,e),p=V.from(f,f.parentElement),v=globalThis.getComputedStyle(f.parentElement),b=parseFloat(v.borderLeftWidth);return b&&(m.left-=b,p.left-=b),[f.id,{element:f,globalBounds:m,localBounds:p}]})),g=["position","top","left","width","height","padding","margin","zIndex","minWidth","minHeight","opacity","overflow"];for(const[f,m]of c){const p=h.get(f);if(p){const{element:v}=p,{style:b,parentElement:w}=v,S=parseInt(N.getStyleValue(v,"zIndex")),{globalBounds:C,localBounds:T,depth:E,parentElement:I}=m,R=I!==w;x.copyProperties(v.$initial={parentElement:w},b,g);let M;R?(p.bounds=p.globalBounds,M=C,e.appendChild(v)):(p.bounds=p.localBounds,M=T,I.appendChild(v));let O="hidden";o.has(v)&&(v.$scrollPlaceholder=N.createElement({parent:v,style:{height:v.scrollHeight}}),O="auto");const A={position:"absolute",top:`${M.top}px`,left:`${M.left}px`,width:`${M.width}px`,height:`${M.height}px`,minWidth:0,minHeight:0,margin:0,zIndex:E+(S||0),overflow:O};v.dataset.domTransition!=="preserve-padding"&&(A.padding=0),Object.assign(b,A),p.processed=!0}else{const{element:v,localBounds:b,depth:w,parentElement:S}=m;v.$initial={removed:!0},Object.assign(v.style,{position:"absolute",top:`${b.top}px`,left:`${b.left}px`,width:`${b.width}px`,height:`${b.height}px`,minWidth:0,minHeight:0,padding:0,margin:0,zIndex:w,overflow:"hidden"}),S.appendChild(v),h.set(f,{element:v,bounds:b,removed:!0,processed:!0}),d.push(v)}}for(const[,f]of h)if(!f.processed){const{element:m}=f,{style:p,parentElement:v}=m,b=f.bounds=f.localBounds;m.classList.add("b-dom-transition-adding"),x.copyProperties(m.$initial={parentElement:v},p,g),Object.assign(p,{position:"absolute",top:a.top?0:`${b.top}px`,left:a.left?0:`${b.left}px`,width:a.width?0:`${b.width}px`,height:a.height?0:`${b.height}px`,opacity:a.opacity?0:null,zIndex:v.$depth+1,overflow:"hidden"})}for(const f of o)f.scrollTop=f.$scrollTop;e.classList.add("b-dom-transition"),e.firstElementChild.offsetWidth;for(const[,{element:f,bounds:m,removed:p}]of h)p?Object.assign(f.style,{top:l.top?0:`${m.top}px`,left:l.left?0:`${m.left}px`,width:l.width?0:`${m.width}px`,height:l.height?0:`${m.height}px`,opacity:l.opacity?0:f.$initial.opacity}):Object.assign(f.style,{top:`${m.top}px`,left:`${m.left}px`,width:`${m.width}px`,height:`${m.height}px`,opacity:f.$initial.opacity});await Us.sleep(r),e.classList.remove("b-dom-transition");for(const f of d)f.$initial&&(f.$initial.removed?f.remove():(x.copyProperties(f.style,f.$initial,g),f.$scrollPlaceholder&&(f.$scrollPlaceholder.remove(),delete f.$scrollPlaceholder),f.classList.remove("b-dom-transition-adding"),f.$initial.parentElement.appendChild(f)));for(const f of o)f.scrollTop=f.$scrollTop,delete f.$scrollTop}static async loadScript(e){return new Promise((t,r)=>{const n=document.createElement("script");n.src=e,n.onload=t,n.onerror=r,document.head.appendChild(n)})}static isNamedColor(e){return e&&!/^(#|hsl|rgb|hwb|lab|lch|oklab|oklch)/.test(e)}static createColorStyle(e){return e!=null&&e.length?this.isNamedColor(e)?`var(--cal-color-${e})`:e:""}static get NodeFilter(){return NodeFilter}static addChild(e,t,r){e.insertBefore(t,r)}static cloneStylesIntoShadowRoot(e,t){return new Promise((r,n)=>{t&&e.querySelectorAll('style, link[rel="stylesheet"]').forEach(l=>l.remove());const s=document.querySelectorAll('link[rel="stylesheet"]');let a=0;s.forEach(l=>{const o=l.cloneNode();o.addEventListener("load",()=>{a+=1,a===s.length&&r()}),o.addEventListener("error",u=>{n(o.href)}),e.appendChild(o)}),document.querySelectorAll("style").forEach(l=>{const o=l.cloneNode();o.innerText=l.innerText,e.appendChild(o)}),s.length||r()})}},N=D,rd,Cv=()=>N.isTouchEvent=!1,id=()=>{N.isTouchEvent=!0,clearTimeout(rd),rd=setTimeout(Cv,400)};if(Se.addEventListener("touchstart",id,!0),Se.addEventListener("touchend",id,!0),N.canonicalStyles=Tn,N.supportsTemplate="content"in Se.createElement("template"),N.elementPropKey=av,N.numberRe=Xc,!("children"in Node.prototype)){const i=e=>e.nodeType===e.ELEMENT_NODE;Object.defineProperty(Node.prototype,"children",{get:function(){return Array.prototype.filter.call(this.childNodes,i)}})}Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(i){const e=(this.document||this.ownerDocument).querySelectorAll(i);let t=e.length;for(;--t>=0&&e.item(t)!==this;);return t>-1}),ea.Element&&!Element.prototype.closest?Node.prototype.closest=Element.prototype.closest=function(i){let e=this;if(!Se.documentElement.contains(e))return null;do{if(e.matches(i))return e;e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===e.ELEMENT_NODE);return null}:Node.prototype.closest=function(i){var e;return(e=this.parentNode)==null?void 0:e.closest(i)},function(i){i.forEach(function(e){Object.prototype.hasOwnProperty.call(e,"remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),globalThis.addEventListener("resize",()=>xn=null),D._$name="DomHelper";var Sv=5,wv=i=>i.floating,Dv={touchend:1,pointerup:1},Tv={Meta:1,Control:1,Alt:1},ct=new class extends F.mixin(fe){suspendFocusEvents(){ta=!0}resumeFocusEvents(){ta=!1}setupFocusListenersOnce(e,t){e&&!ct.observedElements.has(e)&&(ct.setupFocusListeners(e,t),ct.observedElements.add(e))}detachFocusListeners(e){e.$globalEventsDetacher&&(e.$globalEventsDetacher(),e.$globalEventsDetacher=null,ct.observedElements.delete(e))}setupFocusListeners(e=document,t,r=!1){const n={element:e,touchstart(s){if(!et&&s.changedTouches.length===1){if(et=s.changedTouches[0],!U.isAndroid){const a=({clientX:u,clientY:c,type:d})=>{(Dv[d]||Math.max(Math.abs(u-et.clientX),Math.abs(c-et.clientY))>Sv)&&(Nl=null,l(),clearTimeout(o))},l=t.on({element:document,touchmove:a,touchend:a,pointermove:a,pointerup:a,capture:!0}),o=setTimeout(()=>{Nl=et.identifier,l(),s.target.dispatchEvent(new MouseEvent("contextmenu",t.copyEvent({},s)))},t.longPressTime)}}else et=null},touchend:{handler:s=>{et&&(s.changedTouches[0].identifier===Nl?(s.stopImmediatePropagation(),s.cancelable!==!1&&s.preventDefault()):s.changedTouches.length===1&&s.changedTouches[0].identifier===et.identifier&&ct.trigger("globaltap",{event:s}),et=null)},passive:!1},mousedown:{handler:s=>{ra="mouse",et||ct.trigger("globaltap",{event:s}),Cr=s;const a=s.ctrlKey||s.altKey||s.shiftKey||s.metaKey;!pe&&a?pe=new KeyboardEvent("keydown",{key:s.ctrlKey?"Control":s.shiftKey?"Shift":s.altKey?"Alt":"Meta",ctrlKey:s.ctrlKey,altKey:s.altKey,shiftKey:s.shiftKey,metaKey:s.metaKey}):pe&&!a&&(pe=null)},passive:!1},mouseup(){Cr=null},pointerdown:{passive:!1,handler:s=>{var a;En=s,D.usingKeyboard=!1,(a=e.classList)==null||a.remove("b-using-keyboard"),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&D.removeClsGlobally(e,"b-using-keyboard")}},pointerup:{passive:!1,handler:s=>{(En==null?void 0:En.pointerId)===s.pointerId&&(En=null)}},keydown(s){if(ra="key",pe=s,Bl=s.target,!Tv[s.key])if(D.usingKeyboard=!0,e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(const a of e.children)a.matches(".b-outer")&&a.classList.add("b-using-keyboard");else e.classList.add("b-using-keyboard")},mouseenter(s){Bl=s.target},keypress(){ra="key"},keyup(){pe=null},focusin(s){var a,l,o;const{Widget:u}=ct;if((a=s.target)!=null&&a.shadowRoot||(l=s.target)!=null&&l._shadowRoot||(u.resetFloatRootScroll(),ta))return;const c=s.relatedTarget?s.relatedTarget instanceof HTMLElement?s.relatedTarget:document.body:null,d=s.target||document.body,h=u.fromElement(c),g=u.fromElement(d),f=D.getCommonAncestor(h,g),m=!!(c&&d.compareDocumentPosition(c)&4),p=u.query(xv);let v=null;if(d&&d!==document.body?v=D.getActiveElement(d):v=D.getActiveElement(document),p&&!p._isRevertingFocus&&(!g||!p.owns(g)&&!(p.element.compareDocumentPosition(g.element)&4&&g.up(wv))))return p.focus();let b=jl("focusout",c,s.target,h,g,m);for(let S=h,C;S&&S!==f;S=C)if(C=S.owner,!S.isDestroying&&S.onFocusOut&&(S.onFocusOut(b),s.target&&v!==D.getActiveElement(s.target)))return;if(f&&s.target===f.element)!f.isDestroying&&D.getActiveElement(f)===d&&f.focusElement&&f.focusElement!==f.element&&(!f.element.contains(v)||f.focusDescendant)&&f.setTimeout(()=>{var S;return(S=f.focus)==null?void 0:S.call(f)},0);else{b=jl("focusin",d,c,h,g,m);for(let S=g;S&&S!==f;S=S.owner)S.isDestroying||(o=S.onFocusIn)==null||o.call(S,b)}const w=D.getCommonAncestor((c==null?void 0:c.nodeType)===Element.ELEMENT_NODE?c:null,d)||d.parentNode;w&&(b=jl("focusmove",d,c,h,g,m,{bubbles:!0}),w.dispatchEvent(b))},focusout(s){if(!ta&&(!s.relatedTarget||!ct.Widget.fromElement(s.relatedTarget))){const a=s.relatedTarget&&s.relatedTarget instanceof HTMLElement?s.relatedTarget:null;n.focusin({target:a,relatedTarget:s.target}),pe=Cr=null}},blur:{element:globalThis,handler(s){s.target===globalThis&&(pe=null,Cr=null)}},capture:!0,passive:!0};r&&(Vl==null||Vl()),Vl=this.detachEvents=e.$globalEventsDetacher=t.on(n)}get lastInteractionType(){return ra}get shiftKeyDown(){return pe==null?void 0:pe.shiftKey}get ctrlKeyDown(){return(pe==null?void 0:pe.ctrlKey)||(pe==null?void 0:pe.metaKey)}get altKeyDown(){return pe==null?void 0:pe.altKey}get currentOverElement(){return Bl}isKeyDown(e){return e?(pe==null?void 0:pe.key)===e||pe[(e==null?void 0:e.toLowerCase())+"Key"]===!0:!!pe}isMouseDown(e=0){return(Cr==null?void 0:Cr.button)===e}get currentMouseDown(){return Cr}get currentPointerDown(){return En}get currentTouch(){return et}get currentKeyDown(){return pe}},xv=i=>i.isVisible&&i.isTopModal;ct.observedElements=new Set;var et,Nl,ta=!1,ra,pe,Cr,En,Bl,Vl;function jl(i,e,t,r,n,s,a){const l=new CustomEvent(i,a);return Object.defineProperty(l,"_target",{get(){return e}}),Object.defineProperty(l,"relatedTarget",{get(){return t}}),l.fromWidget=r,l.toWidget=n,l.backwards=s,l}var Me=ct;function Ev(i,e){const t=x.getPropertyDescriptor(i,e);return t&&(t.get||t.set)?t:null}var Ut=class extends F.mixin(fe,bn){static get configurable(){return{clientListeners:null,disabled:!1,client:null,keyMap:null}}updateClient(i){this.owner||(this.owner=i)}updateKeyMap(i){const{client:e}=this;e.keyMap=e.mergeKeyMaps(e.keyMap,i,P.uncapitalize(this.constructor.$name))}static initPlugins(i,...e){const t=i.plugins||(i.plugins={});for(const r of e)t[r.$$name]=new r(i)}get enabled(){return!this.disabled}getFocusRevertTarget(){var i;return(i=this.client)==null?void 0:i.getFocusRevertTarget()}construct(...i){const e=this;let[t,r]=i,n;i.length===1?x.isObject(t)&&(r=t,t=r.client):(r=x.assign({},r),delete r.client),e.client=t,super.construct(r),e.applyPluginConfig(t),n=e.clientListeners,n&&(n=x.assign({},n),n.thisObj=e,t.ion(n))}applyPluginConfig(i){const e=this,t=e.pluginConfig||e.constructor.pluginConfig;if(t){const{assign:r,chain:n,after:s,before:a,override:l}=t;r&&e.applyAssign(i,r),(n||s)&&e.applyChain(i,n||s),a&&e.applyChain(i,a,!1),l&&e.applyOverride(i,l)}}applyAssign(i,e){e.forEach(t=>this.assign(i,t))}applyChain(i,e,t=!0){if(Array.isArray(e))for(const r of e)this.chain(i,r,r,t);else for(const r in e)this.chain(i,r,e[r],t)}applyOverride(i,e){const t=this;t.overridden||(t.overridden={}),e.forEach(r=>{if(!t[r])throw new Error(`Trying to chain fn ${i.$$name}#${r}, but plugin fn ${t.$$name}#${r} does not exist`);typeof i[r]=="function"&&(t.overridden[r]=i[r].bind(i)),i[r]=t[r].bind(t)})}assign(i,e){const t=this,r=Ev(t,e);r?Object.defineProperty(i,e,{configurable:!0,enumerable:!0,get:r.get&&r.get.bind(t),set:r.set&&r.set.bind(t)}):i[e]=t[e].bind(t)}chain(i,e,t,r=!0){let n=0;typeof e=="object"&&(e=e.fn),typeof t=="object"&&(n=t.prio||0,t=t.fn);const s=this,a=i.pluginFunctionChain||(i.pluginFunctionChain={}),l=s[t]&&s[t].bind(s),o=s.functionChainRunner;if(!l)throw new Error(`Trying to chain fn ${i.$$name}#${t}, but plugin fn ${s.$$name}#${t} does not exist`);if(!a[e]){let u=i[e];u&&(u=u.bind(i),u.$this=i,u.$prio=0),a[e]=u?[u]:[],i[e]=(...c)=>o(a[e],c)}l.$this=s,l.$prio=n,a[e][r?"push":"unshift"](l),a[e].$sorted=!1}functionChainRunner(i,e){let t,r,n;for(i.$sorted||(i.sort((s,a)=>a.$prio-s.$prio),i.$sorted=!0),r=0;r<i.length&&(t=i[r],!(!t.$this.isDestroyed&&(n=t(...e),n===!1)));r++);return n}doDisable(i){var e,t,r,n;const s=this,{constructor:a}=s,l="featureClass"in a?a.featureClass:`b-${a.$$name.toLowerCase()}`,o=P.uncapitalize(a.$$name);l&&((t=(e=s.client)==null?void 0:e._element)==null||t.classList[i?"remove":"add"](l)),s.isConfiguring||(i?s.trigger("disable"):s.trigger("enable"),(n=(r=s.client).syncSplits)==null||n.call(r,u=>{const c=u.features[o];c&&(c.disabled=i)}))}updateDisabled(i){this.doDisable(i)}throwOverrideIsMissing(i){throw new Error(`Trying to override fn ${i.plugIntoName}#${i.fnName}, but plugin fn ${i.pluginName}#${i.fnName} does not exist`)}get rootElement(){return this.client.rootElement}};y(Ut,"$name","InstancePlugin"),Ut._$name="InstancePlugin";var zl=i=>class extends(i||F){static get $name(){return"Pluggable"}get plugins(){return this._plugins||(this._plugins={}),this._plugins}set plugins(t){t&&(Array.isArray(t)||(t=[t]),Ut.initPlugins(this,...t)),this.initPlugins()}initPlugins(){}addPlugins(...t){Ut.initPlugins(this,...t)}hasPlugin(t){return this.getPlugin(t)!=null}getPlugin(t){var r;return typeof t=="function"&&(t=t.$$name),(r=this.plugins)==null?void 0:r[t]}get widgetClass(){}},{defineProperty:Wl}=Reflect,ia;U.isBrowserEnv?ia=globalThis.performance:ia={now(){return new Date().getTime()}};var ee=null;if(ie.isTestEnv){const i=globalThis.bryntum||(globalThis.bryntum={});ee=i.globalDelays={timeouts:new Map,intervals:new Map,animationFrames:new Map,idleCallbacks:new Map,isEmpty(e=!1){return ee.timeouts.size+ee.animationFrames.size+ee.idleCallbacks.size+(e?ee.intervals.size:0)===0},getFiltered({ignoreTimeouts:e=[],maxDelay:t=5e3,includeIntervals:r=!1}){const n=[],s=["timeouts","animationFrames","idleCallbacks"];r&&s.push("intervals");for(const a of s){const l=ee[a];for(const[,o]of l.entries())!e.includes(o.name)&&(!Number.isInteger(o.delay)||o.delay<t)&&n.push(o)}return n}}}var kn=(i,e,t,r)=>{const n=typeof e=="string",s=(r==null?void 0:r.appendArgs)||[],a=()=>{t.timerId=null,t.lastCallTime=ia.now();const l=t.args;t.args=null,n?i[e](...l,...s):e.call(i,...l,...s),t.called=!0,++t.calls};return r&&(i=r.thisObj||i),t.lastCallTime=-9e9,t.calls=0,t.invoker=a,a.wrapFn=t,a},na=(i,e,t="clearTimeout")=>(e.cancel=()=>{e.isPending&&(i[t](e.timerId),e.args=e.timerId=null)},e.flush=()=>{e.isPending&&(i[t](e.timerId),e.timerId=null,e.invoker())},e.now=(...r)=>{e.cancel(),e.args=r,e.invoker()},e.resume=r=>{const n=e.suspended;e.suspended=r||n<1?0:n-1},e.suspend=()=>{++e.suspended},e.immediate=!1,e.suspended=0,e.timerId=null,Wl(e,"isPending",{get(){return e.timerId!==null}}),e),xe=i=>class extends(i||F){static get $name(){return"Delayable"}static get declarable(){return["delayable"]}doDestroy(){const t=this;super.doDestroy(),t.timeoutIds&&(t.timeoutIds.forEach((r,n)=>{typeof r=="function"&&r(),clearTimeout(n),ee==null||ee.timeouts.delete(n)}),t.timeoutIds=null),t.timeoutMap&&(t.timeoutMap.forEach((r,n)=>clearTimeout(n)),t.timeoutMap=null),t.intervalIds&&(t.intervalIds.forEach(r=>{clearInterval(r),ee==null||ee.intervals.delete(r)}),t.intervalIds=null),t.animationFrameIds&&(t.animationFrameIds.forEach(r=>{cancelAnimationFrame(r),ee==null||ee.animationFrames.delete(r)}),t.animationFrameIds=null),t.idleCallbackIds&&(t.idleCallbackIds.forEach(r=>{cancelIdleCallback(r),ee==null||ee.idleCallbacks.delete(r)}),t.idleCallbackIds=null)}hasTimeout(t){var r;return!!((r=this.timeoutMap)!=null&&r.has(t))}setTimeout({fn:t,delay:r,name:n,runOnDestroy:s,cancelOutstanding:a,args:l}){(arguments.length>1||typeof arguments[0]=="function")&&([t,r,n,s]=arguments),typeof t=="string"?n=t:n||(n=t.name||t),a&&this.clearTimeout(n);const o=this,u=o.timeoutIds||(o.timeoutIds=new Map),c=o.timeoutMap||(o.timeoutMap=new Map),d=setTimeout(()=>{typeof t=="string"&&(t=o[n]),u==null||u.delete(d),c==null||c.delete(n),ee==null||ee.timeouts.delete(d),t.apply(o,l)},r);return u.set(d,s?t:!0),ee==null||ee.timeouts.set(d,{fn:t,delay:r,name:n}),n&&c.set(n,d),d}clearTimeout(t){var r;let n=t;if(typeof n=="string")if(this.timeoutMap)n=this.timeoutMap.get(t),this.timeoutMap.delete(t);else return;clearTimeout(n),(r=this.timeoutIds)==null||r.delete(n),ee==null||ee.timeouts.delete(n)}clearInterval(t){var r;clearInterval(t),(r=this.intervalIds)==null||r.delete(t),ee==null||ee.intervals.delete(t)}setInterval(t,r,n){const s=setInterval(t,r);return(this.intervalIds||(this.intervalIds=new Set)).add(s),ee==null||ee.intervals.set(s,{fn:t,delay:r,name:n}),s}requestAnimationFrame(t,r=[],n=this){const s=this.animationFrameIds||(this.animationFrameIds=new Set),a=requestAnimationFrame(()=>{ee==null||ee.animationFrames.delete(a),s.delete(a)&&t.apply(n,r)});return s.add(a),ee==null||ee.animationFrames.set(a,{fn:t,extraArgs:r,thisObj:n}),a}requestIdleCallback(t,r=[],n=this){const s=this.idleCallbackIds||(this.idleCallbackIds=new Set),a=requestIdleCallback(()=>{ee==null||ee.idleCallbacks.delete(a),s.delete(a)&&t.apply(n,r)});return s.add(a),ee==null||ee.idleCallbacks.set(a,{fn:t,extraArgs:r,thisObj:n}),a}createOnFrame(t,r=[],n=this,s){let a;const l=(...o)=>{a!=null&&s&&(this.cancelAnimationFrame(a),a=null),a==null&&(a=this.requestAnimationFrame(()=>{typeof t=="string"&&(t=n[t]),a=null,o.push(...r),t.apply(n,o)}))};return l.cancel=()=>this.cancelAnimationFrame(a),l}cancelAnimationFrame(t){var r;cancelAnimationFrame(t),(r=this.animationFrameIds)==null||r.delete(t),ee==null||ee.animationFrames.delete(t)}cancelIdleCallback(t){var r;cancelIdleCallback(t),(r=this.idleCallbackIds)==null||r.delete(t),ee==null||ee.idleCallbacks.delete(t)}async nextAnimationFrame(){return new Promise(t=>this.requestAnimationFrame(t))}buffer(t,r){let n=r;r&&typeof r!="number"?n=r.delay:r=null;const s=(...l)=>{if(s.suspended)return;const{delay:o}=s;s.cancel(),s.called=!1,s.args=l,s.immediate||!o?a():s.timerId=this.setTimeout(a,o)},a=kn(this,t,s,r);return s.delay=n,na(this,s)}raf(t,r){let n=r;r&&typeof r!="boolean"?n=r.cancelOutstanding:r=null;const s=(...l)=>{s.suspended||(s.cancelOutstanding&&s.cancel(),s.called=!1,s.args=l,s.immediate?a():s.isPending||(s.timerId=this.requestAnimationFrame(a)))},a=kn(this,t,s,r);return s.cancelOutstanding=n,na(this,s,"cancelAnimationFrame")}idle(t,r){let n=r;r&&typeof r!="boolean"?n=r.cancelOutstanding:r=null;const s=(...l)=>{s.suspended||(s.cancelOutstanding&&s.cancel(),s.called=!1,s.args=l,s.immediate?a():s.isPending||(s.timerId=this.requestIdleCallback(a)))},a=kn(this,t,s,r);return s.cancelOutstanding=n,this.setTimeout(()=>this.idleCallbackIds.delete(s.timerId)&&s.now(),100),na(this,s,"cancelIdleCallback")}throttle(t,r){let n=r,s;r&&typeof r!="number"?(n=r.delay,s=r.throttled):r=null;const a=this,l=(...u)=>{if(l.suspended)return;const{delay:c}=l,d=ia.now()-l.lastCallTime;l.args=u,l.immediate||d>=c?(a.clearTimeout(l.timerId),o()):(l.isPending||(l.timerId=a.setTimeout(o,c-d),l.called=!1),s&&(s.wrapFn.args=u,s()))},o=kn(a,t,l,r);return l.delay=n,s&&(s=kn(a,s,()=>{},r)),na(a,l)}static setupDelayable(t){t.setupDelayableMethods(t.delayable)}static setupDelayableMethods(t,r=null){const n=this,s=t.static,a=r||n.prototype;s&&delete t.static;for(const l in t){let o=t[l];const u=l+"Now",c=typeof o;a[u]||(a[u]=a[l]),c==="number"?o={type:"buffer",delay:o}:c==="string"&&(o={type:o}),Wl(a,l,{get(){const d=this[o.type]((...h)=>{this[u](...h)},o);return Wl(this,l,{value:d}),d}})}}get widgetClass(){}},si=class{get data(){return Object.create(null)}get keys(){return[]}clear(){}getItem(i){return null}removeItem(i){}setItem(i,e){}};si._$name="StateStorage";var kv=class extends si{constructor(i){super(),this.prefix=i.prefix||""}get isLocal(){return!0}get data(){const i=nd(),e=this.keys;for(const t of e)i[t]=this.getItem(t);return i}get keys(){return sd(this.prefix,this.prefix.length)}clear(){const i=sd(this.prefix);for(const e of i)localStorage.removeItem(e)}getItem(i){const e=localStorage.getItem(this.prefix+i);return e===null?e:JSON.parse(e)}removeItem(i){return localStorage.removeItem(this.prefix+i)}setItem(i,e){return localStorage.setItem(this.prefix+i,JSON.stringify(e))}},Iv=class extends si{constructor(){super(),this.clear()}get isMemory(){return!0}get data(){return x.clone(this._data)}get keys(){return Object.keys(this._data)}clear(){this._data=nd()}getItem(i){return i in this._data?this._data[i]:null}removeItem(i){delete this._data[i]}setItem(i,e){this._data[i]=e}},nd=()=>Object.create(null),sd=(i,e=0)=>{const t=[],r=localStorage.length;for(let n,s=0;s<r;++s)n=localStorage.key(s),n.startsWith(i)&&t.push(n.slice(e));return t},ad=new si,Hl={local:kv,memory:Iv},In=class fm extends F.mixin(xe,fe){static get $name(){return"StateProvider"}static get configurable(){return{prefix:"bryntum-state:",storage:"local"}}static get delayable(){return{writeStatefuls:50}}static get instance(){return this._instance}static set instance(e){e==null?e=ld:((typeof e=="string"||x.isClass(e)||e instanceof si)&&(e={storage:e}),x.isObject(e)&&(e=new fm(e))),this._instance=e}static setup(e){return this.instance=e,this.instance}doDestroy(){self.writeStatefuls.flush(),super.doDestroy()}get data(){return this.storage.data}set data(e){if(!e)this.clear();else for(const t in e)this.setValue(t,e[t])}clear(){return this.storage.clear(),this}changeStorage(e){if(e==null)e=ad;else{if(typeof e=="string"){if(!Hl[e])throw new Error(`Invalid storage type "${e}" (expected one of: "${Object.keys(Hl).join('", "')}")`);e=Hl[e]}x.isClass(e)&&(e=new e(this))}return e}saveStateful(e,t){(this.pendingSaves||(this.pendingSaves=[])).push([e,t]),this.writeStatefuls()}writeStatefuls(){const e=this,{pendingSaves:t}=e,r=t==null?void 0:t.length,n=[],s=[];if(e.pendingSaves=null,r){for(let a,l,o,u=0;u<r;++u)[l,a]=t[u],!l.isDestroying&&l.isSaveStatePending&&(o=l.saveState({...a,immediate:!0}),o&&(n.push(o),s.push(l)));n.length&&e.trigger("save",{stateIds:n,saved:s})}}getValue(e){return this.writeStatefuls.flush(),this.storage.getItem(e)}setValue(e,t){const r=this,{storage:n}=r,s=r.getValue(e);return t!=null?(n.setItem(e,t),r.trigger("set",{key:e,value:t,was:s})):s!==null&&(n.removeItem(e),r.trigger("remove",{key:e,was:s})),r}},ld=new In({storage:ad});In._instance=ld,In._$name="StateProvider";var Mv=/boolean|number|string/,sa=i=>{var e;return e=class extends(i||F){afterConstruct(){super.afterConstruct(),this.loadState()}finalizeInit(){this.loadState(),super.finalizeInit()}get isStateful(){return!0}get isStatefulActive(){return!this.statefulSuspended&&!this.isResponsivePending&&!this.isResponsiveUpdating}get state(){return this._state=this.getState()}set state(t){this._state=t,t&&this.applyState(t)}updateStatefulEvents(t){var r;const n=this,s={name:"statefulEvents",thisObj:n};if(n.detachListeners(s.name),t&&(typeof t=="string"?t=P.split(t):Array.isArray(t)||(t=x.getTruthyKeys(t)),t.length)){for(const a of t)s[a]="onStatefulEvent";(r=n.ion)==null||r.call(n,s)}}get statefulId(){const t=this,{responsiveState:r}=t;let n=t.stateId;return n==null&&t.hasGeneratedId===!1&&t.stateful!==!1&&(n=t.id),n&&r&&(n=`${n}[${r}]`),n}get statefulness(){const{stateful:t}=this;return Array.isArray(t)?x.createTruthyKeys(t):t}get stateProvider(){return this._stateProvider||In.instance}applyState(t){t=this.pruneState(t),t&&this.setConfig(t)}getState(){const t=this,{initialConfig:r,statefulness:n,isConstructing:s}=t,{configs:a}=t.$meta,l=s?Object.setPrototypeOf(r,t.$meta.config):t;let o=null,u,c;if(n){o={};for(u in n)if(n[u]){if(c=l[u],c!=null&&c.isStateful)c=c.state;else if(!s&&(x.isDate(c)&&(c=k.format(c,"YYYY-MM-DDTHH:mm:ssZ")),a[u].equal(c,r==null?void 0:r[u])||!Mv.test(typeof c)))continue;o[u]=c}}return o}loadState(t,r){typeof t=="boolean"&&(r=t,t=null);const n=this,{statefulLoaded:s}=n;if(n.isStatefulActive&&(r||!s)){const a=n.loadStatefulData(t||(t=n.statefulId));!s&&t&&(n.defaultState=n.state,n.statefulLoaded=!0),a&&(n.state=a)}}loadStatefulData(t){var r;return t=this.isStatefulActive?t||this.statefulId:null,t&&((r=this.stateProvider)==null?void 0:r.getValue(t))}resetDefaultState(){this.defaultState&&(this.state=this.defaultState)}resumeStateful(t=!1){this.statefulSuspended=t?0:Math.max(this.statefulSuspended-1,0)}saveState(t){typeof t=="string"?t={id:t}:t=t||{};const r=this,{stateProvider:n}=r,s=t.id||r.isStatefulActive&&r.statefulId;if(s&&n)return t.immediate?(r.isSaveStatePending=!1,n.setValue(s,r.state)):r.isSaveStatePending||(r.isSaveStatePending=!0,n.saveStateful(r,t)),s}suspendStateful(){++this.statefulSuspended}onConfigChange({name:t,value:r,was:n,config:s}){if(super.onConfigChange({name:t,value:r,was:n,config:s}),!this.isConstructing&&this.isStatefulActive&&this.statefulId){const{stateful:a}=this;(Array.isArray(a)?a.includes(t):a!=null&&a[t])&&this.saveState()}}onStatefulEvent(){this.isConstructing||this.saveState()}pruneState(t){const{statefulness:r}=this;if(r){const n={};for(const s in t)r[s]&&(n[s]=t[s]);t=n}return t}get widgetClass(){}},y(e,"$name","State"),y(e,"configurable",{stateful:{value:null,$config:{merge:"classList"}},statefulEvents:{$config:{merge:"classList"},value:["stateChange"]},stateId:null,stateProvider:null}),y(e,"prototypeProperties",{statefulLoaded:!1,statefulSuspended:0}),e},od=x.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null)),Rv={string:1,number:1},ai=i=>class extends(i||F){static get $name(){return"Identifiable"}static get declarable(){return["identifiable"]}static get configurable(){return{id:""}}static setupIdentifiable(t,r){const{identifiable:n}=t;n.idMap=Object.create(null),Reflect.defineProperty(t,"identifiable",{get(){return n}})}doDestroy(){this.constructor.unregisterInstance(this),super.doDestroy()}changeId(t){return(this.hasGeneratedId=!t)?this.generateAutoId():t}updateId(t,r){const n=this,s=n.constructor;r&&s.unregisterInstance(n,r),(!n.hasGeneratedId||s.identifiable.registerGeneratedId!==!1)&&s.registerInstance(n,t)}generateAutoId(){return this.constructor.generateId(`b-${this.$$name.toLowerCase()}-`)}static get all(){return Object.values(this.identifiable.idMap)}static generateId(t="generatedId"){return t+(od[t]=(od[t]||0)+1)}static registerInstance(t,r=t.id){const{idMap:n}=this.identifiable;if(r in n&&!this.disableThrow)throw new Error("Id "+r+" already in use");n[r]=t}static unregisterInstance(t,r=t.id){const{idMap:n}=this.identifiable;Rv[typeof t]?delete n[t]:n[r]===t&&delete n[r]}static getById(t){const r=this.identifiable.idMap;if(r)return r[t]}static get registeredInstances(){const t=this.identifiable.idMap;return t?Object.values(t):[]}},ud=Symbol("STM_PROP"),cd={parentIndex:1},dd=i=>class extends(i||F){static get $name(){return"ModelStm"}static get defaultConfig(){return{stm:null}}joinStore(t){this.stm||(this.stm=t.stm)}unjoinStore(t,r=!1){var n;this.stm===t.stm&&(this.stm=null),(n=super.unjoinStore)==null||n.call(this,t,r)}get stm(){return this[ud]}set stm(t){this[ud]=t}beforeChronoFieldSet(t,r){var n;const s=this;return!s.inSetting&&((n=s.stm)!=null&&n.enabled)&&!cd[t]&&!s.constructor.nonPersistableFields[t]&&s.getFieldDefinition(t)?{[t]:{value:r,oldValue:s[t]}}:null}afterChronoFieldSet(t,r,n){n&&this.afterSet(t,r,!1,!1,n,!0)}shouldRecordFieldChange(t,r,n){const s=this.firstStore;return!(this.constructor.nonPersistableFields[t]||r==null&&n==null||r===n||r instanceof Date&&n instanceof Date&&r.getTime()===n.getTime()||t==="id"||t==="$PhantomId"||t==="parentId"&&s&&s.oldIdMap[r]===s.getById(n))}afterSet(t,r,n,s,a,l){const{stm:o}=this,u=this.constructor.nonPersistableFields;if(o!=null&&o.isBase&&o.enabled&&!cd[t]&&!u[t]&&a){let c;const[d,h]=Object.keys(a).reduce((g,f)=>{const{value:m,oldValue:p}=a[f];return this.shouldRecordFieldChange(f,p,m)&&(c=!0,g[0][f]=m,g[1][f]=p),g},[{},{}]);c&&o.onModelUpdate(this,d,h,l)}}beforeInsertChild(t){var r;const n=((r=super.beforeInsertChild)==null?void 0:r.call(this,t))||[],{stm:s}=this;return s!=null&&s.enabled&&n.push(t.reduce((a,l)=>(l.root===this.root&&a.set(l,{parent:l.parent,index:l.parent?l.parentIndex:void 0}),a),new Map)),n}afterInsertChild(t,r,n,s){var a;const{stm:l}=this;if(l!=null&&l.enabled){const o=n.pop();s&&l.onModelInsertChild(this,t,s,o)}(a=super.afterInsertChild)==null||a.call(this,t,r,n,s)}beforeRemoveChild(t,r){const n=super.beforeRemoveChild?super.beforeRemoveChild(t,r):[],{stm:s}=this;return s!=null&&s.enabled&&!r&&n.push(t.reduce((a,l)=>(a.set(l,{parentIndex:l.parentIndex,orderedParentIndex:l.orderedParentIndex}),a),new Map)),n}afterRemoveChild(t,r,n){var s;const{stm:a}=this;if(a!=null&&a.enabled&&!n){const l=r.pop();t&&t.length&&a.onModelRemoveChild(this,t,l)}(s=super.afterRemoveChild)==null||s.call(this,t,r,n)}},_v={includeFilteredOutRecords:!1},Yl=i=>(i=i||!1,typeof i=="boolean"&&(i={includeFilteredOutRecords:i}),i||_v),hd=i=>class extends(i||F){static get $name(){return"TreeNode"}static set convertEmptyParentToLeaf(t){t===!0?t={onLoad:!0,onRemove:!0}:t===!1&&(t={onLoad:!1,onRemove:!1}),this._convertEmptyParentToLeaf=t}constructor(...t){super(...t),this.children&&(this.orderedChildren=this.orderedChildren||[])}static get convertEmptyParentToLeaf(){return this._convertEmptyParentToLeaf||{onLoad:!1,onRemove:!1}}ingestChildren(t,r=this.stores){const{inProcessChildren:n,constructor:s}=this,a=r[0];if(t===!0)return n?!0:[];if(t){t=z.asArray(t);const l=t.length,o=[];for(let u=0,c;u<l;u++)c=t[u],c=c.isModel?c:a?a.createRecord(c,!1,!0):new s(c,null,null,!0),c=a?a.processRecord(c):c,o.push(c);if(this.children===!0&&a){const u=a.createSorterFn(a.sorters);o.sort(u)}return o}}processChildren(t=this.stores){const r=this,{meta:n}=r;r.inProcessChildren=!0;const s=r.ingestChildren(r.data[r.constructor.childrenField],t);if(s){const{convertEmptyParentToLeaf:a}=r.constructor;if(a===!0||a.onLoad?s.length:Array.isArray(s)){if(n.isLeaf=!1,r.children===!0)r.children=[];else if(s.length===0){r.children=s;return}r.insertChild(s)}else s===!0?(n.isLeaf=!1,r.children=!0):r.isRoot||(n.isLeaf=r.constructor.convertEmptyParentToLeaf.onLoad)}r.inProcessChildren=!1}ancestorsExpanded(t=this.firstStore){const{parent:r}=this;return!r||r.isExpanded(t)&&r.ancestorsExpanded(t)}isExpanded(t=this.firstStore){const r=this.instanceMeta(t.id);return Object.prototype.hasOwnProperty.call(r,"collapsed")||(r.collapsed=!this.expanded),!r.collapsed}get expanded(){return this.data.expanded}get childLevel(){let t=this,r=-1;for(;t&&!t.isRoot;)++r,t=t.parent;return r}get isLeaf(){return this.meta.isLeaf!==!1&&!this.isRoot}get isParent(){return!this.isLeaf}get isLoaded(){return this.isParent&&Array.isArray(this.children)}get descendantCount(){return this.getDescendantCount()}get visibleDescendantCount(){return this.getDescendantCount(!0)}getDescendantCount(t=!1,r=this.firstStore){const{children:n}=this;return!n||!Array.isArray(n)||t&&!this.isExpanded(r)?0:n.reduce((s,a)=>s+a.getDescendantCount(t),n.length)}get allChildren(){return this.getAllChildren(!1)}get allUnfilteredChildren(){return this.getAllChildren(!0)}getAllChildren(t=!1){const{[t?"unfilteredChildren":"children"]:r}=this;return!r||r===!0?[]:r.reduce((n,s)=>(n.push(s),n.push.apply(n,t?s.allUnfilteredChildren:s.allChildren),n),[])}get firstChild(){const{children:t}=this;return(t==null?void 0:t.length)&&t[0]||null}get lastChild(){const{children:t}=this;return(t==null?void 0:t.length)&&t[t.length-1]||null}get previousSiblingsTotalCount(){let t=this.previousSibling,r=this.parentIndex;for(;t;)r+=t.descendantCount,t=t.previousSibling;return r}get previousOrderedSibling(){var t,r;return(r=(t=this.parent)==null?void 0:t.orderedChildren[this.orderedParentIndex-1])!=null?r:null}get nextOrderedSibling(){var t,r;return(r=(t=this.parent)==null?void 0:t.orderedChildren[this.orderedParentIndex+1])!=null?r:null}get root(){var t;return((t=this.parent)==null?void 0:t.root)||this}get parentId(){return this.parent&&!this.parent.isAutoRoot?this.parent.id:null}set parentId(t){const r=this,{parent:n}=r,s=t===null?r.firstStore.rootNode:r.firstStore.getById(t);s===n||!n&&!s||(r.isBatchUpdating?r.meta.batchChanges.parentId=t:s?s.appendChild(r):r.parent.removeChild(r))}static set parentIdField(t){this._parentIdField=t,Object.defineProperty(this.prototype,t,{set:function(r){this.parentId=r},get:function(){return this.parentId}})}static get parentIdField(){return this._parentIdField||"parentId"}getChildren(t){let r;return t.includeFilteredOutRecords?r=this.unfilteredChildren||this.children:t.useOrderedTree?r=this.orderedChildren:r=this.children,r}traverse(t,r,n){n=Yl(n);const s=this,a=s.getChildren(n);r||t.call(s,s);for(let l=0,o=a==null?void 0:a.length;l<o;l++)a[l].traverse(t,!1,n)}traverseBefore(t,r,n){n=Yl(n);const s=this,a=s.getChildren(n);for(let l=0,o=a==null?void 0:a.length;l<o;l++)a[l].traverse(t,!1,n);r||t.call(s,s)}traverseWhile(t,r,n){n=Yl(n);const s=this;let a=r||t.call(s,s)!==!1;if(a){const l=s.getChildren(n);l!=null&&l.length&&(a=l.every(o=>o.traverseWhile(t,!1,n)))}return a}bubble(t,r=!1){let n=this;for(r||t.call(n,n);n.parent;)n=n.parent,t.call(n,n)}bubbleWhile(t,r=!1){let n=this,s=!0;for(r||(s=t.call(n,n));s&&n.parent;)n=n.parent,s=t.call(n,n);return s}contains(t,r=!1){return t&&typeof t=="object"&&(t=t.id),!this.traverseWhile(n=>n.id!=t,r)}getTopParent(t){let r;return t?(r=[],this.bubbleWhile(n=>(r.push(n),n.parent&&!n.parent.isRoot))):(r=null,this.bubbleWhile(n=>(r=n,n.parent&&!n.parent.isRoot))),r}appendChild(t,r=!1,n={}){return this.insertChild(t,null,r,n)}insertChild(t,r=null,n=!1,s={}){var a,l,o,u,c,d,h;const g=this,f=Array.isArray(t);if(t=z.asArray(t),typeof r=="number"&&(r=(l=(a=g.children)==null?void 0:a[r])!=null?l:null),!n&&!g.stores.every(b=>b.trigger("beforeAdd",{records:t,parent:g})!==!1))return null;t=g.ingestChildren(t);const m=(c=(u=r==null?void 0:r.parentIndex)!=null?u:(o=g.children)==null?void 0:o.length)!=null?c:0,p=(d=g.beforeInsertChild)==null?void 0:d.call(g,t),v=g.internalAppendInsert(t,r,n,s);return v.length&&g.convertToParent(n),(h=g.afterInsertChild)==null||h.call(g,m,t,p,v),f||!v?v:v[0]}convertToParent(t=!1){const r=this,n=r.isLeaf;r.meta.isLeaf=!1,r.children||(r.children=[]),n&&!r.root.isLoading&&!t&&r.signalNodeChanged({isLeaf:{value:!1,oldValue:!0}})}signalNodeChanged(t,r=this.stores){r.forEach(n=>{n.trigger("update",{record:this,records:[this],changes:t}),n.trigger("change",{action:"update",record:this,records:[this],changes:t})})}tryInsertChild(){return this.insertChild(...arguments)}internalAppendInsert(t,r,n,s){const a=this,{stores:l,root:o,children:u}=a,{firstStore:c}=o,{parentIdField:d}=a.constructor,h=a.id;let g,f,m,p,v,b;if(!o.isLoading&&c)for(b={},v=[],m=0;m<t.length;m++){const w=t[m];b[w.id]=w.root===o,v[m]=w.parentIndex}if(r&&r.parent!==a&&(r=null),u){const w=r?r.parentIndex:u.length;if(u[f=w]===t[0]||u[f=w-1]===t[0])for(g=!0,m=0;g&&m<t.length;m++)t[m]!==u[f+m]&&(g=!1)}if(g)return t;for(m=0;m<t.length;m++){const w=t[m],S=w.parent;if(c&&!o.isLoading&&w.traverse(C=>{C.root===o&&(b[C.id]=!0)}),(S==null?void 0:S.removeChild(w,b==null?void 0:b[w.id],n,{isInserting:!0,...s}))===!1)p||(t=t.slice(),p=!0),t.splice(m--,1);else{w.parent=a,w.data[d]=h;const{meta:C}=w;C.modified[d]===h&&!S&&(C.oldParentId=h),S&&(C.oldParentId=S.id)}}if(t.length){Array.isArray(u)||(a.children=[]),Array.isArray(a.orderedChildren)||(a.orderedChildren=[]);const w=a.addToChildren(r,t,s);l.forEach(S=>{S.isChained||(t.forEach(C=>{C.joinStore(S)}),S.onNodeAddChild(a,t,w,b,n),t.forEach((C,T)=>{if(C.meta.oldParentId!=null&&!(a.inProcessChildren||a.isLoading)){const E={[d]:h,[a.getDataSource("parentIndex")]:C.parentIndex},I={},{modified:R,oldParentId:M}=C.meta,O=v[T];if(delete C.meta.oldParentId,a.id!==M&&(I[d]={value:h,oldValue:M}),C.parentIndex!==O&&(I.parentIndex={value:C.parentIndex,oldValue:O}),R[d]===a.id?Reflect.deleteProperty(R,d):d in R||(R[d]=M),b[C.id]){const A=S.getById(M);A.isLeaf&&!n&&A.signalNodeChanged({isLeaf:{value:!0,oldValue:!1}},[S])}C.afterChange(E,I)}C.traverse(E=>{!E.ignoreBag&&!E.isLinked&&S.updateModifiedBagForRecord(E)})}))})}return t}removeChild(t,r=!1,n=!1,s={}){var a,l;const o=this,u=[],c=o.isLeaf,{children:d,stores:h}=o;if(t=z.asArray(t),t=t.filter(f=>f.parent===o),!n){for(const f of h)if(!f.isChained&&f.trigger("beforeRemove",{parent:o,records:t,isMove:r})===!1)return!1}const g=(a=o.beforeRemoveChild)==null?void 0:a.call(o,t,r);for(const f of t){const{parentIdField:m}=f.constructor,{modified:p}=f.meta,v=f.parent?f.parent.id:null;!(m in p)&&!f.isLinked&&(p[m]=v);const b=o.removeFromChildren(f,s);h.forEach(w=>{if(!w.isChained){const{isRemoving:S}=w;w.isRemoving=!0,u.push(...w.onNodeRemoveChild(o,[f],b,{isMove:r,silent:n})),w.isRemoving=S}}),r||(f.parent=f.parentIndex=f.unfilteredIndex=f.nextSibling=f.previousSibling=null,f.data[m]=null)}return(o.unfilteredChildren||d).length===0&&o.constructor.convertEmptyParentToLeaf.onRemove&&!o.isRoot&&(o.meta.isLeaf=!0),o.isLeaf!==c&&!n&&!r&&o.signalNodeChanged({isLeaf:{value:!0,oldValue:!1}}),(l=o.afterRemoveChild)==null||l.call(o,t,g,r),u}clearParentId(){const t=this;Reflect.deleteProperty(t.data,t.parentIdField),Reflect.deleteProperty(t.originalData,t.parentIdField),t.meta.modified&&Reflect.deleteProperty(t.meta.modified,t.parentIdField)}replaceChildren(t){return this.clearChildren(),this.data[this.constructor.childrenField]=t,this.processChildren(),this.children}clearChildren(t=!1){const r=this,{stores:n}=r,s=r.unfilteredChildren||r.children;r.children=[],r.orderedChildren=[],s&&s!==!0&&(n.forEach(a=>{a.isChained||a.onNodeRemoveChild(r,s,0,{unfiltered:!0,silent:t})}),r.unfilteredChildren&&(r.unfilteredChildren=[]))}clear(){var t;const r=this,{stores:n}=r,s=(t=r.children)==null?void 0:t.slice();if(!(!r.isRoot||!s)){for(const a of n)if(!a.isChained&&a.trigger("beforeRemove",{parent:r,records:s,isMove:!1,removingAll:!0})===!1)return!1;r.children.length=0,r.unfilteredChildren&&(r.unfilteredChildren.length=0),n.forEach(a=>{s.forEach(l=>{l.stores.includes(a)&&l.unjoinStore(a),l.parent=l.parentIndex=l.nextSibling=l.previousSibling=null}),a.storage.suspendEvents(),a.storage.clear(),a.storage.resumeEvents(),a.added.clear(),a.modified.clear(),a.trigger("removeAll"),a.trigger("change",{action:"removeall"})})}}updateChildrenIndices(t,r,n=!1){let s=null;for(let a=0;a<t.length;a++){const l=t[a],o=l[r];r==="parentIndex"||r==="orderedParentIndex"?o===void 0||n?l.setData(r,a):o!==a&&l.set(r,a,!0):l[r]=a,r==="parentIndex"&&(l.previousSibling=s,s&&(s.nextSibling=l),a===t.length-1&&(l.nextSibling=null),s=l)}}addToChildren(t,r,n={}){var s;const a=this,l=[[a.children,"parentIndex",t],[a.unfilteredChildren,"unfilteredIndex",t],[a.orderedChildren,"orderedParentIndex",(n==null?void 0:n.orderedBeforeNode)===void 0?(n==null?void 0:n.orderedParentIndex)!==void 0?a.orderedChildren[n==null?void 0:n.orderedParentIndex]:t:n==null?void 0:n.orderedBeforeNode]];for(const o of l){const[u,c,d]=o;if(u){const h=d?c==="orderedParentIndex"?u.indexOf(d):d[c]:u.length;o.push(h),u.splice(h,0,...r),(s=n==null?void 0:n[c])!=null&&s.skip||a.updateChildrenIndices(u,c)}}return l[0][3]}removeFromChildren(t,r){var n;const s=[[this.children,"parentIndex"],[this.unfilteredChildren,"unfilteredIndex"],[this.orderedChildren,"orderedParentIndex"]];for(const a of s){const[l,o]=a;if(l){const u=l.indexOf(t);a.push(u),u>-1&&(l.splice(u,1),(n=r==null?void 0:r[o])!=null&&n.skip||this.updateChildrenIndices(l,o))}}return s[0][2]}sortOrderedChildren(t=!0,r=!1){const n=[];return this.isLeaf||(this.orderedChildren.sort((s,a)=>{var l,o;if(r){const u=(l=s.meta.modified.orderedParentIndex)!=null?l:s.orderedParentIndex,c=(o=a.meta.modified.orderedParentIndex)!=null?o:a.orderedParentIndex,d=u-c;return d!==0&&(n.push(s),n.push(a)),d}else return s.orderedParentIndex-a.orderedParentIndex}),t&&this.orderedChildren.forEach(s=>{n.push(...s.sortOrderedChildren(t,r))}),this.updateChildrenIndices(this.orderedChildren,"orderedParentIndex",!0)),new Set(n)}sortVisibleChildren(t=!0,r){const n=this;n.isLeaf||(n.children.sort(r),t&&n.orderedChildren.forEach(s=>s.sortVisibleChildren(t,r)),n.updateChildrenIndices(n.children,"parentIndex",!0))}sortUnfilteredChildren(t=!0,r){const n=this;!n.isLeaf&&n.unfilteredChildren&&(n.unfilteredChildren.sort(r),t&&n.orderedChildren.forEach(s=>s.sortUnfilteredChildren(t,r)),n.updateChildrenIndices(n.unfilteredChildren,"unfilteredIndex",!0))}unjoinStore(t,r=!1){var n;const s=this;s.unfilteredChildren&&(s.children=s.unfilteredChildren.slice(),s.unfilteredChildren=null),(n=super.unjoinStore)==null||n.call(this,t,r)}},fd={id:1,stores:1,parentIndex:1,parent:1,previousSibling:1,nextSibling:1,unfilteredIndex:1},Ov={get(i,e){return e==="proxyMeta"?this.proxyMeta:e==="constructor"?i.constructor:e==="setData"?this.setDataOverride:e==="set"?this.setOverride:fd[e]?this.proxyMeta.data[e]:Reflect.get(i,e,this.proxyRecord)},set(i,e,t){return fd[e]?this.proxyMeta.data[e]=t:i[e]=t,!0},setDataOverride(i,e){i==="parentIndex"?this.proxyMeta.data.parentIndex=e:this.proxyMeta.originalRecord.setData(i,e)},setOverride(i,e,...t){i==="parentIndex"?this.proxyMeta.data.parentIndex=e:this.proxyMeta.originalRecord.set(i,e,...t)}},gd=i=>{var e;return e=class extends(i||F){link(){if(this.isLinked)return this.$original.link();const t=this,r={...Ov,proxyMeta:{originalRecord:t,data:{id:`${t.id}_link_${P.generateUUID()}`,stores:[]}}},n=new Proxy(t,r);return r.proxyRecord=n,(t.meta.linkedRecords||(t.meta.linkedRecords=[])).push(n),n}get isLinked(){var t;return!!((t=this.proxyMeta)!=null&&t.originalRecord)}get hasLinks(){return!!(!this.proxyMeta&&this.$links.length)}removeLink(t,r=null,n=!1){if(t.hasLinks)for(const s of t.$links.slice())r?z.include(r,s):s.remove(n);else t.isLinked&&z.remove(t.$original.$links,t)}beforeRemove(t){this.removeLink(this,t)}removeChild(t,r,n,s){if(!(s!=null&&s.isInserting)){t=z.asArray(t);for(const a of t)this.removeLink(a,null,n)}return super.removeChild(t,r,n,s)}get $originalId(){return this.$original.id}get $links(){var t;return(t=this.meta.linkedRecords)!=null?t:[]}},y(e,"$name","ModelLink"),y(e,"isModel",!0),e},{defineProperty:md}=Reflect,Ul=Symbol("owner"),Av=/[\s,]+/,Et=i=>class extends(i||F){static get $name(){return"Factoryable"}static get declarable(){return["factoryable","alias","type"]}static register(t,r,n=globalThis.__BRYNTUM_EXAMPLE){const{factoryable:s}=this.initClass(),{caseless:a,registry:l}=s,o=P.split(t,Av);for(let u,c,d=0;d<o.length;++d){if(c=o[d],u=a?c.toLowerCase():c,!n&&u in l)throw new Error(`Type "${c}" already registered with ${s.class.name} factory`);l[c]=l[u]=r.initClass()}}static isA(t,r){return this.isType(t,r,!0)}static isType(t,r,n){const{factoryable:s}=this,{caseless:a,registry:l}=s,o=l[a?r.toLowerCase():r];return o?n?t instanceof o:t.constructor===o:!1}static setupAlias(t){t.register(t.alias,t)}static setupFactoryable(t,r){const n=r.super.class;let{factoryable:s}=t;s={caseless:!0,defaultType:null,extends:n.factoryable?[n]:null,typeKey:"type",...s},s.class=t,s.registry=Object.create(null),s.extends&&!Array.isArray(s.extends)&&(s.extends=[s.extends]),md(t,"factoryable",{get(){return s}})}static setupType(t,r){const{type:n}=t;t.register(n,t,r.replaceType),md(t.prototype,"type",{value:n})}static create(t,r){return this.reconfigure(null,t,r)}static reconfigure(t,r,n){const s=this,{factoryable:a}=s,{typeKey:l}=a;let o=n,u,c,d,h,g,f,m,p,v;if(n&&!x.isClass(n)&&(o=null,m=typeof n,m==="function"?f=n:m==="string"?o=n:x.isObject(n)?(u=n.cleanup,c=n.defaults,h=n.owner,f=n.setup,o=n.type,p=n.transform):h=n),p&&(r=typeof p=="string"?h[p](r):p(r)),v=r,typeof v=="string")r={};else if(r){if(r===!0&&(r={}),!x.isObject(r))return h&&r!==t&&(t==null?void 0:t[Ul])===h&&(typeof u=="string"?h[u](t):u==null||u(t),t.destroy()),r;v=r[l]}if(v=v&&s.resolveType(v),t){if(r&&(!v||t.constructor===v))return l in r&&(r=x.assign({},r),delete r[l]),t.setConfig(r),t;h&&t[Ul]===h&&(typeof u=="string"?h[u](t):u==null||u(t),t.destroy())}if(r){if(c){if(!(d=v)){if(!(d=c[l]||o||a.defaultType))throw new Error(`No default mergeType defined for ${a.class.name} factory`);d=s.resolveType(d)}d&&(r=d.mergeConfigs(c,r))}if(f){if(g=typeof f=="string"?h[f](r,v,c):f(r,v,c),g===null)return g;r=g||r}if(!v){if(!(v=r[l]||o||a.defaultType))throw new Error(`No default type defined for ${a.class.name} factory`);v=s.resolveType(v)}c&&!d&&(r=v.mergeConfigs(c,r)),l in r&&(r=x.assign({},r),delete r[l]),r=new v(r),h&&(r[Ul]=h)}return r||null}static resolveType(t,r){if(typeof t!="string")return t;const{factoryable:n}=this,s=n.extends;let a=n.registry[n.caseless?t.toLowerCase():t],l;for(l=0;!a&&s&&l<s.length;++l)a=s[l].resolveType(t,!0);if(!a&&!r)throw new Error(`Invalid type name "${t}" passed to ${n.class.name} factory`);return a}},{getOwnPropertyDescriptor:Pv}=Reflect,Ge=class extends F.mixin(Et){static get $name(){return"DataField"}static get type(){return"auto"}static get factoryable(){return{defaultType:"auto"}}static get prototypeProperties(){return{compare:null,compareItems:null,dataSource:null,alwaysWrite:!1,nullable:!0,nullText:null,nullValue:void 0,persist:!0,readOnly:!1,internal:!1,useProp:null}}construct(i){const e=this;i&&(e.name=i.name,Object.assign(e,i)),e.compare&&(e.compareItems=(t,r)=>e.compare(t==null?void 0:t[e.name],r==null?void 0:r[e.name]))}defineAccessor(i,e){const{name:t,dataSource:r}=this;!e&&t in i&&i.$meta.hierarchy.some(n=>{var s;return((s=Pv(n.prototype,t))==null?void 0:s.enumerable)===!1})||Reflect.defineProperty(i,t,{configurable:!0,enumerable:!0,get:this.complexMapping?function(){return this.complexGet(t,r)}:function(){return this.batching&&t in this.meta.batchChanges?this.meta.batchChanges[t]:r in this.data?this.data[r]:this.data[t]},set(n){const s=this.$meta.fields.map[t];s&&s.readOnly||this.set(t,n)}})}isEqual(i,e){return x.isEqual(i,e)}print(i){return i==null?this.nullText:this.printValue(i)}printValue(i){return String(i)}};Ge._$name="DataField";var Mn=class extends Ge{isEqual(i,e){return i===e}getAt(i,e){return i.get(this.name)[e]}};y(Mn,"$name","ArrayDataField"),y(Mn,"type","array"),Mn.initClass(),Mn._$name="ArrayDataField";var li=class extends Ge{static get prototypeProperties(){return{nullValue:!1}}isEqual(i,e){return i==null&&e==null?!0:super.isEqual(i,e)}convert(i){var e;return i==null?this.nullable?i:this.nullValue:((e=i.toLowerCase)==null?void 0:e.call(i))==="false"?!1:!!i}};y(li,"$name","BooleanDataField"),y(li,"type","boolean"),y(li,"alias","bool"),li.initClass(),li._$name="BooleanDataField";var ql=class extends Ge{static get $name(){return"DateDataField"}static get type(){return"date"}static get prototypeProperties(){return{format:null}}convert(i){return i==null?this.nullable||(i=this.nullValue):i==="now"?i=new Date:i instanceof Date||(i=k.parse(i,this.format||k.defaultParseFormat),(!i||isNaN(i))&&(i=void 0)),i}serialize(i){return i instanceof Date&&(i=k.format(i,this.format||k.defaultFormat)),i}printValue(i){return k.format(i,this.format||k.defaultFormat)}};ql.initClass(),ql._$name="DateDataField";var aa=class extends Ge{static get $name(){return"StringDataField"}static get type(){return"string"}static get prototypeProperties(){return{nullValue:""}}convert(i){return i==null?this.nullable?i:this.nullValue:String(i)}};aa.initClass(),aa._$name="StringDataField";var pd=class extends aa{static get $name(){return"DurationUnitDataField"}static get type(){return"durationunit"}isEqual(i,e){return k.compareUnits(i,e)===0}};pd.initClass(),pd._$name="DurationUnitDataField";var oi=class extends Ge{static get prototypeProperties(){return{nullValue:0,rounding:"round"}}convert(i){return i==null?this.nullable?i:this.nullValue:Math[this.rounding](Number(i))}};y(oi,"$name","IntegerDataField"),y(oi,"type","integer"),y(oi,"alias","int"),oi.initClass(),oi._$name="IntegerDataField";var la=class extends Ge{static get $name(){return"ModelDataField"}static get type(){return"model"}static get prototypeProperties(){return{complexMapping:!0}}isEqual(i,e){return i&&e&&e instanceof i.constructor&&e.id==i.id}};y(la,"configurable",{modelClass:null}),la.initClass(),la._$name="ModelDataField";var ui=class extends Ge{static get prototypeProperties(){return{nullValue:0,precision:null}}isEqual(i,e){return isNaN(Number(i))&&isNaN(Number(e))||super.isEqual(i,e)}convert(i){if(i==null)return this.nullable?i:this.nullValue;if(i=Number(i),isNaN(i))return;let e=this.precision;return e?(e=10**e,i=Math.round(i*e)/e):e===0&&(i=Math.round(i)),i}};y(ui,"$name","NumberDataField"),y(ui,"type","number"),y(ui,"alias","float"),ui.initClass(),ui._$name="NumberDataField";var Kl=class extends Ge{static get $name(){return"ObjectDataField"}static get type(){return"object"}static get prototypeProperties(){return{complexMapping:!0}}};Kl.initClass(),Kl._$name="ObjectDataField";var Fv=i=>typeof i=="string"&&i.startsWith("_generated"),Rn=class extends Ge{init(i,e){var t;const r=this,n=`${r.name}Store`,s={skipStack:!0,syncDataOnLoad:!0};if(r.store&&x.assign(s,r.store),r.modelClass&&(s.modelClass=r.modelClass),(t=e[`init${P.capitalize(n)}`])==null||t.call(e,s),!s.storeClass&&!r.storeClass)throw new Error(`Field '${r.name}' with type 'store' must have a storeClass configured`);const a=e.meta[n]=new(s.storeClass||r.storeClass)(s);r.complexMapping?x.setPath(i,r.dataSource,a):i[r.dataSource]=a,a.verifyNoGeneratedIds=!1,a.usesId=!a.count||!a.every(l=>l.hasGeneratedId),a.$currentValue=r.getValue(a),a.ion({change:({action:l})=>{const o=r.getValue(a);if(!a.$isSettingStoreFieldData){const u=a.$preserveCurrentDataset;a.$preserveCurrentDataset=r.subStore&&(l==="update"||l==="remove"||l==="add"),r.$isUpdatingRecord=!0,e.set(r.name,o),r.$isUpdatingRecord=!1,a.$preserveCurrentDataset=u}a.$currentValue=o}})}set(i,e,t){var r,n;const s=this,a=`${s.name}Store`,{[a]:l}=t.meta;if(!l)return t.meta.initableValues.set(s,i),!1;l.$isSettingStoreFieldData||(l.$isSettingStoreFieldData=!0,i=(n=(r=t[`process${P.capitalize(a)}Data`])==null?void 0:r.call(t,i,t))!=null?n:i,l.$preserveCurrentDataset||(l.data=i),l.$isSettingStoreFieldData=!1,l.usesId=!l.count||!l.every(o=>o.hasGeneratedId))}serialize(i,e){const t=e.meta[`${this.name}Store`];return this.$isUpdatingRecord?this.getValue(t):t.$currentValue}getValue(i){return i.allRecords.map(e=>{const t=e.persistableData;return i.usesId||delete t.id,t})}isEqual(i,e){if(i==null&&e==null)return!0;if(i==null&&e!=null||i!=null&&e==null)return!1;if(i.isStore&&e.isStore)return x.isDeeplyEqual(i.$currentValue,e.$currentValue);if(i.isStore&&e.isStore||!i.isStore&&!e.isStore)return x.isEqual(i,e,!0);{const t=i.isStore?i:e,r=t.modelClass,n=r.$meta.fields.defs,s=i.isStore?i.$currentValue:e.$currentValue,a=i.isStore?e:i;if(s.length!==a.length)return!1;for(let l=0;l<n.length;l++){const o=n[l];if(o.persist)for(let u=0;u<s.length;u++){const c=s[u][o.dataSource],d=a[u][o.dataSource];if(!(c!==void 0&&d===void 0&&(o.dataSource===r.idField&&Fv(c)||o.defaultValue!==void 0&&x.isEqual(o.defaultValue,c,!0)))&&!x.isEqual(c,d,!0))return!1}}return!0}}getOldValue(i){const e=i.meta[`${this.name}Store`];return e?x.clone(e.$currentValue):null}getAt(i,e){const t=i.meta[`${this.name}Store`];return t==null?void 0:t.getAt(e)}};y(Rn,"$name","StoreDataField"),y(Rn,"type","store"),Rn.initClass(),Rn._$name="StoreDataField";var vd=new RegExp(/^(.*?)\.(.*)/),Gl=/(.*)\[(.*)]\.?(.*)/,{defineProperty:Lv}=Reflect,{hasOwn:_n}=x,dt=void 0,$v={children:1,data:1,meta:1},Nv=["name","title","text","label","description"],Bv={boolean:1,number:1,date:1,object:1},yd={parentId:1,$PhantomId:2,id:3},bd=class zu extends F.mixin(dd,hd,gd){static get $name(){return"Model"}static get declarable(){return["fields"]}static get fields(){return[{name:"parentIndex",type:"number",persist:!1,internal:!0},{name:"orderedParentIndex",type:"number",persist:!1,internal:!0},{name:"readOnly",type:"boolean"},{name:"expanded",internal:!0},{name:"groupParent",persist:!1,internal:!0}]}static set idField(e){this._assignedIdField=!0,this._idField=e}static get idField(){return this._idField}static set childrenField(e){this._childrenField=e}static get childrenField(){if(!this._childrenField){const e=this.fieldMap.children;this._childrenField=(e==null?void 0:e.dataSource)||"children"}return this._childrenField}get indexPath(){const e=[];let t=this,r=t.childLevel;for(t=this;t&&!t.isRoot;t=t.parent)e[r--]=t.parentIndex+1;return e}construct(e={},t=null,r=null,n=!1,s=!1,a=!1){var l,o;const u=this,c=(l=z.asArray(t))!=null?l:[],{constructor:d,fieldMap:h}=u;let g=null;if(t=c[0],u.meta={modified:{},...d.metaConfig,...r},d.applyConfigs){g={},(!u.useRawData||!u.useRawData.enabled)&&(e={...e});const f=u.getDefaultConfiguration();if(d.autoExposeFields)for(const m in f)m in e&&(e[m]!==void 0&&(g[m]=e[m]),delete e[m]);else for(const m in e)m in d.fieldMap||(e[m]===void 0?g[m]=f[m]:g[m]=e[m],delete e[m])}if(super.construct(g),n||d.exposeProperties(e,a),!_n(d,"idFieldProcessed")){let f=u.meta.idField;f||(d._assignedIdField?f=d.idField:t&&(f=t.idField)),f&&f!==h.id.dataSource&&d.addField({name:"id",dataSource:f,internal:!0}),d._idField=h.id.dataSource,d.idFieldProcessed=!0}u._internalId=zu._internalIdCounter++,u.stores=[],u.unjoinedStores=[],u.originalData||(u.originalData=e),u.data=d.processData(e,!1,t,u,s),(o=u.meta.initableValues)!=null&&o.size&&u.assignInitables(),u.id==null&&u.setData("id",u.generateId(t)),u.data[d.childrenField]&&u.processChildren(c),u.generation=0}set isCreating(e){const t=this;!!t.meta.isCreating!==e&&(t.meta.isCreating=e,t.stores.forEach(r=>{r.onIsCreatingToggle(t,e)}))}get isCreating(){return!!this.meta.isCreating}equals(e){if(e instanceof this.constructor){for(let t=this.$meta.fields.defs,r=0,{length:n}=t;r<n;r++){const s=t[r],{name:a}=s;if(a!=="id"&&!s.isEqual(this.getValue(a),e.getValue(a)))return!1}return!0}return!1}get subclass(){return new this.constructor(Object.setPrototypeOf({id:dt},this.data),this.stores[0],null,!0)}static processData(e,t=!1,r,n,s){const{fieldMap:a,fieldDataSourceMap:l,defaultValues:o}=this,{useRawData:u={enabled:!1}}=r||{},c=s||u.enabled?e:x.clone(e);let d;if(t=t||u.disableDefaultValue||s,!t)for(d in o){const h=l[d];let g=o[d];Array.isArray(g)&&(g=g.slice()),h!=null&&h.complexMapping?x.getPath(c,d)===dt&&x.setPath(c,d,g):c[d]===dt&&(c[d]=g)}if(!u.disableTypeConversion&&!s)for(d in a){const h=a[d],{name:g,dataSource:f}=h,m=f!==g,p=h.complexMapping,v=m&&(p?x.pathExists(e,f):f in e),b=g in e&&(!m||!v),w=!u.disableTypeConversion&&h.convert;if((b||w)&&(!t||b||v)){const S=b?c[g]:p?x.getPath(c,f):c[f],C=w?h.convert(S,e,n):S;p?x.setPath(c,f,C):c[f]=C,m&&delete c[g]}}return this.$meta.fields.initable.length&&this.initInitables(n,c),c}static setupClass(e){super.setupClass(e),e.fields||this.setupFields(this,e)}static setupFields(e,t){var r,n,s,a,l;const o=_n(e,"fields")&&e.fields,u=t.super.fields,c=t.fields={defs:(r=u==null?void 0:u.defs.slice())!=null?r:[],exposedData:!1,defaults:u?{...u.defaults}:{},exposed:Object.create((n=u==null?void 0:u.exposed)!=null?n:null),ordinals:Object.create((s=u==null?void 0:u.ordinals)!=null?s:null),map:Object.create((a=u==null?void 0:u.map)!=null?a:null),sources:Object.create((l=u==null?void 0:u.sources)!=null?l:null)};_n(e,"defaults")&&Object.assign(c.defaults,e.defaults),_n(e,"idField")&&(e.addField({name:"id",dataSource:e.idField,internal:!0}),c.exposed[e.idField]=!0),o!=null&&o.length&&o.map(e.addField,e),c.initable=c.defs.filter(d=>d.init),e.exposeRelations()}static get defaultValues(){return this.$meta.fields.defaults}static get allFields(){return this.$meta.fields.defs}get allFields(){return this.$meta.fields.defs}static get fieldMap(){return this.$meta.fields.map}get fieldMap(){return this.$meta.fields.map}static get fieldDataSourceMap(){return this.$meta.fields.sources}static exposeProperties(e,t=!0){const r=this,n=r.$meta.fields,s=t?"exposed":"map";if(e&&r.autoExposeFields&&!n.exposedData){let a,l,o;for(a in e)!n[s][a]&&a!==r.childrenField&&(o=x.typeOf(e[a]),l={name:a,dataSource:a,fromData:!0},Bv[o]&&(l.type=o),r.addField(l));n.exposedData=!0}r.exposeRelations()}static addField(e){if(e==null)return;typeof e=="string"&&(e={name:e});const t=this.initClass(),r=t.$meta.fields,{ordinals:n}=r,s=r.exposed,{name:a}=e,l=r.map[a],o=e.dataSource||(e.dataSource=a);let u,c;if(!l||e.type&&e.type!==l.type)u=Ge.create(e),u.definedBy=l?l.definedBy:t,u.ordinal=l?l.ordinal:n[a]=r.defs.length;else{u=Object.create(l);for(c in e)c!=="type"&&(u[c]=e[c])}return u.owner=t,r.defs[u.ordinal]=u,r.map[a]=u,r.sources[o]||(r.sources[o]=u),o.includes(".")&&(u.complexMapping=!0),u.complexMapping?s[o.split(".")[0]]=!0:s[o]=!0,"defaultValue"in u&&(r.defaults[o]=u.defaultValue),$v[a]||u.defineAccessor(t.prototype),t._nonPersistableFields=null,t._alwaysWriteFields=null,u}static removeField(e){const t=this.initClass(),r=t.$meta.fields,n=r.map[e],{ordinals:s}=r,a=s[e];if(n){r.defs.splice(a,1),delete s[e],delete r.defaults[e],delete r.exposed[e],delete r.map[e],delete r.sources[n.dataSource];for(const l in s)s[l]>a&&--s[l];delete t.prototype[e]}}static exposeRelations(){const e=this;if(!_n(e,"exposedRelations")&&e.relations){e.exposedRelations=[];for(const t in e.relations){const r=e.relations[t];r.relationName=t,e.exposedRelations.push(r),Reflect.ownKeys(e.prototype).includes(t)||Lv(e.prototype,t,{enumerable:!0,get:function(){return this.getForeign(t)},set:function(n){this.setForeign(t,n,r)}})}}}static initInitables(e,t){const r=e.meta.initableValues=new Map;for(const n of this.$meta.fields.initable){const s=x.getPath(t,n.dataSource);s!==void 0&&r.set(n,s),!n.lazy&&n.init(t,e)}}assignInitables(){const{initableValues:e}=this.meta;for(const[t,r]of e)t.set(r,this.data,this)!==!1&&e.delete(t)}static get autoExposeFields(){return!0}static fieldSorter(e,t){return(yd[e]||100)-(yd[t]||100)}get fields(){return this.$meta.fields.defs}getFieldDefinition(e){return this.constructor.getFieldDefinition(e)}getFieldDefinitionFromDataSource(e){return this.$meta.fields.sources[e]}get fieldNames(){return Object.keys(this.data)}static getFieldDefinition(e){var t,r;const n=this.fieldMap[e];if(!n){if(e.includes("[")){const[,s,,a]=e.match(Gl),l=s.includes(".")?this.getFieldDefinition(s):this.fieldMap[s];if(l!=null&&l.isStoreDataField)return(t=l.modelClass)==null?void 0:t.getFieldDefinition(a)}else if(e.includes(".")){const[s,a]=e.split(".",2),l=this.fieldMap[s];if(l.isModelDataField&&l.modelClass)return(r=l.modelClass)==null?void 0:r.getFieldDefinition(a)}}return n}static getFieldDataSource(e){var t;return((t=this.getFieldDefinition(e))==null?void 0:t.dataSource)||e}getDataSource(e){const t=this.constructor.getFieldDefinition(e);return(t==null?void 0:t.dataSource)||(t==null?void 0:t.name)}static processField(e,t,r){const n=this.fieldMap[e];return n!=null&&n.convert?n.convert(t,this.data,r):t}initRelations(){const e=this;e.constructor.exposedRelations&&e.stores.forEach(r=>{var n;r.modelRelations||r.initRelations();const s=[];(n=r.modelRelations)==null||n.forEach(a=>{s.push({related:e.initRelation(a),config:a})}),r.updateRecordRelationCache(e,s)})}initRelation(e){const t=this,r=t.get(e.foreignKey),n=r!==dt&&typeof e.foreignStore!="string"&&e.foreignStore.getById(r),s=t.meta.relationCache||(t.meta.relationCache={});return s[e.relationName]=n||(r!=null?{id:r,placeHolder:!0}:null),n}removeRelation(e){const{relationName:t,foreignKey:r,nullFieldOnRemove:n}=e;this.meta.relationCache[t]&&(delete this.meta.relationCache[t],n&&this.setData(r,null))}getForeign(e){var t;return(t=this.meta.relationCache)==null?void 0:t[e]}setForeign(e,t,r){const n=zu.asId(t);return this.set(r.foreignKey,n)}getRelationConfig(e){var t,r;return(r=(t=this.firstStore)==null?void 0:t.modelRelations)==null?void 0:r.find(n=>n.foreignKey===e)}flatGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:t in this.data?this.data[t]:this.data[e]}complexGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:x.getPath(this.data,t)}get(e){if(!e)return;const t=this,r=t.fieldMap[e];if(!r){if(e.includes("[")){const[,n,s,a]=e.match(Gl),l=t.fieldMap[n];if(l!=null&&l.getAt){t._thisIsAUsedExpression(t[n]);const o=l.getAt(t,s);return o&&a?o.isModel?o.getValue(a):o[a]:o}return null}if(e.includes("."))return x.hasPath(t.data,e)?t.complexGet(e,e):x.getPath(t,e)}return r!=null&&r.complexMapping?t.complexGet(e,r.dataSource):t.flatGet(e,(r==null?void 0:r.dataSource)||e)}getValue(e){if(e)return e in this?this[e]:this.get(e)}setValue(e,t){e in this?this[e]=t:this.set(e,t)}setData(e,t){var r,n;const{data:s,fieldMap:a}=this;if(typeof e=="string"){const l=a[e],o=(r=l==null?void 0:l.dataSource)!=null?r:e;l!=null&&l.set?l.set(t,this.data,this):l!=null&&l.complexMapping?x.setPath(s,o,t):s[o]=t}else{const l=Object.keys(e);for(let o=0;o<l.length;o++){const u=l[o],c=a[u],d=(n=c==null?void 0:c.dataSource)!=null?n:u;c!=null&&c.set?c.set(t,this.data,this):d&&(c!=null&&c.complexMapping?x.setPath(s,d,e[u]):s[d]=e[u])}}}getData(e){var t;const r=this.fieldMap[e],n=(t=r==null?void 0:r.dataSource)!=null?t:e;if(n)return r!=null&&r.complexMapping?x.getPath(this.data,n):this.data[n]}syncId(e){const t=this.id;if(t!==e){this.setData("id",e);const r={id:{value:e,oldValue:t}};this.afterChange(r,r)}}set(e,t,r=!1,n=!1,s=!1,a=!1,l=!0){var o;const u=this;if(u.isBatchUpdating)return u.inBatchSet(e,t,r||u.$silenceBatch),null;{const c=u.inSet(e,t,r,n,s,a,l);return(o=u.afterSet)==null||o.call(u,e,t,r,n,c),c}}fieldToKeys(e,t){return typeof e!="string"?x.assign({},e):{[e]:t}}inBatchSet(e,t,r){const n=this,{meta:s,constructor:a,fieldMap:l}=n,o={};let u,c=!1;if(typeof e!="string"?Object.keys(n.fieldToKeys(e,t)).forEach(d=>{u=l[d]||x,t=a.processField(d,e[d],n),u.isEqual(s.batchChanges[d],t)||(o[d]={value:t,oldValue:n.get(d)},s.batchChanges[d]=t,c=!0)}):(u=l[e]||x,u.isEqual(s.batchChanges[e],t)||(o[e]={value:t,oldValue:n.get(e)},s.batchChanges[e]=t,c=!0)),c&&(n.generation++,!r)){const d={action:"update",record:n,records:[n],changes:o};n.stores.forEach(h=>{h.trigger("batchedUpdate",{...d})}),n.forEachLinked((h,g)=>h.trigger("batchedUpdate",{...d,record:g,records:[g]}))}}inSet(e,t,r,n,s=!1,a=!1,l=!0){var o,u,c;const d=this,{data:h,meta:g,fieldMap:f,constructor:m}=d,{prototype:p,childrenField:v,relations:b}=m,w={},S=d.fieldToKeys(e,t),C=Object.keys(S).sort(m.fieldSorter);let T=!1;if(!r&&l&&!d.triggerBeforeUpdate(S))return null;d.inSetting=!0;for(let E=0;E<C.length;E++){const I=C[E];if(I===v)continue;if(I.includes("[")){const[,he,ge,be]=I.match(Gl),Ue=d.fieldMap[he];if(Ue!=null&&Ue.getAt){const Nt=Ue.getAt(d,ge);Nt.isModel?Nt.set(be,S[I]):x.setPath(Nt,be,S[I]);continue}}const R=I.includes(".");if(b&&R){const[,he,ge]=I.match(vd);if(b[he]){d[he].set(ge,S[I]);continue}}const M=f[I],O=M||x,A=M==null?void 0:M.readOnly,B=(o=M==null?void 0:M.dataSource)!=null?o:I,L=!s&&!M&&I in p||(M==null?void 0:M.useProp),Y=L?d[B]:M!=null&&M.complexMapping||R?x.getPath(h,B):h[B],K=m.processField(I,S[I],d),W=S[I]={value:K},Z=d.getRelationConfig(I),G=(he,ge)=>O.isEqual(he,ge)||he==null&&ge==null;!A&&!G(Y,K)&&(!a||K!==void 0)&&(d.generation++,W.oldValue=(c=(u=M==null?void 0:M.getOldValue)==null?void 0:u.call(M,d))!=null?c:Y,T=!0,I in g.modified&&G(g.modified[I],K)?(Reflect.deleteProperty(g.modified,I),d.isReverting&&(d.data[B]=K)):d.ignoreBag||(I in g.modified||d.storeFieldChange(I,Y),W.oldValue===dt&&Reflect.deleteProperty(W,"oldValue")),w[I]=W,d.applyValue(L,B,K,s,M),Z&&!n&&(d.initRelation(Z),d.stores.forEach(he=>he.cacheRelatedRecord(d,K,Z.relationName,W.oldValue))))}return T&&d.afterChange(S,w,r,n,s),d.inSetting=!1,T?w:null}applyValue(e,t,r,n,s){var a;const l=this;if(((s==null?void 0:s.dataSource)||t)===l.constructor.idField&&(l.$isPhantom=!1),((s==null?void 0:s.dataSource)||t)===l.constructor.parentIdField)(a=l.parent)!=null&&a.isRoot&&(r==null||!l.firstStore.getById(r))||(l.firstStore.getById(r)||l.firstStore.rootNode).insertChild(l,null,!1,{orderedParentIndex:{skip:!0}});else if(e)l[(s==null?void 0:s.name)||t]=r;else if(s!=null&&s.set)s.set(r,l.data,l);else{let o=s==null?void 0:s.complexMapping;if(!s&&t.includes(".")){const u=t.split(".")[0];s=l.constructor.fieldMap[u],o=(s==null?void 0:s.complexMapping)||(s==null?void 0:s.type)==="object"}o?x.setPath(l.data,t,r):l.data[t]=r}}afterChange(e,t,r,n,s){for(const a of this.stores)a.onModelChange(this,e,t,r,n,s);this.forEachLinked((a,l)=>a.onModelChange(l,e,t,r,n,s))}forEachLinked(e){for(const t of this.$links)for(const r of t.stores)e(r,t)}get isPersistable(){return!this.isBatchUpdating&&!this.isCreating}get isModified(){return!!(this.meta.modified&&Object.keys(this.meta.modified).length>0)}get hasPersistableChanges(){return this.isPersistable&&!x.isEmpty(this.rawModificationData)}isFieldModified(e){return this.isModified&&e in this.meta.modified}getFieldPersistentValue(e){const t=typeof e=="string"?this.getFieldDefinition(e):e,r=(t==null?void 0:t.name)||e;let n;return(!t||t.persist)&&(n=this.getValue(r),t!=null&&t.serialize&&(n=t.serialize(n,this))),n}get modifications(){const e=this.rawModifications;return e&&Object.keys(e).length&&(e[this.constructor.idField]=this.id),e}get rawModifications(){const e=this,t={};if(!e.isModified)return null;let r=!1;return Object.keys(e.meta.modified).forEach(n=>{const s=e.getFieldPersistentValue(n);s!==dt&&(t[n]=s,r=!0)}),r?t:null}get modificationData(){const e=this.rawModificationData;return e&&Object.keys(e).length&&x.setPath(e,this.constructor.idField,this.id),e}get rawModificationData(){const e=this,{fieldMap:t}=e.constructor,r={};if(!e.isModified)return null;let n=!1;return Object.keys(e.meta.modified).forEach(s=>{let a=t[s],l=a==null?void 0:a.dataSource;if(s.includes(".")){const o=s.match(vd)[1];a=t[o],l=s}if(a!=null&&a.persist){const o=e.getFieldPersistentValue(s);o!==dt&&(x.setPath(r,l,o),n=!0)}}),n?r:null}get modificationDataToWrite(){const e=this.constructor.alwaysWriteFields,t=this.modificationData;return e.forEach(r=>{t[this.getFieldDefinition(r).dataSource]=this.getFieldPersistentValue(r)}),t}get persistableData(){const e=this,t={};return e.fields.forEach(r=>{const n=e.getFieldPersistentValue(r);n!==dt&&(r!=null&&r.complexMapping?x.setPath(t,r.dataSource,n):t[r.dataSource]=n)}),t}get dataByFieldName(){const{data:e}=this;return this.fields.reduce((t,r)=>(x.hasPath(e,r.dataSource)&&(t[r.name]=e[r.dataSource]),t),{})}get isCommitting(){return!!this.meta.committing}clearChanges(e=!0,t=!0,r=null){const n=this,{meta:s}=n;if(r)for(const l in r)delete s.modified[l];else s.modified={};const a=x.isEmpty(s.modified);s.committing=!1,t&&n.stores.forEach(l=>{if(a&&l.modified.remove(n),l.added.remove(n),e){const o=l.collectDescendants(n).all;l.added.remove(o),a&&l.modified.remove(o)}})}storeFieldChange(e,t){this.meta.modified[e]=t}revertChanges(e=!1){this.isReverting=!0,this.set(this.meta.modified,dt,e),this.isReverting=!1}setByDataSource(e){var t;const r=this,{fieldDataSourceMap:n}=r.constructor,s=x.pathifyKeys(e,n),a={};for(const l in s){const o=n[l],u=(t=o==null?void 0:o.name)!=null?t:l;a[u]=s[l]}return r.set(a)}applyChangeset(e,t="$PhantomId",r=!0){var n;const s=this,a=s.constructor,{idField:l,fieldDataSourceMap:o}=a,u=x.pathifyKeys(e,o),c=x.pathifyKeys(s.modificationData),d={},h=t in e&&!(l in e);!h&&t in u&&delete u[t];for(const f in u){const m=o[f],p=(n=m==null?void 0:m.name)!=null?n:f;(r||((m==null?void 0:m.name)===l?h:u[f]===c[f]))&&(d[p]=u[f])}const g=s.set(d);return s.clearChanges(!1,!0,r?null:d),g?Object.entries(g).reduce((f,[m,p])=>(f[m]=p.value,f),{}):{}}get internalId(){return this._internalId}get isPhantom(){return this.id===""||this.id==null||this.hasGeneratedId||!!this.$isPhantom}get isModel(){return!0}get hasGeneratedId(){return typeof this.id=="string"&&this.id.startsWith("_generated")}static generateId(e=this.$$name){return`_generated${e}_${P.generateUUID()}`}generateId(){return this.constructor.generateId()}static asId(e){return e!=null&&e.isModel?e.id:x.isObject(e)?e[this.fieldMap.id.dataSource]:e}get json(){return P.safeJsonStringify(this)}toJSON(){const{children:e,unfilteredChildren:t}=this,r=this.persistableData;return(t||e)&&(r[this.constructor.childrenField]=(t||e).map(n=>n.toJSON())),r}toString(){const e=this,t=Nv.find(n=>n in e.constructor.fieldMap),r=t?{[e.constructor.idField]:e.id,[t]:e[t]}:e.data;return P.safeJsonStringify(r)}get isBatchUpdating(){return!!this.batching}hasBatchedChange(e){var t,r;return(r=(t=this.meta)==null?void 0:t.batchChanges)==null?void 0:r[e]}beginBatch(e=!1){const t=this;t.batching||(t.batching=0,t.meta.batchChanges={}),e&&(t.$silenceBatch=(t.$silenceBatch||0)+1),t.batching++}endBatch(e=!1,t=!1,r=!0){const n=this,{parentIdField:s}=n.constructor;if(n.batching&&(n.batching--,n.$silenceBatch&&n.$silenceBatch--,!(n.batching>0)&&!x.isEmpty(n.meta.batchChanges))){let{batchChanges:a}=n.meta;n.meta.batchChanges=null,a[s]&&(a={...a},n.parentId=a[s],delete a[s]),n.set(a,dt,e,!1,t,void 0,r)}}cancelBatch(){if(this.batching){const e=this,{batchChanges:t}=e.meta,r={};if(e.batching=null,e.meta.batchChanges=null,e.generation++,!e.$silenceBatch){Object.entries(t).forEach(([s,a])=>{r[s]={oldValue:a,value:e[s]}});const n={action:"update",record:e,records:[e],changes:r};e.stores.forEach(s=>{s.trigger("batchedUpdate",{...n})}),e.forEachLinked((s,a)=>{s.trigger("batchedUpdate",{...n,record:a,records:[a]})})}e.$silenceBatch&&e.$silenceBatch--}}triggerBeforeUpdate(e){var t;return!((t=this.stores)!=null&&t.some(r=>r.trigger("beforeUpdate",{record:this,changes:e})===!1))}copy(e=null,t){const r=this,n=x.clone(r.data),s=r.constructor.idField,a=x.isObject(t)?t.deep:t;let l;if(e&&typeof e=="object"?(l=e[s],Object.assign(n,e)):l=e,a&&r.children?n.children=r.children.map(u=>u.copy(void 0,t)):(delete n.children,delete n.expanded),r.$meta.fields.initable.length>0){const u=r.toJSON();for(const c of r.$meta.fields.initable)n[c.name]=u[c.name]}e!==!1&&(n[s]=l||r.generateId(r.firstStore));const o=new r.constructor(n,null,null,!1,!0);return o.originalInternalId=r.internalId,o}copyData(e,t,r){const n={};e.allFields.forEach(({name:s})=>{s!==e.constructor.idField&&(n[s]=t?e.get(s):e.getValue(s))}),this.set(n,null,r)}remove(e=!1){const t=this,{parent:r,stores:n}=t;r?r.removeChild(t):n.length&&!t.isSpecialRow&&n.slice().forEach(a=>a.remove(t,e,!1,!0))}beforeRemove(e,t){return super.beforeRemove(e,t)}get isValid(){return!0}get firstStore(){return this.stores.length>0&&this.stores[0]}joinStore(e){var t;const r=this,{stores:n}=r;if(!n.includes(e)){const{unjoinedStores:s}=r;super.joinStore(e),e.register(r),n.push(e),s.includes(e)&&s.splice(s.indexOf(e),1),r.isLoaded&&r.children.forEach(a=>a.joinStore(e)),r.initRelations(),e.tree&&!r.isRoot&&!((t=e.stm)!=null&&t.isRestoring)&&(r.instanceMeta(e.id).collapsed=!r.expanded)}}unjoinStore(e,t=!1){var r,n,s;const a=this,{stores:l,unjoinedStores:o}=a;l.includes(e)&&(e.isDestroying||(e.unregister(a),o.push(e)),(n=(r=a.unfilteredChildren||a.children)==null?void 0:r.forEach)==null||n.call(r,u=>u.unjoinStore(e,t)),l.splice(l.indexOf(e),1),(s=super.unjoinStore)==null||s.call(this,e,t),e.uncacheRelatedRecord(a))}isPartOfStore(e){return e?e.includes(this):this.stores.length>0}get isRemoved(){return!this.isPartOfStore()}instanceMeta(e){var t;const{meta:r}=this,n=e.id||e;return((t=r.map)==null?void 0:t[n])||this.setInstanceMeta(n,{})}setInstanceMeta(e,t){const{meta:r}=this,n=e.id||e;return r.map||(r.map={}),r.map[n]=t}get isGroupHeader(){return"groupRowFor"in this.meta}get isGroupFooter(){return"groupFooterFor"in this.meta}get isSpecialRow(){var e;return!!((e=this.meta)!=null&&e.specialRow)}get $original(){return this.isLinked?this.proxyMeta.originalRecord:this}static get nonPersistableFields(){const e=this;return e._nonPersistableFields||(e._nonPersistableFields={},e.allFields.forEach(t=>{(!t.persist||t.calculated)&&(e._nonPersistableFields[t.name]=1)})),e._nonPersistableFields}static get alwaysWriteFields(){const e=this;return e._alwaysWriteFields||(e._alwaysWriteFields=[],e.allFields.forEach(t=>{t.alwaysWrite&&e._alwaysWriteFields.push(t.name)})),e._alwaysWriteFields}get domId(){return typeof this.id=="string"?this.id.replace(/[ .]/g,"-"):this.id}static toJavaScriptValue(e){const{names:t}=this.$meta,r=t[t.length-2],n=t[t.length-3];return`class ${r} extends ${n} { static fields = ${P.toJavaScriptValue(this.fields,e)}; }`}getCurrentConfig(e){const{data:t,children:r}=this,{defaultValues:n,applyConfigs:s}=this.constructor,a=s?super.getCurrentConfig(e):{};if(a){for(const l of this.fields)if(l.persist){const o=x.getPath(t,l.dataSource);l.isEqual(o,n[l.name])||x.setPath(a,l.dataSource,F.processConfigValue(o,e))}if(r)if(Array.isArray(r)){a.children=[];for(const l of r)a.children.push(l.getCurrentConfig(e))}else a.children=r;this.hasGeneratedId&&delete a.id,delete a.parentId,delete a.parentIndex}return a}};y(bd,"relations",null);var Q=bd;Q._idField="id",Q._internalIdCounter=1,Q._assignedIdField=!1,Q.exposeProperties(),Q._$name="Model";var Re=class gm{constructor(e,t){typeof e=="number"||e===null?(this._magnitude=e,this._unit=t):(typeof e=="string"&&Object.assign(this,k.parseDuration(e)),typeof e=="object"&&Object.assign(this,e))}get magnitude(){return this._magnitude}set magnitude(e){this._magnitude=typeof e=="number"&&e}get unit(){return this._unit}set unit(e){this._unit=k.parseTimeUnit(e)}get isValid(){return this._magnitude!=null&&!!k.normalizeUnit(this._unit)}get milliseconds(){return this.isValid?Math.round(k.asMilliseconds(this._magnitude,this._unit)):0}isEqual(e){return!!e&&this._magnitude!=null&&e._magnitude!=null&&this.milliseconds===e.milliseconds}toString(e){const t=this,r=e?"getShortNameOfUnit":"getLocalizedNameOfUnit";return t.isValid?`${t._magnitude} ${k[r](t._unit,t._magnitude!==1)}`:""}toJSON(){return this.toString()}valueOf(){return this.milliseconds}diff(e){return new gm({unit:this.unit,magnitude:k.as(this.unit,this.milliseconds-e.milliseconds)})}};Re._$name="Duration";var Vv=(i,e)=>i==null?void 0:i[e],jv=/^is(this|next|last)(week|month|year)$/i,zv=["isToday","isTomorrow","isYesterday","isThisWeek","isNextWeek","isLastWeek","isThisMonth","isNextMonth","isLastMonth","isThisYear","isNextYear","isLastYear","isYearToDate"],Cd=class ll extends F.mixin(ai){static get defaultConfig(){return{value:null,operator:null,filterBy:null,convert:null,caseSensitive:!0,id:null,type:null,internal:null,disabled:!1}}static get configurable(){return{property:null}}construct(e){typeof e=="function"&&(e={filterBy:e}),e.type?e.type==="date"&&e.value!=null&&!Array.isArray(e.value)?e.value=new Date(e.value):e.type==="duration"&&e.value!=null&&!Array.isArray(e.value)&&(e.value=new Re(e.value)):k.isDate(e.value)||Array.isArray(e.value)&&e.value.every(k.isDate)?e.type="date":e.value instanceof Re&&(e.type="duration"),super.construct(e)}get id(){return this._id||(this.internal?this._id=ll.generateId(`b-internal-${this.property}-filter-`):this._id=this.property||ll.generateId("b-filter-")),this._id}set id(e){this._id=e}onChange(e){var t;const r=this;!r.isConfiguring&&((t=r.owner)!=null&&t.onFilterChanged)&&!r.owner.isConfiguring&&r.owner.onFilterChanged(r,e)}get filterBy(){return this._filterBy||this.defaultFilterBy}set filterBy(e){this._filterBy=e}defaultFilterBy(e){const t=this;let r;return e.isModel?r=e.getValue(t.property):t._propertyItems.length>1?r=t._propertyItems.reduce(Vv,e):r=e[t.property],t[t.operator](t.convert(r))}updateProperty(e){this._propertyItems=e.split("."),this.onChange("property")}set value(e){const t=this;t._value=e,Array.isArray(e)&&({date:1,duration:1}[t.type]||e.length>0&&typeof e[0]=="string")?t._filterValue=e.map(r=>t.convert(r)):!t.caseSensitive&&Array.isArray(e)&&e.length>0&&typeof e[0]=="string"?t._filterValue=e.map(r=>r==null?void 0:r.toLowerCase()):!t.caseSensitive&&typeof e=="string"?t._filterValue=e.toLowerCase():t._filterValue=t.convert(e),t.onChange("value")}get value(){return this._value}get filterValue(){return this._filterValue}set operator(e){this._operator=e,this.onChange("operator")}get operator(){const e=this;return e._operator?e._operator:Array.isArray(e.filterValue)?"isIncludedIn":typeof e.filterValue=="string"?"*":"="}convert(e){var t;return this.operator!=="sameTime"&&!(typeof this.filterValue=="string"&&e instanceof Date)&&(this.operator==="sameDay"&&(e=k.clearTime(e)),e=(t=e==null?void 0:e.valueOf())!=null?t:e),e=!this.caseSensitive&&typeof e=="string"?e.toLowerCase():e,e}filter(e){return this.filterBy(e)}startsWith(e){return String(e).startsWith(this.filterValue)}endsWith(e){return String(e).endsWith(this.filterValue)}isIncludedIn(e){return this.filterValue.length===0||this.filterValue.includes(e)}isNotIncludedIn(e){return!this.isIncludedIn(e)}includes(e){return this.filterValue.length===0||String(e).includes(this.filterValue)}doesNotInclude(e){return!this.includes(e)}sameTime(e){return k.isSameTime(e,this.filterValue)}sameDay(e){return e===this.filterValue}"="(e){return x.isEqual(e,this.filterValue)}"!="(e){return!x.isEqual(e,this.filterValue)}">"(e){return x.isMoreThan(e,this.filterValue)}">="(e){return x.isMoreThan(e,this.filterValue)||x.isEqual(e,this.filterValue)}"<"(e){return x.isLessThan(e,this.filterValue)}"<="(e){return x.isLessThan(e,this.filterValue)||x.isEqual(e,this.filterValue)}"*"(e){return x.isPartial(e,this.filterValue)}between(e){const[t,r]=this._filterValue;return(x.isMoreThan(e,t)||x.isEqual(e,t))&&(x.isLessThan(e,r)||x.isEqual(e,r))}notBetween(e){return!this.between(e)}empty(e){return e==null||String(e).length===0}notEmpty(e){return!this.empty(e)}isToday(e){return this.between(e)}isTomorrow(e){return this.between(e)}isYesterday(e){return this.between(e)}isThisWeek(e){return this.between(e)}isNextWeek(e){return this.between(e)}isLastWeek(e){return this.between(e)}isThisMonth(e){return this.between(e)}isNextMonth(e){return this.between(e)}isLastMonth(e){return this.between(e)}isThisYear(e){return this.between(e)}isNextYear(e){return this.between(e)}isLastYear(e){return this.between(e)}isYearToDate(e){return this.between(e)}isTrue(e){return e===!0}isFalse(e){return e===!1}setRelativeDateValues(){this._filterValue=ll.getRelativeDateRange(this._operator).map(e=>e.valueOf())}static getRelativeDateRange(e,t=new Date){let r,n,s,a,l,o,u;switch(e){case"isYearToDate":return[k.floor(t,"1 year"),t];case"isToday":return r=k.floor(t,"1 day"),[r,k.add(r,1,"day")];case"isYesterday":return r=k.floor(t,"1 day"),[k.add(r,-1,"day"),r];case"isTomorrow":return n=k.getStartOfNextDay(t),[n,k.add(n,1,"day")];case"isThisWeek":case"isNextWeek":case"isLastWeek":case"isThisMonth":case"isNextMonth":case"isLastMonth":case"isThisYear":case"isNextYear":case"isLastYear":if(s=e.toLowerCase().match(jv),!s)throw new Error(`Unrecognized relative date expression: ${e}`);return[,o,u]=s,a=`1 ${u}`,l=k.floor(t,a),o==="next"?l=k.add(l,1,u):o==="last"&&(l=k.add(l,-1,u)),[l,k.add(l,1,u)]}}static generateFiltersFunction(e){if(!e||!e.length&&!e.count)return ue.returnTrue;for(const t of e)t.type==="date"&&zv.includes(t._operator)&&t.setRelativeDateValues();return function(t){let r=!0;for(const n of e)if(n.disabled||(r=n.filter(t)),!r)break;return r}}};y(Cd,"$name","CollectionFilter");var Oe=Cd;Oe._$name="CollectionFilter";var Sd=x.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null)),On=class{static generateId(i="generatedId"){return i+(Sd[i]=(Sd[i]||0)+1)}};On._$name="IdHelper";var An=class extends F{static get defaultConfig(){return{property:null,direction:"ASC",sortFn:null,convert:null,id:null,useLocaleSort:null}}construct(i){typeof i=="function"&&(i={sortFn:i}),super.construct(i)}get id(){return this._id||(this._id=this.property||On.generateId("b-sorter"))}set id(i){this._id=i}set sortFn(i){this._sortFn=i}get sortFn(){return this._sortFn?this._sortFn:this.defaultSortFn}defaultSortFn(i,e){const t=this,{convert:r,property:n,useLocaleSort:s}=t,a=t.direction.toLowerCase()==="desc"?-1:1;if(i=i[n],e=e[n],r&&(i=r(i),e=r(e)),s&&i!=null&&e!=null&&typeof i=="string"){if(s===!0)return String(i).localeCompare(e);if(typeof s=="string")return String(i).localeCompare(e,s);if(typeof s=="object")return String(i).localeCompare(e,s.locale,s)}return(i>e?1:i<e?-1:0)*a}static generateSortFunction(i,e){const t=i.isCollection?i.values:i,r=t.length;return(n,s)=>{let a,l;for(l=0;l<r;++l)if(a=t[l].sortFn(n,s),a)return a;return e?e(n,s):0}}};An._$name="CollectionSorter";var Wv=()=>0,Hv=(i,e)=>e-i,Xl=Symbol("filteredIndicesProperty"),ci=Object.freeze([]),Yv=Object.freeze({action:"sort",added:ci,removed:ci,replaced:ci}),Uv=Object.freeze({action:"filter",added:ci,removed:ci,replaced:ci}),Sr={string:1,number:1};function wd(i,e,t,r){if(e.unique!==!1)e.set(t,i),r&&e.count++;else{let n=e.get(t);n||(n=new Set,e.set(t,n)),n.add(i)}}function qv(i,e,t){e.unique!==!1?e.delete(t):e.has(t)&&(e.get(t).delete(i),e.get(t).size||e.delete(t))}function Dd(i,e,t,r,n=!1){for(let s=0;s<i.length;s++){const a=i[s];for(let l=0;l<r;l++){const o=t[l],u=a[o],c=e[o];wd(a,c,u,!n&&c.onDuplicate)}}}var wr=class Wu extends F.mixin(fe){constructor(){super(...arguments),y(this,"_sortFunction",null),y(this,"_addedValues",null)}static get configurable(){return{idProperty:"id",extraKeys:null,autoFilter:!0,autoSort:!0,sorters:{$config:["lazy"],value:[]}}}get isCollection(){return!0}construct(e){this.generation=0,this._values=[],super.construct(e)}doDestroy(){var e;super.doDestroy();const t=this;t._values.length=0,t.isFiltered&&(t._filteredValues.length=0,t.filters.destroy()),(e=t._sorters)==null||e.destroy()}clear(){const e=this,t=e._values.slice();e.totalCount&&(e._values.length=0,e._filteredValues&&(e._filteredValues.length=0),e._indicesInvalid=!0,e.generation++,e.trigger("change",{action:"clear",removed:t}))}equals(e,t){if(e.isCollection&&(e=e.values),e.length===this.count){let{values:r}=this;return t&&(e=e.map(t),r=r.map(t)),z.delta(e,r).inBoth.length===this.count}return!1}replaceValues({values:e,filteredValues:t,silent:r=!1,isNewDataset:n=!1}){const s=this;let a,l;s.isFiltered&&!n?(!!t?e&&(a=s._values,s._values=e.slice()):(t=e.slice(),e=null),l=s._filteredValues,s._filteredValues=t.slice()):(a=s._values,s._values=e.slice(),t=null,s.isFiltered&&n&&s.autoFilter?(s._filterFunction=null,s._filteredValues=s._values.filter(s.filterFunction)):s._filteredValues&&(s._filteredValues.length=0)),s._indicesInvalid=!0,s._addedValues=void 0,s.generation++,r||s.trigger("change",{action:"replaceValues",replacedValues:a,replacedFilteredValues:l,values:e,filteredValues:t})}set values(e){this.invalidateIndices(),this.splice(0,this._values.length,e)}get values(){return this.isFiltered?this._filteredValues:this._values}get filteredValues(){return this._filteredValues}[Symbol.iterator](){return this.values[Symbol.iterator]()}forEach(e,t=!1){(this.isFiltered&&!t?this._filteredValues:this._values).forEach(e)}map(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).map(e)}reduce(e,t=!1,r=[]){return(this.isFiltered&&!t?this._filteredValues:this._values).reduce(e,r)}find(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).find(e)}get first(){return this.values[0]}get last(){return this.values[this.count-1]}get allValues(){return this._values}get addedValues(){return this._addedValues}match(e,t=!0){const r=this,{_values:n}=r,s=[];return r.forEach(a=>{const l=e.get(a.id,!0);if(l){const o=r.indexOf(a,!0),u=n[o];n[o]=l,r.removeFromIndices(u),r.addToIndices(l)}else t&&s.push(a)}),s.length&&r.remove(s),r.isFiltered&&(r._filteredValues=r._values.filter(r.filterFunction)),s}add(...e){e.length===1?this.splice(this._values.length,null,...e):this.splice(this._values.length,null,e)}remove(...e){e.length===1?this.splice(0,...e):this.splice(0,e)}move(e,t){for(e=z.asArray(e);e.length&&e[0]===t;)e.shift();if(!e.length)return;const r=this,{_values:n}=r,s=r.indexOf(e[0],!0);if(e.length===1&&n[s+1]===t)return;r.suspendEvents(),r.remove(e),r.resumeEvents();const a=t?r.indexOf(t,!0):n.length;if(a===-1)throw new Error("Collection move beforeItem parameter must be present in Collection");return n.splice(a,0,...e),r._indicesInvalid=1,r.trigger("change",{action:"move",items:e,from:s,to:a}),a}splice(e=0,t,...r){const n=this,s=n.idProperty,a=n._values,l={},o=[],u=[],c=n.totalCount;let d,h;if((r==null?void 0:r.length)===1&&Array.isArray(r[0])&&(r=r[0]),n.trigger("beforeSplice",{index:e,toRemove:t,toAdd:r})!==!1){if(r)if(c&&r.length){const g=n.indices[s];d=[];for(let f=0;f<r.length;f++){const m=r[f],p=m[s],v=g.get(p),b=v?a.indexOf(v):-1;l[p]=!0,b!==-1?a[b]!==m&&(u.push([a[b],m]),a[b]=m):d.push(m)}}else d=r;if(t){if(typeof t=="number"){t=Math.min(t,a.length-e);for(let g=e;t;--t){const f=a[g][s];l[f]?(e++,g++):(o.push(a[g]),a.splice(g,1),h=!0)}}else{let g=d.length===0,f;t=z.asArray(t);const m=t.reduce((p,v)=>{const b=typeof v=="number",w=b?v:n.indexOf(v,!0);return g&&(f!=null&&w!==f+1||b)&&(g=!1),w>=0&&w<c&&p.push(w),f=w,p},[]).sort(Hv);if(g)m.length&&(o.push.apply(o,t),a.splice(m[m.length-1],m.length),h=!0);else for(let p=0;p<m.length;p++){const v=m[p];if(v!==-1){const b=a[v][s];l[b]||(o.unshift(a[v]),a.splice(v,1),h=!0)}}}o.length&&!n._indicesInvalid&&o.forEach(n.removeFromIndices,n)}if(d.length){a.splice(Math.min(e,a.length),0,...d),h=!0,n._indicesInvalid||d.forEach(n.addToIndices,n),n._addedValues||(n._addedValues=new Set);for(const g of d)n._addedValues.add(g)}if(o.length&&n._addedValues)for(const g of o)n._addedValues.delete(g);u.length&&!n._indicesInvalid&&u.forEach(g=>{n.removeFromIndices(g[0]),n.addToIndices(g[1])}),h||u.length?(n.isSorted?n.onSortersChanged():n.isFiltered&&(n.autoFilter?n.onFiltersChanged({action:"splice",oldCount:1}):n._filteredValues.splice(Math.min(e,n._filteredValues.length),0,...d)),n.generation++,n.trigger("change",{action:"splice",removed:o,added:d,replaced:u,oldCount:c})):n.trigger("noChange",{index:e,toRemove:t,toAdd:r})}}changeId(e,t){const r=this,{idProperty:n}=r,s=Sr[typeof e]?e:e[n],a=r.get(s);if(a){const l=r.get(t);if(l&&a!==l)throw new Error(`Attempt to set item ${s} to already existing member's id ${t}`);r.removeIndexEntry(e,n,s),r.addIndexEntry(e,n,t),a[n]=t}}get(e,t=!1){return this.getBy(this.idProperty,e,t)}getAt(e,t=!1){return this.isFiltered&&!t?this._filteredValues[e]:this._values[e]}getBy(e,t,r=!1){return this.findItem(e,t,this.isFiltered&&r)}get count(){return this.values.length}get totalCount(){return this._values.length}updateIdProperty(e){this.addIndex({property:e,unique:!0})}changeSorters(e){return new Wu({values:z.asArray(e),internalListeners:{change:"onSortersChanged",thisObj:this}})}addSorter(e){const t=e instanceof An?e:new An(e);return this.sorters.add(t),t}get isSorted(){var e;return!!((e=this._sorters)!=null&&e.count)}onSortersChanged(){const e=this;e._sortFunction=null,e._addedValues=null,e._values.sort(e.sortFunction),e.trigger("change",Yv)}get sortFunction(){return this._sortFunction||(this.isSorted?this._sortFunction=An.generateSortFunction(this.sorters.values):this._sortFunction=Wv),this._sortFunction}get filters(){return this._filters||(this._filters=new Wu({internalListeners:{change:"onFiltersChanged",thisObj:this}})),this._filters}addFilter(e){const t=e instanceof Oe?e:new Oe(e);return this.filters.add(t),t}removeFilter(e){const{filters:t}=this;e.isCollectionFilter||(e=t.get(e)),t.remove(e)}clearFilters(){this.filters.clear()}get isFiltered(){return!!(this._filters&&this._filters.count)}onFiltersChanged({action:e,removed:t,oldCount:r}){const n=this,s=r||e==="clear"&&t.length?n._filteredValues:n._values;n._filterFunction=null,n._filteredValues=n._values.filter(n.filterFunction),n._indicesInvalid=!0;const{toAdd:a,toRemove:l}=z.delta(n._filteredValues,s,!0);n.trigger("change",{...Uv,added:a,removed:l})}get filterFunction(){return this._filterFunction||(this.isFiltered?this._filterFunction=Oe.generateFiltersFunction(this.filters.values):this._filterFunction=ue.returnTrue),this._filterFunction}changeExtraKeys(e){return z.asArray(e).map(r=>typeof r=="string"?{property:r,unique:!0}:r)}updateExtraKeys(e){for(let t=0;t<e.length;t++)this.addIndex(e[t])}addIndex(e){const t=this;e&&((t._indices||(t._indices={}))[e.property]=new Map,Object.assign(t._indices[e.property],e),t.invalidateIndices(),e.dependentOn&&(t.hasCompositeIndex=!0))}findIndex(e,t,r=!1){const n=this.findItem(e,t,r);return n?(this.isFiltered&&!r?this._filteredValues:this._values).indexOf(n):-1}findItem(e,t,r=!1){var n;const s=this,{isFiltered:a}=s,l=a&&!r?s.indices[Xl][e]:s.indices[e];if(l){const o=(n=l.get(t))!=null?n:typeof t=="string"&&t.length&&!isNaN(t)&&l.get(Number(t))||null;if(o!=null)return o}else{const o=a&&!r?s._filteredValues:s._values,u=o.length;for(let c=0;c<u;c++){const d=o[c];if(d[e]==t)return d}}return null}removeIndex(e){delete this._indices[e],this.hasCompositeIndex=Object.values(this.indices).some(t=>t.dependentOn)}indexOf(e,t=!1){return this.findIndex(this.idProperty,Sr[typeof e]?e:e[this.idProperty],t)}includes(e,t=!1){return Array.isArray(e)?e.some(r=>this.includes(r)):!!this.findItem(this.idProperty,Sr[typeof e]?e:e[this.idProperty],t)}get indices(){return this._indicesInvalid&&this.rebuildIndices(),this._indices}invalidateIndices(){this._indicesInvalid=!0}rebuildIndices(){const e=this,t=e.isFiltered,r=e._indices||(e._indices={}),n=Object.keys(r),s=n.length,a=e._values;let l=!1,o;t&&(o=r[Xl]={});for(let u=0;u<s;u++){const c=r[n[u]];if(c.clear(),c.onDuplicate&&(c.count=0,l=!0),t){let d=o[n[u]];d?d.clear():(d=o[n[u]]=new Map,d.unique=c.unique)}}if(Dd(a,r,n,s),l)for(let u=0;u<s;u++){const c=r[n[u]];if(c.onDuplicate&&c.count>c.size){const d=new Set;for(let h=0;h<a.length;h++){const g=a[h],f=g[n[u]];d.has(f)&&c.onDuplicate(g,f,c),d.add(f)}}}t&&Dd(e._filteredValues,o,n,s,!0),e._indicesInvalid=!1}getIndices(e){const t=[this.indices[e]];return this.isFiltered&&t.push(this.indices[Xl][e]),t}addToIndices(e){Object.keys(this.indices).forEach(t=>{this.addIndexEntry(e,t,e[t])})}removeFromIndices(e){Object.keys(this.indices).forEach(t=>{this.removeIndexEntry(e,t,e[t])})}removeIndexEntry(e,t,r){this.getIndices(t).forEach(n=>qv(e,n,r))}addIndexEntry(e,t,r){this.getIndices(t).forEach(n=>wd(e,n,r))}onItemMutation(e,t){const r=this;!r._indicesInvalid&&Object.keys(r.indices).length>1&&Object.keys(t).forEach(n=>{var s;if(r.indices[n]){const{value:l,oldValue:o}=t[n];r.removeIndexEntry(e,n,o),r.addIndexEntry(e,n,l)}if(r.hasCompositeIndex){const l=Object.values(r.indices).find(o=>{var u;return(u=o.dependentOn)==null?void 0:u[n]});if(l){const o={};for(const c in l.dependentOn)o[c]=((s=t[c])==null?void 0:s.oldValue)||e[c];const u=e.buildIndexKey(o);r.removeIndexEntry(e,l.property,u),r.addIndexEntry(e,l.property,e[l.property])}}})}};wr._$name="Collection";var Td=new WeakMap,Pn=i=>{if(i&&typeof i=="object"){let e=Td.get(i);e===void 0&&(e=Symbol("bscik"),Td.set(i,e)),i=e}return i},Fn=class{constructor(i){const e=this;e.generation=0,e.items=new Set,e.idMap={},e.idProperty="id",i&&(i.idProperty&&(e.idProperty=i.idProperty),i.values&&(e.values=i.values))}get(i){return this.idMap[Pn(i)]}get count(){return this.items.size}add(...i){i.length===1&&Array.isArray(i[0])&&(i=i[0]);const e=this,{items:t,idMap:r,idProperty:n}=e,s=i.length;for(let a=0;a<s;a++){const l=i[a],o=Sr[typeof l]?l:Pn(l[n]),u=r[o];u==null?(r[o]=l,t.add(l),e.generation++):u!==l&&(r[o]=l,t.delete(u),t.add(l))}}at(i){let e,t;i<0&&(i+=this.count);for(e of this.items)if(!i--){t=e;break}return t}remove(i){i=z.asArray(i);const{items:e,idMap:t,idProperty:r}=this,n=i.length;for(let s=0;s<n;s++){const a=i[s],l=Sr[typeof a]?a:Pn(a[r]),o=t[l];o!=null&&(e.delete(o),delete t[l],this.generation++)}}clear(){this.items.clear(),this.idMap={},this.generation++}countOf(i){let e=0,t;for(t of this.items)i(t)&&++e;return e}changeId(i,e){const t=this,{idMap:r,idProperty:n}=t,s=Sr[typeof i]?i:Pn(i[n]),a=t.get(s);if(a){const l=t.get(e);if(l&&a!==l)throw new Error(`Attempt to set item ${s} to already existing member's id ${e}`);a[n]=e,delete r[s],r[e]=a}}filter(i,e){const{items:t}=this,r=[];let n=0;return t.forEach(s=>{i.call(e,s,n++,t)&&r.push(s)}),r}includes(i){const e=Sr[typeof i]?i:Pn(i[this.idProperty]);return!!this.idMap[e]}map(i,e){const{items:t}=this,r=new Array(t.size);let n=0;return t.forEach(s=>{r[n]=i.call(e,s,n++,t)}),r}forEach(i,e){return this.items.forEach(i,e)}find(i,e=0){let t,r;e<0&&(e+=this.countOf(i));for(t of this.items)if(i(t)&&!e--){r=t;break}return r}[Symbol.iterator](){return this.items[Symbol.iterator]()}indexOf(i,e){let t=-1,r;for(r of this.items)if((!e||e(r))&&(++t,r===i))return t;return-1}get values(){return[...this.items]}set values(i){i=z.asArray(i),this.clear(),this.add.apply(this,i),this.generation++}sort(i){this.values=this.values.sort(i)}some(i,e){return this.values.some(i,e)}};Fn._$name="Bag";var oa=class extends Fn{add(...i){return i.length===1&&Array.isArray(i[0])&&(i=i[0]),super.add(...i.filter(e=>e.isPersistable))}};oa._$name="StoreBag";var xd=i=>class extends(i||F){static get $name(){return"StoreCRUD"}static get defaultConfig(){return{autoCommit:!1}}static get properties(){return{isRemoving:!1,suspendCount:0}}remove(t,r=!1){const n=this,{storage:s}=n;if(t=z.asArray(t).reduce((a,l)=>(l=n.getById(l),l&&a.push(l),a),[]),t.length===0)return t;if(!n.tree&&!r&&n.trigger("beforeRemove",{records:t})===!1)return[];if(n.isRemoving=!0,n.isGrouped){const a=s.count,l=[],o=new Set;for(const u of t){const c=u.groupParent.get(n.id);c.meta.collapsed&&l.push(u),z.remove(c.groupChildren,u),z.remove(c.unfilteredGroupChildren,u),c.meta.childCount--,o.add(c)}for(const u of o)u.groupChildren.length>0&&n.onModelChange(u,{},{});l.length&&s.trigger("change",{action:"splice",removed:l,added:[],replaced:[],oldCount:a})}else if(n.tree){const a=[],l=t.length>1,o=t[0],u=l?void 0:s.indexOf(o),c=t.reduce((h,g)=>{const{parent:f}=g;return f&&(h[f.id]||(h[f.id]=[f,[]]),h[f.id][1].push(g)),h},{}),d=Array.from(Object.values(c));if(!r&&n.trigger("beforeRemove",{records:t,isMove:!1,parent:l?void 0:o.parent})===!1)return n.isRemoving=!1,[];n.suspendAutoCommit(),d.sort((h,g)=>g[0].childLevel-h[0].childLevel);for(const[h,g]of d)a.push(...h.removeChild(g,!1,!0));return r||(n.trigger("remove",{parent:l?void 0:o.parent,index:u,isChild:!0,allRecords:a,isMove:!1,records:t}),n.trigger("change",{action:"remove",records:t})),n.resumeAutoCommit(),n.isRemoving=!1,t}if(t.length===0)return n.isRemoving=!1,t;for(const a of t)a.beforeRemove(t);return r&&n.suspendEvents(),s.remove(t),r&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),n.isRemoving=!1,t}clear(t=!1){var r,n;const s=this,{storage:a}=s;if(s.storage.totalCount||(n=(r=s.rootNode)==null?void 0:r.unfilteredChildren)!=null&&n.length){if(!t&&s.trigger("beforeRemove",{records:a.allValues,removingAll:!0})===!1)return null;if(s.rootNode)s.isChained||s.rootNode.clearChildren(t);else if(t){const l=s.registeredRecords;for(let o=l.length-1,u;o>=0;o--)u=l[o],u&&!u.isDestroyed&&u.unjoinStore(s)}t&&(s.removed.clear(),a.suspendEvents()),a.clear(),t&&a.resumeEvents(),s.added.clear(),s.modified.clear()}}removeAll(t=!1){const r=this,n=r.storage;let s;if(r.isRemoving=!0,t){n.suspendEvents();const a=r.registeredRecords;for(let l=a.length-1,o;l>=0;l--)o=a[l],o&&!o.isDestroyed&&!o.isRoot&&o.unjoinStore(r)}return r.tree?s=r.rootNode.clear()!==!1:s=r.clear()!==null,t&&n.resumeEvents(),r.isRemoving=!1,s}add(t,r=!1,n={}){const s=this,{storage:a}=s;if(t=z.asArray(t),!(t!=null&&t.length))return;if(s.tree=s.tree||!!(s.autoTree&&t[0].children),s.tree){const o=new Map,u=s.modelClass.getFieldDataSource("parentIndex"),{parentIdField:c}=s.modelClass,d=[];return t.forEach(h=>{const g=h[c];o.has(g)||o.set(g,{append:[],insert:[]});const f=o.get(g);!h.isModel&&u in h?f.insert.push(h):f.append.push(h)}),o.forEach(({append:h,insert:g},f)=>{const m=f==null?s.rootNode:s.getById(f);if(!m)throw new Error(`Parent node with id ${f} not found, cannot add children.`);if(h.length&&d.push(...m.appendChild(h,r,n)),g.length)for(const p of g)d.push(m.insertChild(p,p[u],r,n))}),s.isFiltered&&s.reapplyFilterOnAdd&&s.filter({silent:!0}),s.reapplySortersOnAdd&&!s.isSyncingDataOnLoad&&s.sort(),d}if(!r&&s.trigger("beforeAdd",{records:t})===!1)return null;if(s.tree=s.tree||!!(s.autoTree&&t[0].children),s.tree)return s.rootNode.appendChild(t);const l=s.processRecords(t);return r&&s.suspendEvents(),s.addingClean=n.clean,a.add(l),s.addingClean=!1,r&&s.resumeEvents(),s.autoCommit&&s.doAutoCommit(),l}processRecords(t,r){return t.map(n=>{const s=this.processRecord(n.isModel?n:this.createRecord(n));return r==null||r.call(this,s),s})}insert(t,r,n=!1){var s;const a=this,l=a.storage,o=a.getAt(t),u=l.values,c=[];if(r=z.asArray(r),a.tree){const m=a.rootNode;return m.insertChild(r,(s=m.children)==null?void 0:s[t],n)}if(!n&&a.trigger("beforeAdd",{records:r})===!1)return null;let d,h,g;if(u[h=t]===r[0]||u[h=t-1]===r[0])for(d=!0,g=0;d&&g<r.length;g++)r[g]!==u[h+g]&&(d=!1);if(d)return null;const f=a.processRecords(r,m=>{const p=l.indexOf(m);m.children&&m.children.length&&a.autoTree&&(a.tree=!0),p>-1&&(p<t&&o&&t--,c.push(p)),m.meta.previousIndex=p});return a.suspendEvents(),a.storage.remove(c),a.resumeEvents(),n&&a.suspendEvents(),l.splice(t,0,...f),n&&a.resumeEvents(),a.autoCommit&&a.doAutoCommit(),f}move(t,r){this.isTree?r.parent.insertChild(t,r):this.storage.move(t,r)}setMultiple(t,r,n){const s=this,a=[],l=[];s.forEach(o=>{t(o)&&(l.push(o.set(r,n,!0)),a.push(o))}),s.trigger("updateMultiple",{records:a,all:s.records.length===a.length}),s.trigger("change",{action:"updatemultiple",records:a,all:s.records.length===a.length}),s.reapplyFilterOnUpdate&&s.isFiltered&&s.filter()}setAll(t,r){const n=this,s=[];n.forEach(a=>{s.push(a.set(t,r,!0))}),n.trigger("updateMultiple",{records:n.records,all:!0}),n.trigger("change",{action:"updatemultiple",records:n.records,all:!0}),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}acceptChanges(){const t=this;t.added.forEach(r=>r.clearChanges(!0,!1)),t.modified.forEach(r=>r.clearChanges(!0,!1)),t.added.clear(),t.modified.clear(),t.removed.clear()}commit(t=!1){const{changes:r}=this;return!t&&this.trigger("beforeCommit",{changes:r})===!1?!1:(this.acceptChanges(),t||this.trigger("commit",{changes:r}),r)}revertChanges(){const t=this,{changes:r}=t;if(r){const n={action:"clearchanges",changes:r};t.add(t.removed.values,!0),t.remove(t.added.values,!0),t.modified.forEach(s=>s.revertChanges(!0)),t.added.clear(),t.modified.clear(),t.removed.clear(),t.trigger("change",n),t.trigger("refresh",n)}}get changes(){const t=this,r=t.modified.values.filter(n=>n.rawModifications);return t.added.count||r.length||t.removed.count?{added:t.added.values.slice(),modified:r,removed:t.removed.values.slice()}:null}get autoCommit(){return this._autoCommit}set autoCommit(t){this._autoCommit=t,t&&this.changes&&this.commit()}suspendAutoCommit(){this.suspendCount++}resumeAutoCommit(t=!0){this.suspendCount--,this.autoCommit&&t&&this.doAutoCommit()}doAutoCommit(){this.suspendCount<=0&&this.commit()}},Ed=i=>class extends(i||F){static get $name(){return"StoreChanges"}static get configurable(){return{applyChangesetFilterSortTarget:"changes"}}applyChangesFromStore(t){const r=this,{changes:n}=t;n&&(n.added&&r.add(n.added),n.removed&&r.remove(n.removed.map(s=>s.id)),n.modified&&n.modified.forEach(s=>{const a=r.getById(s.id);a==null||a.set(s.modifications)}))}applyChangeset(t,r=null,n="$PhantomId",s=!0,a=!1){var l,o,u,c,d;const h=this,{added:g,updated:f,modified:m,removed:p}=(l=r==null?void 0:r(t,h))!=null?l:t,v=(o=f!=null?f:m)!=null?o:[],b=h.modelClass.getFieldDataSource("id"),w=h.modelClass.getFieldDataSource("parentId"),S=a?new Map:null,C=[],T=[];let E=!1,I=[];if(h.trigger("startApplyChangeset"),h._groupVisibleRecordIds=[],h.isGrouped&&h.forEach(R=>{h._groupVisibleRecordIds.push(R.id)}),(g==null?void 0:g.length)>0){const R=[],M=[];for(const B of g)h.getById(B[n])||h.getById(x.getPath(B,b))?R.push(B):M.push(B);v.unshift.apply(v,R);const O=h.reapplySortersOnAdd;h.reapplySortersOnAdd=!1;const A=(u=h.add(M,!1,{orderedParentIndex:{skip:!0}}))!=null?u:[];if(C.push(...A),h.reapplySortersOnAdd=O,h.tree)for(const B of A){const{parent:L}=B;if(L.isRoot){E=!0,I=[L];break}!L.isRoot&&I.every(Y=>!Y.contains(L))&&I.push(L)}for(const B of A)S==null||S.set(B.id,B.data),B.clearChanges()}if((v==null?void 0:v.length)>0)for(const R of v){const M=R[n],O=x.getPath(R,b),A=x.getPath(R,w),B=(c=h.getById(M))!=null?c:h.getById(O);if(B){const L=A!=null?(d=h.getById(A))==null?void 0:d.isLeaf:!1,Y=B.applyChangeset(R,n,s);L&&h.toggleCollapse(B.parent,!1),h.tree&&!E&&I.every(K=>!K.contains(B))&&(B.parent.isRoot?(E=!0,I=[B.parent]):I.push(B.parent)),S==null||S.set(O,Y),T.push(B)}}if((p==null?void 0:p.length)>0&&h.applyRemovals(p),h.applyChangesetFilterSortTarget==="changes"){const R=h.filterChangeset(C,T);I.push(...R)}if(h.afterChangesetApplied(I),h.tree&&h.isSorted&&h.reapplySortersOnAdd&&(g!=null&&g.length||v!=null&&v.length)){const R=new Set;I.forEach(M=>{R.has(M)||(R.add(M),M.sortVisibleChildren(!1,h.sorterFn),M.sortUnfilteredChildren(!1,h.sorterFn))}),h.storage.replaceValues({values:h.collectDescendants(h.rootNode).visible,silent:!0}),h.afterPerformSort(!1)}return h._groupVisibleRecordIds=null,h.trigger("endApplyChangeset"),S}afterChangesetApplied(t){const r=new Set;t.forEach(n=>{r.has(n)||n.traverse(s=>{r.has(s)||(r.add(s),s.sortOrderedChildren(!1,!1),s.children&&s.updateChildrenIndices(s.children,"parentIndex",!0),s.unfilteredChildren&&s.updateChildrenIndices(s.unfilteredChildren,"unfilteredIndex",!0))})})}applyRemovals(t){const r=this,{removed:n}=r,s=r.modelClass.idField,a=[];for(const l of t){const o=x.getPath(l,s);if(n.includes(o)){const u=n.get(o);u.clearChanges(!1,!0,null),u.$isPhantom=!0,n.remove(o)}else a.push(o)}r.remove(a);for(const l of a)n.remove(l)}filterChangeset(t,r){const n=this,{isFiltered:s,tree:a,isGrouped:l,filtersFunction:o}=n,u=n.isSorted?n.createSorterFn(n.sorters):void 0,{allValues:c,addedValues:d,isSorted:h}=n.storage,g=u!=null||h?u!=null?u:n.storage.sortFunction:null,f=new Set;if(!s)return[];let m=!1,p;if(l&&(p=n.groupers,n.clearGroupers(!0)),a){const b=new Set(r.filter(o));for(const S of t.filter(o))b.add(S);b.forEach(S=>S.bubble(C=>b.add(C))),b.delete(n.rootNode);const w=z.groupBy(Array.from(b).filter(S=>{var C,T;return!((T=(C=S.parent)==null?void 0:C.children)!=null&&T.includes(S))}),"parentId");for(const S of Object.values(w)){const{parent:C}=S[0];C.unfilteredChildren&&(C.children.push(...S),f.add(C))}}else if(g&&!l){const{filteredValues:b}=n.storage,w=d?b.findLastIndex(T=>!d.has(T))+1:b.length,S=b.slice(0,w),C=new Set(r.filter(o));for(const T of b)C.has(T)&&C.delete(T);for(const T of C)S.push(T);S.sort(g),b.splice(0,w,...S),m=!0}else{const b=r.filter(w=>o(w)&&!n.storage.includes(w));b.length>0&&(n.includeInSubset(c,n.storage.filteredValues,b),m=!0)}const v=new Set(t.filter(b=>!o(b)));if(v.size>0){if(a)for(const b of v)z.remove(b.parent.children,b),f.add(b.parent);else z.remove(n.storage.filteredValues,v);m=!0}return p&&(n.group(p[0],null,!1,!0,!0),m=!0),a&&f.size>0?n.storage.replaceValues({values:n.collectDescendants(n.rootNode).visible,silent:!0}):m&&(n._idMap=null,n.trigger("refresh")),[...f]}includeInSubset(t,r,n){const s=new Set(n);let a=0,l=0,o=s.size===0;for(;l<t.length&&!o;){const u=r[a];let c=t[l];for(;u!==c;)s.has(c)&&(r.splice(a,0,c),a++,s.delete(c),o=s.size===0),c=t[++l];s.has(u)&&s.delete(u),a<r.length&&a++}return r}},kd=i=>class extends(i||F){static get $name(){return"StoreFilter"}static get defaultConfig(){return{filters:null,reapplyFilterOnAdd:!1,reapplyFilterOnUpdate:!1}}set reapplyFilterOnAdd(t){this.storage.autoFilter=t}get reapplyFilterOnAdd(){return this.storage.autoFilter}set filters(t){const r=this,n=r.filters;if(n.clear(),r._filtersFunction=null,t){if(t.constructor.name==="Object")for(const s of Object.entries(t))s[0]==="filterBy"&&typeof s[1]=="function"?n.add(new Oe({filterBy:s[1]})):n.add(new Oe(s[1].constructor.name==="Object"?Object.assign({property:s[0]},s[1]):{property:s[0],value:s[1]}));else Array.isArray(t)?n.add(...t.map(s=>s instanceof Oe?s:new Oe(s))):t.isCollection?n.add(...t.values):n.add(new Oe({filterBy:t}));n.forEach(s=>s.owner=r)}}get filters(){return this._filters||(this._filters=new wr({extraKeys:["property"]}))}set filtersFunction(t){this._filtersFunction=t}get filtersFunction(){const t=this,{filters:r,isGrouped:n}=t;if(!t._filtersFunction)if(r.count){const s=Oe.generateFiltersFunction(r);t._filtersFunction=a=>n&&a.isSpecialRow?a.groupChildren.some(s):s(a)}else t._filtersFunction=ue.returnTrue;return t._filtersFunction}get isFiltered(){return this.filters.values.some(t=>!t.disabled)}traverseFilter(t){const r=this,n=!t.isRoot&&r.filtersFunction(t),s=t.unfilteredChildren||t.children;return!s||!s.length?n:(t.unfilteredChildren||(t.unfilteredChildren=t.children.slice()),t.children=t.unfilteredChildren.filter(a=>r.traverseFilter(a)),r.isSorted&&t.children.sort(r.sorterFn),t.updateChildrenIndices(t.unfilteredChildren,"unfilteredIndex",!0),t.updateChildrenIndices(t.children,"parentIndex",!0),n||!!t.children.length)}traverseClearFilter(t){const r=this;t.unfilteredChildren&&(t.children=t.orderedChildren.slice(),t.unfilteredChildren=null),t.children&&(r.isSorted&&t.children.sort(r.sorterFn),t.children.forEach(n=>r.traverseClearFilter(n)),t.updateChildrenIndices(t.children,"parentIndex",!0))}get latestFilterField(){return this.filters.last?this.filters.last.property:null}addFilter(t,r=!1){const n=this;if(t=t instanceof Oe?t:new Oe(t),t.owner=n,n.filters.add(t),!r){if(n.remoteFilter)return n.filter().then(()=>t);n.filter()}return t}filter(t){const r=this;let n=!1,s;if(t){let l=typeof t;if(l==="object"&&("silent"in t||"replace"in t||t.filters)&&(n=t.silent,t.replace&&r.clearFilters(t.filters.length===0),s=t.internal,t=t.filters,l=typeof t),t){const o=r.isFiltered;if(r.isConfiguring=!0,Array.isArray(t))t.forEach(u=>r.addFilter(u,!0),r);else if(l==="function"){const u=new Oe(t);u.internal=s,r.addFilter(u,!0)}else l==="string"?r.addFilter({property:t,value:arguments[1]},!0):r.addFilter(t,!0);if(r.isConfiguring=!1,!r.isFiltered&&!o)return null}}r.filtersFunction=null;const a=r.performFilter(n);return r._idMap=null,a}performFilter(t){const r=this,{storage:n,filters:s,rootNode:a}=r,l=r.count;r.trigger("beforeFilter",{filters:s});let o,u;if(r.tree){const c=n.values;r.isFiltered?r.traverseFilter(a):r.traverseClearFilter(a);const d=r.collectDescendants(a).visible;n.replaceValues({values:d,silent:!0});const h=z.delta(d,c,!0);o=h.toAdd,u=h.toRemove}else n.ion({change({removed:c,added:d}){u=c,o=d},once:!0}),r.isFiltered?(r.isGrouped&&r.includeCollapsed(),n.addFilter({id:"primary-filter",filterBy:r.filtersFunction}),r.isGrouped&&r.excludeCollapsed()):n.filters.clear();r.afterPerformFilter(t||r.isRemoteDataLoading?null:{action:"filter",filters:s,oldCount:l,added:o,removed:u,records:r.storage.values})}afterPerformFilter(t){this.resetRelationCache(),t&&this.triggerFilterEvent(t)}triggerFilterEvent(t){this.trigger("filter",t),this.remoteFilter||(this.trigger("refresh",t),this.trigger("change",t))}filterBy(t){return this.filter(t)}removeFilter(t,r=!1){const n=this,s=t instanceof Oe?t:n.filters.get(t);if(s){if(n.filters.remove(s),n._filtersFunction=null,!r){if(n.remoteFilter)return n.filter().then(()=>s);n.filter()}return s}}clearFilters(t=!0){if(this.filters.remove(this.filters.values.filter(r=>!r.internal)),t)return this.filter()}convertFilterToString(t){const r=this.filters.getBy("property",t);return r&&!r.filterBy?String(r):""}doDestroy(){var t;(t=this._filters)==null||t.destroy(),super.doDestroy()}},Kv={add:1,replace:1},Gv=({_groupValue:i},{_groupValue:e})=>i<e?-1:i>e?1:0,Id=i=>{var e;return e=class extends(i||F){static get properties(){return{collapsedGroups:new Set}}construct(t){super.construct(t),this.ion({change:"onDataChanged",thisObj:this})}get GroupRow(){var t;return this._GroupRowClass||(this._GroupRowClass=(t=class extends this.modelClass{get isCollapsed(){return this.meta.collapsed}},y(t,"isSpecialRow",!0),y(t,"fields",[{name:"_groupValue"}]),t))}updateGroupers(t){this.setGroupers(t)}setGroupers(t,r=null){const n=this,{storage:s}=n;let a;return t!=null&&t.length?n._groupers=t:n.groupers&&(delete n._groupers,n.includeCollapsed(),s.replaceValues({values:n.removeHeadersAndFooters(s._values),filteredValues:s.isFiltered?n.removeHeadersAndFooters(s._filteredValues):null,silent:!0}),a=n.group(null,null,null,!1,r==null?void 0:r.silent)),n._idMap=null,a}get unfilteredGroupRecords(){var t;const r=this;if(r.isGrouped){const{generation:n}=r.storage;((t=r._unfilteredGroupRecords)==null?void 0:t.generation)!==n&&(r._unfilteredGroupRecords=r.storage.allValues.filter(s=>s.isSpecialRow),r._unfilteredGroupRecords.generation=n)}return r._unfilteredGroupRecords||[]}getGroupHeaderForRecord(t,r=!1){if(this.isGrouped)return t?t.meta.groupRowFor?t:t.groupParent.get(this.id):this.groupRecords.last}includeCollapsed(){for(const t of this.collapsedGroups)this.expand(this.getById(t),!1)}excludeCollapsed(){for(const t of this.collapsedGroups)this.collapse(this.getById(t))}onDataChange({source:t,action:r,removed:n}){var s;const a=this,{groupers:l}=a;l&&(l.length?(r==="splice"&&(n!=null&&n.length)||r==="move")&&t.replaceValues({...a.prepareGroupRecords(),silent:!0}):t.replaceValues({values:a.removeHeadersAndFooters(t._values),filteredValues:t.isFiltered?a.removeHeadersAndFooters(t._filteredValues):null,silent:!0})),(s=super.onDataChange)==null||s.call(this,...arguments)}move(t,r){const n=this;if(n.isGrouped&&!n.tree){let s=r;if(r!=null&&r.isSpecialRow&&(s=n.getPrev(r,!1,!1),!s))return;const a=n.getGroupHeaderForRecord(s),l=n.groupers[0].field,o=a.meta.groupRowFor,{reapplyFilterOnUpdate:u}=n;if(n.reapplyFilterOnUpdate=!1,n.beginBatch(),t.forEach(c=>c.setValue(l,o)),n.endBatch(),n.reapplyFilterOnUpdate=u,n.isFiltered&&(r!=null&&r.isSpecialRow)){const{unfilteredGroupRecords:c}=n,d=c.indexOf(a);r=c[d+1]}}super.move(t,r)}collapse(t){return t&&!t.meta.collapsed?(this.excludeGroupRecords(t),t.meta.collapsed=!0,this.collapsedGroups.add(t.id),this.trigger("toggleGroup",{groupRecord:t,collapse:!0}),!0):!1}expand(t,r=!0){return t!=null&&t.meta.collapsed?(this.includeGroupRecords(t),t.meta.collapsed=!1,r&&this.collapsedGroups.delete(t.id),r&&this.trigger("toggleGroup",{groupRecord:t,collapse:!1}),!0):!1}removeHeadersAndFooters(t){return t.filter(r=>{var n;return r.unfilteredGroupChildren&&(r.groupChildren.length=r.unfilteredGroupChildren.length=r.meta.childCount=0),r.isSpecialRow||r.isLinked&&((n=r.groupParent)!=null&&n.get(this.id))?(this.unregister(r),!1):!0})}prepareGroupRecords(){var t;const r=this,{GroupRow:n,isFiltered:s,reapplyFilterOnUpdate:a,groupRecords:l}=r,o=r.groupers[0],u=o.ascending!==!1?1:-1,{field:c,fn:d=Gv}=o,h=typeof c=="function",g=c===r.modelClass.idField,f=new wr,m=r._groupVisibleRecordIds||[],p=S=>{const C=!s||r.filtersFunction(S);return a?C:C||m.includes(S.id)},v=!!(r.startGroupsCollapsed&&!(l!=null&&l.count));l==null||l.forEach(S=>{S.isCollapsed&&r.includeGroupRecords(S)});const b=r.removeHeadersAndFooters(r.storage._values);if(r.sorters.length&&b.sort(r.sorterFn),s&&(r.filtersFunction=null),b.forEach(S=>{const C=S,T=h?c(S):S[c],E=z.asArray(T==null?"__novalue__":T),I=Array.isArray(E),R=I&&!E.length,M=R?1:E.length;for(let O=0;O<M;O++){const A=R?[]:E[O],B=`group-header-${typeof A=="number"?A:P.createId(A)}`;let L=f.get(B);if(L||(L=(l==null?void 0:l.get(B))||new n({[r.modelClass.idField]:B,[g?"":c]:A,_groupValue:A},r,{collapsed:v,specialRow:!0,groupRowFor:A,groupField:c,emptyArray:R}),f.add(L),L.meta.childCount=0,L.groupChildren=[],L.unfilteredGroupChildren=[],L.stores=[r]),r.register(L),O>0){const Y=C.groupLinks||(C.groupLinks=[]);S=Y[A]||(Y[A]=C.link()),S.stores=[r],r.register(S)}S.groupParent||S.setData("groupParent",new Map),S.groupParent.set(r.id,L),p(S)&&(L.groupChildren.push(S),L.meta.childCount++),L.unfilteredGroupChildren.push(S)}}),f._values.sort((S,C)=>d(S,C)*u),r.useGroupFooters)for(let S=0,C=f.count;S<C;S++){const T=f.values[S],E=T.meta.groupRowFor,I=`group-footer-${typeof E=="number"?E:P.createId(E)}`,R=r.getById(I)||new n({[r.modelClass.idField]:I,[g?"":c]:E,_groupValue:E},r,{specialRow:!0,groupFooterFor:E,groupRecord:T});R.stores=[r],r.register(R),R.groupChildren=T.groupChildren,f.splice(++S,0,R),C++,T.groupChildren.push(R),T.unfilteredGroupChildren.push(R),T.meta.childCount++}r._idMap=null;const w={values:f.reduce((S,C)=>(C.isGroupFooter||(S.push(C),C.meta.collapsed||S.push(...C.unfilteredGroupChildren)),S),!1,[])};return s&&(w.filteredValues=w.values.filter(p)),(t=r.groupRecords)==null||t.forEach(S=>{f.includes(S)||S.destroy()}),r.groupRecords=f,w}get isGrouped(){var t;return!!((t=this.groupers)!=null&&t.length)}group(t,r,n=!1,s=!0,a=!1){var l,o;const u=this;let c,d;if(t&&typeof t=="object"&&(r=t.ascending,d=t.fn,t=t.field),n?u.groupers.push(c={field:t,ascending:r,complexMapping:t.includes(".")}):t&&(r==null&&(r=((l=u.groupInfo)==null?void 0:l.field)===t&&((o=u.groupInfo)==null?void 0:o.fn)===d?!u.groupInfo.ascending:!0),u.groupInfo=c={field:t,ascending:r,fn:d,complexMapping:t.includes(".")},u.groupers=[u.groupInfo]),c){const{prototype:h}=u.modelClass;c.complexMapping&&!Object.prototype.hasOwnProperty.call(h,t)&&Object.defineProperty(h,t,{get(){return x.getPath(this,t)}})}if(s!==!1){if(u.remoteSort&&!u.isRemoteDataLoading)return u.sort(null,null,!1,!0).then(()=>u.onAfterGrouping(a));u.sort(null,null,!1,!0)}u.onAfterGrouping(a)}onAfterGrouping(t){if(t)return;const r=this,n=r.groupers||[];r.trigger("group",{isGrouped:r.isGrouped,groupers:n,records:r.storage.values}),r.trigger("refresh",{action:"group",isGrouped:r.isGrouped,groupers:n,records:r.storage.values})}addGrouper(t,r=!0){return this.group(t,r,!0)}removeGrouper(t){const r=this,{groupers:n}=r;if(!n)return;const s=n.findIndex(a=>a.field===t);if(s>-1)return n.splice(s,1),n.length?r.group():r.clearGroupers()}clearGroupers(t=!1){return this.setGroupers(null,{silent:t})}isRecordInGroup(t,r){var n;if(!this.isGrouped)return null;const s=(n=this.groupers[0])==null?void 0:n.field;return t.getValue(s)===r&&!t.isSpecialRow}isInCollapsedGroup(t){const r=t.groupParent.get(this.id);return r==null?void 0:r.meta.collapsed}getGroupRecords(t){return this.isGrouped?this.storage.values.filter(r=>this.isRecordInGroup(r,t)):null}getGroupTitles(){return this.isGrouped?this.getDistinctValues(this.groupers[0].field):null}onDataChanged({changes:t,action:r}){this.isGrouped&&(!t&&Kv[r]||t&&this.groupers.some(n=>n.field in t))&&this.sort()}internalIncludeExcludeGroupRecords(t,r){const n=this,s=n.indexOf(t),a=n.allIndexOf(t),{id:l,storage:o}=n,{_filteredValues:u,_values:c}=o,{meta:d,groupChildren:h,unfilteredGroupChildren:g}=t;a===-1||d.collapsed&&!r||!d.collapsed&&r||(g.forEach(f=>f.instanceMeta(l).hiddenByCollapse=!r),r?(u&&u.splice(s+1,0,...h.filter(f=>!n.isAvailable(f))),o._values.splice(a+1,0,...g.filter(f=>!n.isAvailable(f)))):(u&&u.splice(s+1,h.length),c.splice(a+1,g.length)),o._indicesInvalid=!0,n._idMap=null)}excludeGroupRecords(t){this.internalIncludeExcludeGroupRecords(t,!1)}includeGroupRecords(t){this.internalIncludeExcludeGroupRecords(t,!0)}collectGroupRecords(t,r=!0){return(t?this.storage.allValues:this.storage.values).reduce((s,a)=>(a.isSpecialRow&&(r&&!a.isGroupFooter&&s.push(a),a.isGroupHeader&&s.push.apply(s,a.groupChildren)),s),[])}},y(e,"$name","StoreGroup"),y(e,"configurable",{groupers:null,useGroupFooters:!1,startGroupsCollapsed:null}),e},Md=i=>class extends(i||F){static get configurable(){return{objectify:null}}initProxy(){if(!globalThis.Proxy)throw new Error("Proxy not supported");return new Proxy(this,{get(r,n){if(n in r)return r[n];if(n==="$store")return r;let s=r.getById(n);return!s&&!isNaN(parseInt(n))&&(s=r.getAt(parseInt(n))),s},set(r,n,s){return n in r||r.isDestroying||n==="_triggered"?r[n]=s:r.add({[r.modelClass.idField]:n,...s}),!0},deleteProperty(r,n){return r.isDestroying?(delete r[n],!0):!!r.remove(n).length},has(r,n){if(n in r)return!0;if(n.startsWith("{")&&n.endsWith("}")){const s=P.safeJsonParse(n);n=s==null?void 0:s.id}return r.includes(n)}})}},Rd=i=>{var e;return e=class extends(i||F){initRelations(t){const r=this,n=r.modelClass.exposedRelations;t&&r.modelRelations&&r.modelRelations.forEach(s=>{var a;return(a=s.storeDetacher)==null?void 0:a.call(s)}),(!r.modelRelations||r.modelRelations.length===0||t)&&n&&(r.modelRelations=[],n==null||n.forEach(s=>{const a={...s},{foreignStore:l,relationName:o,relatedCollectionName:u}=a,c=typeof l=="string"?r[l]:l;if(a.dependentStore=r,r.modelRelations.push(a),c){a.foreignStoreProperty=a.foreignStore,a.foreignStore=c;const d=c.dependentStoreConfigs;if(d.has(r)){const h=d.get(r);if(t){const g=h.find(f=>f.relationName===o);g&&z.remove(h,g)}h.push(a)}else d.set(r,[a]);u&&c.initRelationCollection(a,r),c.count>0&&c.updateDependentStores("dataset",c.records)}}))}initRelationCollection(t,r){const n=this,s=t.relatedCollectionName,a=n.collectionStores||(n.collectionStores={});a[s]={store:r,config:t},n[s+"Store"]||(n[s+"Store"]=r),n.count>0&&n.initModelRelationCollection(s,n.allRecords)}initModelRelationCollection(t,r){const n=this;r.forEach(s=>{s.traverse(a=>{const l=t in a?`$related${P.capitalize(t)}`:t;Object.defineProperty(a,l,{enumerable:!0,configurable:!0,get:function(){return n.getCollection(this,t)},set:function(o){return n.setCollection(this,t,o)}})})})}resetRelationCache(){this.relationCache={},this.forEach(t=>t.initRelations())}updateRecordRelationCache(t,r){r==null||r.forEach(n=>{const{config:s}=n,a=n.related?n.related.id:t.getValue(s.foreignKey);a!==void 0&&this.cacheRelatedRecord(t,a,s.relationName,a)})}getRelationCollection(t,r){var n;const s=Q.asId(r);return((n=this.relationCache[t])==null?void 0:n[s])||[]}getCollection(t,r){var n;const{config:s,store:a}=this.collectionStores[r];return((n=a.relationCache[s.relationName])==null?void 0:n[t.id])||[]}setCollection(t,r,n){const{config:s,store:a}=this.collectionStores[r],l=a.relationCache[s.relationName]||(a.relationCache[s.relationName]={}),o=(l[t.id]||[]).slice(),u=[],c=[];a.suspendEvents(),o.forEach(d=>{n.includes(d)||(d[s.foreignKey]=null,a.remove(d),c.push(d))}),n.forEach(d=>{d.isModel instanceof Q?d.stores.includes(a)||(a.add(d),u.push(d)):([d]=a.add(d),u.push(d)),d[s.foreignKey]=t.id}),a.resumeEvents(),c.length&&(a.trigger("remove",{records:c}),a.trigger("change",{action:"remove",records:c})),u.length&&(a.trigger("add",{records:u}),a.trigger("change",{action:"add",records:u}))}cacheRelatedRecord(t,r,n,s=null){const a=this,l=a.relationCache[n]||(a.relationCache[n]={});s!==null&&a.uncacheRelatedRecord(t,n,s),r!=null&&z.include(l[r]||(l[r]=[]),t)}uncacheRelatedRecord(t,r=null,n=null){const s=this;function a(l,o){const u=s.relationCache[l],c=u==null?void 0:u[o];if(c){const d=c.indexOf(t);d>=0&&c.splice(d,1),c.length===0&&delete u[o]}}n!=null?a(r,n):t.meta.relationCache&&Object.entries(t.meta.relationCache).forEach(([l,o])=>a(l,o==null?void 0:o.id))}updateDependentStores(t,r){this.dependentStoreConfigs.forEach(n=>{n.forEach(s=>{const{dependentStore:a,relatedCollectionName:l,relationName:o,foreignKey:u}=s,c=a.relationCache[o];if(t==="dataset"){l&&this.initModelRelationCollection(l,r),a.forEach(d=>{const h=d.initRelation(s);h&&a.cacheRelatedRecord(d,h.id,o,h.id)});return}if(t==="removeall"){a.forEach(d=>d.removeRelation(s)),delete a.relationCache[o];return}t==="replace"&&(r=r.map(d=>d[1])),(t==="add"||t==="replace")&&l&&this.initModelRelationCollection(l,r),(t==="add"||t==="replace"||t==="remove")&&r.forEach(d=>{const h=c==null?void 0:c[d.id];switch(t){case"remove":h&&h.forEach(g=>g.removeRelation(s));break;case"add":case"replace":a.forEach(g=>{g.getValue(u)==d.id&&(g.initRelation(s),a.cacheRelatedRecord(g,d.id,o))});break}})})})}updateDependentRecordIds(t,r){var n;(n=this.dependentStoreConfigs)==null||n.forEach(s=>{s.forEach(a=>{var l;const{dependentStore:o,relationName:u,foreignKey:c}=a,d=o.relationCache[u],h=(l=d==null?void 0:d[t])==null?void 0:l.slice();h==null||h.forEach(g=>{o.cacheRelatedRecord(g,r,u,t),g.set(c,r,!1,!0)})})})}},y(e,"$name","StoreRelation"),e},_d=i=>class extends(i||F){static get $name(){return"StoreSum"}sum(t,r=this.storage.values){return r?r.reduce((n,s)=>{if(s.isSpecialRow)return n;const a=Number(s.getValue(t));return isNaN(a)?n:n+a},0):0}min(t,r=this.storage.values){return r!=null&&r.length?r.reduce((n,s)=>{const a=s.getValue(t);return typeof(a==null?void 0:a.valueOf())==="number"&&a<n&&(n=a),n},r[0].getValue(t)):0}max(t,r=this.storage.values){return r!=null&&r.length?r.reduce((n,s)=>{const a=s.getValue(t);return typeof(a==null?void 0:a.valueOf())==="number"&&a>n&&(n=a),n},r[0].getValue(t)):0}average(t,r=this.storage.values){if(!(r!=null&&r.length))return 0;let n=0;const s=r.reduce((a,l)=>{if(l.isSpecialRow)return a;const o=parseFloat(l.getValue(t));return isNaN(o)?a:(n++,a+o)},0);return n>0?s/n:0}groupSum(t,r){return this.sum(r,this.getGroupRecords(t))}},Zl=(i,e)=>String(i).toLowerCase().includes(e),Od={string:Zl,number:Zl,boolean:Zl,date:(i,e)=>i instanceof Date&&e instanceof Date?i-e===0:String(i.getMonth()+1).includes(e)||String(i.getDate()).includes(e)||String(i.getFullYear()).includes(e),object:(i,e)=>i===e,undefined:(i,e)=>i===e},Ad=i=>class extends(i||F){static get $name(){return"StoreSearch"}search(t,r=null,n,s){const a=this.isTree&&!s?this.rootNode.allChildren:this.getAllDataRecords(s),l=a.length,o=[];if(t==null)return[];typeof t=="string"&&(t=t.toLowerCase());let u,c,d,h,g,f;for(u=0;u<l;u++){d=a[u],c=0;for(const m of r||d.fieldNames){h=d.getValue(m),g=h instanceof Date?"date":typeof h;const p=n==null?void 0:n[c];p&&(h=p(h),g="string"),f=Od[g],h&&(f!=null&&f(h,t))&&o.push({index:u,data:d,field:m,id:d.id}),c++}}return o}findByField(t,r,n=!1,s=!1){const a=this.getAllDataRecords(s),l=a.length,o=new Set,u=[];let c,d,h;for(r!=null&&(r=String(r).toLowerCase()),c=0;c<l;c++)if(d=a[c],h=d.getValue(t),!n||!o.has(h)){const g=h instanceof Date?"date":typeof h,f=Od[g];(r==null&&h===r||r===""&&h===""||r&&f(h,r))&&(u.push({id:d.id,index:c,data:d}),n&&o.add(h))}return u}find(t,r=!1){return this.getAllDataRecords(r).find(t)}findRecord(t,r,n=!1){const s=a=>x.isEqual(a[t],r);return this.isTree?this.query(s,n)[0]:this.getAllDataRecords(n).find(s)}query(t,r=!1){if(this.isTree){const n=[];return this.traverse(s=>{t(s)&&n.push(s)},void 0,void 0,r),n}return this.getAllDataRecords(r).filter(t)}some(t,r=!1){return this.getAllDataRecords(r).some(t)}},Pd=i=>class extends(i||F){static get $name(){return"StoreSort"}static get defaultConfig(){return{useLocaleSort:null}}static get configurable(){return{sorters:[],reapplySortersOnAdd:!1}}get isSorted(){return!!this.sorters.length||this.isGrouped}changeSorters(t){return t.map(r=>this.normalizeSorterConfig(r,!0))}updateReapplySortersOnAdd(t){this.storage.autoSort=t}sort(t,r,n=!1,s=!1){const a=this,l=a.allRecords,o=a.sorters?a.sorters.slice():[];let u=null,c;if(t)if(Array.isArray(t))a.sorters=t.map(d=>a.normalizeSorterConfig(d,typeof d=="string"?!0:r));else{const d=a.normalizeSorterConfig(t,r);n?(c=a.getCurrentSorterByField(d.field),c?(u=c.ascending,c.ascending=d.ascending):a.sorters.push(d)):a.sorters=[d]}return!s&&a.trigger("beforeSort",{sorters:a.sorters,records:l,currentSorters:o})===!1?(a.sorters=o,u!==null&&(c.ascending=u),null):a.performSort(s)}normalizeSorterConfig(t,r){var n,s,a;const l=this,o={ascending:r};if(typeof t=="object"?(x.assign(o,t),t.fn&&(delete o.fn,o.sortFn=t.fn),o.ascending=(n=t.ascending)!=null?n:r):typeof t=="function"?o.sortFn=t:o.field=t,o.ascending==null){const u=l.getCurrentSorterByField(o.field);o.ascending=u?!u.ascending:!0}if(o.sortFn==null){const u=(a=(s=l.modelClass)==null?void 0:s.$meta.fields.map[o.field])==null?void 0:a.compareItems;u&&(o.sortFn=u)}return o}getCurrentSorterByField(t){return typeof t=="string"&&this.sorters.find(r=>r.field===t)||null}addSorter(t,r=!0){return this.sort(t,r,!0)}removeSorter(t){const r=this.sorters.findIndex(n=>n.field===t||n.sortFn===t);if(r>-1)return this.sorters.splice(r,1),this.sort()}clearSorters(t=!1){if(this.sorters.length)return this.sorters.length=0,this.sort(void 0,void 0,void 0,t)}createSorterFn(t){const r=this.useLocaleSort;return(n,s)=>{for(let a=0;a<t.length;a++){const l=t[a],{field:o,ascending:u=!0,useLocaleSort:c=r}=l,d=l.fn||l.sortFn,h=u?1:-1;if(d){const m=d.call(l,n,s);if(m===0)continue;if(m!==null)return m*h}const g=n.isModel?n.getValue(o):n[o],f=s.isModel?s.getValue(o):s[o];if(g!==f){if(g==null)return-h;if(f==null)return h;if(c&&typeof g=="string"){if(c===!0)return String(g).localeCompare(f)*h;if(typeof c=="string")return String(g).localeCompare(f,c)*h;if(typeof c=="object")return String(g).localeCompare(f,c.locale,c)*h}if(g>f)return h;if(g<f)return-h}}return 0}}get sorterFn(){return this.createSorterFn(this.remoteSort?[{field:"_remoteSortIndex"}]:this.sorters)}performSort(t){const r=this,{rootNode:n,storage:s,sorterFn:a}=r;r.tree?(!r.isChained&&n.traverse(l=>{l.isLoaded&&l.isParent&&(l.children.sort(a),l.updateChildrenIndices(l.children,"parentIndex",!0))}),s.replaceValues({values:r.collectDescendants(n).visible,silent:!0})):r.isGrouped?s.replaceValues({...r.prepareGroupRecords(),silent:!0}):s.replaceValues({values:s.values.sort(a),silent:!0}),r.afterPerformSort(t||r.isRemoteDataLoading)}afterPerformSort(t){if(t)return;const r=this;r._idMap=null;const n={action:"sort",sorters:r.sorters,records:r.allRecords};r.trigger("sort",n),r.trigger("refresh",n)}},Fd=()=>!0,Ld=i=>class extends(i||F){static get $name(){return"StoreChained"}static get defaultConfig(){return{chainedFilterFn:null,chainedFields:null,masterStore:null,doRelayToMaster:["add","remove","insert"],dontRelayToMaster:[],excludeCollapsedRecords:!0,chainSuspended:0}}static get properties(){return{chainedStores:null}}construct(t){super.construct(t);const r=this,{masterStore:n}=r,s=r.syncOrder?"sort":"";n&&(r.methodNamesToRelay.forEach(a=>r[a]=(...l)=>r.relayToMaster(a,l)),r.removeAll=(...a)=>{n.remove(r.getRange(),...a)},n.ion({changePreCommit:r.onMasterDataChangedPreCommit,change:r.onMasterDataChanged,[s]:r.onMasterDataChanged,prio:1,thisObj:r}),n.chainedStores||(n.chainedStores=[]),n.chainedStores.push(r),r.fillFromMaster())}get $master(){return this.masterStore||this}get isChained(){return!!this.masterStore}set chainedFilterFn(t){this._chainedFilterFn=this.thisObj?t.bind(this.thisObj):t}get chainedFilterFn(){return this._chainedFilterFn||Fd}get methodNamesToRelay(){const t=Array.isArray(this.doRelayToMaster),r=Array.isArray(this.dontRelayToMaster);return t&&this.doRelayToMaster.filter(n=>!r||!this.dontRelayToMaster.includes(n))||[]}updateChainedStores(){this.chainedStores&&this.chainedStores.forEach(t=>t.fillFromMaster())}fillFromMaster(){const t=this,{masterStore:r,isTree:n}=t;let s=[];if(!t.isChained)throw new Error("fillFromMaster only allowed on chained store");if(!t.isChainSuspended){if(r.isGrouped&&r.isFiltered?r.forEach(a=>s.push(a),r,{includeFilteredOutRecords:!0,includeCollapsedGroupRecords:!0}):s=r.allRecords.filter(a=>!a.isSpecialRow&&t.chainedFilterFn(a)),n&&(t.idRegister={},t.internalIdRegister={},s.forEach(a=>{a.stores.includes(t)?t.register(a):a.joinStore(t)}),t.excludeCollapsedRecords)){const a=t.getChildren(t.rootNode);s=t.doIncludeExclude(a,!0)}t.isFillingFromMaster=!0,t.data=s,t.isFillingFromMaster=!1}}commitToMaster(){const t=this,r=t.masterStore;if(!t.isChained)throw new Error("commitToMaster only allowed on chained store");return r.beginBatch(),r.remove(t.removed.values),r.add(t.added.values),r.endBatch(),t.commit()}relayToMaster(t,r){return this.masterStore[t](...r)}onMasterDataChangedPreCommit(t){this.onMasterDataChanged(t),this.$masterEventhandled=!0}onMasterDataChanged({action:t,changes:r,$handled:n,isMove:s}){var a;if(this.$masterEventhandled){this.$masterEventhandled=!1;return}s&&t==="remove"||(t!=="update"||(a=this.chainedFields)!=null&&a.some(l=>l in r))&&this.fillFromMaster()}makeChained(t=Fd,r,n){if(this.isChained){const s=t;t=a=>s(a)&&this.chainedFilterFn(a)}return new((n==null?void 0:n.storeClass)||this.constructor)({storeId:void 0,id:`${this.id}-chained-${P.generateUUID()}`,...n||{},tree:!1,autoTree:!1,masterStore:this.$master,modelClass:this.modelClass,syncDataOnLoad:!1,chainedFilterFn:t,chainedFields:r})}chain(){return this.makeChained(...arguments)}doDestroy(){var t;(t=this.chainedStores)==null||t.forEach(r=>r.destroy()),super.doDestroy()}suspendChain(){this.chainSuspended++}resumeChain(t=!1){this.chainSuspended&&!--this.chainSuspended&&t&&this.fillFromMaster()}get isChainSuspended(){return this.chainSuspended>0}},$d=i=>class extends(i||F){static get $name(){return"StoreState"}getState(){const{sorters:t,groupers:r,filters:n}=this,s={};return t!=null&&t.length&&(s.sorters=t.map(a=>{const l=x.cleanupProperties(x.clone(a));return delete l.fn,delete l.sortFn,l})),r!=null&&r.length&&(s.groupers=r.map(a=>{const l=x.cleanupProperties(x.clone(a));return delete l.fn,l})),n!=null&&n.values.length&&(s.filters=n.values.map(a=>{const l=x.cleanupProperties(x.clone(a.config));return l.value=a.value,l.caseSensitive&&delete l.caseSensitive,l})),s}applyState(t){const r=this,{sorters:n=[],groupers:s=[],filters:a=[]}=t,{sortParamName:l,filterParamName:o}=r;r.sorters=n.filter(u=>u.field||u.sortFn&&!l),r.groupers=s.slice(),r.sort(),r.filters=a.filter(u=>u.property||u.filterBy&&!o),r.filter()}},Xv=i=>String(i).padStart(6,"0"),ua=class St{constructor(e){this.value=e,this._padded=null}set value(e){this._value=String(e!=null?e:"")}get value(){return this._value}static from(e){return e==null||e instanceof St?e:new St(e)}static pad(e){return e instanceof St?e.valueOf():St.split(e).map(Xv).join(".")}static split(e){let t,r;if(e||e===0)switch(typeof e){case"object":e=String(e);case"string":for(r=e.split("."),t=r.length;t-- >0;)r[t]=parseInt(r[t],10);break;case"number":r=[e];break}return r||[]}static compare(e,t){return e===t?0:!e||!t?e?1:t?-1:0:(e=St.pad(e),t=St.pad(t),e<t?-1:t<e?1:0)}append(e){const t=this.value;return St.from(t?`${t}.${e}`:e)}isEqual(e){return!St.compare(this,e)}match(e){let t=!1;if(e){const r=this.value,n=e[0]==="*",s=e.endsWith("*"),a=e.length;n===s?t=r.indexOf(n?e.substr(1,a-2):e)>-1:n?t=r.endsWith(e.substr(1)):t=r.startsWith(e.substr(0,a-1))}return t}toString(){return this.value}toJSON(){return this.toString()}valueOf(){var e;return(e=this._padded)!=null?e:this._padded=St.pad(this.value)}};ua._$name="Wbs";var Zv=Object.freeze([]),Ln=Symbol("StopBranch"),Nd=i=>{var e;return e=class extends(i||F){get StopBranch(){return Ln}get isTree(){return this.tree||this.masterStore&&this.masterStore.tree}get leaves(){const t=this,r=[];return t.isTree?(t.traverse(n=>{n.isLeaf&&r.push(n)}),r):(t.allRecords.forEach(n=>{n.isLeaf&&r.push(n),n.traverse(s=>{s.isLeaf&&r.push(s)},!0)}),r)}async loadChildren(t){}onNodeAddChild(t,r,n,s,a=!1){var l;const o=this,u=t===o.rootNode&&t.isLoading,{storage:c}=o,{previousSibling:d}=r[0];let h;const{visible:g,all:f}=o.collectDescendants(r,void 0,void 0,{inCollapsedBranch:!(t.isExpanded(o)&&t.ancestorsExpanded(o)),applyFilter:o.isFiltered&&o.reapplyFilterOnAdd});if(!u&&f.length)for(const m of f)!o.modified.includes(m)&&!s[m.id]&&(o.removed.includes(m)?o.removed.remove(m):m.isLinked||o.added.add(m));if(u&&o.rootVisible&&(g.unshift(t),f.unshift(t)),g.length?(n===0||!d?h=c.indexOf(t):h=c.indexOf(d)+d.getDescendantCount(!0,o),c.suspendEvents(),o.storage.splice(++h,0,g),c.resumeEvents(),o._idMap=null):o._allRecords=null,o.updateDependentStores("add",r),u&&g.length){if(o.sorters.length&&o.sort(null,null,!1,!0),(l=o.afterLoadData)==null||l.call(o),!a){const m={action:"dataset",data:o._data,records:g};o.trigger("refresh",m),o.trigger("change",m)}}else if(!a){const m={action:"add",parent:t,isChild:!0,isMove:s,records:r,allRecords:f,index:h};if(o.trigger("add",m),o.trigger("change",m),Object.values(s).some(p=>p)){const p={newParent:t,records:r.filter(v=>s[v.id]),oldParents:r.map(v=>o.getById(v.meta.oldParentId))};o.trigger("move",p)}}}onNodeRemoveChild(t,r,n,s={isMove:!1,silent:!1,unfiltered:!1}){const a=this,{storage:l}=a,o=[],u=[],{isMove:c,silent:d,unfiltered:h}=s,g=h&&a.isFiltered,f=g&&t.unfilteredChildren?t.unfilteredChildren:r;if(a.collectDescendants(f,o,u,{inCollapsedBranch:!(t.isExpanded(a)&&t.ancestorsExpanded(a)),unfiltered:g}),!c){for(const m of r)m.unjoinStore(a);for(const m of u)m.stores.includes(a)&&m.unjoinStore(a),a.added.includes(m)?a.added.remove(m):m.isLinked||a.removed.add(m);a.modified.remove(u)}if(o.length?(n=l.indexOf(o[0]),n>-1&&(l.suspendEvents(),l.splice(n,o.length),l.resumeEvents(),a._idMap=null)):(n=-1,a._allRecords=null),!d&&(a.fireRemoveEventForMoveAction||!c)){const m={action:"remove",parent:t,isChild:!0,isMove:c,records:r,allRecords:u,index:n};a.trigger("remove",m),a.trigger("change",m)}return u}collectDescendants(t,r=[],n=[],s={}){var a;const l=this,{inCollapsedBranch:o=!1,unfiltered:u=!1,applyFilter:c=!1}=s,d=Array.isArray(t)?t:(a=l.getChildren(t,u))!=null?a:[];if(c)return{visible:d.flatMap(h=>this.collectVisibleNodeDescendantsFiltered(h)),all:d.flatMap(h=>h.allChildren)};for(let h=0,g=d.length,f;h<g;h++)f=d[h],o||r.push(f),n.push(f),l.collectDescendants(f,r,n,{inCollapsedBranch:o||!f.isExpanded(l),unfiltered:u});return{visible:r,all:n}}collectVisibleNodeDescendantsFiltered(t){const r=t.unfilteredChildren||t.children;if(!r||r.length===0||!t.isLeaf&&!t.isExpanded(this))return this.filtersFunction(t)?[t]:[];const n=r.flatMap(s=>this.collectVisibleNodeDescendantsFiltered(s));return n.length||this.filtersFunction(t)?[t,...n]:[]}getChildren(t,r=!1){const n=this,s=(r||n.isChained)&&t.unfilteredChildren||t.children;return s!=null&&s.length?n.isChained?s.filter(n.chainedFilterFn).sort(n.sorterFn):s:Zv}internalToggleTreeSubRecords(t,r){const n=this,{storage:s}=n,a=s.indexOf(t),l=n.doIncludeExclude(n.getChildren(t),r);if(n.isFiltered&&r&&t.unfilteredChildren&&n.updateChildrenHiddenState(t),l.length&&a!==!1){if(s.suspendEvents(),r){s.splice(a+1,0,...l);const o={action:"add",isExpand:!0,records:l,index:a+1};n.trigger("add",o),n.trigger("change",o)}else{s.splice(a+1,l.length);const o={action:"remove",isCollapse:!0,records:l,index:a+1};n.trigger("remove",o),n.trigger("change",o)}s.resumeEvents(),n._idMap=null}}updateChildrenHiddenState(t){var r;(r=t.unfilteredChildren)==null||r.forEach(n=>{n.instanceMeta(this.id).hidden=!1,n.isLeaf||this.updateChildrenHiddenState(n)})}doIncludeExclude(t,r,n=[]){const s=this,a=(t==null?void 0:t.length)||0;for(let l=0;l<a;l++){const o=t[l];if(!s.isChained||s.chainedFilterFn(o)){const u=o.instanceMeta(s.id);(r||!u.hidden)&&n.push(o),u.hidden=!r,o.isExpanded(s)&&s.doIncludeExclude(s.getChildren(o),r,n)}}return n}async toggleCollapse(t,r){const n=this,s=n.getById(t),a=s.instanceMeta(n);if(r===void 0&&(r=!a.collapsed),!a.isLoadingChildren&&!s.isLeaf&&s.isExpanded(n)===r){if(n.trigger("beforeToggleNode",{record:s,collapse:r}),a.collapsed=r,a.collapsed)return n.onNodeCollapse(s),!0;{n.onNodeExpand(s);let l=!0;if(!s.isLoaded){a.isLoadingChildren=!0;try{await n.loadChildren(s)}catch(o){a.collapsed=!0,l=!1,n.trigger("loadChildrenException",{record:s,exception:o})}finally{a.isLoadingChildren=!1}}return l}}}onNodeCollapse(t){if(t.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(t,!1)}onNodeExpand(t){if(t.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(t,!0)}transformToTree(t){const{parentIdField:r,idField:n,childrenField:s}=this.modelClass,a=new Map,l=new Set,o=[];for(const c of t){const d=c[n];d!=null&&a.set(d,c)}const u=c=>{const d=Object.assign({},c);return d[s]=[],a.set(d[n],d),l.add(c[n]),d};for(let c of t){const d=c[n];l.has(d)?c=a.get(d):c=u(c);const h=c[r];if(h!=null){let g=a.get(h);g&&(g[s]||(g=u(g)),g[s].push(c))}else c[s]?o.push(c):c[n]!=null?o.push(u(c)):o.push(c)}return a.forEach(c=>{var d,h;(h=(d=c[s]).sort)==null||h.call(d,(g,f)=>g.parentIndex-f.parentIndex)}),o}treeify(t,r,n=!1){const{length:s}=t,a=[],l=[],o={};let u,c;for(u=0;u<s;u++){let h=t[u];h=h.field||h,t[u].call||(t[u]=g=>g[h],t[u].fieldName=h),a[u]=new Map}this.rootNode.traverse(h=>{var g;if(c=[],h.isLeaf){for(u=0;u<s;u++){const f=((g=c[(c==null?void 0:c.length)-1])==null?void 0:g.path)||"",m=a[u],p=z.asArray(t[u](h))||[],v=[];if(p[0]===Ln)break;for(let b=0,{length:w}=p;b<w;b++){const S=p[b],C=`${f+(S!=null&&S.isModel?S.id:S)}/`,T=P.makeValidDomId(`generated_${C}`,"_"),E=t[u].fieldName,I=m.get(T)||m.set(T,{id:T,key:S,path:C,expanded:!0,readOnly:!0,children:[],generatedParent:!0,field:E,firstGroupChild:h}).get(T);v.push(I)}c.forEach(b=>{v.forEach(w=>{b.children.includes(w)||b.children.push(w)})}),c=v}c.length?c.forEach((f,m)=>f.children.push(m?h.link():h)):l.push(h)}},!0),(r||n)&&a.forEach(h=>h.forEach((g,f,m)=>{r==null||r(g),n&&(g=this.createRecord(g),m.set(f,g))})),o.children=[...a[0].values(),...l];const d=h=>{h.children&&(h.children.sort((g,f)=>{if(g.isLeaf===f.isLeaf)if(g.isLeaf){let m;for(let p=0;!m&&p<s;p++){const v=t[p](g),b=t[p](f);if(v===Ln||b===Ln)return g.isLeaf<f.isLeaf?-1:g.isLeaf>f.isLeaf?1:0;m=v<b?-1:b>v?1:0}return m}else return typeof g.key=="string"&&typeof f.key=="string"?g.key.localeCompare(f.key,void 0,{numeric:!0}):g.key<f.key?-1:g.key>f.key?1:0;else return g.isLeaf<f.isLeaf?-1:g.isLeaf>f.isLeaf?1:0}),h.children.forEach(d))};return d(o),o}treeifyFlatData(t){const{childrenField:r,parentIdField:n}=this.modelClass;let s=!1,a=!0;for(const l of t){if(l.isModel||Array.isArray(l[r])){a=!1;break}l[n]!=null&&(s=!0)}return a&&s&&(t=this.transformToTree(t)),t}async indent(t){const r=this;if(t=Array.isArray(t)?t:[t],t=t.filter(n=>{let s=!!n.previousSibling;for(;s&&!n.isRoot;)s=!t.includes(n.parent),n=n.parent;return s}),t.length&&r.trigger("beforeIndent",{records:t})!==!1){t.sort((n,s)=>ua.compare(n.wbsCode,s.wbsCode)),r.beginBatch();for(const n of t){const s=n.previousSibling;s.appendChild(n),r.toggleCollapse(s,!1)}r.endBatch(),r.trigger("indent",{records:t}),r.trigger("change",{action:"indent",records:t})}}async outdent(t){const r=this;if(t=Array.isArray(t)?t:[t],t=t.filter(n=>{const{parent:s}=n;let a=s&&!s.isRoot;for(;a&&!n.isRoot;)a=!t.includes(s),n=n.parent;return a}),t.length&&r.trigger("beforeOutdent",{records:t})!==!1){t.sort((n,s)=>ua.compare(n.wbsCode,s.wbsCode)),r.beginBatch();for(const n of t){const{parent:s}=n,a=s.children.slice(s.children.indexOf(n)+1);s.parent.insertChild(n,s.nextSibling),n.appendChild(a),r.toggleCollapse(n,!1)}r.endBatch(),r.trigger("outdent",{records:t}),r.trigger("change",{action:"outdent",records:t})}}},y(e,"$name","StoreTree"),y(e,"StopBranch",Ln),y(e,"configurable",{transformFlatData:null,fireRemoveEventForMoveAction:ie.checkVersion("core","6.0","<")}),e},ca=class{static preWalk(i,e,t){const r=[i];let n,s;for(;r.length;)n=r.pop(),t(n),s=e(n),s&&r.push.apply(r,s.slice().reverse())}static preWalkWithParent(i,e,t){const r=[{node:i,parent:null}];for(;r.length;){const{parent:n,node:s}=r.pop();t(n,s);const a=e(s);Array.isArray(a)&&r.push(...a.slice().reverse().map(l=>({node:l,parent:s})))}}static preWalkUnordered(i,e,t){const r=[i];let n,s;for(;r.length;)n=r.pop(),t(n),s=e(n),s&&r.push.apply(r,s)}static postWalk(i,e,t){const r=new Map,n=[i];let s,a;for(;n.length;)s=n[n.length-1],r.has(s)?(t(s),n.pop()):(a=e(s),a&&n.push(...a.slice().reverse()),r.set(s,s))}static prePostWalk(i,e,t,r){const n=new Map,s=[i];let a,l;for(;s.length;)a=s[s.length-1],n.has(a)?(r(a),s.pop()):(t(a),l=e(a),l&&s.push(...l.slice().reverse()),n.set(a,a))}};ca._$name="WalkHelper";var Bd=i=>class extends(i||F){static get $name(){return"StoreSync"}static get configurable(){return{syncDataOnLoad:null,shouldSyncDataset:null,shouldSyncRecord:null}}syncDataset(t){var r;const n=this,{storage:s}=n,a=(r=n.shouldSyncDataset)==null?void 0:r.call(n,{data:t});if(a===!1)return;n.trigger("startApplyChangeset"),n.isSyncingDataOnLoad=!0;const{toAdd:l,toRemove:o,toMove:u,updated:c,ids:d}=n.tree?n.syncTreeDataset(t,a):n.syncFlatDataset(t,a);let{threshold:h}=n.syncDataOnLoad,g=!1;if(h&&(typeof h=="string"&&(h=parseInt(h,10)/100*n.count),g=l.length+o.length+u.length+c.length>h),n.tree){if(l.length&&n.add(l,g).forEach(p=>p.clearParentId()),u.length)for(const{parent:m,node:p,index:v}of u)n.getById(m.id).insertChild(p,v);n.remove(o,g)}else g&&n.suspendEvents(),n.remove(o),n.add(l),g&&n.resumeEvents();h&&!g&&c.forEach(({record:m,toSet:p,wasSet:v})=>n.onModelChange(m,p,v)),n.acceptChanges();const f={added:l,removed:o,updated:c,thresholdSurpassed:g};if(n.isFiltered&&!n.remoteFilter&&n.filter({silent:n.isRemoteDataLoading}),n.isGrouped)n.group(null,null,!1,!0,n.isRemoteDataLoading);else if(n.isSorted)n.remoteSort?s.replaceValues({values:s.values.sort(n.createSorterFn(n.sorters)),silent:!0}):n.sort();else if(!n.tree)s.values.some((m,p)=>m.id!==d[p])&&(s.replaceValues({values:s.values.sort((m,p)=>d.indexOf(m.id)-d.indexOf(p.id)),silent:!0}),!g&&n.afterPerformSort());else{let m=!1,p=0;ca.preWalk(n.rootNode,v=>Array.isArray(v.children)&&!m?v.children:null,v=>{v.id!==d[p++]&&(m=!0)}),m&&(n.sort((v,b)=>d.indexOf(v.id)-d.indexOf(b.id),void 0,void 0,!0),n.clearSorters(!0),!g&&n.afterPerformSort())}g&&n.trigger("refresh",{action:"batch",data:t,records:s.values,syncInfo:f}),n.isSyncingDataOnLoad=!1,n.trigger("endApplyChangeset"),n.trigger("loadSync",f)}syncFlatDataset(t,r){if(!t)return{toRemove:this.records};const n=this,{idField:s,allFields:a}=n.modelClass,l=[],o=[],u=[],c={},d=[],h=Array.isArray(r),{threshold:g,keepMissingValues:f}=n.syncDataOnLoad;let m=0;if(t.forEach(p=>{var v,b,w;p=p.isModel?p.data:p;const S=p[s],C=n.getById(S);if(!h||r.includes(S))if(C){if(((v=n.shouldSyncRecord)==null?void 0:v.call(n,{record:C,data:p}))!==!1){if((b=n.beforeSyncRecord)==null||b.call(n,{record:C,data:p}),f===!1)for(const E of a)!(E.dataSource in p)&&E.dataSource in C.data&&(p[E.dataSource]=E.defaultValue);const T=C.set(p,null,!!g);T&&u.push({record:C,wasSet:T,toSet:p}),(w=n.afterSyncRecord)==null||w.call(n,{record:C,data:p})}}else o.push(n.processRecord(n.createRecord(p)));C&&m++,c[S]=1,d.push(S)}),m<n.allRecords.filter(p=>!p.isSpecialRow).length)if(r)for(const p of r)c[p]||l.push(n.getById(p));else n.forEach(p=>{c[p.id]||l.push(p)},n,{includeFilteredOutRecords:!0,includeCollapsedGroupRecords:!0});return{toAdd:o,toRemove:l,toMove:[],updated:u,ids:d}}syncTreeDataset(t){if(!t)return{toRemove:this.records};const r=this,{idField:n,parentIdField:s,childrenField:a,allFields:l}=r.modelClass,{keepMissingValues:o,threshold:u}=r.syncDataOnLoad,c=[],d=[],h=[],g=[],f=new Set,m=[];return r.transformFlatData&&(t=r.treeifyFlatData(t)),ca.preWalkWithParent({isRoot:!0,id:r.rootNode.id,children:t},p=>p.children,(p,v)=>{var b;if(p){const{id:w,node:S}=r.resolveSyncNode(v);if(S){if(((b=r.shouldSyncRecord)==null?void 0:b.call(r,{record:S,data:v}))!==!1){let C;const T=S.children;if(T!==!0&&v[a]===!0&&(S.clearChildren(),S.data[a]=S.children=!0,delete v[a],r.toggleCollapse(S,!0),C=!0),S.parent.id!==p[n]&&h.push({node:S,parent:p,index:p[a].indexOf(v)}),o===!1)for(const I of l)I.name!=="parentId"&&!(I.dataSource in v)&&I.dataSource in S.data&&(v[I.dataSource]=I.defaultValue);typeof v.expanded=="boolean"&&this.toggleCollapse(S,!v.expanded);const E=S.set(v,null,!!u);E?g.push({record:S,wasSet:E,toSet:v}):C&&S.signalNodeChanged({[a]:{value:!0,oldValue:T}})}}else v[s]=p[n],d.push({...v,...Array.isArray(v[a])?{children:[]}:void 0});f.add(S),m.push(w)}}),f.length!==t.length&&r.traverse(p=>{f.has(p)||c.push(p)}),{toAdd:d,toRemove:c,toMove:h,updated:g,ids:m}}resolveSyncNode(t){const r=t[this.modelClass.idField],n=this.getById(r);return{id:r,node:n}}},Vd=Symbol("STM_PROP"),jd=i=>class extends(i||F){static get $name(){return"StoreStm"}static get defaultConfig(){return{stm:null,ignoreRemoteChangesInSTM:!1}}get stm(){return this[Vd]}set stm(t){var r;const n=this;n.stm!==t&&((r=n.stm)!=null&&r.hasStore(n)&&n.stm.removeStore(n),n[Vd]=t,n.stm&&!n.stm.hasStore(n)&&n.stm.addStore(n))}add(t,r=!1,n={}){let s;const{stm:a}=this;return!this.tree&&(a!=null&&a.enabled)?(s=super.add(t,r),s!=null&&s.length&&a.onStoreModelAdd(this,s,r)):s=super.add(t,r,n),s}insert(t,r,n=!1){let s;const{stm:a}=this;if(!this.tree&&(a!=null&&a.enabled)){const l=(Array.isArray(r)?r:[r]).reduce((o,u)=>{const c=u instanceof Q?this.indexOf(u):void 0;return c!==void 0&&c!==-1&&o.set(u,c),o},new Map);s=super.insert(t,r),s!=null&&s.length&&(t=this.indexOf(s[0]),a.onStoreModelInsert(this,t,s,l,n))}else s=super.insert(t,r,n);return s}remove(t,r=!1,n){let s;const{stm:a}=this;if(!this.tree&&(a!=null&&a.enabled)){const o=(Array.isArray(t)?t:[t]).map(u=>this.getById(u)).filter(u=>!!u).reduce((u,c)=>{const d=this.indexOf(c);return d!==void 0&&d!==-1&&u.set(c,d),u},new Map);s=super.remove(t,r,n),s!=null&&s.length&&a.onStoreModelRemove(this,s,o,r)}else s=super.remove(t,r,n);return s}removeAll(t){const{stm:r}=this;let n;if(r!=null&&r.enabled){const{tree:s,rootNode:a,allRecords:l}=this,o=l.length,u=s?a.children.slice():l.slice();n=super.removeAll(t),o&&this.count===0&&r.onStoreRemoveAll(this,u,t)}else n=super.removeAll(t);return n}beforeApplyChangeset(){const{stm:t,crudManager:r}=this;let n=!1,s=null;return!(r!=null&&r.applyingChangeset)&&(t!=null&&t.enabled)&&(n=!0,t.isRecording&&(s=t.stash()),this.ignoreRemoteChangesInSTM?t.disable():t.startTransaction()),{shouldResume:n,transactionId:s}}applyChangeset(t,r,n,s,a){const{shouldResume:l,transactionId:o}=this.beforeApplyChangeset(),u=super.applyChangeset(t,r,n,s,a);return this.afterApplyChangeset(l,o),u}afterApplyChangeset(t,r){if(t){const{stm:n}=this;this.ignoreRemoteChangesInSTM?n.enable():n.stopTransaction(),n.applyStash(r)}}},Jv={splice:1,clear:1},Qv={includeFilteredOutRecords:!1,includeCollapsedGroupRecords:!1},Jl=(i,e)=>(e=e||!1,typeof e=="boolean"&&(e={includeFilteredOutRecords:e,includeCollapsedGroupRecords:!1}),e||Qv),re=class Ft extends F.mixin(xe,ai,fe,zl,sa,kd,Ed,xd,Rd,_d,Ad,Pd,Id,Ld,$d,Nd,jd,Bd,Md){static get $name(){return"Store"}static get properties(){return{relationCache:{},dependentStoreConfigs:new Map,addingClean:!1}}static get configurable(){return{id:!0,modelClass:Q,verifyNoGeneratedIds:!0}}static get defaultConfig(){return{fields:null,autoTree:!0,data:null,tree:!1,callOnFunctions:!0,storage:null,useRawData:!1,allowNoId:!0,preventSubClassingModel:null,storeClass:null}}static get identifiable(){return{registerGeneratedId:!1}}constructor(...e){if(super(...e),this.objectify)return this.initProxy()}construct(e={}){const t=this;Object.assign(t,{added:new oa,removed:new oa,modified:new oa,idRegister:{},internalIdRegister:{},oldIdMap:{}}),e.storeId&&(e=x.assign({id:e.storeId},e)),super.construct(e),t.initRelations()}static from(e,t={},r=null){return e&&!e.isStore&&(typeof e=="string"?e=Ft.getStore(e):(Array.isArray(e)?(r&&(e=e.map(n=>n.isModel?n:r(n))),e=x.assign({},t,{data:e})):e=x.assign({},t,e),e=new Ft(e))),e}doDestroy(){var e,t,r,n;const s=this,a=s.registeredRecords;(t=(e=s.stm)==null?void 0:e.removeStore)==null||t.call(e,s);for(let l=a.length-1,o;l>=0;l--)o=a[l],o!=null&&o.isDestroyed||o.unjoinStore(s);(r=s._storage)==null||r.destroy(),s.isChained||(n=s.rootNode)==null||n.destroy(),super.doDestroy()}beginBatch(){this.suspendEvents()}endBatch(){if(this.resumeEvents()){const{values:e}=this.storage;this.trigger("refresh",{action:"batch",data:e,records:e})}}set storage(e){const t=this;e!=null&&e.isCollection?t._storage=e:t._storage=new wr(e),t._storage.autoFilter=t.reapplyFilterOnAdd,t._storage.autoSort=t.reapplySortersOnAdd;for(const r of t._storage)r.joinStore(t);t._storage.ion({change:"onDataChange",thisObj:t})}get storage(){return this._storage||(this.storage={}),this._storage}get allRecords(){var e;const t=this;if(((e=t._allRecords)==null?void 0:e.generation)!==t.storage.generation){if(t.isTree){const r=t.collectDescendants(t.rootNode,void 0,void 0,{unfiltered:!0}).all;t.rootVisible&&r.unshift(t.rootNode),t._allRecords=r}else t._allRecords=t.isGrouped?t.collectGroupRecords():t.storage.allValues;t._allRecords.generation=t.storage.generation}return t._allRecords}getAllDataRecords(e){const t=this;return t.tree?e?t.allRecords:t.rootNode.allChildren:t.isGrouped?t.collectGroupRecords(e,!1):e?t.storage.allValues:t.storage.values}onIsCreatingToggle(e,t){const r=this,n=e.isPersistable&&!t;r.added[n?"add":"remove"](e),n&&(r.trigger("addConfirmed",{record:e}),r.autoCommit&&r.doAutoCommit())}joinRecordsToStore(e){const{allCount:t}=this;for(let r=0;r<e.length;r++){const n=e[r];n.setData("parentIndex",t+r-e.length),n.joinStore(this)}}onDataChange({source:e,action:t,added:r,removed:n,replaced:s,oldCount:a,items:l,from:o,to:u}){const c=this,d=Jv[t],h=d&&(r==null?void 0:r.length),g=d&&(n==null?void 0:n.length);let f,m;if(c._idMap=null,h&&c.joinRecordsToStore(r),s==null||s.forEach(([p,v])=>{p.unjoinStore(c,!0),v.joinStore(c)}),super.onDataChange(...arguments),!c.isTree){if(h){for(const p of r)c.removed.includes(p)?c.removed.remove(p):!c.addingClean&&!p.isLinked&&c.added.add(p);f=!c.remoteFilter&&c.isFiltered&&c.reapplyFilterOnAdd,f&&c.filter({silent:!0}),m=!c.remoteSort&&c.isSorted&&c.reapplySortersOnAdd,m&&c.sort(null,null,!1,!0)}if(g){for(const p of n)p.cancelBatch(),p.unjoinStore(c),c.added.includes(p)?c.added.remove(p):!p._undoingInsertion&&!p.isCreating&&!p.isLinked&&c.removed.add(p);c.modified.remove(n),f=!c.remoteFilter&&c.isFiltered,f&&c.filter({silent:!0})}}switch(t){case"clear":c.relationCache={},c.updateDependentStores("removeall"),c.trigger("removeAll"),c.trigger("change",{action:"removeall"});break;case"splice":if(h){c.updateDependentStores("add",r);const p=r.reduce((w,S)=>{const{previousIndex:C}=S.meta;return C>-1&&C<w&&(w=C),w},r[0].meta.previousIndex),v=e.indexOf(r[0],!e.autoFilter),b={records:r,index:v};p>-1&&(b.oldIndex=p),c.trigger("add",b),c.trigger("change",Object.assign({action:"add"},b)),f&&c.triggerFilterEvent({action:"filter",filters:c.filters,oldCount:a,records:c.storage.allValues}),m&&c.trigger("sort",{action:"sort",sorters:c.sorters,records:c.storage.allValues})}n.length&&(c.updateDependentStores("remove",n),c.trigger("remove",{records:n}),c.trigger("change",{action:"remove",records:n})),s.length&&(c.updateDependentStores("replace",s),c.trigger("replace",{records:s,all:c.records.length===s.length}),c.trigger("change",{action:"replace",replaced:s,all:c.records.length===s.length}));break;case"filter":(c.isGrouped||c.isSorted)&&c.performSort(!0);break;case"move":{const p=Math.min(o,u),v=Math.min(c.storage.allValues.length-1,Math.max(o,u));for(let b=c.storage.allValues,w=p;w<=v;w++)b[w].setData("parentIndex",w);c.trigger("move",{record:l[0],records:l,from:o,to:u}),c.isFiltered&&c.performFilter(),c.trigger("change",{action:t,record:l[0],records:l,from:o,to:u});break}}}onDataReplaced(e,t){var r;const n=this,{storage:s}=n,a=s.allValues,l=n.sorters.length>0;for(let u=0;u<a.length;u++)a[u].joinStore(n);if(!n.remoteFilter&&n.isFiltered&&n.filter({silent:!0}),n.remoteSort?n.isGrouped&&s.replaceValues({...n.prepareGroupRecords(),silent:!0}):(n.isGrouped&&n.group(null,null,!1,!l,!0),l&&n.sort(null,null,!1,!0)),!n.useRawData.disableDuplicateIdCheck){const{idMap:u}=n;if(Object.keys(u).length<s.values.length){const c=[];throw s.values.forEach(d=>u[d.id]?delete u[d.id]:c.push(d)),new Error(`Id collision on ${c.map(d=>d.id)}`)}}const o={action:e,data:t,records:s.values};n.updateDependentStores(e,o.records),(r=n.afterLoadData)==null||r.call(n),n.isRemoteDataLoading||n.trigger("refresh",o),n.trigger("change",o)}onModelChange(e,t,r,n,s){const a=this,l={record:e,records:[e],changes:r,batch:e.batching!=null,fromRelationUpdate:s},o=e.ignoreBag||e.isLinked?!1:a.updateModifiedBagForRecord(e);if(a.storage.onItemMutation(e,r),"id"in r){const{oldValue:u,value:c}=t.id;a.updateDependentRecordIds(u,c),a.onRecordIdChange({record:e,oldValue:u,value:c})}if(!n){if("id"in r){const{oldValue:u,value:c}=t.id;a.trigger("idChange",{store:a,record:e,oldValue:u,value:c})}a.onUpdateRecord(e,r),a.trigger("update",l),a.trigger("change",Object.assign({action:"update"},l))}a.autoCommit&&o&&a.doAutoCommit()}updateModifiedBagForRecord(e){const t=this;let r=!1;return e.isModified?!t.modified.includes(e)&&!t.added.includes(e)&&e.isPartOfStore(t)&&!e.isRoot&&(e.isPhantom?t.added.add(e):t.modified.add(e),r=!0):t.modified.remove(e),r}get idMap(){const e=this,t=!e._idMap,r=e._idMap||(e._idMap={});if(t){const n=e.storage.values;for(let s,a=0,l=0;a<n.length;a++)s=n[a],r[s.id]={index:a,visibleIndex:l,record:s},s.isSpecialRow||l++;if(e.isFiltered)for(let s=0,a=e.storage._values.length;s<a;s++){const l=e.storage._values[s];l.id in r?r[l.id].unfilteredIndex=s:r[l.id]={index:-1,unfilteredIndex:s,record:l}}}return r}changeModelClass(e){const{fields:t}=this;this.originalModelClass=e;let r=e;if(t!=null&&t.length){class n extends e{static get fields(){return t}}r=n}else if(!this.preventSubClassingModel){class n extends e{}r=n}return r.initClass(),r}set storeId(e){this.id=e}get storeId(){return this.id}changeId(e,t){return super.changeId(e!==!0&&e,t)}updateId(e,t){const r=Ft.getById(e);r&&Ft.unregisterInstance(r),super.updateId(e,t)}generateAutoId(){return Ft.generateId("store-")}get tree(){return this._tree}set tree(e){this._tree=e,e&&!this.rootNode&&(this.rootNode=this.buildRootNode(),this.rootNode.isAutoRoot=!0)}buildRootNode(){return{}}static getStore(e,t){if(e instanceof Ft)return e;if(this.getById(e))return this.getById(e);if(Array.isArray(e)){let r;const n=e.map(s=>(s instanceof Q?r=s.constructor:typeof s=="string"&&(s={text:s}),s));if(!r){class s extends Q{}r=s}e={autoCreated:!0,data:n,modelClass:r,allowNoId:!0},t||(t=Ft)}if(t)return new t(e)}static get stores(){return Ft.registeredInstances}get rootNode(){return this.masterStore?this.masterStore.rootNode:this._rootNode}set rootNode(e){var t;const r=this,n=r._rootNode;e!==n&&(n&&(r.clear(!0),r.removed.clear()),e instanceof Q?(e.instanceMeta(r).collapsed=!1,r._rootNode=e):r._rootNode=e=new r.modelClass(Object.assign({expanded:!0,[r.modelClass.idField]:`${r.id}-rootNode`},e),r,null,!0),r._tree=!0,e.isRoot=!0,e.joinStore(r),((t=e.children)!=null&&t.length||r.rootVisible)&&(e.isLoading=!0,r.onNodeAddChild(e,e.children||[],0),e.isLoading=!1),r.trigger("rootChange",{oldRoot:n,rootNode:e}))}set data(e){this.setStoreData(e)}setStoreData(e){const t=this,{idField:r,childrenField:n}=t.modelClass;if(t.transformFlatData&&(e==null?void 0:e.length)>0&&!Object.isExtensible(e[0])&&(t.useRawData=t.useRawData||{disableDuplicateIdCheck:!1,disableDefaultValue:!1,disableTypeConversion:!1},e=x.clone(e)),t.getConfig("plugins"),t.processConfiguredListeners(),e&&!Array.isArray(e)&&(e=x.transformNamedObjectToArray(e,r)),t.tree=!t.isChained&&(t.tree||!!(t.autoTree&&(e!=null&&e.some(s=>s[n])))),e&&(t.remoteSort||t.remoteFilter))for(let s=0;s<e.length;s++)e[s]._remoteSortIndex=s;if(!t.syncDataOnLoad||!t._data){if(t._data=e,t.tree){t.transformFlatData&&(e=t.treeifyFlatData(e));const s=t.rootNode;if(s.isLoading=!0,t.clear(!0),s.appendChild(e),t.updateDependentStores("dataset",[s]),s.isLoading=!1,e.length===0){const a={action:"dataset",data:[],records:[]};t.trigger("refresh",a),t.trigger("change",a)}else t.isFiltered&&t.filter()}else t.loadData(e);t.added.clear(),t.removed.clear(),t.modified.clear()}else t.syncDataset(e)}loadData(e,t="dataset"){var r,n;const s=this,{storage:a,allowNoId:l}=s,o=s.modelClass.fieldMap.id.dataSource,u=s.find(d=>d.isCreating);u&&a.values.splice(s.records.indexOf(u),1);let c=s.verifyNoGeneratedIds;if(s.removeHeadersAndFooters(s.storage.values),s._idMap=null,s.oldIdMap={},e){if(!(e[0]instanceof Q)){s.modelClass.exposeProperties(e[0]);const h=e.length,g=new Array(h);for(let f=0;f<h;f++){const m=e[f];if(!l&&m[o]==null)throw new Error(`Id required but not found on row ${f}`);c&&((n=(r=m[o])==null?void 0:r.startsWith)!=null&&n.call(r,"_generated"))&&(console.warn(`Generated id found in data: ${m[o]}. Generated ids are temporary and should be replaced with real ids by the backend`),c=!1),g[f]=s.processRecord(s.createRecord(m,!0),!0),g[f].setData("parentIndex",f)}s.clear(!0),a.replaceValues({values:g,isNewDataset:!0,silent:!0})}else s.clear(!0),a.replaceValues({values:e.slice(),isNewDataset:!0,silent:!0});u&&!a.values.includes(u)&&a.values.push(u),s._data=e,s.onDataReplaced(t,e)}else s.clear(!0),s._data=null;s.isSyncingDataOnLoad=!1}get data(){return this._data}getRange(e,t,r=!0){return(r?this.storage.allValues:this.storage.values).slice(e,t)}createRecord(e,t=!1,r=!1){return new this.modelClass(e,this,null,t,!1,r)}processRecord(e,t=!1){return e}refreshData(){this.filter(),this.sort()}onRecordIdChange({record:e,oldValue:t,value:r}){const n=this,s=n._idMap,{idRegister:a,oldIdMap:l}=n;if(n.storage._indicesInvalid=!0,l[t]=e,s&&!s[r]){const o=s[t];delete s[t],s[r]=o}n.added.changeId(t,r),n.removed.changeId(t,r),n.modified.changeId(t,r),delete a[t],a[r]=e,e.index=n.storage.indexOf(e)}onUpdateRecord(e,t){const r=this,{internalId:n}=t,{internalIdRegister:s}=r;n&&(this.storage._indicesInvalid=!0,delete s[n.oldValue],s[n.value]=e),r.reapplyFilterOnUpdate&&r.isFiltered&&r.filter()}get useRawData(){return this._useRawData}set useRawData(e){e===!0?this._useRawData={enabled:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0,disableDefaultValue:!1}:this._useRawData=e?Object.assign(e,{enabled:!0}):{enabled:!1}}getCount(e=!0){return e?this.count:this.originalCount}get originalCount(){var e;return this.storage.totalCount-(((e=this.groupRecords)==null?void 0:e.count)||0)}get count(){return this.storage.count}get allCount(){return this.isTree?this.rootNode.descendantCount:this.storage.totalCount}get records(){return this.storage.values}get first(){return this.storage.values[0]}get last(){return this.storage.values[this.storage.values.length-1]}getAt(e,t=!1){return this.storage.getAt(e,t)}register(e){const t=this;if(!t.useRawData.disableDuplicateIdCheck){const r=t.isTree&&t.idRegister[e.id];if(r&&r!==e)throw new Error(`Id collision on ${e.id}`)}t.idRegister[e.id]=e,t.internalIdRegister[e.internalId]=e}unregister(e){delete this.idRegister[e.id],delete this.internalIdRegister[e.internalId]}get registeredRecords(){return Object.values(this.idRegister)}getById(e){if(e!=null&&e.isModel){const t=e;return t.hasLinks&&!this.storage.allValues.includes(t)?t.$links.find(r=>this.storage.allValues.includes(r)):t}return this.idRegister[e]}isAvailable(e){const t=this.getById(e);return t&&this.storage.includes(t)||!1}getByInternalId(e){return this.internalIdRegister[e]}includes(e){return this.isTree?this.idRegister[Q.asId(e)]!=null:this.indexOf(e)>-1}indexOf(e,t=!1,r=!1){if(e!=null&&e.isModel&&!e.stores.includes(this.$store||this)){const a=e.$links.find(l=>this.storage.allValues.includes(l));return a?this.indexOf(a,t):-1}if(this.isTree)return(r?this.rootNode.allChildren:this.storage.values).indexOf(this.getById(e));const n=Q.asId(e);if(n==null)return-1;const s=this.idMap[n];return s?s[t?"visibleIndex":"index"]:-1}allIndexOf(e){return this.isTree?this.allRecords.indexOf(this.getById(e)):this.storage.indexOf(e,!0)}getDistinctValues(e,t=!1){const r=this,n=[],s={};let a;return r.forEach(l=>{if(!l.isSpecialRow&&!l.isRoot){a=l.getValue(e);const o=a instanceof Date?a.getTime():a;s[o]||(n.push(a),s[o]=1)}},r,{includeCollapsedGroupRecords:!0,includeFilteredOutRecords:t}),n}getValueCount(e,t){let r=0;return this.forEach(n=>{x.isEqual(n.getValue(e),t)&&r++}),r}set json(e){typeof e=="string"&&(e=P.safeJsonParse(e)),this.data=e}get json(){return P.safeJsonStringify(this)}get formattedJSON(){return P.safeJsonStringify(this,null,4)}toJSON(){return(this.isTree?this.rootNode.unfilteredChildren||this.rootNode.children||[]:this.allRecords).map(e=>e.toJSON())}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.project}getInlineData(e){var t;const r=[];return this.tree?(t=this.rootNode.children)==null||t.forEach(n=>r.push(n.getCurrentConfig(e))):this.forEach(n=>r.push(n.getCurrentConfig(e))),r}getCurrentConfig(e){var t;const r=super.getCurrentConfig(e),{state:n}=this;return r&&(r.data&&(r.data=this.getInlineData(e)),delete r.project,delete r.stm,delete r.asyncEvents,((t=r.modelClass)==null?void 0:t.$meta.hierarchy[r.modelClass.$meta.hierarchy.length-2])===this.constructor.defaultConfig.modelClass&&delete r.modelClass,this.tree||delete r.tree,n&&Object.assign(r,n)),r}forEach(e,t=this,r){const n=this,s=(a,l)=>{if(!a.isRoot&&!a.isSpecialRow)return e.call(t,a,l)};if(r=Jl(n,r),n.isTree)n.isChained&&(r={...r,sorterFn:n.sorterFn}),n.rootNode.traverseWhile(s,!1,r);else{const a=r.includeFilteredOutRecords?n.storage.allValues:n.storage.values;if(n.isGrouped&&r.includeCollapsedGroupRecords)for(let l=0;l<a.length;l++){const o=a[l],u=r.includeFilteredOutRecords?o.unfilteredGroupChildren:o.groupChildren;if(u&&o.meta.collapsed===!0)for(let c=0;c<u.length;c++){const d=u[c];if(s(d,c)===!1)return}else if(s(o,l)===!1)return}else for(let l=0;l<a.length;l++)if(s(a[l],l)===!1)return}}map(e,t=this){return this.storage.values.map(e,t)}flatMap(e,t=this){return this.storage.values.flatMap(e,t)}every(e,t=this,r){return this.storage[r?"allValues":"values"].every(e,t)}reduce(e,t=[],r=this){return r!==this&&(e=e.bind(r)),this.storage.values.reduce(e,t,r)}[Symbol.iterator](){return this.storage.values[Symbol.iterator]()}traverse(e,t=this.rootNode,r=t===this.rootNode,n){const s=this;if(n=Jl(s,n),s.isTree){if(typeof t=="boolean"&&(r=t,t=s.rootNode),s.isChained){const a=e;e=l=>{s.chainedFilterFn(l)&&a(l)}}t.traverse(e,r,n)}else s.forEach(a=>a.traverse(e,!1,n),s,n)}traverseWhile(e,t=this.rootNode,r=t===this.rootNode,n){const s=this;if(n=Jl(s,n),s.isTree){if(typeof t=="boolean"&&(r=t,t=s.rootNode),s.isChained){const a=e;e=l=>{s.chainedFilterFn(l)&&a(l)}}t.traverseWhile(e,r,n)}else for(const a of s.storage)if(a.traverse(e,!1,n)===!1)break}getNext(e,t=!1,r=!1){const n=this,s=n.storage.values;let a=n.indexOf(e);if(a>=s.length-1)if(t)a=-1;else return null;const l=s[a+1];return r&&l&&l.isSpecialRow?n.getNext(s[a+1],t,!0):l}getPrev(e,t=!1,r=!1){const n=this,s=n.storage.values;let a=n.indexOf(e);if(a===0)if(t)a=s.length;else return null;const l=s[a-1];return r&&l&&l.isSpecialRow&&a>0?n.getPrev(s[a-1],t,!0):l}getAdjacent(e,t=!0,r=!1,n=!1){return t?this.getNext(e,r,n):this.getPrev(e,r,n)}getNextLeaf(e,t=!1){const r=this,n=r.leaves,s=r.getById(e);let a=n.indexOf(s);if(a>=n.length-1)if(t)a=-1;else return null;return n[a+1]}getPrevLeaf(e,t=!1){const r=this,n=r.leaves,s=r.getById(e);let a=n.indexOf(s);if(a===0)if(t)a=n.length;else return null;return n[a-1]}getAdjacentLeaf(e,t=!0,r=!1){return t?this.getNextLeaf(e,r):this.getPrevLeaf(e,r)}};re.initClass(),re._$name="Store";var ey=(i,e)=>(Array.isArray(e[1])?e[1].forEach(t=>i.push(encodeURIComponent(e[0])+"="+encodeURIComponent(t))):i.push(encodeURIComponent(e[0])+"="+encodeURIComponent(e[1])),i),da=Promise.resolve(),$n=i=>String(i).padStart(2,"0"),ty=i=>`${i.getFullYear()}-${$n(i.getMonth()+1)}-${$n(i.getDate())}T${$n(i.getHours())}:${$n(i.getMinutes())}:${$n(i.getSeconds())}.${i.getMilliseconds()}`,Xe=class extends re{static get defaultConfig(){return{headers:null,fetchOptions:null,sendAsFormData:null,writeAllFields:null,parentIdParamName:"id",responseSuccessProperty:"success",responseDataProperty:"data",responseTotalProperty:"total",filterParamName:null,restfulFilter:!1,sortParamName:null,pageParamName:null,pageStartParamName:null,pageSizeParamName:"pageSize",useRestfulMethods:null,httpMethods:{create:"POST",read:"GET",update:"PUT",delete:"DELETE"}}}updatePageSize(i){const e=this;if(!this.isConfiguring){const t=e.currentPage=e.currentPage?Math.min(e.currentPage,Math.floor((e.allCount+i-1)/i)):1;i&&e.loadPage(t)}}afterConstruct(i){super.afterConstruct(i),this.autoLoad&&this.load().catch(()=>{})}get isLoading(){return this._isLoading?2:this.loadTriggerPromise?1:!1}get isCommitting(){return!!this.commitPromise}set pageParamName(i){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageStartParamName)throw new Error("Configs pageStartParamName and pageParamName are mutually exclusive");this._pageParamName=i}get pageParamName(){return this._pageParamName}set pageStartParamName(i){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageParamName)throw new Error("Configs pageParamName and pageStartParamName are mutually exclusive");this._pageStartParamName=i}get pageStartParamName(){return this._pageStartParamName}get isPaged(){return this.pageParamName||this.pageStartParamName}get allCount(){return"remoteTotal"in this?this.remoteTotal:super.allCount}get lastPage(){if(this.isPaged)return Math.floor((this.allCount+this.pageSize-1)/this.pageSize)}buildQueryString(i,...e){const t=i.includes("?"),r=Object.entries(Object.assign({},...e)).reduce(ey,[]).join("&");return r?(t?"&":"?")+r:""}async performSort(i){const e=this;if(e.remoteSort&&!e.isRemoteDataLoading){e.isRemoteDataLoading=!0;const t=await e.internalLoad({},"",r=>{e.data=r.data,e.afterPerformSort(i)});return e.isRemoteDataLoading=!1,t}else super.performSort(i)}async performFilter(i){var e;const t=this;if(t.remoteFilter){(e=t.loadingPromise)==null||e.abort(),t.isRemoteDataLoading=!0;const r=t.count,{filters:n}=t;t.currentPage=1;const s=await t.internalLoad({},"",a=>{t.data=a.data,a=i?null:{action:"filter",filters:n,oldCount:r,records:t.storage.values},t.afterPerformFilter(a),t.trigger("refresh",a)});return t.isRemoteDataLoading=!1,s}else super.performFilter(i)}encodeFilterParams(i){const e=[];for(const{property:t,operator:r,value:n,caseSensitive:s}of i)e.push({field:t,operator:r,value:n,caseSensitive:s});return JSON.stringify(e,function(t,r){return t===""?r:this[t]instanceof Date?ty(this[t]):r})}encodeSorterParams(i){return JSON.stringify(i.filter(e=>!e.sortFn).map(e=>e))}buildReadUrl(){const{readUrl:i}=this;return this.restfulFilter&&this.filters.count?(i.endsWith("/")?i:i+"/")+this.filters.first.value:i}internalLoad(i,e,t,r=0){i=x.assign({},this.params,i);const n=this,s=n.buildReadUrl(),a={action:"read"+e,params:i,url:s};if(!s)throw new Error("No load url specified");if(n.trigger("beforeLoad"+e,a)===!1)throw!1;return n.loadArgs=[s,a,i,e,t],r===!1?new Promise((l,o)=>n.sendLoadRequest(l,o)):n.loadTriggerPromise||(n.loadTriggerPromise=new Promise((l,o)=>{n.setTimeout({delay:r,fn:"sendLoadRequest",args:[l,o],cancelOutstanding:!0})}))}async sendLoadRequest(i,e){const t=this,[r,n,s,a,l]=t.loadArgs;if(t.loadTriggerPromise=null,r){if(t._isLoading=!0,t.trigger(`load${a}Start`,n),t.trigger("beforeRequest",n),t.filterParamName&&t.isFiltered&&(s[t.filterParamName]=t.encodeFilterParams(t.filters.values)),t.remoteSort&&t.isSorted&&(s[t.sortParamName]=t.encodeSorterParams(t.groupers?t.groupers.concat(t.sorters):t.sorters)),t.isPaged){if(!(t.pageParamName in s||t.pageStartParamName in s)){const u=Math.min(t.currentPage||1,t.allCount?t.lastPage:1/0);t.pageParamName?s[t.pageParamName]=u:s[t.pageStartParamName]=(u-1)*t.pageSize}s[t.pageSizeParamName]=t.pageSize}const o={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(o.method=t.httpMethods.read,n.body&&(o.body=JSON.stringify(n.body)));try{const u=t.loadingPromise=Vt.get(n.url+t.buildQueryString(n.url,s),x.assign(o,t.fetchOptions)),c=await u,d=c.parsedJson,h=Array.isArray(d),g=h||d&&x.getPath(d,t.responseSuccessProperty)!==!1,f=h?null:x.getPath(d,t.responseTotalProperty);if(t.isDestroyed)return;if(t.loadingPromise=null,t._isLoading=!1,n.response=c,n.json=d,g){if(f!=null&&(t.remoteTotal=parseInt(f,10)),t.isPaged)if(t.remoteTotal>=0){const m=t.pageParamName?s[t.pageParamName]:s[t.pageStartParamName]/t.pageSize+1;t.currentPage=Math.min(m,t.lastPage)}else throw new Error("A paged store must receive its responseTotalProperty in each data packet");n.data=h?d:x.getPath(d,t.responseDataProperty),await l(n),!t.isDestroyed&&t.trigger("load"+a,n),i(n)}else Object.assign(n,{exception:!0,exceptionType:"server",error:d==null?void 0:d.error}),!t.isDestroyed&&t.trigger("exception",n),e(n);!t.isDestroyed&&t.trigger("afterRequest",n)}catch(u){t._isLoading=!1,n.exception=!0,u instanceof Response?(n.exceptionType=u.ok?"server":"network",n.response=u,n.error=u.error):(n.exceptionType="server",n.error=u),!t.isDestroyed&&t.trigger("exception",n),e(n),!t.isDestroyed&&t.trigger("afterRequest",n)}}}async load(i){const e=this;return e.isPaged?e.loadPage(e.currentPage||1,i):e.internalLoad(i,"",t=>{e.data=t.data})}async loadChildren(i){return this.readUrl?this.internalLoad({[this.parentIdParamName]:i.id},"Children",e=>{e.parentRecord=i,i.children.length&&i.clearChildren(!0),i.data[i.constructor.childrenField]=e.data,i.processChildren(i.stores)},!1):this.immediatePromise}async loadPage(i,e){this.allCount&&(i=Math.min(i,this.lastPage));const t=this,r=t.pageParamName?{[t.pageParamName]:i}:{[t.pageStartParamName]:(i-1)*t.pageSize};return r[t.pageSizeParamName]=t.pageSize,t.internalLoad(x.assign(r,e),"Page",n=>{t.loadData(n.data,"pageLoad")})}async nextPage(i){const e=this;return e.isPaged&&e.currentPage!==e.lastPage?e.loadPage(e.currentPage+1,i):da}async previousPage(i){return this.isPaged&&this.currentPage!==1?this.loadPage(this.currentPage-1,i):da}async commit(){const i=this,{changes:e}=i,t=[];if(i.commitPromise)return!1;if(!e)return i.modified.count&&(i.modified.forEach(r=>r.clearChanges(!0,!1)),i.modified.clear()),da;if(i.trigger("beforeCommit",{changes:e})!==!1){[...e.added,...e.modified,...e.removed].forEach(s=>s.meta.committing=!0),i.trigger("commitStart",{changes:e});const r={action:"commit",exception:!1,changes:e};let n=i.commitRemoved(r);return n&&t.push(n),n=i.commitAdded(r),n&&t.push(n),n=i.commitModified(r),n&&t.push(n),t.length?(n=t.length===1?t[0]:Promise.all(t),i.commitPromise=new Promise((s,a)=>{n.then(()=>{i.commitPromise=null,r.exception?(i.trigger("exception",r),a(r)):(i.trigger("commit",{changes:e}),s(r))}).catch(()=>{i.commitPromise=null,a(r)})})):(i.modified.forEach(s=>s.clearChanges(!0,!1)),i.modified.clear(),i.added.forEach(s=>s.clearChanges(!0,!1)),i.added.clear(),i.removed.clear(),i.trigger("commit",{changes:e}),da)}}doAutoCommit(){this.suspendCount<=0&&this.commit().catch(i=>{const{response:e}=i;if(!(e&&(e.ok&&e.parsedJson||[500,404].includes(e.status))))throw i})}commitAdded(i){const e=this,t=e.added,r={action:"create",params:e.params};return t.count&&e.createUrl?new Promise(n=>{const s=t.values.map(u=>u.persistableData);i.create=r,r.body={data:s},e.trigger("beforeRequest",r);let a=r.body;if(e.sendAsFormData){const u=new FormData;u.append("data",JSON.stringify(s)),a=u}const l={headers:e.headers,parseJson:!0},o=e.createUrl+e.buildQueryString(e.createUrl,e.params);e.useRestfulMethods&&(l.method=e.httpMethods.create),Vt.post(o,a,x.assign(l,e.fetchOptions)).then(u=>{const c=u.parsedJson,d=Array.isArray(c),h=d||c&&c.success!==!1;i.response=u,r.json=c,r.response=u,h?(e.processReturnedData(t.values,d?c:x.getPath(c,e.responseDataProperty)),t.clear(),e.trigger("commitAdded"),e.trigger("refresh",r),n(i)):(t.forEach(g=>g.meta.committing=!1),i.exception=r.exception=!0,i.exceptionType=r.exceptionType="server",e.trigger("exception",r),n(i)),e.trigger("afterRequest",r)}).catch(u=>{t.forEach(c=>c.meta.committing=!1),i.exception=r.exception=!0,u instanceof Response?(i.response=u,r.exceptionType=u.ok?"server":"network",r.response=u,r.error=u.error):(r.exceptionType="server",r.error=u),e.trigger("exception",r),n(i),e.trigger("afterRequest",r)})}):null}commitModified(i){const e=this,{modified:t}=e.changes,r={action:"update",params:e.params},n=t.length&&e.updateUrl?new Promise(s=>{const a=t.map(u=>e.writeAllFields?u.persistableData:u.modificationDataToWrite).filter(u=>!x.isEmpty(u));if(a.length===0){e.modified.clear(),t.forEach(u=>u.meta.committing=!1),s();return}i.update=r,r.body={data:a},e.trigger("beforeRequest",r);let l=r.body;if(e.sendAsFormData){const u=new FormData;u.append("data",JSON.stringify(a)),l=u}const o={headers:e.headers,parseJson:!0};e.useRestfulMethods&&(o.method=e.httpMethods.update),Vt.post(e.updateUrl+e.buildQueryString(e.updateUrl,e.params),l,x.assign(o,e.fetchOptions)).then(u=>{const c=u.parsedJson,d=Array.isArray(c),h=d||c&&c.success!==!1;i.response=u,r.json=c,r.response=u,h?(e.processReturnedData(t,d?c:x.getPath(c,e.responseDataProperty),!0),e.modified.clear(),e.trigger("commitModified"),e.trigger("refresh",r),s(i)):(t.forEach(g=>g.meta.committing=!1),i.exception=r.exception=!0,r.exceptionType="server",e.trigger("exception",r),s(i)),e.trigger("afterRequest",r)}).catch(u=>{t.forEach(c=>c.meta.committing=!1),i.exception=r.exception=!0,u instanceof Response?(i.response=u,r.exceptionType=u.ok?"server":"network",r.response=u,r.error=u.error):(r.exceptionType="server",r.error=u),e.trigger("exception",r),s(i),e.trigger("afterRequest",r)})}):null;return!t.length&&e.modified.count&&e.modified.clear(),n}processReturnedData(i,e,t=!1){const r=this,n=r.modelClass,s=n.fieldMap.id.dataSource;e.forEach((a,l)=>{const o=i[l];o.clearChanges(!0,!1),o.syncId(a[s]),Object.assign(i[l].data,n.processData(a,t,r,o))})}commitRemoved(i){const e=this,t=e.removed,r={action:"delete",params:e.params};return t.count&&e.deleteUrl?new Promise(n=>{i.delete=r,r.body={ids:t.map(l=>l.id)},e.trigger("beforeRequest",r);let s=r.body;if(e.sendAsFormData){const l=new FormData;l.append("id",JSON.stringify(s.ids)),s=l}const a={headers:e.headers,parseJson:!0};e.useRestfulMethods&&(a.method=e.httpMethods.delete),Vt.post(e.deleteUrl+e.buildQueryString(e.deleteUrl,e.params),s,x.assign(a,e.fetchOptions)).then(l=>{const o=l.parsedJson,u=Array.isArray(o),c=u||o&&o.success!==!1;i.response=l,r.json=o,r.response=l,c?(t.forEach(d=>d.meta.committing=!1),t.clear(),e.trigger("commitRemoved"),e.trigger("refresh",r),n(i)):(t.forEach(d=>d.meta.committing=!1),i.exception=r.exception=!0,r.exceptionType="server",e.trigger("exception",r),n(i)),e.trigger("afterRequest",r)}).catch(l=>{t.forEach(o=>o.meta.committing=!1),i.exception=r.exception=!0,l instanceof Response?(i.response=l,r.exceptionType=l.ok?"server":"network",r.response=l,r.error=l.error):(r.exceptionType="server",r.error=l),e.trigger("exception",r),n(i),e.trigger("afterRequest",r)})}):null}get remoteFilter(){return!!(this.filterParamName||this.restfulFilter)}get remoteSort(){return!!this.sortParamName}};y(Xe,"$name","AjaxStore"),y(Xe,"configurable",{params:null,pageSize:50}),Xe._$name="AjaxStore";var Dr=class{static get(i,e){const t=i._domData||(i._domData={});return e!=null?t[e]:t}static remove(i,e){const{_domData:t}=i,r=t==null?void 0:t[e];return t==null||delete t[e],r}static set(i,e,t){arguments.length===3?(i._domData||(i._domData={}))[e]=t:i._domData=e}static assign(i,e){Object.assign(i._domData||(i._domData={}),e)}};Dr._$name="DomDataStore";var ye=()=>{throw new Error("Abstract method call!")},ae=()=>{throw new Error("Method cannot be called at this state!")},qt=class extends F{canUndo(i){ye()}canRedo(i){ye()}onUndo(i){ye()}onRedo(i){ye()}onStartTransaction(i){ye()}onStopTransaction(i){ye()}onStopTransactionDelayed(i){ye()}onRejectTransaction(i){ye()}onEnable(i){ye()}onDisable(i){ye()}onAutoRecordOn(i){ye()}onAutoRecordOff(i){ye()}onResetQueue(i){ye()}onModelUpdate(i){ye()}onStoreModelAdd(i){ye()}onStoreModelInsert(i){ye()}onStoreModelRemove(i){ye()}onStoreModelRemoveAll(i){ye()}onModelInsertChild(i){ye()}onModelRemoveChild(i){ye()}};qt._$name="StateBase";var se=Symbol("STATE_PROP"),Kt=Symbol("STORES_PROP"),Ne=Symbol("QUEUE_PROP"),tt=Symbol("POS_PROP"),ce=Symbol("TRANSACTION_PROP"),Ze=Symbol("TRANSACTION_TIMER_PROP"),rt=Symbol("AUTO_RECORD_PROP"),Nn=Symbol("IS_APPLYING_STASH"),k0=Object.freeze([se,Kt,Ne,tt,ce,Ze,rt,Nn]),zd=new Map,ry=(i,e)=>{zd.set(i,e)},iy=i=>(typeof i=="string"&&(i=zd.get(i)),i),ht={registerStmState:ry,resolveStmState:iy},ha=(i,e)=>{const{undo:t,redo:r}=e;let n;return t&&!r?n={[Ne]:i[Ne].slice(i.position),[tt]:0}:r&&!t?n={[Ne]:i[Ne].slice(0,i.position)}:n={[Ne]:[],[tt]:0},[n,()=>{i.notifyStoresAboutQueueReset(e)}]},ny=class extends qt{canUndo(){return!1}canRedo(){return!1}onUndo(){ae()}onRedo(){ae()}onEnable(i){return i.autoRecord?"autoreadystate":"readystate"}onDisable(){ae()}onAutoRecordOn(){return{[rt]:!0}}onAutoRecordOff(){return{[rt]:!1}}onStartTransaction(){ae()}onStopTransaction(){ae()}onStopTransactionDelayed(){ae()}onRejectTransaction(){ae()}onResetQueue(i,e){return ha(i,e)}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}},Wd=new ny,sy=Wd;ht.registerStmState("disabledstate",Wd);var di=Symbol("ACTION_QUEUE_PROP"),fa=class extends F{get defaultConfig(){return{title:null}}construct(...i){this[di]=[],super.construct(...i)}get queue(){return this[di].slice(0)}get length(){return this[di].length}addAction(i){this[di].push(i)}undo(){const i=this[di];for(let e=i.length-1;e>=0;--e)i[e].undo()}redo(){const i=this[di];for(let e=0,t=i.length;e<t;++e)i[e].redo()}};fa._$name="Transaction";var Hd=class extends qt{canUndo(i){return 0<i.position&&i.position<=i.length}canRedo(i){return 0<=i.position&&i.position<i.length}onUndo(i,e){let t=i.position;const r=i[Ne],n=Math.max(0,t-e),s=()=>{i.notifyStoresAboutStateRestoringStart();const a=[];for(;t!==n;){const l=r[--t];l.undo(),a.push(l)}return[i.autoRecord?"autoreadystate":"readystate",()=>{i.notifyStoresAboutStateRestoringStop({cause:"undo",transactions:a})}]};return[{[se]:"restoringstate",[tt]:n},s]}onRedo(i,e){let t=i.position;const r=i[Ne],n=Math.min(r.length,t+e),s=()=>{i.notifyStoresAboutStateRestoringStart();const a=[];do{const l=r[t++];l.redo(),a.push(l)}while(t!==n);return[i.autoRecord?"autoreadystate":"readystate",()=>{i.notifyStoresAboutStateRestoringStop({cause:"redo",transactions:a})}]};return[{[se]:"restoringstate",[tt]:n},s]}onEnable(){ae()}onDisable(){return"disabledstate"}onAutoRecordOn(){return{[se]:"autoreadystate",[rt]:!0}}onAutoRecordOff(){ae()}onStartTransaction(i,e){const t=new fa({title:e});return[{[se]:"recordingstate",[ce]:t},()=>{i.notifyStoresAboutStateRecordingStart(t)}]}onStopTransaction(){ae()}onStopTransactionDelayed(){ae()}onRejectTransaction(){ae()}onResetQueue(i,e){return ha(i,e)}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}},Yd=new Hd,ga=Yd;ht.registerStmState("readystate",Yd);var Ud=class extends qt{canUndo(){return!1}canRedo(){return!1}onEnable(){}onDisable(i){const e=i[ce];return i.notifyStoresAboutStateRecordingStop(e,{disabled:!0}),{[se]:"disabledstate",[ce]:null}}onAutoRecordOn(i){return[{[se]:"autorecordingstate",[rt]:!0},()=>{i.stopTransactionDelayed()}]}onAutoRecordOff(){ae()}onStartTransaction(){ae()}onStopTransaction(i,e){const t=i[ce],r=i[Ne];let n=i[tt];return t.length&&(!t.title&&!e&&i.getTransactionTitle?t.title=i.getTransactionTitle(t):e&&(t.title=e),r[n]=t,r.length=++n),[{[se]:"readystate",[tt]:n,[ce]:null},()=>{i.notifyStoresAboutStateRecordingStop(t,{stop:!0})}]}onRejectTransaction(i){const e=i[ce];return[{[se]:"restoringstate",[ce]:null},()=>(e.length&&e.undo(),["readystate",()=>{i.notifyStoresAboutStateRecordingStop(e,{rejected:!0})}])]}onStopTransactionDelayed(){ae()}onResetQueue(i,e){return ha(i,e)}onModelUpdate(i,e,t,r,n){i[ce].addAction(i.makeModelUpdateAction(e,t,r,n))}onModelInsertChild(i,e,t,r,n,s){i[ce].addAction(i.makeModelInsertChildAction(e,t,r,n,s))}onModelRemoveChild(i,e,t,r){i[ce].addAction(i.makeModelRemoveChildAction(e,t,r))}onStoreModelAdd(i,e,t,r){i[ce].addAction(i.makeStoreModelAddAction(e,t,r))}onStoreModelInsert(i,e,t,r,n,s){i[ce].addAction(i.makeStoreModelInsertAction(e,t,r,n,s))}onStoreModelRemove(i,e,t,r,n){i[ce].addAction(i.makeStoreModelRemoveAction(e,t,r,n))}onStoreRemoveAll(i,e,t,r){i[ce].addAction(i.makeStoreRemoveAllAction(e,t,r))}},qd=new Ud,ay=qd;ht.registerStmState("recordingstate",qd);var ly=class extends qt{static get $name(){return"RestoringStateClass"}canUndo(){return!1}canRedo(){return!1}onUndo(){ae()}onRedo(){ae()}onEnable(){ae()}onDisable(){ae()}onAutoRecordOn(){return{[rt]:!0}}onAutoRecordOff(){return{[rt]:!1}}onStartTransaction(){ae()}onStopTransaction(){ae()}onStopTransactionDelayed(){ae()}onRejectTransaction(){ae()}onQueueReset(){ae()}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}},Kd=new ly,oy=Kd;ht.registerStmState("restoringstate",Kd);var uy=class extends Hd{onAutoRecordOn(){ae()}onAutoRecordOff(){return{[se]:"readystate",[rt]:!1}}onStartTransaction(i,e){const t=new fa({title:e});return[{[se]:"autorecordingstate",[ce]:t},()=>{i.notifyStoresAboutStateRecordingStart(t),i.stopTransactionDelayed()}]}onModelUpdate(i,e,t,r){i.startTransaction(),i.onModelUpdate(e,t,r)}onModelInsertChild(i,e,t,r,n){i.startTransaction(),i.onModelInsertChild(e,t,r,n)}onModelRemoveChild(i,e,t,r){i.startTransaction(),i.onModelRemoveChild(e,t,r)}onStoreModelAdd(i,e,t,r){i.startTransaction(),i.onStoreModelAdd(e,t,r)}onStoreModelInsert(i,e,t,r,n,s){i.startTransaction(),i.onStoreModelInsert(e,t,r,n,s)}onStoreModelRemove(i,e,t,r,n){i.startTransaction(),i.onStoreModelRemove(e,t,r,n)}onStoreRemoveAll(i,e,t,r){i.startTransaction(),i.onStoreRemoveAll(e,t,r)}},Gd=new uy,Ql=Gd;ht.registerStmState("autoreadystate",Gd);var cy=class extends Ud.mixin(xe){onDisable(i){const e=i[ce],t=i[Ze];return t&&this.clearTimeout(t),i.notifyStoresAboutStateRecordingStop(e,{disabled:!0}),{[se]:"disabledstate",[ce]:null,[Ze]:null}}onAutoRecordOn(i){ae()}onAutoRecordOff(i){const e=i[Ze];return e&&this.clearTimeout(e),{[se]:"recordingstate",[rt]:!1,[Ze]:null}}onStopTransaction(i,e){const t=i[ce],r=i[Ze],n=i[Ne];let s=i[tt];return r&&this.clearTimeout(r),t.length&&(!t.title&&!e&&i.getTransactionTitle?t.title=i.getTransactionTitle(t):e&&(t.title=e),n[s]=t,n.length=++s),[{[se]:"autoreadystate",[tt]:s,[ce]:null,[Ze]:null},()=>{i.notifyStoresAboutStateRecordingStop(t,{stop:!0})}]}onStopTransactionDelayed(i){let e=i[Ze];return e&&this.clearTimeout(e),e=this.setTimeout(()=>{i.stopTransaction()},i.autoRecordTransactionStopTimeout),{[se]:eo,[Ze]:e}}onResetQueue(i,e){return ha(i,e)}onRejectTransaction(i){const e=i[ce],t=i[Ze];return t&&this.clearTimeout(t),[{[se]:"restoringstate",[ce]:null,[Ze]:null},()=>(e.length&&e.undo(),["autoreadystate",()=>{i.notifyStoresAboutStateRecordingStop(e,{rejected:!0})}])]}onModelUpdate(i,...e){super.onModelUpdate(i,...e),i.stopTransactionDelayed()}onModelInsertChild(i,...e){super.onModelInsertChild(i,...e),i.stopTransactionDelayed()}onModelRemoveChild(i,...e){super.onModelRemoveChild(i,...e),i.stopTransactionDelayed()}onStoreModelAdd(i,...e){super.onStoreModelAdd(i,...e),i.stopTransactionDelayed()}onStoreModelInsert(i,...e){super.onStoreModelInsert(i,...e),i.stopTransactionDelayed()}onStoreModelRemove(i,...e){super.onStoreModelRemove(i,...e),i.stopTransactionDelayed()}onStoreRemoveAll(i,...e){super.onStoreRemoveAll(i,...e),i.stopTransactionDelayed()}},eo=new cy,dy=eo;ht.registerStmState("autorecordingstate",eo);var Xd=()=>{throw new Error("Abstract method call!")},kt=class extends F{get type(){return this.constructor.name}undo(){Xd()}redo(){Xd()}};kt._$name="ActionBase";var Zd=Symbol("MODEL_PROP"),Jd=Symbol("NEW_DATA_PROP"),Qd=Symbol("OLD_DATA_PROP"),to=class extends kt{static get defaultConfig(){return{model:void 0,newData:void 0,oldData:void 0,isInitialUserAction:!1}}get type(){return"UpdateAction"}get model(){return this[Zd]}set model(i){this[Zd]=i}get newData(){return this[Jd]}set newData(i){this[Jd]={...i}}get oldData(){return this[Qd]}set oldData(i){this[Qd]={...i}}undo(){const{model:i,oldData:e}=this;i.$&&Object.assign(i,e),i.set(e,null,null,null,!!i.$)}redo(){const{model:i,newData:e}=this;i.$&&Object.assign(i,e),i.set(e,null,null,null,!!i.$)}};to._$name="UpdateAction";var eh=Symbol("PARENT_MODEL_PROP"),th=Symbol("CHILD_MODELS_PROP"),rh=Symbol("INSERT_INDEX_PROP"),ih=Symbol("CONTEXT_PROP"),ro=class extends kt{static get defaultConfig(){return{parentModel:void 0,childModels:void 0,insertIndex:void 0,context:void 0}}get type(){return"InsertChildAction"}get parentModel(){return this[eh]}set parentModel(i){this[eh]=i}get childModels(){return this[th]}set childModels(i){this[th]=i.slice(0)}get insertIndex(){return this[rh]}set insertIndex(i){this[rh]=i}get context(){return this[ih]}set context(i){this[ih]=i}undo(){const{parentModel:i,context:e,childModels:t}=this,r=new Map,n=new Set;for(const s of t){const a=e.get(s);if(!a)n.add(s);else{let l=r.get(a.parent);l||(l={moveRight:[],moveLeft:[],moveFromAnotherParent:[]},r.set(a.parent,l)),a.parent===i?a.index>s.parentIndex?l.moveRight.push({parent:a.parent,model:s,index:a.index+1}):l.moveLeft.push({parent:a.parent,model:s,index:a.index}):l.moveFromAnotherParent.push({parent:a.parent,model:s,index:a.index})}}for(const s of r.values()){const{moveRight:a,moveLeft:l}=s;l.sort((o,u)=>o.index-u.index),a.sort((o,u)=>u.index-o.index)}n.forEach(s=>s.parent.removeChild(s));for(const s of r.values()){const{moveRight:a,moveLeft:l,moveFromAnotherParent:o}=s;l.forEach(u=>{u.parent.insertChild(u.model,u.index)}),a.forEach(u=>{u.parent.insertChild(u.model,u.index)}),o.forEach(u=>{u.parent.insertChild(u.model,u.index)})}}redo(){var i,e;const{parentModel:t,insertIndex:r,childModels:n}=this,s=(i=t.children)==null?void 0:i[r];t.insertChild(n,s,!1,{orderedBeforeNode:(e=s==null?void 0:s.previousSibling)==null?void 0:e.nextOrderedSibling})}};ro._$name="InsertChildAction";var nh=Symbol("PARENT_MODEL_PROP"),sh=Symbol("CHILD_MODELS_PROP"),ah=Symbol("CONTEXT_PROP"),io=class extends kt{static get defaultConfig(){return{parentModel:void 0,childModels:void 0,context:void 0}}get type(){return"RemoveChildAction"}get parentModel(){return this[nh]}set parentModel(i){this[nh]=i}get childModels(){return this[sh]}set childModels(i){this[sh]=i.slice(0)}get context(){return this[ah]}set context(i){this[ah]=i}undo(){const{parentModel:i,context:e,childModels:t}=this;t.sort((r,n)=>{const s=e.get(r),a=e.get(n);return s-a}),t.forEach(r=>{const n=e.get(r);i.insertChild(r,n.parentIndex,void 0,{orderedParentIndex:n.orderedParentIndex})})}redo(){this.parentModel.removeChild(this.childModels)}};io._$name="RemoveChildAction";var lh=Symbol("STORE_PROP"),oh=Symbol("MODEL_LIST_PROP"),no=class extends kt{static get defaultConfig(){return{store:void 0,modelList:void 0,silent:!1}}get type(){return"AddAction"}get store(){return this[lh]}set store(i){this[lh]=i}get modelList(){return this[oh]}set modelList(i){this[oh]=i.slice(0)}undo(){this.store.remove(this.modelList,this.silent)}redo(){this.store.add(this.modelList,this.silent)}};no._$name="AddAction";var uh=Symbol("STORE_PROP"),ch=Symbol("MODEL_LIST_PROP"),dh=Symbol("INSERT_INDEX_PROP"),hh=Symbol("CONTEXT_PROP"),so=class extends kt{static get defaultConfig(){return{store:void 0,modelList:void 0,insertIndex:void 0,context:void 0,silent:!1}}get type(){return"InsertAction"}get store(){return this[uh]}set store(i){this[uh]=i}get modelList(){return this[ch]}set modelList(i){this[ch]=i.slice(0)}get insertIndex(){return this[dh]}set insertIndex(i){this[dh]=i}get context(){return this[hh]}set context(i){this[hh]=i}undo(){const{store:i,modelList:e,context:t,silent:r}=this;e.sort((n,s)=>{const a=t.get(n),l=t.get(s);return a!==void 0&&l!==void 0?a-l:0}),e.forEach(n=>{const s=t.get(n);n._undoingInsertion=!0,s!==void 0?i.insert(s,n,r):i.remove(n,r),n._undoingInsertion=!1})}redo(){const i=this;i.store.insert(i.insertIndex,i.modelList,i.silent)}};so._$name="InsertAction";var fh=Symbol("STORE_PROP"),gh=Symbol("MODEL_LIST_PROP"),mh=Symbol("CONTEXT_PROP"),ao=class extends kt{static get defaultConfig(){return{store:void 0,modelList:void 0,context:void 0,silent:!1}}get type(){return"RemoveAction"}get store(){return this[fh]}set store(i){this[fh]=i}get modelList(){return this[gh]}set modelList(i){this[gh]=i.slice(0)}get context(){return this[mh]}set context(i){this[mh]=i}undo(){const{store:i,context:e,modelList:t,silent:r}=this;t.sort((n,s)=>{const a=e.get(n),l=e.get(s);return a-l}),t.forEach(n=>{const s=e.get(n);i.insert(s,n,r)})}redo(){this.store.remove(this.modelList,this.silent)}};ao._$name="RemoveAction";var ph=Symbol("STORE_PROP"),vh=Symbol("ALL_RECORDS_PROP"),lo=class extends kt{static get defaultConfig(){return{store:void 0,allRecords:void 0,silent:!1}}get type(){return"RemoveAllAction"}get store(){return this[ph]}set store(i){this[ph]=i}get allRecords(){return this[vh]}set allRecords(i){this[vh]=i.slice(0)}undo(){const{store:i,allRecords:e,silent:t}=this;i.add(e,t)}redo(){this.store.removeAll(this.silent)}};lo._$name="RemoveAllAction";var hy=(i,e,t,r)=>new to({model:i,newData:e,oldData:t,isInitialUserAction:r}),fy=(i,e,t,r)=>new ro({parentModel:i,childModels:t,insertIndex:e,context:r}),gy=(i,e,t)=>new io({parentModel:i,childModels:e,context:t}),my=(i,e,t)=>new no({store:i,modelList:e,silent:t}),py=(i,e,t,r,n)=>new so({store:i,insertIndex:e,modelList:t,context:r,silent:n}),vy=(i,e,t,r)=>new ao({store:i,modelList:e,context:t,silent:r}),yy=(i,e,t)=>new lo({store:i,allRecords:e,silent:t}),we=(i,e,...t)=>{const r=i.state,n=e.call(i[se],i,...t);if(typeof n=="string")i[se]=ht.resolveStmState(n);else if(n instanceof qt)i[se]=n;else if(Array.isArray(n)){const[s,a]=n;typeof s=="string"?i[se]=ht.resolveStmState(s):s instanceof qt?i[se]=s:s&&typeof s=="object"&&(i=Object.assign(i,s),i[se]=ht.resolveStmState(i[se])),typeof a=="function"&&we(i,a,...t)}else n&&typeof n=="object"&&(i=Object.assign(i,n),i[se]=ht.resolveStmState(i[se]));r!==ga&&r!==Ql&&n!==ga&&n!==Ql&&i.trigger("ready")},oo=class extends fe(F){static get defaultConfig(){return{disabled:!0,autoRecord:!1,autoRecordTransactionStopTimeout:100,makeModelUpdateAction:hy,makeModelInsertChildAction:fy,makeModelRemoveChildAction:gy,makeStoreModelAddAction:my,makeStoreModelInsertAction:py,makeStoreModelRemoveAction:vy,makeStoreRemoveAllAction:yy,getTransactionTitle:null}}construct(...i){Object.assign(this,{[se]:ga,[Kt]:[],[Ne]:[],[tt]:0,[ce]:null,[Ze]:null,[rt]:!1,[Nn]:!1,stashedTransactions:{}}),super.construct(...i)}get state(){return this[se]}get position(){return this[tt]}get length(){return this[Ne].length}get stores(){return Array.from(this[Kt])}hasStore(i){return this[Kt].includes(i)}addStore(i){this.hasStore(i)||(this[Kt].push(i),i.stm=this,i.forEach(e=>e.stm=this),i.isTree&&(i.rootNode.stm=this))}removeStore(i){this.hasStore(i)&&(this[Kt]=this[Kt].filter(e=>e!==i),i.stm=null,i.forEach(e=>e.stm=null))}forEachStore(i){this[Kt].forEach(e=>i(e,e.id))}get disabled(){return this.state===sy}set disabled(i){const e=this;e.disabled!==i&&(i?we(e,e.state.onDisable,e):we(e,e.state.onEnable,e),e.trigger("stmDisabled",{disabled:i}),e.trigger("disabled",{disabled:i}))}get enabled(){return!this.disabled}enable(){this.disabled=!1}disable(){this.disabled=!0}get isReady(){return this.state===ga||this.state===Ql}waitForReadiness(){return this.await("ready",!1)}get isRecording(){return this.state===ay||this.state===dy}get isApplyingStash(){return this[Nn]}get autoRecord(){return this[rt]}set autoRecord(i){const e=this;e.autoRecord!=i&&(i?we(e,e.state.onAutoRecordOn,e):we(e,e.state.onAutoRecordOff,e))}startTransaction(i=null){we(this,this.state.onStartTransaction,i)}stopTransaction(i=null){we(this,this.state.onStopTransaction,i)}stopTransactionDelayed(){we(this,this.state.onStopTransactionDelayed)}rejectTransaction(){we(this,this.state.onRejectTransaction)}get transaction(){return this[ce]}get queue(){return this[Ne].map(i=>i.title)}get rawQueue(){return this[Ne]}get isRestoring(){return this.state===oy||this.isApplyingStash}get canUndo(){return this.state.canUndo(this)}get canRedo(){return this.state.canRedo(this)}async undo(i=1){this.isReady||await this.waitForReadiness(),we(this,this.state.onUndo,i)}async undoAll(){this.isReady||await this.waitForReadiness(),this.undo(this.length)}async redo(i=1){this.isReady||await this.waitForReadiness(),we(this,this.state.onRedo,i)}async redoAll(){this.isReady||await this.waitForReadiness(),this.redo(this.length)}resetQueue(i={undo:!0,redo:!0}){we(this,this.state.onResetQueue,i)}resetUndoQueue(){this.resetQueue({undo:!0})}resetRedoQueue(){this.resetQueue({redo:!0})}notifyStoresAboutStateRecordingStart(i){this.forEachStore(e=>{var t;return(t=e.onStmRecordingStart)==null?void 0:t.call(e,this,i)}),this.trigger("recordingStart",{stm:this,transaction:i})}notifyStoresAboutStateRecordingStop(i,e){this.forEachStore(t=>{var r;return(r=t.onStmRecordingStop)==null?void 0:r.call(t,this,i,e)}),this.trigger("recordingStop",{stm:this,transaction:i,reason:e})}notifyStoresAboutStateRestoringStart(){this.forEachStore(i=>{var e;return(e=i.onStmRestoringStart)==null?void 0:e.call(i,this)}),this.trigger("restoringStart",{stm:this})}notifyStoresAboutStateRestoringStop({cause:i,transactions:e}){this.forEachStore(t=>{var r;return(r=t.onStmRestoringStop)==null?void 0:r.call(t,this)}),this.trigger("restoringStop",{stm:this,cause:i,transactions:e})}notifyStoresAboutQueueReset(i){this.forEachStore(e=>{var t;return(t=e.onStmQueueReset)==null?void 0:t.call(e,this,i)}),this.trigger("queueReset",{stm:this,options:i})}onModelUpdate(i,e,t,r){we(this,this.state.onModelUpdate,i,e,t,r)}onModelInsertChild(i,e,t,r){we(this,this.state.onModelInsertChild,i,e,t,r)}onModelRemoveChild(i,e,t){we(this,this.state.onModelRemoveChild,i,e,t)}onStoreModelAdd(i,e,t){we(this,this.state.onStoreModelAdd,i,e,t)}onStoreModelInsert(i,e,t,r,n){we(this,this.state.onStoreModelInsert,i,e,t,r,n)}onStoreModelRemove(i,e,t,r){we(this,this.state.onStoreModelRemove,i,e,t,r)}onStoreRemoveAll(i,e,t){we(this,this.state.onStoreRemoveAll,i,e,t)}onUndoKeyPress(i){const e=this;e.enabled&&(i.shiftKey?e.canRedo&&(i.preventDefault(),e.redo()):e.canUndo&&(i.preventDefault(),e.undo()))}stash(){const i=this;if(this.transaction){const e=On.generateId("_stashedTransactionGeneratedId_");return i.stashedTransactions[e]=i.transaction,i.rejectTransaction(),e}}applyStash(i){const e=this,t=e.stashedTransactions[i];e[Nn]=!0,t&&(e.startTransaction(t.title),t.redo(),delete e.stashedTransactions[i]),e[Nn]=!1}};oo._$name="StateTrackingManager";var uo=class{static insertRule(i,e=document.head){const t=this.getStyleSheet(e),r=t.cssRules.length;if(t.insertRule(i,0),t.cssRules.length>r)return t.cssRules[0]}static findRule(i){let e;const t=typeof i=="function";return Array.prototype.find.call(document.head.querySelectorAll("link[rel=stylesheet],style[type*=css]"),r=>{if(e=Array.prototype.find.call(r.sheet.rules||r.sheet.cssRules,n=>t?i(n):n.selectorText===i),e)return!0}),e}static getStyleSheet(i=document.head){return i.$bryntumStylesheet||(i.$bryntumStylesheet=D.createElement({tag:"style",id:"bryntum-private-styles",type:"text/css",parent:i}).sheet),i.$bryntumStylesheet}static getCSSVersion(){return getComputedStyle(document.documentElement).getPropertyValue("--bryntum-version").replace(/[" ]/gm,"")}};uo._$name="CSSHelper";var yh=Array.prototype.slice,bh=Object.freeze([]),by=Object.freeze({}),Ch=/[&<]/,{getPrototypeOf:Sh}=Object,{toString:Cy}=Object.prototype,{isEqual:wh,isObject:Sy}=x,wy={parent:1,elementData:1,ns:1,syncOptions:1},Dh=()=>({ignore:wy,refsFound:new Set}),Th={class:1,className:1,classname:1},Dy={bigint:1,boolean:1,function:1,number:1,string:1,symbol:1},Ty={tag:1,html:1,text:1,children:1,tooltip:1,parent:1,nextSibling:1,ns:1,reference:1,elementData:1,retainElement:1,compareHtml:1,syncOptions:1,listeners:1,isReleased:1,null:1,"":1,keepChildren:1,retainChildren:1},xy=(i,e)=>{const t="className"in e?"className":"class",r=e[t];if(r)if(typeof r=="string"){const n=r.split(" ");n.includes(i)||(n.push(i),e[t]=n.join(" "))}else Array.isArray(r)?r.includes(i)||r.push(i):r.isDomClassList?r.add(i):x.isObject(r)&&(r[i]=1)},Ey=(i,e)=>{const t="className"in e?"className":"class",r=e[t];if(r)if(typeof r=="string"){const n=r.split(" ");n.includes(i)&&(n.splice(n.indexOf(i),1),e[t]=n.join(" "))}else Array.isArray(r)?r.includes(i)&&r.splice(r.indexOf(i),1):r.isDomClassList?r.remove(i):x.isObject(r)&&delete r[i]},de=class oe{static checkEquality(e,t,r,n){var s;if(e===t)return!0;if(e==null)return t==null;if(!e||!t)return!1;const a=typeof e;if(a!==typeof t||Dy[a])return!1;let o=r.equalityCache||(r.equalityCache=new Map),u=!!n,c,d,h,g,f,m,p;if(o=o.get(e)||o.set(e,new Map).get(e),c=o.get(t),c===void 0){if(c=!0,Sh(e)!==Sh(t)||e instanceof Node)c=!1;else if(Array.isArray(e)){if(d=e.length,d!==t.length)c=!1;else for(;d-- >0;)if(!oe.checkEquality(e[d],t[d],r,u)){c=!1;break}}else{m=e.syncOptions,g=m==null?void 0:m.ignoreRefs,g&&(u=!0,n=g!=="children"),h=r.ignore||by;for(f in t)if(!h[f]&&!(f in e)&&!(n&&f==="reference")){c=!1;break}if(c){if(Cy.call(t)==="[object Date]")c=e.getTime()===t.getTime();else if(D.isReactElement(e)||D.isReactElement(t))c=!1;else for(f in e)if(!h[f]&&!(n&&f==="reference")){if(!(f in t)){c=!1;break}if(p=e[f],!oe.checkEquality(p,t[f],r,u)){c=!1;break}}}}!n&&Sy(e)&&e.reference&&((s=r.refsFound)==null||s.add(e.reference)),o.set(t,c)}return c}static sync(e){var t;const r=e,{refOwner:n}=e,s=n==null?void 0:n.byRef,a=Dh();let l=e.affected,o,u,c,d;if(typeof l=="string"&&(l=[l]),e={...e,checkEqualityOptions:a},n){if(n.byRef={},l)for(u in s)l.includes(u)||(n.byRef[u]=s[u]);e.refsWas=s}if(r.changed=oe.performSync(e,e.targetElement),n)for(l||(l=Object.keys(s)),o=0;o<l.length;++o)u=l[o],c=s[u],a.refsFound.has(u)||c.retainElement?n.byRef[u]=c:(d=c.lastDomConfig,(t=c.blur)==null||t.call(c),c.remove(),n.detachRef(u,c,d));return e.targetElement}static performSync(e,t){const{domConfig:r,callback:n}=e,{lastDomConfig:s}=t;if((e.configEquality||oe.checkEquality)(r,s,e.checkEqualityOptions,e.ignoreRefs))n==null||n({action:"none",domConfig:r,targetElement:t});else return r?(r.onlyChildren||(oe.syncAttributes(r,t,e),oe.syncContent(r,t)),r.keepChildren||oe.syncChildren(e,t)):(t.innerHTML=null,t.syncIdMap=null),t.lastDomConfig=r!=null&&r.onlyChildren&&s?{...s,children:r.children}:r,!0;return!1}static syncDataset(e,t){const{lastDomConfig:r}=t,n=e===r,s=Object.keys(e.dataset),a=r&&r.dataset&&Object.keys(r.dataset),l=z.delta(s,a);let o,u,c,d;for(u=0;u<l.onlyInA.length;u++)o=l.onlyInA[u],d=e.dataset[o],d!=null&&t.setAttribute(`data-${P.hyphenate(o)}`,d);for(u=0;u<l.inBoth.length;u++)o=l.inBoth[u],d=e.dataset[o],(n||d!=r.dataset[o])&&(c=`data-${P.hyphenate(o)}`,d==null?t.removeAttribute(c):t.setAttribute(c,d));for(u=0;u<l.onlyInB.length;u++)t.removeAttribute(`data-${P.hyphenate(l.onlyInB[u])}`)}static addCls(e,t){const{lastDomConfig:r}=t;e=J.normalize(e,"array"),e.forEach(n=>{t.classList.add(n),xy(n,r)})}static removeCls(e,t){const{lastDomConfig:r}=t;e=J.normalize(e,"array"),e.forEach(n=>{t.classList.remove(n),Ey(n,r)})}static syncClassList(e,t,r){let n=e.className||e.class,s=!1,a,l,o,u,c,d;if(r){for(l=J.normalize(t,"array"),n=J.normalize(n,"object"),d=J.normalize(r.className||r.class,"object"),c=[],o=0,u=l.length;o<u;++o)a=l[o],n[a]||!(a in d)?(d[a]=1,c.push(a)):s=!0;for(a in n)d[a]||(c.push(a),s=!0);if(!s)return;n=c.join(" ")}else n=J.normalize(n);t.setAttribute("class",n)}static getSyncAttributes(e){const t={},r=[];return e&&Object.keys(e).forEach(n=>{if(!Ty[n]){const s=n.toLowerCase();t[s]=e[n],r.push(s)}}),{attributes:t,names:r}}static syncAttributes(e,t,r){const{lastDomConfig:n}=t,s=e===n,a=oe.getSyncAttributes(e),{attributes:l,names:o}=a,{attributes:u,names:c}=s?a:oe.getSyncAttributes(n),{onlyInA:d,onlyInB:h,inBoth:g}=s?{onlyInA:bh,onlyInB:bh,inBoth:o}:z.delta(o,c);let f,m;for(m=0;m<d.length;m++){f=d[m];const p=l[f];f==="style"&&p!=null?D.applyStyle(t,p,!0):f==="dataset"?oe.syncDataset(e,t):Th[f]?oe.syncClassList(e,t):p!=null&&t.setAttribute(f,p)}for(m=0;m<h.length;m++)t.removeAttribute(h[m]);for(m=0;m<g.length;m++){f=g[m];const p=l[f],v=u[f];p==null?t.removeAttribute(f):f==="style"?r.strict?s?oe.syncStyles(t,p):wh(p,v,!0)||oe.syncStyles(t,p,v):(s||!wh(p,v,!0))&&D.applyStyle(t,p,!0):f==="dataset"?oe.syncDataset(e,t):Th[f]?oe.syncClassList(e,t,r.strict&&t.lastDomConfig):(s||p!==v)&&t.setAttribute(f,p)}}static syncStyles(e,t,r){let n,s,a;if(!r)n=t;else{if(n={},t=D.parseStyle(t),r=D.parseStyle(r),t)for(s in t)a=t[s],r[s]!==a&&(n[s]=a);for(s in r)s in t||(n[s]="")}D.applyStyle(e,n)}static syncContent(e,t){var r;const{html:n,text:s}=e,a=s!=null?s:n;if(t.didSetTextContent=!1,e.elementData&&(t.elementData=e.elementData),a instanceof DocumentFragment)t.childNodes.length===1&&D.getChildElementCount(t)===0&&a.childNodes.length===1&&D.getChildElementCount(a)===0?D.setInnerText(t,a.firstChild.data):(t.innerHTML="",t.appendChild(a));else if(n!=null&&Ch.test(n))t.innerHTML=String(n);else if(a!=null){const{lastDomConfig:l}=t;(r=l==null?void 0:l.children)!=null&&r.length||l!=null&&l.html&&Ch.test(t.lastDomConfig.html)?t.innerHTML=a:(D.setInnerText(t,String(a)),t.didSetTextContent=!0)}}static insertTextNode(e,t,r,n,s=null){const a=document.createTextNode(e);t.insertBefore(a,s),n&&(a.$refOwnerId=n.id),r==null||r({action:"newNode",domConfig:e,targetElement:a})}static insertElement(e,t,r,n,s,a,l){var o;const u=l.ns?document.createElementNS(l.ns,e.tag||"svg"):document.createElement(e.tag||"div");t.insertBefore(u,r),oe.performSync(l,u),a!=null&&(s[a]=u),!e.role&&!e.tabIndex&&!e["aria-hidden"]&&!D.isFocusable(u,!0)&&!u.htmlFor&&u.setAttribute("role","presentation"),n&&(u.$refOwnerId=n.id,a&&(u.$reference=a,n.attachRef(a,u,e))),(o=l.callback)==null||o.call(l,{action:"newElement",domConfig:e,targetElement:u,syncId:a})}static syncChildren(e,t){var r,n,s,a;let{domConfig:l,syncIdField:o,callback:u,releaseThreshold:c,configEquality:d,ns:h,refOwner:g,refsWas:f,strict:m,checkEqualityOptions:p,ignoreRefs:v}=e,b=null,w,S,C;const T=l.syncOptions||{};if((r=l.html)!=null?r:l.text)return;v=!!((n=T.ignoreRefs)!=null?n:v),v&&(g=f=null),"strict"in T&&(m=T.strict);const E=g?g.byRef:{},I=yh.call(l.children||[]),R=yh.call(t.childNodes),M=f||t.syncIdMap||{},O=t.releasedIdMap||{},A=L=>{for(;R.length&&R[0].parentNode!==t;)R.shift();return(L?R.shift():R[0])||null};o=T.syncIdField||o,m=T.strict||m,u=T.callback||u,d=T.configEquality||d,c="releaseThreshold"in T?T.releaseThreshold:c,o&&(t.syncIdMap=E);const B={checkEqualityOptions:p||Dh(),ignoreRefs:v,refOwner:g,refsWas:f,strict:m,syncIdField:o,releaseThreshold:c,callback:u,configEquality:d};for(;I.length;){const L=I.shift();if(C=null,!L)continue;if(D.isReactElement(L)){u({jsx:L,targetElement:t,domConfig:l});continue}if(Array.isArray(L)){this.syncChildren({...e,domConfig:{...e.domConfig,children:L}},t);continue}if(L instanceof Node){S=A(),L!==S&&t.insertBefore(L,S),w=R.indexOf(L),w>-1&&R.splice(w,1);continue}const Y=typeof L=="string";if(B.domConfig=L,B.ns=L.ns||h,!Y){if(g?C=L.reference:o&&L.dataset&&(C=L.dataset[o]),C!=null&&!L.unmatched){const G=M[C]||O[C];if(G){const{lastDomConfig:he}=G;G.retainElement||oe.performSync(B,G)&&(u==null||u({action:"reuseOwnElement",domConfig:L,targetElement:G,lastDomConfig:he,syncId:C})),L.retainElement&&(G.retainElement=!0),E[C]=G,z.remove(R,G),delete O[C],G.isReleased=!1,S=A(),(G.parentNode!==t||m&&G.nextSibling!==S)&&t.insertBefore(G,S)}else m?oe.insertElement(L,t,A(),g,E,C,B):(I.push(L),L.unmatched=!0);continue}L.unmatched&&delete L.unmatched}let K=null,W=null,Z;for(;!W&&(Z=A(!0));){if(g){if(Z.$refOwnerId!==g.id)continue;if(Z.$reference){if(!m)continue;K=Z;break}W=Z}else Z.retainElement||(W=Z);W||(b||(b=[])).push(Z)}if(K||!W)Y?oe.insertTextNode(L,t,u,g,K):oe.insertElement(L,t,K,g,E,C,B);else if(!Y&&W.nodeType===Node.ELEMENT_NODE&&(L.tag||"div").toLowerCase()===W.tagName.toLowerCase()){const{lastDomConfig:G}=W,he=oe.performSync(B,W);if(o&&((s=G==null?void 0:G.dataset)==null?void 0:s[o])!=null){const ge=G.dataset[o];delete O[ge],delete M[ge]}C!=null&&(E[C]=W),W.isReleased=!1,he&&(u==null||u({action:"reuseElement",domConfig:L,targetElement:W,lastDomConfig:G,syncId:C}))}else Y&&W.nodeType===Node.TEXT_NODE?W.data=L:(Y?oe.insertTextNode(L,t,u,g,W):oe.insertElement(L,t,W,g,E,C,B),(a=W.blur)==null||a.call(W),W.remove())}if(!(t.didSetTextContent&&R.length===1&&R[0].nodeType===Node.TEXT_NODE)&&!l.retainChildren){for(;S=A(!0);)(!g||S.$refOwnerId===g.id&&!S.$reference)&&(b||(b=[])).push(S);b&&oe.syncChildrenCleanup(t,b,E,u,g,c,o)}}static syncChildrenCleanup(e,t,r,n,s,a,l){var o;let u=0,c;for(const d of t){const{lastDomConfig:h}=d;if(d.nodeType===Element.TEXT_NODE){d.remove();continue}d.retainElement?l&&h&&(r[d.dataset[l]]=d):!s&&l&&(a==null||u<a)?(d.isReleased||(d.className="b-released",d.isReleased=!0,h!=null&&h.dataset&&(e.releasedIdMap||(e.releasedIdMap={}),e.releasedIdMap[h.dataset[l]]=d),n==null||n({action:"releaseElement",domConfig:h,lastDomConfig:h,targetElement:d}),h&&(h.isReleased=!0,h.className&&(h.className="b-released"),h.class&&(h.class="b-released"),h.style&&(h.style=null))),u++):((o=d.blur)==null||o.call(d),d.remove(),s&&(c=d.$reference,c&&s.detachRef(c,d,h)),e.releasedIdMap&&l&&(h!=null&&h.dataset)&&delete e.releasedIdMap[h.dataset[l]],n==null||n({action:"removeElement",domConfig:d.lastDomConfig,lastDomConfig:d.lastDomConfig,targetElement:d}))}}static removeChild(e,t){if(e.contains(t)){const r=e.syncIdMap;if(r){const n=Object.values(r).indexOf(t);n>-1&&delete r[Object.keys(r)[n]]}e.removeChild(t)}}static addChild(e,t,r){e.appendChild(t),e.syncIdMap||(e.syncIdMap={}),e.syncIdMap[r]=t}static getChild(e,t){var r;const n=String(t).split(".");for(const s of n)if(e=(r=e==null?void 0:e.syncIdMap)==null?void 0:r[s],!e)return null;return e}};de._$name="DomSync";var ft=class{static init(){const i=["fullscreenEnabled","requestFullscreen","exitFullscreen","fullscreenElement"],e=s=>i.map(a=>{let l=s+P.capitalize(a);return s==="moz"&&(l=l.replace("screen","Screen"),"mozCancelFullScreen"in document&&a==="exitFullscreen"&&(l="mozCancelFullScreen")),l});this.functions="fullscreenEnabled"in document&&i||"webkitFullscreenEnabled"in document&&e("webkit")||"mozFullScreenEnabled"in document&&e("moz")||"msFullscreenEnabled"in document&&e("ms")||[];const t=["fullscreenchange","fullscreenerror"],r=["MSFullscreenChange","MSFullscreenError"],n=s=>t.map(a=>s+P.capitalize(a));this.events="fullscreenEnabled"in document&&t||"webkitFullscreenEnabled"in document&&n("webkit")||"mozFullscreenEnabled"in document&&n("moz")||"msFullscreenEnabled"in document&&r||[],this.onFullscreenChange(this.onInternalFullscreenChange.bind(this))}static get enabled(){return!!(this.functions[0]&&document[this.functions[0]])}static async request(i){return this.functions[1]&&(i==null?void 0:i[this.functions[1]]())}static async exit(){return this.functions[2]&&document[this.functions[2]]()}static get isFullscreen(){return!!this.element}static get element(){return this.functions[3]&&document[this.functions[3]]}static onFullscreenChange(i){this.events[0]&&document.addEventListener(this.events[0],i)}static unFullscreenChange(i){this.events[0]&&document.removeEventListener(this.events[0],i)}static onInternalFullscreenChange(){const i=this,{element:e}=i;if(e){if(!e.closest(".b-floatroot")){const t=D.getRootElement(e),{floatRoot:r}=t;r&&(i._floatRoot=r,i._oldParent=r.parentElement,e.appendChild(r))}}else i._floatRoot&&i._oldParent.appendChild(i._floatRoot),i._oldParent=null,i._floatRoot=null}};ft.init(),ft._$name="Fullscreen";var co=null,ho=[],ky=i=>{var e;return i.nodeType===i.ELEMENT_NODE&&((e=i.ownerDocument.defaultView)==null?void 0:e.getComputedStyle(i).getPropertyValue("position"))==="absolute"},Ee=class mm{static addResizeListener(e,t){const r=this;if((e===document||e===globalThis)&&(e=document.body),e.nodeType===e.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e.classList.contains("b-resize-monitored")||(e.classList.add("b-resize-monitored"),e._bResizemonitor={handlers:[]}),e===document.body)r.hasWindowResizeListener||(globalThis.addEventListener("resize",r.onWindowResize),r.hasWindowResizeListener=!0);else if(globalThis.ResizeObserver)r.resizeObserver||(r.resizeObserver=new ResizeObserver(r.onElementResize)),r.resizeObserver.observe(e);else{e.classList.add("b-no-resizeobserver");const[n,s,a]=D.createElement({parent:e,className:"b-resize-monitors",children:[{className:"b-resize-monitor-expand"},{className:"b-resize-monitor-shrink"}]},{returnAll:!0});s.scrollLeft=s.scrollTop=a.scrollLeft=a.scrollTop=1e6,s.addEventListener("scroll",r.onSizeMonitorScroll,!0),a.addEventListener("scroll",r.onSizeMonitorScroll,!0),(t.targetMutationMonitor=new MutationObserver(l=>{const o=[],u=[];for(const d of l)d.type==="childList"&&(o.push.apply(o,d.addedNodes),u.push.apply(u,d.removedNodes));const c=[...o.filter(d=>!u.includes(d)),...u.filter(d=>!o.includes(d))];c.length!==0&&(c.length>0&&c.every(ky)||s.dispatchEvent(new CustomEvent("scroll",{bubbles:!1})))})).observe(e,{childList:!0,subtree:!0}),t.monitorElement=n}e._bResizemonitor.handlers.push(t)}static removeResizeListener(e,t){if(e){(e===document||e===globalThis)&&(e=document.body);const r=e._bResizemonitor;let n=0;r&&r.handlers&&(z.remove(r.handlers,t),n=r.handlers.length),n||(e.classList.remove("b-resize-monitored"),this.resizeObserver?this.resizeObserver.unobserve(e):(t.monitorElement&&(t.monitorElement.remove(),t.monitorElement=null),t.targetMutationMonitor&&t.targetMutationMonitor.disconnect()))}}static onElementResize(e){for(const t of e){const r=t.target,n=r._bResizemonitor,s=t.contentRect||r.getBoundingClientRect();if(Yt(r)&&(!n.rectangle||s.width!==n.rectangle.width||s.height!==n.rectangle.height)){const a=n.rectangle;n.rectangle=s;for(const l of n.handlers)l(r,a,s)}}}static onSizeMonitorScroll(e){var t;if(e.target.isConnected||(t=document.body)!=null&&t.contains(e.target)){e.stopImmediatePropagation();const r=e.target.parentNode,n=r.parentNode,s=n._bResizemonitor,a=n.getBoundingClientRect();(!s.rectangle||a.width!==s.rectangle.width||a.height!==s.rectangle.height)&&(ho.push([n,s.rectangle,a]),s.rectangle=a,co||(co=requestAnimationFrame(mm.fireResizeEvents))),r.firstChild.scrollLeft=r.firstChild.scrollTop=r.childNodes[1].scrollTop=r.childNodes[1].scrollLeft=1e6}}static onWindowResize(e){const t=document.body,r=t._bResizemonitor,n=r.rectangle;r.rectangle=document.documentElement.getBoundingClientRect();for(const s of r.handlers)s(t,n,r.rectangle)}static fireResizeEvents(){for(const e of ho)for(const t of e[0]._bResizemonitor.handlers)e[0].offsetParent&&t.apply(this,e);co=null,ho.length=0}static removeGlobalListeners(){globalThis.removeEventListener("resize",this.onWindowResize)}};Ee._$name="ResizeMonitor";var xh={auto:"auto",true:"auto",false:"hidden","hidden-scroll":"auto",clip:U.supportsOverflowClip?"clip":"hidden"},Eh="b-widget-scroller",fo={block:"nearest"},kh=Promise.resolve(),Ih=i=>new Promise(e=>$.on({element:i===document.documentElement?globalThis:i,scroll:e,once:!0})),Iy={x:1},ma={auto:1,scroll:1},My={true:1,auto:1},Ry={overflowX:"auto",overflowY:"auto"},_y=i=>{var e,t,r,n;let s,a,l,o;return i?typeof i=="number"?s=a=l=o=i:(s=(e=i.top)!=null?e:0,a=(t=i.bottom)!=null?t:0,l=(r=i.start)!=null?r:0,o=(n=i.end)!=null?n:0):s=a=l=o=0,{top:s,bottom:a,start:l,end:o}},Gt=class Ns extends xe(fe(F)){static get configurable(){return{widget:null,element:{$config:{nullify:!0},value:null},contentElement:{$config:{nullify:!0},value:null},overflowX:null,overflowY:null,translate:null,x:0,y:0,rtlSource:null,propagateSync:null}}static get delayable(){return{onScrollEnd:{type:"buffer",delay:100}}}get isRTL(){var e;return!!((e=this.rtlSource)!=null&&e.rtl)}syncOverflowState(){const e=this,{element:t}=e,{hasOverflowX:r,hasOverflowY:n}=e,s=e.hasOverflowX=t.scrollWidth>t.clientWidth,a=e.hasOverflowY=t.scrollHeight>t.clientHeight;if(r!==s||n!==a){const l=new J(t.classList,{"b-horizontal-overflow":s,"b-vertical-overflow":a});D.syncClassList(t,l),e.isConfiguring||e.trigger("overflowChange",{x:s,y:a})}}hasOverflow(e="y"){const t=this,r=t[`overflow${e.toUpperCase()}`],n=t[`overflow${e==="y"?"x":"y"}`];if(!D.scrollBarWidth||!My[r]||n==="hidden-scroll"){const s=e==="y"?"Height":"Width";return t[`scroll${s}`]>t[`client${s}`]}return t[`hasOverflow${e.toUpperCase()}`]}hasScrollbar(e="y"){const{element:t}=this;if(t&&D.scrollBarWidth){const r=e==="y",n=r?"Width":"Height",s=t[`client${n}`],a=parseInt(D.getStyleValue(t,`border${r?"Left":"Top"}Width`))+parseInt(D.getStyleValue(t,`border${r?"Right":"Bottom"}Width`)),l=t[`offset${n}`]-a-s;return Math.abs(l-D.scrollBarWidth)<2}}addPartner(e,t=Iy){const r=this;typeof t=="string"&&(t={[t]:1}),r.partners||(r.partners={}),r.partners[e.id]={scroller:e,axes:t},t.x&&(e.x=r.x),t.y&&(e.y=r.y),e.isPartneredWith(r)||e.addPartner(r,t)}eachPartner(e){const{partners:t}=this;t&&Object.values(t).forEach(e)}removePartner(e){e&&this.isPartneredWith(e)&&(delete this.partners[e.id],e.removePartner(this))}isPartneredWith(e){var t;return!!((t=this.partners)!=null&&t[e.id])}clearPartners(){this.partners&&Object.values(this.partners).forEach(e=>e.scroller.removePartner(this))}async scrollIntoView(e,t=fo){const r=this,{isRectangle:n}=e,s=n?e:V.from(e),{xDelta:a,yDelta:l}=r.getDeltaTo(e,t),o=r.scrollBy(a,l,t);return(t.highlight||t.focus)&&o.then(()=>{var u,c;e=n?s.translate(-a,-l):(c=(u=t.elementAfterScroll)==null?void 0:u.call(t))!=null?c:e,t.highlight&&(isNaN(t.highlight)?(r.widget||r).callback(t.highlight,null,[e]):D.highlight(e,r)),t.focus&&D.focusWithoutScrolling(e)}),o}static async scrollIntoView(e,t=fo,r=!1){const n=V.from(e),s=typeof t=="object"?t.animate:t,a=Ns._globalScroller||(Ns._globalScroller=new Ns),l=[];a.rtlSource={rtl:r};let o=0,u=0,c;for(let d=e.parentNode;d.nodeType===Node.ELEMENT_NODE;d=d.parentNode){if(d===document.body&&d!==document.scrollingElement)continue;const h=d===document.scrollingElement?Ry:d.ownerDocument.defaultView.getComputedStyle(d);if(t.y!==!1&&ma[h.overflowY]&&d.scrollHeight>d.clientHeight||t.x!==!1&&ma[h.overflowX]&&d.scrollWidth>d.clientWidth){a.element=d,a.positionDirty=!0;const{xDelta:g,yDelta:f}=a.getDeltaTo(n,t);(g||f)&&(l.push({element:d,x:d.scrollLeft,y:d.scrollTop,xDelta:g,yDelta:f}),n.translate(-g,-f),o+=g,u+=f)}}if(l.length){const d=Math.abs(o),h=Math.abs(u);let g=s&&(typeof s=="number"?s:typeof s.duration=="number"?s.duration:300);if(g&&(d>10||h>10))Math.max(d,h)<50&&(g=Math.min(g,500)),c=a.scrollAnimation=ue.animate(g,f=>{const m=f===1;for(const{element:p,x:v,y:b,xDelta:w,yDelta:S}of l)a.element=p,w&&(a.x=Math[r?"min":"max"](v+(m?w:Math.round(w*f)),0)),S&&(a.y=Math.max(b+(m?S:Math.round(S*f)),0))},null,s.easing),c.then(()=>{a.scrollAnimation=null});else{for(const{element:f,xDelta:m,yDelta:p}of l)f.scrollTop+=p,f.scrollLeft+=m;c=Ih(l[l.length-1].element)}}else c=kh;return(t.highlight||t.focus)&&c.then(()=>{t.highlight&&(isNaN(t.highlight)?a.callback(t.highlight,null,[e]):D.highlight(e,a)),t.focus&&e.focus()}),c}scrollBy(e=0,t=0,r=fo){const n=this,s=typeof r=="object"?r.animate:r,a=Math.abs(e),l=Math.abs(t);n.scrollAnimation&&(n.scrollAnimation.cancel(),n.scrollAnimation=null),(e||t)&&(n.silent=r.silent);let o=s&&(typeof s=="number"?s:typeof s.duration=="number"?s.duration:300);if(o&&(a>10||l>10)){const{x:u,y:c}=n;let d=u,h=c;return Math.max(a,l)<50&&(o=Math.min(o,500)),n.scrollAnimation=ue.animate(o,g=>{var f,m;const p=g===1;if(e){if(Math.abs(n.x-d)>1&&!r.force)return(f=n.scrollAnimation)==null?void 0:f.cancel();n.x=Math.max(u+(p?e:Math.round(e*g)),0)}if(t){if(Math.abs(n.y-h)>1&&!r.force)return(m=n.scrollAnimation)==null?void 0:m.cancel();n.y=Math.max(c+(p?t:Math.round(t*g)),0)}d=n.x,h=n.y},n,s.easing),n.element.classList.add("b-scrolling"),n.scrollAnimation.then(()=>{n.isDestroyed||(n.element.classList.remove("b-scrolling"),n.scrollAnimation=null)}),n.scrollAnimation}else{if(e||t){const u=n.x,c=n.y;if(Math.round(a)>=1&&(n.x+=e),Math.round(l)>=1&&(n.y+=t),n.x!==u||n.y!==c)return Ih(n.element)}return kh}}async scrollTo(e,t,r){const{x:n,y:s}=this,a=e==null?0:e-n,l=t==null?0:t-s;return this.scrollingToCenter=r==null?void 0:r.scrollingToCenter,this.scrollBy(a,l,r)}doDestroy(){var e,t;const r=this;r._element&&(r._element.removeEventListener("scroll",r.scrollHandler),(e=r.wheelListenerRemover)==null||e.call(r)),(t=r.scrollAnimation)==null||t.cancel(),Object.values(r.partners||{}).forEach(({scroller:n})=>n.removePartner(r)),super.doDestroy()}onElMutation(e){const t=this,[r,n]=D.getTranslateXY(t.element);if(t._x!==-r||t.y!==-n){const s=new CustomEvent("scroll",{bubbles:!0});Object.defineProperty(s,"target",{get:()=>t.element}),t.onScroll(s)}}onElResize(){const e=this,{widget:t}=e;t!=null&&t.isAnimating?t.findListener("animationend","onElResize",e)===-1&&t.ion({animationEnd:"onElResize",thisObj:e,once:!0}):e.syncOverflowState()}onScroll(e){const t=this,{_x:r,_y:n,element:s}=t;let a=0;t.overflowX==="clip"&&s.scrollLeft!==r&&(s.scrollLeft=r,++a),t.overflowY==="clip"&&s.scrollTop!==n&&(s.scrollTop=n,++a),a!==2&&(!t.widget||!t.widget.isDestroyed)&&(t.positionDirty=!0,s.classList.contains("b-scrolling")||s.classList.add("b-scrolling"),e.widget=t.widget,e.scrollingToCenter=t.scrollingToCenter,t.silent||t.trigger("scroll",e),t.syncPartners(),t.controllingPartner=null,t.onScrollEnd(e))}syncPartners(e,t=this.propagateSync){const r=this;r.partners&&Object.values(r.partners).forEach(({axes:n,scroller:s})=>{(s!==r.controllingPartner||e)&&s.sync(r,n)&&t&&s.syncPartners(e,t)})}onScrollEnd(e){const t=this;t.silent&&(t.silent=!1),t.trigger("scrollEnd",e),t.scrollingToCenter=!1,t.controllingPartner=null,t.element.classList.remove("b-scrolling")}getDeltaTo(e,t){const r=this;if(!r.viewport)return{xDelta:0,yDelta:0};const{x:n,y:s,scrollWidth:a,scrollHeight:l,isRTL:o}=r,u=e instanceof V?e:V.from(e),c=t.block||"nearest",d=r.viewport,h=_y(t.edgeOffset),g=d.width>=u.width+(h.start+h.end)?h:{start:0,end:0},f=d.height>=u.height+(h.top+h.bottom)?h:{top:0,bottom:0},m=new V(o?d.right- -n-a:d.x-n,d.y-s,a,l),p=u.clone().adjust(-g.start,-f.top,g.end,f.bottom).constrainTo(m),v=p.clone(),b=r.isRTL?-1:1;let w=0,S=0;if(c==="start")v.moveTo(d.x+(r.isRTL?d.width-v.width:0),d.y),w=p.x-v.x,S=p.y-v.y;else if(c==="end")v.moveTo(d.x+(r.isRTL?0:d.width-v.width),d.bottom-v.height),w=p.x-v.x,S=p.y-v.y;else if(c==="center"){const C=d.center;v.moveTo(C.x-v.width/2,C.y-v.height/2),w=w||p.x-v.x,S=S||p.y-v.y}else v.width>d.width?w=v.x-d.x:v.right>d.right?w=v.right-d.right:v.x<d.x&&(w=v.x-d.x),v.height>d.height?S=v.y-d.y:v.bottom>d.bottom?S=v.bottom-d.bottom:v.y<d.y&&(S=v.y-d.y);return w=b*Math.round(w),S=Math.round(S),t.constrainToScrollable!==!1&&(w=Math.max(Math.min(w,r.maxX-n),-n),S=Math.max(Math.min(S,r.maxY-s),-s)),{xDelta:t.x===!1?0:w,yDelta:t.y===!1?0:S}}get viewport(){return V.client(this.element)}updateWidget(e){this.rtlSource=this.owner=e}updateElement(e,t){var r;const n=this;if(n===Ns._globalScroller){n._element=e,n.positionDirty=!0;return}const s=n.scrollHandler||(n.scrollHandler=n.onScroll.bind(n)),a=n.resizeHandler||(n.resizeHandler=n.onElResize.bind(n));if(t&&(n.translate?(r=n.mutationObserver)==null||r.disconnect():(t.removeEventListener("scroll",s),t.classList.remove(Eh),t.style.overflowX=t.style.overflowY=""),Ee.removeResizeListener(t,a)),e){if(n.translate){if(n.mutationObserver||(n.mutationObserver=new MutationObserver(n.mutationHandler||(n.mutationHandler=n.onElMutation.bind(n)))),n._x=n._y=0,document.contains(e)){const[l,o]=D.getTranslateXY(e);n._x=-l,n._y=-o}n.mutationObserver.observe(e,{attributes:!0})}else e.addEventListener("scroll",s),e.classList.add(Eh);Ee.addResizeListener(e,a),n.widget||(n.rtlSource={get rtl(){return D.getStyleValue(e,"direction")==="rtl"}}),n.isRTL&&e.classList.add("b-rtl"),n.positionDirty&&(n.updateOverflowX(n.overflowX),n.updateOverflowY(n.overflowY)),n.syncOverflowState(),n.isConfiguring&&(n._x&&n.updateX(n._x),n._y&&n.updateY(n._y))}n.positionDirty=!0}get x(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[r,n]=D.getTranslateXY(t);e._x=-r,e._y=-n}else e._x=Math.abs(t.scrollLeft),e._y=t.scrollTop;e.positionDirty=!1}return e._x}get scrollLeft(){return this.x*(this.isRTL?-1:1)}changeX(e){if(e=Math.max(e,0),!this.isConfiguring||e)return e;this._x=e}updateContentElement(e){e&&(e=typeof e=="string"?this.element.querySelector(e):e,Ee.addResizeListener(e,this.resizeHandler))}updateX(e){var t;const r=this,{element:n}=r;n&&!((t=r.widget)!=null&&t.isConfiguring)&&(e=Math.round(e),r.trigger("scrollStart",{x:e}),r.translate?D.setTranslateX(n,-e):n.scrollLeft=r.isRTL?-e:e),r.positionDirty=!0}sync(e,t){const r=this,{x:n,y:s}=t;let a=!1;return n!=null&&r.x!==e.x&&(r.controllingPartner=e,r.x=e.x,a=!0),s!=null&&r.y!==e.y&&(r.controllingPartner=e,r.y=e.y,a=!0),a}get y(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[r,n]=D.getTranslateXY(t);e._x=-r,e._y=-n}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._y}changeY(e){if(!this.isConfiguring||e)return e;this._y=e}updateY(e){const{element:t,widget:r}=this;t&&!(r!=null&&r.isConfiguring)&&(this.trigger("scrollStart",{y:e}),this.translate?D.setTranslateY(t,-e):t.scrollTop=e),this.positionDirty=!0}get maxX(){return this.scrollWidth-this.clientWidth}get maxY(){return this.scrollHeight-this.clientHeight}get lastScrollLeft(){return(this.scrollWidth-this.clientWidth)*(this.isRTL?-1:1)}updateOverflowX(e,t){const r=this,{element:n,translate:s}=r,{style:a,classList:l}=n;t==="hidden-scroll"&&l.remove("b-hide-scroll"),e==="hidden-scroll"&&!s&&(ma[a.overflowY]?(e="hidden",r.enableWheel()):l.add("b-hide-scroll")),s||(a.overflowX=xh[e]||e),r.isConfiguring||(r.positionDirty=!0,r.syncOverflowState())}updateOverflowY(e,t){const r=this,{element:n,translate:s}=r,{style:a,classList:l}=n;t==="hidden-scroll"&&l.remove("b-hide-scroll"),e==="hidden-scroll"&&!s&&(ma[a.overflowX]?(e="hidden",r.enableWheel()):l.add("b-hide-scroll")),s||(a.overflowY=xh[e]||e),r.isConfiguring||(r.positionDirty=!0,r.syncOverflowState())}enableWheel(){this.wheelListenerRemover||(this.wheelListenerRemover=$.on({element:this.element,wheel:"onWheel",thisObj:this}))}onWheel(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)&&this.overflowX==="hidden-scroll"?this.x+=e.deltaX:this.overflowY==="hidden-scroll"&&(this.y+=e.deltaY)}get scrollWidth(){var e,t;return(t=(e=this.element)==null?void 0:e.scrollWidth)!=null?t:0}set scrollWidth(e){const t=this,{element:r,isRTL:n}=t;let s=t.widthStretcher;s&&e==null?(s.remove(),t.widthStretcher=null):e&&(e=Math.abs(e),s||(s=t.widthStretcher=D.createElement({className:"b-scroller-stretcher b-horizontal-stretcher",retainElement:!0})),s.style.transform=`translateX(${(e-1)*(n?-1:1)}px)`,r&&!r.contains(s)&&r.insertBefore(s,r.firstElementChild)),t.propagate!==!1&&t.eachPartner(({scroller:a})=>{a.propagate=!1,a.scrollWidth=e,delete a.propagate}),t.positionDirty=!0,t.syncOverflowState()}get scrollHeight(){var e,t;return(t=(e=this.element)==null?void 0:e.scrollHeight)!=null?t:0}set scrollHeight(e){const t=this,r=t.stretcher||(t.stretcher=D.createElement({className:"b-scroller-stretcher"}));r.style.transform=`translateY(${e-1}px)`,t.element&&t.element.lastChild!==r&&t.element.appendChild(r),t.positionDirty=!0,t.syncOverflowState()}get clientWidth(){var e;return((e=this.element)==null?void 0:e.clientWidth)||0}get clientHeight(){var e;return((e=this.element)==null?void 0:e.clientHeight)||0}get id(){return this._id||(this.widget?this._id=`${this.widget.id}-scroller`:this._id=On.generateId("scroller-")),this._id}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(),delete e.widget,delete e.element}};Gt._$name="Scroller";var pa=class{constructor(i){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),i&&i(this)}};pa._$name="Promissory";var{defineProperty:go}=Reflect,Bn=class Hu extends F.mixin(bn,fe,xe,ai){static get configurable(){return{element:null}}static get delayable(){return{refreshDom:"raf"}}static get identifiable(){return{}}static get renderConfigs(){const e=this,t=e.$meta;let r=t.renderConfigs,n,s;if(r===void 0){r=null,n=t.configs;for(s in n)n[s].render&&(r||(r=new Set)).add(s);t.renderConfigs=e.prototype.$renderConfigs=r}return r}construct(...e){this.$iid=++Hu.$idSeed,this.byRef={},super.construct(...e),this.onDraw!==Hu.prototype.onDraw&&this.initDrawable()}startConfigure(e){this.element=this.renderContext.renderDom(),super.startConfigure(e)}get element(){return this.refreshDom.flush(),this._element}changeElement(e,t){const r=this;return t&&t.remove(),e&&(e.id=r.id,e=D.createElement(e,{refOwner:r})),e}updateId(e,t){const r=this;if(t){const n=r.element;n.id=e,r.fixRefOwnerId(n,e,t)}}get classes(){return this.element.classList}fixRefOwnerId(e,t,r){if(e.$refOwnerId===r){e.$refOwnerId=t;const n=e.$reference;n&&(e.id=`${t}-${n}`);for(const s of e.childNodes)this.fixRefOwnerId(s,t,r)}}onConfigChange({name:e}){!this.isConfiguring&&this.$renderConfigs.has(e)&&this.refreshDom()}attachRef(e,t,r){const n=this,s="_"+e,{listeners:a}=r;s in n||go(n,e,{get(){return n.refreshDom.flush(),n[s]},set(l){n[s]=l}}),t.id=`${n.id}-${e}`,n.byRef[e]=t,n[e]=t,a&&(r.listeners={on:a,un:$.on(Object.assign({element:t,thisObj:n},a))})}detachRef(e,t,r){r.listeners&&(r.listeners.un(),r.listeners=null),this[e]=null,delete this.byRef[e]}renderDom(){return{}}get renderContext(){const e=this,t=e.$meta,r=e.constructor;let n=t.renderConfigs||r.renderConfigs,s=e;if(!n){s=Object.create(e),n=new Set;for(const a in t.configs)go(s,a,{get(){return n.add(a),e[a]}});s.renderDom=()=>e.renderDom.call(s),e.$renderConfigs=n}return go(e,"renderContext",{value:s}),s}refreshDom(){de.sync({targetElement:this.element,domConfig:this.renderContext.renderDom(),refOwner:this,strict:!0})}onListen(e){e==="draw"&&this.initDrawable()}initDrawable(){const e=this;if(!e.intersector){let t=Object.values(e.byRef).find(r=>r.classList.contains("b-drawable"));t||(t=e.element,t.classList.add("b-drawable")),e.intersector=new IntersectionObserver(r=>{e.isDestroyed||r.forEach(n=>{n.isIntersecting&&e.onDraw({count:++e.drawCounter})})}),e.intersector.observe(t)}}onDraw(e){this.trigger("draw",e)}};Bn.$idSeed=0,Object.assign(Bn.prototype,{drawCounter:0,hasGeneratedId:!1,intersector:null}),Bn._$name="Renderable";var Tr=class Bs extends Bn{construct(e){if(e){let n=e.element,s;n&&(ie.deprecate("Core","4.0.0",'Mask "element" config has been renamed to "target"'),e=s=Object.assign({},e),delete s.element,s.target=n),n=e.target,typeof n=="string"&&(e=s=s||Object.assign({},e),s.target=e.owner[n])}super.construct(e);const t=this,{type:r}=t;t.target||(t.target=document.body),t.maskName=`mask${typeof r=="string"?r.trim():""}-${Bs.counter++}`,t.show()}doDestroy(){const e=this,{element:t}=e;if(e.type==="trial")return!1;t&&(e.element=null,e.mode.endsWith("blur")&&D.forEachChild(t,r=>{r.classList.remove(`b-masked-${e.mode}`)}),e.target.classList.remove("b-masked"),e.target[e.maskName]=null,z.remove(Bs.masks,e)),super.doDestroy()}get maskElement(){return this.element}set error(e){this.setConfig(this.errorDefaults),this.text=e}renderDom(){const e=this,{maxProgress:t}=e;return{class:{"b-mask":1,"b-delayed-show":e.showDelay,"b-widget":1,[`b-mask-${e.mode}`]:1,"b-progress":t,"b-prevent-transitions":!e.useTransition},children:[{reference:"maskContent",class:"b-mask-content b-drawable",children:[t?{reference:"progressElement",class:"b-mask-progress-bar",style:{width:`${Math.max(0,Math.min(100,Math.round(e.progress/t*100)))}%`}}:null,{reference:"maskText",class:"b-mask-text",html:(e.icon?`<i class="b-mask-icon ${e.icon}"></i>`:"")+e.text}]}]}}static mergeConfigs(...e){const t={};for(const r of e)typeof r=="string"?t.text=r:x.assign(t,r);return t}static mask(e,t=document.body){return Bs.new({target:t},typeof e!="string"?{...e}:{text:e})}static unmask(e=document.body){const t=this.getElementMasks(e);return t.length>0?t[t.length-1].close():null}static unmaskAll(e=document.body){return this.getElementMasks(e).forEach(t=>t.close())}static getElementMasks(e){return this.masks.filter(t=>t.target===e)}updateAutoClose(e){this.deferredClose.cancel(),e&&(this.deferredClose.delay=e,this.deferredClose())}updateCover(){this.syncCover()}syncCover(){var e,t;(t=(e=this.owner)==null?void 0:e.syncMaskCover)==null||t.call(e,this)}onOwnerResize(){this.syncCover()}updateOwner(e){this.detachListeners("cover"),e==null||e.ion({name:"cover",recompose:"onOwnerResize",resize:"onOwnerResize",thisObj:this})}updateShowDelay(e){const{delayedShow:t}=this;t.delay=e,e||t.flush()}deferredClose(){var e;const{owner:t}=this;this.close().then(()=>{var r;(r=t==null?void 0:t.onMaskAutoClose)==null||r.call(t,this)}),(e=t==null?void 0:t.onMaskAutoClosing)==null||e.call(t,this)}delayedShow(){this.classes.remove("b-delayed-show")}show(){const e=this,{element:t,target:r,hiding:n,maskName:s}=e;n&&(n.resolve(),e.hiding=null,e.clearTimeout("hide")),e.showDelay&&(t.classList.add("b-delayed-show"),e.delayedShow()),t.classList.add("b-visible"),t.classList.remove("b-hidden"),r.classList.add("b-masked"),r[s]||(r[s]=e,r.appendChild(t)),z.include(Bs.masks,e),e.shown=!0,e.trigger("show"),e.mode.endsWith("blur")&&D.forEachChild(r,a=>{a!==t&&a.classList.add(`b-masked-${e.mode}`)})}hide(){const e=this,{target:t,element:r}=e;let{hiding:n}=e;if(!n){if(!e.shown)return Promise.resolve();e.hiding=n=new pa,e.shown=!1,r.classList.remove("b-visible"),r.classList.add("b-hidden"),t.classList.remove("b-masked"),e.mode.endsWith("blur")&&D.forEachChild(t,s=>{s!==r&&s.classList.remove(`b-masked-${e.mode}`)}),n.promise=n.promise.then(()=>{e.hiding===n&&(e.hiding=null)}),e.setTimeout(()=>n.resolve(),500,"hide")}return n.promise}async close(){await this.hide(),this.destroy()}};y(Tr,"$name","Mask"),y(Tr,"type","mask"),y(Tr,"configurable",{autoClose:null,cover:null,icon:"b-icon b-icon-spinner",errorDefaults:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},maxProgress:null,mode:"dark",progress:null,owner:{$config:"nullify",value:null},target:null,text:null,type:null,showDelay:null,useTransition:!1}),y(Tr,"delayable",{deferredClose:0,delayedShow:0,syncCover:{type:"throttle",delay:100}}),y(Tr,"counter",0),y(Tr,"masks",[]);var xr=Tr;xr._$name="Mask";var Mh=i=>{var e;return e=class extends(i||F){get widgetClass(){}get keyMapElement(){return this.element}get keyMapSubComponents(){return this.features}matchKeyMapEntry(t,r=this.keyMap){if(r&&!t.handled&&t.key!==void 0)return x.keys(r).find(n=>{const s=n.split("+"),a=s.includes("Alt"),l=s.includes("Shift"),o=s.includes("Ctrl");let u=s[s.length-1].toLowerCase();return u==="space"&&(u=" "),u===t.key.toLowerCase()&&(!t.altKey&&!a||t.altKey&&a)&&(!t.ctrlKey&&!o||t.ctrlKey&&o)&&(!t.shiftKey&&!l||t.shiftKey&&l)})}performKeyMapAction(t){var r;const{keyMap:n}=this;let s=!1;if(n&&!t.handled&&t.key!==void 0){const a=this.matchKeyMapEntry(t);if(n[a]){const l=z.asArray(n[a]);t.fromKeyMap=!0;let o;for(let u of l){if(o=!0,x.isObject(u)){if(!u.handler)continue;u.preventDefault===!1&&(o=!1),u=u.handler}if(typeof u=="string"){const{thisObj:c,handler:d}=this.resolveKeyMapAction(u);if(((r=c.isActionAvailable)==null?void 0:r.call(c,{key:a,action:u,event:t,actionName:u.split(".").pop()}))!==!1&&d.call(c,t)!==!1){s=!0;break}}else if(u.call(this)!==!1){s=!0;break}}delete t.fromKeyMap,s&&(o&&t.preventDefault(),t.handled=!0)}}return s}resolveKeyMapAction(t){const{keyMapSubComponents:r}=this;if(t.startsWith("up.")||t.startsWith("this."))return this.resolveCallback(t);if(r&&t.includes(".")){const[n,s]=t.split(".");if(n&&s)return{thisObj:r[n],handler:r[n][s]}}return{thisObj:this,handler:this[t]}}updateKeyMap(t){var r;(r=this.keyMapDetacher)==null||r.call(this),x.isEmpty(t)||(this.keyMapDetacher=$.on({element:this.keyMapElement,keydown:"keyMapOnKeyDown",thisObj:this}))}keyMapOnKeyDown(t){this.performKeyMapAction(t)}mergeKeyMaps(t,r,n=null){const s={};t&&x.assign(s,t);for(const a in r){if(!r[a])continue;const l=z.asArray(t==null?void 0:t[a]),o=[];if(l!=null&&l.length&&o.push(...l),!(l!=null&&l.some(u=>{const c=u.handler?u.handler:u;return typeof c=="string"&&c.startsWith(n+".")}))){for(const u of z.asArray(r[a]))x.isObject(u)&&u.handler?o.push(x.assignIf({handler:(n?n+".":"")+u.handler},u)):typeof u=="function"?o.push(u):o.push((n?n+".":"")+u);o.sort((u,c)=>{const d=(u.weight||0)-(c.weight||0);return d===0&&(l!=null&&l.length)?l.indexOf(u)-l.indexOf(c):d})}s[a]=o}return s}},y(e,"$name","KeyMap"),y(e,"configurable",{keyMap:{value:null,$config:{merge:"objects",nullify:!0}}}),e},Rh=i=>{var e;return e=class extends(i||F){get widgetClass(){}get isRTL(){return this.rtl}updateRtl(t){const{element:r}=this;r&&(r.classList.toggle("b-rtl",t===!0),r.classList.toggle("b-ltr",t===!1))}startConfigure(t){var r,n;if((r=super.startConfigure)==null||r.call(this,arguments),!t.floating&&t.rtl==null){const s=this,a=t.rootElement||t.forElement||((n=s.parent)==null?void 0:n.contentElement)||(s.floating?s.floatRoot:s.changeElementRef(s.getRenderContext(t)[0]||t.adopt||document.body)),l=t.owner||t.parent||s.constructor.fromElement(a);l?t.rtl=l[l.isConfiguring?"peekConfig":"getConfig"]("rtl"):t.rtl=(a==null?void 0:a.nodeType)===1&&getComputedStyle(a).getPropertyValue("direction")==="rtl",t.rtl&&(s.configDone.rtl=!1)}}render(...t){var r,n;super.render&&super.render(...t),(U.isChrome&&U.chromeVersion<87||U.isFirefox&&U.firefoxVersion<66||U.isSafari&&U.safariVersion<14.1)&&this.element.classList.add("b-legacy-inset"),(getComputedStyle(this.element).direction==="rtl"||(r=this.owner)!=null&&r.rtl)&&(this.rtl=!0,(n=this.childItems)==null||n.forEach(s=>s.rtl=!0))}},y(e,"$name","RTL"),y(e,"configurable",{rtl:null}),e},_h=Object.freeze({highlight:!1,onlyName:!1}),Vn=[],mo="highlightExternalChange",po=/transparent|rgba\(0,\s*0,\s*0,\s*0\)/,va=Symbol("renderConfigObserver"),Oy={INPUT:1,TEXTAREA:1},vo=(i,e,t,r)=>{let n=(t==null?void 0:t.listeners)||(t==null?void 0:t.internalListeners);if(n=(n==null?void 0:n.on)||n,n){const s=$.on(x.assign({element:e,thisObj:i},n));r?(i._refListeners||(i._refListeners=Object.create(null)))[r]=s:t.listeners={on:n,un:s}}},Oh=(i,e)=>i&&e&&e[x.keys(i)[0]]?me.merge(i,e):i,Ay=i=>{i.isVisible&&i.triggerPaint()},Py=/^:not\((.+)\)$/,Fy=/absolute|fixed/i,Ly=i=>i.scale!=null,{hasOwn:Er}=x,{defineProperty:Ah}=Reflect,Ph=i=>parseFloat(i)*(i.endsWith("ms")?1:1e3),Fh=["b-aligned-above","b-aligned-right","b-aligned-below","b-aligned-left"],$y={configurable:!0,get(){return!1}},ya=/(?:L\{([^}.]+)\})/,Ny=(i,e)=>"L{Tooltip."+e+"}",Lh=/^([trblc])(\d*)-([trblc])(\d*)$/i,By=(i,e)=>(Lh.test(i)&&(i={align:i}),Lh.test(e)&&(e={align:e}),me.merge(i,e)),Vy=/^[\w.]+$/,$h={1:"maxHeight",2:"height",4:"maxWidth",8:"width"},jy=i=>!i.isRipple&&!i.closest(e=>e.isMessageDialog||e.isSharedTooltip),j=class X extends F.mixin(bn,fe,xe,ai,Et,Mh,Rh){static mergeCls(e,t){return t&&e?e=new J(t).assign(typeof e=="string"?new J(e):e):e&&!e.isDomClassList&&(e=new J(e)),e}static get $name(){return"Widget"}static get type(){return"widget"}static get configurable(){return{element:!0,callOnFunctions:!0,id:"",html:null,content:null,cls:{$config:{merge:"classList"},value:null},ui:{$config:{merge:"classList"},value:null},collapsify:null,contentElementCls:{$config:{merge:"classList"},value:null},defaultCls:{$config:{merge:"classList"},value:null},dock:null,forwardTwinEvents:{$config:{merge:"classList"},value:null},parent:null,tab:null,elementAttributes:null,htmlCls:{$config:{merge:"classList"},value:{"b-html":1}},style:null,disabled:null,readOnly:{value:null,default:!1,$config:null},ignoreParentReadOnly:null,adopt:null,appendTo:null,insertBefore:null,insertFirst:null,dataset:null,tooltip:{$config:["lazy","nullify"],value:null},showTooltipWhenDisabled:!0,preventTooltipOnTouch:null,monitorResize:{$config:["lazy","nullify"],value:null},masked:{$config:"nullify",value:null},maskDefaults:{target:"element"},cache:{},floating:null,positioned:null,draggable:null,align:{$config:{merge:By},value:"t-b"},centered:null,constrainTo:void 0,anchor:null,owner:null,scrollAction:null,hideAnimation:{$config:{merge:Oh},value:null},showAnimation:{$config:{merge:Oh},value:null},x:null,y:null,scrollable:{$config:["lazy","nullify"],value:null},scrollerClass:Gt,defaultBindProperty:"html",defaultAction:null,overflowable:{value:null,default:!0,$config:null},width:null,height:null,maxHeight:null,maxWidth:null,minWidth:null,minHeight:null,scaleToFitWidth:null,allowGrowWidth:!0,margin:null,flex:null,weight:null,alignSelf:null,ripple:null,title:null,localizableProperties:["title","ariaLabel","ariaDescription"],requireSize:!1,ref:null,hidden:null,textAlign:null,ignoreScrollDuration:500,tag:"div",recomposeAsync:null,rootElement:null,htmlMutationObserver:{$config:["lazy","nullify"],value:{childList:!0,subtree:!0}},role:{$config:"lazy",value:"presentation"},ariaLabel:{$config:"lazy",value:null},ariaDescription:{$config:"lazy",value:null},ariaElement:"element",ariaHasPopup:null,realignTimeout:300,testConfig:{ignoreScrollDuration:100,realignTimeout:50},maximizeOnMobile:null}}static get prototypeProperties(){return{hasGeneratedId:!1,innerItem:!0}}static get declarable(){return["renderConfigs"]}static get delayable(){return{recompose:"raf",doHideOrRealign:"raf",onAlignConstraintChange:"raf"}}static get factoryable(){return{defaultType:"widget"}}static get identifiable(){return{}}static get all(){return super.all}static get recomposeAsync(){return X._recomposeAsync}static set recomposeAsync(e){if(X._recomposeAsync=e,e!=null){const{all:t}=X;for(let r=0;r<t.length;++r)t[r].isComposable&&(t[r].recomposeAsync=e)}}isType(e,t){return X.isType(this,e,t)}static setupRenderConfigs(e,t){const r=t.getInherited("renderConfigs"),{renderConfigs:n}=e;if(n){if(Array.isArray(n))for(const s of n)r[s]=!0;else x.assign(r,n);r[va]=null}}construct(e={},...t){const r=this,{domSyncCallback:n}=r;if(!globalThis.bryntum.cssVersion){const a=globalThis.bryntum.cssVersion=uo.getCSSVersion(),l=ie.getVersion("core");a&&a!==l&&console.warn(`CSS version ${a} doesn't match bundle version ${l}!
Make sure you have imported css from the appropriate product version.`)}r.configureAriaDescription=e.ariaDescription,r._isAnimatingCounter=0,r.alignmentChanges=0,r.byRef=Object.create(null),r.onTargetResize=r.onTargetResize.bind(r),r.onFullscreenChange=r.onFullscreenChange.bind(r),r.domSyncCallback=n.$nullFn?null:n.bind(r),r._isUserAction=!1,super.construct(e,...t);const{recomposeAsync:s}=X;s!=null&&r.recomposeAsync==null&&(r.recomposeAsync=s),r.finalizeInit()}startConfigure(e){super.startConfigure(e);const t=this,{adopt:r,element:n}=t;r&&(t.adoptElement(n,r,e.id),t.updateElement(t._element,n))}finalizeInit(){var e;const t=this,r=t.insertBefore||t.appendTo||t.insertFirst||t.adopt;r&&(t.owner||(e=r.nodeType?r:document.getElementById(r))!=null&&e.isConnected?t.render():(t.onFirstResizeAfterConnect=t.onFirstResizeAfterConnect.bind(t),Ee.addResizeListener(r,t.onFirstResizeAfterConnect)))}onFirstResizeAfterConnect(e){Ee.removeResizeListener(e,this.onFirstResizeAfterConnect),!this.isDestroyed&&!this.rendered&&this.render()}doDestroy(){var e,t,r,n;const s=this,{preExistingElements:a,element:l,adopt:o,_refListeners:u,_rootElement:c,eventRoot:d}=s;if(ft.element===l&&ft.exit(),u&&(Object.values(u,h=>h()),s._refListeners=null),l){const h=!s._tooltip&&c&&((e=X.Tooltip)==null?void 0:e.getSharedTooltip(c,d,!0));if((h==null?void 0:h.owner)===s&&(h.owner=null,h.hide()),s.onExitFullscreen(),s.clearTimeout(s.scrollListenerTimeout),s.clearTimeout(s.resizeListenerTimeout),s.removeTransientListeners(),s.floating||s.positioned?s.hide(!1):s.revertFocus(),Ee.removeResizeListener(l.parentElement,s.onParentElementResize),Ee.removeResizeListener(l,s.onElementResize),o){for(let g=Array.from(l.childNodes),f=0,{length:m}=g;f<m;f++){const p=g[f];!a.includes(p)&&p!==s.floatRoot&&p.remove()}l.className=s.adoptedElementClassName,l.style.cssText=s.adoptedElementCssText}(t=s.dragEventDetacher)==null||t.call(s),(r=s.dragOverEventDetacher)==null||r.call(s),s.dragGhost.remove()}(n=s.connectedObserver)==null||n.disconnect(),super.doDestroy(),d&&!Object.values(X.identifiable.idMap).some(jy)&&Me.detachFocusListeners(d),o||l.remove()}get assignValueDefaults(){return _h}get valueName(){return this.name||this.ref||this.id}getValueName(e){return e=e&&typeof e=="object"?e.onlyName:e,e?this.name:this.valueName}assignFieldValue(e,t,r){const n=this,s=n.defaultBindProperty;s in n&&(n[s]=r)}assignValue(e,t=_h){const r=this,n=r[mo],s=r.getValueName(t);s&&(!e||s in e)&&(t.highlight===!1&&(r[mo]=!1),r.assignFieldValue(e,s,e?e[s]:null),r[mo]=n)}gatherValue(e){const t=this,r=t.defaultBindProperty;t.constructor!==X&&r in t&&(e[t.name||t.ref||t.id]=t[r])}gatherValues(e){this.eachWidget(t=>t.gatherValue(e),!1)}get forwardTwinEvents(){const e=this._forwardTwinEvents;return e&&x.getTruthyKeys(e)}configureOverflowTwin(e){var t;const r=this;let n=x.clone(r.initialConfig);return delete n.id,n.hidden=!1,n.type=r.type,n._overflowTwinOrigin=r,n.disabled=r.disabled,"value"in r&&(n.value=r.value),(t=r.forwardTwinEvents)==null||t.forEach(s=>{delete n[`on${P.capitalize(s)}`]}),e&&(n=typeof e=="function"?e(n)||n:x.assign(n,e)),n}createOverflowTwin(e){var t;const r=this,n=r.configureOverflowTwin(e),s=X.create(n);return(t=r.forwardTwinEvents)==null||t.forEach(a=>{s.ion({[a]:l=>{r.overflowTwin===l.source&&(l=x.assign({},l),delete l.source,r.trigger(l.eventName,l))}})}),s}ensureOverflowTwin(e,t){let{overflowTwin:r}=this;return r||(this.overflowTwin=r=this.createOverflowTwin(e),t==null||t(r)),r}get isComposable(){return!this.compose.$nullFn}adoptElement(e,t,r){var n;const s=this,a=typeof t=="string"?document.getElementById(t):t,l=X.fromElement(a);l&&l.adopt&&l!==s&&(typeof l.adopt=="string"?document.getElementById(l.adopt):l.adopt)===a&&l.destroy(),s.preExistingElements=Array.from(a.childNodes),s.adoptedElementClassName=a.className,s.adoptedElementCssText=a.style.cssText,a.id&&!r&&(s.id=e.id=a.id),D.syncAttributes(e,a);for(let c=0,{length:d}=e.childNodes;c<d;c++)a.appendChild(e.childNodes[0]);delete s._contentRange,s._element=a;const o=e.lastDomConfig,u=o==null?void 0:o.listeners;u&&s.isComposable&&((n=u.un)==null||n.call(u),vo(s,a,o)),a.lastDomConfig=o||a.lastDomConfig,a.$refOwnerId=s.id,s.scaleToFitWidth||s.getConfig("monitorResize")}addRefAccessor(e,t){const{prototype:r}=this.constructor;Ah(r,t,{writable:!0,value:null}),Ah(r,e,{get(){return this.recompose.flush(),this[t]},set(n){this[t]=n}})}attachRef(e,t,r){const n=this,s="_"+e;t.dataset&&(t.dataset.ownerCmp=n.id),n.isComposable&&(s in n||n.addRefAccessor(e,s),vo(n,t,r,e)),n.byRef[e]=t,n[e]=t}detachRef(e,t,r){const n=this,s=n._refListeners;s!=null&&s[e]&&(s[e](),delete s[e]),n[e]=null,delete n.byRef[e]}afterRecompose(){}compose(){return{class:J.normalize(this.widgetClassList,"object")}}doCompose(){const e=this,{$meta:t}=e,r=t.hierarchy,n=t.renderConfigs||t.getInherited("renderConfigs");let{composers:s}=t,a=null,l,o,u,c;if(e.recompose.suspend(),!s){for(t.composers=s=[],u=r.indexOf(X);u<r.length;++u)c=r[u].prototype,Er(c,"compose")&&s.push(c);Er(n,va)||(n[va]={get(d){n[d]=!0}})}for(e.configObserver=n[va],u=0;u<s.length;++u)l=s[u].compose.call(e,a),a=a?D.merge(a,l):l;return Er(e,"compose")&&(l=e.compose)&&(l=l.call(e,a),D.merge(a,l)),e.configObserver=null,D.normalizeChildren(a,(d,h)=>{h&&(o="_"+d,o in e||e.addRefAccessor(d,o))})}get element(){return this.isComposable&&!this.isDestroying&&this.recompose.flush(),this._element}domSyncCallback(e){}changeElement(e){const t=this,r=t.isComposable;return r&&(e=t.doCompose()),typeof e=="string"?e=D.createElementFromTemplate(e):x.isObject(e)?(e=D.createElement(e,{refOwner:t,callback:t.domSyncCallback}),t.recompose.resume(),r&&vo(t,e,e.lastDomConfig)):D.isReactElement(t.peekConfig("html"))?e=document.createElement("div"):e.nodeType!==1&&(e=D.createElementFromTemplate(t.template(t))),e.id=t.id,t.elementAttributes&&D.setAttributes(e,t.elementAttributes),e}updateElement(e){const t=this,{className:r}=e,{contentElement:n,contentElementCls:s,isComposable:a}=t,l=n!==e,o=!a&&e.querySelectorAll("[data-reference]"),u=a?[]:t.widgetClassList;let c=(l||!a)&&t.uiClasses;if(r&&u.unshift(r),t._hidden&&u.push("b-hidden"),t._readOnly&&u.push("b-readonly"),ue.noThrow(e,"remove"),c?(s!=null&&s.value&&(c=c.slice(),c.push(s.value)),c=c.join(" ")):c=s==null?void 0:s.value,c&&(l?n.className+=" "+c:u.push(c)),!t.parent){const{defaultCls:d}=t,{outerCls:h}=X;u.push(...d?h.filter(g=>!(g in d)||d[g]):h)}if(e.className=u.join(" "),o)for(let d,h=0;h<o.length;++h)d=o[h],t.attachRef(d.getAttribute("data-reference"),d),d.removeAttribute("data-reference");!t.adopt&&!t.scaleToFitWidth&&t.getConfig("monitorResize"),t.getConfig("role"),t.getConfig("ariaLabel"),t.getConfig("ariaDescription"),t._html&&t.getConfig("htmlMutationObserver"),t.trigger("elementCreated",{element:e})}updateAriaDescription(e){const{ariaElement:t}=this,r=`${this.id}-aria-desc-el`;if(e){const n=this._ariaDescEl||(this._ariaDescEl=D.createElement({className:"b-aria-desc-element",id:r,parent:t}));n.innerText=e.match(ya)?this.L(e,this):e,t.setAttribute("aria-describedBy",n.id)}else t.getAttribute("aria-describedby")===r&&t.removeAttribute("aria-describedBy")}updateAriaLabel(e){D.setAttributes(this.ariaElement,{"aria-label":e!=null&&e.match(ya)?this.L(e,this):e})}updateAriaHasPopup(e){D.setAttributes(this.ariaElement,{"aria-haspopup":e})}updateRole(e){var t,r;e?(t=this.ariaElement)==null||t.setAttribute("role",e):(r=this.ariaElement)==null||r.removeAttribute("role")}get ariaElement(){this.getConfig("element");const{_ariaElement:e}=this;return e.nodeType===Node.ELEMENT_NODE?e:x.getPath(this,e)}isCollapsified({collapsed:e,alt:t}){const{collapsify:r}=this,n=r==="hide",s=r===!1,a=r==null;return t?r==="overlay"||a&&e:s||n||a&&!e}async recompose(){const e=this,t={targetElement:e.element,domConfig:e.doCompose(),refOwner:e,callback:e.domSyncCallback,strict:!0};if(e.transitionRecompose){if(e.isTransitioningDom=!0,await D.transition(x.assign({element:e.element,action(){de.sync(t)}},e.transitionRecompose)),e.isDestroyed)return;e.isTransitioningDom=!1,e.trigger("transitionedRecompose")}else de.sync(t);t.changed&&(e.afterRecompose(),e.trigger("recompose")),e.resumeRecompose()}resumeRecompose(){this.recompose.resume()}changeElementRef(e){if(typeof e=="string"){const t=e;if(!(e=document.getElementById(t)))throw new Error(`No element found with id '${t}'`)}return e}changeAppendTo(e){return this.changeElementRef(e)}updateAppendTo(e){!this.isConfiguring&&e&&this.render()}changeInsertBefore(e){return this.changeElementRef(e)}updateInsertBefore(e){!this.isConfiguring&&e&&this.render()}changeInsertFirst(e){return this.changeElementRef(e)}updateInsertFirst(e){!this.isConfiguring&&e&&this.render()}getRenderContext(e=this,t){let r=t||e.appendTo,{insertFirst:n,insertBefore:s}=e;return n&&(r=n,s=r.firstChild),s&&(r||(r=s.parentElement)),[r,s||void 0]}render(e,t=!0){const r=this,{element:n}=r,[s,a]=r.getRenderContext(r,e);r.emptyCache(),r.syncElement&&r.currentElement?D.sync(n,r.currentElement):(s==null||s.insertBefore(n,a),r.currentElement=n),X.fromElement(n.parentElement)&&n.classList.remove(...X.outerCls),super.render(s,t),r.rendered=!0,r.getConfig("role"),t&&(r.getConfig("contentRange"),r.triggerPaint()),r.setupFocusListeners()}template({tag:e,html:t,htmlCls:r,name:n}){const s=this;typeof t=="string"&&Vy.test(t)&&s.resolveCallback(t,s,!1)&&(t=s.callback(t,s,[s]));const a=t!=null&&t.call?t.call(s,s):t;return`<${e} class="${a?r:""}" ${n?`data-name="${n}"`:""}>${a||""}</${e}>`}updateRecomposeAsync(e){this.recompose.immediate=!e}onConfigChange({name:e}){var t;this._element&&!this.isDestroying&&((t=this.$meta.renderConfigs)!=null&&t[e])&&this.recompose()}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.parent}getConfigValue(e,t){return e==="style"?this._style:super.getConfigValue(e,t)}getCurrentConfig(e){const t=super.getCurrentConfig(e);return(e==null?void 0:e.depth)>0&&(t.type=this.type),t}get dataset(){return this.element.dataset}changeDataset(e){x.assign(this.dataset,e)}get dragGhost(){return this.constructor._dragGhost||(this.constructor._dragGhost=D.createElement({html:"\xA0",style:"position:absolute;top:-10000em;left:-10000em"}))}updateParent(e){const{_element:t}=this;t&&t.classList[e?"remove":"add"](...X.outerCls)}get constrainTo(){let e=this._constrainTo;if(e=e===void 0?globalThis:(e==null?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE?e.host||e.ownerDocument:e,this.positioned){const{offsetParent:t}=this.element;if(t&&D.getStyleValue(t,"overflow")==="hidden")e=V.from(t).moveTo(0,0);else if(e&&!e.isRectangle){const r=e===document||e===globalThis;e=V.from(e,t),r&&e.translate(globalThis.pageXOffset,globalThis.pageYOffset)}}return e}updateCentered(e){const{element:t,_anchorElement:r}=this;if(e&&!this.floating&&!this.positioned)throw new Error("`centered` is only relevant when a Widget is `floating` or `positioned`");e?(t.classList.add("b-centered"),t.style.transform=t.style.left=t.style.top="",r==null||r.classList.add("b-hide-display"),t.classList.remove("b-anchored")):t.classList.remove("b-centered")}get contentElement(){return this.element}get contentRange(){const e=this,{contentElement:t}=e,r=e._contentRange||(e._contentRange=new Range);return r.collapsed&&(r.setStart(t,e.contentRangeStartOffset||0),r.setEnd(t,e.contentRangeEndOffset||t.childNodes.length)),r}fixRefOwnerId(e,t,r){if(e.$refOwnerId===r){e.$refOwnerId=t;for(let{childNodes:n}=e,s=n.length;s-- >0;)this.fixRefOwnerId(n[s],t,r)}}get placement(){var e;const t=this,{element:r}=t;let n,s,a;if(r!=null&&r.offsetParent&&!Fy.test(D.getStyleValue(r,"position"))){const l=r.nextElementSibling,o=r.previousElementSibling,u=!l&&o;s=D.getStyleValue(r.parentElement,"flex-direction"),s?s=s.startsWith("row")?"h":"v":(n=(e=l||o)==null?void 0:e.getBoundingClientRect(),a=n&&r.getBoundingClientRect(),s=n&&Math.abs(n.top-a.top)<Math.abs(n.left-a.left)?"h":"v"),s+=s==="h"?u?"r":"l":u?"b":"t"}return s}updateId(e,t){if(super.updateId(e,t),t){const{byRef:r,element:n}=this;for(const s in r)r[s].dataset&&(r[s].dataset.ownerCmp=e);n.id=e,this.fixRefOwnerId(n,e,t)}}get style(){const{element:e}=this;return(e==null?void 0:e.ownerDocument.defaultView.getComputedStyle(e))||this._style}updateStyle(e){this.element&&D.applyStyle(this.element,e)}updateTitle(e){this.titleElement&&(this.titleElement.innerHTML=e)}beforeAlignTo(e){}alignTo(e){var t;const r=this,{lastAlignSpec:n,element:s}=r,{offsetParent:a,style:l,classList:o}=s;if(n&&(n.monitorIntersection&&r.intersectionObserver.unobserve(n.target),isFinite(n.zone)&&s.classList.remove(Fh[n.zone])),!e){r.removeTransientListeners(),r.anchor=r.lastAlignSpec=null;return}r.beforeAlignTo(e),(e.nodeType===Element.ELEMENT_NODE||e.isWidget||e.$$name==="Point")&&(e={target:e}),r.releaseSizeConstraints();const{scrollable:u,constrainTo:c}=r,d=D.measureSize(D.getStyleValue(s,"minHeight"),s),h=D.measureSize(D.getStyleValue(s,"minWidth"),s),g=r.positioned&&D.getStyleValue(s,"position")!=="fixed",f=r.scale||1,m=e.target,p=e.domEvent||e.event||m,v=m!=null&&m.isRectangle?m:(m==null?void 0:m.element)||m,b=(v==null?void 0:v.nodeType)===Element.ELEMENT_NODE,w=((t=p==null?void 0:p.target)==null?void 0:t.nodeType)===Element.ELEMENT_NODE;e=e.realignTarget?e:x.assign({aligningToEvent:w,aligningToElement:b,constrainTo:c,align:"b-t",axisLock:r.axisLock,anchor:r.anchor},r.align,e);const S=e.minWidth||h,C=e.minHeight||d;if(r.lastAlignSpec=e,w)delete e.target,e.domEvent=p,e.anchoredTo=p.target,e.position=new ot(p.clientX+1,p.clientY+1);else if(b&&(e.target=v,Yt(v instanceof SVGElement?v.closest("svg"):v))){if(e=Object.setPrototypeOf({},e),e.target=r.lastAlignSpec.targetRect=e.realignTarget||(e.allowTargetOut?V.from(v,g?a:null,!g):D.isInView(v,!1,r)),!e.target){const W=r.hide();return r.isDestroyed||(r.lastAlignSpec.targetOutOfView=!0),W}e.target.height=Math.max(e.target.height,1),e.target.width=Math.max(e.target.width,1),r.lastAlignSpec.anchoredTo=v}e.anchor&&(e.anchorSize=r.anchorSize,s.contains(r.anchorPathElement)||s.appendChild(r.anchorElement)),r.isAligning=!0,r.trigger("beforeAlign",e);const T=V.from(s,g?a:null,!0),{width:E,height:I}=T;T.isAlignRectangle=!0,S&&(T.minWidth=S*f),C&&(T.minHeight=C*f),r.isAligning=!1,e.rtl=r.rtl,(e.align.includes("s")||e.align.includes("e"))&&(r.rtl?e.align=e.align.replace(/s/g,"r").replace(/e/g,"l"):e.align=e.align.replace(/s/g,"l").replace(/e/g,"r"));const R=r.lastAlignSpec.result=T.alignTo(e);let{align:M,anchor:O,x:A,y:B,width:L,height:Y,overlap:K}=R;if(r.lastAlignSpec.zone=R.zone,Y!=I){const W=Y<I;r.alignmentChanges=r.alignmentChanges|(W?1:2),l[r.alignedHeightStyle=$h[r.alignmentChanges&3]]=`${Y/f}px`,W&&!r._minHeight&&d&&(l.minHeight=`${Math.min(Y,d)/f}px`),u&&(u.overflowY=W)}if(L!=E){const W=L<E;r.alignmentChanges=r.alignmentChanges|(W?4:8),l[r.alignedWidthStyle=$h[r.alignmentChanges&12]]=`${L/f}px`,W&&!r._minWidth&&h&&(l.minWidth=`${Math.min(L,h)/f}px`),u&&(u.overflowX=W)}if(M&&r.alignmentChanges){const W=V.from(s,g?a:null,!0);e.align=M;const Z=r.lastAlignSpec.result=W.alignTo(e);O=Z.anchor,A=Z.x,B=Z.y,L=Z.width,Y=Z.height}if(r.centered||r.setXY(A,B),!R.overlap&&isFinite(R.zone)&&o.add(Fh[R.zone]),O!=null&&O.edge){const{edge:W}=O,{anchorElement:Z}=r,{style:G}=Z,he=V.from(s),ge=[];W==="top"||W==="bottom"?(ge[0]=O.x,ge[1]=W==="top"?1:he.height-1):(ge[0]=W==="left"?1:he.width-1,ge[1]=O.y),G.display="none";let be=D.childFromPoint(s,...ge);if((be!=null&&be.matches(":focus")||be===Me.currentOverElement)&&s.compareDocumentPosition(be)&Node.DOCUMENT_POSITION_CONTAINED_BY&&(be=be.parentNode),be&&be!==document){let Ue=D.getStyleValue(be,"background-color");for(;Ue.match(po)&&D.getStyleValue(be,"position")!=="absolute"&&(be=be.parentNode,be!==document);)Ue=D.getStyleValue(be,"background-color");Ue.match(po)?r.anchorPathElement.setAttribute("fill",r.defaultAnchorBackgroundColor):r.anchorPathElement.setAttribute("fill",Ue)}G.transform=G.display="",Z.className=`b-anchor b-anchor-${W}`,O.x&&(O.x/=f),O.y&&(O.y/=f),D.setTranslateXY(Z,O.x,O.y),o.add("b-anchored")}else r._anchorElement&&(r.anchorElement.classList.add("b-hide-display"),o.remove("b-anchored"));if(!b){l.pointerEvents="none";const W=D.elementFromPoint(A,B);r.owns(W)||(r.lastAlignSpec.anchoredTo=W),l.pointerEvents=""}if((r.scrollAction==="realign"&&b||r.scrollAction==="hide")&&!r.documentScrollListener&&(r.clearTimeout(r.scrollListenerTimeout),e.monitorTargetMutation&&!r.targetObserver&&(r.targetObserver||(r.targetObserver=new MutationObserver(r.onTargetParentMutation.bind(r)))).observe(D.getRootElement(v),{childList:!0,attributes:!0,subtree:!0}),r.scrollListenerTimeout=r.setTimeout(()=>{var W,Z;const G=(Z=(W=b?v:r.lastAlignSpec.anchoredTo).getRootNode)==null?void 0:Z.call(W);r.documentScrollListener=$.addListener(document,"scroll","doHideOrRealign",{capture:!0,thisObj:r}),G!=null&&G.mode&&(r.targetRootScrollListener=$.addListener(G,"scroll","doHideOrRealign",{capture:!0,thisObj:r}))},r.scrollAction==="hide"?r.ignoreScrollDuration:0)),b&&(e.monitorResize&&!r.targetResizeListener&&(Ee.addResizeListener(v,r.onTargetResize),r.targetResizeListener=!0),e.monitorIntersection&&!(K||v.contains(s)||v.ownerSVGElement)&&r.intersectionObserver.observe(v)),!U.isAndroid&&!r.constrainListeners){const W=c!=null&&c.isRectangle?globalThis:c;r.clearTimeout(r.resizeListenerTimeout),r.resizeListenerTimeout=r.setTimeout(()=>{r.constrainListeners=!0,Ee.addResizeListener(W||globalThis,r.onAlignConstraintChange)},r.ignoreScrollDuration)}}onTargetParentMutation(e){var t;const{element:r,lastAlignSpec:n}=this;n!=null&&n.aligningToElement&&((t=n.target)!=null&&t.isConnected?e.some(({target:s})=>s.contains(n.target)&&!r.contains(s))&&this.realign():this.hide())}get intersectionObserver(){return this._intersectionObserver||(this._intersectionObserver=new IntersectionObserver(this.onTargetIntersectionchange.bind(this),{root:U.isSafari?this.rootElement:this.rootElement.ownerDocument}))}onTargetIntersectionchange(e){if(!this.isDestroyed){const t=e[e.length-1];t.isIntersecting||this.onAlignTargetOutOfView(t.target)}}onTargetResize(){const{lastAlignSpec:e}=this;if(e){const{width:t,height:r}=e.targetRect,{width:n,height:s}=e.target.getBoundingClientRect();(n!==t||s!==r)&&this.onAlignConstraintChange(...arguments)}}onAlignTargetOutOfView(e){this.hide(),this.lastAlignSpec&&(this.lastAlignSpec.targetOutOfView=!0)}onAlignConstraintChange(e,t,{height:r}){const{style:n}=this.contentElement,{overflowY:s}=n;this.setTimeout(this.realign,50),t&&r>t.height&&(n.overflowY="hidden",this.requestAnimationFrame(()=>n.overflowY=s))}realign(){const e=this,{lastAlignSpec:t}=e;if((e.floating||e.positioned)&&t&&e.isVisible){if(t.aligningToElement){const r=t.target.contains(this.element),n=D.isInView(t.target,!1,e);if(!t.allowTargetOut&&(!Yt(t.target)||!n)){e.hide(),e.isDestroyed||(e.lastAlignSpec.targetOutOfView=!0);return}t.realignTarget=r?null:n}D.addTemporaryClass(e.element,"b-realigning",e.realignTimeout,e),e.alignTo(t)}}rectangle(e,t,r){return this.rectangleOf("element",e,t,r)}rectangleOf(e,t,r,n){return typeof t!="string"?(n=r,r=t,t=""):t==="border"&&(t=""),typeof r=="boolean"&&(n=r,r=void 0),e!=="element"&&r===void 0&&(r=this.element),r=r!=null&&r.isWidget?r.element:r,V[t||"from"](this[e],r,n)}releaseSizeConstraints(){const e=this,{scrollable:t,element:r,alignmentChanges:n}=e,{style:s}=r;n&12&&(D.setLength(r,e.alignedWidthStyle,e[`_last${P.capitalize(e.alignedWidthStyle)}`]||""),s.minWidth=e._minWidth||"",t&&(t.overflowY=t.config.overflowY)),n&3&&(D.setLength(r,e.alignedHeightStyle,e[`_last${P.capitalize(e.alignedHeightStyle)}`]||""),s.minHeight=e._minHeight||"",t&&(t.overflowX=t.config.overflowX)),e.alignmentChanges=0}toFront(){const{element:e}=this,t=this.floating?this.floatRoot:this.positioned?e==null?void 0:e.parentNode:null,r=document.createDocumentFragment();if(this.containsFocus){for(let n=e.nextSibling,s;n;n=s)s=n.nextSibling,t.contains(n)&&!this.owns(n)&&r.appendChild(n);t.insertBefore(r,e)}else t.appendChild(e)}updateRef(e){this.element.dataset.ref=e}get overflowElement(){return this.contentElement}get maxHeightElement(){return this.element}changeAlign(e){return typeof e=="string"?{align:e}:e}changeScrollable(e,t){return typeof e=="boolean"&&(e={overflowX:e,overflowY:e}),e?(e.element=this.overflowElement,e.widget=this,e.isScroller||(e=t?t.setConfig(e):new this.scrollerClass(e)),e.syncOverflowState()):t==null||t.destroy(),e}handleReactElement(e){const t=this.closest(r=>r.reactComponent);t!=null&&t.reactComponent&&t.reactComponent.processWidgetContent({reactElement:e,widget:this,reactComponent:t.reactComponent})}get html(){return this.initializingElement||!this.element?this.content||this._html:this.contentElement.innerHTML}updateHtml(e){const t=this,r=e==null,{element:n,contentElement:s,htmlCls:a}=t;if(!n&&D.isReactElement(e)){t.whenVisible(()=>t.handleReactElement(e));return}if(n){t.updatingHtml=!0;const l=s===n&&t._anchorElement;a&&a.values.forEach(o=>n.classList[r?"remove":"add"](o)),l&&n.removeChild(l),e&&typeof e=="object"?D.isReactElement(e)?t.handleReactElement(e):de.sync({domConfig:{...e,onlyChildren:!0},targetElement:t.contentElement}):t.contentElement.innerHTML=r?"":e,t.getConfig("htmlMutationObserver"),l&&n.appendChild(l),t.isComposable?t.recompose():(t.floating||t.positioned)&&(t.isAligning||t.realign())}}changeHtmlMutationObserver(e,t){const r=this,{contentElement:n}=r;if(t==null||t.disconnect(),e){const s=new MutationObserver(()=>{r.updatingHtml?r.updatingHtml=!1:r._html=n.innerHTML});return s.observe(n,e),s}}updateContent(e){const t=this,r=e==null,{element:n,htmlCls:s}=t;if(n){const{contentRange:a}=t;s&&s.values.forEach(l=>n.classList[r?"remove":"add"](l)),n.isConnected?(a.deleteContents(),r||a.insertNode(D.createElementFromTemplate(e,{fragment:!0}))):t.contentElement.innerHTML=e,t.contentRangeStartOffset=a.startOffset,t.contentRangeEndOffset=a.endOffset,(t.floating||t.positioned)&&!t.isAligning&&t.realign()}}onThemeChange(){var e;(e=this.anchorElement)!=null&&e.offsetParent&&(this._anchorSize=null,this.realign())}get anchorSize(){const e=this;let t=this._anchorSize;if(!t){const r=parseFloat(D.getStyleValue(e.element,"border-top-width")),n=D.getStyleValue(e.element,"border-top-color"),s=e.anchorElement,{className:a}=s,l=s.firstElementChild,o=e.anchorPathElement=l.lastElementChild,u=e._hidden;s.className="b-anchor b-anchor-top";let c=D.getStyleValue(e.contentElement,"background-color");c.match(po)&&(c=D.getStyleValue(e.element,"background-color")),e.defaultAnchorBackgroundColor=c,t=s.getBoundingClientRect();const[d,h]=t=e._anchorSize=[t.width,t.height];s.className=a,l.setAttribute("height",h+r),l.setAttribute("width",d),o.setAttribute("d",`M0,${h}L${d/2},0.5L${d},${h}`),r&&(o.setAttribute("stroke-width",r),o.setAttribute("stroke",n)),t[1]-=r,u&&e.element.classList.add("b-hidden"),e.themeChangeListener||(e.themeChangeListener=Me.ion({theme:"onThemeChange",thisObj:e})),e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}return t}get anchorElement(){const e=this;if(!e._anchorElement){const t=e.floating,r=`${e.id}-shadow-filter`;e._anchorElement=D.createElement({parent:e.element,className:"b-anchor b-anchor-top",children:[{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",class:"b-pointer-el",children:[t?{tag:"defs",children:[{tag:"filter",id:r,children:[{tag:"feDropShadow",dx:0,dy:-1,stdDeviation:1,"flood-opacity":.2}]}]}:null,{tag:"path",[t?"filter":""]:`url(#${r})`}]}]})}return e._anchorElement}updateAnchor(e){this._anchorElement&&this._anchorElement.classList[e?"remove":"add"]("b-hide-display")}updateDraggable(e){var t,r,n;const s=this,{element:a}=s;e?(s.dragEventDetacher=$.addListener({element:a,dragstart:"onWidgetDragStart",dragend:"onWidgetDragEnd",thisObj:s}),s.dragDetacher=$.on({element:a,mousedown(l){const{target:o}=l,u=X.fromElement(o);(!l.target.closest(".b-field-inner")&&u===this||this.strips&&Object.values(this.strips).includes(u))&&a.setAttribute("draggable","true")},thisObj:s})):((t=s.dragEventDetacher)==null||t.call(s),(r=s.dragOverEventDetacher)==null||r.call(s),(n=s.dragDetacher)==null||n.call(s))}onWidgetDragStart(e){var t;const r=this;if(!r.validateDragStartEvent(e))return;const{element:n,align:s,constrainTo:a}=r,l=r.positioned&&D.getStyleValue(n,"position")!=="fixed",o=l?n.parentElement:r.rootElement,u=V.from(n,l?o:null),c=e.clientX,d=e.clientY,h=document.scrollingElement||document.body,[g,f]=l?D.getOffsetXY(n,o):r.getXY(),m=(t=l?V.content(o).moveTo(0,0):a&&(a!=null&&a.isRectangle?a:V.from(a)))==null?void 0:t.deflate(s.constrainPadding||0),p={element:o,dragover:v=>{n.classList.remove("b-centered"),u.moveTo(g+v.clientX-c-(l?0:h.scrollLeft),f+v.clientY-d-(l?0:h.scrollTop)),m&&u.constrainTo(m),D.setTranslateXY(n,u.x,u.y)}};U.isTouchDevice&&(p.touchmove=v=>v.preventDefault()),r.floatRoot.appendChild(r.dragGhost),r.setDragImage(e),e.dataTransfer.effectAllowed="none",r.dragOverEventDetacher=$.addListener(p),r.alignTo()}validateDragStartEvent(e){var t;const r=this,{element:n}=r,s=D.elementFromPoint(e.clientX,e.clientY),{handleSelector:a}=r.draggable;if(a){const l=(t=Py.exec(a))==null?void 0:t[1];if(l){if(s.closest(`#${n.id} ${l}`))return e.preventDefault(),!1}else if(!s.closest(`#${n.id} ${a}`))return e.preventDefault(),!1}return!0}setDragImage(e){e.dataTransfer.setDragImage&&(e.dataTransfer.setData("application/node type",""),e.dataTransfer.setDragImage(this.dragGhost,-9999,-9999))}setStyle(e,t){return D.applyStyle(this.element,x.isObject(e)?e:{[e]:t}),this}onWidgetDragEnd(){this.dragGhost.remove(),this.dragOverEventDetacher(),this.element.removeAttribute("draggable")}changeFloating(e){return!!e}changePositioned(e){return!!e}updatePositioned(e){this.element.classList[e?"add":"remove"]("b-positioned")}getXY(){return[D.getPageX(this.element),D.getPageY(this.element)]}setXY(e,t){const r=this,{element:n}=r;if(r.floating||r.positioned){if(e!=null&&(r._x=e),t!=null&&(r._y=t),D.getStyleValue(n,"position")==="fixed"){const s=n.getBoundingClientRect(),[a,l]=D.getTranslateXY(n),o=e-s.x,u=t-s.y;D.setTranslateXY(n,a+o,l+u)}else D.setTranslateXY(n,r._x||0,r._y||0);r.isConstructing?r.centered=!1:n.classList.remove("b-centered")}}get x(){return this.getXY()[0]}changeX(e){this.setXY(e)}get y(){return this.getXY()[1]}changeY(e){this.setXY(null,e)}get width(){const e=this,t=e.element;return e.monitorResize?(e._width==null&&(e._width=t.offsetWidth),e._width):t.offsetWidth}changeWidth(e){const t=this;D.setLength(t.element,"width",e),t._lastWidth=e,t._oldWidth=t._width,t._width=null,t._flex=null,t.element.style.flex=""}clearWidthCache(){this._width=null}get maxWidth(){return D.measureSize(this.element.style.maxWidth,this.element)}updateMaxWidth(e){this._lastMaxWidth=e,D.setLength(this.element,"maxWidth",e)}get minWidth(){return D.measureSize(this.element.style.minWidth,this.element)}updateMinWidth(e){D.setLength(this.element,"minWidth",e)}updateFlex(e){this.getConfig("width"),(typeof e=="number"||!isNaN(e))&&(e=`${e} ${e}`),this.element.style.flex=e,this.element.style.width=""}updateAlignSelf(e){this.element.style.alignSelf=e}updateMargin(e){this.element.style.margin=this.parseTRBL(e).join(" ")}updateTextAlign(e,t){t&&this.element.classList.remove(`b-text-align-${t}`),this.element.classList.add(`b-text-align-${e}`)}updatePlaceholder(e){this.input&&(e==null?this.input.removeAttribute("placeholder"):this.input.placeholder=e)}get height(){const e=this,t=e.element;return e.monitorResize?(e._height==null&&(e._height=t.offsetHeight),e._height):t.offsetHeight}changeHeight(e){D.setLength(this.element,"height",e),this._lastHeight=e,this._height=null}get maxHeight(){return D.measureSize(this.maxHeightElement.style.maxHeight,this.element)}updateMaxHeight(e){this._lastMaxHeight=e,D.setLength(this.maxHeightElement,"maxHeight",e)}get minHeight(){return D.measureSize(this.element.style.minHeight,this.element)}updateMinHeight(e){D.setLength(this.element,"minHeight",e)}updateDisabled(e=!1){const{element:t,focusElement:r,ariaElement:n}=this;this.trigger("beforeUpdateDisabled",{disabled:e}),!(e&&(this.revertFocus(),this._disabled!==e))&&(t&&(t.classList[e?"add":"remove"]("b-disabled"),r&&(r.disabled=e),n&&n.setAttribute("aria-disabled",e)),this.onDisabled(e))}onDisabled(e){}disable(){this.disabled=!0}enable(){this.disabled=!1}requestFullscreen(){const e=this,t=ft.request(e.floating?e.floatRoot:e.element);return ft.onFullscreenChange(e.onFullscreenChange),e.element.classList.add("b-fullscreen"),t}exitFullscreen(){return ft.exit()}onFullscreenChange(){ft.isFullscreen||this.onExitFullscreen()}onExitFullscreen(){ft.unFullscreenChange(this.onFullscreenChange),this.element.classList.remove("b-fullscreen")}get tooltip(){var e;const t=this;if(t._tooltip)return t._tooltip;{const r=(e=X.Tooltip)==null?void 0:e.getSharedTooltip(t.rootElement,t.eventRoot);if(r&&r.activeTarget===t._element&&r.isVisible)return r}}changeTooltip(e,t){var r;const n=this,{element:s}=n;if(e){if(!(n.preventTooltipOnTouch&&U.isTouchDevice))if(!e.isTooltip&&e.constructor.name!=="Object"&&(e={html:typeof e=="string"?e:n.placeholder,textContent:!0}),n.configureAriaDescription||(n.ariaDescription=(r=e.html)!=null&&r.match(ya)?e.html.replace(ya,Ny):e.html),t!=null&&t.isTooltip||e.newInstance)e.type="tooltip",e.forElement||(e.forElement=s),!("showOnHover"in e)&&!e.forSelector&&(e.showOnHover=!0),"autoClose"in e||(e.autoClose=!0),e=X.reconfigure(t,e,n),n.detachListeners("tooltipValueListener"),n.configureAriaDescription||e.ion({name:"tooltipValueListener",innerHtmlUpdate:"onTooltipValueChange",thisObj:n});else{s.dataset.btip=!0,n.tipConfig=e;return}}else if(t)if(e==null&&t.isTooltip)t.destroy();else{t.html=null;return}else delete s.dataset.btip;return e}onTooltipValueChange({value:e,source:t}){this.ariaDescription=typeof e=="string"?e:t.contentElement.innerText}get tooltipText(){const e=this._tooltip;if(e)return e.isTooltip?e.contentElement.innerText:typeof e=="string"?e:e.html;if(this.tipConfig)return this.tipConfig.html}get isVisible(){const e=this,{element:t}=e;let r;return!!(t&&!e._hidden&&!e.isDestroying&&t.isConnected&&(!e.requireSize||Yt(t))&&(!(r=e.containingWidget)||r.isVisible))}whenVisible(e,t=this,r,n=e.toString()){var s;const a=this;a.isVisible&&a.isPainted?((s=a.toCallWhenVisible)==null||s.delete(n),a.callback(e,t,r)):(a.toCallWhenVisible||(a.toCallWhenVisible=new Map)).set(n,{callback:e,thisObj:t,args:r})}focus(){this.isFocusable&&D.focusWithoutScrolling(this.focusElement)}get focusElement(){}get isFocusable(){const e=!this.isDestroying&&this.isVisible&&!this.disabled&&this.focusElement;return e&&(e===document.body||e.offsetParent)}async show({align:e,animate:t=!0}={}){const r=this,{element:n,floating:s}=r,{style:a}=n,l=t&&r.showAnimation;let o,u,c=!r.isVisible;return c&&(c=r.trigger("beforeShow"),x.isPromise(c)&&(c=await c)),c!==!1&&(!r.internalBeforeShow||r.internalBeforeShow()!==!1)?new Promise(d=>{if(r.cancelHideShowAnimation(),r.updateCentered(r._centered),s){const h=r.floatRoot;h.contains(n)||(r.rendered?h.appendChild(r.element):r.render(h,!1)),a.transform.includes("scale")&&(r.scale=null,a.transform=a.transformOrigin="");const g=r.closest(Ly);if(g){const{scale:f}=g;r.scale=f,a.transform=`scale(${f})`,a.transformOrigin="0 0"}}if(r._hidden=!1,n.classList.remove("b-hidden"),s&&!Ll(n)&&(r.hide(!1),d()),r.onConfigChange({name:"hidden",value:!1,was:!0,config:r.$meta.configs.hidden}),l){o=Object.keys(l)[0],u=l[o];const h=r.currentAnimation={showing:!0,styleProp:o,resolve:d};r.isAnimating=!0,a.transition="none",a[o]=u.from,D.getStyleValue(n,o),r.currentAnimation.detacher=$.onTransitionEnd({element:n,property:o,duration:Ph(u.duration)+20,handler:()=>r.afterHideShowAnimate(h),thisObj:r}),a.transition=`${o} ${u.duration} ease ${u.delay}`,a[o]=u.to}r.afterShow(e,l?null:d)}):Promise.resolve()}async showBy(e,t,r){const n=this,s=Array.isArray(e);if(s||typeof e=="number"){const a=s?e:[e,t];e=Object.assign({target:new ot(a[0]+1,a[1]+1),matchSize:!1,align:"t0-b0"},s?t:r)}if(n.requireSize=!0,n.isVisible)D.addTemporaryClass(n.element,"b-realigning",300,n),n.alignTo(e);else return n.show({align:e})}async showByPoint(){return ie.deprecate("Core","6.0.0","Widget.showByPoint() replaced by Widget.showBy() with the same signature"),this.showBy(...arguments)}afterShow(e,t){var r,n;const s=this;s.trigger("show"),s._configuredAnchorState=s.anchor,(n=(r=s.owner)==null?void 0:r.onChildShow)==null||n.call(r,s),s.triggerPaint(),(s.floating||s.positioned)&&(e?s.alignTo(e):s.centered?s.alignTo({target:s.constrainTo,align:"c-c"}):s.forElement&&s.alignTo(s.forElement)),t==null||t()}onChildHide(e){e.floating&&this.ariaElement.removeAttribute("aria-owns")}onChildShow(e){e.floating&&(this.ariaHasPopup=e.role,this.ariaElement.setAttribute("aria-owns",e.id))}triggerPaint(){const e=this,{element:t,toCallWhenVisible:r}=e,n=!e.isPainted;if(e.isVisible){if(n&&(e.getConfig("scrollable"),e.scaleToFitWidth&&!e.monitorResize&&(e.onParentElementResize=e.onParentElementResize.bind(e),Ee.addResizeListener(t.parentElement,e.onParentElementResize),e.updateScale()),!e.hideBryntumDomMessage&&(e.isTaskBoardBase||e.isGridBase||e.isCalendar)&&t.insertBefore(new Comment("POWERED BY BRYNTUM (https://bryntum.com)"),t.firstChild),e.onConnectedCallback&&globalThis.ResizeObserver&&(e.connectedObserver=new ResizeObserver(()=>{e.isElementConnected&&!t.isConnected?(e.onConnectedCallback(!1),e.isElementConnected=!1):!e.isElementConnected&&t.isConnected&&(e.onConnectedCallback(!0,e.isElementConnected==null),e.isElementConnected=!0)}),e.connectedObserver.observe(t))),e.eachWidget(Ay,!1),n&&(e.getConfig("tooltip"),!X.Ripple&&X.RippleClass&&(X.Ripple=new X.RippleClass({rootElement:e.rootElement})),globalThis.DocsBrowser&&e.floating&&e.closest(s=>{var a;return(a=s.element)==null?void 0:a.closest(".fiddlePanelResult,.b-owned-by-fiddle")})&&t.classList.add("b-owned-by-fiddle")),e.isPainted=!0,n&&e.triggerConfigs("paint"),e.onInternalPaint({firstPaint:n}),e.trigger("paint",{firstPaint:n}),r!=null&&r.size){for(const{callback:s,thisObj:a,args:l}of r.values())e.callback(s,a,l);r.clear()}n&&e.monitorResize&&!e.scaleToFitWidth&&Ee.onElementResize([{target:t}])}}onInternalPaint(){}cancelHideShowAnimation(){const e=this,{currentAnimation:t,element:r}=e;t&&(e.isAnimating=!1,r.classList.contains("b-hiding")&&(r.classList.remove("b-hiding"),e._hidden=!1),t.detacher(),t.resolve(),r.style.transition=r.style[t.styleProp]="",e.currentAnimation=null,e.trigger(`${t.showing?"show":"hide"}AnimationEnd`))}afterHideShowAnimate(e){const t=this;e===t.currentAnimation&&(t.element.classList.remove("b-hiding"),t.cancelHideShowAnimation(),t._hidden&&t.afterHideAnimation())}suspendVisibility(){this._visibilitySuspended=(this._visibilitySuspended||0)+1,Object.defineProperty(this,"isVisible",$y)}resumeVisibility(e=!0){--this._visibilitySuspended||(delete this.isVisible,e&&this.triggerPaint())}hide(e=!0){return new Promise(t=>{const r=this,{element:n,lastAlignSpec:s}=r,{style:a}=n,l=e&&r.hideAnimation;if(r.clearTimeout(r.scrollListenerTimeout),r.clearTimeout(r.resizeListenerTimeout),!r._hidden&&r.trigger("beforeHide",{animate:e})!==!1){if(r._hidden=!0,s&&(s.targetOutOfView=null,s.monitorIntersection&&(r.intersectionObserver.takeRecords(),r.intersectionObserver.unobserve(s.target))),r.onConfigChange({name:"hidden",value:!0,was:!1,config:r.$meta.configs.hidden}),!n){t();return}if(n.contains(D.getActiveElement(n))&&r.revertFocus(!0),r.isDestroyed){t();return}if(r.cancelHideShowAnimation(),l){const o=Object.keys(l)[0],u=l[o];if(Number(getComputedStyle(r.element)[o])!==u.to){const c=r.currentAnimation={hiding:!0,styleProp:o,resolve:t};n.classList.add("b-hiding"),r.isAnimating=!0,r.currentAnimation.detacher=$.onTransitionEnd({element:n,property:o,duration:Ph(u.duration)+20,handler:()=>r.afterHideShowAnimate(c),thisObj:r}),a[o]=u.from,D.getStyleValue(n,o),a.transition=`${o} ${u.duration} ease ${u.delay}`,a[o]=u.to}else n.classList.add("b-hidden")}else n.classList.add("b-hidden");r.afterHide(!l&&t,l)}})}doHideOrRealign({target:e,isTrusted:t}){const r=this,{lastAlignSpec:n,element:s}=r,a=n==null?void 0:n.anchoredTo,l=n==null?void 0:n.target,o=n==null?void 0:n.position,u=D.getActiveElement(r);if(!t||!Yt(s)||e&&(s.contains(e)||e.nodeType===Element.ELEMENT_NODE&&r.owns(e)||e.nodeType===Element.DOCUMENT_NODE&&s.contains(u)&&Oy[u]&&globalThis.innerHeight<document.body.offsetHeight))return;if(n.aligningToElement){const d=D.isInView(l,!1,r);if(d&&d.equals(n.targetRect))return}const c=r.scrollAction==="hide"&&r.getXY();if(r.realign(),!r.isDestroyed&&Ll(s)&&r.scrollAction==="hide"){const[d,h]=r.getXY(),g=d!==c[0]||h!==c[1];(n!=null&&n.aligningToEvent||(g||(l==null?void 0:l.$$name)==="Point"||o)&&(!a||!Yt(a)||e&&D.isDescendant(e,a)))&&r.hide()}}afterHide(e=null,t=this.hideAnimation){var r,n;const s=this;s._anchor=s._configuredAnchorState,s.removeTransientListeners(),t||s.afterHideAnimation(),s.trigger("hide"),(n=(r=s.owner)==null?void 0:r.onChildHide)==null||n.call(r,s),e&&e()}removeTransientListeners(){var e,t,r;const n=this,{targetObserver:s,lastAlignSpec:a}=n;if(n.clearTimeout(n.resizeListenerTimeout),n.clearTimeout(n.scrollListenerTimeout),s&&(s.disconnect(),delete n.targetObserver),n.documentScrollListener=(e=n.documentScrollListener)==null?void 0:e.call(n),n.targetRootScrollListener=(t=n.targetRootScrollListener)==null?void 0:t.call(n),n.targetResizeListener&&(Ee.removeResizeListener(a.target,n.onTargetResize),n.targetResizeListener=!1),n.constrainListeners){const l=(r=a.constrainTo)!=null&&r.isRectangle?globalThis:a.constrainTo;Ee.removeResizeListener(l||globalThis,n.onAlignConstraintChange),n.constrainListeners=!1}}afterHideAnimation(){const e=this,{element:t}=e;e.floating&&e.floatRoot.contains(t)?t.remove():t.classList.add("b-hidden"),e.defaultAnchorBackgroundColor&&e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}changeHidden(e){const t=this;let r;return t.isConfiguring?(r=!!e,t.element.classList[e?"add":"remove"]("b-hidden")):(t.trigger("beforeChangeHidden",{hidden:e}),e?t.hide():t.show()),r}get assignedId(){return this.hasGeneratedId?null:this.id}get owner(){return this.parent||this._owner||this.containingWidget}get containingWidget(){var e,t;let r=this.parent;if(!r){const n=((e=this.forElement)==null?void 0:e.nodeType)===Element.ELEMENT_NODE?this.forElement:(t=this.element)==null?void 0:t.parentNode;r=(n==null?void 0:n.closest(".b-widget"))&&X.fromElement(n)}return r}get previousSibling(){return this.getSibling(-1)}get nextSibling(){return this.getSibling(1)}getSibling(e){const t=this,{parent:r}=t,n=r?r.childItems:Array.from(t.element.parentElement.querySelectorAll(".b-widget"));return r?n[n.indexOf(t)+e]:X.fromElement(n[n.indexOf(t.element)+e])}up(e,t,r){var n;const{owner:s}=this;return e?(n=s==null?void 0:s.closest)==null?void 0:n.call(s,e,t,r):s}closest(e,t,r){const n=typeof r,s=n==="number",a=n==="string";for(let l=this,o=1;l;l=l.owner,o++){if(X.widgetMatches(l,e,t))return l;if(s&&o>=r)return;if(a&&X.widgetMatches(l,r,t))return;if(l===r)return}}owns(e){if(e){if("eventPhase"in e&&(e=e.target),e.nodeType===Element.ELEMENT_NODE){if(this.element.contains(e))return!0;e=X.fromElement(e)}for(;e;){if(e===this)return!0;e=e.owner}}return!1}eachAncestor(e){let t=this.owner;for(;t;){if(e(t)===!1)return!1;t=t.owner}return!0}changeMaximizeOnMobile(e){const t=this;if(t.floating&&U.isMobile){const{initialConfig:r}=t;e?(t.centered=t.modal=!1,t.maximized=!0):(t.centered=r.modal,t.modal=r.centered,t.maximized=r.maximized)}}changeMonitorResize(e,t){const r=this.scaleToFitWidth?!1:!!e;if(r!==!!t)return r}updateMonitorResize(e){const t=this;Er(t,"onElementResize")||(t.onElementResize=t.onElementResize.bind(t)),Ee[e?"addResizeListener":"removeResizeListener"](t.element,t.onElementResize)}changeReadOnly(e){if(e=!!e,!!this._readOnly!==e)return e}updateReadOnly(e){var t;(t=this.element)==null||t.classList[e?"add":"remove"]("b-readonly"),this.isConfiguring||(this.eachWidget(r=>{r.ignoreParentReadOnly||("_originalReadOnly"in r||(r._originalReadOnly=r.config.readOnly||!1),r.readOnly=e||r._originalReadOnly)},!1),this.trigger("readOnly",{readOnly:e}))}eachWidget(e,t=!0){const r=this.childItems,n=(r==null?void 0:r.length)||0,s={};for(let a=0;a<n;a++){const l=r[a];if(s.down=t,e(l,s)===!1||s.down&&l.eachWidget&&l.eachWidget(e,t)===!1)return!1}return!0}queryAll(e){const t=[];return this.eachWidget(r=>{e(r)&&t.push(r)}),t}query(e){let t=null;return this.eachWidget(r=>{if(e(r))return t=r,!1}),t}getWidgetByRef(e){var t,r;return e instanceof X?e:((t=this==null?void 0:this.widgetMap)==null?void 0:t[e])||((r=this==null?void 0:this.owner)==null?void 0:r.getWidgetByRef(e))}onFocusIn(e){const t=this,{element:r}=t;t.containsFocus=!0,t.focusInEvent=e,(t.floating||t.positioned)&&t.toFront(),r.classList.add("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),r.contains(e._target)&&t.onInternalKeyDown&&!t.keyDownListenerRemover&&(t.keyDownListenerRemover=$.on({element:r,keydown:"onInternalKeyDown",thisObj:t})),t.trigger("focusin",e)}onFocusOut(e){const t=this;t.keyDownListenerRemover&&(t.keyDownListenerRemover(),t.keyDownListenerRemover=null),t.isDestroyed||(e.relatedTarget||t.revertFocus(!t.isVisible),t.containsFocus=!1,t.element.classList.remove("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),t.trigger("focusout",e))}captureFocus(){const e=this,t=D.getActiveElement(e),r=e.contains(t)&&e.captureFocusItem(t);return(n,s)=>{r&&!e.isDestroying&&(D.getActiveElement(e)!==t||s)&&r(n)}}captureFocusItem(e){return(t=!0)=>{this.contains(e)&&(t?e.focus():D.focusWithoutScrolling(e))}}contains(e,t){const{element:r}=this;if(e&&r)return e.isWidget&&(e=e.element),r.contains(e)&&(!t||r!==e)}revertFocus(e){var t;const r=this,n=D.getActiveElement(r);let s=(t=r.focusInEvent)==null?void 0:t.relatedTarget;(e||r.containsFocus&&(s==null?void 0:s.nodeType)===Element.ELEMENT_NODE&&r.element.contains(n))&&((!s||!D.isFocusable(s))&&(s=r.getFocusRevertTarget()),r._isRevertingFocus=!0,s&&D.isFocusable(s)?(s._isRevertingFocus=!0,D.focusWithoutScrolling(s),s._isRevertingFocus=!1):n==null||n.blur(),r._isRevertingFocus=!1)}getFocusRevertTarget(){var e;const t=this,{owner:r,focusInEvent:n}=t,s=n&&n.backwards?1:-1;let a=n&&n.relatedTarget;const l=a&&X.fromElement(a);if(r&&!r.isDestroyed&&(!a||!D.isFocusable(a)||l&&!l.isFocusable)){if(a=null,r.eachWidget){const o=[];if(r.eachWidget(u=>{(u===t||u.isFocusable)&&o.push(u)},!1),o.length>1){const u=o.indexOf(t);a=o[u+s]||o[u-s]}}!a&&r.isFocusable&&(a=r),a=a?a.focusElement:(e=r.getFocusRevertTarget)==null?void 0:e.call(r)}return a}getStaticWidgetClasses(e,t){const r=new J,n=this.$meta.hierarchy;let s,a,l,o,u;for(a=n.indexOf(e);a<n.length;++a)s=n[a],u=Reflect.getOwnPropertyDescriptor(s.prototype,"widgetClass"),u!=null&&u.get?o=u.get.call(this):(l=Er(s,"$$name")||Er(s,"$name")||Er(s,"_$name")?s.$$name:s.name,(l.length<3||l.includes("$"))&&console.warn(`Class "${l}" extending "${s.$name}" should have "$name" static getter with no less than 3 chars.`),o=`b-${l.toLowerCase()}`),o&&r.add(t?o+t:o);return r}get rootUiClass(){return X}get staticClassList(){const{$meta:e}=this;let t=e.staticClassList;return t||(e.staticClassList=t=this.getStaticWidgetClasses(X),U.isTouchDevice&&t.add("b-touch")),t}get uiClasses(){return this.getConfig("ui"),this._uiClasses}get uiClassList(){return this.getConfig("ui"),this._uiClassList}get widgetClassList(){const e=this,{cls:t,defaultCls:r,uiClasses:n}=e;let{staticClassList:s}=e;(r||t)&&(s=s.clone(),r&&s.assign(r),t&&s.assign(t));const a=s.values;return n&&a.push(...n),e.floating&&a.push("b-floating"),e.collapsify==="hide"&&a.push("b-collapsify-hide"),a}changeCls(e){return J.from(e)}updateCls(e,t){if(!this.isConfiguring&&!this.isComposable){const{element:r}=this;t&&x.getTruthyKeys(t).forEach(n=>r.classList.remove(n)),e.assignTo(r)}}changeContentElementCls(e){return J.from(e)}changeHtmlCls(e){return J.from(e)}changeDefaultCls(e){return J.from(e,!0)}changeUi(e){return J.from(e)}updateUi(e){let t=null,r,n;if(e){const s=this.getStaticWidgetClasses(this.rootUiClass);for(n in e)if(e[n])for(r in s)s[r]&&((t||(t=new J))[`${r}-ui-${n}`]=1)}this._uiClasses=t==null?void 0:t.values,this._uiClassList=t}fromCache(e,t=!1,r=this.element){if(!r)return null;const n=this;return n.cache[e]||(n.cache[e]=t?D.children(r,e):D.down(r,e)),n.cache[e]}emptyCache(){this.cache={}}changeMasked(e,t){var r;if(((r=this.masked)==null?void 0:r.type)!=="trial"){if((e===!0||e==="")&&(e="\xA0"),t&&!t.isDestroyed)typeof e=="string"?(t.text=e,e=t):e?(t.setConfig(e),e=t):t.destroy();else if(e){const n=X.resolveType("mask");e=n.mergeConfigs(this.maskDefaults,e),e.owner=this,e=n.mask(e)}return e||null}}onMaskAutoClose(e){e.isDestroyed&&e===this.masked&&(this.masked=null)}mask(e){return this.masked=e,this.masked}unmask(){this.masked=null}onInternalResize(e,t,r,n,s){this._width=e.offsetWidth,this._height=e.offsetHeight}onElementResize(e,t){var r;const n=this,{element:s}=n,a=(r=n._width)!=null?r:n._oldWidth,l=n._height,o=s.offsetWidth,u=s.offsetHeight;n.floating&&t&&n.onFloatingWidgetResize(...arguments),!n.suspendResizeMonitor&&(a!==o||l!==u)&&(n.onInternalResize(s,o,u,a,l),n.trigger("resize",{width:o,height:u,oldWidth:a,oldHeight:l}))}onFloatingWidgetResize(e,t,r){const n=this,{lastAlignSpec:s,constrainTo:a}=n;if(n.isVisible&&s&&s.target){const l=!t||r.height!==t.height,o=!t||r.width!==t.width,u=a&&!V.from(a).contains(V.from(n.element,null,!0));(l&&s.zone!==2||o&&s.zone!==1||u)&&n.requestAnimationFrame(()=>n.realign())}}updateScale(){const e=this,t=e.element,r=t.parentElement;e.configuredWidth||(e.configuredWidth=e.width),t.style.display="none";const n=V.client(r),s=n.width/e.configuredWidth,a=e.scale=e.allowGrowWidth?Math.min(s,1):s;t.style.transform=`scale(${a})`,t.style.transformOrigin="top left",t.style.display="",e.allowGrowWidth&&s>1&&(e.width=e.configuredWidth*s)}onParentElementResize(e){this.updateScale()}parseTRBL(e,t="px"){if(e=e||0,typeof e=="number")return[`${e}${t}`,`${e}${t}`,`${e}${t}`,`${e}${t}`];const r=e.split(" "),n=r.length;return n===1?r[1]=r[2]=r[3]=r[0]:n===2?(r[2]=r[0],r[3]=r[1]):n===3&&(r[3]=r[1]),[isFinite(r[0])?`${r[0]}${t}`:r[0],isFinite(r[1])?`${r[1]}${t}`:r[2],isFinite(r[2])?`${r[2]}${t}`:r[3],isFinite(r[3])?`${r[3]}${t}`:r[4]]}get documentRoot(){var e;return((e=this.owner)==null?void 0:e.documentRoot)||this.element.getRootNode()}get eventRoot(){var e,t;return(e=this.element)!=null&&e.isConnected?D.getRootElement(this.element):((t=this.owner)==null?void 0:t.eventRoot)||this._rootElement}get rootElement(){var e,t;const r=this;if(!r._rootElement){let n=((e=r.owner)==null?void 0:e.rootElement)||D.getRootElement(r.forElement||((t=r.element)!=null&&t.isConnected?r.element:r.getRenderContext()[0]||r.element));n||(n=document.body),r._rootElement=n}return r._rootElement}get floatRoot(){var e;const t=this,{rootElement:r}=t;let{floatRoot:n}=r;if(n)r.contains(n)||r.appendChild(n);else{const{outerCls:s}=X,a=(e=D.getThemeInfo(null,r))==null?void 0:e.name;if(!D.isValidFloatRootParent(r))throw new Error("Attaching float root to wrong root");a&&s.push(`b-theme-${a.toLowerCase()}`),n=r.floatRoot=D.createElement({className:`b-float-root ${s.join(" ")}`,parent:r}),Vn.push(n),U.isAndroid&&(n.style.height=`${screen.height}px`,$.on({element:globalThis,orientationchange:()=>n.style.height=`${screen.height}px`,thisObj:this})),Me.ion({theme:({theme:l,prev:o})=>{n.classList.add(`b-theme-${l.toLowerCase()}`),n.classList.remove(`b-theme-${o.toLowerCase()}`)}})}return n}get floatRootMaxZIndex(){let e=1;return Array.from(this.floatRoot.children).forEach(t=>{const r=parseInt(getComputedStyle(t).zIndex||0,10);r>e&&(e=r)}),e}static resetFloatRootScroll(){Vn.forEach(e=>e.scrollTop=e.scrollLeft=0)}static get floatRoots(){return Vn}static removeFloatRoot(e){Vn.splice(Vn.indexOf(e),1)}static get outerCls(){const e=["b-outer"],{platform:t}=U;return t&&e.push(`b-${t}`),U.isTouchDevice&&e.push("b-touch-events"),U.isMobile&&e.push("b-mobile"),D.scrollBarWidth?e.push("b-visible-scrollbar"):e.push("b-overlay-scrollbar"),U.isChrome?e.push("b-chrome"):U.isSafari?e.push("b-safari"):U.isFirefox&&e.push("b-firefox"),U.isPhone&&e.push("b-phone"),globalThis.ResizeObserver||e.push("b-no-resizeobserver"),e}get isAnimating(){return this._isAnimatingCounter>0}set isAnimating(e){const t=this,{_isAnimatingCounter:r}=t;t._isAnimatingCounter=Math.max(0,r+(e?1:-1)),r===0&&e?(t.element.classList.add("b-animating"),t.trigger("animationStart")):r===1&&!e&&(t.element.classList.remove("b-animating"),t.trigger("animationEnd"))}async waitForAnimations(){this.isAnimating&&await this.await("animationend",{checkLog:!1})}static query(e,t=!1){const{idMap:r}=X.identifiable;for(const n in r)if(X.widgetMatches(r[n],e,t))return r[n];return null}static queryAll(e,t=!1){const{idMap:r}=X.identifiable,n=[];for(const s in r)X.widgetMatches(r[s],e,t)&&n.push(r[s]);return n}static fromElement(e,t,r){const n=typeof t;e&&!e.nodeType&&(e=e.target),(n==="number"||t&&t.nodeType===Element.ELEMENT_NODE)&&(r=t,t=null);let s=e,a=0,l,o,u;for(typeof r!="number"&&(l=r,r=Number.MAX_VALUE),n==="string"&&(t=t.toLowerCase());s&&s.nodeType===Element.ELEMENT_NODE&&a<r&&s!==l;){if(o=s.dataset&&s.dataset.ownerCmp||s.id,o){if(u=X.getById(o),u)if(t){if(n==="function"){if(t(u))return u}else if(X.widgetMatches(u,t,!0))return u}else return u;a++}s=s.parentNode}return null}static fromSelector(e){const t=document.querySelector(e);return t?X.fromElement(t):null}triggerFieldChange(e,t=!0){var r;t&&this.trigger("change",e),(r=this.eachAncestor)==null||r.call(this,n=>{var s,a;if((s=n.onFieldChange)==null||s.call(n,e),(a=n.isolateFieldChange)!=null&&a.call(n,this))return!1})}isolateFieldChange(e){return this.isolateFields}setupFocusListeners(){Me.setupFocusListenersOnce(this.eventRoot,$)}static widgetMatches(e,t,r){return t==="*"?!0:typeof t=="function"?t(e):X.isType(e,t,r)}static attachTooltip(e,t){return typeof t=="string"&&(t={html:t}),X.create(Object.assign({forElement:e},t),"tooltip"),e}changeDock(e){return e==="start"?"left":e==="end"?"right":e}updateRtl(e){super.updateRtl(e),this.eachWidget(t=>{"rtl"in t.initialConfig||(t.rtl=e)})}},zy=j.prototype;["compose","domSyncCallback"].forEach(i=>zy[i].$nullFn=!0),j.initClass(),j.register("mask",xr),D.Widget=j,Me.Widget=j,xr.identifiable.idMap=j.identifiable.idMap,Object.assign(globalThis.bryntum||(globalThis.bryntum={}),{get:j.getById.bind(j),query:j.query,queryAll:j.queryAll,fromElement:j.fromElement,fromSelector:j.fromSelector}),j._$name="Widget";var gt=class extends F.mixin(fe,Et){get contentElement(){var i;return(i=this.owner)==null?void 0:i.contentElement}onChildAdd(i){}onChildRemove(i){}renderChildren(){const i=this,{owner:e,itemCls:t}=i,{contentElement:r,items:n}=e,s=e.itemCls,a=n==null?void 0:n.length;if(a){e.textContent=!1;for(let l=0;l<a;l++){const o=n[l],{element:u}=o,{classList:c}=u;u.dataset.itemIndex=l,c.contains("b-outer")&&c.remove(...j.outerCls),t&&c.add(t),s&&c.add(s),o.render(r,!!e.isPainted)}}i.syncPendingConfigs(),i.syncChildCount()}removeChild(i){const e=this,{element:t}=i,{owner:r,itemCls:n}=e,{contentElement:s}=r,a=r.itemCls;s.contains(t)&&t.remove(),delete t.dataset.itemIndex,n&&t.classList.remove(n),a&&t.classList.remove(a),e.fixChildIndices(),e.syncChildCount()}appendChild(i){const{element:e}=i,{owner:t,itemCls:r}=this,{contentElement:n}=t,s=t.itemCls;e.dataset.itemIndex=t.indexOfChild(i),t.textContent=!1,r&&e.classList.add(r),s&&e.classList.add(s),i.render(n,!!t.isPainted),this.syncChildCount()}insertChild(i,e){const t=this,{element:r}=i,{owner:n,itemCls:s}=t,{contentElement:a}=n,l=D.getChild(a,`[data-item-index="${e}"]`),o=n.itemCls;n.textContent=!1,s&&r.classList.add(s),o&&r.classList.add(o),a.insertBefore(r,l),i.render(null,!!n.isPainted),t.fixChildIndices(),t.syncChildCount()}fixChildIndices(){this.owner.items.forEach((i,e)=>{i.element.dataset.itemIndex=e})}syncChildCount(){var i;const{owner:e}=this,{length:t}=e.items;(i=e.contentElement)==null||i.classList[t===1?"add":"remove"]("b-single-child")}syncConfigLater(i){const e=this.pendingConfigs||(this.pendingConfigs=[]);e.includes(i)||e.push(i)}syncConfigStyle({name:i,style:e,classes:t,map:r}){const n=this,s=`b-box-${i}-`,{contentElement:a}=n,l=n[i];let o=(r==null?void 0:r[l])||l;if(a){if(t){const{classList:u}=a;t.forEach(c=>{c!==o&&u.remove(s+c)}),t.includes(o)&&(u.add(s+o),o="")}a.style[e]=o}else n.syncConfigLater(i)}syncPendingConfigs(){const i=this,{pendingConfigs:e}=i;let t;if(e)for(i.pendingConfigs=null;t=e.pop();)i[i.$meta.configs[t].updater](i[t])}};y(gt,"type","default"),y(gt,"configurable",{owner:null,containerCls:"b-auto-container",itemCls:null}),y(gt,"factoryable",{defaultType:"default"}),gt.initClass(),gt._$name="Layout";var Nh=0,Wy=i=>i.ripple,jn=class extends j{static get defaultConfig(){return{old_element:{children:[{className:"b-ripple-inner",reference:"rippleElement"}]},element:{children:[{tag:"svg",class:"b-ripple-inner",reference:"rippleElement",ns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 100 100",children:[{reference:"circleElement",tag:"circle",cx:"0",cy:"0",r:10}]}]},floating:!0,hideAnimation:!1,showAnimation:!1,scrollAction:"realign",color:"rgba(0,0,0,.3)",startRadius:10,radius:100}}afterConstruct(){super.afterConstruct(),$.on({element:this.rootElement,mousedown:"onRippleControllingEvent",thisObj:this,capture:!0,once:!0})}onRippleControllingEvent(i){var e;const t=this;t.show();const r=D.getStyleValue(t.circleElement,"animationName");t.hide(),(e=t.listenerDetacher)==null||e.call(t),r&&r!=="none"&&(t.listenerDetacher=$.on({mousedown:{element:t.rootElement,capture:!0,handler:"onMousedown"},touchstart:{element:t.rootElement,capture:!0,handler:"onTouchStart"},animationend:{element:t.circleElement,handler:"onAnimationEnd"},thisObj:t}),i.type==="mousedown"&&(t.onMousedown(i),Me.ion({theme:"onRippleControllingEvent",thisObj:this})))}onTouchStart(i){Nh=performance.now(),this.handleTriggerEvent(i)}onMousedown(i){performance.now()-Nh>200&&this.handleTriggerEvent(i)}handleTriggerEvent(i){const e=j.fromElement(i.target,Wy);if(e){const t=e.ripple,r=t.delegate?i.target.closest(t.delegate):e.focusElement||e.element;if(r){const n=x.assign({event:i,target:r,radius:this.radius},t);if(typeof n.clip=="string"&&(n.clip=e[n.clip]||i.target.closest(n.clip),!n.clip))return;this.ripple(n)}}}ripple({event:i,point:e=$.getClientPoint(i),target:t=i.target,clip:r=t,radius:n=this.radius,color:s=this.color}){this.clip=r,r=V.from(r,null,!0);const a=this,l=r.getDelta(e),o=a.rippleElement.style,u=a.circleElement,c=D.getStyleValue(t,"border-radius");a.hide(),o.transform=`translateX(${l[0]}px) translateY(${l[1]}px)`,o.height=o.width=`${n}px`,a.element.style.borderRadius=c,u.setAttribute("r",n),u.setAttribute("fill",s),a.showBy({target:r,align:"c-c",matchSize:!0})}onAnimationEnd(i){i.animationName==="b-ripple-expand"&&this.hide()}};y(jn,"$name","Ripple"),y(jn,"type","ripple"),j.RippleClass=jn,jn._$name="Ripple";var Hy=Object.freeze({}),{isArray:hi}=Array,Yy=i=>i.weight,Bh=({weight:i},{weight:e})=>typeof i=="string"||typeof e=="string"?String(i).localeCompare(String(e)):(i!=null?i:Number.MAX_SAFE_INTEGER)-(e!=null?e:Number.MAX_SAFE_INTEGER),Vh=i=>i&&!i.hidden,Uy=["display","flex-direction"],qy={default:1,box:1},Be=class extends j{static get configurable(){return{items:null,lazyItems:{$config:["lazy"],value:null},defaults:null,defaultType:"widget",layoutStyle:null,itemCls:null,layout:{type:"default"},namedItems:null,overflowable:{value:null,default:!1,$config:null},textContent:!0,record:null,strictRecordMapping:null,autoUpdateRecord:null,autoUpdateFields:null,hideWhenEmpty:null,contentElMutationObserver:{$config:["lazy","nullify"],value:!0},isolateFields:!1,focusDescendant:!1,defaultBindProperty:null,defaultFocus:null}}static get prototypeProperties(){return{flexRowCls:"b-flex-row",flexColCls:"b-flex-column",initialItems:!0}}startConfigure(i){const e=i.items||i.lazyItems;(this.hasItems=!!(e&&(hi(e)?e:Object.keys(e)).length))||(this.initialItems=!1),super.startConfigure(i)}get firstItem(){return this.getAt(0)}get lastItem(){return this.getAt(-1)}getAt(i){return this.ensureItems().at(i)}remove(...i){let e=!0;i.length===1&&(hi(i[0])?i=i[0]:e=!1);const t=this,{_items:r}=t,n=[];for(let s=0;s<i.length;s++){const a=i[s];r.includes(a)&&(r.remove(a),t.layout.removeChild(a),n.push(a),t.onChildRemove(a))}return e?n:n[0]}removeAll(){return this.remove(this.items)}add(...i){const e=this,t=e.ensureItems(),r=[];let n=!0,s,a,l;for(i.length===1&&(hi(i[0])?i=i[0]:n=!1),a=0;a<i.length;a++)s=i[a],s.isWidget?s.parent=e:s=e.createWidget(s),(s==null?void 0:s.weight)!=null?(l=z.findInsertionIndex(s,t.values,Bh),r.push(e.insert(s,l))):s&&(t.includes(s)||(t.add(s),e.onChildAdd(s),e.layout.appendChild(s),r.push(s)));return n?r:r[0]}ensureItems(){const i=this;return i.getConfig("items"),i.getConfig("lazyItems"),i._items||(i.items=[]),i._items}insert(i,e){const t=this,r=t.ensureItems();i instanceof j?i.parent=t:i=t.createWidget(i),r.includes(e)&&(e=t.indexOfChild(e)),e=Math.min(e,r.count);const n=r.values;return n.splice(e,0,i),r.values=n,t.onChildAdd(i),t.layout.insertChild(i,e),i}indexOfChild(i){return this.items.indexOf(i)}changeLazyItems(i){this.items=i,this.layout.renderChildren()}changeItems(i,e){const t=this,r=[],n=new Fn;return hi(i)?t.processItemsArray(i,r):i&&t.processItemsObject(i,t.namedItems,r),r.some(Yy)&&r.sort(Bh),n.add(r),e&&e.forEach(s=>{t.remove(s),!n.includes(s)&&s._createdBy===t&&s.destroy()}),n}afterConstruct(){const{rtl:i}=this,{classList:e}=this.contentElement;e.toggle("b-rtl",i===!0),e.toggle("b-ltr",i===!1)}updateRtl(i){super.updateRtl(i);const{contentElement:e}=this;e&&(e.classList.toggle("b-rtl",i===!0),e.classList.toggle("b-ltr",i===!1))}updateItems(i,e){let t=0;i.forEach(r=>{this.onChildAdd(r),e&&!e.temporary&&this.layout.insertChild(r,t),++t}),this.initialItems=!1}updateHideWhenEmpty(){this.syncChildCount(this.rendered)}get items(){const i=this;if(i.getConfig("lazyItems"),!i._items){if(i.initializingItems)return[];i._items=new Fn,i._items.temporary=!0}return i._items.values}processItemsArray(i,e){const t=i.length;let r,n;for(r=0;r<t;r++)n=i[r],n instanceof j?(n.parent=this,n.element.classList.remove(...j.outerCls)):n=this.createWidget(n),n&&((n.ref||n.id)&&this.addDescendant(n),e.push(n))}processItemsObject(i,e,t){let r,n;for(n in i)r=i[n],r&&(e&&n in e&&(r=typeof r=="object"?x.merge(x.clone(e[n]),r):e[n]),r&&(r instanceof j?r.parent=this:(r instanceof Object&&(r.ref=n),r=this.createWidget(r)),r&&(r.ref=n,this.addDescendant(r),t.push(r))))}onChildAdd(i){if(i.innerItem&&this.readOnly&&!i.ignoreParentReadOnly&&(i.readOnly=!0),this.onChildAddLayout(i),i.ref||i.id)for(let e=this;e;e=e.parent)e.addDescendant(i);this.syncChildCount(!0)}onChildAddLayout(i){i.innerItem&&this.layout.onChildAdd(i)}onChildHide(i){var e;super.onChildHide(i),(e=this._items)!=null&&e.includes(i)&&this.syncChildCount(!0)}onChildShow(i){var e;super.onChildShow(i),(e=this._items)!=null&&e.includes(i)&&this.syncChildCount(!0)}syncChildCount(i){if(!this.isConfiguring){const e=this,{items:t,hasItems:r}=e,n=t.filter(Vh),{length:s}=n;if(e.visibleChildCount=s,e.hideWhenEmpty&&i){const a=!s;!!e._hidden!==a&&(e.hidden=a)}t.forEach(a=>a.element.classList.remove("b-last-visible-child","b-first-visible-child")),s&&(n[0].element.classList.add("b-first-visible-child"),n[s-1].element.classList.add("b-last-visible-child")),e.hasItems=!!e.childItems.length,e.contentElement.classList[s?"remove":"add"]("b-no-visible-children"),e.isComposable?r!==e.hasItems&&e.recompose():e.updateTextContent(e._textContent)}}syncFlexDirection(){const i=this,{contentElement:e,flexColCls:t,flexRowCls:r}=i,n=new J(e.className),s=D.getStyleValue(e,Uy);n[r]=n[t]=0,s.display==="flex"&&(n[s["flex-direction"]==="row"?r:t]=1),D.syncClassList(e,n)}addDescendant(i){const e=i.ref||i.id,t=this._widgetMap||(this._widgetMap={});t[e]||(t[e]=i)}onChildRemove(i){const e=this,t=i.ref||i.id;if(t)for(let r=e;r;r=r.parent)r.widgetMap[t]===i&&delete r.widgetMap[t];e.layout.onChildRemove(i),e.syncChildCount(!0)}get widgetMap(){return this._widgetMap||(this._widgetMap={}),this.initializingItems||this.getConfig("items"),this._widgetMap}changeRecord(i){return this._record=i==null?Hy:null,i}updateRecord(i){var e;const t=this;(e=t.recordUpdateDetacher)==null||e.call(t),t.trigger("beforeSetRecord",{record:i}),t.setValues(i,{onlyName:t.strictRecordMapping,highlight:!!t.$highlight}),t.autoUpdateFields&&(i!=null&&i.firstStore)&&(t.recordUpdateDetacher=i.firstStore.ion({update:t.onRecordUpdated,thisObj:t}))}setRecord(i,e){this.$highlight=e,this.record=i,this.$highlight=!1}onRecordUpdated({record:i}){i===this.record&&this.setValues(this.record,!0,!0)}onFieldChange({source:i,userAction:e}){if(this.autoUpdateRecord&&e){const{record:t,strictRecordMapping:r}=this,{name:n,ref:s,isValid:a=!0,value:l}=i,o=r?n:n||s;t&&o&&a&&(t.isModel?t.setValue(o,l):t[o]=l)}}getValues(i){const e={};return this.eachWidget((t,r)=>{t.isolateFields?r.down=!1:"name"in t&&(!i||i(t))&&(e[t.name]=t.value)},!0),e}get values(){const i={};return this.gatherValue(i),i}set values(i){this.assignValue(i)}get isSettingValues(){return!!this.assigningValues}get assigningValues(){var i;return this._assigningValues||((i=this.parent)==null?void 0:i.assigningValues)}set assigningValues(i){this._assigningValues=i}assignValue(i,e){super.assignValue(i,e),this.isolateFields||this.setValues(i,e)}gatherValue(i){super.gatherValue(i),this.isolateFields||this.gatherValues(i)}setValues(i,e=this.assignValueDefaults){this.assigningValues=e,this.eachWidget(t=>t.assignValue(i,e),!1),this.assigningValues=!1}get hasNoChildren(){const i=this,{items:e,lazyItems:t}=i.initialConfig,r=e&&(hi(e)?e:x.values(e)),n=t&&(hi(t)?t:x.values(t)),s=i.isConfiguring?n||r:i.items;return!(s!=null&&s.filter(Vh).length)}afterRecompose(){super.afterRecompose(),this.realign()}updateTextContent(i){const e=this;if(!e.isComposable){const t=!!(i&&e.hasNoChildren),{classList:r}=e.contentElement;t!==r.contains("b-text-content")&&(r[t?"add":"remove"]("b-text-content"),e.rendered&&e.realign())}}updateLayoutStyle(i){D.applyStyle(this.contentElement,i)}updateElement(i){if(super.updateElement(...arguments),i){const{classList:e}=this.contentElement,{containerCls:t}=this.layout;e.add("b-content-element"),t&&e.add(t)}}onInternalPaint(){var i;(i=super.onInternalPaint)==null||i.call(this,...arguments),this.getConfig("contentElMutationObserver")}changeContentElMutationObserver(i,e){if(e&&(e.takeRecords(),e.disconnect()),i){const t=this,{element:r,contentElement:n}=t;i=new MutationObserver(s=>t.onContentElMutation(s)),i.observe(n,{attributes:!0}),n!==r&&i.observe(r,{attributes:!0}),t.syncFlexDirection()}return i}onContentElMutation(i){qy[this.layout.type]&&this.isVisible&&i.some(e=>this.contentElement.contains(e.target))&&this.syncFlexDirection()}changeLayout(i,e){return gt.reconfigure(e,i,{owner:this,defaults:{owner:this}})}get childItems(){return this.items}getWidgetById(i){return this.widgetMap[i]}processWidgetConfig(i){}setupWidgetConfig(i,e){const t=this;typeof i=="string"?i={html:i}:i.nodeType===Element.ELEMENT_NODE&&(i={element:i,id:i.id}),(typeof e=="string"||!e&&(e=i.type))&&(e==="checkbox"&&U.isMobile&&j.resolveType("slidetoggle",!0)&&(e=i.type="slidetoggle"),e=j.resolveType(e,!0)),i=(e||j).mergeConfigs(t.defaults,i,{parent:t});for(let r=i.parent;r;r=r.parent)if(r.processWidgetConfig(i)===!1)return null;return t.trigger("beforeWidgetCreate",{widgetConfig:i})===!1?null:i}createWidget(i){const e=j.create(this.setupWidgetConfig(i),this.defaultType);return e&&(e._createdBy=this),e}updateDefaults(i,e){if(!this.isConfiguring&&i){const t=Object.entries(i);this.eachWidget(r=>{t.forEach(([n,s])=>{(!e||r[n]===e[n])&&(r[n]=s)})},!1)}}render(){this.getConfig("lazyItems"),this.layout.renderChildren(),this.syncChildCount(),super.render(...arguments)}get focusElement(){const i=this.query(this.defaultFocus||(e=>{var t;return e.isFocusable&&e.ref!=="close"&&!((t=e.ref)!=null&&t.endsWith("collapse"))}));return i?i.focusElement:super.focusElement}doDestroy(){var i;(i=this._items)==null||i.forEach(e=>{var t;return(t=e.destroy)==null?void 0:t.call(e)}),this.layout.destroy(),super.doDestroy()}get isValid(){let i=!0;return this.eachWidget(e=>{e.isVisible&&"isValid"in e&&!e.isValid&&(i=!1)},!0),i}};y(Be,"$name","Container"),y(Be,"type","container"),Be.initClass(),Be._$name="Container";var{assign:zn}=x,jh=()=>performance.now(),Ky={start:!1},Gy=/^[.\d]+([^\d].*)?$/,zh=i=>{const e=i.$bryntum||(i.$bryntum={});return e.transitions||(e.transitions=Object.create(null))},Wh=(i,e)=>{var t;return typeof i=="string"&&(e=(t=Gy.exec(i))==null?void 0:t[1],i=parseFloat(i)),i&&i*(e==="s"||!e&&i<10?1e3:1)},yo=i=>{const e=x.values(zh(i)).filter(t=>t.completed==null).map(t=>t.toString());i.style.transition=e.join(", ")},Hh=i=>class extends i{static get prototypeProperties(){return{_delay:null,_duration:null,_retain:null,_timing:null,_unit:null,owner:null,reverting:null}}constructor(...t){super(...t),this.id=++Xy}start(){this.startTime=jh()}get delay(){var t,r,n;return Wh((n=(r=this._delay)!=null?r:(t=this.owner)==null?void 0:t.delay)!=null?n:0,this.unit)}set delay(t){this._delay=t}get duration(){var t;const{owner:r,unit:n}=this;return Wh((t=this._duration)!=null?t:r?r.duration:Ae.defaultDuration,n)}set duration(t){this._duration=t}get elapsed(){return jh()-this.startTime}get remaining(){return this.duration-this.elapsed}get retain(){var t,r;return(r=this._retain)!=null?r:(t=this.owner)==null?void 0:t.retain}set retain(t){this._retain=t}get timing(){var t,r;return(r=this._timing)!=null?r:(t=this.owner)==null?void 0:t.timing}set timing(t){this._timing=t}get unit(){var t,r;return(r=this._unit)!=null?r:(t=this.owner)==null?void 0:t.unit}set unit(t){this._unit=t}},Xy=0,bo=class pm extends F.mixin(Hh){static get $name(){return"AnimatorTransition"}static get prototypeProperties(){return{element:null,property:null,from:null,to:null,completed:null,promissory:null,reverting:null}}afterConstruct(){super.afterConstruct();const e=this,{element:t,transitions:r}=e;let{property:n}=e;[n,e.to]=D.unitize(n,e.to),e.from=D.unitize(n,e.from)[1],e.promissory=new pa,e.property=n;const s=r[n];r[n]=e;let{from:a}=e;s&&(e.from=s.to,a=null,s.destroy()),a===null&&(a=e.getCurrentStyleValue(),s||(e.from=a)),t.style[n]=a,e.getCurrentStyleValue()}doDestroy(){const e=this;e.finish(!1),e.completed&&!e.retain&&e.clearStyle(),super.doDestroy()}get promise(){var e;return(e=this.promissory)==null?void 0:e.promise}get transitions(){return zh(this.element)}clearStyle(){this.setStyle("")}finish(e){const t=this,{transitions:r,promissory:n,property:s}=t;n&&(t.completed=e,t.promissory=null,n.resolve(e),r[s]===t?(delete r[s],e||(yo(t.element),t.clearStyle())):t.completed=!1)}getCurrentStyleValue(){return D.getStyleValue(this.element,this.property)}revert(){const{duration:e,elapsed:t,element:r,from:n,property:s,_retain:a,_timing:l}=this;return new pm({element:r,property:s,retain:a,timing:l,duration:Math.round(Math.min(e,t)),reverting:this,to:n,unit:"ms"})}setStyle(e){this.element.style[this.property]=e}start(){const e=this,{delay:t,duration:r,element:n,property:s}=e;$.onTransitionEnd({element:n,property:s,duration:t+r+20,thisObj:e.owner,handler:()=>{var a;return(a=e.finish)==null?void 0:a.call(e,!0)}}),super.start(),e.setStyle(e.to)}toString(){const{delay:e,duration:t,property:r,timing:n}=this;return`${r} ${t}ms ${n||"ease-in-out"}${e?` ${e}ms`:""}`}};bo.initClass();var Ae=class at extends F.mixin(Hh){static get $name(){return"Animator"}static get prototypeProperties(){return{element:null,finalize:null,prefinalize:null,completed:null,items:null}}static register(e,t){if(x.isObject(e)){x.entries(e).forEach(r=>at.register(...r));return}at.fx[e]=t,at[e]=r=>(D.isElement(r)?r={element:r,[e]:{}}:(r={element:r.element,[e]:r},delete r[e].element),at.run(r))}static run(e){return new at(e).start()}constructor(e){var t;super(null);const r=this,n=[],s={};let a,l,o,u;if(Array.isArray(e))r.items=e;else for(o in e)(at.specialPropsRe.test(o)?r:s)[o]=e[o];x.keys(s).forEach(c=>{u=s[c],u!=null&&u!==!1&&u===u&&((l=at.fx[c])?(u=zn(r.defaults,l(u,r,c)),u.owner=r,a=new at(u)):(u=zn(r.defaults,typeof u=="object"?u:{to:u}),u.owner=r,u.property=c,a=new bo(u)),n.push(a))}),(t=r.items)==null||t.forEach(c=>{x.isInstantiated(c)?c.owner=r:(c=zn(r.defaults,c),c.owner=r,c=new at(c)),n.push(c)}),r.items=n,r.promise=(n.length===1?n[0].promise:Promise.all(n.map(c=>c.promise))).then(c=>{var d;return(d=r.finish)==null||d.call(r,c),r.completed||!1})}doDestroy(){this.items.forEach(e=>e.destroy()),super.doDestroy()}get defaults(){return{element:this.element}}get retain(){const{_retain:e,finalize:t,owner:r}=this;return e!=null?e:t?!1:r?r.retain:!0}set retain(e){super.retain=e}done(){return this.promise}finish(e){var t,r;const n=this,{items:s}=n;for(yo(n.element),n.completed=typeof e=="boolean"?e:!e.some(a=>!a),(t=n.prefinalize)==null||t.call(n,n.completed,n);s.length;)s.pop().destroy();(r=n.finalize)==null||r.call(n,n.completed,n)}revert(e){var t;const r=this,{reverting:n}=r,s=!e||((t=e.start)!=null?t:!0);let a=r.defaults;return n&&(n.finalize&&(a.finalize=n.finalize),n.prefinalize&&(a.prefinalize=n.prefinalize),a.retain=n._retain),a=zn(a,e,{items:r.items.map(l=>l.revert(Ky)),reverting:r}),a=new at(a),s&&a.start(),a}start(){const{element:e,items:t}=this;return super.start(),t.length&&(yo(e),t.forEach(r=>r.start())),this}};Ae.initClass().Transition=bo,Ae.specialPropsRe=new RegExp(`^(?:${Object.keys(Ae.prototypeProperties).concat(Object.keys(Ae.superclass.prototypeProperties)).map(i=>i[0]==="_"?i.substr(1):i).join("|")})$`),Ae.defaultDuration=200,Ae.fx={},Ae.register({puff(i){return i===!0?i={}:typeof i!="object"?i={transform:`scale(${i})`}:i.scale&&(i=x.clone(i),i.transform=`scale(${i.scale})`,delete i.scale),zn({opacity:0,transform:"scale(8)"},i)}}),Ae._$name="Animator";var ba=class extends F.mixin(xe){static get configurable(){return{element:null,delegate:null,delay:500,startRate:2,endRate:20,accelerateDuration:4e3,pressedCls:"b-pressed"}}doDestroy(){var i;(i=this.mousedownRemover)==null||i.call(this),this.cancel(),super.doDestroy()}cancel(){var i,e,t;const r=this;(i=r.activeElement)==null||i.classList.remove(r.pressedCls),r.activeElement=null,(e=r.acceleration)==null||e.cancel(),r.activeListenerRemover=(t=r.activeListenerRemover)==null?void 0:t.call(r),r.clearTimeout(r.autoRepeatTimer),r.clearTimeout(r.repeatTimer)}updateElement(i){var e;(e=this.mousedownRemover)==null||e.call(this),this.mousedownRemover=$.on({element:i,mousedown:"onMouseDown",thisObj:this})}onMouseDown(i){const e=this,t=e.delegate?i.target.closest(e.delegate):e.element;e.cancel(),t&&(e.activeElement=t,e.triggerEvent=i,t.classList.add(e.pressedCls),e.activeListenerRemover=$.on({mouseup:{element:document,capture:!0,handler:"onMouseUp"},mousemove:{element:t,handler:"onTargetMouseMove"},mouseleave:{element:t,handler:"onTargetMouseLeave"},mouseenter:{element:t,handler:"onTargetMouseEnter"},thisObj:e}),e.autoRepeatTimer=e.setTimeout("startAutoRepeat",e.delay))}onMouseUp(){this.cancel()}onTargetMouseLeave(){this.activeElement.classList.remove(this.pressedCls),this.clearTimeout(this.repeatTimer)}onTargetMouseEnter(i){const e=this;i.buttons?(e.activeElement.classList.add(e.pressedCls),e.triggerEvent=i,e.fireClick()):e.cancel()}onTargetMouseMove(i){this.triggerEvent=i}startAutoRepeat(){const i=this;i.interval=i.startInterval=1e3/i.startRate,i.accelerationDelta=i.startInterval-1e3/i.endRate,i.fireClick(),i.acceleration=ue.animate(i.accelerateDuration,i.nextTick,i,"easeOutQuad")}nextTick(i){this.interval=this.startInterval-this.accelerationDelta*i}fireClick(){const i=this,e=new MouseEvent("click",i.triggerEvent);i.triggerEvent.target.dispatchEvent(e),i.repeatTimer=i.setTimeout(i.fireClick,i.interval)}};ba._$name="ClickRepeater";var Zy=/^(?:undefined|null|LEFT|RIGHT)$/,Jy={TOP:"BOTTOM",RIGHT:"LEFT",BOTTOM:"TOP",LEFT:"RIGHT"},Yh=i=>{const e=i==null?void 0:i.toUpperCase();return[e,e==="LEFT"||e==="RIGHT"]},Ca=i=>{var e;return e=class extends(i||F){static get configurable(){return{rotate:null,invertRotate:null}}compose(){const{rotate:t}=this;return{class:{[`b-rotate-${(t||"").toLowerCase()}`]:t,"b-rotate-vertical":t}}}syncRotationToDock(t){if(Zy.test(String(this.rotate))){const[r,n]=Yh(t);this.rotate=n?this.invertRotate?Jy[r]:r:null}}get widgetClass(){return null}},y(e,"$name","Rotatable"),e},kr=class extends j.mixin(Ca){compose(){const{align:i,href:e}=this;return{tag:e!=null?"a":"button",class:{[`b-align-${i||"end"}`]:1,"b-icon":1},listeners:{click:"onInternalClick"}}}get focusElement(){return this.element}get panel(){var i,e;if((i=this.parent)!=null&&i.isPanel&&((e=this.element)!=null&&e.parentNode.matches(".b-panel-header")))return this.parent}changeAlign(i){return i}onInternalClick(i){const e=this,{handler:t,panel:r}=e,n={domEvent:i,tool:e};e.disabled||(e.trigger("click",n),e.isDestroyed||(e.trigger("action",n),!e.isDestroyed&&(r==null?void 0:r.trigger("toolClick",n))!==!1&&t&&e.callback(t,r,[i,r,e])))}onInternalKeyDown(i){(i.key.trim()||i.code)==="Enter"&&(i.cancelBubble=!0,i.stopPropagation())}updateDisabled(i,e){var t;super.updateDisabled(i,e),i&&((t=this.repeat)==null||t.cancel())}changeRepeat(i,e){return e==null||e.destroy(),i&&ba.new({element:this.element},i)}};y(kr,"$name","Tool"),y(kr,"type","tool"),y(kr,"configurable",{align:{value:null,$config:{merge:"replace"}},href:null,repeat:null,defaultBindProperty:null}),kr.initClass(),kr._$name="Tool";var Qy=/right/i,eb=i=>(i.collapsed||i.collapsing)&&i.owner.expandedHeaderDock==="top"&&i.owner.collapsible.direction.match(Qy)?"start":"end",Wn=class extends kr{static get configurable(){return{autoAlign:!0,collapsed:null,collapsing:null,collapsify:!1,direction:"up",defaultBindProperty:null}}compose(){const{collapsed:i,direction:e}=this;return{class:{[`b-icon-collapse-${e}`]:1,"b-collapsed":i}}}changeAutoAlign(i){return i===!0?eb:i}syncAutoAlign(){const{autoAlign:i}=this;i&&(this.align=i(this))}updateAutoAlign(){this.syncAutoAlign()}updateCollapsed(){this.syncAutoAlign()}updateCollapsing(){this.syncAutoAlign()}updateDirection(){this.syncAutoAlign()}};y(Wn,"$name","CollapseTool"),y(Wn,"type","collapsetool"),Wn.initClass(),Wn._$name="CollapseTool";var Uh=/^(?:UP|DOWN|LEFT|RIGHT)$/,tb=/^(left|top)$/i,rb={},qh=/^b-dock-(top|left|right|bottom)$/,Co="b-panel-collapse-revealer",ib=/^(?:left|right)$/i,Sa="b-collapse-unflex",{round:Xt}=Math,Kh=["up","down","left","right"].reduce((i,e)=>(i[e.toUpperCase()]=i[e]=e,i),{}),So={top:["top","bottom"],right:["right","left"],bottom:["bottom","top"],left:["left","right"]},nb={hl:"LEFT",hr:"RIGHT",vb:"DOWN",vt:"UP"},sb={h:"w",w:"h"},Gh={up:"top",right:"right",down:"bottom",left:"left"},wa={top:!1,right:!0,bottom:!1,left:!0},ab={top:"UP",right:"RIGHT",bottom:"DOWN",left:"LEFT"},Xh={top:i=>`translate(0, -${Xt(i.height||0)}px)`,bottom:i=>`translate(0, ${Xt(i.height||0)}px)`,right:i=>`translate(${Xt(i.width||0)}px, 0)`,left:i=>`translate(-${Xt(i.width||0)}px, 0)`},lb=0,It=class extends F.mixin(Et){static get configurable(){return{animation:{duration:200},collapsed:{value:null,$config:null,default:!1},direction:null,collapseTooltip:"L{Collapse}",expandTooltip:"L{Expand}",panel:{value:null,$config:"nullify"},supportAxis:null,tool:{type:"collapsetool",handler(i){var e;(e=this.collapsible)==null||e.onCollapseClick(i)}}}}static get factoryable(){return{defaultType:"inline"}}get collapsing(){return this.collapsingExpanding==="collapsing"}get collapsingExpanding(){var i;const e=(i=this.currentOperation)==null?void 0:i.collapsing;return e==null?null:e?"collapsing":"expanding"}get currentDock(){var i,e,t,r;return(r=(t=(e=(i=this.panel)==null?void 0:i.header)==null?void 0:e.dock)==null?void 0:t.toLowerCase())!=null?r:"top"}get expanding(){return this.collapsingExpanding==="expanding"}get collapseTool(){var i,e;return(e=(i=this.panel)==null?void 0:i.tools)==null?void 0:e.collapse}get collapseDim(){return ib.test(this.collapseDir)?"width":"height"}getCollapseDir(i){var e;let{direction:t,panel:r}=this;if(!t||Uh.test(t)){const n=r==null?void 0:r.placement;n?t=nb[n]:t=ab[((e=r==null?void 0:r.header)==null?void 0:e.dock)||"top"]}return i?Kh[t]:t}get collapseDir(){return this.getCollapseDir(!0)}get collapseDock(){return this.collapseInfo[0]}get collapseInfo(){const{panel:i}=this,e=i.hasHeader&&i.expandedHeaderDock;let t=Gh[this.collapseDir],r=!1;return e&&((r=wa[t]!==wa[e])||(t=e)),[t,r]}get toolsConfig(){const{direction:i,tool:e}=this;return e&&{collapse:x.assign({direction:i.toLowerCase()},e)}}beforeCollapse(i){const{panel:e}=this,{element:t}=e;t.contains(D.getActiveElement(t))&&e.revertFocus(!0)}changeTool(i){const e=this,{panel:t}=e;if(e.isConfiguring||e.isDestroying||!t||t.isDestroying)return i;t.tools={collapse:i}}collapse(i){var e,t;const r=this,{panel:n}=r,s={id:++lb,completed:!1,panel:n};let{currentOperation:a}=r;return i=i!=null?i:!0,x.isObject(i)&&(s.collapsed=!0,x.assign(s,i),i=s.collapsed,delete s.collapsed),s.collapsing=i,s.previous=a!=null?a:null,i!==r.collapsed?a?a.collapsing!==i&&(s.animation=a.animation.revert({finalize(){var l;(l=r.collapseFinalize)==null||l.call(r,s,!0)}}),s.collapsing=i,a=s):(s.animation=x.clone(("animation"in s?s:r).animation),r.beforeCollapse(s)!==!1&&(s.animation&&(s.animation.finalize=l=>{var o;return(o=r.collapseFinalize)==null?void 0:o.call(r,s,l)}),n.changingCollapse=!0,r[i?"collapseBegin":"expandBegin"](s),s.animation?a=s:(s.completed=!0,r[i?"collapseEnd":"expandEnd"](s)),n.changingCollapse=!1,s.animation||r.onComplete(i?"collapse":"expand"))):a&&a.collapsing!==i&&(r[i?"expandRevert":"collapseRevert"](s),s.animation=a.animation.revert({finalize(){var l;(l=r.collapseFinalize)==null||l.call(r,s,!1)}}),a=s),r.currentOperation=a,(t=(e=a==null?void 0:a.animation)==null?void 0:e.done())!=null?t:Promise.resolve(i===r.collapsed)}collapseFinalize(i,e){const t=this,{currentOperation:r,panel:n}=t,s=n.collapsed?"expand":"collapse";r===i&&(t.currentOperation=null,i.completed=e,n.changingCollapse=!0,t[s+"End"](i),n.changingCollapse=!1,e&&t.onComplete(s))}applyHeaderDock(i,e=!0){const t=this,{currentDock:r,panel:n}=t,s=i?t.collapseDock:n.expandedHeaderDock;s!==r&&n.hasHeader&&(n.header={dock:s},e&&n.recompose.flush())}composeHeader(i){const{panel:e}=this,{class:t}=i,r=e.expandedHeaderDock||Object.keys(t).filter(n=>t[n]&&qh.test(n)).map(n=>qh.exec(n)[1][0]);return t[Co]=1,t[`b-collapsible-${r[0]}${this.collapseDir[0]}`]=1,i}composeTitle(i){return i.class[Co]=1,i}collapseBegin(i){var e;const t=this,{animation:r}=i,{collapseDim:n,collapseTool:s,panel:a}=t,{element:l,placement:o}=a,[u,c]=t.collapseInfo,d=s==null?void 0:s.element.classList,h=!o||o[0]==="h"&&n==="width"||o[0]==="v"&&n==="height";t.configuredWidth=a._lastWidth,t.configuredHeight=a._lastHeight,t.transverseCollapse=c,t.applyHeaderDock(!0);const g=a.rectangle(),f=t.lockInnerSize().moveTo(0,0),m=f.clone(),p=So[u],v=(e=a.headerElement)==null?void 0:e.getBoundingClientRect(),b=Xt((v==null?void 0:v[n])||0);l.classList.toggle(Sa,h),r?(m[p[0]]=m[p[1]],l.classList.add("b-collapsing"),d==null||d.add("b-collapsed","b-collapsing"),s&&(s.collapsing=!0),d&&(d.remove("b-collapsed"),a.rectangle(),d.remove("b-collapsing"),d.add("b-collapsed")),r.element=l,r.retain=!0,r[n]={from:Xt(g[n]),to:b},r.items=[{element:t.innerElement,retain:!1,clip:{from:`rect(${f})`,to:`rect(${m})`}}],c&&r.items.push({element:a.headerElement,duration:r.duration,retain:!1,transform:{from:Xh[u](v),to:"translate(0, 0)"}}),i.animation=Ae.run(r)):(l.style[n]=`${b}px`,s&&(d.add("b-collapsing","b-collapsed"),s.rectangle(),d.remove("b-collapsing")))}collapseEnd(i){const e=this,{collapseTool:t}=e;e.panel.element.classList.remove("b-collapsing"),t&&(t.collapsing=!1),i.completed?e.collapsed=!0:(e.applyHeaderDock(!1),e.restoreConfiguredSize(),e.lockInnerSize(!1))}collapseRevert(i){var e;(e=this.collapseTool)==null||e.element.classList.remove("b-collapsed")}expandBegin(i){const e=this,{animation:t}=i,{collapseDim:r,collapseTool:n,panel:s}=e,[a,l]=e.collapseInfo,{element:o}=s,u=o.classList,c=u.contains(Sa),d=s.rectangle();u.remove("b-collapsed","b-collapsing"),s.element.style[r]="",e.restoreConfiguredSize(),e.lockInnerSize(!1);const h=s.rectangle(),g=e.lockInnerSize().moveTo(0,0),f=g.clone(),m=So[e.collapseDock];n==null||n.element.classList.remove("b-collapsed"),t&&(f[m[0]]=f[m[1]],u.add("b-collapsed","b-expanding"),c&&u.add(Sa),t.element=o,t[r]={from:Xt(d[r]),to:Xt(h[r])},t.items=[{element:e.innerElement,retain:!1,clip:{from:`rect(${f})`,to:`rect(${g})`}}],l&&t.items.push({element:s.headerElement,duration:t.duration,retain:!1,transform:{from:"translate(0, 0)",to:Xh[a](d)}}),i.animation=Ae.run(t))}expandEnd(i){const e=this;e.panel.element.classList.remove("b-expanding"),i.completed&&(e.collapsed=!1,e.applyHeaderDock(!1),e.restoreConfiguredSize(),e.lockInnerSize(!1))}expandRevert(i){var e;(e=this.collapseTool)==null||e.element.classList.add("b-collapsed")}get innerElement(){return this.panel.collapseWrapElement||this.panel.bodyWrapElement}get innerSizeElement(){return this.transverseCollapse?this.panel.element:this.innerElement}get supportAxis(){let{_supportAxis:i}=this;const e=i===!0;return(e||i==null)&&(i=this.collapseDim[0],(e||D.getStyleValue(this.panel.element,"position")==="absolute")&&(i+=sb[i])),i||""}lockInnerSize(i=!0){const e=this,{innerElement:t,panel:r}=e,n=i?e.supportAxis:"",s=r.element,a=r.headerElement,l=i&&a&&V.from(a,s),o=i&&V.from(e.innerSizeElement,s),u=t.style;return a&&(a.style.minWidth=n.includes("w")?`${l.width}px`:"",a.style.minHeight=n.includes("h")?`${l.height}px`:""),u.width=i?`${o.width}px`:"",u.height=i?`${o.height}px`:"",t.classList[i?"add":"remove"]("b-panel-collapse-size-locker"),o}onCollapseClick(i){let e=this.collapsing?!1:this.expanding?!0:!this.collapsed;i.altKey&&(e={animation:null,collapsed:e}),this.collapse(e)}onComplete(i){var e;(e=this.panel)==null||e.trigger(i)}onHeaderClick({event:i}){i.button===0&&this.panel.collapsed&&i.target.classList.contains(Co)&&this.onRevealerClick()}onPanelConfigChange({name:i,value:e}){const t=this,{panel:r}=t;i==="collapsed"?r.isPainted&&(t.collapsed=e):i==="header"&&!r.changingCollapse&&t.syncDirection()}onPanelPaint(){this.syncDirection(),this.panel.collapsed&&!this.collapsed&&this.collapse({animation:null,collapsed:!0})}onRevealerClick(){this.panel._collapse({collapsed:!1})}restoreConfiguredSize(i){const{configuredHeight:e,configuredWidth:t,panel:r}=this;i=i!=null?i:"wh",r.element.classList.remove(Sa),t!=null&&i.includes("w")&&(r.width=t),e!=null&&i.includes("h")&&(r.height=e)}splitHeaderItems({as:i,dock:e}=rb){var t;return(t=this.panel)==null?void 0:t.splitHeaderItems({as:i,dock:e,alt:!0})}syncDirection(){const i=this,{direction:e}=i;(!e||Uh.test(e))&&(i.direction=i.getCollapseDir())}changeCollapsed(i){return!!i}updateCollapsed(i){const{collapseTool:e,panel:t}=this;t&&(t.collapsed=i,t.element.classList[i?"add":"remove"]("b-collapsed")),e&&(e.collapsed=i)}updateDirection(i){const{collapseTool:e,panel:t}=this;e&&(e.direction=Kh[i]),t!=null&&t.rendered&&t.recompose()}updatePanel(i){var e;const t=this;t.syncDirection(),(e=t.panelChangeDetacher)==null||e.call(t),t.panelChangeDetacher=i&&ue.after(i,"onConfigChange","onPanelConfigChange",t,{return:!1})}wrapCollapser(i,e){var t;const r=this,[n,s]=r.collapseInfo;if(!s)return[i,e];const{collapseDir:a,panel:l}=r,{expandedHeaderDock:o,header:u,uiClassList:c}=l,d=(t=l.tools)==null?void 0:t.recollapse,[h,g]=r.splitHeaderItems({as:"element",dock:n}),f=l.hasHeader?l.title||(u==null?void 0:u.title)||"\xA0":null,m=f&&{tag:"header",class:new J({...c,[`b-dock-${o}`]:1,"b-panel-header":1,"b-panel-collapser-header":1},u==null?void 0:u.cls),children:[...h,{reference:"collapserTitleElement",html:f,class:{...c,[`b-align-${(u==null?void 0:u.titleAlign)||"start"}`]:1,"b-header-title":1}},...g]};return d&&(d.direction=a),["collapseWrapElement",{class:{...c,[`b-panel-collapser-header-${o}`]:1,[`b-panel-collapser-${a}`]:1,[`b-${wa[o]?"h":"v"}box`]:1,"b-panel-collapser":1,"b-box-center":1},children:tb.test(o)?{collapserHeaderElement:m,[i]:e}:{[i]:e,collapserHeaderElement:m}}]}};y(It,"$name","PanelCollapser"),y(It,"type","inline"),It.maps={clipByDock:So,dockByDirection:Gh,dockIsHorz:wa},It.initClass(),It._$name="PanelCollapser";var Hn=Symbol("pendingCreate"),Ir=class extends F{static get prototypeProperties(){return{cleanup:null,configName:null,created:null,factory:null,inferType:"name",owner:null,ownerName:null,proxyable:typeof Proxy!="undefined",setup:null,transform:null}}static get properties(){return{defaults:{},instances:{},object:Object.create({})}}get proxy(){const i=this;let e=null;return i.proxyable&&(e=new Proxy(i.instances,{get(t,r){return i.get(r)},set(t,r,n){return i.set(r,n),!0},deleteProperty(t,r){return i.set(r,null),!0}})),Reflect.defineProperty(i,"proxy",{configurable:!0,value:e}),e}get target(){return this.proxy||this.object}define(i,e){const t=this,{transform:r}=t,n=r?r(e,i):e,s=x.isInstantiated(n);t.instances[i]=Hn,s||t.setDefaults(i,n),t.defineProp(i,!0),s&&t.set(i,n)}defineProp(i,e){const t=this,{object:r}=t;t.proxy||Reflect.defineProperty(e?Object.getPrototypeOf(r):r,i,{configurable:!e,enumerable:!0,get(){return t.get(i)},set(n){return t.set(i,n)}})}flush(){var i;const e=this;try{e.updating=!0;for(const t in e.defaults)e.get(t);e.afterConfigureOwner=(i=e.afterConfigureOwner)==null?void 0:i.call(e)}finally{e.updating=!1}}get(i){const{defaults:e,instances:t}=this;return t[i]===Hn&&this.set(i,Hn),t[i]||e[i]&&null}set(i,e){var t;const r=this,{cleanup:n,configName:s,defaults:a,factory:l,instances:o,owner:u,setup:c,transform:d,updating:h}=r,g=u&&s&&!h,f=o[i]===Hn?null:o[i],m=l.reconfigure(f,e===Hn?{}:e||null,{cleanup:n&&(p=>n(p,i)),defaults:a[i]||r.setDefaults(i,{}),owner:r.owner,setup:c&&((p,v,b)=>c(p,i,v,b)),transform:d&&(p=>d(p,i))});if(m!==f){const p=g&&{...o};o[i]=m,m?(r.defineProp(i),(t=r.created)==null||t.call(r,m,i)):(delete r.object[i],delete o[i]),g&&u.onConfigChange({name:s,config:u.$meta.configs[s],value:r.target,was:p})}}setDefaults(i,e){const{defaults:t,factory:r,inferType:n,instances:s,owner:a,ownerName:l}=this,{typeKey:o}=r.factoryable;return e=e===!0?{}:x.assign({},e),(n==="name"||n===!0&&!e[o])&&(e[o]=i),l&&(e[l]=a),e.beforeConfigure=u=>{s[i]=u},t[i]=e}update(i){const e=this,{owner:t}=e;let r,n;try{if(e.updating=!0,i)for(r in i)n=i[r],e.defaults[r]?e.set(r,n):n&&e.define(r,n);else for(r in e.instances)e.set(r,null)}finally{e.updating=!1}t&&(t.isConfiguring?e.afterConfigureOwner||(e.afterConfigureOwner=ue.before(t,"afterConfigure","flush",e)):e.flush())}};Ir.initClass(),Ir._$name="DynamicObject";var ob=[],wo={},ub={align:1,weight:1},Do=i=>{var e;return e=class extends(i||j){static get configurable(){return{tools:{value:null,$config:{nullify:!0}},toolDefaults:{"*":{type:"tool",align:"end"}}}}byWeightSortFn(t,r){return(t.weight||0)-(r.weight||0)}byWeightReverseSortFn(t,r){return(r.weight||0)-(t.weight||0)}gatherTools({align:t,alt:r,refs:n}=wo){var s,a,l;const{collapsed:o,tools:u}=this,c={collapsed:o,alt:r};let d=[],h,g,f,m,p;for(g in u)p=u[g],h=(l=(a=(s=p==null?void 0:p.align)==null?void 0:s.align)!=null?a:p==null?void 0:p.align)!=null?l:"end",h===t&&p.isCollapsified(c)&&d.push(p);if(d.sort(this[t==="end"?"byWeightReverseSortFn":"byWeightSortFn"]),n){const v=n==="widget",b={};for(f=0;f<d.length;++f)m=d[f],b[m.ref]=v?m:m.element;d=b}return d}getEndTools({alt:t,refs:r}=wo){return this.gatherTools({align:"end",alt:t,refs:r})}getStartTools({alt:t,refs:r}=wo){return this.gatherTools({align:"start",alt:t,refs:r})}get childItems(){return[...this.getStartTools(),...this._items||ob,...this.getEndTools()]}changeTools(t,r){const n=this,s=n.$tools||(n.$tools=new Ir({configName:"tools",factory:j,inferType:!1,owner:n,created(a){var l,o;a.innerItem=!1,(o=a.syncRotationToDock)==null||o.call(a,(l=n.header)==null?void 0:l.dock),ue.after(a,"onConfigChange",(u,{name:c})=>{ub[c]&&n.onConfigChange({name:"tools",value:s.target})}),n.onChildAdd(a)},setup(a,l){return a=x.merge({},n.toolDefaults["*"],n.toolDefaults[l],a),a.parent=n,a.ref=l,a}}));if(s.update(t),!r)return s.target}get widgetClass(){}},y(e,"$name","Toolable"),e},Zh=["b-hbox","b-vbox"],cb={name:"align",style:"alignItems"},db={name:"contentAlign",style:"alignContent"},hb={name:"direction",style:"flexDirection"},fb={name:"justify",style:"justifyContent",classes:["stretch"]},gb={name:"wrap",style:"flexWrap",map:{false:"nowrap",true:"wrap",reverse:"wrap-reverse"}},Mr=class extends gt{get vertical(){return this.horizontal===!1}set vertical(i){return this.horizontal=!i}updateAlign(){this.syncConfigStyle(cb)}updateContentAlign(){this.syncConfigStyle(db)}updateDirection(){this.syncConfigStyle(hb)}updateHorizontal(){var i;const e=this,t=(i=e.contentElement)==null?void 0:i.classList,r=Number(e.vertical);t?(t.remove(Zh[1-r]),t.add(Zh[r])):e.syncConfigLater("horizontal"),e.syncDirection()}updateJustify(){this.syncConfigStyle(fb)}updateReverse(){this.syncDirection()}updateWrap(){this.syncConfigStyle(gb)}syncDirection(){const i=this,{reverse:e}=i;i.direction=e?`${i.vertical?"column":"row"}${e?"-reverse":""}`:null}};y(Mr,"$name","Box"),y(Mr,"type","box"),y(Mr,"alias","hbox"),y(Mr,"configurable",{containerCls:"b-box-container",itemCls:"b-box-item",align:null,contentAlign:null,direction:null,horizontal:!0,justify:null,reverse:null,wrap:null}),Mr.initClass(),Mr._$name="Box";var Yn=class extends Mr{};y(Yn,"$name","VBox"),y(Yn,"type","vbox"),y(Yn,"configurable",{horizontal:!1}),Yn.initClass(),Yn._$name="VBox";var To=i=>{var e;return e=class extends(i||F){static get configurable(){return{badge:null}}compose(){const{badge:t}=this;return{dataset:{badge:t},class:{"b-badge":t!=null&&t!==""}}}},y(e,"$name","Badge"),e},Jh=/(?:^|\s)b-icon-/,Qh=/(?:^|\s)b-fa-/,ef=Symbol("defaultToggleable"),mb=["items","type","widgets","html","listeners"],tf=Symbol("defaultListener"),mt=class extends j.mixin(To,Ca){static get configurable(){return{icon:null,menuIcon:"b-icon-picker",pressedIcon:null,iconAlign:"start",behaviorType:"button",text:{value:null,$config:null,default:""},color:null,toggleable:ef,pressed:!1,toggleGroup:null,supportsPressedClick:!1,ripple:{radius:75},forwardTwinEvents:["action","toggle"],localizableProperties:["text"],menu:{$config:["lazy","nullify"],value:null},menuDefaults:{type:"menu",autoShow:!1,autoClose:!0,floating:!0,scrollAction:"realign",align:"t0-b0"},href:null,target:null,defaultBindProperty:null}}updateElement(i,e){var t,r,n;const s=this,{constructor:a}=s,l=super.updateElement(i,e),o=s.peekConfig("menu"),u=o?o.isWidget?o.role:((r=(t=a.resolveType(o.type))==null?void 0:t.configurable)==null?void 0:r.role)||((n=a.configurable.menuDefaults)==null?void 0:n.type)||"menu":!1;return s.ariaHasPopup=u,l}compose(){const{color:i,href:e,icon:t,iconAlign:r,pressed:n,pressedIcon:s,target:a,text:l,toggleable:o,toggleGroup:u,menuIcon:c,behaviorType:d}=this,h=this.hasConfig("menu"),g=n&&s?s:t;return{tag:e?"a":"button",href:e,target:a,type:d,class:{[`b-icon-align-${r}`]:t,[i]:!!i,"b-pressed":n&&o,"b-text":!!l,"b-has-menu":h},[o&&!h?"aria-pressed":""]:n,dataset:{group:u},listeners:{click:"onInternalClick",mousedown:"onInternalMousedown"},children:{iconElement:(t||s)&&{"aria-hidden":!0,tag:"i",class:{...J.normalize(g,"object"),"b-icon":Jh.test(g),"b-fa":Qh.test(g)}},label:l&&{tag:"label",for:this.id,text:l},menuIconElement:h&&c&&{tag:"i",class:{"b-icon":Jh.test(c),"b-fa":Qh.test(c),"b-button-menu-icon":1,[c]:1}}}}}configureOverflowTwin(i){const e=this,t=super.configureOverflowTwin(i);return t.text||(t.text=e.text||e.tooltipText),t}onHide(){var i;(i=this._menu)==null||i.hide()}get childItems(){return this._menu&&[this.menu]}onFocusOut(i){var e;super.onFocusOut(i),(e=this.menu)==null||e.hide()}get focusElement(){return this.element}changeText(i){return i==null?"":i}changeToggleable(i){return i===ef?this.toggleGroup||this.config.menu:i}changeMenu(i,e){const t=this,{element:r}=t;return i?(i.isWidget?(i.forElement=r,i.owner=t,i.constrainTo=t.rootElement):(typeof i=="object"&&!mb.some(n=>n in i)&&(i={lazyItems:i}),i=j.reconfigure(e,i?x.merge({owner:t,constrainTo:t.rootElement,forElement:r},t.menuDefaults,i):null,t)),i.align.constrainPadding=10,t.detachListeners(tf),i.ion({name:tf,beforeShow:"onMenuBeforeShow",hide:"onMenuHide",show:"onMenuShow",thisObj:this})):e==null||e.destroy(),i}onMenuBeforeShow({source:i}){return this.trigger("beforeShowMenu",{menu:i})}onMenuShow(){this.ariaElement.setAttribute("aria-expanded",!0)}onMenuHide(){this.ariaElement.setAttribute("aria-expanded",!1),this.toggle(!1)}updateMenu(i){this.toggleable=!!i}updatePressed(i){var e,t;const r=this;if(!r.toggleable||r.isConfiguring)return;const{menu:n}=r;i&&D.forEachSelector(r.rootElement,`button[data-group=${r.toggleGroup}]`,s=>{s!==r.element&&(j.getById(s.id).pressed=!1)}),n&&(n.initialConfig.minWidth||(n.minWidth=r.width),n.align.minHeight=(e=n._minHeight)!=null?e:100,n.align.minWidth=(t=n._minWidth)!=null?t:100,n[i?"show":"hide"]()),r.trigger("toggle",{pressed:i,userAction:r._isUserAction})}onInternalMousedown(i){var e;(e=this._menu)!=null&&e.containsFocus&&this.pressed&&i.preventDefault()}onInternalClick(i){const e=this,t={event:i};e.disabled||(e._isUserAction=!0,!(e.toggleable&&(e.toggleGroup&&e.pressed&&!e.supportsPressedClick||((!e.toggleGroup||!e.pressed)&&e.toggle(!e.pressed),e.isDestroyed)))&&(e.trigger("click",t),e.isDestroyed||e.trigger("action",t),e.href||(i.preventDefault(),i.stopPropagation()),e._isUserAction=!1))}toggle(i=!this.pressed){this.trigger("beforeToggle",{pressed:i,userAction:this._isUserAction})!==!1&&(this.pressed=i)}};y(mt,"$name","Button"),y(mt,"type","button"),mt.initClass(),mt._$name="Button";var rf={refs:"element"},pb=i=>i.element.style.margin="",vb=i=>i.isToolbar,nf=i=>i[0]+(i[1].minifiable?0:9e9),sf={hidden:!1,width:""},yb={...sf,flex:""},bb=[{box:"hbox",clientSizeProp:"clientWidth",edgeProp:"right",flexDir:"row",horizontal:!0,max:"maxX",overflow:"overflowX",pos:"x",scrollSize:"scrollWidth",sizeProp:"width"},{box:"vbox",clientSizeProp:"clientHeight",edgeProp:"bottom",flexDir:"column",horizontal:!1,max:"maxY",overflow:"overflowY",pos:"y",scrollSize:"scrollHeight",sizeProp:"height"}],Cb={delay:0,startRate:40,endRate:200,accelerateDuration:500},Sb={menu:1,pressed:1},xo=class vm extends Be.mixin(Do){static get delayable(){return{syncOverflowVisibility:{type:"raf",cancelOutstanding:!0}}}static get configurable(){return{defaultType:"button",dock:"top",layout:{type:"box"},overflow:{$config:["lazy","nullify"],value:{type:"menu"}},toolDefaults:{overflowMenuButton:{type:"button",hidden:!0,icon:"b-icon-menu",menuIcon:null,ariaLabel:"Show overflowing items",defaultCls:{"b-overflow-button":1}},overflowScrollEnd:{handler:"up.onEndScrollClick",hidden:!0,defaultCls:{"b-icon-angle-right":1,"b-overflow-button":1,"b-icon":1}},overflowScrollStart:{align:"start",handler:"up.onStartScrollClick",hidden:!0,defaultCls:{"b-icon-angle-left":1,"b-overflow-button":1,"b-icon":1}}},widgetCls:null,ignoreParentReadOnly:!0}}static get prototypeProperties(){return{flexRowCls:"b-hbox",flexColCls:"b-vbox"}}static getEvictionList(e){const t=e.filter(r=>r.overflowable!=="none");return t.forEach((r,n)=>t[n]=[n,r]),t.sort((r,n)=>nf(n)-nf(r)),t}compose(){const e=this,{axisProps:t,dock:r}=e,n=e.getEndTools(rf),s=e.getStartTools(rf);return{class:{[`b-dock-${r}`]:1,[`b-${r}-toolbar`]:1,[`b-${t.box}`]:1},children:{...s,toolbarContent:{class:{"b-box-center":1,"b-toolbar-content":1}},...n}}}get axisProps(){return bb[this.layout.horizontal?0:1]}get contentElement(){return this.toolbarContent}get overflowMenuButton(){var e;return(e=this.tools)==null?void 0:e.overflowMenuButton}get overflowType(){const{overflow:e}=this;return typeof e=="string"?e:e==null?void 0:e.type}onChildAdd(e){var t;super.onChildAdd(e),this.processAddedLeafItem(e),(t=e.syncRotationToDock)==null||t.call(e,this.dock)}onChildRemove(e){super.onChildRemove(e),this.syncOverflowVisibility()}processAddedLeafItem(e){ue.after(e,"onConfigChange",this.onLeafItemConfigChange,e),e.isContainer&&e.eachWidget(t=>this.processAddedLeafItem(t))}onInternalPaint({firstPaint:e}){var t;(t=super.onInternalPaint)==null||t.call(this,...arguments),e&&this.getConfig("overflow")}updateDock(e){var t;const r=this,{layout:n}=r,{vertical:s}=n;if(n.vertical=Yh(e)[1],!r.initialItems){s!==n.vertical&&r.updateOverflow(r.overflow);for(const a of r.childItems)(t=a.syncRotationToDock)==null||t.call(a,e)}}updateOverflow(e,t){var r,n;const s=this,{axisProps:a,contentElement:l,overflowType:o}=s,{flexDir:u}=a,c=(r=s.overflowMenuButton)==null?void 0:r._menu,d={};if(c&&(e?c==null||c.removeAll():c.eachWidget(h=>{h._overflowTwinOrigin.overflowTwin=null})),t==="menu"?d.overflowMenuButton=null:t==="scroll"&&(d.overflowScrollStart=d.overflowScrollEnd=null),o==="menu")(n=s.scrollable)==null||n.destroy(),l.style.overflow=l.style.overflowX=l.style.overflowY="",d.overflowMenuButton={cls:{[`b-${u}-menu`]:1}};else if(o==="scroll"){const h=typeof e=="object"&&(e==null?void 0:e.repeat)||Cb;s.scrollable={[a.overflow]:"hidden-scroll",element:l,internalListeners:{scroll:"onContentScroll",thisObj:s}},d.overflowScrollStart={repeat:h,invertRotate:!0,cls:{[`b-${u}-start-scroller`]:1}},d.overflowScrollEnd={repeat:h,invertRotate:!0,cls:{[`b-${u}-end-scroller`]:1}}}s.tools=d,o?(l.classList.add("b-overflow"),s.monitorResize=!0,s.syncOverflowVisibility()):(l.classList.remove("b-overflow"),s.monitorResize=!1)}onContentScroll(){this.syncScrollerState()}onStartScrollClick(){this.scrollable[this.axisProps.pos]-=2}onEndScrollClick(){this.scrollable[this.axisProps.pos]+=2}onInternalResize(){super.onInternalResize(...arguments),this.isPainted&&this.syncOverflowVisibility()}syncOverflowVisibility(){const e=this,{overflowType:t,contentElement:r,isVisible:n}=e,{clientSizeProp:s,edgeProp:a,sizeProp:l}=e.axisProps,{overflowMenuButton:o,overflowScrollStart:u,overflowScrollEnd:c}=e.tools,d=e.rtl&&e.layout.horizontal,h=t==="menu",g=()=>Math.ceil(r[s]+(!u||u.hidden?0:u.rectangle("outer")[l])+(!c||c.hidden?0:c.rectangle("outer")[l])),f=()=>{if(M.length===0)return 0;const O=M[M.length-1].rectangle(r);return Math.floor(d?r[s]-O.left:O[a])};let m,p,v,b,w,S,C,T,E,I,R,M;if(!(!n||!t||e.items.length===0)){if(e.inSyncOverflowVisibility=!0,o==null||o.hide(),e.eachWidget((O,A)=>{C=O.minifiable,I=O.overflowable,I=C?I||C:I,O.floating?A.down=!1:(A.down=!I,O.innerItem&&(O._toolbarOverflow&&(O.hidden=O._toolbarOverflow=!1),O._toolbarMinified&&(O.minified=O._toolbarMinified=!1),O.isVisible&&(C&&(T||(T=[])).push(O),I&&(M||(M=[])).push(O))))}),M&&(m=g(),p=f()),M&&p>m)if(h){for(;p>m&&(w=T==null?void 0:T.pop());)S=p,w._toolbarMinified=!0,w.minified=!0,p=f(),S-=p,(E||(E=[])).push([w,S]);if(p>m){o.show(),m=g(),b=vm.getEvictionList(M);for(v of b)p>m&&(w=v[1],w._toolbarOverflowWidth=w.width,w._toolbarOverflow=!0,w.hidden=!0,M.splice(M.indexOf(w),1),(R||(R=[])).push(v),p=f());if(R){for(R.sort((O,A)=>O[0]-A[0]).forEach((O,A)=>R[A]=O[1]);E!=null&&E.length;)[w,S]=E.pop(),p+S<=m&&!w._toolbarOverflow&&(p+=S,w.minified=w._toolbarMinified=!1);e.syncOverflowMenuButton(R)}else o.hide()}}else c.show(),u.show(),e.syncScrollerState();else h||(c==null||c.hide(),u==null||u.hide());e.inSyncOverflowVisibility=!1}}syncOverflowMenuButton(e){var t;const r=this,{axisProps:n,overflowMenuButton:s}=r,a={cls:"b-toolbar-overflow-menu",minWidth:280,items:[],align:{align:n.horizontal?"t100-b100":"r100-l100",axisLock:"flexible"}};if(r.addToMenu(a,e.filter(l=>r.overflowItemFilter(l))),(t=s._menu)!=null&&t.isMenu){const l=s.menu,{toAdd:o,toRemove:u}=z.delta(a.items,l.items,1);if(l.remove(u),l.items.length)for(let c=o.length-1;c>=0;c--)l.insert(o[c],0);else l.add(o)}else s.menu=a}syncScrollerState(){const e=this,{axisProps:t,scrollable:r}=e,{overflowScrollStart:n,overflowScrollEnd:s}=e.tools,a=r[t.pos],l=r[t.max];n.disabled=!a,s.disabled=Math.abs(Math.ceil(a))>=Math.abs(l)}overflowItemFilter(e){const{filter:t}=this.overflow;return!!(t?t.call(this,e):D.getChildElementCount(e.element))}addToMenu(e,t){const r=this.horizontal?yb:sf;for(const n of t){const s=n.ensureOverflowTwin(r,pb);e.items.push(s)}}onLeafItemConfigChange(e,{name:t,value:r}){const n=this,s=n.up(vb),a=s.hasConfig("overflow"),{overflowTwin:l}=n;!a||s!=null&&s.inSyncOverflowVisibility||t==="hidden"&&r===n._toolbarOverflow||(l&&!Sb[t]&&(l[t]=r),s!=null&&s.isPainted&&n.ref!=="overflowMenuButton"&&(n.isTextField&&t==="value"&&(n.containsFocus||l!=null&&l.containsFocus)||s.syncOverflowVisibility()))}createWidget(e){e==="->"?e={type:"widget",cls:"b-toolbar-fill"}:e==="|"?e={type:"widget",cls:"b-toolbar-separator"}:typeof e=="string"&&(e={type:"widget",cls:"b-toolbar-text",html:e});const t=super.createWidget(e);return this.widgetCls&&t.element.classList.add(this.widgetCls),t}};y(xo,"$name","Toolbar"),y(xo,"type","toolbar");var Un=xo;Un.initClass(),Un._$name="Toolbar";var wb=i=>!i.classList.contains("b-focus-trap")&&D.isFocusable(i)?D.NodeFilter.FILTER_ACCEPT:D.NodeFilter.FILTER_SKIP,Eo=[],Db={},af=[Eo,Eo],lf=(i,e,t)=>{const{vertical:r}=i;return delete i.vertical,{...i,class:{...e,[`b-${r?"v":"h"}box`]:1,"b-box-center":1,"b-panel-bar-wrap":!t}}},ko=(i,e,t=!1)=>{const r={vertical:t,children:i?[i]:[]};return e&&(r.tag=e),r},Da=(i,e)=>{i!=null&&i.classList?i==null||i.classList.add(e):i!=null&&i.class&&(typeof i.class=="string"&&(i.class={[i.class]:1}),i.class[e]=1)},Tb={dock:1,hidden:1,weight:1},Rr={top:[!0,!0],bottom:[!0,!1],left:[!1,!0],right:[!1,!1]},of={header:1,"pre-header":1},Io=class ol extends Be.mixin(sa,Do){static get configurable(){return{localizableProperties:["title"],collapsed:{value:null,$config:null,default:!1},collapsible:{value:null,$config:"nullify"},bodyCls:{$config:{merge:"classList"},value:null},bodyTag:null,bodyWrapTag:null,trapFocus:null,title:null,header:null,stateful:["collapsed"],stripDefaults:{"*":{type:"toolbar",dock:"top"},bbar:{dock:"bottom",weight:-1e3},tbar:{weight:-1e3}},strips:{value:null,$config:"nullify"},toolDefaults:{close:{weight:-1e3},collapse:{weight:-990}},footer:null,revealed:null,tbar:null,bbar:null,role:"region"}}updateElement(e,t){const r=super.updateElement(e,t);return this.titleElement&&D.setAttributes(this.ariaElement,{"aria-describedby":this.titleElement.id}),r}compose(){const e=this,{collapsible:t,focusable:r,hasItems:n,revealed:s,tools:a}=e,l=e.composeHeader(),o=(l==null?void 0:l.class["b-dock-left"])||(l==null?void 0:l.class["b-dock-right"]);let u=e.composeBody(),c="bodyWrapElement";return t&&([c,u]=t.wrapCollapser(c,u)),{tabIndex:n&&r!==!1||r?0:null,class:{[`b-panel-collapsible-${t==null?void 0:t.type}`]:t,[`b-panel-collapse-${t==null?void 0:t.collapseDir}`]:t,[`b-${o?"h":"v"}box`]:1,"b-panel-collapsible":t,"b-panel-has-header":l,"b-panel-has-tools":a?1:0,"b-panel-overlay-revealed":s},children:{topFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1}},headerElement:l,[c]:u,bottomFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1,"b-end-focus-trap":1}}}}}composeBody(){var e,t;const r=this,{bodyCls:n,bodyConfig:s,bodyWrapTag:a,footer:l,uiClassList:o}=r,u=x.values(r.strips,(w,S)=>!Rr[S==null?void 0:S.dock]).sort(r.byWeightSortFn),c={top:null,right:null,bottom:null,left:null};let d,h,g,f,m,p,v;for(l&&(g=l.dock||"bottom",u.unshift({dock:g,element:{tag:"footer",reference:"footerElement",html:typeof l=="string"?l:l.html,class:{...o,[`b-dock-${g}`]:1,[`${l.cls||""}`]:1}}})),n&&(s[m="className"]||(m="class"),s[m]=new J(s[m]).assign(n)),f=u.length;f-- >0;)d=u[f],[p,h]=Rr[d.dock],v?v.vertical!==p&&(v=ko(lf(v,o),"",p)):v=ko(s,a,p),v.children[h?"unshift":"push"](d.element),c[d.dock]=d;Da(c.top,"b-innermost"),Da(c.right,"b-innermost"),Da(c.bottom,"b-innermost"),Da(c.left,"b-innermost");const b=lf(v||ko(s,a),o,!0);return b.class[`${(e=r.layout)==null?void 0:e.containerCls}-panel`]=!!((t=r.layout)!=null&&t.containerCls),b.class["b-panel-body-wrap"]=1,b.class[`b-${r.$$name.toLowerCase()}-body-wrap`]=1,b}get hasHeader(){if(this.header===!1)return!1;const{header:e,title:t,tools:r,parent:n}=this,s=this.maximizable||Object.values(r||{}).some(a=>!a.hidden);return e||!(n!=null&&n.suppressChildHeaders)&&(t||s)}get rootUiClass(){return ol}composeHeader(e){var t;const r=this;if(!r.hasHeader&&!e)return;const n=r.header||{},s=n.dock||"top",[a,l]=r.splitHeaderItems({as:"element",dock:s}),o=r.$meta.hierarchy,u=r.composeTitle(n),c=new J({[`b-dock-${s}`]:1,...r.uiClassList},n.cls);let d,h;for(d=o.indexOf(ol);d<o.length;++d)h=o[d].$$name,h!=="Grid"&&(c[`b-${h.toLowerCase()}-header`]=1);const g={tag:"header",class:c,children:[...a,u,...l]};return((t=r.collapsible)==null?void 0:t.composeHeader(g))||g}composeTitle(e){var t;const r=typeof e=="string"?e:this.title||e.title,n={reference:"titleElement",id:`${this.id}-panel-title`,html:r!=null?r:"\xA0",class:{[`b-align-${e.titleAlign||"start"}`]:1,"b-header-title":1,...this.uiClassList}};return x.isObject(r)&&(delete n.html,x.merge(n,r)),((t=this.collapsible)==null?void 0:t.composeTitle(n))||n}updateTitle(){}afterRecompose(){var e;super.afterRecompose();const t=this,{headerElement:r}=t;(e=t._headerClickDetacher)==null||e.call(t),t._headerClickDetacher=r&&$.on({element:r,click:n=>{var s;return(s=t.trigger)==null?void 0:s.call(t,"headerClick",{event:n})}})}onHeaderClick(e){var t;(t=this.collapsible)==null||t.onHeaderClick(e)}onInternalPaint(){var e;super.onInternalPaint(...arguments),(e=this.collapsible)==null||e.onPanelPaint(this)}splitHeaderItems({as:e,dock:t,alt:r}=Db){var n,s,a,l;const o=this,u=e==="element",{collapsed:c}=o,d=o.getEndTools({alt:r}),h=o.getStartTools({alt:r}),g=x.values(o.strips,(b,w)=>!of[w==null?void 0:w.dock]&&w.isCollapsified({collapsed:c,alt:r}));let f=af,m,p,v;if(g.length+d.length+h.length){for(f=[p=[...h,...g.filter(b=>b.dock==="pre-header").sort(o.byWeightSortFn)],m=[...g.filter(b=>b.dock==="header").sort(o.byWeightReverseSortFn),...d]],v=0;v<p.length;++v)t&&((s=(n=p[v]).syncRotationToDock)==null||s.call(n,t)),u&&(p[v]=p[v].element);for(v=0;v<m.length;++v)t&&((l=(a=m[v]).syncRotationToDock)==null||l.call(a,t)),u&&(m[v]=m[v].element)}return f}set bodyConfig(e){this._bodyConfig=e}get bodyConfig(){const e=this,{bodyTag:t}=e,r=x.merge({reference:"bodyElement",className:{...e.getStaticWidgetClasses(ol,"-content"),"b-box-center":1,"b-text-content":e.textContent&&e.hasNoChildren}},e._bodyConfig);return t&&(r.tag=t),(e.initializingElement||!e._element)&&(r.html=e.content||e._html),r}changeBodyCls(e){return J.from(e)}changeTbar(e){return this.getConfig("strips"),this.strips={tbar:e},this.strips.tbar}changeBbar(e){return this.getConfig("strips"),this.strips={bbar:e},this.strips.bbar}get childItems(){var e;const t=this,r=x.values(t.strips,(o,u)=>!Rr[u==null?void 0:u.dock]).sort(t.byWeightSortFn),[n,s]=t.splitHeaderItems(),[a,l]=((e=t.collapsible)==null?void 0:e.splitHeaderItems())||af;return[...n,...a,...s,...l,...r.filter(o=>Rr[o.dock][1]),...t._items||Eo,...r.filter(o=>!Rr[o.dock][1]).reverse()]}changeStrips(e,t){const r=this,n=r.$strips||(r.$strips=new Ir({configName:"strips",factory:j,inferType:!1,owner:r,created(s){var a;const{dock:l}=s;if(!of[l]&&!Rr[l])throw new Error(`Invalid dock value "${l}"; must be: top, left, right, bottom, header, or pre-header`);ue.after(s,"onConfigChange",(o,{name:u})=>{Tb[u]&&r.onConfigChange({name:"strips",value:n.target})}),s.innerItem=!1,r.onChildAdd(s),s.parent=r,(a=s.layout)==null||a.renderChildren(),s.hasItems&&(r.hasItems=!0)},setup(s,a){return s=x.merge(x.clone(r.stripDefaults["*"]),r.stripDefaults[a],s),s.parent=r,s.ref=a,s},transform(s){return Array.isArray(s)&&(s={items:s}),s||null}}));if(n.update(e),!t)return n.target}get collapsing(){var e;return(e=this.collapsible)==null?void 0:e.collapsing}get collapsingExpanding(){var e;return(e=this.collapsible)==null?void 0:e.collapsingExpanding}get expanding(){var e;return(e=this.collapsible)==null?void 0:e.expanding}changeCollapsed(e){const t=this,{collapsible:r}=t;if(t.recompose.flush(),e=!!e,!r||t.changingCollapse||!t.isPainted)return e;r==null||r.collapse({animation:null,collapsed:e})}changeCollapsible(e,t){const r=this;return r.getConfig("tools"),e&&(e===!0?e={}:typeof e=="string"&&(e={[Rr[e]?"direction":"type"]:e})),It.reconfigure(t,e,{owner:r,defaults:{panel:r},cleanup(){r.collapsed&&(t.collapse({animation:null,collapsed:!1}),r._collapsed=1)}})}updateCollapsible(e){const t=this,r=e==null?void 0:e.toolsConfig;t.tools={collapse:(r==null?void 0:r.collapse)||null,recollapse:(r==null?void 0:r.recollapse)||null},e&&t.isPainted&&t.collapsed&&(t._collapsed=1),t.collapsed===1&&(t.collapsed=!0)}_collapse(e,t){var r;return t!==!0&&t!==void 0&&(t===!1?e.collapsed=!e.collapsed:typeof t=="number"?e.animation={duration:t}:t===null?e.animation=t:t===!0||("animation"in t?x.merge(e,t):e.animation=t)),(r=this.collapsible)==null?void 0:r.collapse(e)}collapse(e){return this._collapse({collapsed:!0},e)}expand(e){return this._collapse({collapsed:!1},e)}toggleCollapsed(e){return this.collapsed?this.expand(e):this.collapse(e)}get expandedHeaderDock(){var e,t,r;return(r=(t=this._expandedHeaderDock)!=null?t:(e=this.initialConfig.header)==null?void 0:e.dock)!=null?r:"top"}set expandedHeaderDock(e){this._expandedHeaderDock=e==null?void 0:e.toLowerCase()}updateHeader(e){this.changingCollapse||(this.expandedHeaderDock=e==null?void 0:e.dock)}updateTrapFocus(e){var t;const r=this;r.element.classList[e?"add":"remove"]("b-focus-trapped"),r.focusTrapListener=(t=r.focusTrapListener)==null?void 0:t.call(r),e&&(r.focusTrapListener=$.on({element:r.element,focusin:"onFocusTrapped",delegate:".b-focus-trap",thisObj:r}),r.treeWalker||(r.treeWalker=this.setupTreeWalker(r.element,D.NodeFilter.SHOW_ELEMENT,wb)))}setupTreeWalker(e,t,r){return document.createTreeWalker(e,t,r)}onFocusTrapped(e){const t=this,r=t.treeWalker;if(e.target===t.bottomFocusTrap)r.currentNode=t.topFocusTrap,r.nextNode();else if(e.target===t.topFocusTrap)r.currentNode=t.bottomFocusTrap,r.previousNode();else return;t.requestAnimationFrame(()=>r.currentNode.focus())}get focusElement(){return this.hasItems&&(super.focusElement||this.element)}get contentElement(){return this.element&&this.bodyElement}get widgetClassList(){var e;const t=this,r=super.widgetClassList;return t.hasHeader&&r.push("b-panel-has-header",`b-header-dock-${((e=t.header)==null?void 0:e.dock)||"top"}`),t.tbar&&r.push("b-panel-has-top-toolbar"),t.bbar&&r.push("b-panel-has-bottom-toolbar"),r}};y(Io,"$name","Panel"),y(Io,"type","panel");var pt=Io;pt.initClass(),pt._$name="Panel";var Mo=class ei extends pt{static get configurable(){return{autoShow:!0,autoClose:!0,showOnClick:!1,forElement:null,monitorResize:!0,floating:!0,hidden:!0,axisLock:!0,hideAnimation:{opacity:{from:1,to:0,duration:".3s",delay:"0s"}},showAnimation:{opacity:{from:0,to:1,duration:".4s",delay:"0s"}},stripDefaults:{bbar:{layout:{justify:"flex-end"}}},testConfig:{hideAnimation:null,showAnimation:null},closeAction:"hide",trapFocus:!0,focusOnToFront:!0,closable:null,maximizable:null,modal:null,maximized:null,tools:{close:{cls:"b-popup-close",handler:"close",weight:-1e3,ariaLabel:"L{Popup.close}",hidden:!0},maximize:{cls:"b-popup-expand",handler:"toggleMaximized",weight:-999,hidden:!0}},highlightReturnedFocus:!0,role:"dialog"}}finalizeInit(){const e=this,{forElement:t}=e;e.anchoredTo=t,e.initialAnchor=e.anchor,t&&e.showOnClick&&(e.initialConfig.autoShow||(e.autoShow=!1),$.on({element:t,click:"onElementUserAction",thisObj:e})),super.finalizeInit(),e.autoShow&&(!t||D.isVisible(t))&&(e.autoShow===!0?e.show():e.setTimeout(()=>e.show(),e.autoShow))}onInternalPaint({firstPaint:e}){var t;(t=super.onInternalPaint)==null||t.call(this,...arguments);const r=this;e&&r.headerElement&&$.on({element:r.headerElement,dblclick:r.onHeaderDblClick,thisObj:r})}doDestroy(){this.syncModalMask(),super.doDestroy()}compose(){const{hasNoChildren:e,textContent:t}=this;return{class:{"b-text-popup":!!(t&&e)}}}close(){const e=this;if(!e._hidden&&e.trigger("beforeClose")!==!1||e._hidden&&e.closeAction==="destroy")return e.modal&&e.closeAction==="destroy"&&e.revertFocus(),e.unmask(),e.containsFocus&&e.highlightReturnedFocus&&e.setTimeout(()=>e.element.classList.add("b-using-keyboard"),0),e[e.closeAction]()}toggleMaximized(){this.maximized=!this.maximized}updateMaximized(e){D.toggleClasses(this.element,["b-maximized"],e)}onInternalKeyDown(e){const t=this;e.key==="Escape"&&(e.stopImmediatePropagation(),t.floating||t.positioned?t.close(!0):t.collapsible&&(t.revealed?t.collapsible.toggleReveal():t.collapse()))}onDocumentMouseDown({event:e}){const t=this,{owner:r}=t,{target:n}=e;if(e.type!=="touchend"&&(r!=null&&r.isButton)&&r._menu===t&&r.element.contains(n))return e.preventDefault(),!1;t.modal&&n===ei.modalMask?(e.preventDefault(),t.modal.closeOnMaskTap?t.close():t.containsFocus||t.focus()):!t.owns(n)&&t.autoClose&&!t.containsFocus&&t.close()}get isTopModal(){return D.isVisible(ei.modalMask)&&this.element.previousElementSibling===ei.modalMask}onFocusIn(e){const t=D.getActiveElement(this);super.onFocusIn(e),D.getActiveElement(this)===t&&e.target===this.element&&this.focus()}onFocusOut(e){!(globalThis.visualViewport&&globalThis.visualViewport.height<document.documentElement.clientHeight-1)&&!this.modal&&this.autoClose&&this.close(),super.onFocusOut(e)}onShow(){var e;const t=this;(t.autoClose||t.modal)&&t.addDocumentMouseDownListener(),t.focusOnToFront&&t.focus(),(e=super.onShow)==null||e.call(this),t.syncModalMask()}addDocumentMouseDownListener(){this.mouseDownRemover||(this.mouseDownRemover=Me.ion({globaltap:"onDocumentMouseDown",thisObj:this}))}updateModal(e){e&&(this.floating=!0)}syncModalMask(){const e=this,{modal:t,element:r}=e;if(r.setAttribute("aria-modal",!!t),t&&e.isVisible)typeof e._x!="number"&&typeof e._y!="number"&&(e.centered=!0,e.anchor=!1),e.modalMask.classList.remove("b-hide-display"),e.modalMask.classList.toggle("b-modal-transparent",!!t.transparent),r.classList.add("b-modal");else if(e.isPainted){r.classList.remove("b-modal");const n=e.floatRoot.querySelectorAll(".b-modal"),s=n.length?ei.fromElement(n[n.length-1],"popup"):null;s?s.syncModalMask():ei.modalMask.classList.add("b-hide-display")}}onHide(){var e,t;const r=this;(e=r.mouseDownRemover)==null||e.call(r),r.mouseDownRemover=null,(t=super.onHide)==null||t.call(this),r.syncModalMask()}onElementUserAction(){this.show()}onHeaderDblClick(){this.maximizable&&this.toggleMaximized()}updateClosable(e){this.tools.close.hidden=!e}updateMaximizable(e){this.tools.maximize.hidden=!e}get modalMask(){const{modalMask:e}=ei;return e.nextElementSibling!==this.element&&this.floatRoot.insertBefore(e,this.element),e}static get modalMask(){return this._modalMask||(this._modalMask=D.createElement({className:"b-modal-mask b-hide-display"}),$.on({element:this._modalMask,wheel:e=>e.preventDefault()})),this._modalMask}};y(Mo,"$name","Popup"),y(Mo,"type","popup");var _r=Mo;_r.initClass(),_r._$name="Popup";var xb=/^b-icon-/,Eb=/^b-fa-/,Or=class extends j{static get configurable(){return{checked:null,separator:null,toggleGroup:null,menu:{value:null,$config:["lazy","nullify"]},icon:null,closeParent:null,href:null,target:null,localizableProperties:["text"],role:"menuitem",closeMenuDelay:200}}updateElement(i,e){const t=super.updateElement(i,e);return typeof this.checked=="boolean"&&(this.role="menuitemcheckbox"),this.ariaHasPopup=this.hasMenu?"menu":!1,t}compose(){var i;const e=this,{checked:t,href:r,hasMenu:n,separator:s,target:a,text:l,toggleGroup:o}=e,u=typeof t=="boolean",c=e.icon||(u?"b-fw-icon":""),d=`b-icon-${o?"radio-":""}`,h=typeof l=="object";return{tag:r?"a":"div",tabIndex:-1,href:r,target:a,class:{"b-has-submenu":n,"b-checked":t,"b-separator":s||((i=e.cls)==null?void 0:i["b-separator"])},dataset:{group:e.toggleGroup},[u?"aria-checked":""]:t,[n?"aria-expanded":""]:!1,children:{iconElement:c&&{"aria-hidden":!0,tag:"i",class:{"b-fa":Eb.test(c),"b-icon":xb.test(c),"b-menuitem-icon":1,[`${d}checked`]:t===!0,[`${d}unchecked`]:t===!1,...J.normalize(c,"object")}},textElement:{tag:"span",html:h?null:l,class:{"b-menu-text":1,"b-menu-custom-content":h},children:h?[l]:null},subMenuIcon:n&&{"aria-hidden":!0,tag:"i",class:{"b-fw-icon":1,"b-icon-sub-menu":1}}}}}doAction(i){const e=this,t=this.parent,r={menu:t,item:e,element:e.element,bubbles:!0,domEvent:i};if(typeof e.checked=="boolean"){const n=!e.checked;(!e.toggleGroup||n)&&(e.checked=!e.checked)}else e.href&&i.key&&e.element.click();e.trigger("beforeItem",r),e.trigger("item",r),e.closeParent&&t&&(t.rootMenu.close(),i&&!e.href&&i.preventDefault())}get focusElement(){return this.element}get contentElement(){return this.textElement}get isFocusable(){const{focusElement:i}=this;return i&&this.isVisible&&(i===document.body||i.offsetParent)}get hasMenu(){return this.hasConfig("menu")}get childItems(){const{_menu:i}=this;return i?[i]:[]}get text(){return this.html}set text(i){this.html=i}onFocusIn(i){super.onFocusIn(i),!this.disabled&&this.menu&&this.delay("openMenu",200)}onFocusOut(i){this.clearTimeout("openMenu"),super.onFocusOut(i),this._menu&&(this.menu.closeTimer=this.menu.setTimeout(()=>this.closeMenu(),this.closeMenuDelay))}openMenu(i){const{menu:e}=this;!this.disabled&&e&&(e.focusOnToFront=i,e.show())}onChildShow(i){super.onChildShow(i),this.ariaElement.setAttribute("aria-expanded",!0)}closeMenu(){this._menu instanceof j&&this.menu.close()}onChildHide(i){super.onChildHide(i),this.ariaElement.setAttribute("aria-expanded",!1)}changeToggleGroup(i){return i&&typeof this.checked!="boolean"&&(this.checked=!1),i}changeChecked(i,e){if(this.isConfiguring||typeof e=="boolean")return!!i}updateChecked(i){const e=this;e.isConfiguring||(e.toggleGroup&&e.uncheckToggleGroupMembers(),e.element.setAttribute("aria-checked",i),e.trigger("toggle",{menu:e.owner,item:e,element:e.element,bubbles:!0,checked:i}))}getToggleGroupMembers(){const i=this,{checked:e,toggleGroup:t,element:r}=i,n=[];return e&&t&&D.forEachSelector(i.rootElement,`[data-group=${t}]`,s=>{if(s!==r){const a=j.fromElement(s);a&&n.push(a)}}),n}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach(i=>i.checked=!1)}get closeParent(){return(typeof this.checked=="boolean"?this._closeParent:this._closeParent!==!1)&&!this.hasMenu}changeMenu(i,e){const t=this,{constrainTo:r,scrollAction:n}=t.owner;return i&&typeof i=="object"&&!("items"in i)&&!("widgets"in i)&&!("html"in i)&&(i={lazyItems:i}),Zt.reconfigure(e,i,{owner:t,defaults:{type:"menu",align:"s0-e0",anchor:!0,autoClose:!0,autoShow:!1,cls:"b-sub-menu",forElement:t.element,owner:t,ariaLabel:t.text,constrainTo:r,scrollAction:n}})}};y(Or,"$name","MenuItem"),y(Or,"type","menuitem"),Or.initClass(),Or._$name="MenuItem";var kb={ArrowUp:1,ArrowDown:1,ArrowRight:1,ArrowLeft:1,Enter:1,Escape:1},Zt=class extends _r{static get configurable(){return{layout:"vbox",focusable:!0,align:"t-b",scrollAction:"hide",focusOnHover:null,scrollable:!1,defaultType:"menuitem",tools:{close:!1},role:"menu",ariaElement:"bodyElement"}}construct(i){Array.isArray(i)&&(i={lazyItems:i}),super.construct(i),$.on({element:this.element,click:"onMouseClick",mouseover:"onMouseOver",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",thisObj:this})}afterShow(){const{items:i,element:e}=this;i.some(n=>!!n._menu)&&e.classList.add("b-menu-with-submenu"),i.some(n=>n.icon)&&e.classList.add("b-menu-with-icon"),super.afterShow(...arguments)}createWidget(i){return typeof i=="string"&&(i={text:i}),super.createWidget(i)}get focusElement(){var i;const e=this,t=(i=e.parentMenu)==null?void 0:i.element.contains(D.getActiveElement(e.parentMenu)),r=e.items[0];return t||D.usingKeyboard||!(r instanceof Or)?super.focusElement:e.element}onDocumentMouseDown({event:i}){if(!this.parentMenu||!this.parentMenu.owns(i.target))return super.onDocumentMouseDown(...arguments)}hide(i){var e,t;const r=this;super.hide(i),r.isVisible||((t=(e=r.currentSubMenu)==null?void 0:e.hide)==null||t.call(e,i),r.parentMenu&&(r.parentMenu.currentSubMenu=null))}show(){super.show(...arguments);const{parentMenu:i}=this;this.isVisible&&i&&(i.currentSubMenu=this)}onMouseClick(i){const e=i.target.closest(".b-menuitem");e&&this.triggerElement(e,i)}onMouseOver(i){var e;if(this.focusOnHover!==!1){const t=(e=i.relatedTarget)==null?void 0:e.closest(".b-widget"),r=i.target.closest(".b-widget"),n=j.fromElement(r);!D.isTouchEvent&&r&&r!==t&&n.parent===this&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[n],cancelOutstanding:!0})}}handleMouseOver(i){i.focus()}onMouseEnter(){this.clearTimeout(this.closeTimer)}onMouseLeave(i){const e=this,{relatedTarget:t}=i,r=t&&e.owns(t);let n=t instanceof HTMLElement&&j.fromElement(t),s=!r;if(n){for(;n.ownerCmp;)n=n.ownerCmp;s&=!D.getAncestor(n.element,[i.target])}!r&&s&&(e.currentSubMenu&&!e.currentSubMenu.closeTimer&&e.currentSubMenu.hide(),e.element.contains(D.getActiveElement(e))&&D.getActiveElement(e).matches(".b-menuitem")&&e.focusElement.focus())}onInternalKeyDown(i){const e=j.fromElement(i),t=e&&e!==this&&!(e instanceof Or);if(i.key==="Escape"){(t?this:this.rootMenu).close();return}if(super.onInternalKeyDown(i),t)return;kb[i.key]&&i.preventDefault();const r=this.element,n=D.getActiveElement(r);this.navigateFrom(n!==r&&r.contains(n)?n:null,i.key,i)}navigateFrom(i,e,t){const r=this,{treeWalker:n}=r,s=i&&r.getItem(i),a=r.rtl?"ArrowLeft":"ArrowRight",l=r.rtl?"ArrowRight":"ArrowLeft";let o;switch(e){case"ArrowUp":n.currentNode=i||(i=r.bottomFocusTrap),n.previousNode(),o=n.currentNode;break;case"ArrowDown":n.currentNode=i||(i=r.topFocusTrap),n.nextNode(),o=n.currentNode;break;case" ":i&&!i.classList.contains("b-disabled")&&(s!=null&&s.menu?r.openSubMenu(i,s):r.triggerElement(i,t));break;case a:if(i&&(s!=null&&s.menu)&&!i.classList.contains("b-disabled")){const u=r.openSubMenu(i,s);u==null||u.focus()}else n.currentNode=i||(i=r.topFocusTrap),n.nextNode(),o=n.currentNode;break;case l:r.isSubMenu?r.hide():i||(n.currentNode=i||(i=r.topFocusTrap),n.nextNode(),o=n.currentNode);break;case"Enter":i&&!i.classList.contains("b-disabled")&&r.triggerElement(i,t);break}o&&(o===r.element?r.navigateFrom(r.bottomFocusTrap,"ArrowUp",t):o===i?r.navigateFrom(r.topFocusTrap,"ArrowDown",t):o.focus())}getItem(i){if(i!=null)return typeof i=="number"?this.items[i]:i.nodeType===Element.ELEMENT_NODE?j.fromElement(i,"menuitem",this.contentElement):this.items.find(e=>e.id==i)}triggerElement(i,e){const t=this.getItem(i);t&&!t.disabled&&t.doAction(e)}get isSubMenu(){var i;return this===((i=this.owner)==null?void 0:i.menu)}openSubMenu(i,e){var t;const r=this,n=e.menu;if(n){if(!n.isVisible){const s={item:e,element:i};if(r.trigger("beforeSubMenu",s)===!1||((t=e.onBeforeSubMenu)==null?void 0:t.call(e,s))===!1)return;n.show()}return r.currentSubMenu=n}}set selectedElement(i){const e=this,t=e._selectedElement;if(t){const r=e.getItem(t),n=r==null?void 0:r.menu;n==null||n.hide(),t.classList.remove("b-active")}if(e._selectedElement=i,i){const r=D.isFocusable(i);i.classList.add("b-active"),e.scrollable.scrollIntoView(i,{animate:!r,focus:r})}}get selectedElement(){return this._selectedElement}selectFirst(){const i=this.treeWalker;i.currentNode=this.topFocusTrap,i.nextNode(),this.requestAnimationFrame(()=>i.currentNode.focus())}get parentMenu(){var i;const e=this.owner;return e&&(e.isMenu?e:(i=e.up)==null?void 0:i.call(e,"menu"))}get rootMenu(){let i=this;for(;i.parentMenu instanceof this.constructor;)i=i.parentMenu;return i}};y(Zt,"$name","Menu"),y(Zt,"type","menu"),Zt.initClass(),Zt._$name="Menu";var Ta,xa=class extends Ut{static get $name(){return"ContextMenuBase"}static get configurable(){return{type:null,menu:{$config:["lazy","nullify"],value:{type:"menu",autoShow:!1,closeAction:"hide",scrollAction:"hide",constrainTo:globalThis}},items:{},triggerEvent:!1,clickTriggerSelector:null,keyMap:{" ":{handler:"showContextMenuByKey",weight:100},"Ctrl+Space":"showContextMenuByKey"}}}static get pluginConfig(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick"]}}construct(...i){var e;if(super.construct(...i),!((e=this.type)!=null&&e.length))throw new Error("Config 'type' is required to be specified for context menu")}onElementContextMenu(i){this.onElementEvent(i)}onElementClick(i){this.onElementEvent(i)}onElementDblClick(i){this.onElementEvent(i)}onElementEvent(i){if(!i.handled&&this.triggerEvent===i.type){if(i.ctrlKey===!0&&!U.isMac){i.preventDefault();return}const e=i;if(Ta){const{target:t}=Ta;i=$.fixEvent(new MouseEvent(i.type,i)),Object.defineProperty(i,"target",{get:()=>t,configurable:!0}),i.preventDefault=function(){e.preventDefault(),e.handled=!0}}this.internalShowContextMenu(i)}else i.type==="click"&&this.clickTriggerSelector&&i.target.matches(this.clickTriggerSelector)&&this.internalShowContextMenu(i,{align:"l-r",target:i.target})}showContextMenuByKey(i){if(!D.isEditable(i.target)){const e=this.getKeyboardContextMenuTarget(i.target);if(e)return Ta=i,D.triggerMouseEvent(e,this.triggerEvent),i.handled=!0,i.preventDefault(),i.stopImmediatePropagation(),Ta=null,!0}return!1}getKeyboardContextMenuTarget(i){const e=D.isInView(i);return i.children.length?D.childFromPoint(i,e.width/2,e.height/2):i}internalShowContextMenu(i,e){const t=this;if(t.disabled)return;const r=t.getDataFromEvent(i);!i.handled&&!i.defaultPrevented&&r&&t.shouldShowMenu(r)&&(i.type==="contextmenu"&&U.isSafari&&i.ctrlKey&&!i.metaKey&&$.on({element:i.target,capture:!0,once:!0,thisObj:this,click(n){n.preventDefault(),n.stopImmediatePropagation()}}),r.domEvent=i,t.showContextMenu(r,e))}getDataFromEvent(i){return{event:i,targetElement:this.getTargetElementFromEvent(i)}}getTargetElementFromEvent(i){return i.target}async showContextMenu(i,e){var t,r;const n=this,s=D.isDOMEvent(i),a=s?n.getDataFromEvent(i):i,l=s?i:a.domEvent;if((t=n._menu)==null||t.hide(),n.disabled)return;n.menuContext=a;const{type:o,client:u,processItems:c}=n,d=D.isInView(a.targetElement).center;if(H.assign(a,{feature:n,point:l!=null&&l.clientX?[l.clientX+1,l.clientY+1]:[d.x,d.y],menu:n,items:{},selection:u.selectedRecords}),n.callChainablePopulateMenuMethod(a),H.merge(a.items,n.baseItems),n.preventDefaultEvent(a),(!c||await n.callback(c,u,[a])!==!1)&&n.hasActiveMenuItems(a)&&(n.populateItemsWithData(a),n.beforeContextMenuShow(a)!==!1)){const{menu:h}=n;let g=u.trigger(`${o}MenuBeforeShow`,a);x.isPromise(g)&&(l.handled=!0,g=await g),g!==!1&&(h.items=a.items,h.showBy(e||{target:a.domEvent}),(r=n.touchMoveDetacher)==null||r.call(n),n.touchMoveDetacher=$.on({element:u.element,touchmove:()=>h.hide(),thisObj:h,once:!0}),l&&(l.preventDefault(),l.handled=!0))}}get baseItems(){if(!this._baseItems){const i=this,{namedItems:e}=i,t=i._baseItems=H.assign({},i.items);for(const r in t){const n=t[r];n&&(e&&r in e?t[r]=typeof n=="object"?H.merge(H.clone(e[r]),n):e[r]:n===!0&&delete t[r])}}return this._baseItems}hideContextMenu(i){var e;(e=this.menu)==null||e.hide(i)}callChainablePopulateMenuMethod(i){var e,t;(t=(e=this.client)[`populate${P.capitalize(this.type)}Menu`])==null||t.call(e,i)}hasActiveMenuItems(i){return Object.values(i.items).some(e=>e&&!e.hidden)}shouldShowMenu(){return!0}beforeContextMenuShow(i){}populateItemsWithData(i){}preventDefaultEvent(i){var e;(e=i.event)==null||e.preventDefault()}changeTriggerEvent(i){return i||this.client.contextMenuTriggerEvent}changeMenu(i,e){const t=this,{client:r,type:n}=t;if(i)return Zt.reconfigure(e,i?Zt.mergeConfigs({owner:r,rootElement:r.rootElement,onItem(s){r.trigger(`${n}MenuItem`,s)},onToggle(s){r.trigger(`${n}MenuToggleItem`,s)},onDestroy(){t.menu=null},onBeforeItem(s){Object.assign(s,t.menuContext)},onShow({source:s}){t.menuContext.menu=s,r.trigger(`${n}MenuShow`,t.menuContext)}},i):null,t);e!=null&&e.isWidget&&e.destroy()}};xa._$name="ContextMenuBase";var Ib=i=>class extends(i||F){static get $name(){return"DragHelperContainer"}initContainerDrag(){const t=this;if(t.mode||(t.mode="container"),t.mode==="container"&&!t.containers)throw new Error("Container drag mode must specify containers")}grabContainerDrag(t){const r=this;if(!r.ignoreSelector||!t.target.closest(r.ignoreSelector)){const n=D.getAncestor(t.target,r.containers,r.outerElement);if(n){const s=n.getBoundingClientRect();r.context={element:n,valid:!0,action:"container",offsetX:t.pageX-s.left,offsetY:t.pageY-s.top,originalPosition:{parent:n.parentElement,prev:n.previousElementSibling,next:n.nextElementSibling}}}return!0}return!1}startContainerDrag(t){var r;const n=this,{context:s,floatRootOwner:a}=n,{element:l}=s,o=l.cloneNode(!0),u=a==null?void 0:a.element.closest(".b-outer");o.classList.add(n.dragProxyCls,n.draggingCls),((a==null?void 0:a.floatRoot)||D.getRootElement(l)).appendChild(o),s.dragProxy=o,s.dragging=l,l.classList.add(n.dropPlaceholderCls),(r=u==null?void 0:u.parentElement)!=null&&r.matches(".b-float-root")&&(o.style.zIndex=a.floatRootMaxZIndex+1)}onContainerDragStarted(t){const r=this,{context:n}=r,{element:s,dragProxy:a}=n,l=s.getBoundingClientRect();if(r.autoSizeClonedTarget)a.style.width=l.width+"px",a.style.height=l.height+"px",D.setTranslateXY(n.dragProxy,l.left,l.top);else{const o=a.getBoundingClientRect();Object.assign(n,{offsetX:o.width/2,offsetY:o.height/2}),D.setTranslateXY(a,t.clientX,t.clientY)}}updateContainerDrag(t){var r;const n=this,{context:s}=n;if(!s.started||!s.targetElement)return;const a=D.getAncestor(s.targetElement,n.containers,"b-gridbase"),l=(r=s.dragging)==null?void 0:r.contains(D.getActiveElement(s.dragging));a&&D.isDescendant(s.element,a)||(l&&Me.suspendFocusEvents(),a&&s.valid?n.moveNextTo(a,t):n.revertPosition(),l&&Me.resumeFocusEvents(),t.preventDefault())}finishContainerDrag(t){const r=this,{context:n}=r,{dragging:s,dragProxy:a,valid:l,draggedTo:o,insertBefore:u,originalPosition:c}=n;s&&(n.valid=!!(l&&(o||r.externalDropTargetSelector&&t.target.closest(r.externalDropTargetSelector))&&(s!==u||c.parent!==o)),n.finalize=(d=n.valid)=>{!d&&r.context&&r.revertPosition(),s.classList.remove(r.dropPlaceholderCls),a.remove(),r.reset()},n.async=!1,r.trigger("drop",{context:n,event:t}),n.async||n.finalize())}abortContainerDrag(t=!1,r=null,n=!1){const s=this,{context:a}=s;a.dragging&&(a.dragging.classList.remove(s.dropPlaceholderCls),a.dragProxy.remove(),s.revertPosition()),n||s.trigger(t?"drop":"abort",{context:a,event:r}),s.reset()}updateContainerProxy(t){const r=this,{context:n}=r,s=n.dragProxy;let a=t.pageX-n.offsetX,l=t.pageY-n.offsetY;typeof r.minX=="number"&&(a=Math.max(r.minX,a)),typeof r.maxX=="number"&&(a=Math.min(r.maxX-s.offsetWidth,a)),typeof r.minY=="number"&&(l=Math.max(r.minY,l)),typeof r.maxY=="number"&&(l=Math.min(r.maxY-s.offsetHeight,l)),r.lockX?D.setTranslateY(s,l):r.lockY?D.setTranslateX(s,a):D.setTranslateXY(s,a,l);let o;if(t.type==="touchmove"){const u=t.changedTouches[0];o=D.elementFromPoint(u.clientX,u.clientY)}else o=t.target;n.targetElement=o}moveNextTo(t,r){const{context:n}=this,s=n.dragging,a=t.parentElement;if(t!==s){const l=V.from(t).center.x;this.isRTL&&r.pageX>l||!this.isRTL&&r.pageX<l?(a.insertBefore(s,t),n.insertBefore=t):t.nextElementSibling?t.nextElementSibling!==s?(n.insertBefore=t.nextElementSibling,a.insertBefore(s,t.nextElementSibling)):!n.insertBefore&&s.parentElement.lastElementChild!==s&&(n.insertBefore=t.nextElementSibling):(a.appendChild(s),n.insertBefore=null),n.draggedTo=a}}revertPosition(){const{context:t}=this,{dragging:r}=t,{parent:n,next:s}=t.originalPosition;s?s.previousSibling===r||!s&&r===n.lastChild||n.insertBefore(r,s):n.appendChild(r),t.draggedTo=null}},Mb={pageXOffset:0,pageYOffset:0},Rb=i=>class extends xe(i||F){static get $name(){return"DragHelperTranslate"}static get configurable(){return{positioning:null,skipUpdatingElement:null}}initTranslateDrag(){const t=this;!t.isElementDraggable&&t.targetSelector&&(t.isElementDraggable=r=>r.closest(t.targetSelector))}grabTranslateDrag(t){const r=this.getTarget(t);return r?(this.context={valid:!0,element:r,startPageX:t.pageX,startPageY:t.pageY,startClientX:t.clientX,startClientY:t.clientY},!0):!1}getTarget(t){return t.target.closest(this.targetSelector)}getX(t){return this.positioning==="absolute"?parseFloat(t.style.left,10):D.getTranslateX(t)}getY(t){return this.positioning==="absolute"?parseFloat(t.style.top,10):D.getTranslateY(t)}getXY(t){return this.positioning==="absolute"?[t.offsetLeft,t.offsetTop]:D.getTranslateXY(t)}setXY(t,r,n){this.skipUpdatingElement||(this.positioning==="absolute"?(t.style.left=r+"px",t.style.top=n+"px"):D.setTranslateXY(t,r,n))}startTranslateDrag(t){const r=this,{context:n,outerElement:s,proxySelector:a}=r,l=r.dragWithin=r.dragWithin||r.cloneTarget&&document.body;let o=n.dragProxy||n.element;const u=o,c=o.parentElement;if(r.cloneTarget){const d=a?o.querySelector(a):o,{width:h,height:g,x:f,y:m}=V.from(d,V.outer(l));o=r.createProxy(o);let p=f,v=m;if(r.autoSizeClonedTarget&&(o.style.width=`${h}px`,o.style.height=`${g}px`),o.classList.add(r.dragProxyCls,r.draggingCls),o.classList.remove("b-hover","b-selected","b-focused"),l.appendChild(o),!r.autoSizeClonedTarget||a){const b=o.getBoundingClientRect(),{x:w,y:S}=l.getBoundingClientRect(),C=t.clientX-w,T=t.clientY-S+(l!==document.body?document.body.getBoundingClientRect().y:0);p=C-b.width/2,v=T-b.height/2,n.startPageX=t.pageX,n.startPageY=t.pageY}r.setXY(o,p,v),u.classList.add("b-drag-original"),r.hideOriginalElement&&u.classList.add("b-hidden")}o.classList.add(r.draggingCls),Object.assign(n,{element:o,grabbed:u,grabbedParent:c,grabbedNextSibling:o.nextElementSibling,elementStartX:r.getX(o),elementStartY:r.getY(o),elementX:D.getOffsetX(o,l||s),elementY:D.getOffsetY(o,l||s),scrollX:0,scrollY:0,scrollManagerElementContainsDragProxy:!r.cloneTarget||l===s}),l&&(n.parentElement=o.parentElement,l!==o.parentElement&&l.appendChild(o),r.updateTranslateProxy(t))}onTranslateDragStarted(){const t=this,{context:r}=t;let{relatedElements:n}=r;if(t.unifiedProxy&&r.element.classList.add("b-drag-main","b-drag-unified-proxy"),(n==null?void 0:n.length)>0){r.relatedElStartPos=[],r.relatedElDragFromPos=[];const{proxySelector:s}=t;let[a,l]=[r.elementStartX,r.elementStartY];r.originalRelatedElements=n,n=r.relatedElements=n.map((o,u)=>{const c=s?o.querySelector(s):o,{x:d,y:h,width:g,height:f}=V.from(c,t.dragWithin),m=t.cloneTarget?t.createProxy(o):o;return m.classList.add(t.draggingCls),m.classList.remove("b-hover","b-selected","b-focused"),t.cloneTarget&&(t.setXY(m,d,h),t.dragWithin.appendChild(m),m.classList.add(t.dragProxyCls),t.autoSizeClonedTarget&&(m.style.width=`${g}px`,m.style.height=`${f}px`),t.hideOriginalElement&&o.classList.add("b-hidden"),o.classList.add("b-drag-original")),r.relatedElStartPos[u]=r.relatedElDragFromPos[u]=t.getXY(m),t.unifiedProxy&&(m.classList.add("b-drag-unified-animation","b-drag-unified-proxy"),a+=t.unifiedOffset,l+=t.unifiedOffset,t.setXY(m,a,l),r.relatedElDragFromPos[u]=[a,l],m.style.zIndex=100-u),m}),t.unifiedProxy&&n&&n.length>0&&$.onTransitionEnd({element:n[0],property:"transform",handler(){n.forEach(o=>o.classList.remove("b-drag-unified-animation"))},thisObj:t,once:!0})}}applyConstraints(t,r,n){const s=this,{constrain:a,dragWithin:l}=s,{pageXOffset:o,pageYOffset:u}=l===document.body?globalThis:Mb;return l&&a&&(r<0&&(r=0),r+t.offsetWidth>l.scrollWidth&&(r=l.scrollWidth-t.offsetWidth),n<0&&(n=0),n+t.offsetHeight>l.scrollHeight&&(n=l.scrollHeight-t.offsetHeight)),typeof s.minX=="number"&&(r=Math.max(s.minX+o,r)),typeof s.maxX=="number"&&(r=Math.min(s.maxX+o,r)),typeof s.minY=="number"&&(n=Math.max(s.minY+u,n)),typeof s.maxY=="number"&&(n=Math.min(s.maxY+u,n)),{constrainedX:r,constrainedY:n}}updateTranslateProxy(t,r){const n=this,{lockX:s,lockY:a,context:l}=n,o=l.dragProxy||l.element,{relatedElements:u,relatedElDragFromPos:c}=l;l.scrollManagerElementContainsDragProxy&&r&&(l.scrollX=r.getRelativeLeftScroll(o),l.scrollY=r.getRelativeTopScroll(o)),l.pageX=t.pageX,l.pageY=t.pageY,l.clientX=t.clientX,l.clientY=t.clientY;let d=l.elementStartX+t.pageX-l.startPageX+l.scrollX,h=l.elementStartY+t.pageY-l.startPageY+l.scrollY;if(n.snapCoordinates){const m=n.snapCoordinates({element:o,newX:d,newY:h});d=m.x,h=m.y}const{constrainedX:g,constrainedY:f}=n.applyConstraints(o,d,h);if((l.started||g!==d||f!==h)&&n.setXY(o,s?void 0:g,a?void 0:f),u){const m=s?0:g-l.elementStartX,p=a?0:f-l.elementStartY;u.forEach((v,b)=>{const[w,S]=c[b];n.setXY(v,w+m,S+p)})}l.newX=g,l.newY=f}async finishTranslateDrag(t){const r=this,n=r.context,{target:s}=t,a=!r.lockX&&Math.round(n.newX)!==Math.round(n.elementStartX),l=!r.lockY&&Math.round(n.newY)!==Math.round(n.elementStartY),o=n.dragProxy||n.element,{relatedElements:u}=n;if(!r.ignoreSamePositionDrop||a||l)if(n.valid===!1)await r.abortTranslateDrag(!0,t);else{const c=!r.allowDropOutside&&V.from(r.dragWithin||r.outerElement);c&&(typeof r.minX!="number"&&r.minX!==!0&&t.pageX<c.left||typeof r.maxX!="number"&&r.maxX!==!0&&t.pageX>c.right||typeof r.minY!="number"&&r.minY!==!0&&t.pageY<c.top||typeof r.maxY!="number"&&r.maxY!==!0&&t.pageY>c.bottom)?await r.abortTranslateDrag(!0,t):(n.finalize=async(d=n.valid)=>{if(n.finalized){console.warn("DragHelper: Finalizing already finalized drag");return}n.finalized=!0,!d&&r.context&&await r.abortTranslateDrag(!0,null,!0),r.isDestroyed||(r.trigger("dropFinalized",{context:n,event:t,target:s}),r.reset()),!r.cloneTarget&&o.parentElement!==n.grabbedParent&&[o,...u||[]].forEach(h=>h.style.transform="")},n.async=!1,await r.trigger("drop",{context:n,event:t,target:s}),n.async||await n.finalize())}else r.abortTranslateDrag(!1,t)}async abortTranslateDrag(t=!1,r=null,n=!1){var s,a;const l=this,{cloneTarget:o,context:u,proxySelector:c,dragWithin:d,draggingCls:h}=l,{relatedElements:g,relatedElStartPos:f,grabbed:m}=u,p=u.dragProxy||u.element;if(u.valid=!1,(s=l.scrollManager)==null||s.stopMonitoring(),u.aborted){console.warn("DragHelper: Aborting already aborted drag");return}let{elementStartX:v,elementStartY:b}=u;const w=v!==l.getX(p)||b!==l.getY(p);if(p&&u.started){if(!o&&d&&d!==u.grabbedParent&&u.grabbedParent.insertBefore(p,u.grabbedNextSibling),o&&c){const S=m.querySelector(c)||m,{x:C,y:T}=V.from(S);v=C,b=T}p.classList.add("b-aborting"),l.setXY(p,v,b),g==null||g.forEach((S,C)=>{S.classList.remove(h),S.classList.add("b-aborting"),l.setXY(S,f[C][0],f[C][1])}),n||l.trigger(t?"drop":"abort",{context:u,event:r}),p.isConnected&&!l.isDestroying&&w&&await $.waitForTransitionEnd({element:p,property:D.getPropertyTransitionDuration(p,"transform")?"transform":"all",thisObj:l,once:!0,runOnDestroy:!0}),l.isDestroyed||l.trigger("abortFinalized",{context:u,event:r})}(a=l.context)!=null&&a.started&&l.reset()}cleanUp(){const t=this,{context:r,cloneTarget:n,draggingCls:s,dragProxyCls:a}=t,l=r.dragProxy||r.element,{relatedElements:o,originalRelatedElements:u,grabbed:c}=r,d=n&&(t.removeProxyAfterDrop||!r.valid),h=[s,"b-aborting",a,"b-drag-main","b-drag-unified-proxy"];l.classList.remove(...h),d&&l.remove(),o==null||o.forEach(g=>{d?g.remove():g.classList.remove(...h)}),c.classList.remove("b-drag-original","b-hidden"),u==null||u.forEach(g=>g.classList.remove("b-hidden","b-drag-original"))}},fi={move:"onMouseMove",up:"onMouseUp",docclick:"onDocumentClick",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",keydown:"onKeyDown"},uf=class extends F.mixin(fe,Ib,Rb){static get defaultConfig(){return{dragProxyCls:"b-drag-proxy",invalidCls:"b-drag-invalid",draggingCls:"b-dragging",dropPlaceholderCls:"b-drop-placeholder",dragThreshold:5,outerElement:document.body,dragWithin:null,unifiedProxy:null,monitoringConfig:null,constrain:!0,minX:null,maxX:null,minY:null,maxY:null,mode:"translateXY",isElementDraggable:null,targetSelector:null,dropTargetSelector:null,dropTargetCls:null,proxySelector:null,cloneTarget:!1,autoSizeClonedTarget:!0,hideOriginalElement:!1,containers:null,ignoreSelector:null,startEvent:null,lockX:!1,lockY:!1,touchStartDelay:300,scrollManager:null,snapCoordinates:null,unifiedOffset:5,removeProxyAfterDrop:!0,clickSwallowDuration:50,ignoreSamePositionDrop:!0,allowDropOutside:null,floatRootOwner:null,mouseMoveListenerElement:document,externalDropTargetSelector:null,testConfig:{transitionDuration:10,clickSwallowDuration:50,touchStartDelay:100},rtlSource:null,createProxy:null}}construct(i){const e=this;super.construct(i),e.initListeners(),e.isContainerDrag?e.initContainerDrag():e.initTranslateDrag(),e.onScrollManagerScrollCallback=e.onScrollManagerScrollCallback.bind(e)}doDestroy(){this.reset(!0),super.doDestroy()}initListeners(){const i=this,{outerElement:e}=i,t={element:e,pointerdown:"onPointerDown",thisObj:i};i.mouseMoveListenerElement=i.getMouseMoveListenerTarget(e),$.on(t)}getMouseMoveListenerTarget(i){const e=i.getRootNode();let t=this.mouseMoveListenerElement;return e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.mode==="closed"&&(t=i.closest(".b-outer")||t),t}get isRTL(){var i;return!!((i=this.rtlSource)!=null&&i.rtl)}onPointerDown(i){const e=this;if(i.button!==0||e.context||e.isElementDraggable&&!e.isElementDraggable(i.target,i))return;if(e.startEvent=i,e.isContainerDrag?e.grabContainerDrag(i):e.grabTranslateDrag(i)){e.blurDetacher=$.on({element:globalThis,blur:e.onWindowBlur,thisObj:e});const r={element:e.mouseMoveListenerElement,thisObj:e,capture:!0,keydown:fi.keydown};if(i.pointerType==="touch"?(e.touchStartTimer=e.setTimeout(()=>e.touchStartTimer=null,e.touchStartDelay,"touchStartDelay"),r.touchmove={handler:fi.touchmove,passive:!1},r.touchend=r.pointerup=fi.touchend):(r.pointermove=fi.move,r.pointerup=fi.up),e.dragListenersDetacher=$.on(r),e.dragWithin&&e.dragWithin!==e.outerElement&&e.outerElement.contains(e.dragWithin)){const n=V.from(e.dragWithin,e.outerElement);e.minY=n.top,e.maxY=n.bottom,e.minX=n.left,e.maxX=n.right}}}async internalMove(i){var e,t;if(i.scrollInitiated)return;const r=this,{context:n}=r,s=$.getDistanceBetween(r.startEvent,i);if(r.touchStartTimer&&s>r.dragThreshold){r.abort(!0);return}if(!r.touchStartTimer&&(n!=null&&n.element)&&(n.started||s>=r.dragThreshold)&&((e=i.target)==null?void 0:e.nodeType)===Node.ELEMENT_NODE){if(!n.started){if(r.trigger("beforeDragStart",{context:n,event:i})===!1)return r.abort();r.isContainerDrag?r.startContainerDrag(i):r.startTranslateDrag(i),n.started=!0,(t=r.scrollManager)==null||t.startMonitoring(x.merge({scrollables:[{element:r.dragWithin||r.outerElement}],callback:r.onScrollManagerScrollCallback},r.monitoringConfig)),n.outermostEl=D.getOutermostElement(i.target),n.outermostEl.classList.add("b-draghelper-active"),r.dropTargetSelector&&r.dropTargetCls&&D.getRootElement(r.outerElement).querySelectorAll(r.dropTargetSelector).forEach(o=>o.classList.add(r.dropTargetCls));const l=r.trigger("dragStart",{context:n,event:i});x.isPromise(l)&&await l,n.moveUnblocked=!0,r.isContainerDrag?r.onContainerDragStarted(i):r.onTranslateDragStarted(i),r.trigger("afterDragStart",{context:n,event:i})}n.moveUnblocked?r._cachedMouseEvent?(r.update(i),r.update(r._cachedMouseEvent),delete r._cachedMouseEvent):r.update(i):r._cachedMouseEvent=i,i.type==="touchmove"&&(i.preventDefault(),i.stopImmediatePropagation())}}onScrollManagerScrollCallback(i){var e;const{lastMouseMoveEvent:t}=this;(e=this.context)!=null&&e.element&&t&&(t.isScroll=!0,this.update(t,i))}onTouchMove(i){this.internalMove(i)}onMouseMove(i){this.internalMove(i)}update(i,e){const t=this,{context:r}=t,n=document.scrollingElement||document.body;let s=t.getMouseMoveEventTarget(i);if(i.type==="touchmove"){const l=i.changedTouches[0];s=D.elementFromPoint(l.clientX+n.scrollLeft,l.clientY+n.scrollTop)}r.target=s;let a=t.allowDropOutside||!t.dragWithin||t.dragWithin.contains(i.target);a&&t.dropTargetSelector&&(a=a&&!!(s!=null&&s.closest(t.dropTargetSelector))),t.isContainerDrag?t.updateContainerProxy(i,e):t.updateTranslateProxy(i,e),r.valid=a,t.trigger("drag",{context:r,event:i}),t.isContainerDrag&&t.updateContainerDrag(i,e),r.valid=r.valid&&a;for(const l of t.draggedElements)l.classList.toggle(t.invalidCls,!r.valid);i&&(t.lastMouseMoveEvent=i)}get draggedElements(){var i;const{context:e}=this;return[e.dragProxy||e.element,...(i=e.relatedElements)!=null?i:[]]}async abort(i=!1){var e,t;const r=this,{context:n}=r;(t=(e=r.scrollManager)==null?void 0:e.stopMonitoring)==null||t.call(e),r.removeListeners(),n!=null&&n.started&&!n.aborted?(n.element.getBoundingClientRect(),n.valid=!1,r.isContainerDrag?r.abortContainerDrag(void 0,void 0,i):r.abortTranslateDrag(void 0,void 0,i),n.aborted=!0):r.reset(!0)}removeListeners(){var i,e;(i=this.dragListenersDetacher)==null||i.call(this),(e=this.blurDetacher)==null||e.call(this)}reset(i){const e=this,{context:t}=e;if(t!=null&&t.started){for(const r of e.draggedElements)r.classList.remove(e.invalidCls);t.outermostEl.classList.remove("b-draghelper-active"),e.isContainerDrag?t.dragProxy.remove():e.cleanUp(),e.dropTargetSelector&&e.dropTargetCls&&D.getRootElement(e.outerElement).querySelectorAll(e.dropTargetSelector).forEach(r=>r.classList.remove(e.dropTargetCls))}e.removeListeners(),i||e.trigger("reset"),e.context=e.lastMouseMoveEvent=null}onTouchEnd(i){this.onMouseUp(i)}onDocumentClick(i){i.stopPropagation()}onMouseUp(i){var e;const t=this,{context:r}=t;t.removeListeners(),r&&((e=t.scrollManager)==null||e.stopMonitoring(),r.started?r.moveUnblocked?(i.stopPropagation(),r.finalizing=!0,t.isContainerDrag?t.finishContainerDrag(i):t.finishTranslateDrag(i),$.on({element:document,thisObj:t,click:fi.docclick,capture:!0,expires:t.clickSwallowDuration,once:!0})):t.ion({drag(){t.onMouseUp(i)},once:!0}):t.reset(!0))}onKeyDown(i){var e;(e=this.context)!=null&&e.started&&i.key==="Escape"&&(i.stopImmediatePropagation(),this.abort())}onWindowBlur(){this.context&&!this.context.finalizing&&this.abort()}createProxy(i){this.proxySelector&&(i=i.querySelector(this.proxySelector)||i);const e=i.cloneNode(!0);return e.removeAttribute("id"),e}get isContainerDrag(){return this.mode==="container"}async animateProxyTo(i,e={align:"c-c"}){const{context:t,draggedElements:r}=this,{element:n}=t,s=i.isRectangle?i:V.from(i);r.forEach(a=>{a.classList.add("b-drag-final-transition"),D.alignTo(a,s,e)}),await $.waitForTransitionEnd({element:n,property:"all",thisObj:this,once:!0}),r.forEach(a=>a.classList.remove("b-drag-final-transition"))}get isDragging(){var i;return!!((i=this.context)!=null&&i.started)}getMouseMoveEventTarget(i){return i.isScroll?D.elementFromPoint(i.clientX,i.clientY):i.target}};uf._$name="DragHelper";var Mt={down:"onMouseDown",move:"onMouseMove",up:"onMouseUp",docclick:"onDocumentClick",touchstart:{handler:"onTouchStart",passive:!1},touchmove:"onTouchMove",touchend:"onTouchEnd",keydown:"onKeyDown"},Ro=class extends fe(F){static get defaultConfig(){return{resizingCls:"b-resizing",dragThreshold:5,handleSize:10,dynamicHandleSize:null,reservedSpace:10,touchHandleSize:30,minWidth:1,maxWidth:0,minHeight:1,maxHeight:0,outerElement:document.body,scroller:null,allowResize:null,dragWithin:null,isElementResizable:null,targetSelector:null,leftHandle:!0,rightHandle:!0,topHandle:!0,bottomHandle:!0,handleSelector:null,handleContainerSelector:null,startEvent:null,grab:null,invalidCls:"b-resize-invalid",handleVisibilityThreshold:null,skipTranslate:!1,direction:"horizontal",clickSwallowDuration:50,rtlSource:null}}construct(i){const e=this;super.construct(i),!e.handleSelector&&!U.isHoverableDevice&&(e.handleSize=e.touchHandleSize),e.handleVisibilityThreshold=e.handleVisibilityThreshold||2*e.handleSize,e.initListeners(),e.initResize()}doDestroy(){this.abort(!0),super.doDestroy()}updateSkipUpdatingElement(i){i&&(this.skipTranslate=!0)}initResize(){const i=this;if(!i.isElementResizable&&i.targetSelector&&(i.isElementResizable=e=>e.closest(i.targetSelector)),i.grab){const{edge:e,element:t,event:r}=i.grab;i.startEvent=r;const n=i.getCursorOffsetToElementEdge(r,t,e);i.context={element:t,edge:e,valid:!0,async:!1,elementStartX:D.getTranslateX(t)||t.offsetLeft,elementStartY:D.getTranslateY(t)||t.offsetTop,newX:D.getTranslateX(t)||t.offsetLeft,newY:D.getTranslateY(t)||t.offsetTop,elementWidth:t.offsetWidth,elementHeight:t.offsetHeight,cursorOffset:n,startX:r.clientX+n.x+i.scrollLeft,startY:r.clientY+n.y+i.scrollTop,finalize:()=>{var s;return(s=i.reset)==null?void 0:s.call(i)}},t.classList.add(i.resizingCls),i.internalStartResize(i.isTouch)}}initListeners(){const i=this,e={element:i.outerElement,mousedown:Mt.down,touchstart:Mt.touchstart,thisObj:i};!i.handleSelector&&U.isHoverableDevice&&(e.mousemove={handler:Mt.move,delegate:i.targetSelector},e.mouseleave={handler:"onMouseLeaveTarget",delegate:i.targetSelector,capture:!0}),$.on(e)}get isRTL(){var i;return!!((i=this.rtlSource)!=null&&i.rtl)}get scrollLeft(){return this.scroller?this.scroller.x:this.outerElement.scrollLeft}get scrollTop(){return this.scroller?this.scroller.y:this.outerElement.scrollTop}internalStartResize(i){var e;const t={element:document,keydown:Mt.keydown,thisObj:this};i?(t.touchmove=Mt.touchmove,t.touchend=t.pointerup=Mt.touchend):(t.mousemove=Mt.move,t.mouseup=Mt.up),this.removeDragListeners=$.on(t),(e=this.onResizeHandlePointerDown)==null||e.call(this,this.startEvent)}removeDragListeners(){}reset(){var i;(i=this.removeDragListeners)==null||i.call(this),this.context=null,this.trigger("reset")}canResize(i,e){return!this.isElementResizable||this.isElementResizable(i,e)}onPointerDown(i,e){const t=this;t.startEvent=e,t.canResize(e.target,e)&&t.grabResizeHandle(i,e)&&(e.stopImmediatePropagation(),e.type==="touchstart"&&e.preventDefault(),t.internalStartResize(i))}onTouchStart(i){i.touches.length>1||this.onPointerDown(!0,i)}onMouseDown(i){i.button===0&&this.onPointerDown(!1,i)}internalMove(i,e){var t;const r=this,{context:n,direction:s}=r;n!=null&&n.element&&(n.started||$.getDistanceBetween(r.startEvent,e)>=r.dragThreshold)?(n.started||((t=r.scrollManager)==null||t.startMonitoring(x.merge({scrollables:[{element:r.dragWithin||r.outerElement,direction:s}],callback:a=>{var l;return((l=r.context)==null?void 0:l.element)&&r.lastMouseMoveEvent&&r.update(r.lastMouseMoveEvent,a)}},r.monitoringConfig)),r.trigger("resizeStart",{context:n,event:e}),n.started=!0),r.update(e)):!i&&!r.handleSelector&&r.checkResizeHandles(e)}onTouchMove(i){this.internalMove(!0,i)}onMouseMove(i){this.internalMove(!1,i)}onPointerUp(i,e){var t,r,n;const s=this,a=s.context;(t=s.removeDragListeners)==null||t.call(s),a?((r=s.scrollManager)==null||r.stopMonitoring(),a.started&&$.on({element:document,thisObj:s,click:Mt.docclick,expires:s.clickSwallowDuration,capture:!0,once:!0}),s.finishResize(e)):(n=s.reset)==null||n.call(s)}onTouchEnd(i){this.onPointerUp(!0,i)}onMouseUp(i){this.onPointerUp(!1,i)}onDocumentClick(i){i.stopPropagation()}onKeyDown(i){i.key==="Escape"&&this.abort()}update(i){const e=this,t=e.context,{element:r}=t,n=V.from(e.outerElement);t.currentX=Math.max(Math.min(i.clientX+t.cursorOffset.x,n.right),n.x)+e.scrollLeft,t.currentY=Math.max(Math.min(i.clientY+t.cursorOffset.y,n.bottom),n.y)+e.scrollTop,r.classList.add(e.resizingCls),i&&(e.updateResize(i)&&(e.trigger("resizing",{context:t,event:i}),r.classList.toggle(e.invalidCls,t.valid===!1)),e.lastMouseMoveEvent=i)}abort(i=!1){var e,t;const r=this;(t=(e=r.scrollManager)==null?void 0:e.stopMonitoring)==null||t.call(e),r.context?r.abortResize(null,i):r.isDestroyed||r.reset()}grabResizeHandle(i,e){var t;const r=this;if(r.allowResize&&!r.allowResize(e.target,e))return!1;const n=r.handleSelector,s=e.type==="touchstart"?e.changedTouches[0]:e,a=s.clientX,l=s.clientY;let o=r.targetSelector?e.target.closest(r.targetSelector):e.target;if(o){let u;if(n)if(e.target.matches(n))r.direction==="horizontal"?e.pageX<D.getPageX(o)+o.offsetWidth/2?u=r.isRTL?"right":"left":u=r.isRTL?"left":"right":e.pageY<D.getPageY(o)+o.offsetHeight/2?u="top":u="bottom";else return!1;else if(r.direction==="horizontal"?r.overLeftHandle(e,o)?u=r.isRTL?"right":"left":r.overRightHandle(e,o)&&(u=r.isRTL?"left":"right"):r.overTopHandle(e,o)?u="top":r.overBottomHandle(e,o)&&(u="bottom"),!u)return r.context=null,!1;e.type==="touchstart"&&e.preventDefault();const c=r.getCursorOffsetToElementEdge(s,o,u),d=(t=r.internalBeforeStart)==null?void 0:t.call(r,{element:o,edge:u});if(d&&(o=d.element,u=d.edge),r.trigger("beforeResizeStart",{element:o,event:e})!==!1)return r.context={element:o,edge:u,isTouch:i,valid:!0,async:!1,direction:r.direction,elementStartX:D.getTranslateX(o)||o.offsetLeft,elementStartY:D.getTranslateY(o)||o.offsetTop,newX:D.getTranslateX(o)||o.offsetLeft,newY:D.getTranslateY(o)||o.offsetTop,elementWidth:o.offsetWidth,elementHeight:o.offsetHeight,cursorOffset:c,startX:a+c.x+r.scrollLeft,startY:l+c.y+r.scrollTop,finalize:()=>{var h;return(h=r.reset)==null?void 0:h.call(r)}},o.classList.add(r.resizingCls),!0}return!1}getCursorOffsetToElementEdge(i,e,t){const r=V.from(e);let n=0,s=0;switch(t){case"left":n=r.x-(this.isRTL?r.width:0)-i.clientX;break;case"right":n=r.x+(this.isRTL?0:r.width)-i.clientX;break;case"top":s=r.y-i.clientY;break;case"bottom":s=r.y+r.height-i.clientY;break}return{x:n,y:s}}checkResizeHandles(i){const e=this,t=e.targetSelector?i.target.closest(e.targetSelector):i.target;if(t&&(!e.allowResize||e.allowResize(i.target,i))){if(e.currentElement=e.handleContainerSelector?i.target.closest(e.handleContainerSelector):i.target,e.currentElement){let r;e.direction==="horizontal"?r=e.overLeftHandle(i,t)||e.overRightHandle(i,t):r=e.overTopHandle(i,t)||e.overBottomHandle(i,t),r?e.highlightHandle():e.unHighlightHandle()}}else e.currentElement&&e.unHighlightHandle()}onMouseLeaveTarget(i){const e=this;e.currentElement=e.handleContainerSelector?i.target.closest(e.handleContainerSelector):i.target,e.currentElement&&e.unHighlightHandle()}updateResize(i){const e=this,{context:t,allowEdgeSwitch:r,skipTranslate:n,skipUpdatingElement:s}=e;let a;r&&(e.direction==="horizontal"?t.edge=t.currentX>t.startX?"right":"left":t.edge=t.currentY>t.startY?"bottom":"top");const{element:l,elementStartX:o,elementStartY:u,elementWidth:c,elementHeight:d,edge:h}=t,{style:g}=l,f=t.currentX-t.startX,m=t.currentY-t.startY,p=D.getExtremalSizePX(l,"minWidth")||e.minWidth,v=D.getExtremalSizePX(l,"maxWidth")||e.maxWidth,b=D.getExtremalSizePX(l,"minHeight")||e.minHeight,w=D.getExtremalSizePX(l,"maxHeight")||e.maxHeight,S=h==="right"&&!e.isRTL||h==="bottom"?1:-1,C=c+f*S,T=d+m*S;let E=Math.max(p,C),I=Math.max(b,T);if(v>0&&(E=Math.min(E,v)),w>0&&(I=Math.min(I,w)),g.flex&&(g.flex=""),e.direction==="horizontal"&&c!==E){if(s||(g.width=Math.abs(E)+"px"),t.newWidth=E,h==="left"||E<0){const R=Math.max(Math.min(o+c-e.minWidth,o+f),0);n||D.setTranslateX(l,Math.round(R)),t.newX=R}else h==="right"&&r&&!n&&D.setTranslateX(l,o);a=!0}else e.direction==="vertical"&&d!==T&&(s||(g.height=Math.abs(I)+"px"),t.newHeight=I,h==="top"||I<0?(t.newY=Math.max(Math.min(u+d-e.minHeight,u+m),0),n||D.setTranslateY(l,t.newY)):h==="bottom"&&r&&!n&&D.setTranslateY(l,u),a=!0);return a}finishResize(i){var e;const t=this,r=t.context,n={context:r,event:i};if(r.element.classList.remove(t.resizingCls),r.started){let s=!1;t.direction==="horizontal"?s=r.newWidth&&r.newWidth!==r.elementWidth:s=r.newHeight&&r.newHeight!==r.elementHeight,t.trigger(s?"resize":"cancel",n),r.async||r.finalize()}else(e=t.reset)==null||e.call(t)}abortResize(i=null,e=!1){const t=this,r=t.context;r.element.classList.remove(t.resizingCls),t.direction==="horizontal"?((r.edge==="left"||r.allowEdgeSwitch&&!r.skipTranslate)&&D.setTranslateX(r.element,r.elementStartX),r.element.style.width=r.elementWidth+"px"):(D.setTranslateY(r.element,r.elementStartY),r.element.style.height=r.elementHeight+"px"),!e&&t.trigger("cancel",{context:r,event:i}),t.isDestroyed||t.reset()}highlightHandle(){const i=this,e=i.targetSelector?i.currentElement.closest(i.targetSelector):i.currentElement;i.currentElement.classList.add("b-resize-handle"),e.classList.add("b-over-resize-handle")}unHighlightHandle(){const i=this,e=i.targetSelector?i.currentElement.closest(i.targetSelector):i.currentElement;e&&e.classList.remove("b-over-resize-handle"),i.currentElement.classList.remove("b-resize-handle"),i.currentElement=null}overAnyHandle(i,e){return this.overStartHandle(i,e)||this.overEndHandle(i,e)}overStartHandle(i,e){return this.direction==="horizontal"?this.overLeftHandle(i,e):this.overTopHandle(i,e)}overEndHandle(i,e){return this.direction==="horizontal"?this.overRightHandle(i,e):this.overBottomHandle(i,e)}getDynamicHandleSize(i,e){const t=i?2:1,{handleSize:r}=this;return this.dynamicHandleSize&&r*t>e-this.reservedSpace?Math.max(Math.floor((e-this.reservedSpace)/t),0):r}overLeftHandle(i,e){const t=this,{offsetWidth:r}=e;if(t.leftHandle&&t.canResize(e,i)&&(r>=t.handleVisibilityThreshold||t.dynamicHandleSize)){const n=V.from(e);return n.width=t.getDynamicHandleSize(t.rightHandle,r),n.width>0&&n.contains($.getPagePoint(i))}return!1}overRightHandle(i,e){const t=this,{offsetWidth:r}=e;if(t.rightHandle&&t.canResize(e,i)&&(r>=t.handleVisibilityThreshold||t.dynamicHandleSize)){const n=V.from(e);return n.x=n.right-t.getDynamicHandleSize(t.leftHandle,r),n.width>0&&n.contains($.getPagePoint(i))}return!1}overTopHandle(i,e){const t=this,{offsetHeight:r}=e;if(t.topHandle&&t.canResize(e,i)&&(r>=t.handleVisibilityThreshold||t.dynamicHandleSize)){const n=V.from(e);return n.height=t.getDynamicHandleSize(t.bottomHandle,r),n.height>0&&n.contains($.getPagePoint(i))}return!1}overBottomHandle(i,e){const t=this,{offsetHeight:r}=e;if(t.bottomHandle&&t.canResize(e,i)&&(r>=t.handleVisibilityThreshold||t.dynamicHandleSize)){const n=V.from(e);return n.y=n.bottom-t.getDynamicHandleSize(t.bottomHandle,r),n.height>0&&n.contains($.getPagePoint(i))}return!1}};y(Ro,"configurable",{skipUpdatingElement:null}),Ro._$name="ResizeHelper";var cf=/>[ \t\r\n]+</g,_b=/\s\s+/g,gi=class ym{static tpl(e,...t){let r=0,n=t.map((s,a)=>{let l=e[a];return Array.isArray(s)?l+=s.reduce((o,u)=>o+=(typeof u=="string"?u.trim():u)+`
`,""):(s===void 0&&(s=""),l+=typeof s=="string"?s.trim():s),r++,l}).join("");return r<=e.length&&(n+=e[e.length-1]),n.replace(cf,"><").replace(_b," ").trim()}static docsTpl(e,...t){let r=0,n=t.map((s,a)=>{let l=e[a];return Array.isArray(s)?l+=s.reduce((o,u)=>o+=(typeof u=="string"?u.trim():u)+`
`,""):(s===void 0&&(s=""),l+=typeof s=="string"?s.trim():s),r++,l}).join("");return r<=e.length&&(n+=e[e.length-1]),n.replace(cf,"><").trim()}static repeat(e){return function(...t){return ym.tpl(...t).repeat(e)}}static loop(e){}};gi._$name="TemplateHelper";var Ob=class extends Array{constructor(i,e){super(),this.timeZone=i,this.year=e}},Ab=class{constructor(i,e){this.asString=i,this.timeZone=e,this.asArray=Fb(i)}get asLocalDate(){return this._asLocalDate||(this._asLocalDate=new Date(...this.asArray)),this._asLocalDate}get asTicksUtc(){return this._asTicksUtc||(this._asTicksUtc=new Date(Date.UTC(...this.asArray)).getTime()),this._asTicksUtc}},df=(i,e)=>{const t=i.toLocaleString("sv-SE",{timeZone:e});return new Ab(t,e)},Pb=(i,e)=>{const{asTicksUtc:t,asString:r}=df(new Date(i),e);return{offset:(i-t)/6e4,tzTicksUtc:t,tzString:r}},Fb=i=>{const e=i.split(/[\s-:]/).map(t=>t*1);return e[1]-=1,e},Lb=-6e4,$b=36e5,hf=-864e5,qn=2592e6,ff=(i,e)=>{const t=gf.get(i,e);if(t)return t;const r=new Ob(i,e),n=new Date(Date.UTC(e,0,1)).getTime();let s=n,a=qn,l=0,o=[],u=null,c,d,h,g;for(;!g;)({offset:h,tzTicksUtc:c,tzString:d}=Pb(s,i)),u==null?(u=h,r.push({offset:h})):a>0&&h!==u?a=a===qn?hf:Lb:a<0&&h===u&&(a===hf?a=$b:(r.length===1?(r.push(o),u=o.offset):(r[0].startTicks=o.startTicks,r[0].startDateString=o.startDateString,g=!0),a=qn)),o={offset:h,startDateString:d,startTicks:c},a===qn&&(s=n,s+=l*qn,l+=1),s+=a,l>11&&(g=!0);return gf.set(r),r},gf={_cache:{},get(i,e){var t;return(t=this._cache[i])==null?void 0:t[e]},set(i){const{timeZone:e}=i,{_cache:t}=this;t[e]||(t[e]={}),t[e][i.year]=i}},Ve=class{static get $name(){return"TimeZoneHelper"}static toTimeZone(i,e){if(typeof e=="number")return this.toUtcOffset(i,e);const t=df(i,e);return t.asArray[3]!==t.asLocalDate.getHours()&&console.warn("Incorrect time zone conversion due to local DST-switch detected"),t.asLocalDate}static fromTimeZone(i,e){if(typeof e=="number")return this.fromUtcOffset(i,e);const t=this.dateAsArray(i),r=ff(e,i.getUTCFullYear());let n=r[0].offset;if(r.length===2){const s=Date.UTC(...t);s>=r[1].startTicks&&s<r[0].startTicks&&(n=r[1].offset)}return t[4]+=n,new Date(Date.UTC(...t))}static toUtcOffset(i,e){const t=i.getTimezoneOffset()+e;return new Date(i.getTime()+t*60*1e3)}static fromUtcOffset(i,e){const t=-i.getTimezoneOffset()-e;return new Date(i.getTime()+t*60*1e3)}static dateAsArray(i){return[i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()]}};Ve.findOffsetDates=ff,Ve._$name="TimeZoneHelper";var _o=class Vs extends j{static get configurable(){return{testConfig:{destroyTimeout:1,timeout:1e3},floating:!0,timeout:2500,autoDestroy:null,destroyTimeout:200,showProgress:!0,color:null,bottomMargin:20}}compose(){const{appendTo:e,color:t,html:r,showProgress:n,style:s,timeout:a}=this;return{parent:e||this.floatRoot,class:{...J.normalize(t,"object"),"b-toast-hide":1},html:r,style:s,children:{progressElement:n&&{style:`animation-duration:${a/1e3}s;`,class:{"b-toast-progress":1}}},listeners:{click:"hide"}}}doDestroy(){this.untoast(),super.doDestroy()}get nextBottom(){const{bottomMargin:e,element:t}=this;return parseInt(t.style.bottom,10)+t.offsetHeight+e}async show(){var e,t;await super.show(...arguments);const r=this,{element:n}=r,{toasts:s}=Vs;s.includes(r)||(n.style.bottom=((t=(e=s[0])==null?void 0:e.nextBottom)!=null?t:r.bottomMargin)+"px",s.unshift(r),n.getBoundingClientRect(),n.classList.remove("b-toast-hide"),r.timeout>0&&(r.hideTimeout=r.setTimeout("hide",r.timeout)))}async hide(){const e=this;e.untoast(),e.element.classList.add("b-toast-hide"),e.autoDestroy&&!e.destroyTimer&&(e.destroyTimer=e.setTimeout("destroy",e.destroyTimeout))}untoast(){const{toasts:e}=Vs;e.includes(this)&&e.splice(e.indexOf(this),1)}static hideAll(){Vs.toasts.slice().reverse().forEach(e=>e.hide())}static show(e){const t=Vs.new({autoDestroy:!0,rootElement:document.body},typeof e=="string"?{html:e}:e);return t.show(),t}};y(_o,"$name","Toast"),y(_o,"type","toast");var Kn=_o;Kn.toasts=[],Kn.initClass(),Kn._$name="Toast";var mf=class{static getById(i){return j.getById(i)}static fromElement(i,e,t){return j.fromElement(i,e,t)}static createWidget(i={}){return i.isWidget?i:j.create(i)}static append(i,e){if(i=Array.isArray(i)&&i||[i],(e instanceof HTMLElement||typeof e=="string")&&(e={appendTo:e}),e.insertFirst){const t=typeof e.insertFirst=="string"?document.getElementById(e.insertFirst):e.insertFirst;t.firstChild?e.insertBefore=t.firstChild:e.appendTo=t}return i.map(t=>j.create(x.assign({},e||{},t)))}static openPopup(i,e){return j.create(x.assign({forElement:i},typeof e=="string"?{html:e}:e),"popup")}static showContextMenu(i,e){const t=this;return t.currentContextMenu&&t.currentContextMenu.destroy(),i instanceof HTMLElement?e.forElement=i:(e.forElement=document.body,Array.isArray(i)&&(i=new ot(...i)),i instanceof ot&&(e.align={position:i})),e.internalListeners={destroy:t.currentContextMenu=null},t.currentContextMenu=j.create(e,"menu")}static attachTooltip(i,e){return j.attachTooltip(i,e)}static hasTooltipAttached(i){return j.resolveType("tooltip").hasTooltipAttached(i)}static destroyTooltipAttached(i){return j.resolveType("tooltip").destroyTooltipAttached(i)}static mask(i,e="Loading"){if(i)return i instanceof HTMLElement&&(i={target:i,text:e}),xr.mask(i,i.target)}static unmask(i,e=!0){i.mask&&(e?i.mask.close():i.mask.hide())}static toast(i){return Kn.show(i)}};mf._$name="WidgetHelper";var pf=class{static convertFromObject(i,e={}){H.assignIf(e,{rootName:"root",elementName:"element",includeHeader:!0,rootElementForArray:!0});const{rootName:t,elementName:r,includeHeader:n,rootElementForArray:s}=e;let{xmlns:a}=e;a=a?` xmlns="${a}"`:"";const l=n?'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>':"",o=u=>{const c=[];for(const d in u){const h=u[d];if(Array.isArray(h)){s&&c.push(`<${d}>`);for(const g of h)r.length?c.push(`<${r}>`):c.push(`<${d}>`),c.push(o(g)),r.length?c.push(`</${r}>`):c.push(`</${d}>`);s&&c.push(`</${d}>`)}else H.isObject(h)?c.push(`<${d}>${o(h)}</${d}>`):h==null?c.push(`<${d}/>`):c.push(`<${d}>${P.encodeHtml(h)}</${d}>`)}return c.join("")};return`${l}<${t}${a}>${o(i)}</${t}>`}};pf._$name="XMLHelper";var mi=class{constructor(){this.random100=[46,2,36,46,54,59,18,20,71,55,88,98,13,61,61,40,2,15,3,32,51,45,64,25,81,85,54,13,57,49,64,22,81,94,0,62,17,7,11,2,33,99,85,26,83,83,96,26,20,89,91,38,26,13,11,79,32,30,5,51,70,7,5,56,58,77,37,89,40,80,78,59,26,36,8,51,60,23,86,5,11,96,64,94,87,64,4,78,17,85,35,0,90,86,23,55,53,9,35,59,29,2,64,42,8,49,43,73,6,53,38,9,39,31,32,40,49,13,78,68,20,99,24,78,35,91,73,46,67,76,89,69,30,69,25,3,4,55,1,65,66,76,83,19,67,1,95,24,54,45,56,40,67,92,72,4,69,8,47,50,27,2,38,9,14,83,12,14,62,95,22,47,35,18,38,14,86,64,68,61,52,69,39,93,20,73,32,52,74,6,56,68,99,29,24,92,40,67,6,72,31,41,91,53,80,55,33,97,97,99,18,20,5,27,82,84,61,78,27,67,7,42,75,95,91,25,63,21,70,36,46,0,1,45,84,6,86,15,10,62,96,94,10,23,93,83,94,47,5,29,29,52,51,37,77,96,43,72,43,14,54,14,72,52,4,39,15,26,68,28,25,76,60,50,22,40,72,74,68,58,8,48,40,62,52,24,9,26,47,44,49,96,7,77,90,45,76,47,5,86,1,36,18,42,19,90,34,23,70,32,69,79,0,99,57,80,72,21,19,72,85,68,4,40,86,62,0,63,4,11,69,31,78,31,21,78,29,84,13,53,57,10,26,50,24,30,90,42,51,96,93,21,99,23,81,0,89,43,86,63,93,19,54,71,92,36,4,95,37,99,60,29,23,50,68,95,57,95,77,53,99,78,75,12,92,47,23,14,0,41,98,11,34,64,26,90,50,23,38,31,74,76,16,76,66,23,22,72,48,50,20,36,37,58,5,43,49,64,81,30,8,21,98,75,60,17,50,42,27,38,90,74,45,68,67,27,31,15,58,76,41,99,23,98,53,98,56,19,79,2,4,38,96,24,65,51,43,42,41,60,46,7,90,65,3,27,63,99,51,44,86,1,54,40,15,74,3,81,51,63,87,79,84,72,22,38,96,95,33,41,21,99,21,69,7,49,40,52,41,6,91,19,76,40,54,17,33,11,11,0,1,32,94,33,13,18,45,7,85,61,42,54,45,72,78,96,17,9,80,87,41,96,66,0,8,59,18,21,2,28,64,75,97,32,80,86,97,97,55,2,73,75,11,89,67,58,70,76,12,46,64,17,22,97,25,35,93,57,82,46,57,61,31,74,27,4,32,85,53,86,53,53,42,5,28,50,65,63,70,61,73,37,13,80,7,34,22,3,26,6,62,78,12,56,87,41,58,64,31,27,45,35,18,66,62,43,89,69,94,93,33,74,2,43,85,37,82,41,74,9,15,44,33,42,65,19,1,49,78,12,29,9,78,7,55,12,45,40,33,16,86,14,52,16,73,76,0,98,75,91,78,46,99,95,90,69,78,45,62,55,37,88,49,77,27,83,38,73,39,1,75,40,65,83,54,95,7,73,4,30,26,36,89,21,5,95,11,14,87,45,36,21,77,55,5,66,51,98,48,62,74,58,23,82,30,28,19,53,89,76,98,8,34,70,28,54,16,52,35,93,54,54,72,49,18,93,72,90,71,73,15,60,38,80,76,53,70,39,69,25,5,31,61,46,6,54,34,31,52,33,36,79,76,44,29,28,38,1,66,2,90,91,1,76,78,31,55,37,71,2,3,38,85,0,95,42,2,39,57,87,61,77,98,2,24,80,48,27,47,71,15,7,49,60,86,3,2,29,38,54,36,59,83,27,47,9,36,42,8,73,85,9,16,73,60,39,12,43,25,23,29,28,47,40,77,20,89,22,30,41,59,96,19,56,20,76,73,39,46,72,40,47,37,52,29,79,37,39,50,41,87,66,17,75,31,45,26,88,70,11,90,40,74,9,32,65,72,61,6,93,54,15,84,22,99,47,10,96,4,84,19,85,73,45,25,16,8,94,99,39,28,26,68,87,48,1,65,86,46,86,7,60,82,45,75,38,56,41,35,30,86,91,97,85,45,5,14,69,85,96,37,18,26,16,38,16,1,44,94,85,58,60,20,5,47,52,41,50,71,43,42,67,64,38,65,83,99,78,96,33,20,98,24,6,2,25,16,16,44,63,24,68,56,49,91,15,59,99,27,43,34,28,36,45,1,10,19,54,26,75,17,88,96,63,24,71,93,72,97,66,87,18,86],this.randomCache={},this.rndIndex=0}nextRandom(i){const{randomCache:e}=this;let t;return e[i]?t=e[i]:(t=this.random100.filter(r=>r<i),e[i]=t),t[this.rndIndex++%t.length]}reset(){this.rndIndex=0}fromArray(i){return i[this.nextRandom(i.length)]}randomArray(i,e){const t=[],r=this.nextRandom(e+1),n={};for(let s=0,a=this.nextRandom(i.length);s<r;s++){for(;n[a];)a=this.nextRandom(i.length);n[a]=!0,t.push(i[a])}return t}};mi._$name="RandomGenerator";var Nb=["Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.","Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.","Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.","Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.","Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.","Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui atione voluptatem sequi nesciunt.","Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem.","Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur?","Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?"],Gn=class ul{static reset(){this.rnd.reset(),this.rndTime.reset(),this.rndRating.reset()}static get cities(){return["Stockholm","Barcelona","Paris","Dubai","New York","San Francisco","Washington","Moscow"]}static get firstNames(){return["Mike","Linda","Don","Karen","Doug","Jenny","Daniel","Melissa","John","Jane","Theo","Lisa","Adam","Mary","Barbara","James","David"]}static get surNames(){return["McGregor","Ewans","Scott","Smith","Johnson","Adams","Williams","Brown","Jones","Miller","Davis","More","Wilson","Taylor","Anderson","Thomas","Jackson"]}static get teams(){return["Lions","Eagles","Tigers","Horses","Dogs","Cats","Panthers","Rats","Ducks","Cougars","Hens","Roosters"]}static get foods(){return["Pancake","Burger","Fish n chips","Carbonara","Taco","Salad","Bolognese","Mac n cheese","Waffles"]}static get colors(){return["Blue","Green","Red","Yellow","Pink","Purple","Orange","Teal","Black"]}static get skills(){return["JavaScript","CSS","TypeScript","React","Vue","Angular","Java","PHP","Python","C#","C++","BASIC","COBOL","FORTRAN","PASCAL","SQL"]}static get tasks(){return["Meetings","Documentation","Email communication","Project management","Budgeting","Marketing and advertising","Customer service","Research and analysis","Data entry","IT support","Employee management","Sales and business development","Event planning","Graphic design","Writing and editing","Presentation","Travel arrangements and expense management","Training and development","Quality assurance","Customer support","Technical writing","Social media management","Translation","Legal research","Data analysis and visualization","Video editing and production","Network admin","Content creation","Market research","Public relations","Teaching and training","Recruiting","Product development"]}static*generate(e,t=!1,r=1){var n;let s,a;typeof e=="object"&&(t=e.randomHeight,r=(n=e.initialId)!=null?n:1,s=e.addSkills,a=e.rowCallback,e=e.count);const l=this,{rnd:o,rndTime:u,rndRating:c,rndText:d,firstNames:h,surNames:g,teams:f,foods:m,colors:p,cities:v,skills:b}=l;for(let w=0;w<e;w++){const S=o.fromArray(h),C=o.fromArray(g),T=`${S} ${String.fromCharCode(65+w%25)} ${C}`,E=o.nextRandom(60)+1,I=new Date(2019,0,E),R=new Date(2019,0,E+o.nextRandom(30)+2),M={id:r>-1?w+r:void 0,title:"Row "+w,name:T,firstName:S,surName:C,city:o.fromArray(v),team:o.fromArray(v)+" "+o.fromArray(f),age:10+o.nextRandom(80),food:o.fromArray(m),color:o.fromArray(p),score:o.nextRandom(100)*10,rank:o.nextRandom(100)+1,start:I,finish:R,time:k.getTime(u.nextRandom(24),u.nextRandom(12)*5),percent:o.nextRandom(100),done:o.nextRandom(100)<50,rating:c.nextRandom(5),active:E>30,relatedTo:Math.min(e-1,w+r+o.nextRandom(10)),notes:Nb[d.nextRandom(7)+1]};s&&(M.skills=o.randomArray(b,typeof s=="number"?s:7));const O=a==null?void 0:a(M);O&&Object.assign(M,O),t&&(M.rowHeight=o.nextRandom(t===!0?20:t)*5+20),yield M}}static generateData(e,t=!1,r=1,n=!0){let s=e;typeof e!="object"&&(s={count:e,randomHeight:t,initialId:r,reset:n}),s.reset!==!1&&this.reset(),ul.overrideRowCount&&(s.count=ul.overrideRowCount);const a=[],l=this.generate(s);for(let o=0;o<s.count;o++)a.push(l.next().value);return a}static generateEvents({viewStartDate:e,viewEndDate:t,nbrResources:r=50,nbrEvents:n=5,dependencies:s,tickUnit:a="days",minDuration:l=2,maxDuration:o=10,gap:u=1,eventCallback:c}){const d=this.generateData(r),h=[];let g,f;s=[];for(let m=0;m<=r;m++)for(let p=0;p<=n;p++){const v=Math.round(Math.random()*(o-1-l))+l,b=h.length+1;g=p===0?k.add(e,Math.round(Math.random()*3)*u,a):k.add(f,u,a),f=k.add(g,v,a),h.push({id:b,name:this.tasks[(m+p)%(this.tasks.length-1)],startDate:g,duration:v,endDate:f,resourceId:m}),c==null||c(h[h.length-1]),s&&m>0&&s.push({id:s.length+1,from:b-1,to:b})}return{resources:d,events:h,dependencies:s}}static generateOneEventPerTickAndResource({startDate:e,endDate:t,nbrResources:r=50,tickUnit:n="days"}){const s=this.generateData(r),a=[],l=k.getDurationInUnit(e,t,n);for(let o=0;o<=r;o++)for(let u=0;u<l;u++)a.push({id:a.length+1,resourceId:o,name:this.tasks[(o+u)%(this.tasks.length-1)],startDate:k.add(e,u,n),duration:1,durationUnit:n});return{resources:s,events:a}}static generateRow(){return ul.generateData(1,!1,-1,!1)[0]}};y(Gn,"rnd",new mi),y(Gn,"rndTime",new mi),y(Gn,"rndRating",new mi),y(Gn,"rndText",new mi);var vf=Gn;vf._$name="DataGenerator";var Bb=["action","target","to","deltaX","deltaY","x","y","text"],yf=class extends fe(xe()){static get defaultConfig(){return{repeat:!0,outerElement:document.body,callOnFunctions:!0}}construct(i){super.construct(i);const e=this;e.widget&&(e.outerElement=e.widget.element,e.widget.playingDemo=!0),$.playingDemo=!0,Object.assign(e,{prevTarget:null,currentStep:0,mouse:D.createElement({parent:e.outerElement,tag:"div",className:"simulated-mouse"}),timeoutId:null,innerIntervalId:null,mouseOutElements:[]}),e.intervalId=e.setInterval(e.nextStep.bind(e),1e3),e.outerElement.classList.add("b-playing-demo"),e.outerElement.addEventListener("click",t=>{t.isTrusted&&e.abort()})}doDestroy(){this.abort()}abort(i=!1){const e=this;e.mouse.style.top="-100px",e.clearInterval(e.intervalId),e.timeoutId&&e.clearTimeout(e.timeoutId),e.innerIntervalId&&e.clearInterval(e.innerIntervalId),e.outerElement.classList.remove("b-playing-demo"),e.widget&&(e.widget.playingDemo=!1),$.playingDemo=!1,e.trigger(i?"done":"abort")}triggerEvent(i,e,t){if(!i)return null;let r;if(e.startsWith("mouse")){const n=this.mouse.getBoundingClientRect();r=new MouseEvent(e,Object.assign({view:globalThis,bubbles:!0,cancelable:!0,clientX:n.left,clientY:n.top},t||{}))}else r=document.createEvent("Event"),r.initEvent(e,!0,!1);return i.dispatchEvent(r),r}handleMouseMove(i,e){const t=this,r=t.mouse;r.classList.add("quick"),t.mouseDown&&r.classList.add("drag");const n=V.from(r,t.outerElement),s=n.x,a=n.y;let l=0,o=0;if(i.to)if(typeof i.to=="string"){const c=t.outerElement.querySelector(i.to);if(c){const d=V.from(c,t.outerElement),h=d.x+d.width/2,g=d.y+d.height/2;l=(h-s)/10,o=(g-a)/10}}else i.to.x?l=(i.to.x-s)/10:(l=i.to[0]/10,o=i.to[1]/10);else i.deltaX?l=i.deltaX/10:i.x&&(l=(i.x-s)/10);i.deltaY&&(o=i.deltaY/10);let u=0;t.innerIntervalId=t.setInterval(()=>{if(t.shouldPause)return;u++===9&&(clearInterval(t.innerIntervalId),i.then&&i.then());const c=s+l*u,d=a+o*u;r.style.left=c+"px",r.style.top=d+"px";const h=r.getBoundingClientRect(),g=h.left,f=h.top,m=D.elementFromPoint(g,f);m!==t.prevTarget&&(t.prevTarget&&(t.mouseOutElements.push(t.prevTarget),D.isDescendant(t.mouseOutElements[0],m)||(t.mouseOutElements.forEach(p=>t.triggerEvent(p,"mouseout")),t.mouseOutElements.length=0)),t.prevTarget=m,t.triggerEvent(m,"mouseover")),t.triggerEvent(m,i.action,{clientX:g,clientY:f})},50)}getTarget(i){const e=this,t=i.target;return t?typeof t=="function"?t(i):document.querySelector(t):e.prevTarget||e.outerElement}normalizeStep(i){if(i.action)return typeof i.action=="function"?i.action(i):i;if(typeof i=="function")return i(),i;for(const e in i)Object.hasOwnProperty.call(i,e)&&!Bb.includes(e)&&(i.action=e.toLowerCase(),i.to=i[e]);return!i.target&&(typeof i.to=="string"||typeof i.to=="function")&&(i.target=i.to),i}get isScrolling(){const i=this,e=i.outerElement.getBoundingClientRect(),t=i.lastTop&&e.top!==i.lastTop;return i.lastTop=e.top,t}get isInView(){const i=this.outerElement.getBoundingClientRect();return i.top<globalThis.innerHeight&&i.bottom>0}get shouldPause(){return!this.isInView||this.isScrolling||document.hidden||!document.hasFocus()}nextStep(){const i=this;if(i.shouldPause)return;if(i.currentStep===i.steps.length)if(i.repeat)i.currentStep=0;else return i.abort(!0);i.currentStep===0&&i.trigger("initialize");const e=i.mouse,t=i.normalizeStep(i.steps[i.currentStep++]),r=i.getTarget(t),n=t.action;if(r&&n)if(e.className="simulated-mouse",n==="mousemove")i.handleMouseMove(t,r);else{if(r!==i.prevTarget){const s=V.from(r,i.outerElement);e.style.left=s.x+s.width/2+"px",e.style.top=s.y+s.height/2+"px"}n==="mousedown"&&(i.mouseDown=!0),n==="mouseup"&&(i.mouseDown=!1),i.timeoutId=i.setTimeout(()=>{if(i.prevTarget=r,e.classList.add(n),n==="type"){const s=j.fromElement(r),a=t.text.split("|");s.value=a[a.length===1||s.value!=a[0]?0:1]}else i.triggerEvent(r,n)},n==="type"?100:550)}}};yf._$name="DemoBot";var bf=Object.hasOwn||((i,e)=>Object.prototype.hasOwnProperty.call(i,e)),Oo=null;function Vb(i,e){return Object.defineProperty(i,"parser",{value:e}),e}var jb=class{constructor(i){this.formatter=i}format(i){return this.formatter.defaultFormat(i)}parse(i,e){return this.formatter.defaultParse(i,e)}resolvedOptions(){return null}},Xn=class{static get(i){if(i==null)return this.NULL;if(i instanceof this)return i;const e=typeof i=="string"?i:JSON.stringify(i),t=this.cache;let r=t.get(e);return r||(Oo=e,r=new this(i),t.set(e,r)),r}static get cache(){return bf(this,"_cache")&&this._cache||(this._cache=new Map)}static get NULL(){return bf(this,"_null")?this._null:this._null=new this(null)}constructor(i){const e=this,{standardOptions:t}=e.constructor;if(e.cacheKey=Oo,Oo=null,e.initialize(),i===null)e.formatter=new jb(e);else{e.configure(i);for(const[r,n]of Object.entries(e.resolvedOptions()))n!=null&&t.includes(r)&&(e[r]=n)}}get parser(){return Vb(this,new this.constructor.Parser(this))}defaultFormat(i){return i==null?i:String(i)}defaultParse(i){return i}format(i){return i==null?i:this.formatter.format(i)}parse(i,e){return i==null?i:this.parser.parse(i,e)}parseStrict(i){return this.parse(i,!0)}resolvedOptions(){return this.formatter.resolvedOptions()}};y(Xn,"standardOptions",Object.freeze([])),Xn._$name="Formatter";var pi=class extends F.mixin(fe,Et){static get $name(){return"Navigator"}static get type(){return"navigator"}static get configurable(){return{ownerCmp:null,itemsTabbable:null,target:null,keyEventTarget:null,processEvent:null,itemSelector:null,activeItem:null,focusCls:"b-active",keys:null,allowCtrlKey:null,allowShiftKey:null,scrollDuration:50,disabled:null,datasetIdProperty:"id",testConfig:{scrollDuration:1}}}static get factoryable(){return{defaultType:"navigator"}}get activeItem(){const{_activeItem:i}=this;if(this.target.contains(i))return i;this._activeItem=null}updateOwnerCmp(i){this.itemSelector||(this.itemSelector=`.${this.ownerCmp.itemCls}`),D.setAttributes(this.keyEventTarget,{"aria-activedescendant":`${this.owner.id}-active-descendant`})}set navigationEvent(i){const{owner:e}=this;this._navigationEvent=e.navigationEvent=i,i&&Promise.resolve(1).then(()=>this.navigationEvent=null)}get navigationEvent(){return this._navigationEvent}static getComposedKeyName(i){const e=(i.key||"").trim()||i.code;return`${i.ctrlKey?"CTRL+":""}${i.shiftKey?"SHIFT+":""}${i.altKey?"ALT+":""}${e}`}onKeyDown(i){var e;const t=this,{ownerCmp:r,itemSelector:n,activeItem:s,itemsTabbable:a}=t,{target:l}=i,o=t.target.querySelector(n),u=(i.key||"").trim()||i.code,c=t.constructor.getComposedKeyName(i),d=l.matches(n)||l===t.keyEventTarget;if(!t.disabled&&t.processEvent&&(i=t.processEvent.call(r,i)),i&&!t.disabled&&o&&t.target.offsetParent&&d){if(!a){if(t.inlineFlow==null){const h=o.parentNode,g=D.getStyleValue(o,"position"),f=D.getStyleValue(o,"display"),m=D.getStyleValue(o,"float");t.inlineFlow=g==="absolute"||f==="inline"||f==="inline-block"||m==="left"||m==="right"||D.getStyleValue(h,"display")==="flex"&&D.getStyleValue(h,"flex-direction")==="row"}t.prevKey||(t.inlineFlow?(t.prevKey="ArrowLeft",t.nextKey="ArrowRight"):(t.prevKey="ArrowUp",t.nextKey="ArrowDown"))}if(t.navigationEvent=i,s)switch(u){case t.prevKey:if(t.disabled||i.ctrlKey&&!t.allowCtrlKey||i.shiftKey&&!t.allowShiftKey)return;i.preventDefault(),i.handled=!0,t.navigatePrevious(i);break;case t.nextKey:if(t.disabled||i.ctrlKey&&!t.allowCtrlKey||i.shiftKey&&!t.allowShiftKey)return;i.preventDefault(),i.handled=!0,t.navigateNext(i);break;default:{const h=(e=t.keys)==null?void 0:e[c];if(h&&!t.disabled){if(t.callback(h,t.thisObj||r,[i])===!1)return}else r.onInternalKeyDown&&r.onInternalKeyDown(i);if(D.getActiveElement(l)!==l&&i.preventDefault(),a)return}}else{if(a)return;(u===t.nextKey||u===t.prevKey)&&(t.activeItem=t.getDefaultNavigationItem(i))}t.activeItem!==s&&t.triggerNavigate(i)}}getDefaultNavigationItem(i){const{target:e,itemSelector:t,prevKey:r,nextKey:n}=this;if(e.compareDocumentPosition(i.target)&4&&i.key===r)return e.querySelector(`${t}:last-of-type`);if(e.compareDocumentPosition(i.target)&2&&i.key===n)return e.querySelector(`${t}`)}navigatePrevious(i){const e=this,t=e.previous;i.preventDefault(),t&&e.ownerCmp.scrollable.scrollIntoView(t,{animate:e.scrollDuration}).then(()=>{e.activeItem=t,e.triggerNavigate(i)})}navigateNext(i){const e=this,t=e.next;i.preventDefault(),t&&e.ownerCmp.scrollable.scrollIntoView(t,{animate:e.scrollDuration}).then(()=>{e.activeItem=t,e.triggerNavigate(i)})}get owner(){return this.ownerCmp}get previous(){return this.getAdjacent(-1)}get next(){return this.getAdjacent(1)}getAdjacent(i=1,e=this.activeItem){const t=this.treeWalker;if(t.currentNode=e,t[i<0?"previousNode":"nextNode"](),t.currentNode!==this.activeItem)return t.currentNode}onTargetFocusIn(i){var e;const t=this,{target:r,relatedTarget:n}=i,{owner:s,itemsTabbable:a,skipScrollIntoView:l,previousActiveItem:o}=t;r.matches(".b-focus-trap")||(r.matches(t.itemSelector)?(t.skipScrollIntoView=!0,t.activeItem=r,t.skipScrollIntoView=l,t.activeItem&&a&&t.triggerNavigate(i)):r===t.target&&((n?r.compareDocumentPosition(n):0)&Node.DOCUMENT_POSITION_CONTAINED_BY?(e=s.previousSibling)==null||e.focus():t.activeItem=o&&t.target.contains(o)?o:0))}onTargetFocusOut(i){const e=this,{relatedTarget:t}=i;t!=null&&t.matches(".b-focus-trap")||(!t||!e.target.contains(t)||!t.matches(e.itemSelector))&&e.activeItem&&(e.activeItem=null,e.itemsTabbable&&e.triggerNavigate(i))}onTargetMouseDown(i){const e=this,t=i.target.closest(e.itemSelector);e.navigationEvent=i,e.itemsTabbable?t===e.activeItem&&e.triggerNavigate(i):e.ownerCmp.itemsFocusable===!1?e.onFocusGesture(i):t&&(i.preventDefault(),D.focusWithoutScrolling(t))}onTargetClick(i){var e;const t=this,{skipScrollIntoView:r}=t;if(t.skipNextClick||(e=t.navigationEvent)!=null&&e.ignoreNavigation){t.skipNextClick=!1;return}t.disabled||(t.skipScrollIntoView=!0,t.processEvent&&(i=t.processEvent.call(t.ownerCmp,i)),i&&(t.activeItem=i.target.closest(t.itemSelector),t.triggerNavigate(i)),t.skipScrollIntoView=r)}onFocusGesture(i){(i.target===this.ownerCmp.contentElement||i.target.closest(this.itemSelector)&&this.ownerCmp.itemsFocusable===!1)&&i.preventDefault()}acceptNode(i){return i.offsetParent&&i.matches&&i.matches(this.itemSelector)?D.NodeFilter.FILTER_ACCEPT:D.NodeFilter.FILTER_SKIP}changeActiveItem(i){return i!=null&&this.ownerCmp.getItem&&(i=this.ownerCmp.getItem(i)),i}updateActiveItem(i,e){var t;const r=this,{ownerCmp:n}=r,s=e&&r.target.contains(e),a=i&&D.isFocusable(i)&&i!==D.getActiveElement(i);if(s&&(r.previousActiveItem=e),e&&(e.classList.remove(r.focusCls),e.removeAttribute("id")),i!=null){if(r.skipScrollIntoView?a&&D.focusWithoutScrolling(i):(t=n.scrollable)==null||t.scrollIntoView(i,{block:"nearest",focus:a,silent:r.scrollSilently}),i===e&&s)return;i.classList.add(r.focusCls),i.id=`${r.owner.id}-active-descendant`,r._activeItem=i}else r._activeItem=null,e===D.getActiveElement(e)&&n.revertFocus()}updateTarget(i,e){const t=this,r={element:i,thisObj:t,focusin:"onTargetFocusIn",focusout:"onTargetFocusOut",mousedown:{handler:"onTargetMouseDown",delegate:t.itemSelector}};!t.itemsTabbable&&!t.itemsFocusable&&(r.click="onTargetClick"),Object.prototype.hasOwnProperty.call(t,"acceptNode")||(t.acceptNode=t.acceptNode.bind(t),t.acceptNode.acceptNode=t.acceptNode),$.on(r),t.treeWalker=t.setupTreeWalker(i,D.NodeFilter.SHOW_ELEMENT,t.acceptNode),t.keyEventTarget||(t.keyEventTarget=i),(t.targetMutationMonitor=new MutationObserver(t.onTargetChildListChange.bind(t))).observe(i,{childList:!0,subtree:!0})}setupTreeWalker(i,e,t){return document.createTreeWalker(i,e,t)}onTargetChildListChange(){var i;const e=this,{activeItem:t,datasetIdProperty:r}=e;t&&(e.target.contains(t)?t.classList.contains(e.focusCls)||t.classList.add(e.focusCls):e.activeItem=e.target.querySelector(`${e.itemSelector}.${e.focusCls}[data-${P.hyphenate(r)}="${t.dataset[r]}"]`)||((i=e.target.querySelector(`${e.itemSelector}.${e.focusCls}`))==null?void 0:i[t.dataset.index])||null)}changeKeyEventTarget(i){this._keyEventTarget=i,$.on({element:i,keydown:"onKeyDown",thisObj:this})}triggerNavigate(i,e=this.activeItem){var t;const r={event:i,item:e,oldItem:this.previousActiveItem};this.trigger("navigate",r),(t=this.ownerCmp)==null||t.trigger("navigate",r)}};pi._$name="Navigator";var Ea=P.escapeRegExp,Cf=/[\d+-]/g,ka=(i,e)=>new Intl.NumberFormat(i||void 0,e),zb=/^(?:([$])\s*)?(?:(\d+)>)?\d+(,\d+)?(?:\.((\d*)(?:#*)|[*]))?(?:\s*([%])?)?$/,Wb="\u2212",Hb=class{constructor(i){const e=this,t=i.locale,r=ka(t,{maximumFractionDigits:3}),n=i.is.currency?e._decodeStyle(t,{style:"currency",currency:i.currency,currencyDisplay:i.currencyDisplay}):null,s=i.is.percent?e._decodeStyle(t,{style:"percent"}):null,a=r.format(1.2).replace(Cf,"")[0],l=r.format(1e9).replace(Cf,"")[0]||"";Object.assign(e,{currency:n,decimal:a,formatter:i,grouper:l,percent:s}),e.decimal=a,e.decimalRe=Ea(a,"g"),e.grouper=l,e.stripRe=new RegExp(`(?:\\s+|${Ea(l)})`+(n?`|(?:${Ea(n.text)})`:"")+(s?`|(?:${Ea(s.text)})`:""),"g")}decimalPlaces(i){i=i.replace(this.stripRe,"");const e=i.indexOf(this.decimal)+1;return e&&i.length-e}parse(i,e){return typeof i=="string"&&(i=i.replace(this.stripRe,"").replace(this.decimalRe,".").replace(Wb,"-"),i=e?Number(i):parseFloat(i),this.formatter.is.percent&&(i/=100)),i}_decodeStyle(i,e){const t=ka(i,e),r=ka(i,Object.assign(t.resolvedOptions(),{style:"decimal"})),n=t.format(0),s=r.format(0);return{suffix:n.startsWith(s),text:n.replace(s,"").trim()}}},Sf=class bm extends Xn{static get $name(){return"NumberFormat"}initialize(){this._as={},this.is={decimal:!1,currency:!1,percent:!1,null:!0,from:null}}get truncator(){const e=this.maximumFractionDigits,t=Math.min(20,e+1);return e==null?null:this.as({style:"decimal",maximumFractionDigits:t,minimumFractionDigits:t},"truncator")}configure(e){typeof e!="string"?Object.assign(this,e):this.template=e;const t=this,r={},n=t.locale?Te.locales[t.locale]:Te.locale,s=n==null?void 0:n.NumberFormat,{template:a}=t,{standardOptions:l}=t.constructor;if(s)for(const o in s)t[o]==null&&typeof s[o]!="function"&&(t[o]=s[o]);if(a){const o=zb.exec(a),u=o[2],c=o[4];t.useGrouping=!!o[3],t.style=o[1]?"currency":o[6]?"percent":"decimal",u&&(t.integer=+u),c==="*"?t.fraction=[0,20]:c!=null&&(t.fraction=[o[5].length,c.length])}t._minMax("fraction",!0,!0),t._minMax("integer",!0,!1),t._minMax("significant",!1,!0);for(const o of l)t[o]!=null&&(r[o]=t[o]);t.is.from=t.from&&t.from.is,t.is[t.style]=!(t.is.null=!1),t.formatter=ka(t.locale,r)}as(e,t=null){const r=this.resolvedOptions()||{template:"9.*"},n=this._as;let s=t&&n[t];return s||(typeof e=="string"?r.style=e:Object.assign(r,e),r.from=this,s=new bm(r)),t&&(n[t]=s),s}defaultParse(e,t){return e==null?e:t?Number(e):parseFloat(e)}format(e){if(typeof e=="string"){const t=Number(e);e=isNaN(t)?this.parse(e):t}return super.format(e)}round(e){return this.parse(this.format(e))}truncate(e){const t=this,r=t.maximumFractionDigits,{truncator:n}=t;let s=t.parse(e),a;return n&&(s=n.format(s),a=s.indexOf(n.parser.decimal),a>-1&&s.length-a-1>r&&(s=s.slice(0,a+r+1)),s=n.parse(s)),s}resolvedOptions(){const e=super.resolvedOptions();for(const t in e)e[t]===void 0&&(e[t]=this[t]);return e}_minMax(e,t,r){const n=this,s=n[e];if(s!=null){const a=P.capitalize(e),l=`maximum${a}Digits`,o=`minimum${a}Digits`;typeof s=="number"?(t&&(n[o]=s),r&&(n[l]=s)):(n[o]=s[0],n[l]=s[1])}}};y(Sf,"standardOptions",["currency","currencyDisplay","locale","maximumFractionDigits","minimumFractionDigits","minimumIntegerDigits","maximumSignificantDigits","minimumSignificantDigits","style","useGrouping"]);var vi=Sf;vi.Parser=Hb,Object.assign(vi.prototype,{currency:null,currencyDisplay:"symbol",fraction:null,from:null,integer:null,locale:null,maximumFractionDigits:null,minimumFractionDigits:null,minimumIntegerDigits:null,maximumSignificantDigits:null,minimumSignificantDigits:null,significant:null,style:"decimal",template:null,useGrouping:!0}),Xn.number=(i,e)=>vi.get(i).format(e),vi._$name="NumberFormat";var Ia=class extends fe(F){construct(i={}){const e=this;super.construct(i),e.onWsOpen=e.onWsOpen.bind(e),e.onWsClose=e.onWsClose.bind(e),e.onWsMessage=e.onWsMessage.bind(e),e.onWsError=e.onWsError.bind(e),e.autoConnect&&e.address&&e.open()}doDestroy(){const i=this;i.connector&&(i.detachSocketListeners(i.connector),i.connector.close(),i.connector=null),super.doDestroy()}get isConnecting(){var i;return((i=this.connector)==null?void 0:i.readyState)===this.constructor.webSocketImplementation.CONNECTING}get isOpened(){var i;return((i=this.connector)==null?void 0:i.readyState)===this.constructor.webSocketImplementation.OPEN}get isClosing(){var i;return((i=this.connector)==null?void 0:i.readyState)===this.constructor.webSocketImplementation.CLOSING}get isClosed(){var i;return((i=this.connector)==null?void 0:i.readyState)===this.constructor.webSocketImplementation.CLOSED}createWebSocketConnector(){const i=this.connector=new this.constructor.webSocketImplementation(this.address);this.attachSocketListeners(i)}destroyWebSocketConnector(){this.detachSocketListeners(this.connector),this.connector.close(),this.connector=null}attachSocketListeners(i){const e=this;i.addEventListener("open",e.onWsOpen),i.addEventListener("close",e.onWsClose),i.addEventListener("message",e.onWsMessage),i.addEventListener("error",e.onWsError)}detachSocketListeners(i){const e=this;i.removeEventListener("open",e.onWsOpen),i.removeEventListener("close",e.onWsClose),i.removeEventListener("message",e.onWsMessage),i.removeEventListener("error",e.onWsError)}async open(){const i=this;if(i._openPromise)return i._openPromise;if(!i.address){console.warn("Server me.address cannot be empty");return}if(i.isOpened)return!0;i.createWebSocketConnector();let e;return i._openPromise=new Promise(t=>{e=i.ion({open(){t(!0)},error(){t(!1)}})}).then(t=>(e(),i._openPromise=null,t||i.destroyWebSocketConnector(),t)).catch(()=>{i._openPromise=null,i.destroyWebSocketConnector()}),i._openPromise}close(){this.connector&&(this.destroyWebSocketConnector(),this.trigger("close"))}send(i,e={}){var t;(t=this.connector)==null||t.send(JSON.stringify({command:i,...e}))}onWsOpen(i){this.trigger("open",{event:i})}onWsClose(i){this.trigger("close",{event:i})}onWsMessage(i){try{const e=JSON.parse(i.data);this.trigger("message",{data:e})}catch(e){this.trigger("error",{error:e})}}onWsError(i){this.trigger("error",{error:i})}};y(Ia,"webSocketImplementation",typeof WebSocket=="undefined"?null:WebSocket),y(Ia,"configurable",{address:"",userName:"User",autoConnect:!0}),Ia._$name="WebSocketManager";var Yb=class extends F.mixin(fe){constructor(){super(...arguments),y(this,"hasNativeAccess",!0),y(this,"_content",null)}async writeText(i,e){const t=this,{_content:r}=t;if(e&&t.hasNativeAccess)try{await navigator.clipboard.writeText(i)}catch(n){t.hasNativeAccess=!1}r!==i&&(t._content=i,t.triggerContentChange(r,!1,!0))}async readText(i){const e=this,{_content:t}=e;if(i&&e.hasNativeAccess)try{const r=await navigator.clipboard.readText();return t!==r&&(e._content=r,e.triggerContentChange(t,!0)),r}catch(r){e.hasNativeAccess=!1}return t}triggerPaste(i){this.trigger("paste",{source:i,text:this._content})}triggerContentChange(i,e=!1,t=!1){this.trigger("contentChange",{fromRead:e,fromWrite:t,oldText:i,newText:this._content})}async clear(i){await this.writeText("",i)}},Ub=i=>{var e;return e=class extends(i||F){construct(...t){super.construct(...t),globalThis.bryntum.clipboard||(globalThis.bryntum.clipboard=new Yb),globalThis.bryntum.clipboard.ion({paste:"onClipboardPaste",contentChange:"onClipboardContentChange",thisObj:this})}get clipboard(){return globalThis.bryntum.clipboard}onClipboardPaste({text:t,source:r}){var n;const s=this,{clipboardText:a,isCut:l}=s,o=s.compareClipboardText(a,t);o&&l?((n=s.handleCutData)==null||n.call(s,{text:t,source:r}),s.isCut=!1,s.cutData=null):o||s.clearClipboard(!1)}onClipboardContentChange({newText:t}){this.compareClipboardText(this.clipboardText,t)||this.clearClipboard(!1)}set cutData(t){var r,n;const s=this;(r=s._cutData)==null||r.forEach(a=>s.setIsCut(a,!1)),s._cutData=z.asArray(t),(n=s._cutData)==null||n.forEach(a=>s.setIsCut(a,!0))}get cutData(){return this._cutData}setIsCut(){}async writeToClipboard(t,r,n={}){if(await this.beforeCopy({data:t,isCut:r,...n})===!1)return;const s=this,a=typeof t=="string",l=a?t:s.stringConverter?s.stringConverter(t):P.safeJsonStringify(t);return s.clipboardText=l,await s.clipboard.writeText(l,s.useNativeClipboard),s.clipboardData=t,s.isCut=r,s.cutData=r&&!a?t:null,l}async readFromClipboard(t={},r=!1){var n;const s=this,{clipboard:a}=s,l=await a.readText(s.useNativeClipboard),{isOwn:o,data:u}=s.transformClipboardText(l),c=l&&o&&s.isCut;if(!(u==null||Array.isArray(u)&&u.length==0||await((n=s.beforePaste)==null?void 0:n.call(s,{data:u,text:l,...t,isCut:c}))===!1))return o||s.clearClipboard(!1),r||a.triggerPaste(s),u}async clearClipboard(t=!0){const r=this;r.clipboardData=r.clipboardText=r.cutData=null,r.isCut=!1,t&&await r.clipboard.clear(r.useNativeClipboard)}compareClipboardText(t,r){const n=/\r\n|(?!\r\n)[\n-\r\x85\u2028\u2029]/g;return(t==null?void 0:t.replace(n,`
`))===(r==null?void 0:r.replace(n,`
`))}transformClipboardText(t){const r=this,n=r.compareClipboardText(r.clipboardText,t),s=n?r.clipboardData:r.stringParser&&t?r.stringParser(t):t;return{isOwn:n,data:s}}hasClipboardData(){const{clipboard:t}=this,{_content:r}=t;if(!(this.useNativeClipboard&&t.hasNativeAccess))return!!(r&&this.transformClipboardText(r).data)}},y(e,"$name","Clipboardable"),y(e,"configurable",{useNativeClipboard:!1}),e},wf=i=>class extends(i||F){static get $name(){return"Finalizable"}construct(...t){super.construct(...t),this.finalizer=null,this.finalizing=null,this.isFinalized=!1,this.isFinalizing=!1}doFinalize(){this.destroy()}finalize(){const t=this;let r=t.finalizing;return!r&&!t.isFinalized&&(t.isFinalizing=!0,t.finalizing=r=t._awaitFinalizer()),r}async _awaitFinalizer(){const t=this;try{await t.finalizer}finally{t.finalizing=null,t.isFinalized=!0,t.doFinalize()}}},Ao=Symbol("dragAbort"),Ma=Symbol("dragInit"),Df=Symbol("dragDrag"),Po=Symbol("dragDrop"),qb={x:"horizontal",y:"vertical"},yi=class extends F.mixin(wf,xe,ai){static get configurable(){return{itemElement:null,scrollManager:null,monitoringConfig:null,source:null,target:null,targetElement:null,threshold:5,touchStartDelay:300}}static get identifiable(){return{}}construct(...i){super.construct(...i);const e=this,{event:t}=e;Object.assign(e,{altKey:null,cleaners:[],ctrlKey:null,data:new Map,element:t.target,endEvent:null,lastMoveEvent:null,metaKey:null,previousTarget:null,scrollerAction:null,shiftKey:null,state:Ma,startEvent:t,touchStartTimer:null,_valid:!0}),"touches"in t&&e.touchStartDelay&&(e.touchStartTimer=e.setTimeout(()=>e.touchStartTimer=null,e.touchStartDelay,"touchStartDelay")),$.on({element:globalThis,blur:"onWindowBlur",thisObj:e})}doDestroy(){const i=this,{source:e,target:t}=i;i.cleanup(),(t==null?void 0:t.dropping)===i&&(t.dropping=null),(e==null?void 0:e.dragging)===i&&(e.dragging=null),super.doDestroy()}onWindowBlur(){this.started&&this.abort()}get aborted(){return this.state===Ao}get completed(){return this.isDestroying||this.aborted||this.endEvent!==null}get pending(){return this.state===Ma}get started(){return this.state!==Ma&&!this.aborted}get valid(){return this.started&&this.targetElement!=null&&this._valid}set valid(i){this._valid=i}async get(i){if(this.aborted)throw new Error("Data is not available on aborted drag");if(!this.completed)throw new Error("Data is not available until drag completion");if(Array.isArray(i))return Promise.all(i.map(t=>this.get(t)));let e=this.data.get(i);return typeof e=="function"&&(e=await e(),this.data.set(i,e)),e}has(i){return this.data.has(i)}peek(i){if(this.aborted)throw new Error("Data is not available on aborted drag");if(Array.isArray(i))return i.map(t=>this.peek(t));let e=this.data.get(i);return typeof e=="function"&&(e=!0),e}set(i,e){this.data.set(i,e)}changeTarget(i,e){if(i!==e){const t=this;t._target=i,t.previousTarget=e,e&&(e.dropping=null),i&&(i.dropping=t,i.dropping!==t&&(i=null,t.valid=!1)),t._target=e}return i}updateTarget(i,e){const t=this;e&&t.source.dragLeaveTarget(t,e),i&&(t.valid=!0,i.dragMove(t),t.source.dragEnterTarget(t))}updateTargetElement(i){let e,t,r,n,s;for(s=i;s;s=s.parentElement)if(t=Dr.get(s,"droppables"),t){for(n=0;n<t.length;++n)if(e=t[n],e.dropRootElement.contains(i)&&(r=e.droppableSelector,(!r||i.closest(`#${D.getId(e.dropRootElement)} ${r}`))&&(this.target=e,this.target===e)))return}}abort(){const i=this,{element:e,source:t}=i;e==null||e.getBoundingClientRect(),i.state!==Po&&(i.state=Ao,i.cleanup()),t==null||t.endDrag(i)}begin(){const i=this,{source:e}=i,t=e.beforeDrag(i);return t!==!1&&(e.dragging=i),t}cleanup(){let i;for(;i=this.cleaners.pop();)i()}end(i){const e=this,{lastMoveEvent:t,target:r}=e,{dragSwallowClickTime:n}=e.source;e.event=e.domEvent=e.endEvent=i,e.syncFlags(),e.started&&(((t==null?void 0:t.clientX)!==i.clientX||(t==null?void 0:t.clientY)!==i.clientY||(t==null?void 0:t.target)!==i.target)&&e.track(),n&&$.on({element:document,capture:!0,expires:n,once:!0,click(s){s.stopPropagation()}}),e.state=Po,r!==e.source&&(r==null||r.dragDrop(e)))}fakeKey(i,e){const t=this,{lastMoveEvent:r}=t;if(r&&t.element){let n;r.isKey=!0,i.key==="Alt"?t.altKey!==e&&(t.altKey=e,n=!0):i.key==="Control"&&t.ctrlKey!==e&&(t.ctrlKey=e,n=!0),n&&(t.event=t.domEvent=r,t.track())}}keyDown(i){this.completed||(i.key==="Escape"?this.abort():this.isDragToggleKey(i.key)&&this.fakeKey(i,!0))}keyUp(i){!this.completed&&this.isDragToggleKey(i.key)&&this.fakeKey(i,!1)}getDistance(i){return $.getDistanceBetween(this.startEvent,i)}isDragToggleKey(i){return i==="Control"||i==="Alt"}move(i){const e=this,{target:t}=i,r=e.getDistance(i),n=r>=e.threshold;if(e.syncFlags(),e.touchStartTimer){n&&e.abort();return}if(t&&t.nodeType===Node.ELEMENT_NODE){if(n&&!e.started&&(e.event=e.domEvent=i,e.start()===!1)){e.abort();return}e.started&&!e.completed&&(e.lastMoveEvent=e.event=e.domEvent=i,i.type==="touchmove"&&(i.preventDefault(),i.stopImmediatePropagation()),e.track())}}start(){const i=this,{scrollManager:e,monitoringConfig:t,source:r}=i,{draggingBodyCls:n,dragLock:s}=r,a=r.dragRootElement;if(i.state=Df,i.startEvent.type==="touchstart"&&U.isMobileSafari){for(let o=i.startEvent.target.parentElement;o;o=o.parentElement){const{style:u}=o,c=D.getStyleValue(o,"overflow");(c==="auto"||c=="scroll")&&(i.scrollingAncestors||(i.scrollingAncestors=[]),i.scrollingAncestors.push([o,u.overflow,u.overflowX,u.overflowY]),u.overflow="hidden")}i.requestAnimationFrame(()=>{i.scrollingAncestors.forEach(([{style:o},u,c,d])=>{o.overflow=u,o.overflowX=c,o.overflowY=d}),i.scrollingAncestors=null})}if(e){const o=e.startMonitoring(H.merge({scrollables:[{element:a}],direction:qb[s]||s||"both",callback(u){const{lastMoveEvent:c}=i;c&&i.element&&(c.isScroll=!0,i.event=i.domEvent=c,i.scrollerAction=u,i.track(),i.scrollerAction=null)}},t));i.cleaners.push(o)}const l=r.dragRootElement.closest(".b-outer")||document.body;if(l.classList.add(n),i.cleaners.push(()=>l.classList.remove(n)),r.startDrag(i)===!1)return i.cleanup(),!1}syncFlags(){const i=this,{event:e}=i;i.altKey=e.altKey,i.ctrlKey=e.ctrlKey||e.metaKey,i.metaKey=e.metaKey,i.shiftKey=e.shiftKey}track(){const i=this,{event:e,source:t,target:r}=i;let n=e.target,s;e.type==="touchmove"&&(s=e.changedTouches[0],n=D.elementFromPoint(s.clientX,s.clientY)),i.targetElement=n,r===i.target&&(r==null||r.dragMove(i)),t.trackDrag(i)}};y(yi,"$name","DragContext"),yi.prototype.STATE=yi.STATE=Object.freeze({ABORTED:Ao,INIT:Ma,DRAGGING:Df,DROPPED:Po}),yi._$name="DragContext";var Zn=class Cm extends F.mixin(Et){static get type(){return"default"}static get configurable(){return{dragging:null}}static get factoryable(){return{defaultType:Cm}}updateDragging(e,t){t&&this.close(t),e&&this.open(e)}close(e){}open(e){}dragStart(e){this.dragging=e}dragMove(e){}dragEnd(e){this.dragging=null}};Zn.initClass(),Zn._$name="DragProxy";var Ra=i=>class extends(i||F){static get $name(){return"Draggable"}static get configurable(){return{dragging:{$config:"nullify",value:null},draggingClsSelector:null,dragDocumentListeners:{element:document,keydown:"onDragKeyDown",keyup:"onDragKeyUp",contextmenu:"onDragContextMenu",mousemove:"onDragPointerMove",mouseup:"onDragPointerUp",pointerup:"onDragPointerUp",touchend:"onDragPointerUp",touchmove:{handler:"onDragPointerMove",passive:!1}},dragItemSelector:null,dragItemOverCls:null,dragLock:null,dragMinDistance:1,dragProxy:{$config:["lazy","nullify"],value:null},dragRootElement:{$config:"nullify",value:null},dragSameTargetDrop:!1,dragSelector:null,ignoreSelector:null,dragSwallowClickTime:50,dragThreshold:5,dragTouchStartDelay:300,dropTargetSelector:null,overItem:null,testConfig:{dragSwallowClickTime:50}}}static get properties(){return{draggingCls:"b-draggable-active",draggingBodyCls:"b-draghelper-active",draggingItemCls:"b-dragging-item",draggingStartedCls:"b-draggable-started",draggableCls:"b-draggable"}}beforeDrag(t){const{dragRootElement:r,dragSelector:n,ignoreSelector:s}=this,a=n&&t.element.closest(n);return!n||!!(a&&a===r||r.contains(a)&&(!s||!t.element.matches(s)))}dragStart(t){}dragOver(t){}dragEnterTarget(t){}dragLeaveTarget(t,r){}dragDrop(t){}dragEnd(t){}get activeDrag(){const{dragging:t}=this;return t!=null&&t.started&&!t.completed?t:null}get dragEventer(){return this.trigger?this:null}get draggingClassElement(){const{draggingClsSelector:t,dragRootElement:r}=this;return t?r==null?void 0:r.closest(t):r}beginDrag(t){const{draggingCls:r,draggingClassElement:n}=this;r&&n&&(n.classList.add(r),t.cleaners.push(()=>n.classList.remove(r)))}async endDrag(t){const r=this,{dragEventer:n,dragProxy:s}=r;t.valid&&await r.dragDrop(t),!r.isDestroyed&&(t.pending?t.destroy():(r.dragEnd(t),s==null||s.dragEnd(t),n==null||n.trigger(t.valid?"drop":"dragCancel",{drag:t,event:t.event}),r.finalizeDrag(t)))}async finalizeDrag(t){var r;await((r=t.finalize)==null?void 0:r.call(t))}moveDrag(t){if(this.dragOver(t)!==!1){const{dragEventer:r,dragProxy:n}=this;n==null||n.dragMove(t),r==null||r.trigger("drag",{drag:t,event:t.event})}}setupDragContext(t){const r=this,{dragItemSelector:n,id:s}=r,{target:a}=t;return{event:t,id:s?`${s}-drag-${r._nextDragId=(r._nextDragId||0)+1}`:null,itemElement:n?a.closest(n):a,touchStartDelay:r.dragTouchStartDelay,source:r,threshold:r.dragThreshold}}startDrag(t){const{draggingStartedCls:r,draggingClassElement:n,draggingItemCls:s,dragEventer:a,dragProxy:l}=this,{itemElement:o}=t;if((a==null?void 0:a.trigger("beforeDragStart",{drag:t,event:t.event}))===!1)return!1;r&&n&&(n.classList.add(r),t.cleaners.push(()=>n.classList.remove(r))),s&&o&&(o.classList.add(s),t.cleaners.push(()=>o.classList.remove(s))),l==null||l.dragStart(t);const u=this.dragStart(t);return u!==!1&&(a==null||a.trigger("dragStart",{drag:t,event:t.event})),u}trackDrag(t){var r;const{dropTargetSelector:n}=this;t.valid=!(n&&!((r=t.targetElement)!=null&&r.closest(n))),this.moveDrag(t)}configureListeners(t){const r=this,n=x.assign({thisObj:r},r.dragDocumentListeners);return"touches"in t.startEvent?(delete n.mousemove,delete n.mouseup):(delete n.contextmenu,delete n.touchmove,delete n.touchend,delete n.pointerup),n}updateDragging(t,r){const n=this;if(t){const s=n.configureListeners(t);t.cleaners.push($.on(s)),n.beginDrag(t)}else r&&r.destroy()}changeDragProxy(t,r){return Zn.reconfigure(r,t,{owner:this,defaults:{owner:this}})}updateDragRootElement(t,r){var n;const s=this,{draggableCls:a,dragItemSelector:l,onDragItemMouseMove:o}=s;if(r==null||r.classList.remove(a),(n=s._dragRootDetacher)==null||n.call(s),t){const u={thisObj:s,element:t,mousedown:"onDragMouseDown",touchstart:"onDragTouchStart",pointerdown:c=>{var d,h;return c.pointerId&&((h=(d=c.target).releasePointerCapture)==null?void 0:h.call(d,c.pointerId))}};o&&(u.mousemove={delegate:l,handler:"onDragItemMouseMove"}),(s.dragItemOverCls||o||s.onDragItemMouseEnter||s.onDragItemMouseLeave)&&Object.assign(u,{mouseover:{delegate:l,handler:"onDragItemMouseOver"},mouseout:{delegate:l,handler:"onDragItemMouseOut"}}),t.classList.add(a),s._dragRootDetacher=$.on(u)}}onDragItemMouseOver(t){this.overItem=t}onDragItemMouseOut(t){this.dragging||(this.overItem=t)}changeOverItem(t){var r;return this.enterLeaveEvent=t,t.type==="mouseout"?((r=t.relatedTarget)==null?void 0:r.closest(this.dragItemSelector))||null:t.target.closest(this.dragItemSelector)}updateOverItem(t,r){var n,s;const a=this,{dragItemOverCls:l}=a;r&&(l&&r.classList.remove(l),(n=a.onDragItemMouseLeave)==null||n.call(a,a.enterLeaveEvent,r)),t&&(l&&t.classList.add(l),(s=a.onDragItemMouseEnter)==null||s.call(a,a.enterLeaveEvent,t))}onDragContextMenu(t){t.preventDefault()}onDragKeyDown(t){this.dragging.keyDown(t)}onDragKeyUp(t){this.dragging.keyUp(t)}onDragMouseDown(t){t.button===0&&this.onDragPointerDown(t)}onDragPointerDown(t){let{dragging:r}=this;r?r.isFinalizing||r.abort():(r=this.setupDragContext(t),r&&(r=new yi(r),r.begin()===!1&&r.destroy()))}changeDragging(t,r){return r==null||r.destroy(),t}onDragPointerMove(t){const{dragging:r}=this;r&&!r.completed&&(r==null||r.move(t))}onDragPointerUp(t){const{dragging:r}=this;r&&!r.completed&&(r.end(t),this.endDrag(r))}onDragTouchStart(t){t.touches.length===1&&this.onDragPointerDown(t)}},_a=i=>class extends(i||F){static get $name(){return"Droppable"}static get configurable(){return{droppableSelector:null,dropping:null,dropRootElement:{$config:"nullify",value:null}}}get dropEventer(){return this.trigger?this:null}get droppableCls(){return"b-droppable"}dragEnter(t){var r;return(r=this.dropEventer)==null?void 0:r.trigger("dragEnter",{drag:t,event:t.event})}dragMove(t){var r;return(r=this.dropEventer)==null?void 0:r.trigger("dragMove",{drag:t,event:t.event})}dragDrop(t){var r;return(r=this.dropEventer)==null?void 0:r.trigger("drop",{drag:t,event:t.event})}dragLeave(t){var r;return(r=this.dropEventer)==null?void 0:r.trigger("dragLeave",{drag:t,event:t.event})}changeDropping(t,r){if(t!==r){const n=this;r&&(r.aborted||!r.completed)&&n.dragLeave(r),t&&(n._dropping=t,n.dragEnter(t)===!1&&(t=null),n._dropping=r)}return t}updateDropRootElement(t,r){const n=this,{droppableCls:s}=n;let a,l,o;r&&(a=Dr.get(r,"droppables"),o=!0,Array.isArray(a)&&(l=a.indexOf(n))>-1&&(a.length<2?Dr.remove(r,"droppables"):(a.splice(l,1),a.forEach(u=>{s===u.droppableCls&&(o=!1)}))),o&&r.classList.remove(s)),t&&(a=Dr.get(t,"droppables"),a?a.push(n):Dr.set(t,"droppables",[n]),t.classList.add(s))}},Tf=i=>class extends(i||F){static get $name(){return"Featureable"}static get configurable(){return{features:null}}static get declarable(){return["featureable"]}static setupFeatureable(t){const r={ownerName:"client",...t.featureable};r.factory.initClass(),Reflect.defineProperty(t,"featureable",{get(){return r}})}doDestroy(){var t;const r=this.features;super.doDestroy();for(const n in r){const s=r[n];(t=s.destroy)==null||t.call(s)}}hasFeature(t){var r;return!!((r=this.features)!=null&&r[t])}changeFeatures(t,r){if(this.isDestroying)return;const n=this,{featureable:s}=n.constructor,a=n.$features||(n.$features=new Ir({configName:"features",factory:s.factory,owner:n,ownerName:s.ownerName}));if(a.update(t),!r)return a.target}get widgetClass(){}getCurrentConfig(t){const r=super.getCurrentConfig(t),{features:n}=r;if(n)for(const s in n)Object.keys(n[s]).length===0&&(n[s]=!0);return r}},le={e:"b-hover-edge",t:"b-hover-top",r:"b-hover-right",b:"b-hover-bottom",l:"b-hover-left"},Kb={[le.e]:1,[le.t]:1,[le.r]:1,[le.b]:1,[le.l]:1},Gb={t:[le.e,le.t],r:[le.e,le.r],b:[le.e,le.b],l:[le.e,le.l],tr:[le.e,le.t,le.r],bl:[le.e,le.b,le.l],tl:[le.e,le.t,le.l],br:[le.e,le.b,le.r]},Xb=i=>class extends i.mixin(xe){static get $name(){return"Hoverable"}static get configurable(){return{hoverCls:null,hoverAnimationCls:null,hoverRootCls:null,hoverRootActiveCls:null,hoverDelay:null,hoverElement:null,hoverIgnoreElement:null,hoverEdges:null,hoverEdgeSize:10,hoverRootElement:{$config:"nullify",value:null},hoverSelector:null,hoverTarget:{$config:"nullify",value:null},hoverTrack:null,hoverZone:null}}static get delayable(){return{setHoverTarget:0}}hoverEnter(t){}hoverIgnore(t){var r;return(r=this.hoverIgnoreElement)==null?void 0:r.contains(t)}hoverLeave(t){}hoverMove(t){}onHoverMouseMove(t){const r=this,{hoverEdges:n,hoverEdgeSize:s,hoverTarget:a}=r;if(a){if(n){const{top:l,left:o,width:u,height:c,right:d,bottom:h}=a.getBoundingClientRect(),{clientX:g,clientY:f}=t,m=o+u/2,p=l+c/2,v=f<(s?l+s:p),b=g>=(s?d-s:m),w=f>=(s?h-s:p),S=g<(s?o+s:m),C=v||w?v?"t":"b":"",T=b||S?b?"r":"l":"";r.hoverZone=(n.includes(C)?C:"")+(n.includes(T)?T:"")}r.hoverEvent=t,r.hoverTrack&&r.hoverMove(t)}}onHoverMouseOver(t){this.hoverEvent=t,this.hoverElement=t.target}onHoverMouseOut(t){this.hoverEvent=t,this.hoverElement=t.relatedTarget}updateHoverDelay(t){this.setHoverTarget.delay=t}changeHoverEdges(t){return t===!0?"trbl":(t||"").replace("v","tb").replace("h","lr")}updateHoverEdges(){this.syncHoverListeners()}changeHoverElement(t){if(!this.hoverIgnore(t))return t}updateHoverElement(t){const{hoverSelector:r}=this;r&&(t=t==null?void 0:t.closest(r)),this.setHoverTarget(t)}updateHoverRootElement(t,r){const{hoverRootCls:n}=this;n&&(r==null||r.classList.remove(n),t==null||t.classList.add(n)),this.syncHoverListeners()}changeHoverTarget(t,r){return r&&(this.hoverZone=null),t}updateHoverTarget(t,r){const n=this,{hoverCls:s,hoverAnimationCls:a,hoverRootActiveCls:l,hoverRootElement:o}=n;l&&(o==null||o.classList[t?"add":"remove"](l)),r&&(s&&r.classList.remove(s),a&&r.classList.remove(a),n.hoverLeave(r)),t&&(s&&t.classList.add(s),n.hoverEnter(r),n.hoverTrack&&n.hoverMove(n.hoverEvent),a&&(t.getBoundingClientRect(),t.classList.add(a)))}updateHoverTrack(){this.syncHoverListeners()}updateHoverZone(t){const{hoverAnimationCls:r,hoverTarget:n}=this;if(n){const{className:s}=n,a=J.change(s,t?Gb[t]:null,Kb);s!==a&&(n.className=a,t&&r&&(n.classList.remove(r),n.getBoundingClientRect(),n.classList.add(r)))}}setHoverTarget(t){this.hoverTarget=t}syncHoverListeners(){var t;const r=this,n=r.hoverRootElement,s={element:n,thisObj:r,mouseover:"onHoverMouseOver",mouseout:"onHoverMouseOut"};(r.hoverTrack||r.hoverEdges)&&(s.mousemove="onHoverMouseMove"),(t=r._hoverRootDetacher)==null||t.call(r),r._hoverRootDetacher=n&&$.on(s)}},xf=i=>{var e;return e=class extends i{static get configurable(){return{loadMaskDefaults:{useTransition:!0,showDelay:1e3},loadMaskError:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},loadMask:{text:"L{GridBase.loadMask}"},syncMask:{text:"L{GridBase.syncMask}"},localizableProperties:["loadMask.text","syncMask.text"],testConfig:{loadMaskError:{icon:"b-icon b-icon-warning",autoClose:500,showDelay:0}}}}applyLoadMask(){const t=this,{loadMask:r}=t;return r&&(t.masked=xr.mergeConfigs(t.loadMaskDefaults,r)),t.masked}applyMaskError(t){const{loadMaskError:r,masked:n}=this;return r===!1?n.hide():n&&(x.assign(n.errorDefaults,r),n.error=t),n}get widgetClass(){}},y(e,"$name","LoadMaskable"),e},Zb={constructor:1,prototype:1,name:1,length:1,arguments:1,caller:1,callee:1,__proto__:1},Ef=class{static apply(i){if(!i.target)throw new Error("Override must specify what it overrides, using static getter target");if(!i.target.class)throw new Error("Override must specify which class it overrides, using target.class");if(!this.shouldApplyOverride(i))return!1;const e=Object.getOwnPropertyNames(i),t=Object.getOwnPropertyNames(i.prototype);return e.splice(e.indexOf("target"),1),this.internalOverrideAll(i.target.class,e,i),this.internalOverrideAll(i.target.class.prototype,t,i.prototype),!0}static internalOverrideAll(i,e,t){Reflect.ownKeys(t).forEach(r=>{if(e.includes(r)&&!Zb[r]){const n=Object.getOwnPropertyDescriptor(t,r);let s=i,a=null;for(;!a&&s;)a=Object.getOwnPropertyDescriptor(s,r),a||(s=Object.getPrototypeOf(s));a&&this.internalOverride(s,r,n,a)}})}static internalOverride(i,e,t,r){const n=i._overridden=i._overridden||{};n[e]=i[e],r.get?Object.defineProperty(i,e,{enumerable:!1,configurable:!0,get:t.get}):i[e]=t.value}static shouldApplyOverride(i){const e=i.target;if(!e.maxVersion&&!e.minVersion)return!0;if(!e.product)throw new Error("Override must specify product when using versioning");return!(e.maxVersion&&ie[e.product].isNewerThan(e.maxVersion)||e.minVersion&&ie[e.product].isOlderThan(e.minVersion))}};Ef._$name="Override";var{defineProperty:kf}=Object,{hasOwn:Jb}=x,Fo=Symbol("fencible"),Qb=[],If=i=>Array.from(new Set(i)),Lo=i=>i?If(P.split(i)):Qb,eC=(i,e,t)=>{t===!0&&(t=e),x.isObject(t)||(t={all:t});let r=Lo(t.any);const n=Lo(t.all),s=t.lock?Lo(t.lock):If(n.concat(r)),a=e+"Impl",l=function(...o){const u=this,c=Jb(u,Fo)?u[Fo]:u[Fo]={},d=h=>!c[h];if(n.every(d)&&(!r||r.some(d)))try{return s.forEach(h=>c[h]=(c[h]||0)+1),u[a](...o)}finally{s.forEach(h=>--c[h])}};r=r.length?r:null,!i[a]&&kf(i,a,{configurable:!0,value:i[e]}),kf(i,e,{configurable:!0,value:l})},Mf=i=>{var e;return e=class extends(i||F){static setupFenced(t){let{fenced:r}=t;const n=r.static,s=[];n&&(r={...r},delete r.static,s.push([n,t])),s.push([r,t.prototype]);for(const[a,l]of s)for(const o in a)eC(l,o,a[o])}get widgetClass(){}},y(e,"$name","Fencible"),y(e,"declarable",["fenced"]),e},Oa=60*1e3,Ar=60*Oa,Rt=24*Ar,tC=/(\d+)?:?(\d*)/,it=class Lt{static format(e){const t=Math.floor(e/Ar),r=Math.floor(e/Oa)%60;return`${t}:${r<10?"0":""}${r}`}static parse(e){const t=typeof e;if(t==="string"){const r=tC.exec(e);e=Number(r[1]||0)*Ar+Number(r[2]||0)*Oa}else t!=="number"?e=k.getTimeOfDay(e):e<=24&&(e*=Ar);return Math.min(Math.max(Math.floor(e),0),Rt)}constructor(e){let t=0,r,n;e!=null&&e.isDayView?(t=e.dayStartShift,r=e.dayStartTime,n=e.dayEndTime):typeof e=="number"?t=r=n=e:e&&(t=e.startShift,r=e.timeStart,n=e.timeEnd),this.startShift=t=Lt.parse(t||0),this.timeEnd=(n==null?(t+Rt)%Rt:Lt.parse(n))||Rt,this.timeStart=r==null?t:Lt.parse(r)}get startHour(){return Math.floor(this.timeStart/Ar)}get endHour(){return Math.floor(this.timeEnd/Ar)}get startTimeOffsetMs(){const{startShift:e,timeStart:t}=this;return t<e?Rt-e+t:t-e}get today(){return this.startOfDay(new Date)}ceil(e){const t=this.startOfDay(e);return t<e&&t.setDate(t.getDate()+1),t}contains(e){return!this.outside(e)}dateKey(e){return e=this.shiftDate(e,-1),k.makeKey(e)}dayOfDate(e){return this.shiftDate(k.clearTime(e))}dayOfWeek(e){return e=this.shiftDate(e,-1),e.getDay()}delta(e,t="ms"){const{timeStart:r}=this,n=Lt.parse(e),s=(this.startShift&&n<r?n+Rt:n)-r;return t==="ms"?s:k.as(t,s,"ms")}duration(e="ms"){const{timeStart:t,timeEnd:r}=this,n=t<r?r-t:Rt-t+r;return e==="ms"?n:k.as(e,n,"ms")}equals(e){return this.startShift===(e==null?void 0:e.startShift)&&this.timeStart===e.timeStart&&this.timeEnd===e.timeEnd}intersects(e,t){const r=this,{timeStart:n,timeEnd:s}=r,[a,l]=r._dateRangeArgs(e,t),[o,u]=r.timeRange(a,l);return n<s?o<u?o<s&&n<=u:o<s||n<=u:!(o<u)||o<s||n<=u}isIntraDay(e,t){const r=this,[n,s]=r._dateRangeArgs(e,t),a=r.startOfDay(n),l=Rt-k.diff(a,s,"ms");return l<0?!1:l>0||a<n}isInterDay(e){return e.allDay||!this.isIntraDay(...arguments)}outside(e){const{startShift:t,timeStart:r,timeEnd:n}=this,s=Lt.parse(e);return r<n?s<r?s<t?1:-1:s<n?0:s<t?-1:1:s<n||s>=r?0:s<t?1:-1}parseKey(e){return this.dayOfDate(k.parseKey(e))}shiftDate(e,t=1){const{startShift:r}=this,n=typeof e;return e=n==="number"?new Date(e):n==="string"?k.parse(e):new Date(e.getTime()),t&&r&&e.setMilliseconds(t>0?r:-r),e}sortEvents(e,t){const r=this.startOfDay(e);return t==null?void 0:t.sort((n,s)=>{n=n.eventRecord||n,s=s.eventRecord||s;let{startDate:a}=n,{startDate:l}=s;return a?l?(a=a<r?r:a,l=l<r?r:l,a-l||s.endDate-l-(n.endDate-a)):1:-1})}startOfDay(e){return e=this.shiftDate(e,-1),e=k.clearTime(e),e=this.shiftDate(e),e}timeRange(e,t){const[r,n]=this._dateRangeArgs(e,t);return[k.getTimeOfDay(r),k.getTimeOfDay(n)]}toString(){const{startShift:e,timeEnd:t,timeStart:r}=this,n=e?`@${Lt.format(e)}`:"",s=Lt.format(r);return r===t?e?n:s:`${s}-${Lt.format(t)}${n}`}_dateRangeArgs(e,t){return e.isModel?[e.startDate,e.endingDate]:[e,t]}};it.MIDNIGHT=new it({startShift:0,timeStart:0,timeEnd:24}),it.MILLIS_PER_MINUTE=Oa,it.MILLIS_PER_HOUR=Ar,it.MILLIS_PER_DAY=Rt,it._$name="DayTime";var Rf=class Sm extends fe(F){static get configurable(){return{date:{$config:{equal:"date"},value:k.clearTime(new Date)},month:null,year:null,weekStartDay:null,hideNonWorkingDays:null,nonWorkingDays:null,sixWeeks:null}}configure(e){super.configure(e),this.updateDayNumbers(),e.date&&(this.date=e.date),this.generation=0}changeDate(e){if(!this.isConfiguring){if(e=typeof e=="string"?k.parse(e,"YYYY-MM-DD"):new Date(e),isNaN(e))throw new Error("Month date ingestion must be passed a Date, or a valid YYYY-MM-DD date string");return e}}updateDate(e,t){const r=this,{dayColumnIndex:n,weekCount:s}=r,a=k.getFirstDateOfMonth(e),l=k.getLastDateOfMonth(a),o=n[a.getDay()],u=n[l.getDay()],c=!t||e.getFullYear()!==t.getFullYear(),d=!t||e.getMonth()!==t.getMonth(),h=r.eventListeners&&(t?e.getDate()!==t.getDate()|(r.getWeekId(e)!==r.getWeekId(t))<<1|d<<2|c<<3:15);if(r._year=e.getFullYear(),r._month=e.getMonth(),r.startDayOfMonth=1-o,r.endDayOfMonth=l.getDate()+(6-u),r.sixWeeks&&(r.endDayOfMonth+=(6-r.weekCount)*7),(!r.weekBase||c)&&r.calculateWeekBase(),(d||c)&&r.generation++,h){const g={newDate:e,oldDate:t,changes:{d:!0,w:!!(h&2),m:!!(h&12),y:!!(h&8),r:r.weekCount!==s}};r.trigger("dateChange",g),h&2&&r.trigger("weekChange",g),h&12&&r.trigger("monthChange",g),h&8&&r.trigger("yearChange",g)}}calculateWeekBase(){const e=this,{dayColumnIndex:t}=e,r=new Date(e.year,0,1),n=new Date(e.year,11,31),s=e.month?e.getOtherMonth(r):e;e.dayColumnIndex[r.getDay()]>3?e.weekBase=s.startDate:e.weekBase=new Date(e.year,0,s.startDayOfMonth-7);const a=Math.floor(k.diff(e.weekBase,n,"day")/7);e.has53weeks=a===53&&t[n.getDay()]>2}getWeekStart(e){if(typeof e=="number")return k.add(this.weekBase,Math.max(e,1)*7,"day");const t=this,[r,n]=e;return r===t.year?t.getWeekStart(n):t.getOtherMonth(new Date(r,0,1)).getWeekStart(n)}getOtherMonth(e){const t=this,r=t===_f?new Sm(null):_f;return r.configure({weekBase:null,weekStartDay:t.weekStartDay,nonWorkingDays:t.nonWorkingDays,hideNonWorkingDays:t.hideNonWorkingDays,sixWeeks:t.sixWeeks,date:new Date(e.getFullYear(),0,1)}),r.date=e,r.updateDate(r.date,r.date),r}changeYear(e){const t=new Date(this.date);t.setFullYear(e),this.date=t}changeMonth(e){const t=new Date(this.date);t.setMonth(e),this.date=t}get weekStartDay(){return typeof this._weekStartDay=="number"?this._weekStartDay:k.weekStartDay}updateWeekStartDay(){const e=this;e.updateDayNumbers(),!e.isConfiguring&&e.date&&(e.weekBase=null,e.updateDate(e.date,e.date))}get nonWorkingDays(){return this._nonWorkingDays||k.nonWorkingDays}changeNonWorkingDays(e){return x.assign({},e)}updateNonWorkingDays(){this.updateDayNumbers()}updateHideNonWorkingDays(){this.updateDayNumbers()}updateSixWeeks(){this.isConfiguring||this.updateDate(this.date,this.date)}get dayCount(){return this.endDayOfMonth+1-this.startDayOfMonth}get weekCount(){return this.dayCount/7}get startDate(){const e=this;if(e.year!=null&&e.month!=null&&e.startDayOfMonth!=null)return new Date(e.year,e.month,e.startDayOfMonth)}get endDate(){const e=this;if(e.year!=null&&e.month!=null&&e.startDayOfMonth!=null)return new Date(e.year,e.month,e.endDayOfMonth)}eachDay(e){for(let t=this.startDayOfMonth;t<=this.endDayOfMonth;t++)e(new Date(this.year,this.month,t))}eachWeek(e){const t=this,{weekCount:r}=t;for(let n=t.startDayOfMonth,s=0;s<r;s++){const a=[],l=t.getWeekNumber(new Date(t.year,t.month,n));for(let o=0;o<7;o++,n++)a.push(new Date(t.year,t.month,n));e(l,a)}}getWeekNumber(e){const t=this;if(e=k.clearTime(e),e.getFullYear()!==t.year)return t.getOtherMonth(new Date(e.getFullYear(),0,1)).getWeekNumber(e);let r=Math.floor(k.diff(t.weekBase,e,"day")/7),n=e.getFullYear();if(r)r===53&&!t.has53weeks?(r=1,n++):r>53&&(r=r%52);else return t.getOtherMonth(new Date(t.year-1,0,1)).getWeekNumber(new Date(t.year,0,0));return[n,r]}getWeekId(e){const t=this.getWeekNumber(e);return t[0]*100+t[1]}getCellData(e,t,r=it.MIDNIGHT){const n=this,s=e.getDay(),a=n.visibleDayColumnIndex[s],l=n.nonWorkingDays[s],o=n.hideNonWorkingDays&&l;return(e<n.startDate||e>n.endDate)&&(n.month=e.getMonth()),{day:s,dayTime:r,visibleColumnIndex:a,isNonWorking:l,week:n.getOtherMonth(e).getWeekNumber(e),key:k.format(e,"YYYY-MM-DD"),columnIndex:n.dayColumnIndex[s],date:new Date(e),dayEnd:r.duration("s"),tomorrow:r.dayOfDate(k.add(e,1,"day")),isOtherMonth:Math.sign(e.getMonth()+e.getFullYear()*12-(t.month+t.year*12)),visible:!o&&e>=t.startDate&&e<k.add(t.endDate,1,"day"),isRowStart:a===0,isRowEnd:a===n.visibleColumnCount-1}}updateDayNumbers(){const e=this,{weekStartDay:t,nonWorkingDays:r,hideNonWorkingDays:n}=e,s=e.dayColumnIndex=[],a=e.canonicalDayNumbers=[],l=e.visibleDayColumnIndex=[];let o=0;for(let u=0;u<7;u++){const c=(t+u)%7;a[u]=c,s[c]=u,(!n||!r[c])&&(l[c]=o++)}e.visibleColumnCount=o,e.weekLength=n?7-x.keys(r).length:7}};y(Rf,"$name","Month");var Jn=Rf,_f=new Jn(null);Jn._$name="Month";var rC=0,Of=new WeakMap,iC=(...i)=>i.map(e=>{let t;return e&&typeof e=="object"||typeof e=="function"?(t=Of.get(e),t===void 0&&(t=++rC,Of.set(e,t))):t=String(e),t}).join("-"),Jt=i=>{const e=new Map;return(...t)=>{const r=iC(t);let n=e.get(r);return n===void 0&&(n=i(...t),e.set(r,n)),n}},Qn=i=>{const e=new Map,t=c=>c[0],r=c=>c[1],n=(c,d)=>t(c).push(d),s=(c,d)=>r(c).push(d),a=(c,d)=>r(c).some(h=>x.isEqual(h,d)),l=()=>[[],[]],o=c=>!r(c).length&&!t(c).length,u=c=>{let d=e.get(c);return d===void 0&&(d=l(),e.set(c,d)),d};return(c,d)=>{const h=u(c);o(h)?(n(h,d),i(c,g=>{a(h,g)||(s(h,g),t(h).forEach(f=>f(g)))})):(n(h,d),r(h).forEach(g=>d(g)))}},Af=Symbol("success"),nC=Symbol("failure"),Aa=(i,e)=>[Af,i,e],$o=i=>[nC,i],No=i=>i.length&&i[0]===Af,es=i=>typeof i=="function"&&!i.length?i():i,Pa=Jt(i=>Qn((e,t)=>t(Aa(i,e)))),sC=Jt(i=>Qn((e,t)=>{const r=Math.min(i.length,e.length),n=e.substr(0,r),s=e.substr(r);t(n===i?Aa(n,s):$o(s))})),Fa=(i,e)=>(t,r)=>es(i)(t,n=>{if(No(n)){const[,s,a]=n;e(s)(a,r)}else r(n)}),aC=Jt((...i)=>{const e=Jt((t,r)=>Qn(Fa(t,n=>Fa(r,s=>Pa([].concat(n,s))))));return i.reduce(e,Pa([]))}),lC=Jt((...i)=>Qn((e,t)=>i.forEach(r=>es(r)(e,t)))),oC=Jt(i=>(e,t)=>{const r=new RegExp(`^${i}`),n=r.exec(e);if(n){const s=n[0],a=e.substr(s.length);t(Aa(s,a))}else t($o(e))}),uC=Jt((i,e)=>Fa(i,(...t)=>Pa(e(...[].concat.apply([],t))))),Pf=(i,e)=>{const t=[];return i(e,r=>{if(No(r)){const[,,n]=r;n===""&&t.push(r)}}),t},cC=i=>(e,t)=>t?es(i)(e,t):Pf(es(i),e),dC={memo:Jt,memoCps:Qn,success:Aa,failure:$o,isSuccess:No,resolveParser:es,succeed:Pa,string:sC,bind:Fa,seq:aC,alt:lC,regexp:oC,red:uC,runParser:Pf,defineParser:cC},Bo=class extends xe(F){static get configurable(){return{element:null,zoneWidth:50,scrollSpeed:5,direction:"both",startScrollDelay:500,stopScrollWhenPointerOut:!1,testConfig:{scrollSpeed:2,startScrollDelay:100},activeScroll:{$config:["lazy"],value:{}},monitoring:{$config:["lazy","nullify"],value:!0},owner:null}}changeMonitoring(i,e){return e==null||e.clear(),new Map}doDestroy(){this.stopMonitoring(),super.doDestroy()}get isScrolling(){return Object.keys(this.activeScroll).length!==0}get rtl(){var i;return(i=this.owner)==null?void 0:i.rtl}startMonitoring(i={}){const e=this,{element:t,direction:r}=e,{scrollables:n=[],direction:s=r,callback:a}=i,l=[];return n.length||n.push({element:t}),n.forEach(o=>{const u=o.element;typeof u=="string"?D.forEachSelector(t,u,c=>{e.createMonitor(c,o.direction||s,o.callback||a),l.push(c)}):(e.createMonitor(u,o.direction||s,o.callback||a),l.push(u))}),function(){var u;(u=e.stopMonitoring)==null||u.call(e,l)}}createMonitor(i,e,t){const{monitoring:r}=this;r.has(i)||r.set(i,new hC({scrollManager:this,element:i,direction:e,callback:t}))}stopMonitoring(i){const e=this,{monitoring:t}=e;if(i=z.asArray(i),t){if(!i){t.forEach(r=>e.stopMonitoring(r.element));return}i.forEach(r=>{const n=t.get(r);r.classList.remove("b-scrolling"),n&&(n.destroy(),t.delete(r))})}}requestScroll(i,e){const{activeScroll:t}=this;return i in t&&t[i]!==e?!1:(t[i]=e,!0)}releaseScroll(i){const{activeScroll:e={}}=this;Object.keys(e).forEach(t=>{e[t]===i&&delete e[t]})}getRelativeScroll(i,e="left"){let t=0;return this.monitoring.forEach((r,n)=>{D.isDescendant(n,i)&&(t+=e==="left"?r.scrollRelativeLeft:r.scrollRelativeTop)}),t}},hC=class extends F{construct(i){const e=this,{element:t}=i,r=t.scrollLeft,n=t.scrollTop;Object.assign(i,{startScrollLeft:r,startScrollTop:n}),super.construct(i),$.on({element:t,scroll:"onElementScroll",pointermove:"onMouseMove",capture:!0,thisObj:e}),$.on({element:t,pointerleave:"onPointerLeave",thisObj:e})}doDestroy(){this.stopScroll(),super.doDestroy()}startScroll(){const i=this;i.pendingScrollFinalize&&(i.scrollManager.releaseScroll(i),i.pendingScrollFinalize=!1),i.scrolling=!0,i.performScroll()}stopScroll(i=null){const e=this,t=()=>{e.pendingScrollFinalize=!1,e.isDestroyed||(e.scrollManager.releaseScroll(e),e.scrolling=!1)};e.scrollRequested&&(e.scrollManager.cancelAnimationFrame(e.frameId),e.scrollRequested=!1),e.scrollManager.clearTimeout(e.scrollTimeout),e.scrollTimeout=null,!i&&(e.ongoingScrollTop||e.ongoingScrollLeft)?(e.pendingScrollFinalize=!0,Promise.all([e.ongoingScrollTop,e.ongoingScrollLeft].filter(Boolean)).then(()=>e.pendingScrollFinalize&&t())):(e.ongoingScrollTop=e.ongoingScrollLeft=null,t())}onPointerLeave(){this.scrollManager.stopScrollWhenPointerOut&&this.stopScroll()}onMouseMove(i){const e=this,{scrollManager:t}=e,r=e.element.getBoundingClientRect(),n=t.zoneWidth,s=t.scrollSpeed;if(e.scrollDeltaX=e.scrollDeltaY=0,e.direction!=="vertical"){const{scrollLeft:a,scrollWidth:l,clientWidth:o}=e.element;t.rtl?i.clientX<r.left+n&&l+a-o>=1?e.scrollDeltaX=-Math.round((n+(r.left-i.clientX))/s)-1:i.clientX>r.right-n&&a<0&&(e.scrollDeltaX=Math.round((n-(r.right-i.clientX))/s)+1):i.clientX>r.right-n&&l-a-o>=1?e.scrollDeltaX=Math.round((n-(r.right-i.clientX))/s)+1:i.clientX<r.left+n&&a>0&&(e.scrollDeltaX=-Math.round((n+(r.left-i.clientX))/s)-1)}if(e.direction!=="horizontal"){const{scrollTop:a,scrollHeight:l,clientHeight:o}=e.element;i.clientY>r.bottom-n&&l-a-o>=1?e.scrollDeltaY=Math.round((n-(r.bottom-i.clientY))/s)+1:i.clientY<r.top+n&&a>0&&(e.scrollDeltaY=-Math.round((n+(r.top-i.clientY))/s)-1)}e.scrollDeltaX!==0&&!t.requestScroll("horizontal",e)&&(e.scrollDeltaX=0),e.scrollDeltaY!==0&&!t.requestScroll("vertical",e)&&(e.scrollDeltaY=0),e.scrollDeltaX===0&&e.scrollDeltaY===0?e.scrolling&&e.stopScroll():e.scrollTimeout||(e.scrollTimeout=t.setTimeout(()=>e.startScroll(),t.startScrollDelay))}performScroll(){const i=this,{element:e}=i;if(i.scrolling&&!i.scrollRequested){if(i.scrollDeltaX!==0){const t=e.scrollLeft,r=Math.min(t+i.scrollDeltaX,e.scrollWidth-e.clientWidth);e.scrollLeft=r,e.scrollLeft!==t?i.ongoingScrollLeft=new Promise(n=>e.addEventListener("scroll",n,{once:!0})):(i.ongoingScrollLeft=null,i.scrollDeltaX=0)}if(i.scrollDeltaY!==0){const t=e.scrollTop,r=Math.min(t+i.scrollDeltaY,e.scrollHeight-e.clientHeight);e.scrollTop=r,e.scrollTop!==t?i.ongoingScrollTop=new Promise(n=>e.addEventListener("scroll",n,{once:!0})):(i.ongoingScrollTop=null,i.scrollDeltaY=0)}i.scrollDeltaX!==0||i.scrollDeltaY!==0?(i.scrollRequested=!0,i.frameId=i.scrollManager.requestAnimationFrame(()=>{i.scrollRequested=!1,i.performScroll(i)})):i.stopScroll()}}onElementScroll(){var i,e;(e=(i=this.config)==null?void 0:i.callback)==null||e.call(this.thisObj||this.scrollManager,this)}get scrollLeft(){return this.element.scrollLeft}get scrollTop(){return this.verticalElement?this.verticalElement.scrollTop:this.element.scrollTop}get scrollRelativeLeft(){return this.scrollLeft-this.startScrollLeft}get scrollRelativeTop(){return this.scrollTop-this.startScrollTop}getRelativeLeftScroll(i){return this.scrollManager.getRelativeScroll(i,"left")}getRelativeTopScroll(i){return this.scrollManager.getRelativeScroll(i,"top")}};Bo._$name="ScrollManager";var fC={left:!0,right:!0,top:!0,bottom:!0,transform:!0},gC={true:1,false:1},mC=Promise.resolve(),Vo=class $t extends _r{static get configurable(){return{autoHide:!0,mouseOffsetX:15,mouseOffsetY:15,html:{$config:{equals:()=>!1}},getHtml:null,forElement:null,trackMouse:null,updateContentOnMouseMove:!1,forSelector:null,hideOnDelegateChange:null,anchorToTarget:!0,showOnHover:null,hoverDelay:500,autoShow:!1,dismissDelay:0,hideDelay:500,loadingMsg:"Loading...",allowOver:null,anchor:!0,align:{align:"b-t",minHeight:300},axisLock:!0,activeTarget:null,testConfig:{hideDelay:100,hoverDelay:100,showAnimation:null,hideAnimation:null}}}afterConfigure(){const e=this,{forSelector:t}=e;t&&(e.showOnHover=e.showOnHover!==!1,e.forElement||(e.anchorToTarget||(e.trackMouse=!0),e.forElement=e.rootElement.host||e.rootElement)),super.afterConfigure(),e.forElement&&e.showOnHover&&(e.pointerOverOutDetacher=$.on({element:e.forElement,pointerover:"internalOnPointerOver",pointerout:"internalOnPointerOut",thisObj:e}))}doDestroy(){var e;(e=this.pointerOverOutDetacher)==null||e.call(this),super.doDestroy()}set focusOnToFront(e){super.focusOnToFront=e}get focusOnToFront(){return super.focusOnToFront&&D.usingKeyboard}get focusElement(){const e=super.focusElement;if(e!==this.element)return e}get anchorToTarget(){return this._anchorToTarget&&!this.trackMouse}get anchor(){return super.anchor&&!this.trackMouse}set anchor(e){super.anchor=e}onDocumentMouseDown({event:e}){const t=this,{triggeredByEvent:r}=t;r&&D.isTouchEvent&&e.pageX===r.pageX&&e.pageY===r.pageY&&t.activeTarget.contains(e.target)&&performance.now()-r.timeStamp<500||(t.abortDelayedShow(),super.onDocumentMouseDown({event:e}))}internalOnPointerOver(e){const t=this,{target:r,relatedTarget:n}=e,{forElement:s,forSelector:a,activeTarget:l}=t;let o;if(!(t.disabled||t.owner&&!t.owner.showTooltipWhenDisabled&&t.owner.disabled)&&!(t.allowOver&&t.element.contains(r))){if(a){if(o=t.filterTarget(r),l!=null&&l.contains(r)&&l.contains(n)&&o===l||o&&(n==null?void 0:n.closest(a))===o)return}else if(!s.contains(n))o=s;else return;o?t.handleForElementOver(e,o):l&&t.handleForElementOut()}}filterTarget(e){return e.closest(this.forSelector)}onTransitionEnd(e){var t;const r=this,{currentOverElement:n}=$t;if(fC[e.propertyName]){if(r.allowOver&&r.element.contains(n))return;(t=r.activeTarget)!=null&&t.contains(n)&&!r.trackMouse&&r.realign()}}async handleForElementOver(e,t){const r=this,{activeTarget:n,hideOnDelegateChange:s,anchorToTarget:a}=r,l=t!==n,o=l&&s;if(r.trigger("pointerOver",{event:e,target:t})===!1)r.internalOnPointerOut(e);else{if(r.triggeredByEvent=e,r.hasTimeout("hide")&&(r.abortDelayedHide(),!l))return;if(!s&&r.element.classList.contains("b-hiding")&&r.cancelHideShowAnimation(),!r._hidden&&o&&r.hide(!1),r.activeTarget=t,r.isVisible){const u=r.updateContent();if(H.isPromise(u)&&!r.loadingMsg&&await u,r.trigger("beforeShow")===!1)return r.hide();r.alignTo({[a?"target":"position"]:a?t:"mouse",overlap:!(a&&r.anchor)}),r.trigger("show"),r.afterShowByTarget()}else r.delayShow(t)}}async delayShow(e){var t;const r=this;if((t=r.currentAnimation)!=null&&t.showing&&r.cancelHideShowAnimation(),!r.isVisible&&!r.hasTimeout("show"))if(!r.hoverDelay||r.forSelector&&Date.now()-r.lastHidden<r.quickShowInterval){const n=r.updateContent();H.isPromise(n)&&!r.loadingMsg&&await n,r.showByTarget(e)}else r.addDocumentMouseDownListener(),!r.listeningForMouseMove&&!r.anchorToTarget&&(r.mouseMoveRemover=$.on({element:r.rootElement,mousemove:"onMouseMove",thisObj:r})),r.setTimeout(async()=>{if(r.activeTarget===e&&e.isConnected){const n=r.updateContent();H.isPromise(n)&&!r.loadingMsg&&await n,r.showByTarget(e)}},!r.triggeredByEvent||r.triggeredByEvent.type==="pointerover"?r.hoverDelay:0,"show");else r.isVisible&&r.showByTarget(e)}changeAllowOver(e){return this.inAfterShow||(this.configuredAllowOver=e),e}updateAllowOver(e){var t;const r=this,{element:n}=r;n.classList.toggle("b-allow-over",!!e),e?r.allowOverlisteners=$.on({element:n,mouseenter:"onOwnElementMouseEnter",mouseleave:"internalOnPointerOut",thisObj:r}):(t=r.allowOverlisteners)==null||t.call(r)}updateContent(){const e=this;if(e.getHtml){const t=e.callback(e.getHtml,e,[{tip:e,element:e.element,activeTarget:e.activeTarget,event:e.triggeredByEvent}]);return e.html=t,t}}get hasContent(){return!!(D.isReactElement(this._html)||this._html!==""&&typeof this.html=="string"&&this.html.length||this.items.length)}internalBeforeShow(){return(this.updateContentOnMouseMove||this.hasContent)&&!this.disabled}showAsyncMessage(e=this.optionalL(this.loadingMsg)){e&&(this.html=`
                <div class="b-tooltip-loading">
                    <i class="b-icon b-icon-spinner"></i>
                    ${e}
                </div>
            `)}showByTarget(e){var t;const r=this,{anchorToTarget:n}=r;r.mouseMoveRemover=(t=r.mouseMoveRemover)==null?void 0:t.call(r),r.showBy({[n?"target":"position"]:n?e:"mouse",overlap:!(n&&r.anchor)})}afterShowByTarget(){const e=this,{dismissDelay:t}=e;e.abortDelayedShow(),t&&e.setTimeout("hide",t),e.element.parentNode&&e.toFront(),!e.mouseMoveRemover&&(e.trackMouse||e.updateContentOnMouseMove)&&(e.mouseMoveRemover=$.on({element:e.rootElement,pointermove:"onMouseMove",thisObj:e})),e.inAfterShow=!0,e.allowOver=e.allowOver||e.configuredAllowOver!=!1&&e.childItems.some(r=>r.isVisible&&!r.disabled&&r.focusElement),e.inAfterShow=!1}updateActiveTarget(e,t){e&&!this.isConfiguring&&this.trigger("overTarget",{newTarget:e,lastTarget:t})}internalOnPointerOut(e){var t;const r=this,n=e.relatedTarget;r.allowOver&&r.element.contains(n)||r.element.contains(e.target)&&((t=r.activeTarget)!=null&&t.contains(n))||r.activeTarget&&!r.activeTarget.contains(n)&&r.handleForElementOut()}handleForElementOut(){const e=this,{hideDelay:t}=e;if(e.trigger("pointerOut")===!1)return e.activeTarget=null,!0;e.abortDelayedShow(),e.isVisible&&t!==!1&&(e.abortDelayedHide(),t>0?e.setTimeout("hide",t):e.hide())}show(e){const t=this;!e&&t.forElement&&t.anchorToTarget&&!t.forSelector?t.showByTarget(t.forElement):super.show(...arguments),t.isVisible&&(t.afterShowByTarget(),t.forElement&&!t.transitionEndDetacher&&!t._hidden&&(t.transitionEndDetacher=$.on({element:t.forElement,transitionend:"onTransitionEnd",thisObj:t})))}get hideDelay(){return this.autoHide?this._hideDelay:!1}hide(){var e,t;const r=this;if(r.abortDelayedShow(),r._hidden)return mC;{r.abortDelayedHide();const n=super.hide(...arguments);return r.lastHidden=Date.now(),r.activeTarget=null,(e=r.mouseMoveRemover)==null||e.call(r),r.mouseMoveRemover=null,(t=r.transitionEndDetacher)==null||t.call(r),r.transitionEndDetacher=null,n}}abortDelayedShow(){var e,t,r;const n=this;n.hasTimeout("show")&&((e=n.mouseDownRemover)==null||e.call(n),n.mouseDownRemover=null,n.clearTimeout("show"),(t=n.mouseMoveRemover)==null||t.call(n),n.mouseMoveRemover=null,(r=n.transitionEndDetacher)==null||r.call(n),n.transitionEndDetacher=null)}abortDelayedHide(){this.clearTimeout("hide")}realign(){const e=this,t=e.lastAlignSpec;!e.isConfiguring&&!e.isVisible&&(t!=null&&t.targetOutOfView)&&(t.allowTargetOut||D.isInView(t.target,!1,e))&&(e.show(),t.targetOutOfView=!1),super.realign()}alignTo(e){const t=this,r=(t.mouseOffsetX||1)*(t.rtl?-1:1),n=t.mouseOffsetY||1,s=Math.max(Math.min(r,5),0),a=Math.max(Math.min(n,5),0);if(!t.isVisible)return;let l;!t.anchorToTarget&&e.position==="mouse"&&(l=new ot(t.triggeredByEvent.pageX-globalThis.scrollX,t.triggeredByEvent.pageY-globalThis.scrollY),e.position=new ot(l.x+(r||1)-(r<0?t.width:0),l.y+(n||1)-(n<0?t.height:0))),e&&!(t.triggeredByEvent&&t.element.contains(t.triggeredByEvent.target))&&e.nodeType===Node.ELEMENT_NODE&&(e={target:e}),super.alignTo(e),l&&t.lastAlignSpec.result.inflate(a,s).contains(l)&&(t.lastAlignSpec.position="mouse",t.mouseOffsetY=-n,t.mouseOffsetX=-r,t.realign(),t.mouseOffsetY=n,t.mouseOffsetX=r)}changeHtml(e){const t=this;if(H.isPromise(e)){t.showAsyncMessage(),e.target=t.activeTarget,e.then(r=>{e.target===t.activeTarget&&(t.html=r)});return}return typeof e!="object"&&(e=e!=null?t.optionalL(String(e)):""),e}updateHtml(e,t){const r=this;let n=e==="";n||(super.updateHtml(e,t),r.hasContent?(r.isVisible&&r.realign(),H.isPromise(e)||r.trigger("innerHtmlUpdate",{value:e})):n=!0),n&&r.hide()}onMouseMove(e){const t=this,{forElement:r,activeTarget:n}=t,s=t.hasTimeout("hide"),a=e.target;if(t.triggeredByEvent=e,!t._hidden){let l;const o=n==null?void 0:n.contains(a),u=!o&&t.forSelector&&n&&!s&&a.nodeType===Node.ELEMENT_NODE&&!a.matches(t.forSelector)&&!(t.allowOver&&t.element.contains(a)),c=r!=null&&r.document?r.document.documentElement:r,d=c&&(c.contains?c.contains(a):c.compareDocumentPosition(a)&16);if(u&&(l=t.handleForElementOut()),l||!s||d){if(t.dismissDelay&&!s&&t.setTimeout("hide",t.dismissDelay),t.updateContentOnMouseMove&&t.getHtml&&(t.html=t.callback(t.getHtml,t,[{tip:t,element:t.element,forElement:n,event:e}]),!t.html)){t.hide();return}t.trackMouse&&t.alignTo({position:"mouse",ignorePageScroll:!0})}}}onElementUserAction(e){this.internalOnPointerOver(e)}onOwnElementMouseEnter(e){this.abortDelayedHide()}static getSharedTooltip(e,t,r){var n,s,a;let l=(s=(n=t.bryntum)==null?void 0:n.tooltip)==null?void 0:s.get($t);if(!l&&!r){(a=t.bryntum)!=null&&a.tooltip||x.setPath(t,"bryntum.tooltip",new Map);const o=t.bryntum.tooltip;o.set($t,!0),l=new $t({forElement:t,rootElement:e,forSelector:"[data-btip]",resetCfg:{},isSharedTooltip:!0,cls:"b-tooltip-shared",internalListeners:{pointerOver({source:u,target:c}){for(const g in u.resetCfg)g==="listeners"?u.un(u.resetCfg[g].set):g!=="html"&&(u[g]=u.resetCfg[g].was);u.resetCfg={};const d=j.getById(c.id),h=(d==null?void 0:d.tipConfig)||u.gatherDataConfigs(c.dataset);if(d&&d.element!==c||!d&&c.matches(".b-widget")||d!=null&&d.disabled&&!d.showTooltipWhenDisabled)return!1;u.owner=d;for(const g in h)u.resetCfg[g]={set:h[g],was:u[g]},g==="listeners"?u.ion(h[g]):u[g]=h[g]},hide({source:u}){u.owner=null}},gatherDataConfigs(u){const c=this,d={};for(const h in u)if(h.startsWith("btip"))if(h.length>4){const g=P.uncapitalize(h.substr(4));if(g in c.getDefaultConfiguration()){const f=u[h];d[g]=gC[f]?f==="true":isNaN(f)?f:parseInt(f,10)}}else d.html=u[h];return d},filterTarget(u){const c=u.closest(this.forSelector);if(c)return c;if($t.showOverflow&&u.closest(".b-widget"))for(;(u==null?void 0:u.nodeType)===Element.ELEMENT_NODE;){if(D.getStyleValue(u,"text-overflow")==="ellipsis"&&u.clientWidth<u.scrollWidth)return this.html=P.encodeHtml(u.textContent),u;u=u.parentNode}}}),$.on({element:t,mouseenter:u=>$t.currentOverElement=u.target,keydown:u=>$t.currentOverElement=u.target,capture:!0,thisObj:l}),o.set($t,l)}return l}static encodeConfig(e){const t={};if(typeof e=="string")t.btip=e;else for(const r in e)t[`btip${r==="html"?"":P.capitalize(r)}`]=e[r];return t}};y(Vo,"$name","Tooltip"),y(Vo,"type","tooltip");var je=Vo;je.initClass(),Object.defineProperty(j,"tooltip",{get(){return je.getSharedTooltip(document.body,document.body)}}),j.Tooltip=je,je._$name="Tooltip";var jo=class extends Zn{static get type(){return"tip"}static get configurable(){return{align:"t10-b50",offset:20,tooltip:{$config:["lazy","nullify"],value:{type:"tooltip"}}}}open(){this.getConfig("tooltip")}close(){var i;(i=this.tooltip)==null||i.hide()}dragMove(i){const{offset:e,tooltip:t}=this,{event:r}=i;t&&(t.isVisible||t.show(),t.alignTo({align:this.align,target:new V(r.clientX-e,r.clientY-e,e*2,e*2)}))}changeTooltip(i,e){return j.reconfigure(e,i,this)}};jo.initClass(),jo._$name="DragTipProxy";var zo=i=>{var e;return e=class extends(i||F){static get configurable(){return{label:null,labelPosition:"before",labelCls:null,labelWidth:{value:null,$config:{localeKey:"L{labelWidth}"}}}}get hasLabel(){return!!this.label}compose(){const{hasLabel:t,labelPosition:r}=this;return{class:{[`b-label-${r}`]:t,"b-has-label":t}}}changeLabel(t){return t||""}setupLabel(t){return x.assign({tag:"label",for:`${this.id}-input`,class:`b-label b-align-${t.align||"start"}`},t)}updateLabelWidth(t){this.labelElement&&(this.labelElement.style.flex=`0 0 ${D.setLength(t)}`,this.inputWrap.style.flexBasis=t==null?"":"auto")}get widgetClass(){}},y(e,"$name","Labelable"),e},ts=class extends Be{static get configurable(){return{animation:{duration:300},collapsed:null,collapser:{value:null,$config:"nullify"},syncableConfigs:null,syncConfigTriggers:{$config:{merge:"classList"},value:null},testConfig:{animation:{duration:10}}}}static get delayable(){return{syncChildConfigs:"raf"}}get inline(){var i;return(i=this.owner.inline)!=null?i:this.ensureItems().count===1}changeCollapsed(i){if(this.togglingCollapse)return this.togglingCollapse=!1,i;this.toggleCollapse(!!i)}updateCollapsed(i){var e;this.collapser=(e=this.collapser)==null?void 0:e.destroy(),this.setCollapsedCls(i)}updateCollapser(i,e){e&&e.completed==null&&(!e.reverting||!i)&&e.destroy(),this.setOwnerCls("b-collapsing",i)}get collapsing(){const{collapser:i}=this;return i!=null&&i.collapsed}get collapsingExpanding(){return this.collapser!=null}get expanding(){const{collapser:i}=this;return i!=null&&!i.collapsed}collapse(i){this.toggleCollapse(!0,i)}expand(i){this.toggleCollapse(!1,i)}setCollapsedCls(i){this.setOwnerCls("b-collapsed",i)}setOwnerCls(i,e){var t,r;(r=(t=this.owner)==null?void 0:t.element)==null||r.classList[e?"add":"remove"](i)}syncChildConfigs(){const i=this,{owner:e,syncableConfigs:t}=i;if(t){let r,n;for(r in t)n=t[r](e),i.eachWidget(s=>{s[r]=n},!1)}e.afterSyncChildConfigs(i)}syncContainer(){const{inline:i,layout:e}=this;this.autoLayout&&(e.horizontal=i,e.justify=i?"center":"stretch")}toggleCollapse(i,e){const t=this,{animation:r,collapser:n,inline:s}=t,{containerWrapElement:a}=t.owner,l=o=>{o&&(t.element.style.height="",t.togglingCollapse=!0,t.collapsed=i,t.collapser=null)};if(i==null&&(i=!t.collapsed),e!==!1&&e!==null&&(!a||!t.isVisible?e=null:(e===!0?e={}:typeof e=="number"&&(e={duration:e}),e=r||e?x.merge({},r,e):null)),!e)t.togglingCollapse=!0,t.collapsed=i;else if(n&&i!==n.collapsed)t.collapser=n.revert({finalize:l}),t.collapser.collapsed=i;else if(!n&&i!==t.collapsed){!i&&t.setCollapsedCls(!1);const{element:o}=t,{height:u}=o.getBoundingClientRect(),c=s?1:u;!i&&t.setCollapsedCls(!0),o.style.height=`${u}px`,t.collapser=Ae.run(x.merge({finalize:l,element:a,[s?"opacity":"height"]:{from:i?c:0,to:i?0:c}},e)),t.collapser.collapsed=i}}};y(ts,"$name","FieldContainer"),y(ts,"type","fieldcontainer"),ts.initClass(),ts._$name="FieldContainer";var pC=(i,e)=>(i.weight||0)-(e.weight||0),vC=(i,e)=>(e.weight||0)-(i.weight||0),Wo=[],yC={align:!0,weight:!0},Ho=class cl extends j.mixin(To,zo){static get configurable(){return{defaultBindProperty:"value",placeholder:null,value:"",name:null,labels:null,required:null,clearable:null,revertOnEscape:null,hint:null,hintHtml:null,inputWidth:null,keyStrokeChangeDelay:0,readOnly:null,editable:!0,defaultAction:"change",triggers:null,highlightExternalChange:!0,localizableProperties:["label","title","placeholder","labelWidth"],autoSelect:!1,autoComplete:"off",spellCheck:null,validateOnInput:!0,inputAttributes:null,inputType:"text",inputAlign:null,attributes:{value:["placeholder","autoComplete","spellCheck","minLength","maxLength","pattern","tabIndex","min","max"],$config:{merge:"distinct"}},nullValue:{$config:null,value:null,default:null},updatedClsDuration:500,inputReadOnly:!1,ariaElement:"input",container:{$config:"nullify",value:null},containerDefaults:{type:"fieldcontainer",syncableConfigs:{disabled:e=>e.disabled},syncConfigTriggers:{disabled:1}},containValues:null,inline:null,testConfig:{updatedClsDuration:10},keyMap:{}}}static get delayable(){return{highlightChanged:"raf"}}doDestroy(){var e,t,r;const n=this,{triggers:s}=n,a=n.isPainted&&cl.getSharedErrorTooltip(n.rootElement,!0);if((e=n.inputListenerRemover)==null||e.call(n),(t=n.keyListenerRemover)==null||t.call(n),(r=n.container)==null||r.destroy(),super.doDestroy(),s)for(const l of Object.values(s))l.destroy();(a==null?void 0:a.field)===n&&a.hide()}get childItems(){const{container:e,triggers:t}=this,r=t?Object.values(t):[];return e?[...r,...e.childItems]:r}get invalidValueError(){return"L{invalidValue}"}get errorTip(){return this.constructor.getSharedErrorTooltip(this.rootElement)}static getSharedErrorTooltip(e,t){var r;let n=(r=e.bryntum)==null?void 0:r.errorTooltip;return!n&&!t&&(e.bryntum=e.bryntum||{},n=new je({cls:"b-field-error-tip",forSelector:".b-field.b-invalid .b-field-inner",align:{align:"l-r",monitorTargetMutation:!0},scrollAction:"realign",trapFocus:!1,rootElement:e,onBeforeShow(){const s=this,a=j.fromElement(s.activeTarget);if(a){const l=a.getErrors();if(l)return s.html=l.join("<br>"),s.field=a,!0}return!1}}),e.bryntum.errorTooltip=n),n}static get errorTip(){return this.getSharedErrorTooltip(document.body)}construct(e){super.construct(e);const t=this;t.keyStrokeChangeDelay&&(t.changeOnKeyStroke=t.buffer(t.internalOnChange,t.keyStrokeChangeDelay))}changeKeyMap(e){var t;const r=this;let n={};e&&(r._fieldKeyMap?x.assign(n,r._fieldKeyMap):(r._fieldKeyMap=e,x.assign(n,e)));for(const s in r.triggers)(t=r.triggers[s])!=null&&t.keyMap&&(n=r.mergeKeyMaps(n,r.triggers[s].keyMap,s));return n}get keyMapSubComponents(){return this.triggers}onFocusIn(e){const t=this;t.valueOnFocus=x.clone(t.value),t.validOnFocus=!(t.errors&&Object.keys(t.errors).length),super.onFocusIn(e),t.focusing=!0,t.syncInvalid(),t.focusing=!1}onFocusOut(e){super.onFocusOut(e),this.syncRequired(),this.onEditComplete()}onEditComplete(){}get rootUiClass(){return cl}compose(){this.getConfig("clearable");const e=this,{container:t,innerElements:r,label:n,labels:s,labelCls:a,readOnly:l,triggers:o}=e,u=x.values(o,(f,m)=>!m),c=u.filter(f=>f.align==="start").sort(pC),d=u.filter(f=>f.align!=="start").sort(vC),h=e.setupLabel.bind(e),g=[...c.map(f=>f.element),...r,...d.map(f=>f.element)];return{class:{"b-has-start-trigger":c.length,"b-no-input":!r.length,"b-readonly":l,"b-field-container":!!t,"b-field-container-inline":t==null?void 0:t.inline},children:[...(s||Wo).filter(f=>f&&f.align!=="end").map(h),(n||null)&&h({reference:"labelElement",class:`b-label b-align-start ${a||""}`,html:n}),g.length?{class:"b-field-inner",reference:"inputWrap",children:g}:null,...(s||Wo).filter(f=>(f==null?void 0:f.align)==="end").map(h),...t?[{reference:"containerWrapElement",children:[t.element],class:{"b-field-container-wrap":1}}]:Wo]}}updateElement(e,t){var r;const n=this,s=n.initialConfig.value,{input:a}=n;super.updateElement(e,t),s!=null&&(n.value=s),n.syncEmpty(),n.updateInputReadOnly(n.inputReadOnly),n.syncInvalid();const l=a||n.focusElement;(r=n.keyListenerRemover)==null||r.call(n),n.keyListenerRemover=l&&$.on({element:l,thisObj:n,keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}get innerElements(){return[this.inputElement]}get inputElement(){const{attributes:e,inputAttributes:t,id:r,inputCls:n,inputType:s,name:a}=this,l=x.assign({reference:"input",tag:"input",type:s,name:a||r,id:`${r}-input`,retainElement:!0},t);n&&(l.class=n);for(let o,u,c=e.length;c-- >0;)o=e[c],u=this[o],u!=null&&(l[o]=u);return l}get caretPos(){return this.textSelection[0]}set caretPos(e){this.textSelection=e}get focusElement(){return this.input}get textSelection(){var e;const t=this.input;let r;try{r=[t.selectionStart,t.selectionEnd,t.selectionDirection]}catch(n){r=((e=t.value)==null?void 0:e.length)||0,r=[r,r]}return r}set textSelection(e){typeof e=="number"?this.select(e,e):this.select(...e)}get hasTextSelection(){const[e,t]=this.textSelection;return e&&t-e>0}getAfterValue(e){const[t,r]=this.textSelection,n=this.input.value;return`${n.substr(0,t)}${e}${n.substr(r||t)}`}select(e,t){const r=this.focusElement;if(r.value.length){if(arguments.length===0){this.selectAll();return}if(!this.supportsTextSelection)return;r.setSelectionRange(e,t)}}moveCaretToEnd(){const e=this.input;if(e.createTextRange){const t=e.createTextRange();t.collapse(!1),t.select()}else this.supportsTextSelection&&this.select(e.value.length,e.value.length)}selectAll(){this.focusElement.select()}syncEmpty(){var e;const{isEmptyInput:t,isEmpty:r,element:n}=this,s=(e=this.triggers)==null?void 0:e.clear,a=t&&r;n&&(s&&s[a?"hide":"show"](),n.classList.toggle("b-empty",a))}updateHint(){this.syncHint()}updateHintHtml(){this.syncHint()}syncHint(){const e=this,{input:t,hint:r,hintHtml:n}=e,s=t==null?void 0:t.parentElement;if(t){let a=n||r;const l=e.hintElement||a&&(e.hintElement=D.createElement({parent:s,className:"b-field-hint",nextSibling:t.nextSibling,children:[{className:"b-field-hint-content"}]}));l&&(typeof a=="function"&&(a=a({source:e,value:e.value})),l.firstChild[n?"innerHTML":"textContent"]=a||""),e.element.classList[a?"remove":"add"]("b-field-no-hint")}}syncInvalid(){const e=this,{isPainted:t}=e;if(e.updatingInvalid=!0,t){const{isValid:r,element:n,inputWrap:s}=e;if(n.classList[r?"remove":"add"]("b-invalid"),r){const a=e.constructor.getSharedErrorTooltip(e.rootElement,!0);a!=null&&a.isVisible&&a.field===e&&a.hide()}else{const a=e.errorTip;a&&(e.containsFocus||e.isVisible&&s.contains(je.currentOverElement))&&(a.activeTarget===s&&a.isVisible?a.onBeforeShow():(a.activeTarget=s,a.showBy(s)))}}e.updatingInvalid=!1}updateEditable(){this.syncInputReadOnly()}syncInputReadOnly(){this.getConfig("readOnly"),this.inputReadOnly=this._readOnly||this.editable===!1}updateInputReadOnly(e){const t=this,{input:r,inputListenerRemover:n}=t;r&&(r.readOnly=e?"readOnly":null,e?t.inputListenerRemover=n==null?void 0:n():n||(t.inputListenerRemover=$.on({element:r,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput"})))}changeReadOnly(e){return!!e}updateReadOnly(e){this.syncInputReadOnly()}updateClearable(e){const t=this;t.getConfig("triggers"),t.triggers={clear:e&&x.assign({cls:"b-icon-remove",weight:1e3,key:"Shift+backspace",handler(){t._isUserAction=!0,t.clear(...arguments),t._isUserAction=!1}},e)||null}}changeTriggers(e,t){const r=this,n=r.$triggers||(r.$triggers=new Ir({configName:"triggers",factory:cl.Trigger,inferType:!1,owner:r,created(s){ue.after(s,"onConfigChange",(a,{name:l})=>{yC[l]&&r.onConfigChange({name:"triggers",value:n.target})})},setup(s,a){s.reference=s.ref=a,s.parent=r}}));if(r.stepTriggers===!1&&(e.back||e.forward)&&(e=x.assign({},e),delete e.back,delete e.forward),n.update(e),r.element&&(r.keyMap=r.keyMap),!t)return n.target}updateInputWidth(e){this.input.style.width=D.setLength(e),this.element.classList.add("b-has-width")}updateInputAlign(e){this.input.style.textAlign=e}get isValid(){const e=this;if(!e.disabled){if(e.syncRequired(),e.errors&&Object.keys(e.errors).length)return!1;const t=e.validity;if(t)return t.valid}return!0}get isEmpty(){return this.value==null||this.value===""}get isEmptyInput(){return!this.input||this.input.value==null||this.input.value===""}get validity(){const e=this.input;return e==null?void 0:e.validity}async setValue(e){this.value=e}changeValue(e,t){return e==null&&(e=this.nullValue),this.hasChanged(t,e)?e:(e===""&&this.syncRequired(),t)}updateValue(e,t){const r=this;r.isConfiguring||(r.syncRequired(),r.inputting||r.triggerChange()),r.inputting||(r._lastValue=e),r.syncInputFieldValue(),r.overflowTwin&&!r._overflowTwinSync&&(r._overflowTwinSync=!0,r.overflowTwin.value=e,r._overflowTwinSync=!1)}hasChanged(e,t){return t!==e}syncInputFieldValue(e=!1){const t=this,{input:r,parent:n,inputValueAttr:s,inputValue:a}=t;if(r&&!t.inputting&&r[s]!==a&&(r[s]=a,!t.isConfiguring&&!t.containsFocus&&t.highlightExternalChange)){if(r.classList.remove("b-field-updated"),t.clearTimeout("removeUpdatedCls"),n){const{assigningValues:l}=n;(l===!0||(l==null?void 0:l.highlight)===!1)&&(e=!0)}e||t.highlightChanged()}t.syncEmpty(),t.syncInvalid()}highlightChanged(){this.input.classList.add("b-field-updated"),this.setTimeout("removeUpdatedCls",this.updatedClsDuration)}removeUpdatedCls(){this.input.classList.remove("b-field-updated")}get inputValue(){return this.value==null?"":this.value}get inputValueAttr(){return"value"}get supportsTextSelection(){const e=this.focusElement;return e&&(e.tagName.toLowerCase()==="textarea"||e.type&&/text|search|password|tel|url/.test(e.type))}internalOnInputFocus(){this.autoSelect&&this.selectAll()}internalOnChange(e){const t=this;t.hasChanged(t._lastValue,t.value)&&t.isValid&&(t.triggerChange(e,!0),t._lastValue=t.value)}triggerChange(e,t=!!this._isUserAction){const r=this,{value:n,_lastValue:s,isValid:a}=r;r.syncHint(),r.triggerFieldChange({value:n,oldValue:s,event:e,userAction:t,valid:a}),r.defaultAction==="change"&&r.trigger("action",{value:n,oldValue:s,event:e,userAction:t,valid:a})}fetchInputValue(){this.value=this.input[this.inputValueAttr]}internalOnInput(e){var t;const r=this;r.validateOnInput||r.errorTip.hide(),r.inputting=!0,r.fetchInputValue(),r.inputting=!1,r.trigger("input",{value:r.value,event:e}),(t=r.changeOnKeyStroke)==null||t.call(r,e)}get needsInputSync(){var e;return this.input[this.inputValueAttr]!==String((e=this.inputValue)!=null?e:"")}internalOnKeyEvent(e){const t=this,{value:r}=t;let n=!1;if(e.type==="keydown"&&e.key==="Escape"&&!(t.readOnly||t.disabled)){const s=t.isValid,a="initialValue"in t?t.initialValue:t.valueOnFocus,l=t.hasChanged(a,r),{needsInputSync:o}=t;t.revertOnEscape&&(!s||l||o)&&(l&&(t.value=a),o&&t.syncInputFieldValue(!0),t.clearError(),n=(l||o)&&t.isValid||s!==t.validOnFocus)}t.isDestroyed||(n&&e.stopImmediatePropagation(),t.trigger(e.type,{event:e}))}clear(e){const t=this,{value:r}=t;(r!==t.nullValue||t.input.value.length>0)&&(t.value=t.nullValue,t.clearError(),t.syncInvalid(),t.trigger("clear",{event:e}))}onDisabled(){this.syncInvalid()}syncRequired(){var e;const t=this;!t.isConfiguring&&!t.focusing&&t.required&&t.isEmpty&&!((e=t.parent)!=null&&e.isSettingValues)?t.setError("L{fieldRequired}",t.updatingInvalid):t.clearError("L{fieldRequired}",t.updatingInvalid)}setError(e,t,r){const n=this;if((n.errors||(n.errors={}))[n.optionalL(e)]=1,t||n.syncInvalid(),r){const s=()=>{n.clearError(e),a()},a=n.ion({keydown:s,focusOut:s})}}clearError(e,t){const r=this;r.errors&&(e?delete this.errors[this.optionalL(e)]:r.errors={}),t||r.syncInvalid()}getErrors(){const e=this;if(!e.isValid){const t=e.validity,r=x.keys(t).find(a=>a!=="valid"&&a!=="customError"&&t[a]),n=e.errors&&Object.keys(e.errors);let s;if(n!=null&&n.length?s=n:t.customError?s=[e.input.validationMessage]:r?s=[e.L(r,{min:e.min,max:e.max})]:s=[e.L(e.invalidValueError)],(s==null?void 0:s.length)>0)return s}}createOverflowTwin(e){const t=this,r=super.createOverflowTwin(e);return r.ion({change({value:n}){t._overflowTwinSync=!0,t.value=n,t._overflowTwinSync=!1}}),r}get containerCollapsed(){var e;return(e=this.container)==null?void 0:e.collapsed}set containerCollapsed(e){const{container:t}=this;t&&(t.collapsed=e)}afterSyncChildConfigs(e){}changeContainer(e,t){e&&(Array.isArray(e)||!("type"in e||"items"in e))&&(e={items:e});const r=this,n=e&&x.merge({owner:r,layout:"box"},r.containerDefaults),s=j.reconfigure(t,e,{owner:r,defaults:n});if(s&&(s.autoLayout=(n==null?void 0:n.layout)==="box",s===t)){s.syncContainer();return}return s}onConfigChange(e){var t,r;super.onConfigChange(e),(r=(t=this.container)==null?void 0:t.syncConfigTriggers)!=null&&r[e.name]&&this.container.syncChildConfigs()}assignValue(e,t){const r=this,{container:n,containValues:s}=r,a=r.getValueName(t),l=e&&a in e;n&&s!==!1?e&&s==="nested"?l&&(e=x.clone(e[a]),super.assignValue({[a]:e&&!("value"in e)||e.value},t),e&&delete e.value,n.assignValue(e,t)):(super.assignValue(e,t),n.assignValue(e,t)):super.assignValue(e,t)}gatherValue(e){super.gatherValue(e),this.gatherValues(e)}gatherValues(e,t){const r=this,{container:n,containValues:s,valueName:a}=r,l=typeof s;t=t!=null?t:a in e,n&&s!==!1&&(s==="nested"?t&&(e[a]={value:e[a],...n.values}):(s===!0||s==null&&t||l==="string"&&r[s]||l==="function"&&s(r))&&n.gatherValues(e))}updateContainer(e,t){t&&this.detachListeners(t.id),e&&(e.rendered||e.render(),e.syncContainer(),e.syncChildConfigs())}};y(Ho,"$name","Field"),y(Ho,"type","field");var De=Ho;De.Trigger=class extends j{static get $name(){return"FieldTrigger"}static get factoryable(){return{defaultType:De.Trigger,extends:null}}static get type(){return"trigger"}static get configurable(){return{align:null,weight:null,role:void 0}}get field(){return this.parent}construct(){super.construct(...arguments),this.key&&(this.keyMap={[this.key]:"onClick"})}compose(){return{"aria-hidden":!0,class:{[`b-align-${this.align||"end"}`]:1,"b-icon":1},listeners:{click:"onClick",mousedown:"onMousedown"}}}changeAlign(e){return e}onClick(e){const t=this,{field:r}=t;r.disabled||r.readOnly||(e.key&&e.preventDefault(),r.trigger("trigger",{trigger:t})!==!1&&t.handler&&r.callback(t.handler,r,[e,t]))}onMousedown(e){const t=this.field;!("key"in e)&&D.isTouchEvent&&t.editable&&(t.editable=!1,t.setTimeout(()=>t.editable=!0,500)),e.preventDefault(),D.getActiveElement(t.input)!==t.input&&t.focus()}},De.SpinTrigger=class extends De.Trigger{static get $name(){return"SpinTrigger"}static get type(){return"spintrigger"}static get configurable(){return{repeat:{$config:["nullify"],value:!0}}}compose(){return{children:{upButton:{class:{"b-icon":1,"b-spin-up":1}},downButton:{class:{"b-icon":1,"b-spin-down":1}}}}}updateRepeat(e){var t;(t=this.clickRepeater)==null||t.destroy(),this.clickRepeater=e?ba.new({element:this.element},e):null}onClick(e){const t=this,{field:r}=t;r.disabled||r.readOnly||(e.target===t.upButton?r.doSpinUp(e.shiftKey):e.target===t.downButton&&r.doSpinDown(e.shiftKey))}},De.Trigger.initClass(),De.SpinTrigger.initClass(),j.register(De.Trigger,"trigger"),j.register(De.SpinTrigger,"spintrigger"),De._$name="Field";var vt=class extends De{static get configurable(){return{nullValue:""}}construct(i){(i==null?void 0:i.inputType)==="hidden"&&(i.hidden=!0),super.construct(...arguments)}};y(vt,"$name","TextField"),y(vt,"type","textfield"),y(vt,"alias","text"),vt.initClass(),vt._$name="TextField";var Qt=class extends vt{static get configurable(){return{editable:!0,pickerAlignElement:"inputWrap",value:null,triggers:{expand:{cls:"bars"}},autoClose:!0,autoExpand:null,picker:{value:{floating:!0},$config:["lazy","nullify"]},inputType:"text",monitorResize:!0,nullValue:null}}doDestroy(){var i;(i=this.globalTapListener)==null||i.call(this),super.doDestroy()}changeEditable(i){return U.isMobile&&this.initialConfig.editable!==!0&&(i=!1),i}updateAutoClose(i){!i&&ie.deprecate("Core","6.0.0","PickerField.autoClose is no longer supported")}updateEditable(i){var e;const t=this,{element:r,ariaElement:n,nonEditableClickTarget:s}=t,{expand:a}=t.triggers,l=globalThis.matchMedia("(max-width: 410px)").matches;super.updateEditable(...arguments),r.classList.toggle("b-not-editable",!i),i===!1?(U.isMobile&&l&&(a==null||a.hide()),n.removeAttribute("aria-autocomplete"),(e=t.globalTapListener)==null||e.call(t),$.on({element:s,click:o=>{const u=s.getRootNode().elementFromPoint(o.clientX,o.clientY);o.target===s&&u===s&&t.onTriggerClick(o)},thisObj:t})):(a==null||a.show(),n.setAttribute("aria-autocomplete","list"),t.globalTapListener=Me.ion({globaltap:"showKeyboard",thisObj:t}))}get nonEditableClickTarget(){return this.input}updateElement(i,e){var t;const r=super.updateElement(i,e),n=this.peekConfig("picker"),s=n?n.isWidget?n.role:(t=this.constructor.resolveType(n.type))==null?void 0:t.$meta.config.role:!1;return D.setAttributes(this.ariaElement,{"aria-expanded":!1}),this.ariaHasPopup=s,r}changePicker(i,e){throw new Error("changePicker(oldPicker, newPicker) must be implemented in PickerField subclass implementations")}get childItems(){const i=super.childItems;return this._picker&&i.push(this.picker),i}onEditComplete(){super.onEditComplete(),this.autoClosePicker()}onElementResize(i){const e=this;e.pickerVisible&&e.picker.requestAnimationFrame(e.picker.realign,null,e.picker),super.onElementResize(i)}internalOnKeyEvent(i){const e=this;let t=!0;if(i.type==="keydown"&&!e.disabled&&!i.shiftKey&&!i.ctrlKey)if(e.pickerVisible){const{picker:r}=e;i.key==="Escape"?(i.preventDefault(),i.stopImmediatePropagation(),e.hidePicker(),t=!1):r.onInternalKeyDown?r.onInternalKeyDown(i):i.key==="ArrowDown"&&r.focusable&&r.focus()}else i.key==="ArrowDown"&&(i.stopImmediatePropagation(),i.preventDefault(),e.onTriggerClick(i));t&&super.internalOnKeyEvent(i)}onFocusIn(i){const e=this;super.onFocusIn(i),e.autoExpand&&(e.minChars=0,e.onTriggerClick(i),e.ignoreTriggerClick=!0,e.setTimeout(()=>e.ignoreTriggerClick=!1,100))}onTriggerClick(i){this.disabled||this.togglePicker("key"in i)}showKeyboard({event:i}){const e=this.input;D.isTouchEvent&&D.getActiveElement(e)===e&&i.target===e&&(Me.suspendFocusEvents(),e.blur(),e.focus(),Me.resumeFocusEvents())}togglePicker(i){this.pickerVisible?this.hidePicker():this.showPicker(i)}showPicker(i){const e=this,{picker:t}=e;e.pickerHideShowListenersAdded||(t.ion({show:"onPickerShow",hide:"onPickerHide",thisObj:e}),e.pickerHideShowListenersAdded=!0),D.setAttributes(e.ariaElement,{"aria-controls":t.id,"aria-expanded":!0}),t.autoClose=e.autoClose,t.show(),t.isVisible&&i&&e.focusPicker()}onPickerShow(){const i=this;i.pickerVisible=!0,i.element.classList.add("b-open"),i.trigger("togglePicker",{show:!0}),i.pickerTapOutRemover=Me.ion({globaltap:"onPickerTapOut",thisObj:i}),i.pickerKeyDownRemover=$.on({element:i.picker.element,keydown:"onPickerKeyDown",thisObj:i})}onPickerHide(){var i,e;const t=this;t.ariaElement.setAttribute("aria-expanded",!1),t.pickerVisible=!1,t.element.classList.remove("b-open"),t.trigger("togglePicker",{show:!1}),(i=t.pickerTapOutRemover)==null||i.call(t),(e=t.pickerKeyDownRemover)==null||e.call(t)}onPickerTapOut({event:i}){!this.containsFocus&&!this.owns(i.target)&&this.autoClosePicker()}onPickerKeyDown(i){if(i.key==="Tab"&&!this.picker.trapFocus){const e=D.getActiveElement(this.input),t=new KeyboardEvent("keydown",i);this.input.dispatchEvent(t),t.defaultPrevented&&i.preventDefault(),D.getActiveElement(this.input)===e?this.input.focus():i.preventDefault(),this.isDestroyed||this.hidePicker()}}autoClosePicker(){this.autoClose&&this.hidePicker()}hidePicker(){this.pickerVisible&&this.picker.hide()}focusPicker(){}focus(){const i=this.input;D.isTouchEvent&&this.editable&&(i.readOnly=!0,this.setTimeout(()=>i.readOnly=!1,500)),super.focus()}};y(Qt,"$name","PickerField"),y(Qt,"type","pickerfield"),Qt._$name="PickerField";var er=document.createRange(),yt=class extends j{static get configurable(){return{itemCls:"b-list-item",selectedCls:"b-selected",selectIconCls:"b-icon-check",tag:"ul",items:null,displayField:"text",store:null,navigator:!0,scrollable:{overflowX:!1,overflowY:!0},itemsFocusable:!0,multiSelect:!1,toggleAllIfCtrlPressed:!1,collapsibleGroups:!1,selectAllItem:!1,itemTpl(i){let e=P.encodeHtml(i.getValue(this.displayField));return(e==null||e==="")&&(e="&nbsp;"),e},getItemStyle:null,getItemCls:null,groupHeaderTpl(i,e){let t=P.encodeHtml(e);return(t==null||t==="")&&(t="&nbsp;"),`${this.allowGroupSelect?this.itemIconTpl(i):""}${t}`},allowGroupSelect:!0,clearSelectionOnEmptySpaceClick:!1,selected:{$config:["nullify","lazy"],value:[]},activateOnMouseover:null,role:"listbox",keyMap:{"Ctrl+a":"selectAll"}}}construct(i,...e){var t;const r=this;Array.isArray(i)&&(i={items:i}),super.construct(i,...e);const{element:n}=r,{classList:s}=n;r.multiSelect&&s.add("b-multiselect"),(t=r.store)!=null&&t.count?r.refresh():s.add("b-empty"),$.on({element:n,delegate:r.itemSelector,mouseover:"onMouseOver",thisObj:r}),$.on({element:n,click:"onClick",thisObj:r})}doDestroy(){var i;this.detachListeners("store"),(i=this.navigator)==null||i.destroy(),super.doDestroy()}onFocusIn(i){var e;this.restoreActiveItem((e=i._target)==null?void 0:e.closest(this.itemSelector)),super.onFocusIn(i)}contentTpl(){const i=this,e=i.store.records.map((t,r)=>i.itemWrapperTpl(t,r));return i.multiSelect&&i.selectAllItem!==!1&&e.unshift(i.selectAllItemTpl()),gi.tpl`${e}`}itemWrapperTpl(i,e){const{selected:t,getItemStyle:r,store:n}=this,s=r?`style="${this.callback(r,this,[i])}"`:"";return n.isGrouped&&!i.isGroupHeader&&i.groupParent.get(n.id).meta.collapsed?"":gi.tpl`<li ${s} class="${this.getItemClasses(i,e)}" role="option" aria-selected="${t.includes(i)}" data-index="${e}" data-id="${P.encodeHtml(i.id)}" ${this.itemsFocusable?'tabindex="-1"':""}>${this.itemContentTpl(i,e)}</li>`}itemContentTpl(i,e){if(i.isGroupHeader){let t=this.groupHeaderTpl(i,P.capitalize(i.meta.groupRowFor));if(this.collapsibleGroups){const r=i.meta.collapsed?"right":"down";t+=`<button class="b-button b-tool b-icon b-icon-collapse-${r} b-list-expander-icon" data-noselect></button>`}return t}return`${this.itemIconTpl(i,e)}${this.itemTpl(i,e)}`}itemIconTpl(i,e){return this.multiSelect?`<i class="b-selected-icon b-icon ${this.selectIconCls}"></i>`:""}selectAllItemTpl(){const i=this.allSelected?"b-selected":"";return`<li class="${this.itemCls} b-select-all-item ${i}" data-noselect data-select-all data-id="select-all">${this.itemIconTpl({})}<div>${this.L("selectAll")}</div></li>`}getItemClasses(i){var e;const t=this,{getItemCls:r}=t,n=(e=t._navigator)==null?void 0:e.activeItem,s=(n==null?void 0:n.dataset.id)==i.id,a="groupRowFor"in i.meta?"b-list-item-group-header":"",l=t.selected.includes(i)||i.isSpecialRow&&i.groupChildren.every(u=>t.selected.includes(u)),o=r?this.callback(r,this,[i]):"";return`${t.itemCls} ${i.cls||""} ${o} ${l?t.selectedCls:""} ${s?t.navigator.focusCls:""} ${a}`}onBeforeStoreLoad(){this.mask(this.L("L{loading}"))}onAfterStoreRequest(){this.unmask()}onStoreChange({source:i,action:e,records:t,record:r,changes:n}){const s=this,{selected:a}=s;switch(e){case"dataset":{a.match(i.storage,!s._externallyOwnedSelection);break}case"remove":a.remove(t);break;case"clear":s.deselectAll();break;case"update":{const{id:l}=n;l&&D.setAttributes(s.contentElement.querySelector(P.encodeAttributeSelector("data-id",l.oldValue)),{"data-id":l.value}),s.refreshItem(r);return}}s.refresh()}onStoreRefresh(){this._selected?this.refresh():this.getConfig("selected")}refresh(){var i;const e=this;if(e.isVisible&&e.store){const t=(i=e.navigator)==null?void 0:i.activeItem;e.paintListener=null;const r=D.createElementFromTemplate(e.contentTpl(),{fragment:!0});e.clearItems().insertNode(r),t&&e.restoreActiveItem(t),e.refreshCount=(e.refreshCount||0)+1,e.element.classList[e.store.count>0?"remove":"add"]("b-empty"),e.updateSelectAllState()}else e.paintListener||(e.paintListener=e.ion({paint:"refresh",thisObj:e,once:!0}))}clearItems(){const i=this,e=i.contentElement.querySelector(i.itemSelector),t=i.contentElement.lastChild;if(e){const r=i.contentElement.querySelectorAll(`${i.itemSelector}:not(.b-mask)`);er.setStartBefore(e),er.setEndAfter(r[r.length-1]),er.deleteContents()}else t?(er.setStartAfter(t),er.setEndAfter(t)):(er.setStart(i.contentElement,0),er.setEnd(i.contentElement,0));return er}refreshItem(...i){for(const e of i){const t=this.getItem(e);if(t){const r=this.store.indexOf(e),n=D.createElementFromTemplate(this.itemWrapperTpl(e,r));D.sync(n,t)}}}getItem(i){if(i!=null)return typeof i=="number"?this.contentElement.querySelector(`[data-index="${i<0?this.store.count+i:i}"]`):(i.nodeType===Element.ELEMENT_NODE&&(i=i.dataset.id),(i==null?void 0:i.id)!=null&&(i=i.id),this.contentElement.querySelector(P.encodeAttributeSelector("data-id",i)))}getRecordFromElement(i){return i.target&&(i=i.target),i=i.closest(this.itemSelector),this.store.getAt(parseInt(i.dataset.index))}updateItems(i){var e;const t=this,r=re.getStore(z.asArray(i));(e=t.store)!=null&&e.autoCreated?t.store.data=(r==null?void 0:r.records)||[]:t.store=r}updateDisabled(i){super.updateDisabled(...arguments),this.navigator&&(this.navigator.disabled=i)}changeSelected(i,e){const t=this,r={change:"onInternalSelectionChange",thisObj:t};if(e==null||e.un(r),i)if(i.isCollection)t._externallyOwnedSelection=!0,i.ion(r);else if(t._externallyOwnedSelection=!1,i=z.asArray(i).reduce((n,s)=>(s=s.isModel?s:t.store.getById(s),s&&n.push(s),n),[]),e)e.splice(0,e.count,i),i=e,t.refresh();else{const n=i;i=t._selected=new wr({internalListeners:r}),i.add(n)}else e==null||e.destroy();return i}updateSelected(i){i&&this.refresh()}get itemSelector(){return`.${this.itemCls}`}get selected(){return this._selected}updateMultiSelect(i,e){!i&&e&&this.selected.count>1&&this.deselect(this.selected.allValues.slice(1))}get store(){return this.getConfig("items"),this._store}changeStore(i){const e=this;if(i instanceof re||(Array.isArray(i)&&(i={data:i}),i=new re(i)),e.detachListeners("store"),i){const t={name:"store",change:"onStoreChange",refresh:"onStoreRefresh",thisObj:e};i.readUrl&&(t.beforeLoad="onBeforeStoreLoad",t.afterRequest="onAfterStoreRequest"),i.isGrouped&&(e.element.classList.add("b-grouped"),t.groupchange="onStoreRefresh"),i.ion(t)}return i}updateStore(i){i!=null&&i.records.length&&this.getConfig("selected"),this.refreshCount||this.refresh()}changeNavigator(i,e){const t=this,{element:r}=t;return r&&(i=pi.reconfigure(e,i?pi.mergeConfigs({ownerCmp:t,disabled:t.disabled,target:r,keyEventTarget:r},i):null,t),(i==null?void 0:i.keyEventTarget)===r&&!t.itemsTabbable&&(r.tabIndex=0)),i}get minAlignHeight(){const i=this.element.lastElementChild,e=this.minHeight;if(e!=null)return i?Math.min(i.offsetTop+i.offsetHeight,e):0}alignTo(...i){super.minHeight=this.minAlignHeight,super.alignTo(...i)}hide(...i){return this.navigator&&(this.navigator.activeItem=null),super.hide(...i)}show(){const{refreshCount:i}=this,{previousActiveItem:e}=this.navigator;super.minHeight=this._minHeight;const t=super.show(...arguments);return this.refreshCount===i&&this.restoreActiveItem(e,!0),t}restoreActiveItem(i=this.navigator.previousActiveItem,e="nearest"){const t=this,{navigator:r,lastAlignSpec:n}=t;if(i!=null){if(typeof e!="string"){const s=n?n.zone:1;e=s&1?"nearest":s?"start":"end"}i=t.getItem(i),i&&!t.disabled&&(t.scrollable.scrollIntoView(i,{block:e}),r.activeItem=i)}}onMouseOver(i){const e=this,t=i.currentTarget;!D.isTouchEvent&&t&&e.navigator&&e.activateOnMouseover&&e.setTimeout({fn:"handleMouseOver",delay:30,args:[t],cancelOutstanding:!0})}handleMouseOver(i){this.navigator.activeItem=i}onClick(i){const e=i.target.closest(this.itemSelector);e?this.onItemClick(e,i):this.clearSelectionOnEmptySpaceClick&&this.deselectAll()}onSpaceKey(i){(i.target.nodeName.toUpperCase()!=="INPUT"||i.target.readOnly)&&this.onEnterKey(i)}onEnterKey(i){const e=this.navigator.activeItem;e&&!this.disabled&&(this.onItemClick(e,i),i.stopImmediatePropagation(),i.preventDefault())}onInternalKeyDown(i){const e=this;switch(i.key){case"ArrowLeft":e.collapseItem();break;case"ArrowRight":e.expandItem();break;case" ":e.onSpaceKey(i);break;case"Enter":e.onEnterKey(i);break}}collapseItem(){const{activeItem:i}=this.navigator;i&&this.toggleCollapse(this.getRecordFromElement(i),!0)}expandItem(){const{activeItem:i}=this.navigator;i&&this.toggleCollapse(this.getRecordFromElement(i),!1)}onItemClick(i,e){var t;const r=this,{allowGroupSelect:n}=r,s=parseInt(i.dataset.index),a=r.store.getAt(s),l=a==null?void 0:a.isSpecialRow,o=i.contains(e.target.closest("[data-noselect]"));if(!(r.disabled||r.trigger("beforeItem",{item:i,record:a,index:s,event:e,userAction:!0})===!1)){if(r._isUserAction=!0,i.contains(e.target.closest("[data-select-all]")))r.onSelectAllClick(i,e);else if(e.target.matches(".b-list-expander-icon")){r.toggleCollapse(a);return}else if(a&&!o&&(!l||n)){const{selected:u}=r,c=(t=a.groupParent)==null?void 0:t.get(r.store.id);if(r.multiSelect){let d=u.includes(a),h=a;r.toggleAllIfCtrlPressed&&e.ctrlKey?h=r.store.records:n&&l&&(d=!a.groupChildren.some(g=>!u.includes(g)),i.classList.toggle("b-selected",!d),h=a.groupChildren),u[d?"remove":"add"](h),!l&&c&&n&&r.getItem(c).classList.toggle("b-selected",c.groupChildren.every(f=>u.includes(f)))}else u.splice(0,u.count,a)}r.isDestroyed||(r.lastClicked=a,r.trigger("item",{item:i,record:a,index:s,event:e,userAction:!0}),r._isUserAction=!1)}}onInternalSelectionChange({action:i,removed:e,added:t,replaced:r}){const n=this,{selectedCls:s,unselectedCls:a}=n;let l,o;if(i==="clear")for(o of n.element.querySelectorAll(`.${s}`))o.classList.remove(s),o.setAttribute("aria-selected",!1),a&&o.classList.remove(a);else if(i!=="replaceValues"){for(l of e)o=n.getItem(l),o&&(o.classList.remove(s),o.setAttribute("aria-selected",!1));for(l of t)o=n.getItem(l),o&&(o.classList.add(s),o.setAttribute("aria-selected",!0))}n.selectAllItem&&n.updateSelectAllState(),n.trigger("selectionChange",{selected:n.selected.values})}onSelectAllClick(i){i.classList.contains(this.selectedCls)?this.deselectAll():this.selectAll()}updateSelectAllState(){var i;(i=this.element.querySelector(".b-select-all-item"))==null||i.classList.toggle(this.selectedCls,this.allSelected)}get allSelected(){const{selected:i,store:e}=this;return i.count&&(e.isFiltered?e.records.every(t=>i.includes(t)):e.count===i.count)}selectAll(i){const e=this;(e.multiSelect||!i)&&(e.selected.add(e.store.records),i&&!e.navigator.activeItem&&(e.navigator.activeItem=e.getItem(-1)))}deselectAll(){this.selected.clear()}select(i){const{store:e}=this,{modelClass:t}=e;i=z.asArray(i).reduce((r,n)=>(n=e.getById(t.asId(n)),n&&r.push(n),r),[]),this.selected.add(i)}deselect(i){const{modelClass:e}=this.store;i=z.asArray(i).reduce((t,r)=>(r=this.selected.get(e.asId(r)),r&&t.push(r),t),[]),this.selected.remove(i)}toggleCollapse(i,e){i.isGroupHeader&&(e=e===void 0?!i.meta.collapsed:e,this.store[e?"collapse":"expand"](i),this.refresh(),this.trigger("toggleGroup",{groupRecord:i,collapse:e}))}updateCollapsibleGroups(i,e){if(e&&!i){const{store:t}=this;t.groupRecords.forEach(r=>t.expand(r))}this.refresh()}};y(yt,"$name","List"),y(yt,"type","list"),yt.initClass(),yt.prototype.navigatorClass=pi,yt._$name="List";var bi=class extends yt{static get configurable(){return{itemCls:"b-chip",multiSelect:!1,closable:!0,iconTpl:null,closeHandler:null}}itemContentTpl(i,e){const t=this;return gi.tpl`${t.iconTpl?this.iconTpl(i):""}
            ${t.itemTpl(i,e)}
            ${t.closable?'<div class="b-icon b-close-icon b-icon-clear" data-noselect></div>':""}`}onInternalKeyDown(i){const e=this;e.closable&&e.selected.count&&(i.key==="Delete"||i.key==="Backspace")?e.callback(e.closeHandler,e.owner,[e.selected.values,{isKeyEvent:!0}]):super.onInternalKeyDown(i)}updateClosable(i){this.element.classList[i?"add":"remove"]("b-chips-closable"),this.navigator&&(this.navigator.disabled=!i),this.isConfiguring||this.refresh()}onClick(i){const e=this,t=i.target.closest(`.${e.itemCls}`);if(e.closable&&i.target.classList.contains("b-close-icon")){const r=e.store.getAt(parseInt(t.dataset.index));e.closeHandler?e.callback(e.closeHandler,e.owner,[[r]]):e.store.remove(r)}else super.onClick(i)}};y(bi,"$name","ChipView"),y(bi,"type","chipview"),bi.initClass(),bi._$name="ChipView";var Yo="L{Field.fieldRequired}",Ci="L{Field.validateFilter}",bC="L{Combo.recordNotCommitted}",CC=/[\w\s]/,ze=class extends Qt{static get configurable(){return{primaryFilter:{},picker:{type:"list",floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,align:{align:"t0-b0",axisLock:!0},maxHeight:324,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},multiSelect:null,items:null,store:null,valueField:void 0,displayField:"text",pickerWidth:null,minChars:null,selected:null,listItemTpl:null,displayValueRenderer:null,listCls:null,triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},filterParamName:null,encodeFilterParams:i=>i.map(e=>e.value),filterOnEnter:!1,hideTrigger:null,overlayAnchor:null,keyStrokeFilterDelay:null,defaultAction:"select",triggerAction:"all",filterOperator:"startsWith",caseSensitive:!1,hidePickerOnSelect:null,chipView:{$config:["lazy","nullify"],value:{type:"combochipview"}},chipStore:{$config:["lazy","nullify"],value:{}},filterSelected:null,emptyText:null,value:null,valueCollection:{$config:["nullify","lazy"],value:{}},validateFilter:!0,clearTextOnPickerHide:!0,destroyStore:!1,multiValueSeparator:",",createOnUnmatched:null,role:"combobox",inlinePicker:null,testConfig:{keyStrokeFilterDelay:0},localizeDisplayFields:!1,buildItems:null}}static get queryLast(){return"last"}construct(i){super.construct(...arguments),this.store||(this.items=[]),this.filterOnEnter&&(this.hideTrigger=!0)}startConfigure(i){this.usingRecordAsValue=i.valueField===null,super.startConfigure(...arguments)}afterConfigure(){super.afterConfigure();const i=this;x.hasOwn(i,"_value")||(i._value=i.valueField===i.displayField?"":null,i._lastValue=i._lastValue||i._value)}get childItems(){const{_chipView:i,_picker:e}=this,t=super.childItems;return i&&t.push(i),e&&t.push(e),t}get innerElements(){var i;const e=(i=this._chipView)==null?void 0:i.element,{input:t,inputElement:r}=this;return e&&de.sync({targetElement:t,domConfig:r}),[e||r]}updateInlinePicker(i){i&&(this.element.classList.add("b-inline-picker"),this.getConfig("picker"),this.triggers.expand=null,this.pickerVisible=!0)}hidePicker(){if(!this.inlinePicker)return super.hidePicker(...arguments)}changeChipStore(i){return i&&!(i instanceof re)&&(i=new re(re.mergeConfigs({storage:this.valueCollection},i))),i}updateChipStore(i,e){e==null||e.destroy()}changeChipView(i,e){const t=this;if(t.element.classList[i?"add":"remove"]("b-uses-chipview"),i){const{input:r}=t;return t.chipStore||(t.chipStore={}),Ff.reconfigure(e,i,{defaults:{parent:t,insertBefore:r,store:t.chipStore,closable:!t.readOnly,navigator:{type:"combochipnavigator",keyEventTarget:r}}})}e==null||e.destroy()}updateChipView(i){var e;const t=this;t._chipViewEventDetacher=(e=t._chipViewEventDetacher)==null?void 0:e.call(t),t.chipStore=i==null?void 0:i.store,i&&(i.element.appendChild(t.input),t._chipViewEventDetacher=$.on({element:i.element,mousedown:"onChipViewMousedown",thisObj:t}))}updateMultiSelect(i,e){const t=this,{input:r,element:n}=t,s=!t.isConfiguring;let{value:a}=t;if(n.classList[i?"add":"remove"]("b-multiselect"),i){const{chipView:l}=t,{parentNode:o}=r,u=l==null?void 0:l.element;u&&u!==o&&(o.insertBefore(u,r),u.appendChild(r),t.chipView.refresh()),r.value="",s&&(a=z.asArray(a))}else{const l=t._chipView,{parentNode:o}=r,u=l==null?void 0:l.element;u===o&&(u.parentNode.insertBefore(r,u),u.remove(),n.classList.remove("b-uses-chipview")),s&&typeof a!="string"&&(a=a!=null&&a.length?a[0]:null)}s&&(t.value=a)}onChipViewMousedown(i){i.preventDefault(),this.containsFocus||this.focus()}onChipClose(i,e={}){(e.isKeyEvent&&this.input.value===""||!e.isKeyEvent)&&(this._isUserAction=!0,this.valueCollection.remove(i),this._isUserAction=!1)}updateFilterParamName(i){this.hideTrigger!==!1&&(this.hideTrigger=!!i)}updateHideTrigger(i){this.element.classList[i?"add":"remove"]("b-hide-trigger")}updateKeyStrokeFilterDelay(i){this.filterOnInput.delay=i}updateReadOnly(i){super.updateReadOnly(...arguments),this._chipView&&(this._chipView.closable=!i)}updateDisabled(i){super.updateDisabled(...arguments),this._chipView&&(this._chipView.closable=!i)}updateFilterOperator(i){this.primaryFilter&&(this.primaryFilter.operator=i)}get minChars(){const i=this._minChars;return i!=null?i:this.remoteFilter?4:1}get validateFilter(){return this._validateFilter&&!this.createOnUnmatched}get items(){return this.store.allRecords}updateBuildItems(i){i&&(this.items=i.call(this))}changeItems(i){const e=this;if(i==null){if(e.store&&!e.store.isItemStore)return;i=[]}if(e.buildItems&&!(i!=null&&i.length)&&(i=e.buildItems()),i instanceof re){e.store=i;return}const t=e.displayField;let r,n=e.valueField,s;if(Array.isArray(i)?s=i.map(a=>{let l=a;return a instanceof Q?(r=a.constructor,n||(e.valueField=n=r.idField)):typeof a=="string"||typeof a=="number"?(n||(e.valueField=n=e.displayField),l={[n]:a,[t]:a}):(n||(e.valueField=n="value"),Array.isArray(a)&&(l={[n]:a[0],[t]:a[1]})),a.selected&&(e.value=l),l}):(n||(e.valueField=n="value"),s=[],Object.entries(i).forEach(([a,l])=>{s.push({[n]:a,[t]:l})})),e.store)e.store.data=s;else{const a=n===t?{name:"value",dataSource:t}:n;if(!r){class l extends Q{static get idField(){return e.valueField}static set idField(u){super.idField=u}static get fields(){return[a,t]}}r=l}e.store=new re({isItemStore:!0,data:s,idField:n,verifyNoGeneratedIds:!1,modelClass:r})}}get value(){const i=this,{valueCollection:e,valueField:t}=i;if(t==null)return i.multiSelect?e.values.slice():e.first;let r;return i.multiSelect?r=e.count?e.map(n=>n[t]):i._lastValue||[]:r=e.count?e.first[t]:i._lastValue,r}set value(i){super.value=i}get needsInputSync(){return this.usesChipView?!1:!this.editable}changeValue(i,e){var t,r;const n=this;if(i===e){n.syncInputFieldValue(!0);return}if(!n.multiSelect&&Array.isArray(i)&&i.length>1)throw new Error("Multiple values cannot be set to a non-multiSelect Combo");n.triggerConfig("items"),n.inputting||(t=n._chipView)==null||t.selected.clear(),n.store||(n.items=[]);const{valueField:s,displayField:a,store:l,valueCollection:o,_picker:u}=n,{storage:c}=l,d=(r=n.hidePickerOnSelect)!=null?r:!n.multiSelect,h=n._isUserAction||(u==null?void 0:u._isUserAction)||d&&n.pickerVisible||!1;if(!n.remoteFilter&&l.isAjaxStore&&!l.count){l.ion({load:()=>n.value=i,once:!0,thisObj:n}),n._lastValue=i;return}let g;if(i!=null){const f=Array.isArray(i),m=f?i.slice():[i];if(n.remoteFilter){if(i!=null){if(x.isObject(i)||i.isModel)n.store.data=[i],n.valueCollection.splice(0,n.valueCollection.count,n.store.first);else{const b=n.isConfiguring;n.primaryFilter.setConfig({value:i,disabled:!1}),l.performFilter(!0).then(()=>{if(n.isDestroyed)return;const{isConfiguring:w}=n;n.isConfiguring=b,o.splice(0,o.count,l.allRecords),n.isConfiguring=w})}return}}else l.isFiltered&&(n.primaryFilter.disabled=!0,l.filter());for(let b=0,w=m.length;b<w;b++){let S=m[b];if(S instanceof Q)c.includes(S,!0)||l.add(S);else{const C=x.isObject(S);C&&(S=S[l.modelClass.fieldMap[s].dataSource]),g=c.getBy(a,S)||c.getBy(s,S)||o.getBy(a,S)||o.getBy(s,S),g instanceof Set&&(g=[...g][0]),g?(C&&g.set(m[b]),m[b]=g):(m.splice(b,1),w--,b--)}}const p=!m.length,v=o.generation;o.splice(0,o.count,m),p&&(n._value=f&&i.length===0?null:i,n._lastValue=n._value),(p||o.generation===v)&&n.syncInputFieldValue(),n.syncEmpty(),p&&!n.isConfiguring&&n.triggerFieldChange({value:i,oldValue:e,userAction:h,valid:n.isValid})}else if(o.count)o.clear();else{const f=n._value;n._value=null,n.syncInputFieldValue(),n.syncEmpty(),n.isConfiguring||n.triggerFieldChange({value:i,oldValue:f,userAction:h,valid:n.isValid})}n._lastValue=n._value}hasChanged(i,e){return this.multiSelect?!x.isEqual(i,e):super.hasChanged(...arguments)}onComboStoreChange({action:i}){i!=="filter"&&this.syncInputFieldValue(!0)}syncInputFieldValue(i){var e;this.usesChipView?(e=this.chipView)==null||e.refresh():super.syncInputFieldValue(i)}get usesChipView(){return!!(this.multiSelect&&this._chipView)}get isEmpty(){return this.valueCollection.count===0}get inputValue(){const i=this;let e=i.selected?i.selected[i.displayField]:i.value;return i.displayValueRenderer&&(e=i.callback(i.displayValueRenderer,i,[i.selected,i])),e==null?"":e}get nonEditableClickTarget(){var i;return this.multiSelect&&((i=this.chipView)==null?void 0:i.element)||super.nonEditableClickTarget}changeValueCollection(i,e){if(e==null||e.destroy(),i)return i.isCollection||(i=new wr({internalListeners:{noChange:"onValueCollectionNoChange",change:"onValueCollectionChange",prio:-1e3,thisObj:this}})),i}changePrimaryFilter(i){return i.isCollectionFilter?i.setConfig({disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive}):(typeof i=="function"&&(i={filterBy:i}),i=new Oe({id:"primary",disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive,...i})),i}changeStore(i){const e=this,t=[],{valueCollection:r,keyStrokeFilterDelay:n,filterParamName:s}=e;if(Array.isArray(i)){e.items=i;return}let a;if(i){if(i.isStore){const l=i.filters.get("primary");e.remoteFilter&&(i.filterParamName=s),a=i.remoteFilter||i.restfulFilter,l?e.primaryFilter=l:t.push(e.primaryFilter)}else typeof i=="string"?i=re.getStore(i):(i=new(i.readUrl?Xe:re)(i),e.destroyStore=!0),a=e.remoteFilter||i.restfulFilter,a&&s&&(i.filterParamName=s,e.encodeFilterParams&&(i.encodeFilterParams=e.encodeFilterParams)),t.push(e.primaryFilter);if(!e.valueField&&!e.usingRecordAsValue&&(e.valueField=i.modelClass.idField),e.filterSelected){const l=o=>!e.containsFocus||!r.includes(o);a?(i.storage.autoFilter=!0,i.storage.addFilter({id:`${e.id}-selected-filter`,filterBy:l})):(t.push(l),i.reapplyFilterOnAdd=!0)}r.addIndex({property:e.displayField,unique:!1}),r.addIndex({property:e.valueField,unique:!0}),t.forEach(l=>i.addFilter(l,!0)),a?e.keyStrokeFilterDelay=Math.max(300,n||0):e.keyStrokeFilterDelay=n!=null?n:10}return i}updateStore(i,e){const t=this,{_picker:r}=t;let n;t.destroyStore&&e&&e.destroy(),r&&(r.store=i),i.storage.addIndex({property:t.displayField,unique:!1}),i.storage.addIndex({property:t.valueField,unique:!0}),n={filter:"onStoreFilter"},t.displayValueRenderer&&((n||(n={})).change="onComboStoreChange"),t.detachListeners("store"),i!=null&&i.storage&&t.valueCollection.match(i.storage),t.syncInputFieldValue(),n&&(n.name="store",n.thisObj=t,i.ion(n))}get remoteFilter(){var i;return!!(this.filterParamName||(i=this._store)!=null&&i.restfulFilter)}get record(){return this.selected}get records(){return this.valueCollection.values.slice()}get selected(){const{store:i}=this;return this.multiSelect?this.valueCollection.values.slice().sort((e,t)=>i.indexOf(e)-i.indexOf(t))[0]:this.valueCollection.first}onEditComplete(){const i=this,e=i.valueCollection.count;super.onEditComplete(),e&&(i.clearError(Ci),i.syncInputFieldValue()),i.required&&!e&&i.setError(Yo)}onTriggerClick(i){var e;const t=this,r="key"in i;if(!(t.ignoreTriggerClick||t.remoteFilter&&t.filterOnEnter)){if(t.pickerVisible)t.hidePicker();else if(!t.readOnly&&!t.disabled)switch((e=t.triggerAction)==null?void 0:e.toLowerCase()){case"all":t.doFilter(null,r);break;case"last":t.doFilter(t.lastQuery,r);break;default:t.doFilter(t.input.value,r)}}}internalOnInput(i){const e=this;e.syncEmpty(),e.syncInputWidth(),e.filterOnInput(i),e.trigger("input",{value:e.input.value,event:i})}filterOnInput(i){const e=this,{value:t}=i.type==="input"?i.target:e.input,r=t.length;e.inputting=!0,e.inlinePicker||r>=e.minChars&&(!e.filterOnEnter||i.key==="Enter")?e.doFilter(t):(e.validateFilter&&!e.remoteFilter&&e[r?"setError":"clearError"](Ci),e.hidePicker()),e.inputting=!1}syncInputWidth(){const i=this;if(i.usesChipView){const e=i.input,t=i._inputPadding||(i._inputPadding=D.getEdgeSize(e,"padding","lr")),r=e.value||"",n=D.measureText(r+"W",e,!1,i.element)+t.width;e.style.flex=`1 1 ${Math.ceil(n)}px`}}doFilter(i,e){var t;const r=this,{store:n,picker:s}=r,a=i==null||i==="";r.lastQuery=i,r.primaryFilter.setConfig({value:i,disabled:a}),r.remoteFilter&&n.clear(!0);const l=()=>{const{navigator:o,isVisible:u}=s;n.count?!a&&o&&(o.activeItem=0):!r.remoteFilter&&!a&&(o&&(o.activeItem=null),r.validateFilter&&r.setError(Ci)),u&&s.realign()};(t=r.filterPromise=n.filter())==null||t.then(()=>{r.filterPromise=null,l()}),r.inlinePicker||(s!=null&&s.isVisible?s.lastAlignSpec.zone===0&&s.realign():r.showPicker(e)),r.filterPromise||l()}onStoreFilter({source:i}){const e=this,t=e._picker,r=t==null?void 0:t.element.dataset,{count:n}=i;e.remoteFilter&&(n?t&&(t.navigator.activeItem=0):e.validateFilter&&e.setError(Ci),e.filterSelected&&e.valueCollection.count&&(i.storage.onFiltersChanged({action:"splice",oldCount:1}),t&&t.refresh())),r&&(e.createOnUnmatched&&!n&&e.primaryFilter.value!=null?r.addNewValue=e.L("L{addNewValue}")(e.primaryFilter.value):r==null||delete r.addNewValue)}onValueCollectionChange({source:i}){var e,t,r,n;const s=this,{multiSelect:a,_picker:l}=s,o=(e=s.hidePickerOnSelect)!=null?e:!a,u=a?i.values.slice():i.first,c=i.values.slice(),d=s._isUserAction||(l==null?void 0:l._isUserAction)||o&&s.pickerVisible||!1,h=s._value;if(o&&s.hidePicker(),!i.count&&s.required?s.setError(Yo):(s.clearError(Yo),s.clearError(Ci)),s.validateFilter&&u&&s.clearError(Ci),s.filterSelected){const f=l==null?void 0:l.navigator,m=Number((r=(t=f==null?void 0:f.activeItem)==null?void 0:t.dataset)==null?void 0:r.index);s.remoteFilter?(s.store.storage.onFiltersChanged({action:"splice",oldCount:1}),s._picker&&s._picker.refresh()):s.store.filter(),isNaN(m)||(f.activeItem=Math.min(l.store.count,m))}s._value=null,s._lastValue=null;const g=s.cacheCurrentValue(s.value);s.syncInputFieldValue(),s.syncEmpty(),s.isConfiguring||(s.triggerFieldChange({value:g,oldValue:h,userAction:d,valid:s.isValid}),(n=s.trigger)==null||n.call(s,"select",{record:u,records:c,userAction:d}),s.defaultAction==="select"&&s.trigger("action",{value:g,record:u,records:c,userAction:d}))}cacheCurrentValue(i){return this._value=i}onValueCollectionNoChange({toAdd:i}){!this.inlinePicker&&!this.multiSelect&&i.length&&this.pickerVisible&&(this.picker.hide(),this.syncInputFieldValue())}showPicker(){var i;const e=this,{picker:t}=e;e.readOnly||e.inlinePicker||(t.multiSelect=e.multiSelect,super.showPicker(...arguments),e.overlayAnchor&&!t.align.offset&&(t.align.offset=-t.anchorSize[1],t.realign()),t.restoreActiveItem&&(e.multiSelect?t.restoreActiveItem(((i=t.navigator)==null?void 0:i.previousActiveItem)||e.selected||0,!0):t.restoreActiveItem(e.selected||0,!0)),e.input.focus())}changePicker(i,e){if(i){const t=this,r=t.pickerWidth||(i==null?void 0:i.width),n=yt.mergeConfigs({owner:t,store:t.store,selected:t.valueCollection,multiSelect:t.multiSelect,cls:t.listCls,displayField:t.displayField,forElement:t[t.pickerAlignElement],align:{matchSize:r==null,anchor:t.overlayAnchor,target:t[t.pickerAlignElement],minHeight:t.inlinePicker?null:Math.min(3,t.store.count)*40},[t.listItemTpl?"itemTpl":void 0]:t.listItemTpl,width:r,navigator:{keyEventTarget:t.input}},i);t.inlinePicker&&Object.assign(n,{floating:!1,align:null,activateOnMouseover:!1,maxHeight:null,appendTo:t.element}),i=yt.reconfigure(e,i?n:null,t),i.element.classList.add("b-combo-picker"),i.element.dataset.emptyText=t.emptyText?t.L(t.emptyText):t.L("L{noResults}"),i.ion({navigate:"onPickerNavigate",thisObj:t}),$.on({element:i.element,pointerdown:s=>t.onPickerNavigate({event:s}),thisObj:t})}else e==null||e.destroy();return i}onPickerNavigate({event:i}){i.target.matches("[data-add-new-value]")&&this.addNewRecord(this.primaryFilter.value)}onPickerHide(){const i=this;super.onPickerHide(),i.multiSelect&&i.clearTextOnPickerHide&&(i.input.value="")}async internalOnKeyEvent(i){var e;const t=this,r=t.input[t.inputValueAttr],n=r.length,{key:s}=i,{primaryFilter:a,store:l,_picker:o,multiSelect:u}=t;if(i.type==="keydown"&&(o!=null&&o.isVisible)&&o.navigator){const{activeItem:c}=o.navigator;if(c&&u&&s===t.multiValueSeparator){t.input.value="",a.setConfig({value:"",disabled:!0}),l.filter(),o.onItemClick(c,i),o.hide(),i.preventDefault();return}if(!c&&t.createOnUnmatched&&(u&&s===t.multiValueSeparator||s==="Enter")){i.preventDefault(),await t.addNewRecord(r);return}}!t.editable&&t.pickerVisible&&(s==="Backspace"&&((e=a.value)!=null&&e.length)?(a.value=a.value.substring(0,a.value.length-1),t.store.filter(),o.restoreActiveItem(0)):i.type=="keypress"&&s.match(CC)&&((!t.lastFilterKepressTime||i.timeStamp-t.lastFilterKepressTime>2e3)&&(a.value=""),a.setConfig({value:(a.value||"")+s,disabled:!1}),t.store.filter(),o.restoreActiveItem(0)),t.lastFilterKepressTime=i.timeStamp),super.internalOnKeyEvent(...arguments),i.type==="keydown"&&s==="Enter"&&t.filterOnEnter&&n>=t.minChars&&(i.stopPropagation(),t.filterOnInput.now(i))}async addNewRecord(i){var e,t;const r=this,{store:n,_picker:s,valueCollection:a,multiSelect:l,primaryFilter:o}=r,u=n.remoteFilter&&n.autoCommit;r.filterPromise&&await r.filterPromise,u||(o.setConfig({value:"",disabled:!0}),n.filter());const[c]=n.add(r.callback(r.createOnUnmatched,r,[i,r]));if(n.isCommitting){let d;try{await n.commitPromise}catch(h){d=(t=(e=h.response)==null?void 0:e.parsedJson)==null?void 0:t.error}c.isPhantom&&(r.clearError(),r.setError(d||bC,!1,!0),n.remove(c),n.removed.remove(c))}u&&(o.setConfig({value:"",disabled:!0}),n.filter()),r.input.value="",n.includes(c)&&a.splice(l?a.count:0,l?0:a.count,c),s==null||s.hide()}changeCreateOnUnmatched(i){return i===!0&&(i=this.defaultRecordCreater),i}defaultRecordCreater(i){return this.store.createRecord({[this.displayField]:i})}updateLocalization(){var i;super.updateLocalization();const e=this,{displayField:t}=e;let{localizedDisplayFieldsMap:r}=e;if(e.localizeDisplayFields===!0){r||(e.localizedDisplayFieldsMap=r=new Map),!e.store&&e.buildItems&&(e.items=e.buildItems());for(const n of e.items)if(n.id){let s=r.get(n.id);!s&&((i=n[t])!=null&&i.startsWith("L{"))&&(s=n[t],r.set(n.id,s)),s&&(n[t]=e.L(s))}e.syncInputFieldValue()}}};y(ze,"$name","Combo"),y(ze,"type","combo"),y(ze,"alias","combobox,dropdown"),y(ze,"delayable",{filterOnInput:0});var Ff=class extends bi{static get $name(){return"ComboChipView"}static get type(){return"combochipview"}static get defaultConfig(){return{closeHandler:"up.onChipClose",itemsFocusable:!1,multiSelect:!0,itemTpl(i){return P.encodeHtml(i.getValue(this.owner.displayField))},scrollable:{overflowY:"auto"}}}},SC=class extends pi{static get $name(){return"ComboChipNavigator"}static get type(){return"combochipnavigator"}static get configurable(){return{allowShiftKey:!0}}onTargetClick(i){const e=this,t=i.target.closest(e.itemSelector);t&&!i.target.classList.contains("b-close-icon")&&(!i.shiftKey&&!t.contains(i.target.closest("[data-noselect]"))&&e.ownerCmp.selected.clear(),e.inClickHandler=!0,e.activeItem=t,e.inClickHandler=!1)}onKeyDown(i){i.key!=="Enter"&&!i.target.selectionStart&&!i.target.selectionEnd&&super.onKeyDown(i)}updateActiveItem(i,e){const t=this.ownerCmp;super.updateActiveItem(i,e),i&&!this.inClickHandler&&t.selected.add(t.getRecordFromElement(i))}navigatePrevious(i){const e=this.ownerCmp;e.navigator.activeItem&&!i.shiftKey&&e.selected.clear(),this.previous?super.navigatePrevious(i):this.activeItem=null}navigateNext(i){const e=this.ownerCmp;e.navigator.activeItem&&!i.shiftKey&&e.selected.clear(),this.next?super.navigateNext(i):this.activeItem=null}};ze.initClass(),Ff.initClass(),SC.initClass(),ze._$name="Combo";var Si=class extends Be{static get configurable(){return{project:null,stm:null,text:null,color:null,showZeroActionBadge:null,cls:"b-undo-controls b-toolbar",layoutStyle:{alignItems:"stretch",flexFlow:"row nowrap",overflow:"visible"},items:{undoBtn:{type:"button",icon:"b-icon-undo",tooltip:"L{UndoRedo.UndoLastAction}",onAction:"up.onUndo"},transactionsCombo:{type:"combo",valueField:"idx",editable:!1,store:{},emptyText:"L{UndoRedo.NoActions}",onAction:"up.onTransactionSelected",displayValueRenderer:"up.transactionsDisplayValueRenderer"},redoBtn:{type:"button",icon:"b-icon-redo",tooltip:"L{UndoRedo.RedoLastAction}",onAction:"up.onRedo"}},overflowable:!0}}afterConstruct(){this.updateUndoRedoControls()}updateStm(i){this.detachListeners("undoredo"),i==null||i.ion({name:"undoredo",recordingstop:"updateUndoRedoControls",restoringstop:"updateUndoRedoControls",queueReset:"updateUndoRedoControls",disabled:"updateUndoRedoControls",thisObj:this})}changeItems(i){const{undoBtn:e,redoBtn:t}=i;return this.color&&(e&&(e.color=this.color),t&&(t.color=this.color)),this.text&&(e&&(e.text="L{UndoRedo.Undo}"),t&&(t.text="L{UndoRedo.Redo}")),super.changeItems(i)}updateProject(i){this.stm=i.stm}fillUndoRedoCombo(){const{transactionsCombo:i}=this.widgetMap;i&&(i.items=[[0,"Original data"],...this.stm.queue.map((e,t)=>[t+1,e||`Transaction ${t+1}`])])}updateUndoRedoControls(){const{stm:i,showZeroActionBadge:e}=this,{undoBtn:t,redoBtn:r,transactionsCombo:n}=this.widgetMap;t.badge=i.position||(e?"0":""),r.badge=i.length-i.position||(e?"0":""),t.disabled=!i.canUndo,r.disabled=!i.canRedo,this.fillUndoRedoCombo(),n&&(n.disabled=n.store.count<=1)}transactionsDisplayValueRenderer(i,e){var t;const r=((t=this.stm)==null?void 0:t.position)||0;return`${r} undo actions / ${e.store.count-r-1} redo actions`}onUndo(){this.stm.canUndo&&this.stm.undo()}onRedo(){this.stm.canRedo&&this.stm.redo()}onTransactionSelected(i){const{stm:e}=this,t=e.position-i.value;t>0?e.canUndo&&e.undo(t):t<0&&e.canRedo&&e.redo(-t)}};y(Si,"$name","UndoRedoBase"),y(Si,"type","undoredobase"),Si.initClass(),Si._$name="UndoRedoBase";var rs=class extends ze{static get configurable(){return{positiveValue:!0,positiveText:null,negativeValue:!1,negativeText:null,store:{value:[],$config:"lazy"},value:!1}}changeStore(i,e){const t=this;return super.changeStore(new re({data:[{id:t.positiveValue,text:t.positiveText||t.L("L{Object.Yes}")},{id:t.negativeValue,text:t.negativeText||t.L("L{Object.No}")}]}),e)}};y(rs,"$name","BooleanCombo"),y(rs,"type","booleancombo"),rs.initClass(),rs._$name="BooleanCombo";var La=class wm extends Be.mixin(Ca){onChildAdd(e){super.onChildAdd(e),e.ion({click:"resetValueCache",toggle:"onItemToggle",thisObj:this,prio:1e4})}onChildRemove(e){e.un({toggle:"resetValueCache",click:"resetValueCache",thisObj:this}),super.onChildRemove(e)}onItemToggle(e){const t=this;t.resetValueCache(),!t.isSettingValue&&(!t.toggleGroup||e.pressed)&&t.triggerFieldChange({value:t.value,userAction:!0,event:e})}resetValueCache(){this._value=null}createWidget(e){const t=this;return t.constructor.resolveType(e.type||"button").isButton&&(t.color&&!e.color&&(e.color=t.color),t.toggleGroup&&!e.toggleGroup&&(typeof t.toggleGroup=="boolean"&&(t.toggleGroup=wm.generateId("toggleGroup")),e.toggleGroup=t.toggleGroup)),t.columns&&(e.width=`${100/t.columns}%`),e=super.createWidget(e),t.relayEvents(e,["click","action","toggle"]),e}updateRotate(e){this.eachWidget(t=>{t.rotate!==!1&&(t.rotate=e)})}get value(){if(!this._value){const e=[];this.items.forEach(t=>{t.pressed&&t.value!==void 0&&e.push(t.value)}),this._value=e.join(this.valueSeparator)}return this._value}set value(e){const t=this,r=t.value;Array.isArray(e)||(e==null?e=[]:typeof e=="string"?e=e.split(t.valueSeparator):e=[e]),t._value=e.join(t.valueSeparator),t.isSettingValue=!0,t.items.forEach(n=>{n.value!==void 0&&(n.pressed=e.includes(n.value))}),t.isSettingValue=!1,!t.isConfiguring&&r!==t.value&&t.triggerFieldChange({value:t.value,userAction:!1})}updateDisabled(e){this.items.forEach(t=>t.disabled=e||!t.ignoreParentReadOnly&&this.readOnly)}updateReadOnly(e){super.updateReadOnly(e),this.updateDisabled(this.disabled)}get widgetClassList(){const e=super.widgetClassList;return this.columns&&e.push("b-columned"),e}};y(La,"$name","ButtonGroup"),y(La,"type","buttongroup"),y(La,"configurable",{defaultType:"button",cls:null,items:null,color:null,toggleGroup:null,valueSeparator:",",columns:null,hideWhenEmpty:!0,defaultBindProperty:"value"});var Uo=La;Uo.initClass(),Uo._$name="ButtonGroup";var tr=class extends pt{static get configurable(){return{layout:"vbox",textContent:!1,date:{$config:{equal:"date"},value:null},month:{},year:null,weekStartDay:null,sixWeeks:!0,showWeekNumber:null,showWeekColumn:null,disabledDates:null,headerRenderer:null,weekRenderer:null,cellRenderer:null,disableWeekends:null,hideNonWorkingDays:null,hideNonWorkingDaysCls:"b-hide-nonworking-days",nonWorkingDays:null,tip:null,dayCellCls:"b-calendar-cell",dayHeaderCls:"b-calendar-day-header",disabledCls:"b-disabled-date",otherMonthCls:"b-other-month",weekendCls:"b-weekend",todayCls:"b-today",nonWorkingDayCls:"b-nonworking-day",dayNameFormat:"ddd",minRowHeight:{$config:["lazy"],value:null},minColumnWidth:{$config:["lazy"],value:null},disableOtherMonthCells:null,disableOtherMonthCellsCls:"b-disable-othermonth-cells",hideOtherMonthCells:null,hideOtherMonthCellsCls:"b-hide-othermonth-cells",animateTimeShift:!0}}construct(i){super.construct(i),this.refreshCount||this.refresh()}onInternalPaint({firstPaint:i}){var e;(e=super.onInternalPaint)==null||e.call(this,...arguments),i&&(this.refreshCount||this.refresh(),this.getConfig("minColumnWidth"),this.getConfig("minRowHeight"))}get overflowElement(){return this.weeksElement}doDestroy(){var i;(i=this.tip)==null||i.destroy(),super.doDestroy()}updateMinRowHeight(i){this.element.style.setProperty("--min-row-height",D.setLength(i)),this.scrollable={overflowY:i?"auto":!1}}updateMinColumnWidth(i){const e=this;e.element.style.setProperty("--min-column-width",D.setLength(i)),e.scrollable={overflowX:i?"auto":!1},e.overflowElement.classList[i?"add":"remove"]("b-min-columnwidth")}getDateFromDomEvent(i){const e=(i.nodeType===Element.ELEMENT_NODE?i:i.target).closest(`#${this.id} [data-date]`);if(e)return k.parseKey(e.dataset.date)}changeTip(i,e){const t=this;return je.reconfigure(e,i,{owner:t,defaults:{type:"tooltip",owner:t,id:`${t.id}-cell-tip`,forElement:t.bodyElement,forSelector:`.${t.dayCellCls}`}})}updateTip(i){this.detachListeners("tip"),i==null||i.ion({pointerOver:"onTipOverCell",name:"tip",thisObj:this})}updateElement(i,e){const t=this;super.updateElement(i,e),t.updateHideNonWorkingDays(t.hideNonWorkingDays),t.weekdayCells=Array.from(i.querySelectorAll(".b-calendar-day-header")),t.weekElements=Array.from(i.querySelectorAll(".b-calendar-week")),t.weekDayElements=Array.from(i.querySelectorAll(".b-calendar-days")),t.cellElements=[];for(let r=0,{length:n}=t.weekDayElements;r<n;r++)t.cellElements.push(t.weekDayElements[r].previousSibling,...t.weekDayElements[r].children)}changeDate(i){if(i=typeof i=="string"?k.parse(i):new Date(i),isNaN(i))throw new Error("CalendarPanel date ingestion must be passed a Date, or a YYYY-MM-DD date string");return k.clearTime(i)}updateDate(i){this.month.date=i}updateDayNameFormat(){const i=new Date("2000-06-04T12:00:00");this.shortDayNames=[];for(let e=4;e<11;e++)i.setDate(e),this.shortDayNames.push(k.format(i,this.dayNameFormat))}get weekStartDay(){return typeof this._weekStartDay=="number"?this._weekStartDay:k.weekStartDay}updateWeekStartDay(i){const e=this;if(e._month){e.month.weekStartDay=i,e.dayNames=[];for(let t=0;t<7;t++)e.dayNames[t]=e.shortDayNames[e.canonicalDayNumbers[t]];e.refreshCount&&e.refresh()}}updateHideNonWorkingDays(i){var e;this.contentElement.classList.toggle(this.hideNonWorkingDaysCls,!!i),(e=this.scrollable)==null||e.syncOverflowState(),this._month&&(this.month.hideNonWorkingDays=i),this.isConfiguring||this.refresh()}updateHideOtherMonthCells(i){var e;this.element.classList.toggle(this.hideOtherMonthCellsCls,!!i),(e=this.scrollable)==null||e.syncOverflowState()}updateDisableOtherMonthCells(i){var e;this.element.classList.toggle(this.disableOtherMonthCellsCls,!!i),(e=this.scrollable)==null||e.syncOverflowState()}get nonWorkingDays(){return this._nonWorkingDays||this._localeNonWorkingDays||(this._localeNonWorkingDays=k.nonWorkingDays)}get weekends(){return this._localeWeekends||(this._localeWeekends=k.weekends)}changeNonWorkingDays(i){return x.assign({},i)}updateNonWorkingDays(i){var e;this._month&&(this.month.nonWorkingDays=i,this.refresh(),(e=this.scrollable)==null||e.syncOverflowState())}get visibleDayColumnIndex(){return this.month.visibleDayColumnIndex}get dayColumnIndex(){return this.month.dayColumnIndex}get canonicalDayNumbers(){return this.month.canonicalDayNumbers}get visibleColumnCount(){return this.month.visibleColumnCount}get weekLength(){return this.month.weekLength}get startDate(){return this.month.startDate}get duration(){return k.diff(this.month.startDate,this.month.endDate,"day")+1}get endDate(){const{endDate:i}=this.month;if(i)return k.add(i,1,"day")}changeMonth(i,e){const t=this;if(!(i instanceof Jn)){if(typeof i=="number"){if(e){e.month=i;return}const r=t.date||k.clearTime(new Date);r.setMonth(i),i={date:r}}i=Jn.new({weekStartDay:t.weekStartDay,nonWorkingDays:t.nonWorkingDays,hideNonWorkingDays:t.hideNonWorkingDays,sixWeeks:t.sixWeeks},i)}return i.ion({dateChange:"onMonthDateChange",thisObj:t}),i}onMonthDateChange({source:i,newDate:e,oldDate:t,changes:r}){const n=this;if(n.year=i.year,!n.isConfiguring){if(!n.getCell(e)||r.m||r.y){const{isVisible:s}=n;n.refresh(),n.animateTimeShift&&s&&D.slideIn(n.contentElement,e>t?1:-1)}n.trigger("dateChange",{changes:r,value:e,oldValue:t})}}updateYear(i){this.month.year=i}updateShowWeekNumber(i){this.updateShowWeekColumn(i)}updateShowWeekColumn(i){const e=this;e.element.classList[i?"add":"remove"]("b-show-week-column"),e.floating&&(e.isAligning||e.realign())}updateSixWeeks(i){this.month&&(this.month.sixWeeks=i,this.refresh())}refresh(){this.doRefresh()}doRefresh(){var i;this.getConfig("element");const e=this,t=e.timeZone!=null?e.timeZone:(i=e.project)==null?void 0:i.timeZone,r=t!=null?Ve.toTimeZone(new Date,t):new Date,{weekElements:n,weekDayElements:s,date:a,month:l,dayCellCls:o,dayHeaderCls:u,disabledCls:c,otherMonthCls:d,weekendCls:h,todayCls:g,nonWorkingDayCls:f,nonWorkingDays:m,canonicalDayNumbers:p,sixWeeks:v}=e;if(r.setHours(0,0,0,0),!a){e.date=r;return}e.element.style.setProperty("--visible-week-count",l.weekCount),e.trigger("beforeRefresh"),e.getConfig("dayNameFormat");for(let C=0;C<7;C++){const T=e.weekdayCells[C],E=e.canonicalDayNumbers[C],I={[u]:1,[h]:k.weekends[E],[f]:m[E]};e.headerRenderer?(T.innerHTML="",e.callback(e.headerRenderer,e,[T,C,E])):D.setInnerText(T,e.shortDayNames[E]),D.syncClassList(T,I),T.dataset.columnIndex=C,T.dataset.cellDay=E}let b=0,w=0,S=6;for(let C=6;C>=0;C--)if(!m[p[C]]){S=C;break}n[4].classList.toggle("b-hide-display",l.weekCount<5&&!v),n[5].classList.toggle("b-hide-display",l.weekCount<6&&!v),l.eachWeek((C,T)=>{const E=s[b],I=[E.previousSibling,...E.children];n[b].dataset.week=`${C[0]},${C[1]}`,e.weekRenderer?e.callback(e.weekRenderer,e,[I[0],C]):I[0].innerText=C[1];for(let R=0;R<7;R++){const M=T[R],O=M.getDay(),A=k.makeKey(M),B=m[O],L=I[R+1],Y={[o]:1,[c]:e.isDisabledDate(M),[d]:M.getMonth()!==l.month,[h]:k.weekends[O],[g]:M.getTime()===r.getTime(),[f]:B,"b-last-working-day":R===S,"b-first-visible-cell":!(M-(e.firstVisibleDate||-1)),"b-last-visible-cell":!(M-(e.lastVisibleDate||-1)),[`b-day-of-week-${O}`]:1};D.syncClassList(L,Y),L.dataset.date=A,L.dataset.cellIndex=w,L.dataset.columnIndex=R,L.lastDomConfig&&(delete L.lastDomConfig.class,delete L.lastDomConfig.className),e.cellRenderer?e.callback(e.cellRenderer,e,[{cell:L,date:M,day:O,row:n[b],rowIndex:b,cellIndex:w,columnIndex:R,visibleColumnIndex:e.visibleDayColumnIndex[O],week:C,key:A}]):L.innerHTML=M.getDate(),w++}b++}),e.visibleWeekCount=b,e.floating&&(e.isAligning||e.realign()),e.refreshCount=(e.refreshCount||0)+1,e.trigger("refresh")}isDisabledDate(i){const e=i.getDay(),{disabledDates:t,nonWorkingDays:r}=this;if(this.disableWeekends&&r[e])return!0;if(t)return Array.isArray(t)?(i=k.clearTime(i,!0),t.some(n=>!(k.clearTime(n,!0)-i))):this.callback(this.disabledDates,this,[i])}get bodyConfig(){const i=super.bodyConfig,e=[];i.children=[{tag:"div",className:"b-calendar-row b-calendar-weekdays",reference:"weekdaysHeader",children:[{class:"b-week-number-cell"},...z.fill(7,{class:this.dayHeaderCls}),D.scrollBarPadElement]},{className:"b-weeks-container notranslate",reference:"weeksElement",children:e}];for(let t=0;t<6;t++){const r={className:"b-calendar-row b-calendar-week",dataset:{rowIndex:t},children:[{className:"b-week-number-cell"},{className:"b-calendar-days",children:[{},{},{},{},{},{},{}],syncOptions:{ignoreRefs:!0,strict:!1}}]};e.push(r)}return i}get firstVisibleDate(){if(this.hideOtherMonthCells){const{year:i,month:e}=this.month;return new Date(i,e,1)}for(const i=this,e=i.month.startDate;;e.setDate(e.getDate()+1))if(!i.hideNonWorkingDays||!i.nonWorkingDays[e.getDay()])return e}get lastVisibleDate(){const i=k.add(this.endDate,-1,"d");if(this.hideOtherMonthCells)return i;for(const e=this,t=i;;t.setDate(t.getDate()-1))if(!e.hideNonWorkingDays||!e.nonWorkingDays[t.getDay()])return t}getCell(i,e){typeof i!="string"&&(i=k.makeKey(i));const t=this.weeksElement.querySelector(`[data-date="${i}"]`);if(t&&(!e||!t.classList.contains(this.otherMonthCls)))return t}onTipOverCell({source:i,target:e}){i.date=k.parseKey(e.dataset.date)}updateLocalization(){this._localeNonWorkingDays=this._localeWeekends=null,this.updateDayNameFormat(),this.updateWeekStartDay(this.weekStartDay),super.updateLocalization()}};y(tr,"$name","CalendarPanel"),y(tr,"type","calendarpanel"),tr.initClass(),tr._$name="CalendarPanel";var wC=i=>!i.value,rr=class extends De{static get configurable(){return{inputType:"checkbox",autoCollapse:null,containerDefaults:{syncableConfigs:{disabled:i=>i.disabled||!i.value},syncConfigTriggers:{autoCollapse:1,value:1}},text:"",checkedValue:!0,uncheckedValue:!1,color:null,value:"",toggleGroup:null,localizableProperties:["label","text"]}}construct(i){"checked"in i&&(i=x.assign({},i),i.value=i.checked,delete i.checked),super.construct(i),this.syncHasText()}get textLabelCls(){return"b-checkbox-label"}get innerElements(){return[this.inputElement,{tag:"label",class:this.textLabelCls,for:`${this.id}-input`,reference:"textLabel",html:this.text||""}]}get inputElement(){const i=super.inputElement;return this.toggleGroup&&(i.dataset={group:this.toggleGroup}),i.listeners={click:"internalOnClick",change:"internalOnChange",input:"internalOnInput"},i}get checked(){return this.value}set checked(i){this.value=i}syncHasText(){this.element.classList[this.text?"add":"remove"]("b-text")}updateText(i){this.textLabel&&(this.syncHasText(),this.textLabel.innerHTML=i)}afterSyncChildConfigs(i){super.afterSyncChildConfigs(i);let{autoCollapse:e}=this;e&&(e=e===!0?wC:e,i.collapsed=e(this))}assignFieldValue(i,e,t){this.value=t===this.checkedValue||(t===this.uncheckedValue?!1:null)}fetchInputValue(){this.readOnly||(this.value=this.input.checked)}gatherValue(i){var e;const t=this,r=t.value?t.checkedValue:t.uncheckedValue,n=r!==void 0,{valueName:s}=t;n&&(i[s]=r),t.gatherValues(i,n),r===!0&&((e=i[s])==null?void 0:e.value)===r&&delete i[s].value}changeValue(i){return i==="false"?!1:!!i}updateValue(i){var e;const t=this,r=t.input.checked!==i;t.input.checked=i,(e=t.container)==null||e.syncChildConfigs(),r&&!t.inputting&&!t.isConfiguring&&(t.uncheckToggleGroupMembers(),t.triggerChange(!1,null))}get inputValueAttr(){return"checked"}updateColor(i,e){const t=this.element.classList;e&&t.remove(e),i&&t.add(i)}getToggleGroupMembers(){const i=this,{checked:e,toggleGroup:t,input:r,type:n}=i,s=[];return e&&t&&D.forEachSelector(i.rootElement,`input[type=${n}][data-group=${t}]`,a=>{if(a!==r){const l=j.fromElement(a);l&&s.push(l)}}),s}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach(i=>i.checked=!1)}check(){this.checked=!0}uncheck(){this.checked=!1}toggle(){this.checked=!this.checked}internalOnClick(i){return this.readOnly?(i.preventDefault(),!1):this.trigger("click",{event:i})}internalOnChange(i){const e=this;if(e.readOnly&&e.value!==e.input.checked){e.input.checked=e.value;return}e.value=e.input.checked,e.inputting||(e.inputting=!0,e.triggerChange(!0,i),e.inputting=!1)}updateInputReadOnly(i){}triggerChange(i,e){const t=this,{checked:r}=t.input,n={checked:r,value:r,oldValue:!r,userAction:i,valid:!0,event:e};if(!r&&i&&t.toggleGroup&&t.getToggleGroupMembers().filter(a=>a.isVisible&&!a.disabled).length||t.trigger("beforeChange",n)===!1)t.input.checked=t._value=!r;else return t.triggerFieldChange(n,!1),i&&t.uncheckToggleGroupMembers(),t.trigger("action",n),t.trigger("change",n),!0}};y(rr,"$name","Checkbox"),y(rr,"type","checkbox"),y(rr,"alias","check"),rr.initClass(),rr._$name="Checkbox";var Pr=class extends yt{configure(i){super.configure(i),this.setItems(),this.ion({item:"onColorSelect"})}setItems(){const i=this,{colors:e,colorClasses:t}=i;let r=t||e;i.addNoColorItem&&(r=[...r],r.push(null)),i.items=r.map(n=>!n||typeof n=="string"?{color:n,text:(t?P.capitalize(n):n)||i.L("L{noColor}")}:n)}afterConfigure(){var i;super.afterConfigure(...arguments),(this.addNoColorItem||this.value)&&this.select((i=this.value)!=null?i:null)}updateColors(){this.isConfiguring||this.setItems()}updateAddNoColorItem(){this.isConfiguring||this.setItems()}onColorSelect({record:i}){var e;this.refresh();const t={color:i.color,record:i,bubbles:!0};(e=this.colorSelected)==null||e.call(this,t),this.trigger("colorSelected",t)}select(i){(!i||typeof i=="string")&&(i=this.store.findRecord("color",i!=null?i:null)),i&&super.select(i)}updateColumns(i){this.style=`grid-template-columns:repeat(${i}, 1fr);`}getColorClassName(i){var e,t;return(e=this.colorClasses)!=null&&e.includes(i)||(t=this.colorClasses)!=null&&t.find(r=>r&&r.color===i)?this.colorClassPrefix+i:i?"":"b-no-color"}};y(Pr,"$name","ColorPicker"),y(Pr,"type","colorpicker"),y(Pr,"configurable",{itemsFocusable:!1,navigator:{focusCls:"b-color-active"},itemWrapperTpl(i,e){const{selected:t}=this,{color:r,text:n}=i,s=this.getColorClassName(r);return gi.tpl`
                    <li
                        class="${this.getItemClasses(i,e)} ${s}"
                        role="option"
                        aria-selected="${t.includes(i)}"
                        data-index="${e}"
                        data-id="${P.encodeHtml(r)}"
                        data-btip="${n}"
                        ${this.itemsFocusable?'tabindex="-1"':""}
                        style="${s?"":"background-color: "+r}"
                    ></li>`},colorClasses:null,colorClassPrefix:null,colors:["#45171D","#F03861","#FF847C","#FECEA8","#A5F2E7","#AA83F3","#8983F3","#A10054","#073059","#2866AB","#5FBDC5","#D8D95C","#FFDEDE","#F7F3CE","#C5ECBE","#3E3E3E","#405559","#68868C","#EDEDED","#D3D6DB","#3A4750","#303841","#BE3144"],addNoColorItem:!0,columns:6,colorSelected:null}),Pr.initClass(),Pr._$name="ColorPicker";var Fr=class extends ze{configure(i){var e;const t=(e=i.picker)!=null?e:{};i.colors&&(t.colors=i.colors),"addNoColorItem"in i&&(t.addNoColorItem=i.addNoColorItem),i.picker=t,super.configure(i)}updatePicker(i){i&&(this.items=i.store.records)}updateColors(i){this.isConfiguring||(this.picker.colors=i)}updateAddNoColorItem(i){this.isConfiguring||(this.picker.addNoColorItem=i)}set value(i){this.store||(this.items=[],this.store=this.picker.store),i||(i=this.store.findRecord("color",null)),super.value=i}showPicker(){this.picker.refresh(),super.showPicker(...arguments)}get value(){return super.value}syncInputFieldValue(...i){var e;const t=this,{value:r}=t;let n=(e=t.picker)==null?void 0:e.getColorClassName(r);n||(t.colorBox.style.color=r),n="b-colorbox "+n,t.colorBox.className=n,t.showBoxForNoColor||t.element.classList.toggle("b-colorless",!r),super.syncInputFieldValue(...i)}get innerElements(){return[{reference:"colorBox",className:"b-colorbox"},...super.innerElements]}};y(Fr,"$name","ColorField"),y(Fr,"type","colorfield"),y(Fr,"configurable",{displayField:"text",valueField:"color",editable:!1,picker:{type:"colorpicker",align:{align:"t100-b100",matchSize:!1}},showBoxForNoColor:!0,colors:null,addNoColorItem:!0}),Fr.initClass(),Fr._$name="ColorField";var ir=class extends pt{construct(i){super.construct({year:new Date().getFullYear(),...i}),$.on({element:this.contentElement,click:"onYearClick",delegate:".b-yearpicker-year",thisObj:this})}get focusElement(){return this.getYearButton(this.year)||this.getYearButton(this.startYear)}getYearButton(i){return this.contentElement.querySelector(`.b-yearpicker-year[data-year="${i}"]`)}get value(){return this.year}set value(i){this.year=i}onYearClick({target:i}){const e=Math.min(Math.max(parseInt(i.innerText),this.minYear||1),this.maxYear||9999);this.year===e?this.trigger("select",{oldValue:e,value:e}):this.year=e}handleTitleClick(i){this.trigger("titleClick",i)}previous(){this.startYear=this.startYear-this.yearButtonCount}next(){this.startYear=this.endYear+1}ingestYear(i){if(!isNaN(i))return x.isDate(i)?i.getFullYear():i}changeYear(i){if(i=this.ingestYear(i))return Math.min(Math.max(i,this.minYear||1),this.maxYear||9999)}updateYear(i,e){const t=this;!t.startYear||i>t.endYear?t.startYear=i:i<t.startYear&&(t.startYear=i-(t.yearButtonCount-1)),t.isConfiguring||t.trigger("select",{oldValue:e,value:i})}get endYear(){return this.startYear+this.yearButtonCount-1}changeStartYear(i){if(i=this.ingestYear(i))return i=this.minYear?Math.max(i,this.minYear):i,this.maxYear?Math.min(i,this.maxYear-(this.yearButtonCount-1)):i}async updateStartYear(i,e){this.isVisible&&D.slideIn(this.contentElement,Math.sign(i-e))}composeBody(){this.getConfig("year");const{startYear:i}=this,e=super.composeBody(),t=e.children[this.tbar?1:0].children=[];this.widgetMap.title.text=`${`000${i}`.slice(-4)} - ${`000${this.endYear}`.slice(-4)}`;for(let r=0,n=i;r<this.yearButtonCount;r++,n++)t.push({tag:"button",dataset:{year:n},class:{"b-yearpicker-year":1,"b-selected":n===this.year},text:`000${n}`.slice(-4)});return e}};y(ir,"$name","YearPicker"),y(ir,"type","yearpicker"),y(ir,"configurable",{textContent:!1,tbar:{overflow:null,items:{previous:{type:"tool",cls:"b-icon b-icon-previous",onAction:"up.previous",weight:100},title:{type:"button",cls:"b-yearpicker-title",weight:200,onAction:"up.handleTitleClick"},next:{type:"tool",cls:"b-icon b-icon-next",onAction:"up.next",weight:300}}},itemCls:"b-year-container",yearButtonCount:12,year:null,minYear:null,maxYear:null,startYear:null}),ir.initClass(),ir._$name="YearPicker";var wi=class extends vt{static get configurable(){return{readOnly:!0,editable:!1,cls:"b-display-field",template:null,ariaElement:"displayElement"}}get focusElement(){}changeReadOnly(){return!0}changeEditable(){return!1}get inputElement(){return{tag:"span",id:`${this.id}-input`,reference:"displayElement",html:this.template?this.template(this.value):P.encodeHtml(this.value)}}};y(wi,"$name","DisplayField"),y(wi,"type","displayfield"),y(wi,"alias","display"),wi.initClass(),wi._$name="DisplayField";var Lf=()=>k.getMonthNames().map((i,e)=>[e,i]),$f=(i,e)=>i.valueOf()-e.valueOf(),DC=Object.freeze([]),TC=class extends ze{static get $name(){return"ReadOnlyCombo"}static get type(){return"readonlycombo"}static get configurable(){return{editable:!1,inputAttributes:{tag:"div",tabIndex:-1},inputValueAttr:"innerHTML",highlightExternalChange:!1,monitorResize:!1,triggers:{expand:!1},picker:{align:{align:"t-b",axisLock:!0,matchSize:!1},cls:"b-readonly-combo-list",scrollable:{overflowX:!1}}}}};TC.initClass();var Di=class extends tr{static get delayable(){return{refresh:"raf"}}static get configurable(){return{activeDate:{value:new Date,$config:{equal:"date"}},focusable:!0,textContent:!1,tbar:{overflow:null,items:{prevYear:{cls:"b-icon b-icon-first",onAction:"up.gotoPrevYear",tooltip:"L{DatePicker.gotoPrevYear}"},prevMonth:{cls:"b-icon b-icon-previous",onAction:"up.gotoPrevMonth",tooltip:"L{DatePicker.gotoPrevMonth}"},fields:{type:"container",cls:"b-datepicker-title",items:{monthField:{type:"readonlycombo",cls:"b-datepicker-monthfield",items:Lf(),internalListeners:{select:"up.onMonthPicked"}},yearButton:{type:"button",cls:"b-datepicker-yearbutton",internalListeners:{click:"up.onYearPickerRequested"}}}},nextMonth:{cls:"b-icon b-icon-next",onAction:"up.gotoNextMonth",tooltip:"L{DatePicker.gotoNextMonth}"},nextYear:{cls:"b-icon b-icon-last",onAction:"up.gotoNextYear",tooltip:"L{DatePicker.gotoNextYear}"}}},yearPicker:{value:{type:"YearPicker",yearButtonCount:16,trapFocus:!0,positioned:!0,hidden:!0,internalListeners:{titleClick:"up.onYearPickerTitleClick",select:"up.onYearPicked"}},$config:"lazy"},date:null,minDate:{value:null,$config:{equal:"date"}},maxDate:{value:null,$config:{equal:"date"}},focusDisabledDates:null,multiSelect:!1,selection:{$config:{equal:(i,e)=>i&&i.equals(e)},value:null},editMonth:!0,dayNameFormat:"dd",trapFocus:!0,role:"grid",focusDescendant:!0,alwaysRefreshOnMonthChange:null}}static get prototypeProperties(){return{outOfRangeCls:"b-out-of-range",activeCls:"b-active-date",selectedCls:"b-selected-date"}}construct(i){const e=this;super.construct(i),e.externalCellRenderer=e.cellRenderer,e.cellRenderer=e.internalCellRenderer,e.element.setAttribute("aria-activedescendant",`${e.id}-active-day`),e.weeksElement.setAttribute("role","grid"),e.weekElements.forEach(t=>t.setAttribute("role","row")),e.element.setAttribute("ariaLabelledBy",e.widgetMap.fields.id),$.on({element:e.weeksElement,click:{handler:"onCellClick",delegate:`.${e.dayCellCls}:not(.${e.disabledCls}):not(.${e.outOfRangeCls})`},mousedown:{handler:"onCellMousedown",delegate:`.${e.dayCellCls}`},thisObj:e}),e.widgetMap.monthField.readOnly=e.widgetMap.yearButton.disabled=!e.editMonth,e.refresh.flush()}afterHide(){var i;(i=this._yearPicker)==null||i.hide(),super.afterHide(...arguments)}doDestroy(){var i,e;(i=this.yearButton)==null||i.destroy(),(e=this.monthField)==null||e.destroy(),super.doDestroy()}get focusElement(){return this.weeksElement.querySelector(`.${this.dayCellCls}[tabIndex="0"]`)}doRefresh(){const i=this,{date:e}=i,t=i.focusElement,r=k.betweenLesser(i.activeDate,i.month.startDate,i.month.endDate)?i.activeDate:i._activeDate=e;i.getConfig("tbar"),super.doRefresh(...arguments),i.widgetMap.monthField.value=e.getMonth(),i.widgetMap.yearButton.text=e.getFullYear();const n=k.parseKey(t==null?void 0:t.dataset.date);r-n&&i.syncActiveDate(r,n)}internalCellRenderer({cell:i,date:e}){const t=this,{activeCls:r,selectedCls:n,externalCellRenderer:s}=t,a=t.isSelectedDate(e),l={[r]:r&&t.isActiveDate(e),[n]:a,[t.outOfRangeCls]:t.minDate&&e<t.minDate||t.maxDate&&e>t.maxDate};if(a&&t.multiSelect){const o=!t.isSelectedDate(k.add(e,-1,"d")),u=!t.isSelectedDate(k.add(e,1,"d"));l["b-range-start"]=o,l["b-range-end"]=u,l["b-in-range"]=!o&&!u}D.updateClassList(i,l),i.innerHTML=`<div class="b-datepicker-cell-inner">${e.getDate()}</div>`,i.setAttribute("role","gridcell"),i.setAttribute("aria-label",k.format(e,"MMMM D, YYYY")),t.isActiveDate(e)?i.id=`${t.id}-active-day`:i.removeAttribute("id"),s&&(arguments[0].cell=i.firstChild,t.callback(s,this,arguments))}onCellMousedown(i){const e=i.target.closest("[data-date]");e.focus(),D.getActiveElement(e)===e&&i.preventDefault(),this.activeDate=k.parseKey(e.dataset.date)}onCellClick(i){const e=i.target.closest("[data-date]");this.onUIDateSelect(k.parseKey(e.dataset.date),i)}onUIDateSelect(i,e){const t=this,{lastClickedDate:r,multiSelect:n}=t;t.lastClickedDate=i,t.isDisabledDate(i)||(t.activatingEvent=e,n?t.handleMultiSelect(r,i,e):(t.selection=i,t.floating&&t.hide()),t.activatingEvent=null)}handleMultiSelect(i,e,t){const r=this,{multiSelect:n}=r,s=r._selection||(r._selection=new $a),a=s.dates,l=n==="range",{size:o,generation:u}=s,c=o&&{[k.makeKey(k.add(a[0],-1,"d"))]:1,[k.makeKey(a[0])]:1,[k.makeKey(a[a.length-1])]:1,[k.makeKey(k.add(a[a.length-1],1,"d"))]:1},d=s.has(e),h=d?"delete":"add",g=l&&(c==null?void 0:c[k.makeKey(e)]);if(t.ctrlKey)(n===!0||!o||g)&&(s[h](e),l&&!s.has(r.rangeStartDate)&&r.rangeStartDate.setDate(r.rangeStartDate.getDate()+(e<a[1]?1:-1)));else if(t.shiftKey&&o){const[m,p]=[new Date(l?r.rangeStartDate||(r.rangeStartDate=a[0]):i),e].sort($f);l&&s.clear();for(const v=m;v<=p;v.setDate(v.getDate()+1))s.add(v)}else s.has(e)&&s.size===1||(s.clear(),s.add(e));const f=s.size;f===1?r.rangeStartDate=e:f||(r.rangeStartDate=null),s.generation!==u&&r.updateSelection(s)}changeSelection(i){const e=this;let t,r;if(i)if(i.forEach||(i=[i]),i.forEach((n,s)=>i[s]=e.changeDate(n)),r=i[0],i.sort($f),e.multiSelect==="range"&&i.length===2){t=new $a;for(const n=new Date(i[0]);n<=i[1];n.setDate(n.getDate()+1))t.add(n)}else r=i[0],t=new $a(i);else t=new $a;return r&&(e.activeDate=e.rangeStartDate=k.clearTime(r)),t}updateMultiSelect(i){this.element.classList.toggle("b-multiselect",!!i),i||(this.selection=[...this.selection][0])}updateSelection(i){const e=this,{dates:t}=i,r=e.multiSelect==="range"?[t[0],t[t.length-1]]:t;t.length&&(e.date=t[0]),e.isConfiguring||(e.refresh.now(),e.trigger("selectionChange",{selection:r,userAction:!!e.activatingEvent}))}get selection(){const{_selection:i}=this,e=i?i.dates:DC;return this.multiSelect==="range"&&e.length?[e[0],e[e.length-1]]:e}onInternalKeyDown(i){const e=this,t=i.key.trim()||i.code,r=e.activeDate;let n=new Date(r);if(t==="Escape"&&e.floating)return e.hide();if(r&&e.weeksElement.contains(i.target)){do switch(t){case"ArrowLeft":i.preventDefault(),i.ctrlKey?n=e.gotoPrevMonth():n.setDate(n.getDate()-1);break;case"ArrowUp":i.preventDefault(),n.setDate(n.getDate()-7);break;case"ArrowRight":i.preventDefault(),i.ctrlKey?n=e.gotoNextMonth():n.setDate(n.getDate()+1);break;case"ArrowDown":i.preventDefault(),n.setDate(n.getDate()+7);break;case"Enter":return e.onUIDateSelect(r,i)}while(e.isDisabledDate(n)&&!e.focusDisabledDates);if(e.minDate&&n<e.minDate||e.maxDate&&n>e.maxDate)return;e.activeDate=n}}changeMinDate(i){return i&&tr.prototype.changeDate.apply(this,arguments)}updateMinDate(i){this._yearpicker&&(this._yearpicker.minYear=i==null?void 0:i.getFullYear()),this.refresh()}changeMaxDate(i){return i&&tr.prototype.changeDate.apply(this,arguments)}updateMaxDate(i){this._yearpicker&&(this._yearpicker.maxYear=i==null?void 0:i.getFullYear()),this.refresh()}changeDate(i){return k.clamp(super.changeDate(i),this.minDate,this.maxDate)}updateDate(i,e){const t=this,{month:r}=t;if(t.isConfiguring&&!t.initializingActiveDate&&(t.selection=i),!r.date||i.getMonth()===r.month||!t.getCell(i)||t.alwaysRefreshOnMonthChange||t.isNavigating)super.updateDate(i);else{const n=r.getOtherMonth(i),s=t.eventListeners&&(e?i.getDate()!==e.getDate()|(n.getWeekId(i)!==r.getWeekId(e))<<1|(i.getMonth()!==(e==null?void 0:e.getMonth()))<<2|(i.getFullYear()!==(e==null?void 0:e.getFullYear()))<<3:15);t.trigger("dateChange",{changes:{d:!0,w:!!(s&2),m:!!(s&12),y:!!(s&8),r:n.weekCount!==r.weekCount},value:i,oldValue:e})}}changeActiveDate(i,e){if(this.trigger("beforeActiveDateChange",{activeDate:i,oldActiveDate:e})!==!1){if(i=i?this.changeDate(i):this.date||(this.date=k.clearTime(new Date)),isNaN(i))throw new Error("DatePicker date ingestion must be passed a Date, or a YYYY-MM-DD date string");return k.clamp(i,this.minDate,this.maxDate)}}updateActiveDate(i,e){const t=this,{isConfiguring:r}=t;(r||!t.getCell(i))&&(t.initializingActiveDate=r,t.date=i,t.initializingActiveDate=!1),!r&&!t.refresh.isPending&&t.syncActiveDate(i,e)}syncActiveDate(i,e){const t=this,{activeCls:r}=t,n=t.getCell(i),s=e&&t.getCell(e),a=D.getActiveElement(t.element);n.setAttribute("tabIndex",0),r&&n.classList.add(r),n.id=`${t.id}-active-day`,t.weeksElement.contains(a)&&n.focus(),s&&s!==n&&(s.removeAttribute("tabIndex"),r&&s.classList.remove(r),s.removeAttribute("id"))}set value(i){const e=this,{selection:t,duration:r}=e;if(i){if(i=e.changeDate(i,e.value),e.multiSelect==="range"&&(t==null?void 0:t.length)===2){k.betweenLesserEqual(i,...t)||(i<t[0]?e.selection=[i,k.add(i,r-1,"d")]:e.selection=[k.add(i,-(r-1),"d"),i]),e.date=e.activeDate=i;return}i!==void 0&&(e.selection=i)}else e.date=new Date,e.selection=null}get value(){return this.selection[this.selection.length-1]}get duration(){return this.multiSelect==="range"?k.diff(...this.selection,"d")+1:1}gotoPrevYear(){return this.goto(-1,"year")}gotoPrevMonth(){return this.goto(-1,"month")}gotoNextMonth(){return this.goto(1,"month")}gotoNextYear(){return this.goto(1,"year")}goto(i,e){const t=this,{activeDate:r}=t,n=r&&t.getCell(r);let s;e==="month"&&n&&(r==null?void 0:r.getMonth())===t.month.month+i?s=r:s=k.add(n?r:t.date,i,e);const a=new Date(s);a.setDate(1);const l=k.add(k.add(a,1,"month"),-1,"day");if(t.minDate&&i<0&&l<t.minDate||t.maxDate&&i>0&&a>t.maxDate)return;t.isNavigating=!0;const o=t.date=s;return n&&(t.activeDate=s),t.isNavigating=!1,o}isActiveDate(i){return!(i-this.activeDate)}isSelectedDate(i){var e;return(e=this._selection)==null?void 0:e.has(i)}onMonthPicked({record:i,userAction:e}){var t;e&&(this.activeDate=k.add(this.activeDate,i.value-this.activeDate.getMonth(),"month"),(t=this.focusElement)==null||t.focus())}onYearPickerRequested(){const{yearPicker:i}=this;i.isVisible?i.hide():(i.year=i.startYear=this.activeDate.getFullYear(),i.show(),i.focus())}onYearPickerTitleClick(){this.yearPicker.hide()}onYearPicked({value:i,source:e}){const t=new Date(this.activeDate);t.setFullYear(i),this.activeDate=t,this.focusElement&&D.focusWithoutScrolling(this.focusElement),e.hide()}changeYearPicker(i,e){var t,r;return ir.reconfigure(e,i?ir.mergeConfigs({owner:this,appendTo:this.element,minYear:(t=this.minDate)==null?void 0:t.getFullYear(),maxYear:(r=this.maxDate)==null?void 0:r.getFullYear()},i):null,this)}get childItems(){const{_yearPicker:i}=this,e=super.childItems;return i&&e.push(i),e}updateLocalization(){var i;const{monthField:e}=this.widgetMap,t=Lf();!this.isConfiguring&&!t.every((r,n)=>r[1]===e.store.getAt(n).text)&&(t[(i=e.value)!=null?i:this.date.getMonth()].selected=!0,e.items=t),super.updateLocalization()}};y(Di,"$name","DatePicker"),y(Di,"type","datepicker");var $a=class Dm extends Set{add(e){return e=k.makeKey(e),this.has(e)||(this.generation=(this.generation||0)+1),super.add(e)}delete(e){return e=k.makeKey(e),this.has(e)&&this.generation++,super.delete(e)}has(e){return super.has(k.makeKey(e))}clear(){return this.size&&this.generation++,super.clear()}equals(e){return Array.isArray(e)&&(e=new Dm(e)),e.size===this.size&&[...this].every(t=>e.has(t))}get dates(){return[...this].sort().map(e=>k.parseKey(e))}};Di.initClass(),Di._$name="DatePicker";var Ti=class extends Qt{static get configurable(){return{format:"L",strictParsing:!1,fallbackFormat:"YYYY-MM-DD",timeFormat:"HH:mm:ss:SSS",keepTime:!1,pickerFormat:null,validateDateOnly:null,triggers:{expand:{cls:"b-icon-calendar",handler:"onTriggerClick",weight:200},back:{cls:"b-icon b-icon-angle-left b-step-trigger",key:"Shift+ArrowDown",handler:"onBackClick",align:"start",weight:100},forward:{cls:"b-icon b-icon-angle-right b-step-trigger",key:"Shift+ArrowUp",handler:"onForwardClick",align:"end",weight:100}},calendarContainerCls:"",min:null,max:null,step:!1,stepTriggers:null,weekStartDay:null,picker:{type:"datepicker",role:"dialog",floating:!0,scrollAction:"realign",align:{align:"t0-b0",axisLock:!0}},value:null}}changePicker(i,e){const t=this,r={owner:t,forElement:t[t.pickerAlignElement],minDate:t.min,maxDate:t.max,weekStartDay:t._weekStartDay,align:{anchor:t.overlayAnchor,target:t[t.pickerAlignElement]},onSelectionChange:({selection:s,source:a})=>{a.isVisible&&(t._isUserAction=t._isPickerInput=!0,t.value=t.value?k.copyTimeValues(new Date(s[0]),t.value):new Date(s[0]),t._isPickerInput=t._isUserAction=!1,a.hide())}};t.calendarContainerCls&&(r.cls=t.calendarContainerCls),t.value?r.value=t.value:r.activeDate=new Date;const n=Di.reconfigure(e,i,{owner:t,defaults:r});return n==null||n.refresh.flush(),n}get backShiftDate(){return k.add(this.value,-1*this._step.magnitude,this._step.unit)}onBackClick(){const i=this,{min:e}=i;if(!i.readOnly&&i.value){const t=i.backShiftDate;(!e||e.getTime()<=t)&&(i._isUserAction=!0,i.value=t,i._isUserAction=!1)}}get forwardShiftDate(){return k.add(this.value,this._step.magnitude,this._step.unit)}onForwardClick(){const i=this,{max:e}=i;if(!i.readOnly&&i.value){const t=i.forwardShiftDate;(!e||e.getTime()>=t)&&(i._isUserAction=!0,i.value=t,i._isUserAction=!1)}}showPicker(i){if(this.readOnly)return;const e=this,{_picker:t}=e;if(t){const r={minDate:e.min,maxDate:e.max};e.value?r.value=e.value:t.activeDate||(r.activeDate=new Date),t.setConfig(r)}super.showPicker(i)}focusPicker(){this.picker.focus()}get isValid(){const i=this;i.clearError("L{Field.minimumValueViolation}",!0),i.clearError("L{Field.maximumValueViolation}",!0);let e=i.value;if(e){const{min:t,max:r,validateDateOnly:n}=i;if(n&&(e=k.clearTime(e,!1)),t&&e<t)return i.setError("L{Field.minimumValueViolation}",!0),!1;if(r&&e>r)return i.setError("L{Field.maximumValueViolation}",!0),!1}return super.isValid}transformDateValue(i,e=!0){const t=this;return i!=null&&(k.isDate(i)||(typeof i=="string"?i=k.parse(i,t.format,t.strictParsing)||k.parse(i,t.fallbackFormat,t.strictParsing):i=new Date(i)),k.isValidDate(i))?e&&(!t.min||i-t.min>-k.MS_PER_DAY)&&(!t.max||i<=t.max)?t.transformTimeValue(i):i:null}transformTimeValue(i){const e=this,{keepTime:t}=e;if(i=k.clone(i),!t)k.clearTime(i,!1);else if(t!=="entered"&&t!==!0){const r=k.parse(t,e.timeFormat);k.isValidDate(r)?k.copyTimeValues(i,r):k.isValidDate(e.value)&&k.copyTimeValues(i,e.value)}else t===!0&&(e._isPickerInput||e.inputting)&&k.isValidDate(e.value)&&k.copyTimeValues(i,e.value);return i}changeMin(i){return this.transformDateValue(i,!1)}updateMin(i){const{input:e,_picker:t}=this;e&&(i==null?e.removeAttribute("min"):e.min=i),t&&(t.minDate=i),this.syncInvalid()}changeMax(i){return this.transformDateValue(i,!1)}updateMax(i){const{input:e,_picker:t}=this;e&&(i==null?e.removeAttribute("max"):e.max=i),t&&(t.maxDate=i),this.syncInvalid()}get weekStartDay(){return typeof this._weekStartDay=="number"?this._weekStartDay:k.weekStartDay}updateWeekStartDay(i){this._picker&&(this._picker.weekStartDay=i)}changeValue(i,e){const t=this,r=t.transformDateValue(i);if(i&&!r){t.setError("L{invalidDate}");return}if(t.clearError("L{invalidDate}"),t.hasChanged(e,r))return super.changeValue(r,e);t.inputting||t.syncInputFieldValue()}updateValue(i,e){const t=this._picker;t&&!this.inputting&&(t.value=t.activeDate=i),super.updateValue(i,e)}changeStep(i,e){const t=typeof i;if(!i)return null;if(t==="number"?i={magnitude:Math.abs(i),unit:e?e.unit:"day"}:t==="string"&&(i=k.parseDuration(i)),i&&i.unit&&i.magnitude)return i.magnitude<0&&(i={magnitude:-i.magnitude,unit:i.unit}),i}updateStep(i){this.element.classList[i?"remove":"add"]("b-no-steppers"),this.syncInvalid()}hasChanged(i,e){return i!=null&&i.getTime&&(e!=null&&e.getTime)&&this.keepTime!=="entered"&&this.keepTime!==!0?!k.isEqual(k.clearTime(i),k.clearTime(e)):super.hasChanged(i&&i.getTime(),e&&e.getTime())}get inputValue(){const i=this.value;return i?k.format(i,this.format):""}updateFormat(){this.isConfiguring||this.syncInputFieldValue(!0)}updateLocalization(){super.updateLocalization(),this.syncInputFieldValue(!0)}internalOnKeyEvent(i){super.internalOnKeyEvent(i),i.key==="Enter"&&this.isValid&&this.picker.hide()}};y(Ti,"$name","DateField"),y(Ti,"type","datefield"),y(Ti,"alias","date"),Ti.initClass(),Ti._$name="DateField";var xC=i=>i.ctrlKey&&i.preventDefault(),xi=class extends De{static get configurable(){return{wrapAround:null,min:null,max:null,step:1,largeStep:0,value:null,format:"",decimalPrecision:null,leadingZeroes:null,triggers:{spin:{type:"spintrigger"}},changeOnSpin:!0,inputType:null}}construct(i){super.construct(i);const e=this;e.input.addEventListener("dblclick",()=>{e.select()}),typeof e.changeOnSpin=="number"&&(e.bufferedSpinChange=e.buffer(e.triggerChange,e.changeOnSpin))}acceptValue(i,e){let t=!isNaN(i);if(t&&!this.hasTextSelection){t=!1;const r=this.input.value,n=parseFloat(r);r!==e&&(t=!this.acceptValue(n,r))}return t}okMax(i){return isNaN(this.max)||i<=this.max}okMin(i){return isNaN(this.min)||i>=this.min}internalOnKeyEvent(i){if(i.type==="keydown"){const e=this,t=i.key;let r;if(t==="ArrowUp")e.doSpinUp(i.shiftKey),r=!0;else if(t==="ArrowDown")e.doSpinDown(i.shiftKey),r=!0;else if(!i.altKey&&!i.ctrlKey&&t&&t.length===1){const n=e.getAfterValue(t),s=e.formatter.parseStrict(n);r=!(s===e.value||n==="-"&&(isNaN(e.min)||e.min<0))&&!e.acceptValue(s,n)}t==="Enter"&&e._changedBySilentSpin&&(e.triggerChange(i,!0),e._changedBySilentSpin=!1),r&&i.preventDefault()}super.internalOnKeyEvent(i)}doSpinUp(i=!1){const e=this;if(e.readOnly)return;let t=(e.value||0)+(i?e.largeStep:e.step);e.okMin(t)||(t=e.min),e.okMax(t)?e.applySpinChange(t):e.wrapAround&&(t=e.min,e.applySpinChange(t))}doSpinDown(i=!1){const e=this;if(e.readOnly)return;let t=(e.value||0)-(i?e.largeStep:e.step);e.okMax(t)||(t=e.max),e.okMin(t)?e.applySpinChange(t):e.wrapAround&&(t=e.max,e.applySpinChange(t))}applySpinChange(i){const e=this;e._isUserAction=!0,e.changeOnSpin!==!0&&(e._changedBySilentSpin=!0,e.silenceChange=!0,e.bufferedSpinChange&&e.bufferedSpinChange(null,!0)),e.value=i,e._isUserAction=!1,e.silenceChange=!1}triggerChange(){this.silenceChange||super.triggerChange(...arguments)}onFocusOut(i){var e,t,r;super.onFocusOut(...arguments);const n=this,{input:s}=n,a=s.value,l=n.formatter.truncate(a),o=isNaN(l)?a:n.formatValue(l);(r=(t=(e=n.triggers)==null?void 0:e.spin)==null?void 0:t.clickRepeater)==null||r.cancel(),n.lastTouchmove=null,a!==o&&(s.value=o),n._changedBySilentSpin&&(n.triggerChange(i,!0),n._changedBySilentSpin=!1)}internalOnInput(i){const e=this,{formatter:t,input:r}=e,{parser:n,maximumFractionDigits:s}=t,a=r.value,l=n.decimalPlaces(a);if(t.truncator&&l>s){let o=a,u;const c=t.truncate(a);if(!isNaN(c)&&(o=e.formatValue(c),u=n.decimalPlaces(o),u<s&&(o+="0".repeat(s-u),u=s),u<l)){const d=a.length-e.caretPos;r.value=o,e.caretPos=o.length-d+1}}super.internalOnInput(i)}formatValue(i){return this.formatter.format(i)}changeFormat(i){const e=this;if(i===""){const{leadingZeroes:t,decimalPrecision:r}=e;i=t?`${t}>9`:null,r!=null?i=`${i||""}9.${"#".repeat(r)}`:i&&(i+=".*")}return i}get formatter(){const i=this,e=i.format;let t=i._formatter;return(!t||i._lastFormat!==e)&&(t=vi.get(i._lastFormat=e),i._formatter=t),t}updateStep(i){var e;const t=this;t.element.classList.toggle("b-hide-spinner",!i),t._step=i,i&&U.isMobile?t.touchMoveListener||(t.touchMoveListener=$.on({element:t.input,touchmove:"onInputSwipe",thisObj:t,throttled:{buffer:150,alt:xC}})):(e=t.touchMoveListener)==null||e.call(t)}onInputSwipe(i){const{lastTouchmove:e}=this;if(e){const t=i.screenX-e.screenX,r=e.screenY-i.screenY,n=Math.abs(t)>Math.abs(r)?t:r;this[`doSpin${n>0?"Up":"Down"}`]()}i.preventDefault(),this.lastTouchmove=i}changeLargeStep(i){return i||this.step*10}get validity(){const i=this.value,e={};return i!=null&&(e.rangeUnderflow=!this.okMin(i),e.rangeOverflow=!this.okMax(i)),e.valid=!e.rangeUnderflow&&!e.rangeOverflow,e}changeValue(i,e){const t=this;if(i||i===0){let r;typeof i!="number"&&(i=typeof i=="string"?t.formatter.parse(i):Number(i),r=isNaN(i),r&&(i="")),!r&&t.format&&(i=t.formatter.round(i))}else i=void 0;return super.changeValue(i,e)}get inputValue(){let i=this.value;return i!=null&&this.format&&(i=this.formatValue(i)),i}};y(xi,"$name","NumberField"),y(xi,"type","numberfield"),y(xi,"alias","number"),xi.initClass(),xi._$name="NumberField";var Lr=class extends pt{construct(i){super.construct(i),this.refresh()}updateSeconds(i){this.widgetMap.second[i?"show":"hide"]()}onFieldChange(){!this.isConfiguring&&!this.isRefreshing&&(this.value=this.pickerToTime())}onAmPmButtonClick({source:i}){this._pm=i.ref==="pmButton",this._value&&(this.value=this.pickerToTime())}onInternalKeyDown(i){var e;const t=this;switch(i.key){case"Escape":t.triggerTimeChange(t._initialValue),t.hide(),i.preventDefault();return;case"Enter":t.value=t.pickerToTime(),t.hide(),i.preventDefault();return}(e=super.onInternalKeyDown)==null||e.call(this,i)}pickerToTime(){const i=this,e=i._pm,{hour:t,minute:r,second:n}=i.widgetMap;t.format=i._is24Hour?"2>9":null;let s=t.value,a=new Date(i.value);return i._is24Hour||(e&&s<12&&(s=s+12),!e&&s===12&&(s=0)),a.setHours(s),a.setMinutes(r.value),i.seconds&&a.setSeconds(n.value),i._min&&(a=k.max(i._min,a)),i._max&&(a=k.min(i._max,a)),a}triggerTimeChange(i){this.trigger("timeChange",{time:i})}updateInitialValue(i){this.value=i}changeValue(i){return i&&(i=typeof i=="string"?k.parse(i,this.format):i),this.isVisible||(this._initialValue=i),i!=null?i:k.getTime(0)}updateValue(i){this.isVisible&&this.triggerTimeChange(i),this.refresh()}updateFormat(i){this._is24Hour=k.is24HourFormat(i),this.refresh()}changeMin(i){return typeof i=="string"?k.parse(i,this.format):i}changeMax(i){return typeof i=="string"?k.parse(i,this.format):i}refresh(){const i=this;if(!i.isConfiguring&&i.value){i.isRefreshing=!0;const{hour:e,minute:t,second:r,amButton:n,pmButton:s}=i.widgetMap,a=i.value,l=i._is24Hour,o=a.getHours(),u=i._pm=o>=12;i.element.classList[l?"add":"remove"]("b-24h"),e.min=l?0:1,e.max=l?23:12,e.value=l?o:o%12||12,t.value=a.getMinutes(),r.value=a.getSeconds(),n.pressed=!u,s.pressed=u,n.hidden=s.hidden=l,i.isRefreshing=!1}}};y(Lr,"$name","TimePicker"),y(Lr,"type","timepicker"),y(Lr,"configurable",{floating:!0,layout:"hbox",items:{hour:{label:"L{TimePicker.hour}",type:"number",min:0,max:23,highlightExternalChange:!1,format:"2>9",wrapAround:!0},minute:{label:"L{TimePicker.minute}",type:"number",min:0,max:59,highlightExternalChange:!1,format:"2>9",wrapAround:!0},second:{hidden:!0,label:"L{TimePicker.second}",type:"number",min:0,max:59,highlightExternalChange:!1,format:"2>9",wrapAround:!0},amPm:{type:"buttongroup",items:{amButton:{type:"button",text:"AM",toggleGroup:"am-pm",cls:"b-blue",onClick:"up.onAmPmButtonClick"},pmButton:{type:"button",text:"PM",toggleGroup:"am-pm",cls:"b-blue",onClick:"up.onAmPmButtonClick"}}}},autoShow:!1,trapFocus:!0,seconds:null,value:{$config:{equal:"date"},value:null},format:null,max:null,min:null,initialValue:null}),Lr.initClass(),Lr._$name="TimePicker";var nr=class extends Qt{static get configurable(){return{picker:{type:"timepicker",align:{align:"t0-b0",axisLock:!0}},format:"LT",triggers:{expand:{align:"end",handler:"onTriggerClick",compose:()=>({children:[{class:{"b-icon-clock-live":1}}]})},back:{align:"start",cls:"b-icon b-icon-angle-left b-step-trigger",key:"Shift+ArrowDown",handler:"onBackClick"},forward:{align:"end",cls:"b-icon b-icon-angle-right b-step-trigger",key:"Shift+ArrowUp",handler:"onForwardClick"}},min:null,max:null,step:"5m",stepTriggers:null,value:null,keepDate:!1}}changePicker(i,e){const t=this;return Lr.reconfigure(e,i,{owner:t,defaults:{value:t.value,forElement:t[t.pickerAlignElement],owner:t,align:{anchor:t.overlayAnchor,target:t[t.pickerAlignElement]},onTimeChange({time:r}){t._isUserAction=!0,t.value=r,t._isUserAction=!1}}})}onBackClick(){const i=this,{min:e}=i;if(!i.readOnly&&i.value){const t=k.add(i.value,-1*i.step.magnitude,i.step.unit);(!e||e.getTime()<=t)&&(i._isUserAction=!0,i.value=t,i._isUserAction=!1)}}onForwardClick(){const i=this,{max:e}=i;if(!i.readOnly&&i.value){const t=k.add(i.value,i.step.magnitude,i.step.unit);(!e||e.getTime()>=t)&&(i._isUserAction=!0,i.value=t,i._isUserAction=!1)}}get isValid(){const i=this;i.clearError("L{Field.minimumValueViolation}",!0),i.clearError("L{Field.maximumValueViolation}",!0);let e=i.value;if(e){if(e=e.getTime(),i._min&&i._min.getTime()>e)return i.setError("L{Field.minimumValueViolation}",!0),!1;if(i._max&&i._max.getTime()<e)return i.setError("L{Field.maximumValueViolation}",!0),!1}return super.isValid}hasChanged(i,e){return i!=null&&i.getTime&&(e!=null&&e.getTime)?i.getHours()!==e.getHours()||i.getMinutes()!==e.getMinutes()||i.getSeconds()!==e.getSeconds()||i.getMilliseconds()!==e.getMilliseconds():super.hasChanged(i,e)}showPicker(){const i=this,{picker:e,value:t}=i;i.readOnly||(e.value=t,e.format=i.format,e.maxTime=i.max,e.minTime=i.min,t||(i.value=e.value),super.showPicker(!0))}onPickerShow(){var i;super.onPickerShow(),this.pickerKeyDownRemover=(i=this.pickerKeyDownRemover)==null?void 0:i.call(this)}focusPicker(){this.picker.focus()}transformTimeValue(i){return i!=null&&(typeof i=="string"?(i=k.parse(i,this.format),this.keepDate&&(i=k.copyTimeValues(new Date(this.value),i))):i=new Date(i),k.isValidDate(i))?this.keepDate?i:k.getTime(i):null}changeMin(i){return this.transformTimeValue(i)}updateMin(i){const{input:e}=this;e&&(i==null?e.removeAttribute("min"):e.min=i),this.syncInvalid()}changeMax(i){return this.transformTimeValue(i)}updateMax(i){const{input:e}=this;e&&(i==null?e.removeAttribute("max"):e.max=i),this.syncInvalid()}changeValue(i,e){const t=this,r=t.transformTimeValue(i);if(i&&!r||t.isRequired&&i===""){t.setError("L{invalidTime}");return}if(t.clearError("L{invalidTime}"),t.hasChanged(e,r))return super.changeValue(r,e);t.inputting||t.syncInputFieldValue(!0)}updateValue(i,e){const{expand:t}=this.triggers;t&&i&&(t.element.firstElementChild.style.animationDelay=-((i.getHours()*60+i.getMinutes())/10)+"s"),super.updateValue(i,e)}changeStep(i,e){const t=typeof i;if(!i)return null;if(t==="number"?i={magnitude:Math.abs(i),unit:e?e.unit:"hour"}:t==="string"&&(i=k.parseDuration(i)),i!=null&&i.unit&&(i!=null&&i.magnitude))return i.magnitude<0&&(i={magnitude:-i.magnitude,unit:i.unit}),i}updateStep(i){this.element.classList[i?"remove":"add"]("b-no-steppers"),this.syncInvalid()}updateFormat(){this.syncInputFieldValue(!0)}get inputValue(){return k.format(this.value,this.format)}updateLocalization(){super.updateLocalization(),this.syncInputFieldValue(!0)}};y(nr,"$name","TimeField"),y(nr,"type","timefield"),y(nr,"alias","time"),nr.initClass(),nr._$name="TimeField";var Nf=new Date(2e3,0,1),$r=class extends De{doDestroy(){this.dateField.destroy(),this.timeField.destroy(),super.doDestroy()}get focusElement(){return this.dateField.input}get innerElements(){return[this.dateField.element,this.timeField.element]}internalOnKeyEvent(){}updateRevertOnEscape(i){this.timeField.revertOnEscape=i,this.dateField.revertOnEscape=i}changeTimeField(i){const e=this,t=nr.new({revertOnEscape:e.revertOnEscape,syncInvalid(...r){const n=e.updatingInvalid;nr.prototype.syncInvalid.apply(this,r),e.timeField&&!n&&e.syncInvalid()}},i);return $.on({element:t.element,keydown:"onTimeFieldKeyDown",thisObj:e}),e.readOnly&&(t.readOnly=!0),t}updateTimeField(i){const e=this;i.ion({change({userAction:t,value:r}){if(t&&!e.$settingValue){const n=e.dateField.value;e._isUserAction=!0,e.value=n?k.copyTimeValues(new Date(n),r||Nf):null,e._isUserAction=!1}},thisObj:e})}changeDateField(i){const e=this,t=(i==null?void 0:i.type)||"datefield",r=j.resolveType(i.type||"datefield"),n=j.create(x.assign({type:t,revertOnEscape:e.revertOnEscape,syncInvalid(...s){const a=e.updatingInvalid;r.prototype.syncInvalid.apply(this,s),e.dateField&&!a&&e.syncInvalid()}},i));return $.on({element:n.element,keydown:"onDateFieldKeyDown",thisObj:e}),e.readOnly&&(n.readOnly=!0),n.ion({keydown:({event:s})=>{var a;s.key==="Tab"&&!s.shiftKey&&((a=this.timeField)!=null&&a.isVisible)&&(s.stopPropagation(),s.cancelBubble=!0)}}),n}get childItems(){return[this.dateField,this.timeField]}updateDateField(i){const e=this;i.ion({change({userAction:t,value:r}){t&&!e.$isInternalChange&&(e._isUserAction=!0,e.timeField.value=r,e.value=r,e._isUserAction=!1)},thisObj:e})}updateWeekStartDay(i){this.dateField&&(this.dateField.weekStartDay=i)}changeWeekStartDay(i){var e,t;return typeof i=="number"?i:(t=(e=this.dateField)==null?void 0:e.weekStartDay)!=null?t:k.weekStartDay}syncInputFieldValue(i=this.isConfiguring){super.syncInputFieldValue(!0);const e=this,{dateField:t,timeField:r}=e,n=t.highlightExternalChange,s=r.highlightExternalChange;!i&&!e.highlightExternalChange&&(i=!0),e.$isInternalChange=!0,t.highlightExternalChange=!1,t.highlightExternalChange=n,i&&(r.highlightExternalChange=t.highlightExternalChange=!1),r.value=t.value=e.inputValue,t.highlightExternalChange=n,r.highlightExternalChange=s,e.$isInternalChange=!1,e.syncInvalid()}onTimeFieldKeyDown(i){const e=this;if(i.key==="Enter"||i.key==="Tab"){const t=e.dateField.value;e._isUserAction=!0,e.value=t?k.copyTimeValues(new Date(t),e.timeField.value||Nf):null,e._isUserAction=!1}}onDateFieldKeyDown(i){const e=this;i.key==="Tab"&&!i.shiftKey?(i.stopPropagation(),i.preventDefault(),e.timeField.focus()):i.key==="Enter"&&(e.value=e.dateField.value)}updateRequired(i,e){this.timeField.required=this.dateField.required=i}updateReadOnly(i,e){super.updateReadOnly(i,e),this.isConfiguring||(this.timeField.readOnly=this.dateField.readOnly=i)}onDisabled(i){this.timeField.disabled=this.dateField.disabled=i}focus(){this.dateField.focus()}hasChanged(i,e){return!k.isEqual(i,e)}get isValid(){return this.timeField.isValid&&this.dateField.isValid}setError(i,e){[this.dateField,this.timeField].forEach(t=>t.setError(i,e))}getErrors(){const i=[...this.dateField.getErrors()||[],...this.timeField.getErrors()||[]];return i.length?i:null}clearError(i,e){[this.dateField,this.timeField].forEach(t=>t.clearError(i,e))}updateInvalid(){this.updatingInvalid=!0,[this.dateField,this.timeField].forEach(i=>i.updateInvalid()),this.updatingInvalid=!1}};y($r,"$name","DateTimeField"),y($r,"type","datetimefield"),y($r,"alias","datetime"),y($r,"configurable",{timeField:{},dateField:{keepTime:!0,step:"1 d"},weekStartDay:null,inputTemplate:()=>"",ariaElement:"element"}),$r.initClass(),$r._$name="DateTimeField";var Ei=class extends vt{static get defaultConfig(){return{value:null,step:1,unit:null,defaultUnit:"day",magnitude:null,useAbbreviation:!1,allowNegative:!1,decimalPrecision:null,triggers:{spin:{type:"spintrigger"}},nullValue:null}}static get configurable(){return{min:null,max:null,allowedUnits:null}}changeMin(i){return typeof i=="string"?new Re(i):i}changeMax(i){return typeof i=="string"?new Re(i):i}changeAllowedUnits(i){return typeof i=="string"&&(i=i.split(",")),i.length>0&&!i.includes(this.defaultUnit)&&(this.defaultUnit=i[0]),i}updateAllowedUnits(i){this.allowedUnitsRe=new RegExp(`(${i.join("|")})`,"i")}get inputValue(){return this.value==null?"":this.calcValue(!0).toString(this.useAbbreviation)}set unit(i){this._unit=i,this.value=this.calcValue()}get unit(){return this._unit}get unitWithDefault(){return this._unit||this.defaultUnit}set magnitude(i){this.clearError("L{invalidUnit}"),this._magnitude=i,super.value=this.calcValue()}get magnitude(){return this._magnitude}roundMagnitude(i){return i&&this.decimalPrecision!=null?x.round(i,this.decimalPrecision):i}get allowDecimals(){return this.decimalPrecision!==0}get isValid(){const i=this,e=i.value==null||i.value&&i.value.magnitude==null;return super.isValid&&(e&&!i.required||!e&&(i.allowNegative||i.value.magnitude>=0))}internalOnChange(i){const e=this,t=e.value,r=e._lastValue;e.hasChanged(r,t)&&(e._lastValue=t,e.triggerFieldChange({value:t,event:i,userAction:!0,valid:e.isValid}))}onFocusOut(i){var e,t,r;return this.syncInputFieldValue(!0),(r=(t=(e=this.triggers)==null?void 0:e.spin)==null?void 0:t.clickRepeater)==null||r.cancel(),super.onFocusOut(i)}set value(i){const e=this;let t,r;if(e.getConfig("allowedUnits"),e.clearError("L{invalidUnit}"),typeof i=="number"||typeof i=="string"&&i.length>0&&!isNaN(i))t=Number(i),r=e.unitWithDefault;else if(typeof i=="string")if(/^\s*$/.test(i))t=null;else{const n=k.parseDuration(i,e.allowDecimals,e.unitWithDefault);n&&(!e.allowedUnitsRe||e.allowedUnitsRe.test(n.unit)?(r=n.unit,t=n.magnitude):e.setError("L{invalidUnit}"))}else i&&"unit"in i&&"magnitude"in i?(r=i.unit,t=i.magnitude):(r=null,t=null);(e._magnitude!==t||e._unit!=r)&&(e._magnitude=t,r&&(e._unit=r),super.value=e.calcValue())}okMax(i){return typeof i=="number"&&(i=new Re({unit:this.unitWithDefault,magnitude:i})),this.max==null||i<=this.max}okMin(i){return typeof i=="number"&&(i=new Re({unit:this.unitWithDefault,magnitude:i})),this.min==null||i>=this.min}get validity(){const i=this.value,e={};return i!=null&&(e.rangeUnderflow=!this.okMin(i),e.rangeOverflow=!this.okMax(i)),e.valid=!e.rangeUnderflow&&!e.rangeOverflow,e}get value(){return super.value}calcValue(i=!1){const e=this;return(!e._unit||e._magnitude==null)&&e.clearable?null:new Re(i?this.roundMagnitude(e._magnitude):this._magnitude,e.unitWithDefault)}hasChanged(i,e){return e&&!i||!e&&i||e&&i&&!i.isEqual(e)}get milliseconds(){return this.value?this.value.milliseconds:0}onInternalKeyDown(i){i.key==="ArrowUp"?this.doSpinUp():i.key==="ArrowDown"&&this.doSpinDown()}doSpinUp(){const i=this;if(i.readOnly)return;let e=(i.magnitude||0)+i.step;i._isUserAction=!0,i.okMin(e)||(e=i.min),i.okMax(e)&&(i.value=e),i._isUserAction=!1}doSpinDown(){const i=this;if(i.readOnly)return;let e=(i.magnitude||0)-i.step;i.okMax(e)||(e=i.max),i.okMin(e)&&(i.allowNegative||(i.magnitude||0)>0)&&(i._isUserAction=!0,i.value=e,i._isUserAction=!1)}};y(Ei,"$name","DurationField"),y(Ei,"type","durationfield"),y(Ei,"alias","duration"),Ei.initClass(),Ei._$name="DurationField";var is=class extends gt{};y(is,"$name","Fit"),y(is,"type","fit"),y(is,"configurable",{containerCls:"b-fit-container",itemCls:"b-fit-item"}),is.initClass(),is._$name="Fit";var sr=class extends Be{afterConfigure(){const i=this;super.afterConfigure(),i.onTargetSizeChange=i.onTargetSizeChange.bind(i),$.on({element:i.element,keydown:"onKeyDown",contextmenu:"stopMouseEvents",mousedown:"stopMouseEvents",mouseover:"stopMouseEvents",mouseout:"stopMouseEvents",mouseup:"stopMouseEvents",click:"stopMouseEvents",dblclick:"stopMouseEvents",thisObj:i}),i.ion({beforeHide:"beforeEditorHide",hide:"afterEditorHide",thisObj:i}),Te.ion({locale:"onLocaleChange",thisObj:i})}onLocaleChange(){const{inputField:i}=this;i&&!i.isDestroyed&&(i.syncInputFieldValue?i.syncInputFieldValue(!0):i instanceof De)}render(i){const e=this.element.parentNode,[t]=this.getRenderContext(this,i);t.classList.add("b-editing"),super.render(...arguments),e!=null&&e.classList&&t!==e&&e.classList.remove("b-editing")}async startEdit(i){var e,t,r;const n=this;if(i=x.assignIf(i,{align:n.align,hideTarget:n.hideTarget,matchSize:n.matchSize,matchFont:n.matchFont,fitTargetContent:n.fitTargetContent,focus:!0}),n.trigger("beforeStart",i)!==!1){const{target:s,hideTarget:a,matchSize:l,matchFont:o,fitTargetContent:u,record:c,field:d=n.inputField.name,focus:h}=i,{inputField:g}=n,{input:f}=g,m=D.getStyleValue(s,"font-size"),p=D.getStyleValue(s,"font-family");let{value:v,align:b}=i;if(c&&d&&(n.record=c,n.dataField=d,v===void 0&&(v=c.getValue(d))),l&&(s instanceof HTMLElement&&n.updateSize(s,l),s instanceof HTMLElement&&Ee.addResizeListener(s,n.onTargetSizeChange)),f&&(o?(f.style.fontSize=m,f.style.fontFamily=p):f.style.fontSize=f.style.fontFamily=""),n.assigningValues=!0,(e=g.clearError)==null||e.call(g),"setValue"in g?await g.setValue(v):g.value=v,n.assigningValues=!1,typeof b=="string"&&(b={align:b}),await n.showBy({target:s,allowTargetOut:!0,...b}),u){const S=f.scrollWidth-f.clientWidth;S>0&&(n.width+=S+D.scrollBarWidth)}h&&((t=g.focus)==null||t.call(g)),s.nodeType===Element.ELEMENT_NODE&&a&&s.classList.add("b-hide-visibility"),n.editing=!0;const w=g.value;return n.trigger("start",{value:w}),Array.isArray(w)&&g.editingRecords&&((r=w[0])!=null&&r.isModel)?n.oldValue=w.map(S=>S.copy(S.id)):(n.oldValue=w,Array.isArray(n.oldValue)&&(n.oldValue=n.oldValue.slice())),g.initialValue=n.oldValue,!0}return!1}async refreshEdit(){if(this.isVisible){const{record:i,dataField:e,inputField:t}=this;if(i&&e){const r=i.getValue(e);x.isEqual(t.value,r)||await t.setValue(r)}}}finishEdit(){const{target:i,aligningToElement:e}=this.lastAlignSpec;e&&(i.classList.remove("b-editing"),i.classList.remove("b-hide-visibility")),this.editing=!1,this.trigger("finishEdit")}onKeyDown(i){var e;const t=this;switch(i.key){case t.completeKey:t.completeEdit(null,i),i.stopImmediatePropagation();break;case t.cancelKey:t.cancelEdit(i),i.stopImmediatePropagation();break}(e=t.trigger)==null||e.call(t,"keydown",{event:i})}stopMouseEvents(i){this.allowMouseEvents||i.stopPropagation()}onFocusOut(i){super.onFocusOut(i);const e=this;if(!e.isFinishing&&e.editing)switch(e.blurAction){case"cancel":e.cancelEdit(i);break;case"complete":e.completeEdit(null,i)}}async completeEdit(i,e){var t,r,n,s;const a=this,{inputField:l,oldValue:o,record:u}=a,c=l.invalidAction||(l.allowInvalid===!1?"block":a.invalidAction),{value:d}=l;if(a.isVisible){if(!l.isValid&&c!=="allow"){if(c==="block")return(t=l.focus)==null||t.call(l),!1;if(c==="revert")return a.cancelEdit(e)!==!1}else{if(x.isEqual(d,o))return a.cancelEdit(e)!==!1;{const h={inputField:l,record:u,value:d,oldValue:o};if(a.trigger("beforeComplete",h)===!1)(r=l.focus)==null||r.call(l);else if(i||(i=h.finalize||((n=h.editorContext)==null?void 0:n.finalize)),i){let g=await i(h);if(g===!0)a.onEditComplete();else{if(l.setError){const f=g||l.invalidValueError,m=()=>{p(),l.clearError(f)},p=l.ion({change:m,input:m});l.setError(f)}c==="block"?(s=l.focus)==null||s.call(l):c==="revert"&&(await l.setValue(o),g=!0),g=!1}return g}else return a.onEditComplete(),!0}}return!1}}cancelEdit(i){var e;const t=this,{inputField:r,oldValue:n}=t,{value:s}=r;if(t.editing&&!t.isFinishing&&t.trigger("beforeCancel",{value:s,oldValue:n,event:i})!==!1)(e=r.clearError)==null||e.call(r),t.isFinishing=!0,t.hide(),t.trigger("cancel",{value:s,oldValue:n,event:i}),t.finishEdit(),t.isFinishing=!1;else return!1}onEditComplete(){const i=this,{record:e,dataField:t,inputField:r,oldValue:n}=i,{value:s}=r;if(!i.isFinishing){if(i.isFinishing=!0,i.hide(),e){const a=`set${P.capitalize(t)}`;e[a]?e[a](s):e.setValue(t,s)}i.trigger("complete",{value:s,oldValue:n}),i.finishEdit(),i.isFinishing=!1}}doDestroy(){this.createdInputField&&this.inputField.destroy(),super.doDestroy()}set owner(i){this._owner=i}get owner(){return this._owner||j.fromElement(this.element.parentNode)}changeInputField(i,e){const t=this;return e&&e.destroy(),typeof i=="string"&&(i={type:i}),i instanceof j||(i=j.create(i),t.createdInputField=!0),t.completeOnChange&&i.ion({change:"onInputFieldChange",thisObj:t}),i.parent=t,i}updateInputField(i){this.removeAll(),this.add(i)}get inputField(){return this.items[0]}onInputFieldChange(){this.containsFocus&&this.completeEdit()}onTargetSizeChange(i,e,t){e&&t&&this.updateSize(i)}updateSize(i,e=this.lastMatchSize){const t=this,r=V.inner(i);t.width=e.width===!1?"auto":r.width-t.align.offset[0],t.height=e.height===!1?"auto":r.height,t.lastMatchSize=e}beforeEditorHide(){if(this.editing&&!this.isFinishing)return this.cancelEdit(),!1}afterEditorHide(){this.positioned&&this.element.remove(),Ee.removeResizeListener(this.lastAlignSpec.target,this.onTargetSizeChange)}};y(sr,"$name","Editor"),y(sr,"type","editor"),y(sr,"configurable",{positioned:!0,hidden:!0,layout:"fit",align:{align:"t0-t0",offset:[0,0]},hideTarget:!1,matchSize:!0,matchFont:!0,fitTargetContent:!1,inputField:"textfield",blurAction:"complete",completeKey:"Enter",cancelKey:"Escape",invalidAction:"block",completeOnChange:null,isolateFields:!0}),sr.initClass(),sr._$name="Editor";var EC={number:!0,boolean:!0,string:!0,date:!0,duration:!0,time:!0,auto:!0},kC={number:!0,boolean:!0,string:!0},IC=i=>{var e;return((e=i==null?void 0:i.column)==null?void 0:e.type)==="duration"},Bf="",Ye="b-fieldfilterpicker",MC={between:!0,notBetween:!0,isIncludedIn:!0,isNotIncludedIn:!0},RC={textfield:!0,datefield:!0,numberfield:!0,durationfield:!0,combo:!0,timefield:!0},q={empty:{value:"empty",text:"L{isEmpty}",argCount:0},notEmpty:{value:"notEmpty",text:"L{isNotEmpty}",argCount:0},"=":{value:"=",text:"L{equals}"},"!=":{value:"!=",text:"L{doesNotEqual}"},">":{value:">",text:"L{isGreaterThan}"},"<":{value:"<",text:"L{isLessThan}"},">=":{value:">=",text:"L{isGreaterThanOrEqualTo}"},"<=":{value:"<=",text:"L{isLessThanOrEqualTo}"},between:{value:"between",text:"L{isBetween}",argCount:2},notBetween:{value:"notBetween",text:"L{isNotBetween}",argCount:2},isIncludedIn:{value:"isIncludedIn",text:"L{isOneOf}",isArrayValued:!0},isNotIncludedIn:{value:"isNotIncludedIn",text:"L{isNotOneOf}",isArrayValued:!0}},ar=class ti extends Be{static get defaultValueFieldPlaceholders(){return{string:"L{enterAValue}",number:"L{enterANumber}",date:"L{selectADate}",relation:"L{selectValue}",list:"L{selectOneOrMoreValues}",duration:"L{enterAValue}",time:"L{selectATime}",auto:"L{enterAValue}"}}afterConstruct(){const e=this;if(!e._fields)throw new Error(`${ti.name} requires 'fields' to be configured.`);if(!e._filter)throw new Error(`${ti.name} requires 'filter' to be configured.`);super.afterConstruct();const{widgetMap:{propertyPicker:t,operatorPicker:r,caseSensitive:n}}=e;t.ion({select:"onPropertySelect",thisObj:e}),r.ion({select:"onOperatorSelect",thisObj:e}),n.ion({change:"onCaseSensitiveChange",thisObj:e}),e.propertyFieldConfig&&t.setConfig(e.propertyFieldConfig),e.operatorFieldConfig&&r.setConfig(e.operatorFieldConfig),t.cls=e.allPropertyPickerClasses,r.cls=e.allOperatorPickerClasses,e.populateUIFromFilter()}changeDateFormat(e){return this.L(e)}get allChildInputs(){const{propertyPicker:e,operatorPicker:t,caseSensitive:r}=this.widgetMap;return[e,t,...this.valueFields,r]}updateDisabled(e){this.allChildInputs.forEach(t=>t.disabled=e)}updateReadOnly(e){const{propertyPicker:t,operatorPicker:r}=this.widgetMap;this.allChildInputs.forEach(n=>n.readOnly=e),t.readOnly=t.readOnly||e,r.readOnly=r.readOnly||e}updatePropertyLocked(e){this.widgetMap.propertyPicker.readOnly=e||this.readOnly,this.widgetMap.propertyPicker.cls=this.allPropertyPickerClasses}updateOperatorLocked(e){this.widgetMap.operatorPicker.readOnly=e||this.readOnly,this.widgetMap.operatorPicker.cls=this.allOperatorPickerClasses}changeOperators(e){const t=e!=null?e:ti.defaultOperators;return Object.keys(t).reduce((r,n)=>({...r,[n]:t[n].map(s=>({...s,text:this.L(s.text)}))}),{})}changeFields(e){let t=e;return Array.isArray(e)&&(ie.deprecate("Core","6.0.0","FieldOption[] deprecated, use Object<String, FieldOption> keyed by field name instead"),t=z.keyBy(t,"name")),t}get isMultiSelectValueField(){var e;return["isIncludedIn","isNotIncludedIn"].includes((e=this._filter)==null?void 0:e.operator)}get allPropertyPickerClasses(){var e;return new J(`${Ye}-property`,(e=this.propertyFieldConfig)==null?void 0:e.cls,{[`${Ye}-combo-locked`]:this.propertyLocked})}get allOperatorPickerClasses(){var e;return new J(`${Ye}-operator`,(e=this.operatorFieldConfig)==null?void 0:e.cls,{[`${Ye}-combo-locked`]:this.operatorLocked})}getValueFieldConfigs(){const e=this,{valueFieldCls:t,fieldType:r,_filter:{operator:n},onValueChange:s,filterValues:a,isMultiSelectValueField:l,operatorArgCount:o,getValueFieldConfig:u,fieldIsRelation:c,triggerChangeOnInput:d}=e,h=x.merge({},ti.defaultValueFieldPlaceholders,e.valueFieldPlaceholders);if(!r||!n||o===0)return[];let g={type:"textfield",internalListeners:{change:s,input:d?s:null,thisObj:e},bubbleEvents:{keydown:!0},cls:t,dataset:{type:r},placeholder:e.L(h[l?"list":c?"relation":r]),highlightExternalChange:!1};return l||c?g={...g,type:"combo",multiSelect:l,createOnUnmatched:!0,items:e.getUniqueDataValues(a),value:a!=null?a:[]}:["number","date","boolean","duration","time"].includes(r)&&(g.type=`${r}field`),u&&(g=e.callback(u,e,[e.filter,g])),l?[g]:z.populate(o,f=>[{type:"widget",tag:"div",cls:`${Ye}-value-separator`,content:e.L("L{FieldFilterPicker.and}")},{...g,value:a[f]}]).flat().slice(1)}getUniqueDataValues(e=[]){var t;const r=this,{fieldType:n}=r;if(!r.store||!((t=r._filter)!=null&&t.property))return[];const{relatedDisplayField:s}=r.selectedField;let a,l;if(r.fieldIsRelation){const{foreignStore:o}=r.currentPropertyRelationConfig;s?(a=o.allRecords.reduce((u,c)=>(c.id!=null&&u.push({text:c.getValue(s),value:c.id}),u),[]),l=a.sort((u,c)=>r.sortStrings(u.text,c.text))):a=o.allRecords.map(u=>u.id)}else a=r.store.allRecords.map(o=>o.getValue(r._filter.property));if(!l){a.push(...e);const o=z.unique(a.reduce((u,c)=>(c!=null&&String(c).trim()!==""&&(n==="date"?u.push(c.valueOf()):n==="duration"?u.push(c.toString()):u.push(c)),u),[]));n==="string"?l=o.sort(r.sortStrings):n==="duration"?l=o.map(u=>new Re(u)).filter(u=>u.isValid).sort(r.sortDurations):l=o.sort(r.sortNumerics),n==="date"?l=l.map(u=>{const c=new Date(u);return{text:k.format(c,r.dateFormat),value:u}}):n==="duration"&&(l=l.map(u=>u.toString()))}return l}sortStrings(e,t){return(e!=null?e:Bf).localeCompare(t!=null?t:Bf)}sortNumerics(e,t){return e-t}sortDurations(e,t){return e.valueOf()-t.valueOf()}get fieldType(){var e;return(e=this.selectedField)==null?void 0:e.type}get selectedField(){var e,t;return(t=this.fields)==null?void 0:t[(e=this._filter)==null?void 0:e.property]}get propertyOptions(){var e;return Object.entries((e=this.fields)!=null?e:{}).filter(([,t])=>EC[t.type]||IC(t)).map(([t,{title:r}])=>({value:t,text:r!=null?r:t})).sort((t,r)=>t.text.localeCompare(r.text))}get operatorOptions(){return this.operators[this.fieldIsRelation?"relation":this.fieldType]}get fieldIsRelation(){return!!this.currentPropertyRelationConfig}get currentPropertyRelationConfig(){var e,t;return(t=(e=this.store)==null?void 0:e.modelRelations)==null?void 0:t.find(({foreignKey:r})=>{var n;return r===((n=this._filter)==null?void 0:n.property)})}updateOperators(){delete this._operatorArgCountLookup}get operatorArgCountLookup(){return this._operatorArgCountLookup||(this._operatorArgCountLookup=ti.buildOperatorArgCountLookup(this.operators))}updateFilter(){this._filter&&this.onFilterChange()}updateStore(e){var t;(t=this._store)==null||t.un(this),e==null||e.ion({refresh:"onStoreRefresh",thisObj:this}),this.inferFieldTypes()}onStoreRefresh({action:e}){this.isMultiSelectValueField&&["dataset","create","update","delete"].includes(e)&&(this.valueFields[0].items=this.getUniqueDataValues(this.filterValues))}refreshValueFields(){const e=this,{valueFields:t}=e.widgetMap,{fieldType:r,operatorArgCount:n,_filter:{property:s,operator:a}}=e,l=MC[a];t.element.className=new J({[`${Ye}-values`]:!0,[`${Ye}-values-multiple`]:l,[`${Ye}-values-${r}`]:r!==void 0,"b-hidden":s==null||a==null||n===0}),t.removeAll(),t.add(e.getValueFieldConfigs()),delete e._valueFields,e.refreshCaseSensitive()}refreshCaseSensitive(){var e,t;const r=this,{fieldType:n,operatorArgCount:s,isMultiSelectValueField:a}=r,l=(e=r._filter)==null?void 0:e.operator,{caseSensitive:o}=r.widgetMap;o.hidden=n!=="string"||!l||a||s===0,o.checked=((t=r._filter)==null?void 0:t.caseSensitive)!==!1}onPropertySelect(e){var t;const r=this,{_filter:n}=r;n.property=((t=e.record)==null?void 0:t.data.value)||null,r.fieldType!==r._fieldType&&(n.operator=null,n.value=null),r._fieldType=n.type=r.fieldType,r.refreshOperatorPicker(),r.refreshValueFields(),r.triggerChange()}onCaseSensitiveChange({checked:e}){this._filter.caseSensitive=e,this.triggerChange()}onOperatorSelect(e){var t;const r=this,n=r.isMultiSelectValueField,s=this.operatorArgCount;r._filter.operator=((t=e.record)==null?void 0:t.data.value)||null,r.operatorArgCount!==s&&(r._filter.value=null),r.isMultiSelectValueField&&!n&&(r._filter.value=[]),r.refreshValueFields(),r.triggerChange()}triggerChange(){const{filter:e,isValid:t}=this;this.trigger("change",{filter:e,isValid:t})}onValueChange(){const e=this,{isMultiSelectValueField:t,fieldType:r,_filter:n}=e,s=this.valueFields.map(a=>a.value);t&&r==="date"?n.value=s[0].map(a=>new Date(a)):t&&r==="duration"?n.value=s[0].map(a=>new Re(a)):(r==="date"&&n.operator==="between"&&k.isValidDate(s[1])&&s[1].setHours(23,59,59,999),n.value=s.length===1?s[0]:s),e.triggerChange()}refreshOperatorPicker(){const{operatorPicker:e}=this.widgetMap,{_filter:{operator:t,property:r},operatorOptions:n}=this;e.items=n,e.value=t,e.hidden=r===null}populateUIFromFilter(e=!1){const t=this,{filterValues:r,widgetMap:{propertyPicker:n,operatorPicker:s},_filter:{property:a,operator:l,disabled:o},propertyOptions:u,operatorOptions:c,isMultiSelectValueField:d}=t;n.items=u,s.items=c,s.hidden=a===null;let h=e;n.value!==a&&(n.value=a,t.refreshOperatorPicker(),h=!0),s.value!==l&&(l===null||!s.items.find(({value:g})=>g===l)?s.clear():s.value=l,h=!0),!l&&s.items.length===1&&(s.value=t._filter.operator=s.items[0].value),h&&t.refreshValueFields(),t.refreshCaseSensitive(),t.valueFields.forEach((g,f)=>{d&&(g.value.length>0||r.length>0)?t.fieldType==="date"?g.value=r.map(m=>m==null?void 0:m.valueOf()):t.fieldType==="duration"?g.value=r.map(m=>m==null?void 0:m.toString()):g.value=r:f>=r.length?g.clear():g.value=r[f]}),t.allChildInputs.forEach(g=>g.disabled=t.disabled||o)}get valueFields(){return this._valueFields||(this._valueFields=this.widgetMap.valueFields.queryAll(e=>e.owner===this.widgetMap.valueFields&&RC[e.type]))}get filterValues(){var e;return((e=this._filter)==null?void 0:e.value)==null?[]:z.asArray(this._filter.value)}onFilterChange(){const e=this,t=e.fieldType,r=t!==e._fieldType;e._fieldType=e._filter.type=t,e.populateUIFromFilter(r)}get operatorArgCount(){const{fieldType:e,filter:{operator:t},operatorArgCountLookup:r}=this;return e&&t?r[e][t]:1}get isValid(){const e=this,{filter:t,fieldType:r,filterValues:n,isMultiSelectValueField:s,operatorArgCount:a}=e,{operator:l}=t,o=a>0&&(t==null?void 0:t.value)==null;return r&&l&&!o&&(s&&n.length>0||n.length===a)&&n.every(u=>u!=null&&(r!=="duration"||u.isValid))}focus(){var e,t,r;(r=(t=(e=this.valueFields.find(n=>n.isEmptyInput))!=null?e:this.operatorPicker)!=null?t:this.propertyPicker)==null||r.focus()}inferFieldTypes(){if(this.store&&this.fields)for(const[e,t]of Object.entries(this.fields))t.type==="auto"&&(t.type=ti.inferFieldType(this.store,e))}static inferFieldType(e,t){var r;const n=(r=e.find(s=>s.getValue(t)!=null,!0))==null?void 0:r.getValue(t);if(n!==void 0){const s=typeof n;if(s==="object"&&n instanceof Date)return"date";if(kC[s])return s}return"auto"}};y(ar,"$name","FieldFilterPicker"),y(ar,"type","fieldfilterpicker"),y(ar,"operators",{empty:{value:"empty",text:"L{isEmpty}",argCount:0},notEmpty:{value:"notEmpty",text:"L{isNotEmpty}",argCount:0},"=":{value:"=",text:"L{equals}"},"!=":{value:"!=",text:"L{doesNotEqual}"},">":{value:">",text:"L{isGreaterThan}"},"<":{value:"<",text:"L{isLessThan}"},">=":{value:">=",text:"L{isGreaterThanOrEqualTo}"},"<=":{value:"<=",text:"L{isLessThanOrEqualTo}"},between:{value:"between",text:"L{isBetween}",argCount:2},notBetween:{value:"notBetween",text:"L{isNotBetween}",argCount:2},isIncludedIn:{value:"isIncludedIn",text:"L{isOneOf}"},isNotIncludedIn:{value:"isNotIncludedIn",text:"L{isNotOneOf}"}}),y(ar,"defaultOperators",{string:[q.empty,q.notEmpty,q["="],q["!="],{value:"includes",text:"L{contains}"},{value:"doesNotInclude",text:"L{doesNotContain}"},{value:"startsWith",text:"L{startsWith}"},{value:"endsWith",text:"L{endsWith}"},q.isIncludedIn,q.isNotIncludedIn],number:[q.empty,q.notEmpty,q["="],q["!="],q[">"],q["<"],q[">="],q["<="],q.between,q.notBetween,q.isIncludedIn,q.isNotIncludedIn],date:[q.empty,q.notEmpty,q["="],q["!="],{value:"<",text:"L{isBefore}"},{value:">",text:"L{isAfter}"},q.between,{value:"isToday",text:"L{isToday}",argCount:0},{value:"isTomorrow",text:"L{isTomorrow}",argCount:0},{value:"isYesterday",text:"L{isYesterday}",argCount:0},{value:"isThisWeek",text:"L{isThisWeek}",argCount:0},{value:"isNextWeek",text:"L{isNextWeek}",argCount:0},{value:"isLastWeek",text:"L{isLastWeek}",argCount:0},{value:"isThisMonth",text:"L{isThisMonth}",argCount:0},{value:"isNextMonth",text:"L{isNextMonth}",argCount:0},{value:"isLastMonth",text:"L{isLastMonth}",argCount:0},{value:"isThisYear",text:"L{isThisYear}",argCount:0},{value:"isNextYear",text:"L{isNextYear}",argCount:0},{value:"isLastYear",text:"L{isLastYear}",argCount:0},{value:"isYearToDate",text:"L{isYearToDate}",argCount:0},q.isIncludedIn,q.isNotIncludedIn],boolean:[{value:"isTrue",text:"L{isTrue}",argCount:0},{value:"isFalse",text:"L{isFalse}",argCount:0}],duration:[q.empty,q.notEmpty,q["="],q["!="],q[">"],q["<"],q[">="],q["<="],q.between,q.notBetween,q.isIncludedIn,q.isNotIncludedIn],time:[q.empty,q.notEmpty,q["="],q["!="],q[">"],q["<"],q[">="],q["<="],q.between,q.notBetween,q.isIncludedIn,q.isNotIncludedIn],relation:[q.empty,q.notEmpty,q["="],q["!="],q.isIncludedIn,q.isNotIncludedIn],auto:[{value:"*",text:"L{contains}"}]}),y(ar,"configurable",{fields:null,disabled:!1,readOnly:!1,layout:"vbox",propertyLocked:!1,operatorLocked:!1,filter:null,propertyFieldConfig:null,operatorFieldConfig:null,valueFieldCls:null,triggerChangeOnInput:!0,items:{inputs:{type:"container",layout:"hbox",cls:`${Ye}-inputs`,items:{propertyPicker:{type:"combo",items:{},cls:`${Ye}-property`,placeholder:"L{FieldFilterPicker.selectAProperty}",highlightExternalChange:!1},operatorPicker:{type:"combo",items:{},cls:`${Ye}-operator`,placeholder:"L{FieldFilterPicker.selectAnOperator}",highlightExternalChange:!1},valueFields:{type:"container",cls:`${Ye}-values`,items:{}}}},caseSensitive:{type:"checkbox",text:"L{FieldFilterPicker.caseSensitive}",cls:`${Ye}-case-sensitive`}},operators:ar.defaultOperators,dateFormat:"L{FieldFilterPicker.dateFormat}",store:null,valueFieldPlaceholders:null,getValueFieldConfig:null}),y(ar,"buildOperatorArgCountLookup",i=>z.keyBy(Object.entries(i),([e])=>e,([,e])=>z.keyBy(e,({value:t})=>t,({argCount:t})=>t===void 0?1:t)));var qo=ar;qo.initClass(),qo._$name="FieldFilterPicker";var ki=class extends j{compose(){const{text:i,html:e}=this;return{tag:"label",text:i,html:e}}};y(ki,"$name","Label"),y(ki,"type","label"),y(ki,"configurable",{text:null,localizableProperties:["text"]}),ki.initClass(),ki._$name="Label";var lr=class vn extends Be{afterConstruct(){const e=this;e.validateConfig();const{addFilterButton:t}=e.widgetMap;t.ion({click:"addFilter",thisObj:e}),t.text=e.L(t.text),e.store&&e.updateStore(e.store),super.afterConstruct()}changeDateFormat(e){return this.L(e)}validateConfig(){if(!this.fields&&!this.store)throw new Error("FieldFilterPickerGroup requires either a 'fields' or 'store' config property.")}updateFields(e){this.widgetMap.pickers.childItems.forEach(t=>t.fields=e)}updateFilters(e,t){const r=this;t&&t.filter(n=>!e.find(s=>s.id===n.id)).forEach(n=>{var s;return(s=r.store)==null?void 0:s.removeFilter(n.id)}),e.forEach(n=>n.id=n.id||r.nextFilterId),r.widgetMap.pickers.items=(e==null?void 0:e.map(n=>r.getPickerRowConfig(n)))||[]}changeFilters(e){const{canManageFilter:t}=this;return e&&t?e.filter(r=>this.callback(t,this,[r])):e}updateStore(e){const t=this;t.detachListeners("store"),e&&(t.widgetMap.pickers.childItems.forEach(({widgetMap:{filterPicker:{filter:r,isValid:n}}})=>{e.removeFilter(r.id,!0),n&&e.addFilter(r,!0)}),e.filter(),t.appendFiltersFromStore(),e.ion({name:"store",filter:"onStoreFilter",thisObj:t})),t.widgetMap.pickers.childItems.forEach(r=>r.store=e)}updateShowAddFilterButton(e){this.widgetMap.addFilterButton.hidden=!e}updateAddFilterButtonText(e){this.widgetMap.addFilterButton.text=e!=null?e:vn.addFilterButtonDefaultText}appendFiltersFromStore(){const e=this;e.store.filters.forEach(t=>{var r;const n=e.canManage(t),{property:s,operator:a,id:l}=t;n&&s&&a&&!((r=e.filters)!=null&&r.find(o=>o.id===l))&&e.appendFilter(t)})}canManage(e){const t=this;return!t.canManageFilter||t.callback(t.canManageFilter,t,[e])===!0}getFilterPickerConfig(e){const t=this,{fields:r,store:n,disabled:s,readOnly:a,valueFieldCls:l,operators:o,limitToProperty:u,dateFormat:c,getFieldFilterPickerConfig:d,triggerChangeOnInput:h}=t;return{type:t.constructor.childPickerType,fields:r!=null?r:t.getFieldsFromStore(n),filter:e,store:n,disabled:s,readOnly:a,propertyLocked:!!u,valueFieldCls:l,operators:o,dateFormat:c,internalListeners:{change:"onFilterPickerChange",thisObj:t},flex:1,triggerChangeOnInput:h,...d?t.callback(d,t,[e]):void 0}}getFieldsFromStore(e){var t,r;return Object.fromEntries((r=(t=e.modelClass)==null?void 0:t.fields.map(({name:n,type:s})=>[n,{type:s}]))!=null?r:[])}getPickerRowConfig(e){const t=this,{disabled:r,readOnly:n,canDeleteFilter:s}=t,a=!(s&&t.callback(s,t,[e])===!1);return{type:"container",layout:"box",cls:{[`b-${vn.type}-row`]:!0,[`b-${vn.type}-row-removable`]:a},dataset:{separatorText:t.L("L{FieldFilterPicker.and}")},items:{activeCheckbox:{type:"checkbox",disabled:r,readOnly:n,checked:!e.disabled,internalListeners:{change:"onFilterActiveChange",thisObj:t},cls:`b-${vn.type}-filter-active`},filterPicker:t.getFilterPickerConfig(e),removeButton:{type:"button",ref:"removeButton",disabled:r,readOnly:n,hidden:!a,cls:`b-transparent b-${vn.type}-remove`,icon:"b-fa-trash",internalListeners:{click:"removeFilter",thisObj:t}}}}}get allInputs(){const e=[this.constructor.childPickerType,"button","checkbox"];return this.queryAll(t=>e.includes(t.type))}updateDisabled(e){this.allInputs.forEach(t=>t.disabled=e)}updateReadOnly(e){this.allInputs.forEach(t=>t.readOnly=e)}onFilterActiveChange({source:e,checked:t}){const r=this,n=r.getFilterIndex(e),s=r.filters[n],a=r.getFilterPicker(n);s.disabled=!t,a.onFilterChange(),r.store&&a.isValid&&r.store.addFilter(s,!0),r.updateStoreFilter(),r.triggerChange()}onFilterPickerChange({source:e,filter:t,isValid:r}){const n=this,{store:s}=n,a=n.getFilterIndex(e);s&&(s.removeFilter(t.id,!0),r&&s.addFilter(t,!0),n.updateStoreFilter()),Object.assign(n.filters[a],t),n.triggerChange()}getFilterIndex(e){return this.widgetMap.pickers.childItems.indexOf(e.containingWidget)}getPickerRow(e){return this.widgetMap.pickers.childItems[e]}getFilterPicker(e){return this.getPickerRow(e).widgetMap.filterPicker}get nextFilterId(){return this._nextId=(this._nextId||0)+1,`${this.id}-filter-${this._nextId}`}removeFilter({source:e}){const t=this,r=t.getFilterIndex(e),n=t.filters[r],s=t.getPickerRow(r),a=t.query(l=>l.isFocusable&&l.type!=="container"&&!s.contains(l));a&&a.focus(),t.removeFilterAt(r),t.store&&(t.store.removeFilter(n.id,!0),t.updateStoreFilter()),t.trigger("remove",{filter:n}),t.triggerChange()}addFilter({property:e=null,operator:t=null,value:r=null}={}){var n;const s=this,{filters:a}=s,l={property:s.limitToProperty||e,operator:t,value:r,disabled:!1,id:s.nextFilterId,caseSensitive:!1};s.trigger("beforeAddFilter",{filter:l})&&(s.appendFilter(l),s.getFilterPicker(a.length-1).isValid&&((n=s.store)==null||n.addFilter(l,!0),s.store&&s.updateStoreFilter()),s.trigger("add",{filter:l}),s.triggerChange())}appendFilter(e){const t=this;(!t.limitToProperty||e.property===t.limitToProperty)&&(t.filters.push(e),t.widgetMap.pickers.add(t.getPickerRowConfig(e,t.filters.length-1)))}onStoreFilter(e){const t=this;if(t._isUpdatingStore)return;const{filters:r}=e,n=r.values.reduce((s,a)=>({...s,[a.id]:a}),{});for(let s=t.filters.length-1;s>=0;s--){const a=t.filters[s],l=n[a.id],o=t.getPickerRow(s);if(o){const{filterPicker:u,activeCheckbox:c}=o.widgetMap;if(!l&&u.isValid)t.removeFilterAt(s);else if(l!==void 0){const{operator:d,value:h,property:g,disabled:f,caseSensitive:m}=l;a!==l&&Object.assign(a,{operator:d,value:h,property:g,disabled:f,caseSensitive:m}),u.filter=a,u.onFilterChange(),c.checked=!f}}}t.appendFiltersFromStore(),t.triggerChange()}removeFilterAt(e){const{widgetMap:{pickers:t},filters:r}=this;t.remove(t.childItems[e]),r.splice(e,1),this.triggerChange()}updateStoreFilter(){var e;this._isUpdatingStore=!0,(e=this.store)==null||e.filter(),this._isUpdatingStore=!1}get value(){return this.filters}triggerChange(){const{filters:e}=this,t=e.filter((r,n)=>this.getPickerRow(n).widgetMap.filterPicker.isValid);this.trigger("change",{filters:e,validFilters:t})}activateAll(){this.setAllActiveStatus(!0)}deactivateAll(){this.setAllActiveStatus(!1)}setAllActiveStatus(e){const t=this,{_filters:r,store:n}=t;r.forEach((s,a)=>{if(e===s.disabled){const{filterPicker:l,activeCheckbox:o}=t.getPickerRow(a).widgetMap;s.disabled=!e,l.onFilterChange(),o.checked=e,e&&n&&l.isValid&&n.addFilter(s,!0)}}),t.updateStoreFilter()}focus(){var e;const{length:t}=this._filters;t>0&&((e=this.getPickerRow(t-1))==null||e.widgetMap.filterPicker.focus())}};y(lr,"$name","FieldFilterPickerGroup"),y(lr,"type","fieldfilterpickergroup"),y(lr,"addFilterButtonDefaultText","L{FieldFilterPickerGroup.addFilter}"),y(lr,"configurable",{filters:[],fields:null,disabled:!1,readOnly:!1,layout:"vbox",store:null,limitToProperty:null,valueFieldCls:null,showAddFilterButton:!0,canDeleteFilter:null,getFieldFilterPickerConfig:null,canManageFilter:null,addFilterButtonText:null,triggerChangeOnInput:!0,items:{pickers:{type:"container",layout:"vbox",scrollable:!0,items:{}},addFilterButton:{type:"button",text:lr.addFilterButtonDefaultText,cls:`b-${lr.type}-add-button`,hidden:!0}},operators:null,dateFormat:"L{FieldFilterPicker.dateFormat}"}),y(lr,"childPickerType","fieldfilterpicker");var Ko=lr;Ko.initClass(),Ko._$name="FieldFilterPickerGroup";var Ii=class extends pt.mixin(zo){static get configurable(){return{bodyTag:"fieldset",focusable:!1,inline:null,inlineInternal:null,layout:{type:"box",horizontal:!1}}}static get prototypeProperties(){return{flexRowCls:"b-hbox",flexColCls:"b-vbox"}}get bodyConfig(){const i=super.bodyConfig,{className:e}=i,{inlineInternal:t,hasLabel:r,title:n}=this;return delete i.html,e["b-inline"]=t,e["b-fieldset-has-label"]=r,n&&(i.children={legendElement:{tag:"legend",text:n,class:{"b-fieldset-legend":1}}}),i}compose(){const{inlineInternal:i,label:e,labelCls:t,labelWidth:r}=this;return{class:{"b-field":e,"b-vbox":!i},children:{"labelElement > headerElement":(e||null)&&{tag:"label",html:e,class:{"b-label":1,"b-align-start":1,[t]:t},style:{width:D.unitize("width",r)[1]}}}}}syncInlineInternal(){var i;this.inlineInternal=(i=this.inline)!=null?i:this.label!=null&&this.labelPosition==="before"}updateDisabled(i,e){super.updateDisabled(i,e),this.eachWidget(t=>{t.disabled=i},!1)}updateInline(){this.syncInlineInternal()}updateInlineInternal(i){this.layout.horizontal=i}updateLabel(){this.syncInlineInternal()}updateLabelPosition(){this.syncInlineInternal()}};y(Ii,"$name","FieldSet"),y(Ii,"type","fieldset"),Ii.initClass(),Ii._$name="FieldSet";var ns=class extends De{static get configurable(){return{multiple:null,accept:null,inputType:"file",attributes:["multiple","accept"]}}get files(){return this.input.files}pickFile(){this.input.click()}get multiple(){return this._multiple?"":null}clear(){this.input.value=null}triggerChange(i){this.triggerFieldChange({event:i,value:this.input.value,oldValue:this._lastValue,userAction:!0,valid:!0})}};y(ns,"$name","FileField"),y(ns,"type","filefield"),ns.initClass(),ns._$name="FileField";var ss=class extends Be{static get defaultConfig(){return{defaultBindProperty:"value",buttonConfig:null,fileFieldConfig:null}}construct(i={}){const e=this;i.items=[Object.assign({type:"button",ref:"fileButton",text:"L{FilePicker.file}",localeClass:this},i.buttonConfig),Object.assign({type:"filefield",ref:"fileField",style:"display: none"},i.fileFieldConfig)].concat(i.items||[]),super.construct(i),e.button.ion({click:e.onButtonClick,thisObj:e}),e.fileField.ion({change:e.onFileFieldChange,thisObj:e}),e._thisIsAUsedExpression(e.fileTip)}get button(){return this.widgetMap.fileButton}get fileField(){return this.widgetMap.fileField}get files(){return this.fileField.files}get fileTip(){const i=this;return i._fileTip||(i._fileTip=new je({cls:"b-file-tip",forElement:i.button.element,showOnHover:!0,align:"b-t",scrollAction:"realign",internalListeners:{beforeshow(){const e=this,t=i.files;return t&&t.length?(e.html=`${Array.from(t).map(r=>r.name).join("<br>")}`,!0):!1}}}))}clear(){const i=this;i.fileField.clear(),i.button.badge="",i.trigger("clear")}onButtonClick({event:i}){this.fileField.pickFile(),i.preventDefault()}onFileFieldChange({valid:i}){const e=this;e.button.badge=e.files.length||"",e.triggerFieldChange({files:e.files,valid:i})}};y(ss,"$name","FilePicker"),y(ss,"type","filepicker"),ss.initClass(),ss._$name="FilePicker";var or=class extends vt{static get configurable(){return{field:null,store:null,filterFunction:null,clearable:!0,revertOnEscape:!0,ignoreParentReadOnly:!0,keyStrokeChangeDelay:100,onChange({value:i}){const{store:e,field:t,filterFunction:r}=this;if(e){const n=`${t||this.id}-Filter`;if(i.length===0)e.removeFilter(n);else{let s;r?s=a=>r(a,i):(i=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=a=>{var l;return(l=a.getValue(t))==null?void 0:l.match(new RegExp(i,"i"))}),e.filter({id:n,filterBy:s})}}}}}updateValue(i,e){super.updateValue(i,e),i&&this.isConfiguring&&this.onChange({value:i})}};y(or,"$name","FilterField"),y(or,"type","filterfield"),or.initClass(),or._$name="FilterField";var Vf=[{ref:"cancelButton",cls:"b-messagedialog-cancelbutton b-gray",text:"L{Object.Cancel}",onClick:"up.onCancelClick"},{ref:"okButton",cls:"b-messagedialog-okbutton b-raised b-blue",text:"L{Object.Ok}",onClick:"up.onOkClick"}];U.isWindows&&Vf.reverse();var Go=class Tm extends _r{static get configurable(){return{centered:!0,modal:!0,hidden:!0,autoShow:!1,closeAction:"hide",title:"\xA0",lazyItems:{$config:["lazy"],value:[{cls:"b-messagedialog-message",ref:"message"},{type:"textfield",cls:"b-messagedialog-input",ref:"input"}]},showClass:null,bbar:{overflow:null,items:Vf}}}construct(){this.okButton=this.yesButton=1,this.cancelButton=3,super.construct(...arguments)}destroy(){}async confirm(){return this.showDialog("confirm",...arguments)}async alert(){return this.showDialog("alert",...arguments)}async prompt({textField:e}){const t=this.widgetMap.input;return j.reconfigure(t,e),t.value="",this.showDialog("prompt",...arguments)}showDialog(e,{message:t="",title:r="\xA0",cancelButton:n,okButton:s,rootElement:a=document.body}){const l=this;return l.rootElement=a,l.getConfig("lazyItems"),l.title=l.optionalL(r),l.widgetMap.message.html=l.optionalL(t),l.showClass=`b-messagedialog-${e}`,s&&(s=typeof s=="string"?{text:s}:s),n&&(n=typeof n=="string"?{text:n}:n),s=Object.assign({},l.widgetMap.okButton.initialConfig,s),n=Object.assign({},l.widgetMap.cancelButton.initialConfig,n),s.text=l.optionalL(s.text),n.text=l.optionalL(n.text),j.reconfigure(l.widgetMap.okButton,s),j.reconfigure(l.widgetMap.cancelButton,n),l.show(),l.promise=new Promise(o=>{l.resolve=o})}show(){const e=D.getActiveElement(this.element);return this.owner=this.element.contains(e)?null:Tm.fromElement(document.activeElement),super.show(...arguments)}updateShowClass(e,t){const{classList:r}=this.element;t&&r.remove(t),e&&r.add(e)}doResolve(e){const t=this,{resolve:r}=t;if(r){const n=t.showClass==="b-messagedialog-prompt";if(n&&e===t.okButton&&!t.widgetMap.input.isValid)return;t.resolve=t.reject=t.promise=null,r(n?{button:e,text:t.widgetMap.input.value}:e),t.hide()}}onInternalKeyDown(e){e.key==="Escape"?(e.stopImmediatePropagation(),this.onCancelClick()):e.key==="Enter"&&!e.target.closest(".b-button")&&(e.stopImmediatePropagation(),e.preventDefault(),this.onOkClick()),super.onInternalKeyDown(e)}onOkClick(){this.doResolve(Xo.okButton)}onCancelClick(){this.doResolve(Xo.cancelButton)}};y(Go,"$name","MessageDialog"),y(Go,"type","messagedialog");var jf=Go;jf.initClass();var Xo=new Proxy({},{get(i,e){const t=i.instance||(i.instance=new jf({rootElement:document.body})),r=t[e];return typeof r=="function"?r.bind(t):r}}),_C=Xo,as=class extends Un{static get defaultConfig(){return{store:null,defaults:{localeClass:this},items:{firstPageButton:{onClick:"up.onFirstPageClick",icon:"b-icon-first",weight:100,tooltip:"L{PagingToolbar.firstPage}"},previousPageButton:{onClick:"up.onPreviousPageClick",icon:"b-icon-previous",weight:110,tooltip:"L{PagingToolbar.prevPage}"},pageNumber:{type:"numberfield",label:"L{page}",min:1,max:1,triggers:null,onChange:"up.onPageNumberChange",highlightExternalChange:!1,weight:120},pageCount:{type:"widget",cls:"b-pagecount b-toolbar-text",weight:130},nextPageButton:{onClick:"up.onNextPageClick",icon:"b-icon-next",weight:140,tooltip:"L{PagingToolbar.nextPage}"},lastPageButton:{onClick:"up.onLastPageClick",icon:"b-icon-last",weight:150,tooltip:"L{PagingToolbar.lastPage}"},separator:{type:"widget",cls:"b-toolbar-separator",weight:151},reloadButton:{onClick:"up.onReloadClick",icon:"b-icon-reload",weight:160,tooltip:"L{PagingToolbar.reload}"},spacer:{type:"widget",cls:"b-toolbar-fill",weight:161},dataSummary:{type:"widget",cls:"b-toolbar-text",weight:170}}}}set parent(i){super.parent=i,this.store||(this.store=i.store)}get parent(){return super.parent}set store(i){const e=this;e.detachListeners("store"),e._store=i,i&&(i.ion({name:"store",beforerequest:"onStoreBeforeRequest",afterrequest:"onStoreChange",change:"onStoreChange",thisObj:e}),i.isLoading&&e.onStoreBeforeRequest())}get store(){return this._store}onStoreBeforeRequest(){this.eachWidget(i=>i.disable())}updateLocalization(){this.updateSummary(),super.updateLocalization()}updateSummary(){const i=this,{pageCount:e,dataSummary:t}=i.widgetMap;let r=0,n=0,s=0,a=0,l=0;if(i.store){const{store:o}=i,{pageSize:u,currentPage:c}=o;r=o.count,n=o.lastPage,l=o.allCount,s=Math.max(0,(c-1)*u+1),a=Math.min(l,s+u-1)}e.html=i.L("L{pageCountTemplate}")({lastPage:n}),t.html=r?i.L("L{summaryTemplate}")({start:s,end:a,allCount:l}):i.L("L{noRecords}")}onStoreChange(){const i=this,{widgetMap:e,store:t}=i,{count:r,lastPage:n,currentPage:s}=t,{pageNumber:a,pageCount:l,firstPageButton:o,previousPageButton:u,nextPageButton:c,lastPageButton:d,dataSummary:h}=e;i.eachWidget(g=>g.enable()),a.value=s,a.max=n,h.disabled=a.disabled=l.disabled=!r,o.disabled=u.disabled=s<=1||!r,c.disabled=d.disabled=s>=n||!r,i.updateSummary()}onPageNumberChange({value:i}){this.store.currentPage!==i&&this.store.loadPage(i)}onFirstPageClick(){this.store.loadPage(1)}onPreviousPageClick(){this.store.previousPage()}onNextPageClick(){this.store.nextPage()}onLastPageClick(){this.store.loadPage(this.store.lastPage)}onReloadClick(){this.store.loadPage(this.store.currentPage)}};y(as,"$name","PagingToolbar"),y(as,"type","pagingtoolbar"),as.initClass(),as._$name="PagingToolbar";var{dockIsHorz:OC}=It.maps,AC={top:0,down:0,left:1,bottom:2,up:2,right:3},Zo={up:{from:"translate(0,0)",to:"translate(0,-100%)"},down:{from:"translate(0,0)",to:"translate(0,100%)"},left:{from:"translate(0,0)",to:"translate(-100%,0)"},right:{from:"translate(0,0)",to:"translate(100%,0)"}},ls=class extends It.mixin(xe){static get configurable(){return{autoCloseDelay:1e3,autoClose:!0,revealing:{value:null,$config:null,default:!1},recollapseTool:{type:"collapsetool",cls:"b-recollapse",collapsify:"overlay",handler(){var i;(i=this.collapsible)==null||i.toggleReveal()}}}}static get delayable(){return{doAutoClose:0}}doAutoClose(){this.toggleReveal(!1)}updateAutoCloseDelay(i){const{doAutoClose:e}=this;(e.suspended=i==null||i<0)||(e.delay=i,e.immediate=!i)}changeRecollapseTool(i){const e=this,{panel:t}=e;if(e.isConfiguring||e.isDestroying||!t||t.isDestroying)return i;t.tools={recollapse:i}}beforeCollapse(i){if(super.beforeCollapse(i)===!1)return!1;this.panel.revealed&&(i.animation=null)}applyHeaderDock(i,e=!0){var t;(t=this.panel)==null||t.recompose(),super.applyHeaderDock(i,e)}collapseBegin(i){const e=this,{collapseDir:t,innerElement:r}=e,{animation:n}=i,{collapseTool:s,panel:a}=e;e.configuredWidth=a._lastWidth,e.configuredHeight=a._lastHeight,e.applyHeaderDock(!0),e.lockInnerSize(),s==null||s.element.classList.add("b-collapsed"),n&&(a.element.classList.add("b-collapsing"),n.element=r,n.transform=Zo[t],i.animation=Ae.run(n))}onComplete(i){var e,t;super.onComplete(i);const r=this,{panel:n}=r,{element:s}=n;r.autoCloseLeaveDetacher=(e=r.autoCloseLeaveDetacher)==null?void 0:e.call(r),r.autoCloseClickDetacher=(t=r.autoCloseClickDetacher)==null?void 0:t.call(r),r.doAutoClose.cancel(),i==="reveal"&&r.autoClose&&(n.containsFocus&&(r.autoCloseLeaveDetacher=$.on({element:s,mouseenter:a=>{r.doAutoClose.cancel()},mouseleave:a=>{r.doAutoClose()}})),r.autoCloseClickDetacher=$.on({element:document.body,thisObj:n,mousedown:a=>{var l;!n.owns(a)&&!((l=r.revealer)!=null&&l.contains(a.target))&&r.autoCloseDelay!=null&&r.doAutoClose.now()}}))}expandBegin(i){const e=this,{animation:t}=i,{collapseDir:r,collapseTool:n,innerElement:s,panel:a}=e,{element:l}=a;l.classList.remove("b-collapsed","b-collapsing"),e.restoreConfiguredSize(),e.lockInnerSize(!1),e.lockInnerSize(),n==null||n.element.classList.remove("b-collapsed"),t&&(l.classList.add("b-collapsed","b-expanding"),t.element=s,t.transform={from:Zo[r].to,to:Zo[r].from},i.animation=Ae.run(t))}expandEnd(i){super.expandEnd(i);const{panel:e}=this;i.completed&&(e.revealed=!1),e.element.classList.remove("b-expanding")}expandRevert(i){super.expandRevert(i),this.panel.element.classList.add("b-expanding")}get innerElement(){return this.panel.overlayElement}get innerSizeElement(){return this.panel.element}get toolsConfig(){const i=this,{direction:e}=i,t=super.toolsConfig,r=i.recollapseTool;return r?{...t,recollapse:r&&x.assign({direction:e.toLowerCase()},r)}:t}lockInnerSize(i=!0){const e=this,{panel:t}=e,r=i&&t.rectangle(),n=i?[0,0,0,0]:"",s=super.lockInnerSize(i);return i&&(n[AC[e.collapseDir]]=`-${r[e.collapseDim]+10}px`),t.element.style.clipPath=i?`inset(${n.join(" ")})`:"",s}onOverlayTransitionDone(i){const e=this,{panel:t}=e;i.srcElement===t.overlayElement&&e.revealing&&(e.revealing=!1,e.onComplete(t.revealed?"reveal":"unreveal"))}onRevealerClick(){this.toggleReveal()}toggleReveal(i){const{panel:e}=this,{element:t}=e;e.collapsed&&(this.revealer=D.getActiveElement(t),i==null&&(i=!e.revealed),e.revealed!==i&&e.trigger("beforeToggleReveal",{reveal:i})!==!1&&(!i&&t.contains(this.revealer)&&e.revertFocus(!0),this.revealing=!0,e.revealed=i))}updateRevealing(i){const e=this,t=/left|right/i,{panel:r}=e,n=t.test(e.collapseDir)?"height":"width";r&&(e.innerElement.style[n]="0px",e.innerElement.style[`min-${n}`]="100%",r.element.classList[i?"add":"remove"]("b-panel-overlay-revealing"))}wrapCollapser(i,e){var t;const r=this,{collapseDir:n,panel:s}=r,{expandedHeaderDock:a,header:l,uiClassList:o}=s,u=(t=s.tools)==null?void 0:t.recollapse,[c,d]=r.splitHeaderItems({as:"element",dock:r.collapseDock}),h=OC[a],g=s.hasHeader?s.title||(l==null?void 0:l.title)||"\xA0":null;return u&&(u.direction=n),["overlayElement",{class:{...o,[`b-panel-overlay-header-${a}`]:1,[`b-panel-overlay-${n}`]:1,[`b-${h?"h":"v"}box`]:1,"b-panel-overlay":1,"b-box-center":1},listeners:{transitionend:f=>r.onOverlayTransitionDone(f),transitioncancel:f=>r.onOverlayTransitionDone(f)},children:{overlayHeaderElement:g&&{tag:"header",class:new J({...o,[`b-dock-${a}`]:1,"b-panel-header":1,"b-panel-overlay-header":1},l==null?void 0:l.cls),children:[...c,{reference:"overlayTitleElement",html:g,class:{...o,[`b-align-${(l==null?void 0:l.titleAlign)||"start"}`]:1,"b-header-title":1}},...d]},[i]:e}}]}};y(ls,"$name","PanelCollapserOverlay"),y(ls,"type","overlay"),ls.initClass(),ls._$name="PanelCollapserOverlay";var Mi=class extends De{construct(i={}){i.inputType="password",super.construct(...arguments),this.element.classList.add("b-textfield")}};y(Mi,"$name","PasswordField"),y(Mi,"type","passwordfield"),y(Mi,"alias","password"),Mi.initClass(),Mi._$name="PasswordField";var Ri=class extends rr{static get configurable(){return{inputType:"radio",clearable:null,uncheckedValue:void 0}}get textLabelCls(){return super.textLabelCls+" b-radio-label"}internalOnClick(i){super.internalOnClick(i)!==!1&&this.checked&&this.clearable&&(this.checked=!1)}updateName(i){this.toggleGroup=i}updateClearable(){}};y(Ri,"$name","Radio"),y(Ri,"type","radio"),y(Ri,"alias","radiobutton"),Ri.initClass(),Ri._$name="Radio";var os=class extends Ii{static get configurable(){return{defaultType:"radio",clearable:null,name:null,options:{value:null,$config:{merge:"items"}},defaultBindProperty:"value"}}get existingOptions(){const{name:i}=this;return this.ensureItems().filter(e=>e.name===i)}get refPrefix(){return`${this.name||this.ref||this.id}_`}get selected(){return this.existingOptions.filter(i=>i.input.checked)[0]||null}get value(){const{selected:i}=this;return i?i.checkedValue:null}set value(i){this.existingOptions.forEach(e=>{e.isConfiguring=this.isConfiguring,e.checked=e.checkedValue===i,e.isConfiguring=!1})}ensureItems(){return this.getConfig("options"),super.ensureItems()}changeOptions(i,e){if(!(i&&e&&x.isDeeplyEqual(e,i)))return i}convertOption(i,e,t){const r=this,{name:n}=r,s={name:n,type:"radio",value:i===r.value,ref:`${r.refPrefix}${i}`,checkedValue:i};return typeof e=="string"?s.text=e:x.assign(s,e),t?j.reconfigure(t,s):s}isOurRadio(i){return i.isRadio&&i.name===this.name}isolateFieldChange(i){return this.isOurRadio(i)}onChildAdd(i){super.onChildAdd(i),this.isOurRadio(i)&&i.ion({name:i.id,beforeChange:"onRadioItemBeforeChange",change:"onRadioItemChange",click:"onRadioClick",thisObj:this})}onChildRemove(i){this.isOurRadio(i)&&this.detachListeners(i.id),super.onChildRemove(i)}onRadioClick(i){const{source:e}=i;e.checked&&this.clearable&&e.clearable==null&&(e.checked=!1)}onRadioItemBeforeChange(i){if(i.checked){const e=this,{lastValue:t}=e;if(!e.reverting&&e.trigger("beforeChange",e.wrapRadioEvent(i))===!1&&t!=null&&t!==e.value)return e.reverting=!0,i.source.uncheckToggleGroupMembers(),e.value=t,e.lastValue=t,e.reverting=!1,!1}}onRadioItemChange(i){const e=this;i.checked&&!e.reverting&&(e.triggerFieldChange(e.wrapRadioEvent(i)),e.lastValue=e.value)}wrapRadioEvent(i){return{from:i,item:i.source,userAction:i.userAction,lastValue:this.lastValue,value:this.value}}updateOptions(){const i=this,{options:e,refPrefix:t}=i,r=i.existingOptions.reduce((o,u)=>(o[u.ref.substring(t.length)]=u,o),{});let n=0,s,a;if(e)for(s in e)a=i.convertOption(s,e[s],r[s]),delete r[s],i.insert(a,n++);const l=Object.values(r);l!=null&&l.length&&(i.remove(l),l.forEach(o=>o.destroy()))}};y(os,"$name","RadioGroup"),y(os,"type","radiogroup"),os.initClass(),os._$name="RadioGroup";var PC={ArrowUp:1,ArrowDown:1,ArrowLeft:1,ArrowRight:1},_i=class extends j{static get configurable(){return{text:null,showValue:!0,showTooltip:!1,min:0,max:100,step:1,value:50,unit:null,thumbSize:20,tooltip:{$config:["lazy","nullify"],value:{type:"tooltip",align:"b-t",anchor:!1,axisLock:!0}},localizableProperties:["text"],triggerChangeOnInput:null,defaultBindProperty:"value"}}compose(){const{id:i,min:e,max:t,showValue:r,step:n,text:s,value:a,unit:l="",disabled:o}=this,u=`${i}-input`,c=!!(s||r);return{class:{"b-has-label":c,"b-text":c,"b-disabled":o},children:{input:{tag:"input",type:"range",id:u,reference:"input",[o?"disabled":""]:o,min:e,max:t,step:n,value:a,listeners:{input:"onInternalInput",change:"onInternalChange",mouseover:"onInternalMouseOver",mouseout:"onInternalMouseOut"}},label:{tag:"label",for:u,html:r?s?`${s} (${a}${l})`:a+l:s}}}}get focusElement(){return this.input}get percentProgress(){return(this.value-this.min)/(this.max-this.min)*100}onInternalKeyDown(i){!this.readOnly&&PC[i.key]&&i.stopImmediatePropagation()}onInternalChange(){this.updateUI(),this.triggerChange(!0),this.trigger("action",{value:this.value})}onInternalInput(){const i=this;if(i.readOnly){i.input.value=i.value;return}i.value=parseInt(i.input.value,10),i.trigger("input",{value:i.value}),i.triggerChangeOnInput&&i.triggerChange(i)}onInternalMouseOver(){var i;const e=this,t=e.rtl?100-e.percentProgress:e.percentProgress;(i=e.tooltip)==null||i.showBy({target:V.from(e.input).inflate(e.thumbSize/2,-e.thumbSize/2),align:`b-t${Math.round(t)}`})}onInternalMouseOut(){var i;(i=this.tooltip)==null||i.hide()}triggerChange(i){this.triggerFieldChange({value:this.value,valid:!0,userAction:i})}updateMax(i){const e=this;e.input&&e._value>i&&(e.value=i,e.trigger("input",{value:e.value}))}updateMin(i){const e=this;e.input&&e._value<i&&(e.value=i,e.trigger("input",{value:e.value}))}changeTooltip(i,e){var t;return i&&(i.owner=this),this.showTooltip?je.reconfigure(e,i,{owner:this,defaults:{forElement:this.input,html:String(this.value)+((t=this.unit)!=null?t:"")}}):null}changeValue(i){const e=this,{min:t,step:r}=e;return i=Math.min(Math.max(i,t),e.max),i>t?t+x.roundTo(i-t,r):x.roundTo(i,r)}updateValue(i){var e;const t=this,{input:r,_tooltip:n}=t;n&&(n.html=t.value+((e=t.unit)!=null?e:"")),r&&r.value!==String(i)&&(r.value=i,t.triggerChange(!1)),t.updateUI()}updateUI(){var i,e;const t=this;(i=t._tooltip)!=null&&i.isVisible&&((e=t._tooltip)==null||e.alignTo({target:V.from(t.input).inflate(t.thumbSize/2,-t.thumbSize/2),align:`b-t${Math.round(t.percentProgress)}`}))}};y(_i,"$name","Slider"),y(_i,"type","slider"),_i.initClass(),_i._$name="Slider";var us=class extends rr{static get properties(){return{toggledCls:"b-slidetoggle-checked"}}construct(i){i.checked&&(i.cls=J.from(i.cls)||{},i.cls[this.constructor.properties.toggledCls]=1),super.construct(i)}get innerElements(){const i=super.innerElements;return i.splice(1,0,this.toggleElement),this.text?i[i.length-1].class="b-slidetoggle-label":i.pop(),i}get toggleElement(){return{class:"b-slidetoggle-toggle",reference:"slideToggle",children:[{class:"b-slidetoggle-thumb",reference:"slideThumb"}]}}internalOnChange(){super.internalOnChange(),this.element.classList[this.value?"add":"remove"](this.toggledCls)}};y(us,"$name","SlideToggle"),y(us,"type","slidetoggle"),us.initClass(),us._$name="SlideToggle";var zf=["b-horizontal","b-vertical"],Jo=i=>D.getStyleValue(i.parentElement,"display")==="flex"&&(parseInt(D.getStyleValue(i,"flex-basis"),10)||parseInt(D.getStyleValue(i,"flex-grow"),10)),FC={horizontal:!1,vertical:!0},cs=class extends j{static get configurable(){return{orientation:"auto",vertical:null,containerElement:{$config:"nullify",value:null},nextNeighbor:{$config:"nullify",value:null},previousNeighbor:{$config:"nullify",value:null}}}static get delayable(){return{syncState:"raf"}}doDestroy(){var i;(i=this.mouseDetacher)==null||i.call(this),super.doDestroy()}compose(){return{class:{"b-splitter":1},listeners:{pointerdown:"onMouseDown",mouseenter:"syncState",...!U.supportsPointerEvents&&{mousedown:"onMouseDown",touchstart:"onMouseDown"}}}}get currentOrientation(){return this.vertical?"vertical":"horizontal"}getSibling(i=!0){let{element:e}=this,t;for(;!t&&(e=e[`${i?"next":"previous"}ElementSibling`]);)(!e.isConnected||D.isVisible(e))&&(t=e);return t}get nextWidget(){let{element:i}=this,e;for(;!e&&(i=i.nextElementSibling);)e=j.fromElement(i,this.element.parentElement);return e}get previousWidget(){let{element:i}=this,e;for(;!e&&(i=i.previousElementSibling);)e=j.fromElement(i,this.element.parentElement);return e}updateContainerElement(i){var e;const t=this;t.stateDetector=(e=t.stateDetector)==null?void 0:e.disconnect(),i&&(t.stateDetector=new MutationObserver(()=>t.syncState()),t.stateDetector.observe(i,{attributes:!0,childList:!0}))}updateNextNeighbor(i){this.watchNeighbor(i,"next")}updatePreviousNeighbor(i){this.watchNeighbor(i,"previous")}watchNeighbor(i,e){this.detachListeners(e),i==null||i.ion({name:e,thisObj:this,collapse:"syncState",expand:"syncState",hide:"syncState",show:"syncState"})}updateOrientation(){this.syncState.now()}updateVertical(i){var e;const t=(e=this.element)==null?void 0:e.classList;t==null||t.add(zf[i?1:0]),t==null||t.remove(zf[i?0:1])}syncState(){var i;const e=this,{element:t,nextWidget:r,previousWidget:n}=e;let s=(i=FC[e.orientation])!=null?i:null;if(e.nextNeighbor=r,e.previousNeighbor=n,e.disabled=r&&(r.collapsible&&r.collapsed||r.hidden)||n&&(n.collapsible&&n.collapsed||n.hidden),s!==null&&r&&n)e.containerElement=null;else if(e.containerElement=t.parentElement,e.rendered&&t.offsetParent){const a=D.getStyleValue(t.parentElement,"flex-direction");if(a)s=!a.startsWith("column");else{const l=t.previousElementSibling,o=t.nextElementSibling;if(!l||!o)return;const u=l.getBoundingClientRect(),c=o.getBoundingClientRect(),d=u.top<c.top?u:c,h=d===c?u:c;s=d.top===h.top}}e.vertical=s}onMouseDown(i){var e;i.preventDefault(),i.touches&&(i=i.touches[0]);const t=this,{element:r,nextNeighbor:n,previousNeighbor:s}=t,a=s?s.element:t.getSibling(!1),l=n?n.element:t.getSibling(),o=Jo(a),u=Jo(l),c=[];(e=t.mouseDetacher)==null||e.call(t);for(const h of r.parentElement.children)Jo(h)&&h!==r&&c.push({element:h,width:h.offsetWidth,height:h.offsetHeight});t.context={startX:i.pageX,startY:i.pageY,prevWidth:a.offsetWidth,prevHeight:a.offsetHeight,nextWidth:l.offsetWidth,nextHeight:l.offsetHeight,prevHasFlex:o,nextHasFlex:u,flexed:c,prev:a,next:l};const d={element:document,pointermove:"onMouseMove",pointerup:"onMouseUp",thisObj:t};U.supportsPointerEvents||(d.mousemove=d.touchmove="onMouseMove",d.mouseup=d.touchend="onMouseUp"),r.classList.add("b-moving"),t.mouseDetacher=$.on(d),t.trigger("splitterMouseDown",{event:i})}onMouseMove(i){const e=this,{context:t,nextWidget:r,previousWidget:n}=e,s=t.prev.style,a=t.next.style,l=(i.pageX-t.startX)*(e.rtl?-1:1),o=i.pageY-t.startY;if(i.preventDefault(),Object.assign(t,{deltaX:l,deltaY:o}),t.started||(t.started=!0,e.trigger("dragStart",{context:t,event:i}),t.flexed.forEach(u=>{u.element.style.flexGrow=e.vertical?u.width:u.height,u.element.style.flexBasis="0"})),e.vertical){const u=t.prevWidth+l,c=t.nextWidth-l;t.prevHasFlex?s.flexGrow=u:n?n.width=u:s.width=`${u}px`,t.nextHasFlex?a.flexGrow=c:r?r.width=c:a.width=`${c}px`}else{const u=t.prevHeight+o,c=t.nextHeight-o;t.prevHasFlex?s.flexGrow=u:n?n.height=u:s.height=`${u}px`,t.nextHasFlex?a.flexGrow=c:r?r.height=c:a.height=`${c}px`}e.trigger("drag",{context:t,event:i})}onMouseUp(i){var e;const t=this;(e=t.mouseDetacher)==null||e.call(t),t.mouseDetacher=null,t.element.classList.remove("b-moving"),t.context.started&&t.trigger("drop",{context:t.context,event:i}),t.context=null}render(){super.render(...arguments),this.syncState.now(),this.vertical===null&&this.syncState()}};y(cs,"$name","Splitter"),y(cs,"type","splitter"),cs.initClass(),cs._$name="Splitter";var Oi=class extends mt{static get configurable(){return{active:null,index:null,isFirst:null,isLast:null,item:{value:null,$config:"nullify"},itemCls:null,tabPanel:null,titleProperty:"text",titleSource:"title",role:"tab"}}compose(){const{active:i,cls:e,index:t,isFirst:r,isLast:n}=this,s=this.owner.visibleChildCount;return{tabindex:0,"aria-selected":i,"aria-setsize":s,"aria-posinset":t+1,class:{"b-tabpanel-tab":1,"b-active":i,"b-tab-first":r,"b-tab-last":n,...e},dataset:{index:t}}}updateIndex(i){this.isFirst=!i}updateItem(i,e){var t,r;const n=this;(e==null?void 0:e.tab)===n&&(e.tab=null),i&&(i.tab=n,n[n.titleProperty]=i[n.titleSource],n.itemCls=i.cls,n.ariaElement.setAttribute("aria-controls",i.id),i.role="tabpanel"),(t=n.itemChangeDetacher)==null||t.call(n),n.itemChangeDetacher=i&&ue.after(i,"onConfigChange","onItemConfigChange",n,{return:!1}),(r=n.itemHideDetacher)==null||r.call(n),n.itemHideDetacher=i==null?void 0:i.ion({beforeChangeHidden:"onItemBeforeChangeHidden",beforeHide:"onItemBeforeHide",beforeUpdateDisabled:"onItemBeforeUpdateDisabled",thisObj:n,prio:1e3}),n.syncMinMax()}updateItemCls(i,e){const{element:t}=this,r=t&&J.from(t==null?void 0:t.classList,!0);t&&(r.remove(e).add(i),t.className=r.value)}updateRotate(i,e){!i!=!e&&this.syncMinMax()}syncMinMax(){const i=this,{rotate:e,tabPanel:t}=i;let{_minWidth:r,_minHeight:n,_maxWidth:s,_maxHeight:a}=i;if(t){const{tabMinWidth:l,tabMaxWidth:o}=t;l!=null&&(e?(r===l&&(r=null),n=l):(n===l&&(n=null),r=l)),o!=null&&(e?(s===o&&(s=null),a=o):(a===o&&(a=null),s=o)),i.minWidth=r,i.minHeight=n,i.maxWidth=s,i.maxHeight=a}}onItemBeforeChangeHidden({source:i,hidden:e}){if(!i.$isDeactivating&&!i.$isActivating){const{tabPanel:t}=this;this.hidden=e,e&&i===t.activeItem&&t.activateAvailableTab(i)}}onItemBeforeHide(){this.item.$isDeactivating||this.hide()}onItemBeforeUpdateDisabled({source:i,disabled:e}){const{tabPanel:t}=this;this.disabled=e,i===t.activeItem&&t.activateAvailableTab(i)}onItemConfigChange({name:i,value:e}){i===this.titleSource&&(this[this.titleProperty]=e)}};y(Oi,"$name","Tab"),y(Oi,"type","tab"),Oi.initClass(),Oi._$name="Tab";var Na=i=>i.isTab,ds=class extends Un{static get configurable(){return{defaultType:"tab",overflow:"scroll",role:"tablist",ignoreParentReadOnly:!0}}get firstTab(){return this.tabAt(0)}get lastTab(){return this.tabAt(-1)}get tabCount(){return this._items.countOf(Na)}get tabs(){return z.from(this._items,Na)}compose(){return{children:{toolbarContent:{class:{"b-tabpanel-tabs":1}}}}}indexOfTab(i){return this._items.indexOf(i,Na)}onChildAdd(i){super.onChildAdd(i),i.index==null&&this.syncTabs()}onChildRemove(i){super.onChildRemove(i),this.syncTabs()}onFocusIn(){const{activeIndex:i}=this.owner;isNaN(i)||this.tabs[i].focus()}syncTabs(){const{tabs:i}=this;for(let e=0,t=i.length;e<t;++e)i[e].index=e,i[e].isFirst=!e,i[e].isLast=e===t-1}tabAt(i){return this._items.find(Na,i)||null}};y(ds,"$name","TabBar"),y(ds,"type","tabbar"),ds.initClass(),ds._$name="TabBar";var Ba=["b-slide-out-left","b-slide-out-right","b-slide-in-left","b-slide-in-right"],hs=class extends gt{onChildAdd(i){super.onChildAdd(i);const e=this,{activeItem:t,owner:r}=e,n=r.activeIndex!=null?r.activeIndex:e.activeIndex||0,s=r.items.indexOf(i),a=t!=null?i===t:s===n;i.ion({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:e}),a?(e._activeIndex=s,e._activeItem=i,i.show()):(i.$isDeactivating=!0,i.hide(),i.$isDeactivating=!1)}onChildRemove(i){super.onChildRemove(i);const e=this;e._activeItem===i&&e.activateSiblingOf(i),e._activeIndex=e.owner.items.indexOf(e._activeItem),i.un({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:e})}onBeforeChildShow({source:i}){if(!this.owner.isConfiguring&&!i.$isActivating)return this.activeItem=i,!1}onBeforeChildHide({source:i}){if(!this.owner.isConfiguring&&!i.$isDeactivating)return this.activateSiblingOf(i),!1}activateSiblingOf(i){const{owner:e}=this,t=e.items.slice(),r=t.indexOf(i);t.splice(r,1),this.activeIndex=Math.min(r,t.length-1)}setActiveItem(i,e=this.activeIndex,t){var r;const n=this,{owner:s}=n,{items:a}=s,l=i instanceof j,o=a[e],u=s.items[i=l?a.indexOf(i):parseInt(i,10)],c=(t==null?void 0:t.animation)!==!1,d=!(t!=null&&t.silent),h={prevActiveIndex:e,prevActiveItem:o};if(u&&!u.$isActivating&&u!==o){const g=o&&o.element,f=u&&u.element;if(n.animateDetacher){const p=n.animateDetacher.event;if(p.activeItem===u)return p.promise;n.animateDetacher(),p.prevActiveItem.element.classList.remove(...Ba),p.activeItem.element.classList.remove(...Ba),n.animateDetacher=null}if(h.activeIndex=i,h.activeItem=u,d&&s.trigger("beforeActiveItemChange",h)===!1)return null;const m=n._activeIndex!==h.activeIndex;m&&(n._activeIndex=h.activeIndex),d&&((r=s.onBeginActiveItemChange)==null||r.call(s,h)),m&&(n._activeIndex=h.prevActiveIndex),c&&g&&s.isVisible&&n.animateCardChange?h.promise=n.cardChangeAnimation=new Promise((p,v)=>{const b=o.monitorResize;o.monitorResize=!1,n.contentElement.style.overflowX="hidden",o._hidden=!0,u.$isActivating=!0,u.show(),u.$isActivating=!1,g.classList.add(i>e?"b-slide-out-left":"b-slide-out-right"),f.classList.add(i<e?"b-slide-in-left":"b-slide-in-right"),s.isAnimating=!0,n.animateDetacher=$.onTransitionEnd({mode:"animation",element:f,thisObj:o,handler(){if(s.isAnimating=n.cardChangeAnimation=!1,!n.animateDetacher){n.setActiveItem(i,e,t);return}n.animateDetacher=null,f.classList.remove(...Ba),g&&(g.classList.remove(...Ba),o.$isDeactivating=!0,o._hidden=!1,o.hide(),o.monitorResize=b,o.$isDeactivating=!1),n.contentElement.style.overflowX="",n.onActiveItemChange(h,p,!d)}}),n.animateDetacher.reject=v,n.animateDetacher.event=h}):(u.$isActivating=!0,u.show(),u.focus(),u.$isActivating=!1,o&&(o.$isDeactivating=!0,o.hide(),o.$isDeactivating=!1),n.onActiveItemChange(h,null,!d))}return h}onActiveItemChange(i,e,t){const r=this;r._activeItem=i.activeItem,r._activeIndex=i.activeIndex,!t&&r.owner.trigger("activeItemChange",i),r.owner.containsFocus&&i.activeItem.focus(),e==null||e(i)}renderChildren(){const{owner:i}=this;i.contentElement.classList.toggle(this.hideChildHeaderCls,i.suppressChildHeaders),super.renderChildren()}changeActiveIndex(i){const{owner:e}=this;return e.isConfiguring&&!e._items?i:Math.min(i,e.items.length-1)}updateActiveIndex(i,e){this.owner.isConfiguring||this.setActiveItem(i,e)}updateActiveItem(i){this.owner.isConfiguring||this.setActiveItem(i,this.activeIndex)}get isChangingCard(){return!!this.animateDetacher}};y(hs,"$name","Card"),y(hs,"type","card"),y(hs,"configurable",{containerCls:"b-card-container",itemCls:"b-card-item",hideChildHeaderCls:"b-hide-child-headers",animateCardChange:!0,activeItem:null,activeIndex:null}),hs.initClass(),hs._$name="Card";var LC=i=>i.maximized,Ai=class extends pt{static get configurable(){return{activeTab:0,animateTabChange:!0,autoHeight:!1,defaultType:"container",focusable:!1,itemCls:"b-tabpanel-item",layout:{type:"card"},suppressChildHeaders:!0,tabBar:{type:"tabbar",weight:-2e3},tabMinWidth:null,tabMaxWidth:null}}get activeIndex(){return this.layout.activeIndex}get activeItem(){return this.layout.activeItem}get activeTabItemIndex(){var i;const{activeTab:e,items:t,tabBar:r}=this;return t.indexOf((i=r.tabs[e])==null?void 0:i.item)}get bodyConfig(){return x.merge({className:{"b-tabpanel-body":1}},super.bodyConfig)}get focusElement(){var i;const e=this.items[this.activeTab||0];return(e==null?void 0:e.focusElement)||((i=e==null?void 0:e.tab)==null?void 0:i.focusElement)}get tabPanelBody(){return this.bodyElement}finalizeInit(){super.finalizeInit();const i=this,{activeTab:e,layout:t}=i,{activeIndex:r}=t,{tabs:n}=i.tabBar,s=e>=0&&e<n.length&&i.items.indexOf(n[e].item);if(n.length>0&&(s===!1||s<0))throw new Error(`Invalid activeTab ${e} (${n.length} tabs)`);s!==r&&t.setActiveItem(s,r,{animation:!1,silent:!0}),t.animateCardChange=i.animateTabChange}onChildAdd(i){if(super.onChildAdd(i),!this.initialItems){const e=this,{tabBar:t}=e,r=e.makeTabConfig(i),n=r&&(t==null?void 0:t.firstTab),s=n&&t._items,a=n&&z.from(e._items,o=>o.tab||o===i),l=n?a.indexOf(i)+s.indexOf(n):0;r&&t&&(n&&i.weight==null&&l<s.count-1?t.insert(r,l):t.add(r))}}onChildRemove(i){const{tab:e}=i,{items:t}=this;e&&(this.tabBar.remove(e),e.destroy()),i===this.activeItem&&(this._activeTab=null,t.length&&(this.activeTab=t[Math.min(this.activeIndex,t.length-1)])),super.onChildRemove(i)}isDisabledOrHiddenTab(i){const{tabs:e}=this.tabBar,t=e==null?void 0:e[i];return t&&(t.disabled||t.hidden)}findAvailableTab(i,e=1){const{tabs:t}=this.tabBar,r=t.length,n=Math.max(0,t.indexOf(i.tab));n&&(e=-e);let s;for(let a=1;a<=r&&(s=(n+(e<0?r:0)+a*e)%r,!!this.isDisabledOrHiddenTab(s));++a);return s}activateAvailableTab(i,e=1){this.activeTab=this.findAvailableTab(i,e)}changeActiveTab(i,e){const t=this,{tabBar:r,layout:n}=t,{tabCount:s}=r;if(i.isWidget||x.isObject(i)?(t.items.indexOf(i)===-1&&(i=t.add(i)),i=r.indexOfTab(i.tab)):i=parseInt(i,10),!t.initialItems&&s>0&&(i<-1||i>=s))throw new Error(`Invalid activeTab ${i} (${s} tabs)`);if(t.isDisabledOrHiddenTab(i)&&(i=t.findAvailableTab(i)),n.animateCardChange&&n.cardChangeAnimation)n.cardChangeAnimation.then(a=>{(a==null?void 0:a.activeIndex)!==i&&(t._activeTab=i,t.updateActiveTab(i,e))});else return i}async updateActiveTab(i,e){var t;if(!this.initialItems){const{activeTabItemIndex:r,layout:n}=this;if(r>-1){const s=this.items[e],a=this.items[r];n.activeItem!==a&&(n.animateCardChange&&await this.tabSelectionPromise,s!=null&&s.containsFocus&&s.tab.focus(),this.tabSelectionPromise=(t=n.setActiveItem(a))==null?void 0:t.promise)}}}changeTabBar(i){return this.getConfig("strips"),this.strips={tabBar:i},this.strips.tabBar}makeTabConfig(i){const{tab:e}=i,t={item:i,type:"tab",tabPanel:this,disabled:!!i.disabled,hidden:i.initialConfig.hidden,weight:i.weight||0,internalListeners:{click:"onTabClick",thisObj:this},localizableProperties:{text:!1}};return e===!1?null:x.isObject(e)?Oi.mergeConfigs(t,e):t}updateItems(i,e){const t=this,{activeTab:r,initialItems:n}=t;let s=0,a;super.updateItems(i,e),n&&(a=Array.from(i,l=>t.makeTabConfig(l)).filter(l=>{if(l)return l.index=s++,!0}),s&&(a[0].isFirst=!0,a[s-1].isLast=!0,a[r].active=!0,t.tabBar.add(a),t.activeTab=r))}updateTabMinWidth(i){var e;(e=this.tabBar)==null||e.items.forEach(t=>{t.isTab&&(t.minWidth=i)})}updateTabMaxWidth(i){var e;(e=this.tabBar)==null||e.items.forEach(t=>{t.isTab&&(t.maxWidth=i)})}updateAutoHeight(i){this.detachListeners("themeAutoHeight"),i&&Me.ion({name:"themeAutoHeight",theme:"internalOnThemeChange",thisObj:this}),this.$measureHeight=i}applyAutoHeight(){const i=this,{layout:e,activeTab:t,element:r}=i,{animateCardChange:n}=e;if(e.animateCardChange=!1,i.height=null,!i.up(LC)){const s=i.height=Math.max(...i.items.map(a=>(i.activeTab=a,r.clientHeight)))+1;i.flex=`1 1 ${s}px`}i.activeTab=t,e.animateCardChange=n,i.$measureHeight=!1}internalOnThemeChange(){this.isVisible?this.applyAutoHeight():this.$measureHeight=!0}onBeginActiveItemChange(i){const e=this.tabBar.tabs,{activeItem:t,prevActiveItem:r}=i;this.activeTab=e.indexOf(t==null?void 0:t.tab),r!=null&&r.tab&&(r.tab.active=!1),t!=null&&t.tab&&(t.tab.active=!0,t.tab.show())}onBeforeActiveItemChange(i){return this.trigger("beforeTabChange",i)}onActiveItemChange(i){this.trigger("tabChange",i)}onTabClick(i){this.activeTab=i.source.item}onInternalPaint(){super.onInternalPaint(...arguments),this.$measureHeight&&this.applyAutoHeight()}};y(Ai,"$name","TabPanel"),y(Ai,"type","tabpanel"),y(Ai,"alias","tabs"),Ai.initClass(),Ai._$name="TabPanel";var Pi=class extends De{static get configurable(){return{resize:"none",inputAttributes:{tag:"textarea"}}}updateResize(i){this.input.style.resize=i}};y(Pi,"$name","TextAreaField"),y(Pi,"type","textareafield"),y(Pi,"alias","textarea"),Pi.initClass(),Pi._$name="TextAreaField";var Qo=class xm extends Qt{static get configurable(){return{picker:{type:"widget",tag:"textarea",cls:"b-textareapickerfield-picker",scrollAction:"realign",align:{align:"t-b",axisLock:!0},autoShow:!1},triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},resize:"none",inputType:null}}startConfigure(e){typeof e.inline=="boolean"&&ie.deprecate("Core","6.0.0","TextAreaPickerField.inline config is no longer supported"),super.startConfigure(e)}get inputElement(){const e=super.inputElement;return e.readOnly="readonly",e.reference="displayElement",this.ariaElement="displayElement",e}get focusElement(){var e;return(e=this._picker)!=null&&e.isVisible?this.input:this.displayElement}get needsInputSync(){var e;return this.displayElement[this.inputValueAttr]!==String((e=this.inputValue)!=null?e:"")}showPicker(){const e=this,{picker:t}=e;e.inline||(t.width=e.pickerWidth||e[e.pickerAlignElement].offsetWidth,super.showPicker(!0))}focusPicker(){this.input.focus()}onPickerKeyDown(e){const t=this,r=t.input;switch(e.key.trim()||e.code){case"Escape":t.picker.hide();return;case"Enter":e.ctrlKey&&(t.syncInputFieldValue(),t.picker.hide());break}t.input=t.displayElement;const n=super.onPickerKeyDown(e);return t.input=r,n}syncInputFieldValue(e){this.displayElement&&(this.displayElement.value=this.inputValue),super.syncInputFieldValue(e)}changeValue(e){return e==null?"":e}changePicker(e,t){var r;const n=this,s=n.pickerWidth||(e==null?void 0:e.width);if(e=xm.reconfigure(t,e?H.merge({owner:n,forElement:n[n.pickerAlignElement],align:{matchSize:s==null,anchor:n.overlayAnchor,target:n[n.pickerAlignElement]},id:n.id+"-input",style:{resize:n.resize},html:(r=n.value)!=null?r:""},e):null,n),e){const a=n.input=e.element;n.inputListenerRemover=$.on({element:a,thisObj:n,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput",keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}return e}};y(Qo,"$name","TextAreaPickerField"),y(Qo,"type","textareapickerfield");var eu=Qo;eu.initClass(),eu._$name="TextAreaPickerField";var $C=i=>{var e;return e=class extends(i||F){compose(){const{minified:t}=this;return{class:{"b-minified":t}}}get widgetClass(){}},y(e,"$name","Minifiable"),y(e,"configurable",{minifiable:!0,minified:null}),e},NC=[],BC=i=>i[0]!=="*",Wf=(i,e)=>{const t=i[e]||null;return delete i[e],t},VC=i=>i.responsiveRoot,Hf={number:i=>({width:e})=>e<=i&&i},Yf=i=>(delete i.once,{callback:Wf(i,"callback"),configs:i,when:Wf(i,"when")}),Uf=(i,...e)=>{const t=e.flatMap(s=>(s==null?void 0:s.once)||NC),r=i.mergeConfigs(...e),n=Yf(r);return n.once=t.length?Yf(i.mergeConfigs(...t)):null,n},jC=(i,e)=>{let t,r=Proxy.revocable(i,{get(a,l){return t&&(t[l]=!0),i[l]}}),n=ue.after(i,"onConfigChange",(a,{name:l})=>{t!=null&&t[l]&&e()}),s=i.ion({resize:()=>{e()}});return i.monitorResize=!0,{widget:i,get object(){return r==null?void 0:r.proxy},destroy(){r&&(r.revoke(),n(),s(),r=n=s=null)},reset(){t=Object.create(null)}}},qf=i=>{var e;return e=class extends(i||F).mixin(xe,Mf){get isResponsivePending(){return this.responsiveUpdateCount===0&&this.hasConfig("responsive")}get isResponsiveUpdating(){var t;return this._responsiveUpdating||((t=this.responsiveWidget)==null?void 0:t._responsiveUpdating)}updateResponsive(t){var r;const n=this,s=n.constructor,{responsiveDefaults:a}=n,l=Array.from(new Set(x.keys(t).concat(x.keys(a)))).filter(BC);let o=null,u,c,d,h;if(t){o={"*":Uf(s,a["*"],t["*"])};for(c of l)d=t[c],d!==null&&d!==!1&&(u=u||d&&"when"in d,o[c]=Uf(s,a["*"],a[c],t["*"],d),h=o[c].when,o[c].when=((r=Hf[typeof h])==null?void 0:r.call(Hf,h))||h)}n.$responsiveStates=o,n.$responsiveWhen=u,n.syncResponsiveWidget()}updateResponsiveState(t,r){var n,s,a,l,o;const u=this,{$responsiveStates:c}=u,d=++u.responsiveStateChanges===1,h=(n=u.element)==null?void 0:n.classList,g=c["*"],f=c[t]||g,m=d&&(f.once||g.once),p=d&&u.isStateful,v=u.responsiveWidget;let b=f.configs,w=m==null?void 0:m.configs;w&&(b=b?u.constructor.mergeConfigs(b,w):w),r&&(h==null||h.remove(`b-responsive-${r.toLowerCase()}`)),t&&(h==null||h.add(`b-responsive-${t.toLowerCase()}`)),p&&(w=u.loadStatefulData(),w&&(b=b?u.constructor.mergeConfigs(b,w):w),u.suspendStateful()),u._responsiveUpdating=!0;try{(s=u.trigger)==null||s.call(u,"beforeResponsiveStateChange",{state:t,oldState:r,target:v}),b&&u.setConfig(b),(a=f.callback)==null||a.call(f,{source:u,state:t,oldState:r,target:v,initial:d}),(l=m==null?void 0:m.callback)==null||l.call(m,{source:u,state:t,oldState:r,target:v,initial:d}),(o=u.trigger)==null||o.call(u,"responsiveStateChange",{state:t,oldState:r,target:v})}finally{u._responsiveUpdating=!1,p&&u.resumeStateful()}}get responsiveTarget(){return this.responsiveWidget||this._responsiveTarget}updateResponsiveTarget(){this.syncResponsiveWidget()}updateResponsiveWidget(t){var r;const n=this,s=t&&n.responsiveUpdate;(r=n.$responsiveWrapper)==null||r.destroy(),n.$responsiveWrapper=t&&jC(t,s),s==null||s.now()}responsiveUpdate(){const t=this,{$responsiveStates:r,$responsiveWrapper:n}=t,s=n==null?void 0:n.widget;if(r&&n){let a=null,l=0,o=r,u,c;s&&s!==t&&!t.$responsiveWhen&&(s.getConfig("responsive"),o=s.$responsiveStates||o),n.reset();for(c in r)c!=="*"&&(u=o[c].when(n.object,U),u!=null&&u!==!1&&(!a||u<l)&&(a=c,l=u));++t.responsiveUpdateCount,t.responsiveState=a}}syncResponsiveWidget(){var t;const r=this;let n=null,s;if(!r.isDestroying&&r.responsive){if(s=r.responsiveTarget,!(n=s))n=!r.responsiveRoot&&((t=r.up)==null?void 0:t.call(r,VC))||r;else if(typeof s=="string"&&(n=s==="@"?r:s[0]==="@"?r[s.substring(1)]:r.up(s),!n))throw new Error(`No match for responsiveTarget="${s}"`);if(!n.isWidget)throw new Error(`${n.constructor.$$name} is not a widget and cannot be a responsiveTarget`)}return r.responsiveWidget=n,n}changeBreakpoints(t){return x.assertObject(t,"breakpoints"),t!=null&&t.width&&Object.keys(t.width).forEach(r=>{t.width[r].maxWidth=r}),t!=null&&t.height&&Object.keys(t.height).forEach(r=>{t.height[r].maxHeight=r}),t}updateBreakpoints(t){t&&(this.monitorResize=!0)}getBreakpoint(t,r){const n=Object.keys(t).map(a=>parseInt(a)).sort(),s=n.find(a=>r<=a);return t[s!=null?s:t["*"]&&"*"]}activateBreakpoint(t,r){var n,s;const a=this,l=a[`current${t}Breakpoint`];r!==l&&(a[`current${t}Breakpoint`]=r,a.setConfig(r.configs),l&&a.element.classList.remove(`b-breakpoint-${l.name.toLowerCase()}`),a.element.classList.add(`b-breakpoint-${r.name.toLowerCase()}`),a.trigger(`responsive${t}Change`,{breakpoint:r,prevBreakpoint:l}),(n=r.callback)==null||n.call(r,{source:a,breakpoint:r,prevBreakpoint:l}),(s=a.recompose)==null||s.call(a))}applyResponsiveBreakpoints(t,r){var n;const s=this,{width:a,height:l}=(n=s.breakpoints)!=null?n:{};if(a){const o=s.getBreakpoint(a,t);s.activateBreakpoint("Width",o)}if(l){const o=s.getBreakpoint(l,r);s.activateBreakpoint("Height",o)}}onInternalResize(t,r,n,s,a){super.onInternalResize(t,r,n,s,a),this.applyResponsiveBreakpoints(r,n)}},y(e,"$name","Responsive"),y(e,"configurable",{responsive:{$config:{lazy:"paint"},value:null},responsiveDefaults:{small:{when:400},medium:{when:800},large:{when:()=>1/0},"*":{}},responsiveRoot:null,responsiveState:null,responsiveTarget:{value:null,$config:{lazy:"paint"}},responsiveWidget:{value:null,$config:{nullify:!0}},breakpoints:null}),y(e,"delayable",{responsiveUpdate:"raf"}),y(e,"fenced",{syncResponsiveWidget:!0}),y(e,"prototypeProperties",{responsiveStateChanges:0,responsiveUpdateCount:0}),e},Kf=i=>{var e;return e=class extends(i||F){changeCssVarPrefix(t){return x.assertString(t,"prefix"),t&&!t.endsWith("-")&&(t=t+"-"),t||""}changeCss(t){x.assertObject(t,"css");const r=this;if(!globalThis.Proxy)throw new Error("Proxy not supported");const n=new Proxy({},{get(s,a){var l;return(l=getComputedStyle(r.element||document.documentElement).getPropertyValue(`--${r.cssVarPrefix}${P.hyphenate(a)}`))==null?void 0:l.trim()},set(s,a,l){return(r.element||document.documentElement).style.setProperty(`--${r.cssVarPrefix}${P.hyphenate(a)}`,l),!0}});return t&&(r._element?x.assign(n,t):r.$initialCSS=t),n}updateElement(t,...r){super.updateElement(t,...r),this.$initialCSS&&x.assign(this.css,this.$initialCSS)}get widgetClass(){}},y(e,"$name","Styleable"),y(e,"configurable",{cssVarPrefix:"",css:{}}),e},ur="http://www.w3.org/2000/svg",zC={bar:1,outline:2,text:3},WC=(i,e)=>parseInt(i.order,10)-parseInt(e.order,10),Gf=(i,e)=>parseInt(i.dataset.order,10)-parseInt(e.dataset.order,10),HC=i=>i.field,YC=()=>!1,UC=/\s+/,Fi=class extends j{static get configurable(){return{data:null,values:null,series:null,topValue:null,element:{children:[{ns:ur,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:ur,tag:"g",reference:"scaledSvgGroup"},{ns:ur,tag:"g",reference:"unscaledSvgGroup"}]}]},omitZeroHeightBars:!1,singleTextForAllBars:!0,monitorResize:!0,getRectClass(i,e,t,r){return""},getOutlineClass(i,e){return""},getBarTip(i,e,t,r){},getBarText(i,e,t){return""},getRectConfig:null,getBarTextRenderData(i,e,t,r){return i},getBarTextTip(i,e,t,r){}}}construct(i){const e=this;super.construct(i),e.scheduleRefresh=e.createOnFrame(e.refresh,[],e,!0),e.refresh()}set tip(i){var e;const t=this;(e=t.tip)==null||e.destroy(),i?t._tip=je.new({owner:t,forElement:t.svgElement,forSelector:"rect",internalListeners:{beforeShow:"up.onBeforeTipShow"}},i):t._tip=null}onElementResize(){super.onElementResize(...arguments);const i=this.svgElement.getBoundingClientRect();this.scaledSvgGroup.setAttribute("transform",`scale(${i.width} ${i.height})`)}onBeforeTipShow({source:i}){const e=parseInt(i.activeTarget.dataset.index);i.html=i.contentTemplate({histogram:this,index:e})}updateSeries(i){const e=this,t=e._series={};let r=0,n=0;for(const s in i)if(i[s]!==!1){const a=t[s]=H.merge({},i[s]);a.field||(a.field=s),a.type||(a.type="bar"),"order"in a||(a.order=zC[a.type]*10+r),"index"in a||(a.index=r),a.type==="bar"&&(a.index=n++),a.id=s,r++}!e.topValue&&e._data&&(e.topValue=e.getDataTopValue(e._data)),e.refreshSuspended||e.scheduleRefresh()}getDataTopValue(i,e){const t=Object.values(e||this.series).map(HC);let r=0,n;for(let s=0,{length:a}=i;s<a;s++){n=i[s];for(let l=0,{length:o}=t;l<o;l++)r=Math.max(r,n[t[l]])}return r}updateData(i){const e=this;e._data=i,!e.topValue&&e._data&&e._series&&(e.topValue=e.getDataTopValue(i)),e.refreshSuspended||e.scheduleRefresh()}updateTopValue(i){const e=this;e._topValue=i,!i&&e._data&&(e._topValue=e.getDataTopValue(e._data)),e.refreshSuspended||e.scheduleRefresh()}scheduleRefresh(){}suspendRefresh(){this.refreshSuspended++}resumeRefresh(){this.refreshSuspended&&this.refreshSuspended--}refresh(i){const e=this,{series:t,_tip:r,topValue:n,singleTextForAllBars:s}=e,a=(i==null?void 0:i.args)||[],l=[],o=[];if(t){for(const u of Object.values(t).sort(WC)){const c=e[`draw${P.capitalize(u.type)}`](u,...a);Array.isArray(c)?l.push.apply(l,c):l.push(c),!s&&u.type==="bar"&&o.push(...e.drawText(u,...a))}l.sort(Gf),s?o.push(...e.drawText(null,...a)):o.sort(Gf),de.sync({domConfig:{width:"100%",height:"100%",preserveAspectRatio:"none",dataset:{topValue:n},children:[{ns:ur,tag:"g",reference:"scaledSvgGroup",children:l},{ns:ur,tag:"g",reference:"unscaledSvgGroup",children:o}]},configEquality:YC,targetElement:e.svgElement}),r&&r.isVisible&&e.onBeforeTipShow({source:r})}}drawBar(i,...e){const t=this,{topValue:r,data:n,omitZeroHeightBars:s,barStyle:a}=t,{field:l,order:o,stretch:u}=i,{length:c}=n,d=1/c,h=[],g=P.createId(i.id),f=i.index,m=u?1:void 0;let p;for(let v=0,b=0,{length:w}=n;v<w;v++,b+=p){const S=n[v];let C=S.rectConfig={ns:ur,tag:"rect",dataset:{}};const T=S[l],E=T?m||S.height||(T>r?r:T)/r:0,I=1-E,R=t.callback("getBarTip",t,[i,C,S,v,...e]);p=S.width||d,a?C.style=a:delete C.style,Object.assign(C.dataset,{index:v,order:o,series:g});const M={[`b-series-${g}`]:1,[`b-series-index-${f}`]:1},O=t.callback("getRectClass",t,[i,C,S,v,...e]);O&&O.split(UC).forEach(A=>M[A]=1),Object.assign(C,{x:b,y:I,width:p,height:E,class:M}),R?C.dataset.btip=R:delete C.dataset.btip,t.getRectConfig&&(C=t.getRectConfig(C,S,v,i,...e)),C&&(C.height||!s)&&h.push(C)}return h}changeGetRectConfig(i){return i?this.bindCallback(i):null}drawOutline(i,...e){const t=this,{topValue:r,data:n}=t,{field:s,order:a,id:l}=i,o=1/n.length,u=["M 0,1"],c={ns:ur,tag:"path",dataset:{order:a,id:l}};let d,h="M",g="L";for(let f=0,m=0,{length:p}=n;f<p;f++){const v=1-n[f][s]/r;d=n[f].width||o,u.push(`${h} ${m},${v} ${g} ${m+=d},${v}`),h=g=""}return c.class=`b-series-${i.id} b-series-index-${i.index} `+t.callback("getOutlineClass",t,[i,n,...e]),c.d=u.join(" "),c}drawText(i,...e){const t=this,{data:r}=t,n=1/r.length,s="100%",a=[];for(let l=0,o,u=0,{length:c}=r;l<c;l++,u+=o){o=r[l].width||n;const d=t.callback("getBarText",t,[r[l],l,i,...e]);if(d){const h=t.callback("getBarTextRenderData",t,[{ns:ur,tag:"text",className:"b-bar-legend",html:d,left:u,width:o,x:`${(u+o/2)*100}%`,y:r[l].y!==void 0?r[l].y:s,dataset:{index:l,series:i}},r[l],l,i,...e]),g=t.callback("getBarTextTip",t,[h,r[l],l,i,...e]);g?h.dataset.btip=g:delete h.dataset.btip,a.push(h)}}return a}};y(Fi,"type","histogram"),y(Fi,"$name","Histogram"),y(Fi,"properties",{refreshSuspended:0}),Fi.initClass(),Fi._$name="Histogram";var fs="http://www.w3.org/2000/svg",gs=class extends j{static get configurable(){return{scalePoints:null,scaleMaxPadding:.1,horizontal:!1,align:{value:!1,$config:{merge:"replace"}},element:{children:[{ns:fs,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:fs,tag:"g",reference:"scaledSvgGroup",children:[{ns:fs,tag:"path",reference:"pathElement"}]},{ns:fs,tag:"g",reference:"unscaledSvgGroup"}]}]},monitorResize:!0}}construct(i){super.construct(i),this.scheduleRefresh=this.createOnFrame(this.refresh,[],this,!0),this.refresh()}changeAlign(i){return i||(i=this.horizontal?"bottom":"right"),i}updateAlign(i,e){this.element.classList.remove(`b-align-${e}`),this.element.classList.add(`b-align-${i}`)}updateHorizontal(i,e){this.element.classList.remove(`b-scale-${e?"horizontal":"vertical"}`),this.element.classList.add(`b-scale-${i?"horizontal":"vertical"}`)}onElementResize(){super.onElementResize(...arguments),this.scheduleRefresh()}scheduleRefresh(){}refresh(){var i;if(!this.scalePoints)return;const e=this,{horizontal:t,width:r,height:n,align:s,scalePoints:a,scaleMaxPadding:l}=e,o=(i=a[a.length-1])==null?void 0:i.value,u=[],c=[],d=1/(o+l*o);e.scaledSvgGroup.setAttribute("transform",`scale(${t?r:1} ${t?1:n})`);for(const h of a){const g=!!h.text,f=d*h.value;if(g){const m={ns:fs,tag:"text",className:"b-scale-tick-label",html:h.text,dataset:{tick:h.value}};t?(m.x=`${f*100}%`,m.y=s==="top"?"1.6em":n-12):(m.x=s==="left"?"12":`${r-12}`,m.y=`${(1-f)*100}%`),c.push(m)}t?s==="top"?u.push(`M${f},0 L${f},${g?10:5}`):u.push(`M${f},${n} L${f},${n-(g?10:5)}`):s==="left"?u.push(`M0,${1-f} L${g?10:5},${1-f}`):u.push(`M${r},${1-f} L${r-(g?10:5)},${1-f}`)}e.pathElement.setAttribute("d",u.join("")),de.syncChildren({domConfig:{children:c}},e.unscaledSvgGroup)}};y(gs,"$name","Scale"),y(gs,"type","scale"),gs.initClass(),gs._$name="Scale";var Xf=class Yu extends F{static get configurable(){return{element:null,colorPrefix:"b-sch-",tooltip:null,size:null}}doDestroy(){var e;(e=this.tooltip)==null||e.destroy(),super.doDestroy()}updateElement(e){$.on({element:e,delegate:".b-resource-image",error:"onImageErrorEvent",thisObj:this,capture:!0})}changeTooltip(e){return je.new({forElement:this.element,forSelector:".b-resource-avatar",cls:"b-resource-avatar-tooltip"},e)}static get failedUrls(){return this._failedUrls||(this._failedUrls=new Set),this._failedUrls}getResourceAvatar(e){if(Array.isArray(e))return e.map(h=>this.getResourceAvatar(h));const{initials:t,color:r,iconCls:n,imageUrl:s,defaultImageUrl:a,dataset:l={},resourceRecord:o,alt:u=P.encodeHtml(o==null?void 0:o.name)}=e,c=this.getImageConfig(t,r,s,a,l,u)||this.getIconConfig(n,l)||this.getResourceInitialsConfig(t,r,l),{size:d}=this;return Object.assign(c.style,{...d?{height:d,width:d}:void 0}),c}getImageConfig(e,t,r,n,s,a){if(r=Yu.failedUrls.has(r)?n:r||n,r)return{tag:"img",draggable:"false",loading:"lazy",class:{"b-resource-avatar":1,"b-resource-image":1},style:{},alt:a,elementData:{defaultImageUrl:n,imageUrl:r,initials:e,color:t,dataset:s},src:r,dataset:s}}getIconConfig(e,t){if(e)return e&&{tag:"i",style:{},class:{"b-resource-avatar":1,"b-resource-icon":1,[e]:1},dataset:t}}getResourceInitialsConfig(e,t,r){const n=D.isNamedColor(t)&&t,s=!n&&t,{size:a}=this;return{tag:"div",class:{"b-resource-avatar":1,"b-resource-initials":1,[`${this.colorPrefix}${n}`]:n},style:{backgroundColor:s||null,...a?{height:a,width:a}:void 0},children:[e],dataset:r}}onImageErrorEvent({target:e}){if(!e.matches(".b-resource-avatar"))return;const{defaultImageUrl:t,initials:r,color:n,imageUrl:s,dataset:a}=e.elementData;if(t&&!e.src.endsWith(t.replace(/^[./]*/gm,"")))e.src=t;else{const l=D.createElement(this.getResourceInitialsConfig(r,n,a));l.elementData=e.elementData,e.parentElement.replaceChild(l,e)}Yu.failedUrls.add(s)}};y(Xf,"$name","AvatarRendering");var ms=Xf;ms._$name="AvatarRendering",window&&!window.bryntum&&(window.bryntum={});var Zf=(i,e)=>new Date(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds()+e,i.getMilliseconds()),tu=function(){"use strict";var i={version:"1.2.0"};return Array.prototype.indexOf||(Array.prototype.indexOf=function(e){"use strict";if(this==null)throw new TypeError;var t=Object(this),r=t.length>>>0;if(r===0)return-1;var n=0;if(arguments.length>1&&(n=Number(arguments[1]),n!=n?n=0:n!=0&&n!=1/0&&n!=-1/0&&(n=(n>0||-1)*Math.floor(Math.abs(n)))),n>=r)return-1;for(var s=n>=0?n:Math.max(r-Math.abs(n),0);s<r;s++)if(s in t&&t[s]===e)return s;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),i.array={},i.array.sort=function(e,t){e.sort(function(r,n){return+r-+n}),t&&e[0]===0&&e.push(e.shift())},i.array.next=function(e,t,r){for(var n,s=r[0]!==0,a=0,l=t.length-1;l>-1;--l){if(n=t[l],n===e)return n;if(n>e||n===0&&s&&r[1]>e){a=l;continue}break}return t[a]},i.array.nextInvalid=function(e,t,r){for(var n=r[0],s=r[1],a=t.length,l=t[a-1]===0&&n!==0?s:0,o=e,u=t.indexOf(e),c=o;o===(t[u]||l);)if(o++,o>s&&(o=n),u++,u===a&&(u=0),o===c)return;return o},i.array.prev=function(e,t,r){for(var n,s=t.length,a=r[0]!==0,l=s-1,o=0;o<s;o++){if(n=t[o],n===e)return n;if(n<e||n===0&&a&&r[1]<e){l=o;continue}break}return t[l]},i.array.prevInvalid=function(e,t,r){for(var n=r[0],s=r[1],a=t.length,l=t[a-1]===0&&n!==0?s:0,o=e,u=t.indexOf(e),c=o;o===(t[u]||l);)if(o--,o<n&&(o=s),u--,u===-1&&(u=a-1),o===c)return;return o},i.day=i.D={name:"day",range:86400,val:function(e){return e.D||(e.D=i.date.getDate.call(e))},isValid:function(e,t){return i.D.val(e)===(t||i.D.extent(e)[1])},extent:function(e){if(e.DExtent)return e.DExtent;var t=i.M.val(e),r=i.DAYS_IN_MONTH[t-1];return t===2&&i.dy.extent(e)[1]===366&&(r=r+1),e.DExtent=[1,r]},start:function(e){return e.DStart||(e.DStart=i.date.next(i.Y.val(e),i.M.val(e),i.D.val(e)))},end:function(e){return e.DEnd||(e.DEnd=i.date.prev(i.Y.val(e),i.M.val(e),i.D.val(e)))},next:function(e,t){t=t>i.D.extent(e)[1]?1:t;var r=i.date.nextRollover(e,t,i.D,i.M),n=i.D.extent(r)[1];return t=t>n?1:t||n,i.date.next(i.Y.val(r),i.M.val(r),t)},prev:function(e,t){var r=i.date.prevRollover(e,t,i.D,i.M),n=i.D.extent(r)[1];return i.date.prev(i.Y.val(r),i.M.val(r),t>n?n:t||n)}},i.dayOfWeekCount=i.dc={name:"day of week count",range:604800,val:function(e){return e.dc||(e.dc=Math.floor((i.D.val(e)-1)/7)+1)},isValid:function(e,t){return i.dc.val(e)===t||t===0&&i.D.val(e)>i.D.extent(e)[1]-7},extent:function(e){return e.dcExtent||(e.dcExtent=[1,Math.ceil(i.D.extent(e)[1]/7)])},start:function(e){return e.dcStart||(e.dcStart=i.date.next(i.Y.val(e),i.M.val(e),Math.max(1,(i.dc.val(e)-1)*7+1||1)))},end:function(e){return e.dcEnd||(e.dcEnd=i.date.prev(i.Y.val(e),i.M.val(e),Math.min(i.dc.val(e)*7,i.D.extent(e)[1])))},next:function(e,t){t=t>i.dc.extent(e)[1]?1:t;var r=i.date.nextRollover(e,t,i.dc,i.M),n=i.dc.extent(r)[1];t=t>n?1:t;var s=i.date.next(i.Y.val(r),i.M.val(r),t===0?i.D.extent(r)[1]-6:1+7*(t-1));return s.getTime()<=e.getTime()?(r=i.M.next(e,i.M.val(e)+1),i.date.next(i.Y.val(r),i.M.val(r),t===0?i.D.extent(r)[1]-6:1+7*(t-1))):s},prev:function(e,t){var r=i.date.prevRollover(e,t,i.dc,i.M),n=i.dc.extent(r)[1];return t=t>n?n:t||n,i.dc.end(i.date.prev(i.Y.val(r),i.M.val(r),1+7*(t-1)))}},i.dayOfWeek=i.dw=i.d={name:"day of week",range:86400,val:function(e){return e.dw||(e.dw=i.date.getDay.call(e)+1)},isValid:function(e,t){return i.dw.val(e)===(t||7)},extent:function(){return[1,7]},start:function(e){return i.D.start(e)},end:function(e){return i.D.end(e)},next:function(e,t){return t=t>7?1:t||7,i.date.next(i.Y.val(e),i.M.val(e),i.D.val(e)+(t-i.dw.val(e))+(t<=i.dw.val(e)?7:0))},prev:function(e,t){return t=t>7?7:t||7,i.date.prev(i.Y.val(e),i.M.val(e),i.D.val(e)+(t-i.dw.val(e))+(t>=i.dw.val(e)?-7:0))}},i.dayOfYear=i.dy={name:"day of year",range:86400,val:function(e){return e.dy||(e.dy=Math.ceil(1+(i.D.start(e).getTime()-i.Y.start(e).getTime())/i.DAY))},isValid:function(e,t){return i.dy.val(e)===(t||i.dy.extent(e)[1])},extent:function(e){var t=i.Y.val(e);return e.dyExtent||(e.dyExtent=[1,t%4?365:366])},start:function(e){return i.D.start(e)},end:function(e){return i.D.end(e)},next:function(e,t){t=t>i.dy.extent(e)[1]?1:t;var r=i.date.nextRollover(e,t,i.dy,i.Y),n=i.dy.extent(r)[1];return t=t>n?1:t||n,i.date.next(i.Y.val(r),i.M.val(r),t)},prev:function(e,t){var r=i.date.prevRollover(e,t,i.dy,i.Y),n=i.dy.extent(r)[1];return t=t>n?n:t||n,i.date.prev(i.Y.val(r),i.M.val(r),t)}},i.hour=i.h={name:"hour",range:3600,val:function(e){return e.h||(e.h=i.date.getHour.call(e))},isValid:function(e,t){return i.h.val(e)===t},extent:function(){return[0,23]},start:function(e){return e.hStart||(e.hStart=i.date.next(i.Y.val(e),i.M.val(e),i.D.val(e),i.h.val(e)))},end:function(e){return e.hEnd||(e.hEnd=i.date.prev(i.Y.val(e),i.M.val(e),i.D.val(e),i.h.val(e)))},next:function(e,t){t=t>23?0:t;var r=i.date.next(i.Y.val(e),i.M.val(e),i.D.val(e)+(t<=i.h.val(e)?1:0),t);return!i.date.isUTC&&r.getTime()<=e.getTime()&&(r=i.date.next(i.Y.val(r),i.M.val(r),i.D.val(r),t+1)),r},prev:function(e,t){return t=t>23?23:t,i.date.prev(i.Y.val(e),i.M.val(e),i.D.val(e)+(t>=i.h.val(e)?-1:0),t)}},i.minute=i.m={name:"minute",range:60,val:function(e){return e.m||(e.m=i.date.getMin.call(e))},isValid:function(e,t){return i.m.val(e)===t},extent:function(e){return[0,59]},start:function(e){return e.mStart||(e.mStart=i.date.next(i.Y.val(e),i.M.val(e),i.D.val(e),i.h.val(e),i.m.val(e)))},end:function(e){return e.mEnd||(e.mEnd=i.date.prev(i.Y.val(e),i.M.val(e),i.D.val(e),i.h.val(e),i.m.val(e)))},next:function(e,t){var r=i.m.val(e),n=i.s.val(e),s=t>59?60-r:t<=r?60-r+t:t-r,a=new Date(e.getTime()+s*i.MIN-n*i.SEC);return!i.date.isUTC&&a.getTime()<=e.getTime()&&(a=new Date(e.getTime()+(s+120)*i.MIN-n*i.SEC)),a},prev:function(e,t){return t=t>59?59:t,i.date.prev(i.Y.val(e),i.M.val(e),i.D.val(e),i.h.val(e)+(t>=i.m.val(e)?-1:0),t)}},i.month=i.M={name:"month",range:2629740,val:function(e){return e.M||(e.M=i.date.getMonth.call(e)+1)},isValid:function(e,t){return i.M.val(e)===(t||12)},extent:function(){return[1,12]},start:function(e){return e.MStart||(e.MStart=i.date.next(i.Y.val(e),i.M.val(e)))},end:function(e){return e.MEnd||(e.MEnd=i.date.prev(i.Y.val(e),i.M.val(e)))},next:function(e,t){return t=t>12?1:t||12,i.date.next(i.Y.val(e)+(t>i.M.val(e)?0:1),t)},prev:function(e,t){return t=t>12?12:t||12,i.date.prev(i.Y.val(e)-(t>=i.M.val(e)?1:0),t)}},i.second=i.s={name:"second",range:1,val:function(e){return e.s||(e.s=i.date.getSec.call(e))},isValid:function(e,t){return i.s.val(e)===t},extent:function(){return[0,59]},start:function(e){return e},end:function(e){return e},next:function(e,t){var r=i.s.val(e),n=t>59?60-r:t<=r?60-r+t:t-r,s=new Date(e.getTime()+n*i.SEC);return!i.date.isUTC&&s.getTime()<=e.getTime()&&(s=new Date(e.getTime()+(n+7200)*i.SEC)),s},prev:function(e,t,r){return t=t>59?59:t,i.date.prev(i.Y.val(e),i.M.val(e),i.D.val(e),i.h.val(e),i.m.val(e)+(t>=i.s.val(e)?-1:0),t)}},i.time=i.t={name:"time",range:1,val:function(e){return e.t||(e.t=i.h.val(e)*3600+i.m.val(e)*60+i.s.val(e))},isValid:function(e,t){return i.t.val(e)===t},extent:function(){return[0,86399]},start:function(e){return e},end:function(e){return e},next:function(e,t){t=t>86399?0:t;var r=i.date.next(i.Y.val(e),i.M.val(e),i.D.val(e)+(t<=i.t.val(e)?1:0),0,0,t);return!i.date.isUTC&&r.getTime()<e.getTime()&&(r=i.date.next(i.Y.val(r),i.M.val(r),i.D.val(r),i.h.val(r),i.m.val(r),t+7200)),r},prev:function(e,t){return t=t>86399?86399:t,i.date.next(i.Y.val(e),i.M.val(e),i.D.val(e)+(t>=i.t.val(e)?-1:0),0,0,t)}},i.weekOfMonth=i.wm={name:"week of month",range:604800,val:function(e){return e.wm||(e.wm=(i.D.val(e)+(i.dw.val(i.M.start(e))-1)+(7-i.dw.val(e)))/7)},isValid:function(e,t){return i.wm.val(e)===(t||i.wm.extent(e)[1])},extent:function(e){return e.wmExtent||(e.wmExtent=[1,(i.D.extent(e)[1]+(i.dw.val(i.M.start(e))-1)+(7-i.dw.val(i.M.end(e))))/7])},start:function(e){return e.wmStart||(e.wmStart=i.date.next(i.Y.val(e),i.M.val(e),Math.max(i.D.val(e)-i.dw.val(e)+1,1)))},end:function(e){return e.wmEnd||(e.wmEnd=i.date.prev(i.Y.val(e),i.M.val(e),Math.min(i.D.val(e)+(7-i.dw.val(e)),i.D.extent(e)[1])))},next:function(e,t){t=t>i.wm.extent(e)[1]?1:t;var r=i.date.nextRollover(e,t,i.wm,i.M),n=i.wm.extent(r)[1];return t=t>n?1:t||n,i.date.next(i.Y.val(r),i.M.val(r),Math.max(1,(t-1)*7-(i.dw.val(r)-2)))},prev:function(e,t){var r=i.date.prevRollover(e,t,i.wm,i.M),n=i.wm.extent(r)[1];return t=t>n?n:t||n,i.wm.end(i.date.next(i.Y.val(r),i.M.val(r),Math.max(1,(t-1)*7-(i.dw.val(r)-2))))}},i.weekOfYear=i.wy={name:"week of year (ISO)",range:604800,val:function(e){if(e.wy)return e.wy;var t=i.dw.next(i.wy.start(e),5),r=i.dw.next(i.Y.prev(t,i.Y.val(t)-1),5);return e.wy=1+Math.ceil((t.getTime()-r.getTime())/i.WEEK)},isValid:function(e,t){return i.wy.val(e)===(t||i.wy.extent(e)[1])},extent:function(e){if(e.wyExtent)return e.wyExtent;var t=i.dw.next(i.wy.start(e),5),r=i.dw.val(i.Y.start(t)),n=i.dw.val(i.Y.end(t));return e.wyExtent=[1,r===5||n===5?53:52]},start:function(e){return e.wyStart||(e.wyStart=i.date.next(i.Y.val(e),i.M.val(e),i.D.val(e)-(i.dw.val(e)>1?i.dw.val(e)-2:6)))},end:function(e){return e.wyEnd||(e.wyEnd=i.date.prev(i.Y.val(e),i.M.val(e),i.D.val(e)+(i.dw.val(e)>1?8-i.dw.val(e):0)))},next:function(e,t){t=t>i.wy.extent(e)[1]?1:t;var r=i.dw.next(i.wy.start(e),5),n=i.date.nextRollover(r,t,i.wy,i.Y);i.wy.val(n)!==1&&(n=i.dw.next(n,2));var s=i.wy.extent(n)[1],a=i.wy.start(n);return t=t>s?1:t||s,i.date.next(i.Y.val(a),i.M.val(a),i.D.val(a)+7*(t-1))},prev:function(e,t){var r=i.dw.next(i.wy.start(e),5),n=i.date.prevRollover(r,t,i.wy,i.Y);i.wy.val(n)!==1&&(n=i.dw.next(n,2));var s=i.wy.extent(n)[1],a=i.wy.end(n);return t=t>s?s:t||s,i.wy.end(i.date.next(i.Y.val(a),i.M.val(a),i.D.val(a)+7*(t-1)))}},i.year=i.Y={name:"year",range:31556900,val:function(e){return e.Y||(e.Y=i.date.getYear.call(e))},isValid:function(e,t){return i.Y.val(e)===t},extent:function(){return[1970,2099]},start:function(e){return e.YStart||(e.YStart=i.date.next(i.Y.val(e)))},end:function(e){return e.YEnd||(e.YEnd=i.date.prev(i.Y.val(e)))},next:function(e,t){return t>i.Y.val(e)&&t<=i.Y.extent()[1]?i.date.next(t):i.NEVER},prev:function(e,t){return t<i.Y.val(e)&&t>=i.Y.extent()[0]?i.date.prev(t):i.NEVER}},i.fullDate=i.fd={name:"full date",range:1,val:function(e){return e.fd||(e.fd=e.getTime())},isValid:function(e,t){return i.fd.val(e)===t},extent:function(){return[0,3250368e7]},start:function(e){return e},end:function(e){return e},next:function(e,t){return i.fd.val(e)<t?new Date(t):i.NEVER},prev:function(e,t){return i.fd.val(e)>t?new Date(t):i.NEVER}},i.modifier={},i.modifier.after=i.modifier.a=function(e,t){var r=t[0];return{name:"after "+e.name,range:(e.extent(new Date)[1]-r)*e.range,val:e.val,isValid:function(n,s){return this.val(n)>=r},extent:e.extent,start:e.start,end:e.end,next:function(n,s){return s!=r&&(s=e.extent(n)[0]),e.next(n,s)},prev:function(n,s){return s=s===r?e.extent(n)[1]:r-1,e.prev(n,s)}}},i.modifier.before=i.modifier.b=function(e,t){var r=t[t.length-1];return{name:"before "+e.name,range:e.range*(r-1),val:e.val,isValid:function(n,s){return this.val(n)<r},extent:e.extent,start:e.start,end:e.end,next:function(n,s){return s=s===r?e.extent(n)[0]:r,e.next(n,s)},prev:function(n,s){return s=s===r?r-1:e.extent(n)[1],e.prev(n,s)}}},i.compile=function(e){var t=[],r=0,n;for(var s in e){var a=s.split("_"),l=a[0],o=a[1],u=e[s],c=o?i.modifier[o](i[l],u):i[l];t.push({constraint:c,vals:u}),r++}t.sort(function(h,g){var f=h.constraint.range,m=g.constraint.range;return m<f?-1:m>f?1:0}),n=t[r-1].constraint;function d(h){return h==="next"?function(g,f){return g.getTime()>f.getTime()}:function(g,f){return f.getTime()>g.getTime()}}return{start:function(h,g){for(var f=g,m=i.array[h],p=1e3,v;p--&&!v&&f;){v=!0;for(var b=0;b<r;b++){var w=t[b].constraint,S=w.val(f),C=w.extent(f),T=m(S,t[b].vals,C);if(!w.isValid(f,T)){f=w[h](f,T),v=!1;break}}}return f!==i.NEVER&&(f=h==="next"?n.start(f):n.end(f)),f},end:function(h,g){for(var f,m=i.array[h+"Invalid"],p=d(h),v=r-1;v>=0;v--){var b=t[v].constraint,w=b.val(g),S=b.extent(g),C=m(w,t[v].vals,S),T;C!==void 0&&(T=b[h](g,C),T&&(!f||p(f,T))&&(f=T))}return f},tick:function(h,g){return new Date(h==="next"?n.end(g).getTime()+i.SEC:n.start(g).getTime()-i.SEC)},tickSafe:function(h,g){return h==="next"?Zf(n.end(g),1):Zf(n.start(g),-1)},tickStart:function(h){return n.start(h)}}},i.schedule=function(e){if(!e)throw new Error("Missing schedule definition.");if(!e.schedules)throw new Error("Definition must include at least one schedule.");for(var t=[],r=e.schedules.length,n=[],s=e.exceptions?e.exceptions.length:0,a=0;a<r;a++)t.push(i.compile(e.schedules[a]));for(var l=0;l<s;l++)n.push(i.compile(e.exceptions[l]));function o(C,T,E,I,R){var M=w(C),O=T,A=1e6,B=[],L=[],Y,K,W=[],Z=C==="next",G,he=Z?0:1,ge=Z?1:0;if(E=E?new Date(E):new Date,!E||!E.getTime())throw new Error("Invalid start date.");for(c(C,t,B,E),h(C,n,L,E);A--&&O&&(Y=S(B,M))&&!(I&&M(Y,I));){if(s&&(g(C,n,L,Y),K=p(C,L,Y))){d(C,t,B,K);continue}if(R){var be=v(L,M);K=b(C,t,B,Y,be);var Ue=Z?[new Date(Math.max(E,Y)),K?new Date(I?Math.min(K,I):K):void 0]:[K?new Date(I?Math.max(I,K.getTime()+i.SEC):K.getTime()+i.SEC):void 0,new Date(Math.min(E,Y.getTime()+i.SEC))];if(G&&Ue[he].getTime()===G[ge].getTime()?(G[ge]=Ue[ge],O++):(G=Ue,W.push(G)),!K)break;d(C,t,B,K)}else W.push(Z?new Date(Math.max(E,Y)):m(t,B,Y,I)),f(C,t,B,Y);O--}for(var Nt=0,Im=W.length;Nt<Im;Nt++){var js=W[Nt];W[Nt]=Object.prototype.toString.call(js)==="[object Array]"?[u(js[0]),u(js[1])]:u(js)}return W.length===0?i.NEVER:T===1?W[0]:W}function u(C){if(C instanceof Date&&!isNaN(C.valueOf()))return new Date(C)}function c(C,T,E,I){for(var R=0,M=T.length;R<M;R++)E[R]=T[R].start(C,I)}function d(C,T,E,I){for(var R=w(C),M=0,O=T.length;M<O;M++)E[M]&&!R(E[M],I)&&(E[M]=T[M].start(C,I))}function h(C,T,E,I){for(var R=w(C),M=0,O=T.length;M<O;M++){var A=T[M].start(C,I);A?E[M]=[A,T[M].end(C,A)]:E[M]=i.NEVER}}function g(C,T,E,I){for(var R=w(C),M=0,O=T.length;M<O;M++)if(E[M]&&!R(E[M][0],I)){var A=T[M].start(C,I);A?E[M]=[A,T[M].end(C,A)]:E[M]=i.NEVER}}function f(C,T,E,I){for(var R=0,M=T.length;R<M;R++)if(E[R]&&E[R].getTime()===I.getTime()){const O=T[R].start(C,T[R].tick(C,I));O!==i.NEVER&&O.getTime()===E[R].getTime()?E[R]=T[R].start(C,T[R].tickSafe(C,I)):E[R]=O}}function m(C,T,E,I){for(var R,M=0,O=T.length;M<O;M++)if(T[M]&&T[M].getTime()===E.getTime()){var A=C[M].tickStart(E);if(I&&A<I)return I;(!R||A>R)&&(R=A)}return R}function p(C,T,E){for(var I=w(C),R,M=0,O=T.length;M<O;M++){var A=T[M];A&&!I(A[0],E)&&(!A[1]||I(A[1],E))&&(!R||I(A[1],R))&&(R=A[1])}return R}function v(C,T){for(var E,I=0,R=C.length;I<R;I++)C[I]&&(!E||T(E,C[I][0]))&&(E=C[I][0]);return E}function b(C,T,E,I,R){for(var M=w(C),O,A=0,B=T.length;A<B;A++){var L=E[A];if(L&&L.getTime()===I.getTime()){var Y=T[A].end(C,L);if(R&&(!Y||M(Y,R)))return R;(!O||M(Y,O))&&(O=Y)}}return O}function w(C){return C==="next"?function(T,E){return!E||T.getTime()>E.getTime()}:function(T,E){return!T||E.getTime()>T.getTime()}}function S(C,T){for(var E=C[0],I=1,R=C.length;I<R;I++)C[I]&&T(E,C[I])&&(E=C[I]);return E}return{isValid:function(C){return o("next",1,C,C)!==i.NEVER},next:function(C,T,E){return o("next",C||1,T,E)},prev:function(C,T,E){return o("prev",C||1,T,E)},nextRange:function(C,T,E){return o("next",C||1,T,E,!0)},prevRange:function(C,T,E){return o("prev",C||1,T,E,!0)}}},i.setTimeout=function(e,t){var r=i.schedule(t),n;e&&s();function s(){var a=Date.now(),l=r.next(2,a);if(!l[0]){n=void 0;return}var o=l[0].getTime()-a;o<1e3&&(o=l[1]?l[1].getTime()-a:1e3),o<2147483647?n=setTimeout(e,o):n=setTimeout(s,2147483647)}return{isDone:function(){return!n},clear:function(){clearTimeout(n)}}},i.setInterval=function(e,t){if(!e)return;var r=i.setTimeout(s,t),n=r.isDone();function s(){n||(e(),r=i.setTimeout(s,t))}return{isDone:function(){return r.isDone()},clear:function(){n=!0,r.clear()}}},i.date={},i.date.timezone=function(e){i.date.build=e?function(n,s,a,l,o,u){return new Date(n,s,a,l,o,u)}:function(n,s,a,l,o,u){return new Date(Date.UTC(n,s,a,l,o,u))};var t=e?"get":"getUTC",r=Date.prototype;i.date.getYear=r[t+"FullYear"],i.date.getMonth=r[t+"Month"],i.date.getDate=r[t+"Date"],i.date.getDay=r[t+"Day"],i.date.getHour=r[t+"Hours"],i.date.getMin=r[t+"Minutes"],i.date.getSec=r[t+"Seconds"],i.date.isUTC=!e},i.date.UTC=function(){i.date.timezone(!1)},i.date.localTime=function(){i.date.timezone(!0)},i.date.UTC(),i.SEC=1e3,i.MIN=i.SEC*60,i.HOUR=i.MIN*60,i.DAY=i.HOUR*24,i.WEEK=i.DAY*7,i.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],i.NEVER=0,i.date.next=function(e,t,r,n,s,a){return i.date.build(e,t!==void 0?t-1:0,r!==void 0?r:1,n||0,s||0,a||0)},i.date.nextRollover=function(e,t,r,n){var s=r.val(e),a=r.extent(e)[1];return(t||a)<=s||t>a?new Date(n.end(e).getTime()+i.SEC):n.start(e)},i.date.prev=function(e,t,r,n,s,a){var l=arguments.length;return t=l<2?11:t-1,r=l<3?i.D.extent(i.date.next(e,t+1))[1]:r,n=l<4?23:n,s=l<5?59:s,a=l<6?59:a,i.date.build(e,t,r,n,s,a)},i.date.prevRollover=function(e,t,r,n){var s=r.val(e);return t>=s||!t?n.start(n.prev(e,n.val(e)-1)):n.start(e)},i.parse={},i.parse.cron=function(e,t){var r={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12,SUN:1,MON:2,TUE:3,WED:4,THU:5,FRI:6,SAT:7},n={"* * * * * *":"0/1 * * * * *","@YEARLY":"0 0 1 1 *","@ANNUALLY":"0 0 1 1 *","@MONTHLY":"0 0 1 * *","@WEEKLY":"0 0 * * 0","@DAILY":"0 0 * * *","@HOURLY":"0 * * * *"},s={s:[0,0,59],m:[1,0,59],h:[2,0,23],D:[3,1,31],M:[4,1,12],Y:[6,1970,2099],d:[5,1,7,1]};function a(b,w,S){return isNaN(b)?r[b]||null:Math.min(+b+(w||0),S||9999)}function l(b){var w={},S;for(S in b)S!=="dc"&&S!=="d"&&(w[S]=b[S].slice(0));return w}function o(b,w,S,C,T){var E=S;for(b[w]||(b[w]=[]);E<=C;)b[w].indexOf(E)<0&&b[w].push(E),E+=T||1;b[w].sort(function(I,R){return I-R})}function u(b,w,S,C){(w.d&&!w.dc||w.dc&&w.dc.indexOf(C)<0)&&(b.push(l(w)),w=b[b.length-1]),o(w,"d",S,S),o(w,"dc",C,C)}function c(b,w,S){var C={},T={};S===1?(o(w,"D",1,3),o(w,"d",r.MON,r.FRI),o(C,"D",2,2),o(C,"d",r.TUE,r.FRI),o(T,"D",3,3),o(T,"d",r.TUE,r.FRI)):(o(w,"D",S-1,S+1),o(w,"d",r.MON,r.FRI),o(C,"D",S-1,S-1),o(C,"d",r.MON,r.THU),o(T,"D",S+1,S+1),o(T,"d",r.TUE,r.FRI)),b.exceptions.push(C),b.exceptions.push(T)}function d(b,w,S,C,T,E){var I=b.split("/"),R=+I[1],M=I[0];if(M!=="*"&&M!=="0"){var O=M.split("-");C=a(O[0],E,T),T=a(O[1],E,T)||T}o(w,S,C,T,R)}function h(b,w,S,C,T,E){var I,R,M=w.schedules,O=M[M.length-1];b==="L"&&(b=C-1),(I=a(b,E,T))!==null?o(O,S,I,I):(I=a(b.replace("W",""),E,T))!==null?c(w,O,I):(I=a(b.replace("L",""),E,T))!==null?u(M,O,I,C-1):(R=b.split("#")).length===2?(I=a(R[0],E,T),u(M,O,I,a(R[1]))):d(b,O,S,C,T,E)}function g(b){return b.indexOf("#")>-1||b.indexOf("L")>0}function f(b,w){return g(b)&&!g(w)?1:b-w}function m(b){var w={schedules:[{}],exceptions:[]},S=b.replace(/(\s)+/g," ").split(" "),C,T,E,I;for(C in s)if(T=s[C],E=S[T[0]],E&&E!=="*"&&E!=="?"){I=E.split(",").sort(f);var R,M=I.length;for(R=0;R<M;R++)h(I[R],w,C,T[1],T[2],T[3])}return w}function p(b){var w=b.toUpperCase();return n[w]||w}var v=p(e);return m(t?v:"0 "+v)},i.parse.recur=function(){var e=[],t=[],r,n=e,s,a,l,o,u,c,d,h;function g(f,m,p){if(f=o?f+"_"+o:f,r||(n.push({}),r=n[0]),r[f]||(r[f]=[]),s=r[f],l){for(a=[],d=m;d<=p;d+=l)a.push(d);h={n:f,x:l,c:s.length,m:p}}a=u?[m]:c?[p]:a;var v=a.length;for(d=0;d<v;d+=1){var b=a[d];s.indexOf(b)<0&&s.push(b)}a=l=o=u=c=0}return{schedules:e,exceptions:t,on:function(){return a=arguments[0]instanceof Array?arguments[0]:arguments,this},every:function(f){return l=f||1,this},after:function(f){return o="a",a=[f],this},before:function(f){return o="b",a=[f],this},first:function(){return u=1,this},last:function(){return c=1,this},time:function(){for(var f=0,m=a.length;f<m;f++){var p=a[f].split(":");p.length<3&&p.push(0),a[f]=+p[0]*3600+ +p[1]*60+ +p[2]}return g("t"),this},second:function(){return g("s",0,59),this},minute:function(){return g("m",0,59),this},hour:function(){return g("h",0,23),this},dayOfMonth:function(){return g("D",1,c?0:31),this},dayOfWeek:function(){return g("d",1,7),this},onWeekend:function(){return a=[1,7],this.dayOfWeek()},onWeekday:function(){return a=[2,3,4,5,6],this.dayOfWeek()},dayOfWeekCount:function(){return g("dc",1,c?0:5),this},dayOfYear:function(){return g("dy",1,c?0:366),this},weekOfMonth:function(){return g("wm",1,c?0:5),this},weekOfYear:function(){return g("wy",1,c?0:53),this},month:function(){return g("M",1,12),this},year:function(){return g("Y",1970,2450),this},fullDate:function(){for(var f=0,m=a.length;f<m;f++)a[f]=a[f].getTime();return g("fd"),this},customModifier:function(f,m){var p=i.modifier[f];if(!p)throw new Error("Custom modifier "+f+" not recognized!");return o=f,a=arguments[1]instanceof Array?arguments[1]:[arguments[1]],this},customPeriod:function(f){var m=i[f];if(!m)throw new Error("Custom time period "+f+" not recognized!");return g(f,m.extent(new Date)[0],m.extent(new Date)[1]),this},startingOn:function(f){return this.between(f,h.m)},between:function(f,m){return r[h.n]=r[h.n].splice(0,h.c),l=h.x,g(h.n,f,m),this},and:function(){return r=n[n.push({})-1],this},except:function(){return n=t,r=null,this}}},i.parse.text=function(e){var t=i.parse.recur,r=0,n="",s,a={eof:/^$/,fullDate:/^(\d\d\d\d-\d\d-\d\dt\d\d:\d\d:\d\d)\b/,rank:/^((\d\d\d\d)|([2-5]?1(st)?|[2-5]?2(nd)?|[2-5]?3(rd)?|(0|[1-5]?[4-9]|[1-5]0|1[1-3])(th)?))\b/,time:/^((([0]?[1-9]|1[0-2]):[0-5]\d(\s)?(am|pm))|(([0]?\d|1\d|2[0-3]):[0-5]\d))\b/,dayName:/^((sun|mon|tue(s)?|wed(nes)?|thu(r(s)?)?|fri|sat(ur)?)(day)?)\b/,monthName:/^(jan(uary)?|feb(ruary)?|ma((r(ch)?)?|y)|apr(il)?|ju(ly|ne)|aug(ust)?|oct(ober)?|(sept|nov|dec)(ember)?)\b/,yearIndex:/^(\d\d\d\d)\b/,every:/^every\b/,after:/^after\b/,before:/^before\b/,second:/^(s|sec(ond)?(s)?)\b/,minute:/^(m|min(ute)?(s)?)\b/,hour:/^(h|hour(s)?)\b/,day:/^(day(s)?( of the month)?)\b/,dayInstance:/^day instance\b/,dayOfWeek:/^day(s)? of the week\b/,dayOfYear:/^day(s)? of the year\b/,weekOfYear:/^week(s)?( of the year)?\b/,weekOfMonth:/^week(s)? of the month\b/,weekday:/^weekday\b/,weekend:/^weekend\b/,month:/^month(s)?\b/,year:/^year(s)?\b/,between:/^between (the)?\b/,start:/^(start(ing)? (at|on( the)?)?)\b/,at:/^(at|@)\b/,and:/^(,|and\b)/,except:/^(except\b)/,also:/(also)\b/,first:/^(first)\b/,last:/^last\b/,in:/^in\b/,of:/^of\b/,onthe:/^on the\b/,on:/^on\b/,through:/(-|^(to|through)\b)/},l={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12,sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7,"1st":1,fir:1,"2nd":2,sec:2,"3rd":3,thi:3,"4th":4,for:4};function o(C,T,E,I){return{startPos:C,endPos:T,text:E,type:I}}function u(C){var T=C instanceof Array?C:[C],E=/\s+/,I,R,M,O,A,B;for(T.push(E),A=r;!I||I.type===E;){B=-1,R=n.substring(A),I=o(A,A,n.split(E)[0]);var L,Y=T.length;for(L=0;L<Y;L++)O=T[L],M=O.exec(R),M&&M.index===0&&M[0].length>B&&(B=M[0].length,I=o(A,A+B,R.substring(0,B),O));I.type===E&&(A=I.endPos)}return I}function c(C){var T=u(C);return r=T.endPos,T}function d(C){for(var T=+w(C),E=v(a.through)?+w(C):T,I=[],R=T;R<=E;R++)I.push(R);return I}function h(C){for(var T=d(C);v(a.and);)T.push.apply(T,d(C));return C===a.dayName&&T.sort((E,I)=>E-I),T}function g(C){var T,E,I,R;v(a.weekend)?C.on(l.sun,l.sat).dayOfWeek():v(a.weekday)?C.on(l.mon,l.tue,l.wed,l.thu,l.fri).dayOfWeek():(T=w(a.rank),C.every(T),E=p(C),v(a.start)?(T=w(a.rank),C.startingOn(T),b(E.type)):v(a.between)&&(I=w(a.rank),v(a.and)&&(R=w(a.rank),C.between(I,R))))}function f(C){v(a.first)?C.first():v(a.last)?C.last():C.on(h(a.rank)),p(C)}function m(C){r=0,n=C,s=-1;for(var T=t();r<n.length&&s<0;){var E=b([a.every,a.after,a.before,a.onthe,a.on,a.of,a.in,a.at,a.and,a.except,a.also]);switch(E.type){case a.every:g(T);break;case a.after:u(a.time).type!==void 0?(T.after(w(a.time)),T.time()):u(a.fullDate).type!==void 0?(T.after(w(a.fullDate)),T.fullDate()):(T.after(w(a.rank)),p(T));break;case a.before:u(a.time).type!==void 0?(T.before(w(a.time)),T.time()):u(a.fullDate).type!==void 0?(T.before(w(a.fullDate)),T.fullDate()):(T.before(w(a.rank)),p(T));break;case a.onthe:f(T);break;case a.on:T.on(h(a.dayName)).dayOfWeek();break;case a.of:T.on(h(a.monthName)).month();break;case a.in:T.on(h(a.yearIndex)).year();break;case a.at:for(T.on(w(a.time)).time();v(a.and);)T.on(w(a.time)).time();break;case a.and:break;case a.also:T.and();break;case a.except:T.except();break;default:s=r}}return{schedules:T.schedules,exceptions:T.exceptions,error:s}}function p(C){var T=b([a.second,a.minute,a.hour,a.dayOfYear,a.dayOfWeek,a.dayInstance,a.day,a.month,a.year,a.weekOfMonth,a.weekOfYear]);switch(T.type){case a.second:C.second();break;case a.minute:C.minute();break;case a.hour:C.hour();break;case a.dayOfYear:C.dayOfYear();break;case a.dayOfWeek:C.dayOfWeek();break;case a.dayInstance:C.dayOfWeekCount();break;case a.day:C.dayOfMonth();break;case a.weekOfMonth:C.weekOfMonth();break;case a.weekOfYear:C.weekOfYear();break;case a.month:C.month();break;case a.year:C.year();break;default:s=r}return T}function v(C){var T=u(C).type===C;return T&&c(C),T}function b(C){var T=c(C);return T.type?T.text=S(T.text,C):s=r,T}function w(C){return b(C).text}function S(C,T){var E=C;switch(T){case a.time:var I=C.split(/(:|am|pm)/),R=I[3]==="pm"&&I[0]<12?parseInt(I[0],10)+12:I[0],M=I[2].trim();E=(R.length===1?"0":"")+R+":"+M;break;case a.rank:E=parseInt(/^\d+/.exec(C)[0],10);break;case a.monthName:case a.dayName:E=l[C.substring(0,3)];break;case a.fullDate:E=new Date(C.toUpperCase());break}return E}return m(e.toLowerCase())},i}();tu.date.localTime();var Va=tu;function Jf(i){const e=[],t=[];let r;const n=function*(){for(r||(r=i[Symbol.iterator]());e.length&&(yield*e,e.length=0),!!r;){const{value:a,done:l}=r.next();if(l){r=null,i=null;break}t.push(a),yield a}},s=function*(){for(r||(r=i[Symbol.iterator]());t.length&&(yield*t,t.length=0),!!r;){const{value:a,done:l}=r.next();if(l){r=null,i=null;break}e.push(a),yield a}};return[n(),s()]}function*qC(i,e){if(e<0)throw new Error("Batch size needs to a natural number");e=e|0;const t=[];for(const r of i)t.length===e&&(yield t,t.length=0),t.push(r);t.length>0&&(yield t)}function*KC(i,e){let t=0;for(const r of i)e(r,t++)&&(yield r)}function*GC(i,e){let t=0;for(const r of i)++t>e&&(yield r)}function XC(i,e){let t=0;for(const r of i)if(!e(r,t++))return!1;return!0}function ZC(i,e){let t=0;for(const r of i)if(e(r,t++))return!0;return!1}function*JC(i,e){let t=0;for(const r of i)yield e(r,t++)}function QC(i,e,t){let r=0,n=t;for(const s of i)n=e(n,s,r++);return n}function*eS(i){const e=new Set;for(const t of i)e.has(t)||(e.add(t),yield t)}function*tS(i,e){const t=new Set;for(const r of i){const n=e(r);t.has(n)||(t.add(n),yield r)}}function*rS(i,e){let t=0;for(const r of i)if(e(r,t++))yield r;else return}function*iS(i){for(const e of i)yield*e}var ru=class dl{constructor(e){if(this.iterable=void 0,!e)throw new Error("Require an iterable instance for chaining");this.iterable=e}derive(e){return this.iterable=void 0,new dl(e)}copy(){const[e,t]=Jf(this.iterable);return this.iterable=t,new dl(e)}split(){const[e,t]=Jf(this.iterable);return[new dl(e),this.derive(t)]}inBatchesBySize(e){return this.derive(qC(this.iterable,e))}filter(e){return this.derive(KC(this.iterable,e))}drop(e){return this.derive(GC(this.iterable,e))}map(e){return this.derive(JC(this.iterable,e))}reduce(e,t){return QC(this,e,t)}concat(){return this.derive(iS(this.iterable))}uniqueOnly(){return this.derive(eS(this.iterable))}uniqueOnlyBy(e){return this.derive(tS(this.iterable,e))}every(e){return XC(this,e)}some(e){return ZC(this,e)}takeWhile(e){return this.derive(rS(this.iterable,e))}*[Symbol.iterator](){let e=this.iterable;if(!e)throw new Error("Chained iterator already exhausted or used to derive the new one");this.iterable=void 0,yield*e,e=void 0}toArray(){return Array.from(this)}sort(e){return Array.from(this).sort(e)}toSet(){return new Set(this)}toMap(){return new Map(this)}flush(){for(const e of this);}memoize(){return new Qf(this)}},nS=i=>new ru(i),cr=nS,Qf=class extends ru{constructor(){super(...arguments),this.elements=[],this.$iterator=void 0}set iterable(i){this.$iterable=i}get iterable(){return this}derive(i){return new ru(i)}*[Symbol.iterator](){const i=this.elements;if(this.$iterable){this.$iterator||(this.$iterator=this.$iterable[Symbol.iterator]());let e=this.$iterator,t=i.length;for(t>0&&(yield*i);;){if(i.length>t){for(let s=t;s<i.length;s++)yield i[s];t=i.length}if(!e)break;const{value:r,done:n}=e.next();n?(e=this.$iterator=null,this.$iterable=null):(i.push(r),t++,yield r)}}else yield*i}},sS=i=>new Qf(i),eg=sS,ja=Symbol("MixinIdentity"),ps=Symbol("MixinStateProperty"),aS=class{constructor(){this.baseEl=void 0,this.sourceEl=void 0,this.$elementsByTopoLevel=void 0,this.$topoLevels=void 0,this.linearizedByTopoLevelsSource=eg(this.linearizedByTopoLevels())}static new(i){const e=new this;return i&&Object.assign(e,i),e}get topoLevels(){return this.$topoLevels!==void 0?this.$topoLevels:this.$topoLevels=this.buildTopoLevels()}buildTopoLevels(){return Array.from(this.elementsByTopoLevel.keys()).sort((i,e)=>i-e)}get elementsByTopoLevel(){return this.$elementsByTopoLevel!==void 0?this.$elementsByTopoLevel:this.$elementsByTopoLevel=this.buildElementsByTopoLevel()}getOrCreateLevel(i,e){let t=i.get(e);return t||(t=[],i.set(e,t)),t}buildElementsByTopoLevel(){let i=0;const e=this.baseEl?cr(this.baseEl.walkDepthState.elementsByTopoLevel.values()).concat().toSet():new Set,t=cr(this.sourceEl.requirements).map(r=>r.walkDepthState.elementsByTopoLevel).concat().reduce((r,[n,s])=>(n>i&&(i=n),this.getOrCreateLevel(r,n).push(s),r),new Map);return this.getOrCreateLevel(t,i+1).push([this.sourceEl]),cr(t).map(([r,n])=>[r,cr(n).concat().uniqueOnly().filter(s=>!e.has(s)).sort((s,a)=>s.id-a.id)]).toMap()}*linearizedByTopoLevels(){yield*cr(this.topoLevels).map(i=>this.elementsByTopoLevel.get(i)).concat()}},tg=1,lS=i=>class extends i{},za=class{},iu=class{constructor(){this.id=tg++,this.requirements=[],this.baseClass=za,this.identitySymbol=void 0,this.mixinLambda=lS,this.walkDepthState=void 0,this.$minimalClass=void 0,this.name=""}static new(i){const e=new this;i&&Object.assign(e,i),e.walkDepthState=aS.new({sourceEl:e,baseEl:uS(e.baseClass)});const t=e.mixinLambda,r=e.identitySymbol=Symbol(t.name),n=Object.assign(function(s){const a=t(s);return a.prototype[r]=!0,a},{[ja]:r,[ps]:e});return Object.defineProperty(n,Symbol.hasInstance,{value:rg}),e.mixinLambda=n,e}get minimalClass(){return this.$minimalClass!==void 0?this.$minimalClass:this.$minimalClass=this.buildMinimalClass()}getBaseClassMixinId(i){const e=this.constructor,t=e.baseClassesIds.get(i);if(t!==void 0)return t;const r=tg++;return e.baseClassesIds.set(i,r),r}buildMinimalClass(){const i=this.constructor;let e=this.baseClass;const t=this.walkDepthState.linearizedByTopoLevelsSource.reduce((n,s)=>{const{cls:a,hash:l}=n,o=l+String.fromCharCode(s.id);let u=i.minimalClassesByLinearHash.get(o);return u||(u=s.mixinLambda(a),s.name=u.name,i.minimalClassesByLinearHash.set(o,u)),n.cls=u,n.hash=o,n},{cls:e,hash:String.fromCharCode(this.getBaseClassMixinId(e))}).cls,r=Object.assign(t,{[ja]:this.identitySymbol,[ps]:this,mix:this.mixinLambda,derive:n=>te([r,n],s=>class extends s{}),$:this,toString:this.toString.bind(this)});return Object.defineProperty(r,Symbol.hasInstance,{value:rg}),r}toString(){return this.walkDepthState.linearizedByTopoLevelsSource.reduce((i,e)=>`${e.name}(${i})`,this.baseClass.name)}};iu.minimalClassesByLinearHash=new Map,iu.baseClassesIds=new Map;var oS=i=>Object.getPrototypeOf(i.prototype).constructor.hasOwnProperty(ps),uS=i=>Object.getPrototypeOf(i.prototype).constructor[ps],cS=(i,e)=>{let t;if(i.length>0){const s=i[i.length-1];!oS(s)&&s!==za&&(t=s)}const r=[];return i.forEach((s,a)=>{const l=s[ps];if(l!==void 0){const o=l.baseClass;if(o!==za)if(t){if(t!==o){const u=o.prototype.isPrototypeOf(t.prototype),c=t.prototype.isPrototypeOf(o.prototype);if(!u&&!c)throw new Error("Base class mismatch");t=c?o:t}}else t=o;r.push(l)}else if(a!==i.length-1)throw new Error("Base class should be provided as the last element of the requirements array")}),iu.new({requirements:r,mixinLambda:e,baseClass:t||za}).minimalClass},rg=function(i){return!!(i&&i[this[ja]])},bt=(i,e)=>!!(i&&i[e[ja]]),te=cS,dS=class{initialize(i){i&&Object.assign(this,i)}static new(i){const e=new this;return e.initialize(i),e}},Li;(function(i){i.Millisecond="millisecond",i.Second="second",i.Minute="minute",i.Hour="hour",i.Day="day",i.Week="week",i.Month="month",i.Quarter="quarter",i.Year="year"})(Li||(Li={}));var nu;(function(i){i.Honor="honor",i.Ignore="ignore",i.Conflict="conflict"})(nu||(nu={}));var su;(function(i){i.MustStartOn="muststarton",i.MustFinishOn="mustfinishon",i.StartNoEarlierThan="startnoearlierthan",i.StartNoLaterThan="startnolaterthan",i.FinishNoEarlierThan="finishnoearlierthan",i.FinishNoLaterThan="finishnolaterthan",i.AsSoonAsPossible="assoonaspossible",i.AsLateAsPossible="aslateaspossible"})(su||(su={}));var au;(function(i){i.Normal="Normal",i.FixedDuration="FixedDuration",i.FixedEffort="FixedEffort",i.FixedUnits="FixedUnits"})(au||(au={}));var lu;(function(i){i[i.NoError=0]="NoError",i[i.CyclicDependency=1]="CyclicDependency",i[i.DuplicatingDependency=2]="DuplicatingDependency"})(lu||(lu={}));var ou;(function(i){i[i.StartToStart=0]="StartToStart",i[i.StartToEnd=1]="StartToEnd",i[i.EndToStart=2]="EndToStart",i[i.EndToEnd=3]="EndToEnd"})(ou||(ou={}));var uu;(function(i){i.Project="Project",i.FromEvent="FromEvent",i.ToEvent="ToEvent"})(uu||(uu={}));var cu;(function(i){i[i.SchedulerBasic=1]="SchedulerBasic",i[i.SchedulerPro=2]="SchedulerPro",i[i.Gantt=3]="Gantt"})(cu||(cu={}));var du;(function(i){i.Forward="Forward",i.Backward="Backward",i.None="None"})(du||(du={}));var hS=(i,e)=>i&&!e||!i&&e?!1:!i&&!e?!0:i.direction===e.direction&&(i.kind==="own"&&e.kind==="own"||i.kind==="enforced"&&e.kind==="enforced"&&i.enforcedBy===e.enforcedBy||i.kind==="inherited"&&e.kind==="inherited"&&i.inheritedFrom===e.inheritedFrom),hu;(function(i){i.Start="Start",i.End="End"})(hu||(hu={}));var Nr=new Date(-864e13),dr=new Date(864e13),fS=i=>{if(!i)return!1;const e=i.getTime();return e!==Nr.getTime()&&e!==dr.getTime()},Br;(function(i){i[i.Left=0]="Left",i[i.Right=1]="Right"})(Br||(Br={}));var Je;(function(i){i[i.FullRangeIterated=0]="FullRangeIterated",i[i.StoppedByIterator=1]="StoppedByIterator",i[i.MaxCacheExtendCyclesReached=2]="MaxCacheExtendCyclesReached",i[i.MaxRangeReached=3]="MaxRangeReached"})(Je||(Je={}));var fu=class{constructor(i){this.cacheFilledStartDate=dr,this.cacheFilledEndDate=Nr,this.intervalsCachingChunkDuration=30,this.intervalsCachingChunkUnit=Li.Day,this.maxCacheExtendCycles=1e3,this.maxRange=5*365*24*60*60*1e3,i&&Object.assign(this,i)}includeWrappingRangeFrom(i,e,t){i.ensureCacheFilledForInterval(e,t),this.intervalCache.includeWrappingRange(i.intervalCache,e,t)}ensureCacheFilledForInterval(i,e){const t=this.cacheFilledStartDate.getTime(),r=this.cacheFilledEndDate.getTime();if(t!==dr.getTime()){const n=i.getTime(),s=e.getTime();if(t<=n&&s<=r)return;if(s<=t)e=new Date(t-1);else if(n>=r)i=new Date(r);else if(t<=n&&n<=r)i=new Date(r+1);else if(t<=s&&s<=r)e=new Date(t-1);else{this.ensureCacheFilledForInterval(i,new Date(t-1)),this.ensureCacheFilledForInterval(new Date(r+1),e);return}}(t===dr.getTime()||i.getTime()<r)&&(this.cacheFilledStartDate=i),(r===Nr.getTime()||r<e.getTime())&&(this.cacheFilledEndDate=e),this.fillCache(i,e)}fillCache(i,e){throw new Error("Abstract method")}clear(){this.cacheFilledStartDate=dr,this.cacheFilledEndDate=Nr,this.intervalCache.clear()}forEachAvailabilityInterval(i,e,t){var r;t=t||this;const n=i.startDate,s=i.endDate,a=n&&n.getTime(),l=s&&s.getTime(),o=(r=i.maxRange)!=null?r:this.maxRange,u=i.isForward!==!1;if(u?!n:!s)throw new Error("At least `startDate` or `endDate` is required, depending from the `isForward` option");const c=this.intervalCache;let d=u?n:s,h=u?n:s;const g=h.getTime();for(let f=1;f<this.maxCacheExtendCycles;f++){u?this.ensureCacheFilledForInterval(d,s||k.add(d,this.intervalsCachingChunkDuration,this.intervalsCachingChunkUnit)):this.ensureCacheFilledForInterval(n||k.add(d,-this.intervalsCachingChunkDuration,this.intervalsCachingChunkUnit),d);let m=c.getIntervalOf(h,u?Br.Left:Br.Right);for(;m;){const p=m.startDate,v=m.endDate;if(u&&l&&p.getTime()>=l||!u&&a&&v.getTime()<=a)return Je.FullRangeIterated;if(u&&p.getTime()-g>=o||!u&&g-v.getTime()>=o)return Je.MaxRangeReached;if(u&&p.getTime()>=this.cacheFilledEndDate.getTime()||!u&&v.getTime()<=this.cacheFilledStartDate.getTime())break;h=u?v:p;const b=a&&p.getTime()<a?n:p,w=l&&v.getTime()>l?s:v;if(e.call(t,b,w,m.cacheInterval)===!1)return Je.StoppedByIterator;m=u?c.getNextInterval(m):c.getPrevInterval(m)}if(u&&h.getTime()===dr.getTime()||!u&&h.getTime()===Nr.getTime())return Je.FullRangeIterated;d=u?this.cacheFilledEndDate:this.cacheFilledStartDate}return Je.MaxCacheExtendCyclesReached}},vs=i=>Array.from(new Set(i)),ig=class Uu{constructor(e){if(this.intervals=[],e&&Object.assign(this,e),!this.calendar)throw new Error("Required attribute `calendar` is missing")}includeInterval(e){if(this.intervals.indexOf(e)==-1){const t=this.intervals.slice();return t.push(e),new Uu({intervals:t,calendar:this.calendar})}else return this}combineWith(e){return new Uu({intervals:this.intervals.concat(e.intervals),calendar:this.calendar})}getIsWorking(){if(this.isWorking!=null)return this.isWorking;const e=this.intervals=this.normalizeIntervals(this.intervals);return this.isWorking=e[0].isWorking}normalizeIntervals(e){const t=vs(e);return t.sort((r,n)=>n.getPriorityField()-r.getPriorityField()),t}},ng=class Em{constructor(e){this.intervalGroups=[],e&&Object.assign(this,e)}combineWith(e){const t=this.intervalGroups.slice();return t.push([e.calendar,e]),new Em({intervalGroups:t})}getIsWorkingForEvery(){if(this.isWorkingForEvery!=null)return this.isWorkingForEvery;for(let[e,t]of this.getGroups())if(!t[0].isWorking)return this.isWorkingForEvery=!1;return this.isWorkingForEvery=!0}getIsWorkingForSome(){if(this.isWorkingForSome!=null)return this.isWorkingForSome;for(let[e,t]of this.getGroups())if(t[0].isWorking)return this.isWorkingForSome=!0;return this.isWorkingForSome=!1}getCalendars(){return this.getGroups(),this.calendars}isCalendarWorking(e){return this.getCalendarsWorkStatus().get(e)}getCalendarsWorkStatus(){if(this.calendarsWorkStatus)return this.calendarsWorkStatus;const e=new Map;for(let[t,r]of this.getGroups())e.set(t,r[0].isWorking);return this.calendarsWorkStatus=e}getCalendarsWorking(){if(this.calendarsWorking)return this.calendarsWorking;const e=[];for(let[t,r]of this.getGroups())r[0].isWorking&&e.push(t);return this.calendarsWorking=e}getCalendarsNonWorking(){if(this.calendarsNonWorking)return this.calendarsNonWorking;const e=[];for(let[t,r]of this.getGroups())r[0].isWorking||e.push(t);return this.calendarsNonWorking=e}getGroups(){if(this.intervalsByCalendar)return this.intervalsByCalendar;const e=this.calendars=[],t=new Map;return this.intervalGroups.forEach(([r,n])=>{let s=t.get(r);s||(e.push(r),s=[],t.set(r,s)),s.push.apply(s,n.intervals)}),t.forEach((r,n)=>{const s=vs(r);s.sort((a,l)=>l.getPriorityField()-a.getPriorityField()),t.set(n,s)}),this.intervalsByCalendar=t}},ys=(i,e,t=(r,n)=>r-n)=>{let r=0,n=e.length;for(;r<n;){const s=(r+n)/2|0,a=t(i,e[s]);if(a===0)return{found:!0,index:s};a<0?n=s:r=s+1}return{found:!1,index:n}},Vr;(function(i){i[i.Exact=0]="Exact",i[i.Next=1]="Next"})(Vr||(Vr={}));var sg=class{constructor(i){this.keys=[],this.values=[],this.comparator=i||((e,t)=>e-t)}set(i,e){const t=ys(i,this.keys,this.comparator);return t.found?this.values[t.index]=e:(this.keys.splice(t.index,0,i),this.values.splice(t.index,0,e)),t.index}insertAt(i,e,t){this.keys.splice(i,0,e),this.values.splice(i,0,t)}setValueAt(i,e){this.values[i]=e}get(i){const e=ys(i,this.keys,this.comparator);return e.found?this.values[e.index]:void 0}getEntryAt(i){return i<this.keys.length?{key:this.keys[i],value:this.values[i]}:void 0}getKeyAt(i){return this.keys[i]}getValueAt(i){return this.values[i]}delete(i){const e=ys(i,this.keys,this.comparator);e.found&&this.deleteAt(e.index)}size(){return this.keys.length}deleteAt(i){this.keys.splice(i,1),this.values.splice(i,1)}indexOfKey(i){const e=ys(i,this.keys,this.comparator);return{found:e.found?Vr.Exact:Vr.Next,index:e.index}}map(i){const e=this.keys,t=this.values,r=[];for(let n=0;n<e.length;n++)r.push(i(t[n],e[n],n));return r}getAllEntries(){return this.map((i,e)=>({value:i,key:e}))}clear(){this.keys.length=0,this.values.length=0}},gu=class{constructor(i){if(this.points=new sg((e,t)=>e.getTime()-t.getTime()),this.leftInfinityKey=Nr,this.rightInfinityKey=dr,Object.assign(this,i),this.emptyInterval===void 0||!this.combineIntervalsFn)throw new Error("All of `emptyPoint`, `combineIntervalsFn` are required");this.points.set(this.leftInfinityKey,this.emptyInterval)}size(){return this.points.size()}indexOf(i){return this.points.indexOfKey(i)}getDateAt(i){return this.points.getKeyAt(i)}getPointAt(i){return this.points.getValueAt(i)}getIntervalOf(i,e=Br.Left){let{found:t,index:r}=this.indexOf(i),n;return e===Br.Left?n=t===Vr.Exact?r:r-1:n=r-1,this.getIntervalWithStartDateIndex(n)}getPrevInterval(i){return i.startDateIndex===0?null:this.getIntervalWithStartDateIndex(i.startDateIndex-1)}getNextInterval(i){return i.startDateIndex>=this.size()-1?null:this.getIntervalWithStartDateIndex(i.startDateIndex+1)}getIntervalWithStartDateIndex(i){return{startDateIndex:i,startDate:this.getDateAt(i),endDate:i+1<this.size()?this.getDateAt(i+1):this.rightInfinityKey,cacheInterval:this.getPointAt(i)}}addInterval(i,e,t){const r=this.points,{found:n,index:s}=r.indexOfKey(i);let a,l;if(n==Vr.Exact){const o=t(l=r.getValueAt(s));r.setValueAt(s,o),a=s+1}else{const o=t(l=r.getValueAt(s-1));r.insertAt(s,i,o),a=s+1}for(;a<r.size()&&!(r.getKeyAt(a).getTime()>=e.getTime());){const u=t(l=r.getValueAt(a));r.setValueAt(a,u),a++}a===r.size()?r.insertAt(r.size(),e,this.emptyInterval):r.getKeyAt(a).getTime()===e.getTime()||r.insertAt(a,e,l)}includeWrappingRange(i,e,t){let r=i.getIntervalOf(e);for(;r&&(this.addInterval(r.startDate,r.endDate,n=>this.combineIntervalsFn(n,r.cacheInterval)),!(r.endDate.getTime()>t.getTime()));)r=i.getNextInterval(r)}getSummary(){return this.points.map((i,e)=>({label:i,date:e}))}clear(){this.points.clear(),this.points.set(this.leftInfinityKey,this.emptyInterval)}},ag=class extends fu{constructor(i){super(i),this.calendarCaches=vs(this.calendarCaches),this.intervalCache=new gu({emptyInterval:new ng,combineIntervalsFn:(e,t)=>e.combineWith(t)})}fillCache(i,e){this.calendarCaches.forEach(t=>{t.fillCache(i,e),this.includeWrappingRangeFrom(t,i,e)})}},gS=new Map,mS=i=>{const e=vs(i);if(e.length===0)throw new Error("No calendars to combine");e.sort((a,l)=>a.internalId<l.internalId?-1:1);const t=e.map(a=>a.internalId+"/").join(""),r=e.map(a=>a.version+"/").join("");let n=gS.get(t),s;return n&&n.versionsHash===r?s=n.cache:s=new ag({calendarCaches:e.map(a=>a.calendarCache)}),s},lg=class extends fu{constructor(i){if(super(i),this.staticIntervalsCached=!1,!this.unspecifiedTimeInterval)throw new Error("Required attribute `unspecifiedTimeInterval` is missing");this.intervalCache=new gu({emptyInterval:new ig({intervals:[this.unspecifiedTimeInterval],calendar:this.calendar}),combineIntervalsFn:(e,t)=>e.combineWith(t)})}fillCache(i,e){var t;this.staticIntervalsCached||(this.cacheStaticIntervals(),this.staticIntervalsCached=!0),this.parentCache&&this.includeWrappingRangeFrom(this.parentCache,i,e);const r=i.getTime(),n=e.getTime(),s=this.calendar.ignoreTimeZone?null:(t=this.calendar.project)==null?void 0:t.timeZone;if(r>n)throw new Error("Invalid cache fill interval");const a=Va.NEVER;this.forEachRecurrentInterval(l=>{const o=l.getStartDateSchedule(),u=l.getEndDateSchedule();let c=o.prev(1,i),d;if(u==="EOD"){const f=o.next(1,e);f!==a?d=k.getStartOfNextDay(f,!0):d=a}else d=u.next(1,e);if(c!==a&&c.getTime()===r){const f=o.prev(2,i);f!==a&&f.length===2&&(c=f[1])}if(d!==a&&d.getTime()===n){const f=u.next(2,e);f!==a&&f.length===2&&(d=f[1])}const h=o.next(1/0,c!==a?c:i,d!==a?new Date(d.getTime()-1):e);if(h===a)return;const g=u==="EOD"?h.map(f=>k.getStartOfNextDay(f,!0)):u.next(1/0,new Date(h[0].getTime()+1),d!==a?d:e);g!==a&&(g.length>h.length?g.length=h.length:g.length<h.length&&(h.length=g.length),h.forEach((f,m)=>{let p=f,v=g[m];s!=null&&(p=Ve.toTimeZone(p,s),v=Ve.toTimeZone(v,s)),this.intervalCache.addInterval(p,v,b=>b.includeInterval(l))}))})}clear(){this.staticIntervalsCached=!1,super.clear()}cacheStaticIntervals(){this.forEachStaticInterval(i=>{var e;const t=(e=this.calendar.project)==null?void 0:e.timeZone;let{startDate:r,endDate:n}=i;t!=null&&(r=Ve.toTimeZone(r,t),n=Ve.toTimeZone(n,t)),this.intervalCache.addInterval(r,n,s=>s.includeInterval(i))})}forEachStaticInterval(i){this.intervalStore.forEach(e=>{e.isStatic()&&i(e)})}forEachRecurrentInterval(i){this.intervalStore.forEach(e=>{e.isRecurrent()&&i(e)})}},Wa=class extends te([],i=>{const e=i.prototype;class t extends i{async commitAsync(){return this.project.commitAsync()}set project(n){this.$project=n}get project(){return this.$project}calculateProject(){throw new Error("Implement me")}setProject(n){return this.project=n}getProject(){return this.project?this.project:this.setProject(this.calculateProject())}getAssignmentStore(){const n=this.getProject();return n==null?void 0:n.assignmentStore}getDependencyStore(){const n=this.getProject();return n==null?void 0:n.dependencyStore}getEventStore(){const n=this.getProject();return n==null?void 0:n.eventStore}getResourceStore(){const n=this.getProject();return n==null?void 0:n.resourceStore}getCalendarManagerStore(){const n=this.getProject();return n==null?void 0:n.calendarManagerStore}}return t}){},nt=class extends te([Wa,re],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this.isLoadingData=!1,this.disableHasLoadedDataToCommitFlag=!1}static get $name(){return"AbstractPartOfProjectStoreMixin"}construct(n={}){return n.asyncEvents={add:!0,remove:!0,removeAll:!0,change:!0,refresh:!0,replace:!0,move:!0,update:!0},e.construct.call(this,n)}trigger(n,s){const a=this,{asyncEvents:l,project:o}=a,u=l==null?void 0:l[n];return u&&(u===!0||u[s.action])?(e.trigger.call(a,`${n}PreCommit`,{...s}),!o||o.isEngineReady()&&!o.isWritingData?e.trigger.call(a,n,s):!a.eventsSuspended&&o&&(o.dataReadyDetacher||(o.queuedDataReadyEvents=[],o.dataReadyDetacher=o.ion({dataReady(){this.queuedDataReadyEvents.forEach(([d,h,g,f])=>{d.trigger.call(h,g,f)}),o.queuedDataReadyEvents=null,o.dataReadyDetacher(),o.dataReadyDetacher=null},once:!0})),o.queuedDataReadyEvents.push([e,a,n,s])),!0):e.trigger.call(a,n,s)}calculateProject(){return this.project}setStoreData(n){var s;this.project&&!(this.syncDataOnLoad||this.disableHasLoadedDataToCommitFlag)&&(this.project.hasLoadedDataToCommit=!0),this.isLoadingData=!0,e.setStoreData.call(this,n),this.isLoadingData=!1,(s=this.project)==null||s.trigger("storeRefresh",{store:this})}async doAutoCommit(){this.suspendCount<=0&&this.project&&!this.project.isEngineReady()&&await this.project.commitAsync(),e.doAutoCommit.call(this)}async addAsync(n,s){const a=this.add(n,s);return await this.project.commitAsync(),a}async insertAsync(n,s,a){const l=this.insert(n,s,a);return await this.project.commitAsync(),l}async loadDataAsync(n){this.data=n,await this.project.commitAsync()}performFilter(){var n;return this.project&&(this.isLoadingData||(n=this.rootNode)!=null&&n.isLoading)&&this.project.commitAsync().then(()=>this.filter()),super.performFilter(...arguments)}}return t}){},bs=class extends te([Wa,Q],i=>{const e=i.prototype;class t extends i{joinStore(n){let s=null;if(bt(n,nt)){const a=n.getProject();a&&!this.getProject()&&(this.setProject(a),s=a)}e.joinStore.call(this,n),s&&!s.isRepopulatingStores&&this.joinProject()}unjoinStore(n,s=!1){e.unjoinStore.call(this,n,s);const{project:a}=this,l=bt(n,nt)&&!n.isFillingFromMaster&&a===(n.isChained&&n.project?n.masterStore.project:n.project);a&&!a.isDestroying&&!a.isRepopulatingStores&&l&&(this.leaveProject(s),this.setProject(null)),l&&(this.graph=null)}joinProject(){}leaveProject(n=!1){}calculateProject(){const n=this.stores.find(s=>bt(s,nt)&&!!s.getProject());return n==null?void 0:n.getProject()}async setAsync(n,s,a){var l;const o=this.set(n,s,a);return await((l=this.project)==null?void 0:l.commitAsync()),o}async getAsync(n){var s;return await((s=this.project)==null?void 0:s.commitAsync()),this.get(n)}get isStmRestoring(){const n=this.getProject();return(n==null?void 0:n.isRestoringData)||(n==null?void 0:n.stm.isRestoring)||!1}}return t}){},mu=class extends te([bs],i=>{const e=i.prototype;class t extends i{static get fields(){return["name",{name:"startDate",type:"date"},{name:"endDate",type:"date"},"recurrentStartDate","recurrentEndDate","cls","iconCls",{name:"isWorking",type:"boolean",defaultValue:!1},{name:"priority",type:"number"}]}getCalendar(){return this.stores[0].calendar}resetPriority(){this.priorityField=null,this.getCalendar().getDepth()}getPriorityField(){if(this.priorityField!=null)return this.priorityField;let n=1e4+this.getCalendar().getDepth()*100,s=this.priority;return s==null&&(s=this.isRecurrent()?20:30),this.priorityField=n+s}isRecurrent(){return!!(this.recurrentStartDate&&this.recurrentEndDate&&this.getStartDateSchedule()&&this.getEndDateSchedule())}isStatic(){return!!(this.startDate&&this.endDate)}parseDateSchedule(n){let s=n;if(n&&n!==Object(n)&&(s=Va.parse.text(n),s!==Object(s)||s.error>=0))try{s=JSON.parse(n)}catch(a){return null}return s}getStartDateSchedule(){if(this.startDateSchedule)return this.startDateSchedule;const n=this.parseDateSchedule(this.recurrentStartDate);return this.startDateSchedule=Va.schedule(n)}getEndDateSchedule(){if(this.endDateSchedule)return this.endDateSchedule;if(this.recurrentEndDate==="EOD")return"EOD";const n=this.parseDateSchedule(this.recurrentEndDate);return this.endDateSchedule=Va.schedule(n)}}return t}){},og=class extends te([nt],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this.disableHasLoadedDataToCommitFlag=!0}static get defaultConfig(){return{modelClass:mu}}}return t}){},ug=class extends te([mu],i=>{const e=i.prototype;class t extends i{getCalendar(){return this.calendar}getPriorityField(){return this.priorityField!=null?this.priorityField:this.priorityField=this.getCalendar().getDepth()}}return t}){},Ha=class extends te([Wa],i=>{const e=i.prototype;class t extends i{get eventStore(){var n;return(n=this.project)==null?void 0:n.eventStore}get resourceStore(){var n;return(n=this.project)==null?void 0:n.resourceStore}get assignmentStore(){var n;return(n=this.project)==null?void 0:n.assignmentStore}get dependencyStore(){var n;return(n=this.project)==null?void 0:n.dependencyStore}get calendarManagerStore(){var n;return(n=this.project)==null?void 0:n.calendarManagerStore}getEventById(n){var s;return(s=this.eventStore)==null?void 0:s.getById(n)}getDependencyById(n){var s;return(s=this.dependencyStore)==null?void 0:s.getById(n)}getResourceById(n){var s;return(s=this.resourceStore)==null?void 0:s.getById(n)}getAssignmentById(n){var s;return(s=this.assignmentStore)==null?void 0:s.getById(n)}getCalendarById(n){var s;return(s=this.calendarManagerStore)==null?void 0:s.getById(n)}}return t}){},cg=class extends te([bs],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this.version=1}static get fields(){return[{name:"version",type:"number"},"name",{name:"unspecifiedTimeIsWorking",type:"boolean",defaultValue:!0},{name:"intervals",type:"store",subStore:!0},"cls","iconCls"]}get intervalStoreClass(){return og}get intervalStore(){return this.meta.intervalsStore}initIntervalsStore(n){n.storeClass=this.intervalStoreClass,n.modelClass=this.getDefaultConfiguration().calendarIntervalModelClass||this.intervalStoreClass.defaultConfig.modelClass,n.calendar=this}processIntervalsStoreData(n){this.bumpVersion()}isDefault(){const n=this.getProject();return n?this===n.defaultCalendar:!1}getDepth(){return this.childLevel+1}forEachAvailabilityInterval(n,s,a){var l,o;const u=(o=n.maxRange)!=null?o:(l=this.getProject())==null?void 0:l.maxCalendarRange;return u&&(n={...n,maxRange:u}),this.calendarCache.forEachAvailabilityInterval(n,s,a)}accumulateWorkingTime(n,s,a){var l,o,u;if(s===0)return{finalDate:new Date(n),remainingDurationInMs:0};if(isNaN(s))throw new Error("Invalid duration");let c=n;const d=(u=(o=(l=this.getProject())==null?void 0:l.adjustDurationToDST)!=null?o:this.adjustDurationToDST)!=null?u:!1;return this.forEachAvailabilityInterval(a?{startDate:n,isForward:!0}:{endDate:n,isForward:!1},(h,g,f)=>{let m=!0;if(f.getIsWorking()){let p=g.getTime()-h.getTime();if(s<=p){if(d){const v=a?h.getTimezoneOffset()-new Date(h.getTime()+s).getTimezoneOffset():new Date(g.getTime()-s).getTimezoneOffset()-g.getTimezoneOffset();s-=v*60*1e3}c=a?new Date(h.getTime()+s):new Date(g.getTime()-s),s=0,m=!1}else{if(d){const v=h.getTimezoneOffset()-g.getTimezoneOffset();p+=v*60*1e3}c=a?g:h,s-=p}}return m}),{finalDate:new Date(c),remainingDurationInMs:s}}calculateDurationMs(n,s,a=!1){var l,o,u;let c=0;const d=n.getTime()<=s.getTime()||!a?1:-1;d<0&&([n,s]=[s,n]);const h=(u=(o=(l=this.getProject())==null?void 0:l.adjustDurationToDST)!=null?o:this.adjustDurationToDST)!=null?u:!1;return this.forEachAvailabilityInterval({startDate:n,endDate:s},(g,f,m)=>{if(m.getIsWorking()&&(c+=f.getTime()-g.getTime(),h)){const p=g.getTimezoneOffset()-f.getTimezoneOffset();c+=p*60*1e3}}),c*d}calculateEndDate(n,s){const a=s>=0,l=this.accumulateWorkingTime(n,Math.abs(s),a);return l.remainingDurationInMs===0?l.finalDate:null}calculateStartDate(n,s){const a=s<=0,l=this.accumulateWorkingTime(n,Math.abs(s),a);return l.remainingDurationInMs===0?l.finalDate:null}skipNonWorkingTime(n,s=!0){let a;const l=this.forEachAvailabilityInterval(s?{startDate:n,isForward:!0}:{endDate:n,isForward:!1},(o,u,c)=>{if(c.getIsWorking())return a=s?o:u,!1});return l===Je.MaxRangeReached||l===Je.FullRangeIterated?"empty_calendar":a?new Date(a):new Date(n)}addInterval(n){return this.addIntervals([n])}addIntervals(n){return this.bumpVersion(),this.intervalStore.add(n)}removeInterval(n){return this.removeIntervals([n])}removeIntervals(n){return this.bumpVersion(),this.intervalStore.remove(n)}clearIntervals(n){return n||this.bumpVersion(),this.intervalStore.removeAll(n)}bumpVersion(){this.clearCache(),this.version++}get calendarCache(){if(this.$calendarCache!==void 0)return this.$calendarCache;const n=new ug({isWorking:this.unspecifiedTimeIsWorking});return n.calendar=this,this.$calendarCache=new lg({calendar:this,unspecifiedTimeInterval:n,intervalStore:this.intervalStore,parentCache:this.parent&&!this.parent.isRoot?this.parent.calendarCache:null})}clearCache(){this.$calendarCache&&this.$calendarCache.clear(),this.$calendarCache=void 0}resetPriorityOfAllIntervals(){this.traverse(n=>{n.intervalStore.forEach(s=>s.resetPriority())})}insertChild(n,s,a){let l=e.insertChild.call(this,...arguments);return Array.isArray(l)||(l=[l]),l.forEach(o=>{o.bumpVersion(),o.resetPriorityOfAllIntervals()}),l}joinProject(){e.joinProject.call(this),this.intervalStore.setProject(this.getProject())}leaveProject(){e.leaveProject.call(this),this.intervalStore.setProject(null),this.clearCache()}doDestroy(){this.leaveProject(),this.intervalStore.destroy(),super.doDestroy()}isDayHoliday(n){const s=k.clearTime(n),a=k.getNext(n,Li.Day);let l=!1;return this.forEachAvailabilityInterval({startDate:s,endDate:a,isForward:!0},(o,u,c)=>(l=c.getIsWorking(),!l)),!l}getDailyHolidaysRanges(n,s){const a=[];for(n=k.clearTime(n);n<s;)this.isDayHoliday(n)&&a.push({startDate:n,endDate:k.getStartOfNextDay(n,!0,!0)}),n=k.getNext(n,Li.Day);return a}getWorkingTimeRanges(n,s,a){const l=[];return this.forEachAvailabilityInterval({startDate:n,endDate:s,isForward:!0,maxRange:a},(o,u,c)=>{if(c.getIsWorking()){const d=c.intervals[0];l.push({name:d.name,startDate:o,endDate:u})}}),l}getNonWorkingTimeRanges(n,s,a){const l=[];return this.forEachAvailabilityInterval({startDate:n,endDate:s,isForward:!0,maxRange:a},(o,u,c)=>{if(!c.getIsWorking()){const d=c.intervals[0];l.push({name:d.name,iconCls:d.iconCls,cls:d.cls,startDate:o,endDate:u})}}),l}isWorkingTime(n,s,a){if(a){let l;const o=this.forEachAvailabilityInterval({startDate:n,endDate:s,isForward:!0},(u,c,d)=>{if(d.getIsWorking()&&u<=n&&c>=s)return l=!0,!1});return o===Je.MaxRangeReached||o===Je.FullRangeIterated?!1:l}else{const l=this.skipNonWorkingTime(n);return l&&l!=="empty_calendar"?s?l<s:l.getTime()===n.getTime():!1}}}return t}){},dg=class extends te([bs],i=>{const e=i.prototype;class t extends i{getAssignmentFor(n){var s;for(const a of(s=this.assigned)!=null?s:[])if(a.resource===n)return a;return null}isAssignedTo(n){return!!this.getAssignmentFor(n)}async assign(n){const s=this.project.assignmentStore.modelClass;return this.addAssignment(new s({event:this,resource:n})),this.commitAsync()}async unassign(n){const s=this.getAssignmentFor(n);return this.removeAssignment(s),this.commitAsync()}leaveProject(){if(this.isInActiveTransaction&&this.assigned){const n=this.getEventStore();this.assigned.forEach(s=>n.assignmentsForRemoval.add(s))}e.leaveProject.call(this,...arguments)}remove(){if(this.parent){const n=this.getEventStore();e.remove.call(this),n&&n.afterEventRemoval()}else return e.remove.call(this)}addAssignment(n){return this.getProject().assignmentStore.add(n),n}removeAssignment(n){return this.getProject().assignmentStore.remove(n),n}}return t}){},$i=class extends te([bs,Ha,Q],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this.$isCalculating=!1,this.$changed={},this.$beforeChange={}}get isInActiveTransaction(){return!0}joinProject(){this.invalidate()}leaveProject(n=!1){var s;e.leaveProject.call(this,n),(s=this.project)==null||s.bufferedCommitAsync()}invalidate(){var n;(n=this.project)==null||n.invalidate(this)}getCurrentOrProposed(n){var s;return n in this.$changed&&this.$changed[n]!==!0?this.$changed[n]:(s=this.get(n))!=null?s:null}hasCurrentOrProposed(n){return n in this.$changed&&this.$changed[n]!=!0||this.get(n)!=null}propose(n){var s;if(this.project||(s=this.recurringTimeSpan)!=null&&s.project){const a=Object.keys(n);for(let l=0;l<a.length;l++){const o=a[l];this.$changed[o]=n[o]}this.invalidate()}else this.set(n)}setChanged(n,s,a=!0,l=!1){const o=this;o.$changed[n]=s,l&&(n in o.$beforeChange||(o.$beforeChange[n]=o.get(n)),o.setData(n,s)),a&&o.invalidate()}calculateInvalidated(){}finalizeInvalidated(n=!1){const s=this;s.$isCalculating=!0,n?s.setData(s.$changed):(s.setData(s.$beforeChange),s.set(s.$changed)),s.$changed={},s.$beforeChange={},s.$isCalculating=!1}}return t}){},pS=i=>Number(i)!==i,pu=i=>i instanceof Set||i instanceof Array?cr(i):cr([i]),hg=i=>new Promise(e=>setTimeout(e,i)),vS=(i,...e)=>i.replace(/{(\d+)}/g,(t,r)=>typeof e[r]!="undefined"?e[r]:t),fg=class extends te([nt],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this.assignmentsForRemoval=new Set,this.allAssignmentsForRemoval=!1}remove(n,s){this.assignmentsForRemoval=pu(n).toSet();const a=e.remove.call(this,n,s);return this.assignmentsForRemoval.clear(),a}removeAll(n){this.allAssignmentsForRemoval=!0;const s=e.removeAll.call(this,n);return this.allAssignmentsForRemoval=!1,s}}return t}){},gg=class extends te([nt],i=>{const e=i.prototype;class t extends i{doDestroy(){var n;const s=[];(n=this.rootNode)!=null&&n.isDestroyed||this.traverse(a=>s.push(a)),super.doDestroy(),s.forEach(a=>a.destroy())}}return t}){},mg=class extends te([nt],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this.dependenciesForRemoval=new Set,this.allDependenciesForRemoval=!1}remove(n,s){this.dependenciesForRemoval=pu(n).toSet();const a=e.remove.call(this,n,s);return this.dependenciesForRemoval.clear(),a}removeAll(n){this.allDependenciesForRemoval=!0;const s=e.removeAll.call(this,n);return this.allDependenciesForRemoval=!1,s}}return t}){},yS={splice:1,clear:1},pg=class extends te([nt],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this.assignmentsForRemoval=new Set,this.dependenciesForRemoval=new Set}onDataChange(n){var s;const a=yS[n.action];super.onDataChange(n),a&&((s=n.removed)!=null&&s.length)&&this.afterEventRemoval()}remove(n,s){const a=e.remove.call(this,n,s);return this.afterEventRemoval(),a}removeAll(n){const s=e.removeAll.call(this,n);return this.afterEventRemoval(),s}onNodeRemoveChild(n,s,a,l){const o=e.onNodeRemoveChild.call(this,...arguments);return this.afterEventRemoval(),o}afterEventRemoval(){const{assignmentsForRemoval:n,dependenciesForRemoval:s}=this;if(!n)return;const a=this.getAssignmentStore();if(a&&!a.allAssignmentsForRemoval&&n.size){const o=[...n].filter(u=>!a.assignmentsForRemoval.has(u));o.length>0&&a.remove(o)}n.clear();const l=this.getDependencyStore();if(l&&!l.allDependenciesForRemoval&&s.size){const o=[...s].filter(u=>!l.dependenciesForRemoval.has(u));o.length>0&&l.remove(o)}s.clear()}processRecord(n,s=!1){var a;if(!((a=this.project)!=null&&a.isRepopulatingStores)){const l=this.getById(n.id);if(l&&l!==n&&l.assigned)for(const u of l.assigned)u.event=n}return n}}return t}){},bS={splice:1,clear:1},vg=class extends te([nt],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this.assignmentsForRemoval=new Set}onDataChange(n){var s;const a=bS[n.action];super.onDataChange(n),a&&((s=n.removed)!=null&&s.length)&&this.afterResourceRemoval()}remove(n,s){const a=e.remove.call(this,n,s);return this.afterResourceRemoval(),a}removeAll(n){const s=e.removeAll.call(this,n);return this.afterResourceRemoval(),s}afterResourceRemoval(){const n=this.getAssignmentStore();if(n&&!n.allAssignmentsForRemoval){const s=[...this.assignmentsForRemoval].filter(a=>!n.assignmentsForRemoval.has(a));s.length>0&&n.remove(s)}this.assignmentsForRemoval.clear()}processRecord(n,s=!1){const a=this.getById(n.id);if(a&&a!==n)for(const o of a.assigned||[])o.resource=n;return n}}return t}){},_t=class extends te([$i],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this._startDate=null,this._endDate=null,this._duration=null}static get fields(){return[{name:"startDate",type:"date"},{name:"endDate",type:"date"},{name:"duration",type:"number"},{name:"durationUnit",type:"durationunit",defaultValue:"day"}]}get startDate(){var n,s;return(s=(n=this._startDate)!=null?n:this.get("startDate"))!=null?s:null}get endDate(){var n,s;return(s=(n=this._endDate)!=null?n:this.get("endDate"))!=null?s:null}get duration(){var n,s;return(s=(n=this._duration)!=null?n:this.get("duration"))!=null?s:null}set startDate(n){this.proposeStartDate(n)}set endDate(n){this.proposeEndDate(n)}set duration(n){this.proposeDuration(n)}inSet(n,s,a,l,o){const u=this;return u.project&&!u.project.isWritingData&&typeof n!="string"&&!o&&("startDate"in n&&!("startDate"in u.$changed)&&(u.$changed.startDate=!0,u.invalidate()),"endDate"in n&&!("endDate"in u.$changed)&&(u.$changed.endDate=!0,u.invalidate())),e.inSet.call(u,n,s,a,l,o)}getStartDate(){return this.startDate}proposeStartDate(n,s=!("endDate"in this.$changed)){var a;(this.inSetting||(n==null?void 0:n.getTime())!==((a=this.startDate)==null?void 0:a.getTime()))&&(this._startDate=n,this.propose({startDate:n,keepDuration:s}))}async setStartDate(n,s=!0){var a;return this.proposeStartDate(n,s),(a=this.project)==null?void 0:a.commitAsync()}getEndDate(){return this.endDate}proposeEndDate(n,s=!1){var a;(this.inSetting||(n==null?void 0:n.getTime())!==((a=this.endDate)==null?void 0:a.getTime()))&&(this._endDate=n,this.propose({endDate:n,keepDuration:s}))}async setEndDate(n,s=!1){var a;return this.proposeEndDate(n,s),(a=this.project)==null?void 0:a.commitAsync()}getDuration(){return this.duration}proposeDuration(n,s,a=!0){this._duration=n,this.propose({duration:n,keepStart:a}),s&&this.propose({durationUnit:s})}async setDuration(n,s,a=!0){var l;return this.proposeDuration(n,s,a),(l=this.project)==null?void 0:l.commitAsync()}getDurationUnit(){return this.durationUnit}joinProject(){var n,s;const a=this,l=a.$changed,o=a.getCurrentOrProposed("startDate"),u=a.getCurrentOrProposed("endDate"),c=a.getCurrentOrProposed("duration");if(o!=null&&(l.startDate=a._startDate=o),u!=null&&(l.endDate=a._endDate=u),c!=null&&(l.duration=a._duration=c),a.eventStore&&!a.eventStore.isLoadingData){const d=(n=a.assignmentStore)==null?void 0:n.storage.findItem("event",null);if(d){const h=(s=a.assignmentStore)==null?void 0:s.storage.findItem("eventId",a.id);if(h)for(const g of h)g.setChanged("event",a);else for(const g of d)g.getCurrentOrProposed("event")===a.id&&g.setChanged("event",a)}}e.joinProject.call(a)}applyValue(n,s,a,l,o){var u;if((this.project||(u=this.recurringTimeSpan)!=null&&u.project)&&o){const{name:c}=o;(c==="startDate"||c=="duration"||c==="endDate")&&(n=!0,this["_"+c]=a),l&&(n=!1)}e.applyValue.call(this,n,s,a,l,o)}afterChange(n,s,a,l,o){!this.$isCalculating&&!o&&this.setData({startDate:this.getCurrentOrProposed("startDate"),endDate:this.getCurrentOrProposed("endDate"),duration:this.getCurrentOrProposed("duration"),durationUnit:this.getCurrentOrProposed("durationUnit")}),e.afterChange.call(this,n,s,a,l,o)}calculateInvalidated(){var n,s;const a=this,l=a.$changed,o="startDate"in l,u="endDate"in l,c="duration"in l,{startDate:d,endDate:h,duration:g,keepDuration:f,keepStart:m}=l;let p=null;o&&!u&&!c?d===null?l.endDate=null:a.hasCurrentOrProposed("endDate")&&d>a.getCurrentOrProposed("endDate")&&!f?(l.endDate=d,l.duration=0):a.hasCurrentOrProposed("duration")&&(f||!a.hasCurrentOrProposed("endDate"))?p="endDate":a.hasCurrentOrProposed("endDate")&&(p="duration"):!o&&u&&!c?h===null?l.startDate=null:a.hasCurrentOrProposed("startDate")&&!f&&h!==!0&&h<a.getCurrentOrProposed("startDate")?(l.startDate=h,l.duration=0):a.hasCurrentOrProposed("duration")&&(f||!a.hasCurrentOrProposed("startDate"))?p="startDate":a.hasCurrentOrProposed("startDate")&&(p="duration"):!o&&!u&&c?g===null?l.endDate=null:a.hasCurrentOrProposed("startDate")&&(m||!a.hasCurrentOrProposed("endDate"))?(m&&l.duration<0&&(l.duration=0),p="endDate"):a.hasCurrentOrProposed("endDate")&&(p="startDate"):o&&u&&!c?d===null&&h===null?l.duration=null:p="duration":o&&!u&&c?p="endDate":!o&&u&&c?p="startDate":o&&u&&c&&(g==null?p="duration":d==null?p="startDate":p="endDate");const v=a.getCurrentOrProposed("startDate"),b=a.getCurrentOrProposed("endDate"),w=a.getCurrentOrProposed("duration"),S=a.getCurrentOrProposed("durationUnit"),C=(s=(n=a.getProject())==null?void 0:n.adjustDurationToDST)!=null?s:!1;switch(p){case"startDate":const T=k.add(b,-w,S);if(C){const R=b.getTimezoneOffset()-T.getTimezoneOffset();T.setTime(T.getTime()-R*60*1e3)}l.startDate=T;break;case"endDate":const E=k.add(v,w,S);if(C){const R=v.getTimezoneOffset()-E.getTimezoneOffset();E.setTime(E.getTime()-R*60*1e3)}l.endDate=E;break;case"duration":let I=k.diff(v,b,"millisecond");if(C){const R=v.getTimezoneOffset()-b.getTimezoneOffset();I+=R*60*1e3}l.duration=k.as(S,I,"millisecond");break}"startDate"in l&&l.startDate!==!0&&(this._startDate=l.startDate),"endDate"in l&&l.endDate!==!0&&(this._endDate=l.endDate),"duration"in l&&l.duration!==!0&&(this._duration=l.duration),l.startDate===!0&&delete l.startDate,l.endDate===!0&&delete l.endDate,delete l.keepDuration,delete l.keepStart}}return t}){},Ni=class extends te([$i],i=>{const e=i.prototype;class t extends i{get assigned(){var n;return(n=this.project)==null?void 0:n.assignmentStore.getResourcesAssignments(this)}joinProject(){var n;this.resourceStore&&!this.resourceStore.isLoadingData&&((n=this.assignmentStore)==null||n.query(s=>s.get("resource")===this.id).forEach(s=>s.setChanged("resource",this))),e.joinProject.call(this)}leaveProject(n=!1){var s;if(this.assigned&&!n&&!((s=this.resourceStore)!=null&&s.isLoadingData)){const a=this.resourceStore;this.assigned.forEach(l=>a.assignmentsForRemoval.add(l))}e.leaveProject.call(this)}applyValue(n,s,a,l,o){(o==null?void 0:o.name)==="id"&&this.assigned.forEach(u=>{u.set("resourceId",a)}),e.applyValue.call(this,n,s,a,l,o)}}return t}){};function Ya(i){return i!=null&&i.isModel?i.id:i}var Ua=class extends te([$i],i=>{const e=i.prototype;class t extends i{static get fields(){return[{name:"resource",isEqual:(n,s)=>n===s,persist:!1},{name:"event",isEqual:(n,s)=>n===s,persist:!1}]}setChanged(n,s,a){const{assignmentStore:l,eventStore:o,resourceStore:u,project:c}=this;let d=!1;if(n==="event"){const h=bt(s,_t)?s:o==null?void 0:o.$master.getById(s);h&&(d=!0),s=h||s}if(n==="resource"){const h=bt(s,Ni)?s:u==null?void 0:u.$master.getById(s);h&&(d=!0),s=h||s}e.setChanged.call(this,n,s,a,!0),l&&d&&!c.isPerformingCommit&&!l.isLoadingData&&!(u!=null&&u.isLoadingData)&&!l.skipInvalidateIndices&&l.invalidateIndices()}joinProject(){e.joinProject.call(this),this.setChanged("event",this.get("event")),this.setChanged("resource",this.get("resource"))}calculateInvalidated(){var n,s;let{event:a=this.event,resource:l=this.resource}=this.$changed;if(a!==null&&!bt(a,_t)){const o=(n=this.eventStore)==null?void 0:n.getById(a);o&&this.setChanged("event",o,!1)}if(l!==null&&!bt(l,Ni)){const o=(s=this.resourceStore)==null?void 0:s.getById(l);o&&this.setChanged("resource",o,!1)}}finalizeInvalidated(n){const s=this.$changed;"resource"in s&&(s.resourceId=Ya(s.resource)),"event"in s&&(s.eventId=Ya(s.event)),e.finalizeInvalidated.call(this,n)}set event(n){this.setChanged("event",n),this.setChanged("eventId",Ya(n))}get event(){const n=this.get("event");return(n==null?void 0:n.id)!=null?n:null}set resource(n){this.setChanged("resource",n),this.setChanged("resourceId",Ya(n))}get resource(){const n=this.get("resource");return(n==null?void 0:n.id)!=null?n:null}}return t}){},Bi=class extends te([nt,Ha,re],i=>{const e=i.prototype;class t extends i{setProject(n){const s=e.setProject.call(this,n);return n&&this.joinProject(n),s}joinProject(n){}onCommitAsync(){}}return t}){},yg=new Set,vu=class extends te([fg,Bi],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this.skipInvalidateIndices=!1}static get defaultConfig(){return{modelClass:Ua,storage:{extraKeys:[{property:"event",unique:!1},{property:"resource",unique:!1},{property:"eventId",unique:!1}]}}}set data(n){this.allAssignmentsForRemoval=!0,super.data=n,this.allAssignmentsForRemoval=!1}getEventsAssignments(n){return this.storage.findItem("event",n,!0)||yg}getResourcesAssignments(n){return this.storage.findItem("resource",n.$original,!0)||yg}updateIndices(){this.storage.rebuildIndices()}invalidateIndices(){this.storage.invalidateIndices()}afterLoadData(){this.eventStore&&this.linkAssignments(this.eventStore,"event"),this.resourceStore&&this.linkAssignments(this.resourceStore,"resource")}linkAssignments(n,s){n=n.masterStore||n;const a=this.count&&this.storage.findItem(s,null,!0);if(a){for(const l of a){const o=n.getById(l.getCurrentOrProposed(s));o&&l.setChanged(s,o)}this.invalidateIndices()}}unlinkAssignments(n){this.forEach(s=>{var a,l,o;return s.setChanged(n,(o=(l=(a=s[n])==null?void 0:a.id)!=null?l:s==null?void 0:s.getData(n))!=null?o:s[n+"Id"])}),this.invalidateIndices()}onCommitAsync(){this.updateIndices()}}return t}){},yu=class extends te([cg,$i],i=>{const e=i.prototype;class t extends i{}return t}){},bg=class extends te([gg,Bi],i=>{const e=i.prototype;class t extends i{static get defaultConfig(){return{tree:!0,modelClass:yu}}}return t}){},qa=class extends te([$i],i=>{const e=i.prototype;class t extends i{static get fields(){return[{name:"fromEvent",isEqual:(n,s)=>n===s,persist:!1},{name:"toEvent",isEqual:(n,s)=>n===s,persist:!1}]}setChanged(n,s,a){var l,o,u;let c=!1;if(n==="fromEvent"||n==="toEvent"){const d=bt(s,_t)?s:(l=this.eventStore)==null?void 0:l.getById(s);d&&(c=!0),s=d||s}e.setChanged.call(this,n,s,a,!0),c&&!this.project.isPerformingCommit&&!((o=this.dependencyStore)!=null&&o.isLoadingData)&&((u=this.dependencyStore)==null||u.invalidateIndices())}joinProject(){e.joinProject.call(this),this.setChanged("fromEvent",this.get("fromEvent")),this.setChanged("toEvent",this.get("toEvent"))}calculateInvalidated(){var n,s;let{fromEvent:a,toEvent:l}=this.$changed;if(a!==null&&!bt(a,_t)){const o=(n=this.eventStore)==null?void 0:n.getById(a);o&&(this.$changed.fromEvent=o)}if(l!==null&&!bt(l,_t)){const o=(s=this.eventStore)==null?void 0:s.getById(l);o&&(this.$changed.toEvent=o)}}set fromEvent(n){this.setChanged("fromEvent",n)}get fromEvent(){const n=this.get("fromEvent");return(n==null?void 0:n.id)!=null?n:null}set toEvent(n){this.setChanged("toEvent",n)}get toEvent(){const n=this.get("toEvent");return(n==null?void 0:n.id)!=null?n:null}}return t}){},Cg=new Set,bu=class extends te([mg,Bi],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this.dependenciesForRemoval=new Set,this.allDependenciesForRemoval=!1}static get defaultConfig(){return{modelClass:qa,storage:{extraKeys:[{property:"fromEvent",unique:!1},{property:"toEvent",unique:!1}]}}}getIncomingDepsForEvent(n){return this.storage.findItem("toEvent",n)||Cg}getOutgoingDepsForEvent(n){return this.storage.findItem("fromEvent",n)||Cg}set data(n){this.allDependenciesForRemoval=!0,super.data=n,this.allDependenciesForRemoval=!1}updateIndices(){this.storage.rebuildIndices()}invalidateIndices(){this.storage.invalidateIndices()}onCommitAsync(){this.updateIndices()}}return t}){},Sg=class extends te([_t,dg],i=>{const e=i.prototype;class t extends i{get assigned(){var n,s;return(s=(n=this.project)==null?void 0:n.assignmentStore.getEventsAssignments(this))!=null?s:this.$cachedAssignments}leaveProject(n=!1){this.$cachedAssignments=this.assigned,super.leaveProject(n)}applyValue(n,s,a,l,o){var u;s==="id"&&((u=this.assigned)==null||u.forEach(c=>c.set("eventId",a))),e.applyValue.call(this,n,s,a,l,o)}copy(n=null,s=null){const a=e.copy.call(this,n,s);return(x.isObject(s)&&!s.skipFieldIdentifiers||!x.isObject(s))&&(a.$cachedAssignments=this.assigned),a}}return t}){},wg=class extends te([_t],i=>{const e=i.prototype;class t extends i{get outgoingDeps(){return this.project.dependencyStore.getOutgoingDepsForEvent(this)}get incomingDeps(){return this.project.dependencyStore.getIncomingDepsForEvent(this)}leaveProject(){const n=this.eventStore;this.outgoingDeps&&this.outgoingDeps.forEach(s=>n.dependenciesForRemoval.add(s)),this.incomingDeps&&this.incomingDeps.forEach(s=>n.dependenciesForRemoval.add(s)),e.leaveProject.call(this)}}return t}){},Ka=class extends te([_t,Sg,wg],i=>{const e=i.prototype;class t extends i{}return t}){},Cu=class extends te([pg,Bi],i=>{const e=i.prototype;class t extends i{static get defaultConfig(){return{modelClass:Ka}}joinProject(){var n;(n=this.assignmentStore)==null||n.linkAssignments(this,"event")}afterLoadData(){var n;this.afterEventRemoval(),(n=this.assignmentStore)==null||n.linkAssignments(this,"event")}}return t}){},Su=class extends te([vg,Bi],i=>{const e=i.prototype;class t extends i{static get defaultConfig(){return{modelClass:Ni}}joinProject(){var n;(n=this.assignmentStore)==null||n.linkAssignments(this,"resource")}afterLoadData(){var n;(n=this.assignmentStore)==null||n.linkAssignments(this,"resource")}clear(n){var s;e.clear.call(this,n),(s=this.assignmentStore)==null||s.unlinkAssignments("resource")}}return t}){},CS=class extends te([],fe){},SS=class extends te([],xe){},wS=class extends te([CS,SS,Q],i=>{const e=i.prototype;class t extends i{constructor(){super(...arguments),this.isRestoringData=!1}get isRepopulatingStores(){return!1}get isInitialCommit(){return!this.isInitialCommitPerformed||this.hasLoadedDataToCommit}construct(n={}){this.isInitialCommitPerformed=!1,this.isLoadingInlineData=!1,this.isWritingData=!1,this.hasLoadedDataToCommit=!1;const s="silenceInitialCommit"in n?n.silenceInitialCommit:!0,a="adjustDurationToDST"in n?n.adjustDurationToDST:!1;this.maxCalendarRange="maxCalendarRange"in n?n.maxCalendarRange:15768e7,delete n.maxCalendarRange,delete n.silenceInitialCommit,delete n.adjustDurationToDST,e.construct.call(this,n),this.silenceInitialCommit=s,this.adjustDurationToDST=a}repopulateStore(n){}repopulateReplica(){}deferUntilRepopulationIfNeeded(n,s,a){s(...a)}attachStore(n){}detachStore(n){}async commitAsync(){throw new Error("Abstract method called")}isEngineReady(){throw new Error("Abstract method called")}getStm(){throw new Error("Abstract method called")}}return t}){},Dg=class extends te([],xe){},Tg=class extends te([wS,Ha,Dg,Q],i=>{const e=i.prototype;class t extends i{static get configurable(){return{stm:{},eventStore:{},assignmentStore:{},resourceStore:{},dependencyStore:{},calendarManagerStore:{},eventModelClass:Ka,assignmentModelClass:Ua,resourceModelClass:Ni,dependencyModelClass:qa,calendarModelClass:yu,eventStoreClass:Cu,assignmentStoreClass:vu,resourceStoreClass:Su,dependencyStoreClass:bu,calendarManagerStoreClass:bg,assignmentsData:null,calendarsData:null,dependenciesData:null,eventsData:null,resourcesData:null}}construct(n={}){var s;const a=this;if(a.$invalidated=new Set,a.isPerformingCommit=!1,a.silenceInitialCommit=!0,a.ongoing=Promise.resolve(),n.eventStore&&!n.assignmentStore){const g=n.eventStore.masterStore||n.eventStore,f=g.assignmentStore||((s=g.crudManager)==null?void 0:s.assignmentStore);f!=null&&f.isAssignmentStore&&(n.assignmentStore=f,a.isSharingAssignmentStore=!0)}e.construct.call(a,n),a.defaultCalendar=new a.calendarManagerStore.modelClass({unspecifiedTimeIsWorking:a.unspecifiedTimeIsWorking}),a.defaultCalendar.project=a;const{calendarsData:l,eventsData:o,dependenciesData:u,resourcesData:c,assignmentsData:d}=a;!!(l||o||u||c||d)?(a.loadInlineData({calendarsData:l,eventsData:o,dependenciesData:u,resourcesData:c,assignmentsData:d}),delete a.calendarsData,delete a.eventsData,delete a.dependenciesData,delete a.resourcesData,delete a.assignmentsData):a.bufferedCommitAsync()}doDestroy(){var n,s,a,l,o,u;const c=this;(n=c.eventStore)==null||n.destroy(),(s=c.dependencyStore)==null||s.destroy(),(a=c.assignmentStore)==null||a.destroy(),(l=c.resourceStore)==null||l.destroy(),(o=c.calendarManagerStore)==null||o.destroy(),c.defaultCalendar.destroy(),(u=c.stm)==null||u.destroy(),e.doDestroy.call(this)}async loadInlineData(n){const s=this;s.isLoadingInlineData=!0,n.calendarsData&&(s.calendarManagerStore.data=n.calendarsData),n.resourcesData&&(s.resourceStore.data=n.resourcesData),n.assignmentsData&&(s.assignmentStore.data=n.assignmentsData),n.eventsData&&(s.eventStore.data=n.eventsData),n.tasksData&&(s.eventStore.data=n.tasksData),n.dependenciesData&&(s.dependencyStore.data=n.dependenciesData),await s.commitLoad(),s.isLoadingInlineData=!1}async commitLoad(){await this.commitAsync(),this.isDestroyed||this.trigger("load")}joinStoreRecords(n){const s=a=>{a.setProject(this),a.joinProject()};n.rootNode?n.rootNode.traverse(s):n.forEach(s)}unJoinStoreRecords(n){const s=a=>{a.leaveProject(),a.setProject(this)};n.rootNode?n.rootNode.traverse(a=>{a!==n.rootNode&&s(a)}):n.forEach(s)}resolveStoreAndModelClass(n,s){const a=(s==null?void 0:s.storeClass)||this[`${n}StoreClass`];let l=s==null?void 0:s.modelClass;return l||(this.getDefaultConfiguration()[`${n}ModelClass`]!==a.getDefaultConfiguration().modelClass?l=a.getDefaultConfiguration().modelClass:l=this[`${n}ModelClass`]),{storeClass:a,modelClass:l}}setEventStore(n){this.eventStore=n}changeEventStore(n,s){const a=this,{stm:l}=a;if(a.detachStore(s),n instanceof re)n.project=a,l.addStore(n),a.joinStoreRecords(n);else{const{storeClass:o,modelClass:u}=a.resolveStoreAndModelClass("event",n);n=new o(x.assign({modelClass:u,project:a,stm:l},n))}if(s&&l.hasStore(s)){l.removeStore(s),a.unJoinStoreRecords(s);const{assignmentsForRemoval:o}=s;o.forEach(u=>{const c=u.event;if(c){const d=n.getById(c.id);d&&(u.event=d,o.delete(u))}}),s.afterEventRemoval()}return n.setProject(a),n}updateEventStore(n,s){this.attachStore(n),this.trigger("eventStoreChange",{store:n})}setAssignmentStore(n){this.assignmentStore=n}changeAssignmentStore(n,s){const a=this,{stm:l}=a;if(a.detachStore(s),s&&l.hasStore(s)&&(l.removeStore(s),a.unJoinStoreRecords(s)),n instanceof re)n.project=a,l.addStore(n),a.joinStoreRecords(n);else{const{storeClass:o,modelClass:u}=a.resolveStoreAndModelClass("assignment",n);n=new o(x.assign({modelClass:u,project:a,stm:l},n))}return n.setProject(a),n}updateAssignmentStore(n,s){this.attachStore(n),this.trigger("assignmentStoreChange",{store:n})}setResourceStore(n){this.resourceStore=n}changeResourceStore(n,s){const a=this,{stm:l}=a;if(a.detachStore(s),n instanceof re)n.project=a,l.addStore(n),a.joinStoreRecords(n);else{const{storeClass:o,modelClass:u}=a.resolveStoreAndModelClass("resource",n);n=new o(x.assign({modelClass:u,project:a,stm:l},n))}if(s&&l.hasStore(s)){l.removeStore(s),a.unJoinStoreRecords(s);const{assignmentsForRemoval:o}=s;o.forEach(u=>{const c=u.resource;if(c){const d=n.getById(c.id);d&&(u.resource=d,o.delete(u))}}),s.afterResourceRemoval()}return n.setProject(a),n}updateResourceStore(n,s){this.attachStore(n),this.trigger("resourceStoreChange",{store:n})}setDependencyStore(n){this.dependencyStore=n}changeDependencyStore(n,s){const a=this;if(a.detachStore(s),n instanceof re)n.project=a,a.stm.addStore(n),a.joinStoreRecords(n);else{const{storeClass:l,modelClass:o}=a.resolveStoreAndModelClass("dependency",n);n=new l(x.assign({modelClass:o,project:a,stm:a.stm},n))}return n}updateDependencyStore(n,s){this.attachStore(n),this.trigger("dependencyStoreChange",{store:n})}setCalendarManagerStore(n){this.calendarManagerStore=n}changeCalendarManagerStore(n,s){const a=this;if(a.detachStore(s),n instanceof re)a.stm.addStore(n);else{const l=(n==null?void 0:n.storeClass)||a.calendarManagerStoreClass,o=(n==null?void 0:n.modelClass)||l.getDefaultConfiguration().modelClass||a.calendarModelClass;n=new l(x.assign({modelClass:o,project:a,stm:a.stm},n))}return n.setProject(a),n}updateCalendarManagerStore(n,s){this.attachStore(n),this.trigger("calendarManagerStoreChange",{store:n})}get calendar(){return this.$calendar||this.defaultCalendar}set calendar(n){this.$calendar=n}get effectiveCalendar(){return this.calendar}async addEvent(n){return this.eventStore.add(n),this.commitAsync()}async addAssignment(n){return this.assignmentStore.add(n),this.commitAsync()}async addResource(n){return this.resourceStore.add(n),this.commitAsync()}async addDependency(n){return this.dependencyStore.add(n),this.commitAsync()}bufferedCommitAsync(){this.hasPendingAutoCommit||this.setTimeout({fn:"commitAsync",delay:10})}get hasPendingAutoCommit(){return this.hasTimeout("commitAsync")}unScheduleAutoCommit(){this.clearTimeout("commitAsync")}async commitAsync(){return this.isPerformingCommit?this.ongoing:this.ongoing=this.doCommitAsync()}async doCommitAsync(){const n=this;if(n.isPerformingCommit=!0,n.unScheduleAutoCommit(),await hg(0),!n.isDestroyed){for(const u of n.$invalidated)u.calculateInvalidated();const{isInitialCommit:s,silenceInitialCommit:a}=n,l=s&&a;n.assignmentStore.onCommitAsync(),n.dependencyStore.onCommitAsync(),n.isInitialCommitPerformed=!0,n.hasLoadedDataToCommit=!1,n.isPerformingCommit=!1;const o=[n.assignmentStore,n.dependencyStore,n.eventStore,n.resourceStore,n.calendarManagerStore];if(o.forEach(u=>{var c;return(c=u.suspendAutoCommit)==null?void 0:c.call(u)}),n.isWritingData=!0,n.trigger("refresh",{isInitialCommit:s,isCalculated:!0}),l)for(const u of n.$invalidated)u.finalizeInvalidated(!0);else{for(const u of n.$invalidated)u.beginBatch(!0),u.finalizeInvalidated();for(const u of n.$invalidated)u.endBatch(!1,!0)}return n.isWritingData=!1,n.$invalidated.clear(),n.trigger("dataReady"),o.forEach(u=>{var c;return(c=u.resumeAutoCommit)==null?void 0:c.call(u)}),n.trigger("commitFinalized"),!0}}async propagateAsync(){return this.commitAsync()}invalidate(n){this.$invalidated.add(n),this.bufferedCommitAsync()}async isValidDependency(){return!0}getStm(){return this.stm}set stm(n){n=this.$stm=new oo(x.assign({disabled:!0},n)),n.ion({restoringStop:async()=>{n.disable(),await this.commitAsync(),this.isDestroyed||(n.enable(),this.trigger("stateRestoringDone"))}})}get stm(){return this.$stm}isEngineReady(){return!this.hasPendingAutoCommit&&!this.isPerformingCommit&&this.isInitialCommitPerformed}}return t.applyConfigs=!0,t}){},Pe=class extends Ut.mixin(Et){onConfigChange(i){!this.isConfiguring&&!this.isDestroying&&this.client.recompose(),super.onConfigChange(i)}};y(Pe,"factoryable",{}),y(Pe,"configurable",{}),Pe._$name="TaskBoardFeature";var Vi=class extends Pe{initialCompose(){const i=this;i.draggable=DS.new({dragRootElement:i.disabled?null:i.client.bodyWrapElement,dropRootElement:i.client.bodyWrapElement,owner:i,internalListeners:{beforeDragStart:"onBeforeDragStart",dragStart:"onDragStart",thisObj:i}},i.draggable)}doDestroy(){var i;(i=this.draggable)==null||i.destroy(),super.doDestroy()}doDisable(i){super.doDisable(i),this.draggable&&(this.draggable.dragRootElement=i?null:this.client.bodyWrapElement)}movePrev(i){const{columns:e}=this.client;e.move(i,e.getPrev(i))}moveNext(i){const{columns:e}=this.client,t=Math.min(e.indexOf(i)+2,e.count);e.move(i,e.getAt(t))}populateColumnHeaderMenu({items:i,columnRecord:e}){const{client:t}=this,{columns:r,rtl:n}=t;!t.readOnly&&!this.disabled&&(i.moveColumnLeft={text:"L{TaskBoard.moveColumnLeft}",icon:"b-fw-icon b-icon-left",disabled:e===r[n?"last":"first"],weight:200,onItem:()=>this["move"+(n?"Next":"Prev")](e)},i.moveColumnRight={text:"L{TaskBoard.moveColumnRight}",icon:"b-fw-icon b-icon-right",disabled:e===r[n?"first":"last"],weight:300,onItem:()=>this["move"+(n?"Prev":"Next")](e)})}onBeforeDragStart({drag:i,event:e}){return this.client.trigger("beforeColumnDrag",{drag:i,event:e,columnRecord:i.columnRecord})}onDragStart({drag:i,event:e}){return this.client.trigger("columnDragStart",{drag:i,event:e,columnRecord:i.columnRecord})}};y(Vi,"$name","ColumnDrag"),y(Vi,"type","columnDrag"),y(Vi,"pluginConfig",{after:["initialCompose","populateColumnHeaderMenu"]}),Vi.initClass();var DS=class extends F.mixin(Ra,_a,fe){static get configurable(){return{dragSelector:".b-taskboard-column-header, .b-taskboard-column-header *",dragItemSelector:".b-taskboard-column-header",draggingItemCls:null,dragProxy:{type:"default",async open(i){const{owner:e}=this,{itemElement:t,startEvent:r,columnRecord:n}=i,s=e.owner.client,a=V.from(t,e.dragRootElement),l=$.getClientPoint(r).getDelta(a),o=D.createElement({className:"b-taskboard-column-drag-proxy",parent:e.dragRootElement,style:{top:a.y,left:$.getClientPoint(r).translate(l[0],0).x,width:t.getBoundingClientRect().width},retainElement:!0}),u=[t,...s.getColumnElements(n)];Object.assign(i,{proxy:o,elements:u,proxyOffset:l}),u.forEach((c,d)=>{const h=c.cloneNode(!0),g=c.getBoundingClientRect();if(c.originalWidth=g.width,c.originalHeight=g.height,c.matches(".b-taskboard-column")){const f=c.closest(".b-taskboard-swimlane"),m=de.getChild(f,"header"),p=de.getChild(f,"body"),v=f.cloneNode(),b=m==null?void 0:m.cloneNode(!0),w=p.cloneNode();let S=f.getBoundingClientRect().height;if(d===u.length-1){const C=D.getStyleValue(c.parentElement,"padding-bottom");S-=parseFloat(C)}v.style.flex=`0 0 ${S}px`,b&&v.appendChild(b),w.appendChild(h),v.appendChild(w),o.appendChild(v)}else o.appendChild(h);c.classList.add("b-drag-original")})},dragMove({proxy:i,event:e,proxyOffset:t}){const r=$.getClientPoint(e).translate(t[0],0);i.style.left=`${r.x}px`}}}}setupDragContext(i){const e=super.setupDragContext(i),{client:t}=this.owner;return e.scrollManager=t.scrollManager,e.monitoringConfig={scrollables:[{element:t.bodyElement,direction:"horizontal"}]},e}startDrag(i){return i.columnRecord=this.owner.client.resolveColumnRecord(i.itemElement),super.startDrag(i)}dragStart(i){this.owner.client.suspendResponsiveness(),i.wasStarted=!0}dragEnter(i){if(!i.itemElement.matches(this.dragItemSelector))return!1;i.dropIndicators||(i.dropIndicators=i.elements.map((e,t)=>D.createElement({className:"b-taskboard-column-drop-indicator",elementData:{dropIndicator:!0,element:e},style:{width:e.originalWidth,height:e.originalHeight}})),this.insertDropIndicators(i,i.columnRecord))}insertDropIndicators(i,e){const{client:t}=this.owner,r=t.columns.indexOf(e);i.dropIndicators.forEach((n,s)=>{var a,l;if(s===0){const o=de.getChild(t.bodyElement,"header"),u=[...o.children];z.remove(u,n),o.insertBefore(n,u[r])}else{const o=(l=(a=t.swimlanes)==null?void 0:a.getAt(s-1))!=null?l:{domId:"default"},u=de.getChild(t.getSwimlaneElement(o),"body"),c=[...u.children];z.remove(c,n),u.insertBefore(n,c[r])}})}updateValidity(i,e){i.proxy.classList.toggle("b-invalid",!e),i.dropIndicators.forEach(t=>t.classList.toggle("b-invalid",!e)),i.invalid=!e}dragMove(i){var e;const{client:t}=this.owner,r=t.documentRoot,n=V.from(i.proxy,void 0,!0),s=r.elementFromPoint(n.center.x,n.y),a=s==null?void 0:s.closest(".b-taskboard-column-header");if(i.invalid&&(i.valid=!1),!((e=s==null?void 0:s.elementData)!=null&&e.dropIndicator)&&a){const l=V.from(a);let o=t.resolveColumnRecord(a);n.center.x>l.center.x&&(o=t.columns.getNext(o)),this.insertDropIndicators(i,o);const u=i.beforeColumn!==o;if(i.beforeColumn=o,u){const c=t.trigger("columnDrag",{drag:i,columnRecord:i.columnRecord,beforeColumn:o});this.updateValidity(i,c!==!1)}}}async dragDrop(i){const{client:e}=this.owner,{columns:t}=e,{columnRecord:r,beforeColumn:n,elements:s,dropIndicators:a,proxy:l}=i;i.invalid||await e.trigger("beforeColumnDrop",{drag:i,columnRecord:r,beforeColumn:n})===!1?i.valid=!1:i.finalizer=new Promise(o=>{function u(){l.remove(),a.forEach(c=>c.remove()),s.forEach(c=>c.classList.remove("b-drag-original")),e.suspendDomTransition(),n!==void 0&&t.move(r,n),e.resumeDomTransition(),e.trigger("columnDrop",{drag:i,columnRecord:r,beforeColumn:n}),e.trigger("columnDragEnd",{drag:i,columnRecord:r,beforeColumn:n}),e.resumeResponsiveness(),o()}l.classList.add("b-dropping"),D.alignTo(l,V.from(a[0],void 0,!0)),D.getPropertyTransitionDuration(l,"transform")?$.onTransitionEnd({element:l,property:"transform",handler:u,thisObj:e}):u()})}dragLeave(i){}doAbort(i){const{client:e}=this.owner,{dropIndicators:t,proxy:r,columnRecord:n,elements:s}=i;if(r){let a=function(){r.remove(),t.forEach(l=>l.remove()),s.forEach(l=>l.classList.remove("b-drag-original")),e.trigger("columnDragAbortFinalized")};r.classList.add("b-dropping"),t.forEach((l,o)=>{const u=i.elements[o];l.classList.remove("b-invalid"),u.parentElement.insertBefore(l,u)}),D.alignTo(r,V.from(t[0],void 0,!0)),D.getPropertyTransitionDuration(r,"transform")?$.onTransitionEnd({element:r,property:"transform",handler:a,thisObj:e}):a()}e.trigger("columnDragAbort",{drag:i,columnRecord:n}),i.wasStarted&&e.trigger("columnDragEnd",{drag:i,columnRecord:n})}dragEnd(i){(!i.valid||i.aborted)&&this.doAbort(i)}};Vi._$name="ColumnDrag";var jr=class extends xa{static get pluginConfig(){const i=super.pluginConfig;return i.chain.push("populateColumnHeaderMenu","populateColumnHeader","onColumnHeaderClick"),i}changeItems(i){return x.assertObject(i,"features.columnHeaderMenu.items"),i}changeProcessItems(i){return x.assertFunction(i,"features.columnHeaderMenu.processItems"),i}populateColumnHeader({columnHeaderConfig:i}){this.disabled||(i.children.padder.children.menu={tag:"button",class:{"b-column-header-button":1,"b-taskboard-column-header-menu-button":1,"b-fw-icon":1,"b-icon-menu-horizontal":1}})}getDataFromEvent(i){return x.assign(super.getDataFromEvent(i),i.taskBoardData)}populateColumnHeaderMenu({items:i,columnRecord:e}){const{client:t}=this;t.readOnly||(i.addTask={text:"L{TaskBoard.addTask}",icon:"b-fw-icon b-icon-add",weight:100,onItem(){t.addTask(e)}})}onColumnHeaderClick(i){const{event:e}=i;e.target.matches(".b-column-header-button")&&this.showContextMenu(e,{target:e.target,align:"t90-b90"})}doDisable(i){super.doDisable(i),!this.isConfiguring&&this.client.recompose()}get showMenu(){return!0}};y(jr,"$name","ColumnHeaderMenu"),y(jr,"type","columnHeaderMenu"),y(jr,"configurable",{processItems:null,items:null,menu:{anchor:!0},type:"columnHeader",triggerEvent:!1}),Pe.register(jr.type,jr),jr._$name="ColumnHeaderMenu";var zr=class extends Pe{constructor(){super(...arguments),y(this,"columnMap",new Map)}doDestroy(){for(const[,i]of this.columnMap)i.destroy();super.doDestroy()}changeTopItems(i){return x.assertObject(i,"features.columnToolbars.topItems"),i}changeBottomItems(i){return x.assertObject(i,"features.columnToolbars.bottomItems"),i}changeProcessItems(i){return x.assertFunction(i,"features.columnToolbars.processItems"),i}getToolbar(i,e,t){var r,n;const s=this,{columnMap:a,client:l,namedItems:o}=s,u=s[`${i}Items`],c=`${i}_._${e.domId}_._${(r=t==null?void 0:t.domId)!=null?r:"default"}`;let d=a.get(c);if(!d){const h={};if(x.getTruthyKeys(u).map(g=>{const f=o[g],m=u[g];h[g]=x.merge({internalListeners:{click:"onClick",change:"onChange",thisObj:s},columnRecord:e,swimlaneRecord:t},f,m)}),((n=s.processItems)==null?void 0:n.call(s,{items:h,location:i,columnRecord:e,swimlaneRecord:t}))===!1)return null;d=l.add({type:"toolbar",cls:`b-taskboard-column-${i[0]}bar`,overflow:null,monitorResize:!1,contentElMutationObserver:!1,items:h,dataset:{role:`${i}-toolbar`,domTransition:!0}}),a.set(c,d)}return d.element}populateColumn({columnConfig:i,columnRecord:e,swimlaneRecord:t}){const r=this;r.disabled||(x.getTruthyKeys(r.topItems).length&&D.merge(i,{children:{"tbar > body":r.getToolbar("top",e,t)}}),x.getTruthyKeys(r.bottomItems).length&&(i.children.bbar=r.getToolbar("bottom",e,t)))}removeColumnToolbar(i,e,t){const{columnMap:r,client:n}=this,s=`${i}_._${e}_._${t}`,a=r.get(s);a&&(n.remove(a),n.setTimeout(()=>a.destroy(),0),r.delete(s))}removeColumnToolbars(i,e){this.removeColumnToolbar("top",i,e),this.removeColumnToolbar("bottom",i,e)}onRemoveColumnElement({columnId:i,swimlaneRecord:e}){var t;this.removeColumnToolbars(i,(t=e.id)!=null?t:"default")}onRemoveSwimlaneElement({swimlaneId:i}){for(const e of this.client.columns)this.removeColumnToolbars(e.id,i)}onAddClick({source:i}){this.client.addTask(i.columnRecord,i.swimlaneRecord)}onChange({source:i}){this.trigger("itemChange",{item:i,columnRecord:i.columnRecord,swimlaneRecord:i.swimlaneRecord})}onClick({source:i}){this.trigger("itemClick",{item:i,columnRecord:i.columnRecord,swimlaneRecord:i.swimlaneRecord})}};y(zr,"$name","ColumnToolbars"),y(zr,"type","columnToolbars"),y(zr,"configurable",{topItems:null,bottomItems:{addTask:!0},namedItems:{addTask:{type:"button",icon:"b-icon-add",tooltip:"L{TaskBoard.addTask}",ariaLabel:"L{TaskBoard.addTask}",internalListeners:{click:"onAddClick"}}},processItems:null}),y(zr,"pluginConfig",{chain:["populateColumn","onRemoveColumnElement","onRemoveSwimlaneElement"]}),zr.initClass(),zr._$name="ColumnToolbars";var ke=class extends F.mixin(Et){static getEditorConfig({config:i,item:e}){const t=i.editor!==null&&(i.editor||e.defaultEditor);return typeof t=="string"?{type:t}:t}};y(ke,"factoryable",{}),y(ke,"configurable",{}),y(ke,"defaultEditor",{type:"text"}),ke._$name="TaskItem";var TS={editNext:1,cancel:1,editPrevious:1,complete:1},Wr=class extends Pe{changeAddNewAtEnd(i){return x.assertBoolean(i,"features.simpleTaskEdit.addNewAtEnd"),i}editTask(i,e){const t=this,r=t.client;e||(e=r.getTaskElement(i));const n=r.resolveTaskItem(e),s=n.element,a=ke.getEditorConfig(n);if(!a)return!1;if(t.disabled||i.readOnly||r.trigger("beforeSimpleTaskEdit",{simpleTaskEdit:t,taskRecord:i,field:n.config.field})===!1)return!0;e.focus();const l=t.editor=sr.new({owner:r,appendTo:s.parentNode,scrollAction:"realign",cls:"b-simple-task-editor",completeKey:null,cancelKey:null,inputField:{autoSelect:!0,name:n.config.field,...a},align:{align:"c-c",allowTargetOut:!1},internalListeners:{complete:"onEditorComplete",cancel:"onEditorCancel",finishEdit:"onEditorFinishEdit",thisObj:t}},t.editorConfig);t.currentElement=s,s.classList.add("b-editing");const o=D.getStyleValue(s,"color");return l.element.style.color=o,l.inputField.element.style.color=o,l.element.retainElement=!0,r.getTaskElement(i).scrollIntoView({block:"nearest"}),s.scrollIntoView({block:"nearest"}),l.startEdit({target:n.element,record:i,field:n.config.field}),!0}async editPrevious(i){const e=this,{client:t,editor:r}=e,n=r.record,s=t.getTaskElement(n),a=Array.from(s.querySelectorAll(".b-taskboard-taskitem.b-editable")),l=a.indexOf(e.currentElement)-1;if(await e.complete(i))if(l>=0)e.editTask(n,a[l]);else{const o=t.getPreviousTask(n,!1);if(o){const u=t.getTaskElement(o),c=Array.from(u.querySelectorAll(".b-taskboard-taskitem.b-editable"));e.editTask(o,c[c.length-1])}}}async editNext(i){const e=this,{client:t,editor:r}=e,n=r.record,s=t.getTaskElement(n),a=Array.from(s.querySelectorAll(".b-taskboard-taskitem.b-editable")),l=a.indexOf(e.currentElement)+1;if(await e.complete(i))if(l<a.length)e.editTask(n,a[l]);else{const o=t.getNextTask(n,!1);o?e.editTask(o):e.addNewAtEnd&&t.addTask(t.getColumn(n),t.getSwimlane(n))}}complete(i){return this.editor.completeEdit(null,i)}cancel(i){this.editor.cancelEdit(i)}onActivateTask({taskRecord:i,event:e}){this.editTask(i,e.target)&&e.preventDefault()}onEditorComplete({source:i}){this.client.trigger("simpleTaskEditComplete",{simpleTaskEdit:this,taskRecord:i.record,field:i.dataField})}onEditorCancel({source:i}){this.client.trigger("simpleTaskEditCancel",{simpleTaskEdit:this,taskRecord:i.record,field:i.dataField})}onEditorFinishEdit(){const i=this,{editor:e}=i;e==null||e.setTimeout(()=>{i.editor===e&&(i.currentElement=null,i.editor=null),e.destroy()},0)}isActionAvailable({actionName:i}){if(TS[i])return!!this.editor}};y(Wr,"$name","SimpleTaskEdit"),y(Wr,"type","simpleTaskEdit"),y(Wr,"configurable",{addNewAtEnd:!0,editorConfig:{},keyMap:{Enter:"editNext",Escape:"cancel","Ctrl+Enter":"complete","Shift+Enter":"editPrevious"}}),y(Wr,"pluginConfig",{assign:["editTask"],before:["onActivateTask"]}),Wr.initClass(),Wr._$name="SimpleTaskEdit";var ji=class extends Pe{initialCompose(){const i=this;i.draggable=xS.new({dragRootElement:i.disabled?null:i.client.bodyWrapElement,dropRootElement:i.client.bodyWrapElement,owner:i},i.draggable)}doDisable(i){super.doDisable(i),this.draggable&&(this.draggable.dragRootElement=i?null:this.client.bodyWrapElement)}};y(ji,"$name","SwimlaneDrag"),y(ji,"type","swimlaneDrag"),y(ji,"pluginConfig",{after:["initialCompose"]}),ji.initClass();var xS=class extends F.mixin(Ra,_a){static get configurable(){return{dragSelector:".b-taskboard-swimlane-header, .b-taskboard-swimlane-header *",dragItemSelector:".b-taskboard-swimlane-header",draggingItemCls:null,dragProxy:{type:"default",async open(i){const{owner:e}=this,{itemElement:t,startEvent:r}=i,n=e.owner.client,s=n.resolveSwimlaneRecord(t),a=n.getSwimlaneElement(s),l=D.getStyleValue(a.syncIdMap.body,["padding-left","padding-right"]),o=V.from(a,e.dragRootElement).deflate(0,parseFloat(l["padding-right"]),0,parseFloat(l["padding-left"])),u=$.getClientPoint(r).getDelta(o),c=D.createElement({className:"b-taskboard-swimlane-drag-proxy",parent:e.dragRootElement,style:{top:$.getClientPoint(r).translate(0,u[1]).y,left:o.x,width:o.width},retainElement:!0});Object.assign(i,{proxy:c,swimlaneRecord:s,swimlaneElement:a,proxyOffset:u,bounds:o});const d=a.cloneNode(!0);c.appendChild(d)},dragMove({proxy:i,event:e,proxyOffset:t}){const r=$.getClientPoint(e).translate(0,t[1]);i.style.top=`${r.y}px`}}}}setupDragContext(i){const e=super.setupDragContext(i),{client:t}=this.owner;return e.scrollManager=t.scrollManager,e.monitoringConfig={scrollables:[{element:t.bodyElement,direction:"vertical"}]},e}dragStart(i){}dragEnter(i){if(!i.itemElement.matches(this.dragItemSelector))return!1;if(!i.dropIndicator){const{bounds:e}=i;i.dropIndicator=D.createElement({className:"b-taskboard-swimlane-drop-indicator",elementData:{dropIndicator:!0},style:{width:e.width,height:e.height}}),this.insertDropIndicator(i.dropIndicator,i.swimlaneRecord),i.swimlaneElement.classList.add("b-drag-original")}}insertDropIndicator(i,e){const{client:t}=this.owner;t.bodyElement.insertBefore(i,e&&t.getSwimlaneElement(e))}async dragMove(i){var e;const{client:t}=this.owner,{documentRoot:r}=t,n=V.from(t.element,void 0,!0),s=V.from(i.proxy,void 0,!0),a=s.center.y>n.bottom?r.elementFromPoint(s.x,s.y):r.elementFromPoint(s.x,s.center.y),l=a==null?void 0:a.closest(".b-taskboard-swimlane");if(!((e=a==null?void 0:a.elementData)!=null&&e.dropIndicator)&&l){const o=V.from(l,void 0,!0);let u=t.resolveSwimlaneRecord(l);s.center.y>o.center.y&&(u=t.swimlanes.getNext(u)),this.insertDropIndicator(i.dropIndicator,u),i.beforeSwimlane=u}}async dragDrop(i){const{client:e}=this.owner,{swimlanes:t}=e,{swimlaneRecord:r,beforeSwimlane:n,swimlaneElement:s,dropIndicator:a,proxy:l}=i;function o(){l.remove(),a.remove(),s.classList.remove("b-drag-original"),n!==void 0&&t.move(r,n),e.trigger("dropSwimlane",{beforeSwimlane:n,drag:i})}l.classList.add("b-dropping"),D.alignTo(l,V.from(a,void 0,!0)),D.getPropertyTransitionDuration(l,"transform")?$.onTransitionEnd({element:l,property:"transform",handler:o,thisObj:e}):o()}dragLeave(i){}};ji._$name="SwimlaneDrag";var xg=".b-taskboard-card, .b-taskboard-card-drop-indicator",Eg=(i,e=!1)=>D.children(i.parentElement,`.b-taskboard-card${e?":not(.b-drag-original)":""}, .b-first-drop-indicator`).indexOf(i),ES=i=>i.some((e,t)=>e.parentElement!==e.elementData.initialParent||t===0&&Eg(e,!0)!==e.elementData.initialIndex),Hr=class extends Pe{initialCompose(){const i=this;i.draggable=kS.new({dragRootElement:i.disabled?null:i.client.bodyWrapElement,dropRootElement:i.client.bodyWrapElement,owner:i,[i.dragTouchStartDelay!=null?"dragTouchStartDelay":void 0]:i.dragTouchStartDelay,internalListeners:{beforeDragStart:"onBeforeDragStart",dragStart:"onDragStart",thisObj:i}},i.draggable)}doDestroy(){var i;super.doDestroy(),(i=this.draggable)==null||i.destroy()}doDisable(i){super.doDisable(i),this.draggable&&(this.draggable.dragRootElement=i?null:this.client.bodyWrapElement)}onBeforeDragStart({drag:i,event:e}){return this.client.trigger("beforeTaskDrag",{drag:i,event:e,domEvent:e,taskRecords:i.taskRecords})}onDragStart({drag:i,event:e}){return this.client.trigger("taskDragStart",{drag:i,event:e,domEvent:e,taskRecords:i.taskRecords})}};y(Hr,"$name","TaskDrag"),y(Hr,"type","taskDrag"),y(Hr,"pluginConfig",{after:["initialCompose"]}),y(Hr,"configurable",{reorderTaskRecords:!1,dragTouchStartDelay:null}),Hr.initClass();var kS=class extends F.mixin(Ra,_a,fe){static get configurable(){return{dragSelector:".b-taskboard-card:not(.b-readonly)",dragItemSelector:".b-taskboard-card:not(.b-readonly)",dropTargetSelector:".b-taskboardbase",draggingItemCls:null,dragProxy:{type:"default",async open(i){const{itemElement:e,startEvent:t}=i,r=this.owner.owner.client,n=e.closest(".b-taskboard-column"),s=r.resolveTaskRecord(e),a=i.proxy=D.createElement({className:"b-taskboard-drag-proxy "+n.className,role:"presentation",retainElement:!0}),l=[];let o;r.selectedTasks.includes(s)?o=r.selectedTasks.filter(c=>!c.readOnly).sort((c,d)=>c.parentIndex-d.parentIndex):o=[s];const u=o.map(c=>r.getTaskElement(c));Object.assign(i,{taskElements:u,taskHeights:new Map,proxyOffset:$.getClientPoint(t).getDelta(V.from(e,null,!0))}),u.forEach(c=>{var d;const{elementData:h}=c,g=c.cloneNode(!0),f=V.from(c,e);g.style.width=f.width+"px",g.style.height=f.height+"px",i.taskHeights.set(c,f.height),g.style.left=f.x+"px",g.style.top=f.y+"px",g.taskElement=c,g.taskRecord=h.taskRecord,g.originalColor=((d=h.swimlaneRecord)==null?void 0:d.color)||h.columnRecord.color,a.appendChild(g),l.push(g)}),u.forEach(c=>c.classList.add("b-drag-original")),await Us.animationFrame(),l.forEach((c,d)=>{d>0?(c.style.top=30+d*20+"px",c.style.left=40+d*5+"px"):(c.style.top=0,c.style.left=0)})},dragMove({proxy:i,event:e,proxyOffset:t}){const{dragRootElement:r}=this.owner,n=r.getBoundingClientRect(),s=$.getClientPoint(e).translate(t[0]-n.left+r.scrollLeft,t[1]-n.top+r.scrollTop);i.style.top=s.y+"px",i.style.left=s.x+"px"}}}}configureListeners(i){const e=super.configureListeners(i);return e.element=this.owner.client.rootElement,e}setupDragContext(i){const e=super.setupDragContext(i),{client:t}=this.owner;return e.scrollManager=t.scrollManager,e.monitoringConfig={scrollables:[{element:".b-taskboard-column-body",direction:"vertical"},{element:t.bodyElement,direction:"both"}]},e}startDrag(i){const{itemElement:e}=i,t=this.owner.client,r=t.resolveTaskRecord(e);return t.isSelected(r)?i.taskRecords=t.selectedTasks.slice().sort((n,s)=>n.parentIndex-s.parentIndex):i.taskRecords=[r],i.initiatedFrom=r,super.startDrag(i)}dragStart(i){const{client:e}=this.owner,t=i.itemElement;i.wasStarted=!0,i.position="after",i.targetTaskRecord=i.initiatedFrom;for(const r of i.taskRecords)r.instanceMeta(e).dragging=!0;e.bodyWrapElement.appendChild(i.proxy),i.dropIndicators=i.taskElements.map((r,n)=>D.createElement({className:{"b-taskboard-card-drop-indicator":1,"b-first-drop-indicator":n===0},style:{height:i.taskHeights.get(r)},elementData:{dropIndicator:!0,initialParent:r.parentElement,initialIndex:Eg(r),taskElement:r},retainElement:!0,nextSibling:t})),e.element.classList.add("b-dragging-task")}dragEnter(i){if(!i.itemElement.matches(this.dragItemSelector))return!1}getFirstVisibleChild(i){for(const e of i.children)if(e.offsetParent)return e}getCardAt(i,e){return this.owner.client.getCardAt(i,e,xg)}updateValidity(i,e){i.proxy.classList.toggle("b-invalid",!e),i.dropIndicators.forEach(t=>t.classList.toggle("b-invalid",!e)),i.invalid=!e}dragMove(i){var e,t,r;const n=this,{client:s}=n.owner,{event:a,dropIndicators:l}=i,{clientX:o,clientY:u}=a,c=s.documentRoot.elementFromPoint(o,u),d=de.getChild(c==null?void 0:c.closest(".b-taskboard-column"),"body.inner");if(i.invalid&&(i.valid=!1),!!c&&d){const h=s.resolveSwimlaneRecord(c),g=s.resolveColumnRecord(c),f=g.tasksPerRow||(h==null?void 0:h.tasksPerRow)||s.tasksPerRow;let m=c.closest(xg),p=h!==i.targetSwimlane||g!==i.targetColumn;if(i.targetSwimlane=h,i.targetColumn=g,!m){const{cardGap:v}=s,b=V.from(d),w=n.getFirstVisibleChild(d),S=(e=w==null?void 0:w.getBoundingClientRect().top)!=null?e:null;if(f===1)if(S!==null&&u<S)m=w;else{const C=b.center.x,T=n.getCardAt(C,u-v),E=n.getCardAt(C,u+v);m=T||E}else{const C=s.getColumnWidth(i.targetColumn),T=(b.width-C)/2,E=C/f,I=Math.floor((o-b.left)/E),R=b.left+T+E*(I+.5);if(S!==null&&u<S)m=n.getCardAt(R,S);else{const M=b.center.x,O=n.getCardAt(M-v,u),A=n.getCardAt(M+v,u);m=O||A}}}if(!(m!=null&&m.elementData.dropIndicator)){let v=!1;if(m){const b=V.from(m),w=s.resolveTaskRecord(m);f===1&&u<b.center.y||f>1&&o<b.center.x?(i.position!=="before"&&(p=!0),v=m,i.position="before"):(i.position!=="after"&&(p=!0),v=m.nextElementSibling,i.position="after"),w!==i.targetTaskRecord&&(p=!0),i.targetTaskRecord=w}else i.position!=="last"&&(p=!0),i.position="last",i.targetTaskRecord=null;(t=v==null?void 0:v.elementData)!=null&&t.dropIndicator||(v===!1?l.forEach(b=>{d==null||d.appendChild(b)}):l.forEach(b=>{((v==null?void 0:v.parentElement)||d).insertBefore(b,v)}),i.lastCardElement=m)}for(const v of i.proxy.children){if(!v.taskRecord.eventColor){const b=((r=i.targetSwimlane)==null?void 0:r.color)||i.targetColumn.color;v.originalColor&&v.classList.remove(`b-taskboard-color-${v.originalColor}`),b&&(v.originalColor=b,D.isNamedColor(b)?v.classList.add(`b-taskboard-color-${b}`):v.style.color=b)}i.targetSwimlane&&(v.dataset.lane=i.targetSwimlane.id),v.dataset.column=i.targetColumn.id}if(p){const{taskRecords:v,targetTaskRecord:b,position:w}=i,S=s.trigger("taskDrag",{drag:i,taskRecords:v,targetSwimlane:h,targetColumn:g,targetTaskRecord:b,position:w,event:a,domEvent:a});n.updateValidity(i,S!==!1)}}}async dragDrop(i){const e=this,{client:t}=e.owner,{dropIndicators:r,taskRecords:n,targetSwimlane:s,targetColumn:a,targetTaskRecord:l,event:o}=i,u={drag:i,domEvent:o,event:o,taskRecords:n,targetSwimlane:s,targetColumn:a,targetTaskRecord:l};!ES(r)||!a||i.invalid||await t.trigger("beforeTaskDrop",u)===!1?i.valid=!1:i.finalizer=new Promise(d=>{var h;const{columnField:g,swimlaneField:f}=t,{taskStore:m}=t.project,{proxy:p}=i,v=a.tasks,b=s?v==null?void 0:v.filter(E=>E[f]===s.id):v,w=!v;let S;if(!w)if(i.targetTaskRecord){if(i.position==="before")S=l;else if(i.position==="after"){const E=b.indexOf(l);S=(h=b[E+1])!=null?h:null}}else b.length&&(S=null);function C(){var E;if(p.remove(),r.forEach(I=>{const{taskElement:R}=I.elementData;I.parentElement.insertBefore(R,I),I.parentElement.syncIdMap[R.elementData.taskId]=R,R.classList.remove("b-drag-original"),I.remove()}),t.suspendDomTransition(),!w){let I;if(S){const R=b.slice(b.indexOf(S)),M=b[b.indexOf(S)-1];let O;for(M?(O=Math.max(1,Math.round((S.weight-M.weight)/2)),I=M.weight+O):I=Math.max(1,Math.round(S.weight/2));((E=R[0])==null?void 0:E.weight)===I;)O=R[1]?Math.max(1,Math.round((R[1].weight-I)/2)):50,I=R[0].weight=I+O,R.shift()}else I=b.length?b[b.length-1].weight+100:100;n.forEach(R=>{const M={[g]:a.id,weight:I};s&&(M[f]=s.id),t.features.taskDrag.reorderTaskRecords&&S!==void 0&&m.move(R,S),R.set(M)}),!t.features.taskDrag.reorderTaskRecords&&!t.taskSorterFn&&t.project.taskStore.sort()}t.resumeDomTransition(),t.trigger("taskDrop",{drag:i,event:o,taskRecords:n,targetSwimlane:s,targetColumn:a,moveBefore:S,domEvent:o}),t.trigger("taskDragEnd",{drag:i,taskRecords:n,domEvent:o}),t.element.classList.remove("b-dragging-task");for(const I of n)I.instanceMeta(t).dragging=!1;d()}const T=Array.from(p.children);p.classList.add("b-pre-dropping"),T[0].offsetWidth,p.classList.add("b-dropping"),T.forEach((E,I)=>{const R=r[I];D.alignTo(E,V.from(R,void 0,!0))}),D.getPropertyTransitionDuration(T[0],"transform")?$.onTransitionEnd({element:T[0],property:"transform",handler:C,thisObj:t}):C()})}dragLeave(i){i.dropIndicators.forEach(e=>{const{taskElement:t}=e.elementData;t.parentElement.insertBefore(e,t)})}doAbort(i){const{client:e}=this.owner,{dropIndicators:t,proxy:r,taskRecords:n}=i;if(r){let s=function(){r.remove(),t.forEach(l=>{l.elementData.taskElement.classList.remove("b-drag-original"),l.remove()}),e.element.classList.remove("b-dragging-task");for(const l of n)l.instanceMeta(e).dragging=!1;e.trigger("taskDragAbortFinalized")};const a=Array.from(r.children);r.classList.add("b-dropping"),t.forEach(l=>{const{taskElement:o}=l.elementData;l.classList.remove("b-invalid"),o.parentElement.insertBefore(l,o)}),a.forEach((l,o)=>{D.alignTo(l,V.from(t[o],void 0,!0))}),D.getPropertyTransitionDuration(a[0],"transform")?$.onTransitionEnd({element:a[0],property:"transform",handler:s,thisObj:e}):s()}e.trigger("taskDragAbort",{drag:i,taskRecords:n}),i.wasStarted&&e.trigger("taskDragEnd",{drag:i,taskRecords:n})}dragEnd(i){(i.started||i.wasStarted)&&(!i.valid||i.aborted)&&this.doAbort(i)}};Hr._$name="TaskDrag";var Yr=class extends Pe{constructor(){super(...arguments),y(this,"state","idle")}changeDragThreshold(i){return x.assertNumber(i,"features.taskDragSelect.dragThreshold"),i}initializeDragSelect(i){const e=this,{client:t}=e;e.bounds=V.from(t.bodyElement,!0),e.element=D.createElement({tag:"div",className:"b-dragselect-rect"},{returnAll:!0})[0],t.floatRoot.appendChild(e.element),t.element.classList.add("b-dragselecting");const r=Array.from(t.element.querySelectorAll(".b-taskboard-card:not(.b-dragging-item)"));e.cardRectangles=r.flatMap(n=>{const s=t.resolveTaskRecord(n);return s?{rectangle:V.from(n,!0),record:s}:[]}),i.ctrlKey||t.deselectAll(),t.navigateable=!1,e.state="selecting"}updateSelection(){const{cardRectangles:i,rectangle:e,client:t}=this;for(let r=0,n=i.length;r<n;r++){const s=i[r],a=e.intersect(s.rectangle,!0);a&&!s.selected?(s.selected=!0,t.selectTask(s.record,!0)):!a&&s.selected&&(s.selected=!1,t.deselectTask(s.record))}}onColumnMouseDown({event:i}){const e=this;!e.disabled&&i.button===0&&(e.state="considering",e.startX=i.clientX,e.startY=i.clientY,e.mouseUpDetacher=$.on({element:document,mouseup:"onMouseUp",thisObj:e}))}onMouseMove({event:i}){const e=this,{startX:t,startY:r}=e,{clientX:n,clientY:s}=i;if(e.state==="considering"){const a=Math.abs(n-t),l=Math.abs(s-r);(a>e.dragThreshold||l>e.dragThreshold)&&e.initializeDragSelect(i)}if(e.state==="selecting"){const{element:a,bounds:l}=e,o=Math.max(n,l.left),u=Math.max(s,l.top),c=Math.min(t,o),d=Math.min(r,u),h=Math.abs(t-o),g=Math.abs(r-u),f=new V(c,d,h,g).constrainTo(l);D.setTranslateXY(a,f.left,f.top),a.style.width=f.width+"px",a.style.height=f.height+"px",e.rectangle=f,e.updateSelection()}}onMouseUp(){var i,e;const t=this,{client:r,state:n}=t;n==="selecting"&&((i=t.element)==null||i.remove(),r.element.classList.remove("b-dragselecting"),r.setTimeout(()=>r.navigateable=!0,100)),(n==="selecting"||n==="considering")&&(t.state="idle",t.startX=t.startY=t.rectangle=t.bounds=null),(e=t.mouseUpDetacher)==null||e.call(t)}};y(Yr,"$name","TaskDragSelect"),y(Yr,"type","taskDragSelect"),y(Yr,"configurable",{dragThreshold:5}),y(Yr,"pluginConfig",{chain:["onColumnMouseDown","onMouseMove"]}),Yr.initClass(),Yr._$name="TaskDragSelect";var Fe=i=>{var e;return e=class extends(i||F){get taskBoard(){return this._taskBoard||this.up(t=>t.isTaskBoardBase)||j.query(t=>t.isTaskBoardBase)}changeTaskBoard(t){if(t&&!t.isTaskBoard)throw new Error("The taskBoard config only accepts an instance of TaskBoard or a subclass thereof");return t}},y(e,"$name","TaskBoardLinked"),y(e,"configurable",{taskBoard:null}),e},Ur=class extends ze.mixin(Fe){afterConstruct(){!this.showBoxForNoColor&&!this.value&&this.element.classList.add("b-colorless")}syncInputFieldValue(...i){const e=this,{color:t}=e.record||{};let r="b-colorbox";t&&(D.isNamedColor(t)?r+=` b-taskboard-color-${t}`:e.colorBox.style.color=t),e.colorBox.className=r,e.showBoxForNoColor||e.element.classList.toggle("b-colorless",!t),super.syncInputFieldValue(...i)}get innerElements(){return[{reference:"colorBox",className:"b-colorbox"},...super.innerElements]}};y(Ur,"$name","ColorBoxCombo"),y(Ur,"type","colorboxcombo"),y(Ur,"configurable",{displayField:"text",valueField:"id",editable:!1,showBoxForNoColor:!1,listItemTpl({text:i,color:e}){let t=P.encodeHtml(i);return e&&(D.isNamedColor(e)?t=`<div class="b-colorbox b-taskboard-color-${e}"></div>`+t:t=`<div class="b-colorbox" style="color : ${e}"></div>`+t),t},picker:{cls:"b-colorbox-picker"}}),Ur._$name="ColorBoxCombo";var Cs=class extends Ur{changeStore(){return this.taskBoard.columns.chain()}};y(Cs,"$name","ColumnCombo"),y(Cs,"type","columncombo"),Cs.initClass(),Cs._$name="ColumnCombo";var zi=class extends ze.mixin(Fe){get innerElements(){return this.peekConfig("multiSelect")||this._multiSelect?super.innerElements:[{reference:"avatarContainer"},this.inputElement]}syncInputFieldValue(...i){const e=this;if(!e.multiSelect){const t=e.record;t&&de.sync({targetElement:e.avatarContainer,domConfig:{className:"b-resourcescombo-avatar-container",children:[e.avatarRendering.getResourceAvatar({resourceRecord:t,initials:t.initials,color:t.color,iconCls:t.iconCls,imageUrl:t.image===!1?null:t.imageUrl||(e.taskBoard.resourceImagePath||"")+(t.image||""),dataset:{btip:P.encodeHtml(t.name)}})]}})}super.syncInputFieldValue(...i)}changeStore(){return this.taskBoard.project.resourceStore.chain()}changeAvatarRendering(i,e){if(e==null||e.destroy(),i)return new ms({element:this.element})}};y(zi,"$name","ResourcesCombo"),y(zi,"type","resourcescombo"),y(zi,"configurable",{displayField:"name",valueField:"id",multiSelect:!0,editable:!1,listItemTpl(i){const{avatarRendering:e,taskBoard:t}=this.owner;return D.createElement(e.getResourceAvatar({resourceRecord:i,initials:i.initials,color:i.color,iconCls:i.iconCls,imageUrl:i.image===!1?null:i.imageUrl||(t.resourceImagePath||"")+(i.image||"")})).outerHTML+P.encodeHtml(i.name)},picker:{cls:"b-resources-picker"},chipView:{scrollable:null,itemTpl(i){const{avatarRendering:e,taskBoard:t}=this.owner;return D.createElement(e.getResourceAvatar({resourceRecord:i,initials:i.initials,color:i.color,iconCls:i.iconCls,imageUrl:i.image===!1?null:i.imageUrl||(t.resourceImagePath||"")+(i.image||""),dataset:{btip:P.encodeHtml(i.name)}})).outerHTML}},avatarRendering:{value:!0,$config:"nullify"}}),zi.initClass(),zi._$name="ResourcesCombo";var Ss=class extends Ur{changeStore(){return this.taskBoard.swimlanes.chain()}};y(Ss,"$name","SwimlaneCombo"),y(Ss,"type","swimlanecombo"),Ss.initClass(),Ss._$name="SwimlaneCombo";var Wi=class extends Pr{};y(Wi,"$name","TaskColorPicker"),y(Wi,"type","taskcolorpicker"),y(Wi,"configurable",{colorClasses:[{color:"red",text:"Red"},{color:"pink",text:"Pink"},{color:"purple",text:"Purple"},{color:"deep-purple",text:"Deep purple"},{color:"indigo",text:"Indigo"},{color:"blue",text:"Blue"},{color:"light-blue",text:"Light blue"},{color:"cyan",text:"Cyan"},{color:"teal",text:"Teal"},{color:"green",text:"Green"},{color:"light-green",text:"Light green"},{color:"lime",text:"Lime"},{color:"yellow",text:"Yellow"},{color:"amber",text:"Amber"},{color:"orange",text:"Orange"},{color:"deep-orange",text:"Deep orange"}],colorClassPrefix:"b-taskboard-background-color-",colors:null}),Wi.initClass(),Wi._$name="TaskColorPicker";var Hi=class extends Fr{};y(Hi,"$name","TaskColorCombo"),y(Hi,"type","taskcolorcombo"),y(Hi,"configurable",{picker:{type:"taskcolorpicker"},name:"eventColor",clearable:!0}),Hi.initClass(),Hi._$name="TaskColorCombo";var Yi=class extends _r.mixin(Fe){changeItems(i,e){const{taskBoard:t}=this,{column:r,swimlane:n,resources:s}=i;return t?(r&&(r.name||(r.name=t.columnField),r.label||(r.label=P.capitalize(t.columnField))),n&&(!t.swimlaneField||!t.swimlanes?i.swimlane=null:(n.name||(n.name=t.swimlaneField),n.label||(n.label=P.capitalize(t.swimlaneField)))),t.project.resourceStore.count||(i.resources=null),t.project.eventStore.usesSingleAssignment&&s&&(s.multiSelect=!1)):i.column=i.swimlane=i.resources=null,super.changeItems(i,e)}processItemsObject(i,e,t){for(const r in i){const n=i[r];n&&!("name"in n)&&(n.name=r)}return super.processItemsObject(i,e,t)}updateAutoUpdateRecord(i){this.bbar.hidden=i}updateRecord(i){super.updateRecord(i),i&&(this.element.dataset.taskId=i.id)}onSaveClick(){const i=this,{record:e,owner:t}=i,{resources:r,...n}=i.values;if(i.isValid){if((t==null?void 0:t.trigger("beforeSave",{record:e,values:i.values,editor:i}))===!1)return;t==null||t.trigger("save",{record:e,values:i.values,editor:i}),i.close(),e.set(n),r&&(e.resources=r)}}onCancelClick(){var i,e;const t=this;((i=t.owner)==null?void 0:i.trigger("beforeCancel",{editor:t}))!==!1&&((e=t.owner)==null||e.trigger("cancel",{editor:t}),t.close())}onInternalKeyDown(i){const e=this;e.saveAndCloseOnEnter&&!e.readOnly&&i.key==="Enter"&&(i.preventDefault(),e.autoUpdateRecord?e.isValid&&(i.target.blur(),e.close()):e.onSaveClick()),super.onInternalKeyDown(i)}};y(Yi,"$name","TaskEditor"),y(Yi,"type","taskboardtaskeditor"),y(Yi,"configurable",{centered:!0,modal:{closeOnMaskTap:!0},closable:!0,autoUpdateRecord:!0,autoUpdateFields:!0,saveAndCloseOnEnter:!0,draggable:{handleSelector:".b-panel-header"},autoShow:!1,anchor:!0,closeAction:"destroy",scrollAction:"realign",title:"L{TaskBoard.editTask}",defaults:{labelWidth:"30%"},width:"30em",items:{name:{type:"text",label:"L{TaskBoard.name}",weight:100},description:{type:"textarea",label:"L{TaskBoard.description}",height:"5em",weight:200},resources:{type:"resourcescombo",label:"L{TaskBoard.resources}",weight:300},color:{type:"taskcolorcombo",label:"L{TaskBoard.color}",name:"eventColor",weight:400},column:{type:"columncombo",weight:500},swimlane:{type:"swimlanecombo",weight:600}},bbar:{hidden:!0,items:{saveButton:{text:"L{TaskBoard.save}",onClick:"up.onSaveClick",weight:100},cancelButton:{text:"L{TaskBoard.cancel}",onClick:"up.onCancelClick",weight:200}}},maximizeOnMobile:!0}),Yi.initClass(),Yi._$name="TaskEditor";var qr=class extends Pe{constructor(){super(...arguments),y(this,"editor",null)}doDestroy(){var i;(i=this.editor)==null||i.destroy()}changeEditorConfig(i){return x.assertObject(i,"features.taskEdit.editorConfig"),i}changeEditorType(i){return x.assertString(i,"features.taskEdit.editorType"),i}changeItems(i){return x.assertObject(i,"features.taskEdit.items"),i}changeProcessItems(i){return x.assertFunction(i,"features.taskEdit.processItems"),i}async editTask(i,e=null){var t,r;const n=this,{client:s}=n,a=s.getColumn(i),l=s.swimlaneField&&((t=s.swimlanes)==null?void 0:t.getById(i.getValue(s.swimlaneField)));if(n.disabled||await s.trigger("beforeTaskEdit",{taskRecord:i})===!1)return;n.isEditing&&n.cancelEdit();const o=j.resolveType(n.editorType),u=o.mergeConfigs(o.$meta.config.items,n.items);if(((r=n.processItems)==null?void 0:r.call(n,{items:u,taskRecord:i,columnRecord:a,swimlaneRecord:l}))===!1)return;const d=n.editor=o.new({items:u,owner:s,readOnly:i.readOnly},n.editorConfig);s.trigger("beforeTaskEditShow",{taskRecord:i,editor:d}),d.record=i,d.centered||!U.isHoverableDevice?d.show():(Gt.scrollIntoView(e!=null?e:s.getTaskElement(i)),d.showBy(e!=null?e:s.getTaskElement(i))),d.isVisible&&d.ion({hide:n.onEditorHide,thisObj:n})}cancelEdit(){}onActivateTask({taskRecord:i,event:e}){e.defaultPrevented||this.editTask(i)}populateTaskMenu({items:i,taskRecord:e}){!this.client.readOnly&&!this.disabled&&(i.editTask={text:"L{TaskBoard.editTask}",icon:"b-fw-icon b-icon-edit",weight:100,onItem:()=>this.editTask(e),disabled:e.readOnly})}onEditorHide(){var i;(i=this.client.getTaskElement(this.editor.record))==null||i.focus()}};y(qr,"$name","TaskEdit"),y(qr,"type","taskEdit"),y(qr,"configurable",{editorType:"taskboardtaskeditor",editorConfig:{},items:{},processItems:null}),y(qr,"pluginConfig",{assign:["editTask"],chain:["onActivateTask","populateTaskMenu"]}),qr.initClass(),qr._$name="TaskEdit";var Kr=class extends xa{static get pluginConfig(){const i=super.pluginConfig;return i.chain.push("populateTaskMenu"),i}changeItems(i){return x.assertObject(i,"features.taskMenu.items"),i}changeProcessItems(i){return x.assertFunction(i,"features.taskMenu.processItems"),i}updateTriggerEvent(i){this.detachListeners("triggerEvent"),i&&this.client.ion({name:"triggerEvent",[i]:"onTriggerEvent",thisObj:this})}doDisable(i){super.doDisable(i),!this.isConfiguring&&this.client.recompose()}onTriggerEvent({event:i}){this.internalShowContextMenu(i)}showMenuFor(i,e=".b-taskboard-task-menu"){const t=this.client.getTaskElement(i),r=t.querySelector(e),n={taskRecord:i,columnRecord:this.client.getColumn(i),targetElement:t};let s=null;r&&(n.targetElement=r,s={target:r}),this.showContextMenu(n,s)}showContextMenu(i,...e){this.client.isSelected(i.taskRecord)||this.client.selectTask(i.taskRecord),super.showContextMenu(i,...e)}getDataFromEvent(i){return x.assign(super.getDataFromEvent(i),i.taskBoardData)}populateTaskMenu({items:i,taskRecord:e}){var t;const{client:r,disabled:n}=this;if(!r.readOnly&&!n){const{columnField:s,swimlaneField:a,selectedTasks:l}=r,{resourceStore:o,eventStore:u}=r.project,c=l.includes(e);i.column={text:`L{TaskBoard.changeColumn} ${s}`,icon:"b-fw-icon b-icon-move-left-right",weight:300,disabled:e.readOnly,menu:r.columns.map(d=>({ref:d.id,text:P.encodeHtml(d.text),cls:"b-column-menu-item",isColumn:!0,checked:e.getValue(s)===d.id,closeParent:!0})),onItem({item:d}){d.isColumn&&(e.setValue(s,d.ref),d.parent.items.forEach(h=>{h!==d&&(h.checked=!1)}))}},(t=r.swimlanes)!=null&&t.count&&a&&(i.swimlane={text:P.xss`L{TaskBoard.changeSwimlane} ${a}`,icon:"b-fw-icon b-icon-move-up-down",weight:400,disabled:e.readOnly,menu:r.swimlanes.map(d=>({ref:d.id,text:P.encodeHtml(d.text),isSwimlane:!0,checked:e.getValue(a)===d.id,closeParent:!0})),onItem({item:d}){d.isSwimlane&&(e.setValue(a,d.ref),d.parent.items.forEach(h=>{h!==d&&(h.checked=!1)}))}}),o.count&&(i.resources={text:"L{TaskBoard.resources}",icon:"b-fw-icon b-icon-user",weight:200,disabled:e.readOnly,menu:o.map(d=>{var h;const g=(h=this.avatarRendering)==null?void 0:h.getResourceAvatar({resourceRecord:d,initials:d.initials,color:d.color,iconCls:d.iconCls,imageUrl:d.imageUrl||(r.resourceImagePath||"")+(d.image||"")});return{ref:d.id,cls:"b-resource-menu-item",text:g?{className:"b-resource-menu-item-inner",children:[g,P.encodeHtml(d.name)]}:P.encodeHtml(d.name),resource:d,checked:e.resources.includes(d),toggleGroup:u.usesSingleAssignment?"single":null}}),onItem({item:d}){d.resource&&e[d.checked?"assign":"unassign"](d.resource)}}),i.removeTask={text:c&&l.length>1?"L{TaskBoard.removeTasks}":"L{TaskBoard.removeTask}",icon:"b-fw-icon b-icon-trash",cls:"b-separator",weight:500,disabled:e.readOnly,onItem:()=>r.removeTask(c?l:e)}}}get showMenu(){return!0}updateShowAvatars(i){var e;(e=this.avatarRendering)==null||e.destroy(),i&&(this.avatarRendering=new ms({element:this.client.element}))}};y(Kr,"$name","TaskMenu"),y(Kr,"type","taskMenu"),y(Kr,"configurable",{processItems:null,items:null,type:"task",triggerEvent:"taskContextMenu",showAvatars:{value:!0,$config:"nullify"},menu:{align:"t90-b90",anchor:!0}}),Pe.register(Kr.type,Kr),Kr._$name="TaskMenu";var Gr=class extends Pe{changeTemplate(i){return x.assertFunction(i,"features.taskTooltip.template"),i}doDisable(i){super.doDisable(i),this._tooltip&&(this.tooltip.disabled=i)}changeTooltip(i,e){const t=this,{client:r}=t;if(x.assertObject(i,"features.taskTooltip.tooltip"),e==null||e.destroy(),i)return new je(x.assign({axisLock:"flexible",cls:"b-taskboard-tooltip",forSelector:".b-taskboardbase:not(.b-draghelper-active) .b-taskboard-card",scrollAction:"realign",forElement:r.element,showOnHover:!0,hoverDelay:0,hideDelay:100,anchorToTarget:!0,allowOver:!!(t.config.items||t.config.tools),getHtml:t.getTipHtml.bind(t),disabled:t.disabled,textContent:!1},i))}getTipHtml({tip:i,activeTarget:e}){const{client:t}=this,r=t.resolveTaskRecord(e),n=t.resolveColumnRecord(e),s=t.resolveSwimlaneRecord(e);if(this.template)return this.template({tip:i,taskRecord:r,columnRecord:n,swimlaneRecord:s,activeTarget:e});const a=[{class:"b-taskboard-tooltip-title",text:r.name},{class:"b-taskboard-tooltip-label",text:P.capitalize(t.columnField)},{class:"b-taskboard-tooltip-value",text:n.text}];return s&&a.push({class:"b-taskboard-tooltip-label",text:P.capitalize(t.swimlaneField)},{class:"b-taskboard-tooltip-value",text:s.text}),r.resources.length&&a.push({class:"b-taskboard-tooltip-label",text:this.L("L{TaskBoard.resources}")},{class:"b-taskboard-tooltip-value",text:r.resources.map(l=>l.name).join(", ")}),{children:a}}render(){this.getConfig("tooltip")}};y(Gr,"$name","TaskTooltip"),y(Gr,"type","taskTooltip"),y(Gr,"configurable",{tooltip:{value:{},$config:["lazy","nullify"]},template:null}),y(Gr,"pluginConfig",{chain:["render"]}),Gr.initClass(),Gr._$name="TaskTooltip";var ws=class extends Q{get tasks(){return this.taskBoard.getColumnTasks(this,!0)}get taskBoard(){return this.firstStore.taskBoard}async collapse(){return this.taskBoard.collapse(this)}async expand(){return this.taskBoard.expand(this)}};y(ws,"$name","ColumnModel"),y(ws,"fields",["text","tooltip",{name:"color",type:"string"},"tasksPerRow",{name:"collapsible",type:"boolean",defaultValue:!0},{name:"collapsed",type:"boolean"},{name:"hidden",type:"boolean"},{name:"width",type:"number"},{name:"flex",type:"number"},{name:"minWidth",type:"number"}]),ws._$name="ColumnModel";var kg=i=>{var e;return e=class extends(i||Q){static get configurable(){return{assignments:null,dependencies:null,resources:null,timeRanges:null}}static get autoExposeFields(){return!1}get assignments(){return this.assignmentStore.allRecords}updateAssignments(t){this.assignmentStore.data=t}get dependencies(){return this.dependencyStore.allRecords}updateDependencies(t){this.dependencyStore.data=t}get resources(){return this.resourceStore.allRecords}updateResources(t){this.resourceStore.data=t}get timeRanges(){return this.timeRangeStore.allRecords}getTimeRanges(t,r){const n=this.timeRangeStore,s=[];for(const a of n)a.isRecurring?s.push(...a.getOccurrencesForDateRange(t,r)):a.startDate<r&&t<a.endDate&&s.push(a);return s}updateTimeRanges(t){this.timeRangeStore.data=t}getResourceTimeRanges(t,r){const n=this.resourceTimeRangeStore,s=[];for(const a of n)a.isRecurring?s.push(...a.getOccurrencesForDateRange(t,r)):a.startDate<r&&(!a.endDate||t<a.endDate)&&s.push(a);return s}},y(e,"$name","ProjectModelCommon"),e},wu={startDate:1,endDate:1,constraintDate:1,deadlineDate:1},Ig=i=>{var e;return e=class extends i{get timeZone(){return this.getData("timeZone")}set timeZone(t){this.setData("timeZone",t)}setLocalDate(t,r){const n=this;n.set(t,n.timeZone!=null?Ve.toTimeZone(r,n.timeZone):r,!0),n.setData(t,n[t])}getLocalDate(t){return this.timeZone!=null&&this[t]?Ve.fromTimeZone(this[t],this.timeZone):this[t]}applyChangeset(t){if(this.timeZone!=null)for(const r in wu)t[r]&&(this.setLocalDate(r,new Date(t[r])),delete t[r]);return super.applyChangeset(...arguments)}getFieldPersistentValue(t){var r,n;if(this.timeZone!=null){const s=(n=(r=t==null?void 0:t.field)!=null?r:t==null?void 0:t.name)!=null?n:t;if(wu[s])return this.getLocalDate(s)}return super.getFieldPersistentValue(t)}convertToTimeZone(t){const r=this,n={...r.meta.modified},s={...wu};r.isTask&&!r.manuallyScheduled&&(delete s.startDate,delete s.endDate);for(const a in s)r[a]!=null?(s[a]=r[a],r.timeZone!=null&&(s[a]=r.getLocalDate(a),n[a]&&(n[a]=Ve.fromTimeZone(n[a],r.timeZone)))):delete s[a];r.timeZone=t;for(const a in s)r.setLocalDate(a,s[a],!1),s[a]=1,r.timeZone!=null&&n[a]&&(n[a]=Ve.toTimeZone(n[a],r.timeZone));r.clearChanges(!0,!0,s),x.isEmpty(n)||(r.meta.modified=n,r.stores.forEach(a=>a.modified.add(r)))}},y(e,"$name","TimeZonedDatesMixin"),y(e,"fields",[{name:"timeZone",persist:!1}]),e},hr=class extends Q.mixin(Ig){construct(i,...e){const t=this;if(i!=null&&i.fullDuration){const{magnitude:r,unit:n}=i.fullDuration;i.duration=r,i.unit=n,delete i.fullDuration}super.construct(i,...e),t.normalize(),t.startDateMS&&t.endDateMS&&t.startDateMS>t.endDateMS&&console.error(`startDate > endDate for ${t.constructor.$name} record with id: ${t.id}`)}internalCalculateStartDate(i,e,t){return k.add(i,-e,t)}internalCalculateEndDate(i,e,t){return k.add(i,e,t)}internalCalculateDuration(i,e,t){return k.as(t,k.diff(i,e,"h"),"h")}internalNormalize(i,e,t,r){const n=this,s=t!=null;i&&e&&!s?n.setData("duration",n.internalCalculateDuration(i,e,r)):i&&!e&&s?n.setData("endDate",n.internalCalculateEndDate(i,t,r)):!i&&e&&s&&n.setData("startDate",n.internalCalculateStartDate(e,t,r))}normalize(){this.internalNormalize(this.startDate,this.endDate,this.duration,this.durationUnit||this.constructor.defaultValues.durationUnit)}get eventStore(){var i;const e=this;return e.isOccurrence?e.recurringTimeSpan.eventStore:(e._eventStore||(e._eventStore=(i=e.stores)==null?void 0:i.find(t=>t.isEventStore)),e._eventStore)}updateInternalCls(i){this._cls?this._cls.value=i:this._cls=new J(i)}set internalCls(i){this.updateInternalCls(i),this.set("cls",this._cls.value)}get internalCls(){const{cls:i}=this;return i!=null&&i.isDomClassList?i:(this.updateInternalCls(i),this.setData("cls",this._cls.value),this._cls)}get cls(){return this._cls||(this._cls=new J(super.get("cls"))),this._cls}set cls(i){this.internalCls=i}get startDate(){return this.get("startDate")}set startDate(i){this.setStartDate(i)}get endDate(){return this.get("endDate")}set endDate(i){this.setEndDate(i)}get endingDate(){const i=this,{endDate:e,startDate:t}=i;return e||k.add(t,i.duration,i.durationUnit)}get duration(){return this.get("duration")}set duration(i){this.setDuration(i,this.durationUnit)}get durationUnit(){return this.get("durationUnit")}setDuration(i,e=this.durationUnit){i=parseFloat(i),this.set({duration:i,durationUnit:e,...this.updateDatesFromDuration(i,e)})}updateDatesFromDuration(i,e,t=this.startDate,r=this.endDate){const n={};return t?n.endDate=this.internalCalculateEndDate(t,i,e):r&&(n.startDate=this.internalCalculateStartDate(r,i,e)),n}getDurationInUnit(i,e){const t=this;return t.startDate&&t.endDate?k.getDurationInUnit(t.startDate,t.endDate,i,e):k.as(i,t.duration,t.durationUnit)}get fullDuration(){return new Re({unit:this.durationUnit,magnitude:this.duration})}set fullDuration(i){typeof i=="string"&&(i=k.parseDuration(i,!0,this.durationUnit)),this.setDuration(i.magnitude,i.unit)}setStartDate(i,e=!0){const t=this,r={startDate:i};if(i){let n;if(e)n=t.duration!=null;else if(t.endDate){if(r.duration=t.internalCalculateDuration(i,t.endDate,t.durationUnit),r.duration<0)throw new Error("Negative duration")}else n=t.duration!=null;n&&(r.endDate=t.internalCalculateEndDate(i,t.duration,t.durationUnit))}else r.duration=null;t.set(r)}setEndDate(i,e=!1){const t=this,r={endDate:i};if(i){let n;if(e===!0)n=t.duration!=null;else if(t.startDate){if(r.duration=t.internalCalculateDuration(t.startDate,i,t.durationUnit),r.duration<0)throw new Error("Negative duration")}else n=this.duration!=null;n&&(r.startDate=t.internalCalculateStartDate(i,t.duration,t.durationUnit))}t.set(r)}setStartEndDate(i,e,t){if(i>e)throw new Error("Start date must be less or equal to end date");this.set({startDate:i,endDate:e},null,t)}get dates(){const i=[],e=k.startOf(this.startDate,"day"),t=this.endDate;for(let r=e;r<t;r=k.add(r,1,"day"))i.push(r);return i}get startDateMS(){var i;return(i=this.batching&&this.hasBatchedChange("startDate")?this.get("startDate"):this.startDate)==null?void 0:i.getTime()}get endDateMS(){var i;return(i=this.batching&&this.hasBatchedChange("endDate")?this.get("endDate"):this.endDate)==null?void 0:i.getTime()}get durationMS(){const{endDateMS:i,startDateMS:e}=this;return i&&e?i-e:k.asMilliseconds(this.duration||0,this.durationUnit)}get isMilestone(){return this.duration===0}inSetNormalize(i){if(typeof i!="string"){let{startDate:e,endDate:t,duration:r,durationUnit:n=this.durationUnit}=i;typeof e=="string"&&(e=this.getFieldDefinition("startDate").convert(e)),typeof t=="string"&&(t=this.getFieldDefinition("endDate").convert(t)),"duration"in i?(e&&!t&&(t=this.internalCalculateEndDate(e,r,n)),!e&&t&&(e=this.internalCalculateStartDate(t,r,n))):e&&t&&(r=this.internalCalculateDuration(e,t,n));const s=Object.isFrozen(i)?x.clone(i):i;return e&&(s.startDate=e),t&&(s.endDate=t),r!=null&&(s.duration=r),s}}fieldToKeys(i,e){var t,r;const n=super.fieldToKeys(i,e);if(n.fullDuration){const{magnitude:s,unit:a}=n.fullDuration;n.duration=s,n.durationUnit=a}return!this.isEventModel&&!this.isTaskModel&&("duration"in n||n.durationUnit)&&!(n.startDate&&n.endDate)&&Object.assign(n,this.updateDatesFromDuration((t=n.duration)!=null?t:this.duration,(r=n.durationUnit)!=null?r:this.durationUnit,n.startDate,n.endDate)),n}inSet(i,e,t,r,n,s,a){var l;const o=this;n||(i=o.inSetNormalize(i)||i);const u=super.inSet(i,e,t,r,n,s,a);if(!((l=o.project)!=null&&l.isWritingData)&&i.startDate&&i.endDate){let c;i.startDate instanceof Date&&i.endDate instanceof Date?c=i.startDate>i.endDate:o.fieldMap.startDate.convert(i.startDate)>o.fieldMap.endDate.convert(i.endDate)&&(c=!0),c&&console.error(`startDate > endDate for ${o.constructor.$name} record with id: ${o.id}`)}return u}applyValue(i,e,t,r,n){e==="cls"&&this.updateInternalCls(t),super.applyValue(i,e,t,r,n)}forEachDate(i,e){return this.dates.forEach(i.bind(e))}get isScheduled(){const{startDateMS:i,endDateMS:e}=this;return e-i>=0}get isValid(){const{startDate:i,endDate:e}=this;return!i||!e||e-i>=0}shift(i,e=this.durationUnit){if(typeof i=="string"){const t=i;i=e,e=t}return this.setStartDate(k.add(this.startDate,i,e,!0),!0)}get wbsCode(){return this._wbsCode||this.indexPath.join(".")}set wbsCode(i){this._wbsCode=i}fullCopy(){return this.copy.apply(this,arguments)}intersects(i){return this.intersectsRange(i.startDate,i.endDate)}intersectsRange(i,e){const t=this.startDate,r=this.endDate;return t&&r&&k.intersectSpans(t,r,i,e)}split(i=.5){const e=this,t=e.copy(),{fullDuration:r,eventStore:n,assignmentStore:s}=e,a=new Re(r),l=new Re(r);let o,u;return typeof i=="string"?(o=new Re(i),o.unit===a.unit?l.magnitude-=o.magnitude:(l.magnitude=k.as(o.unit,a)-o.magnitude,l.unit=o.unit,u=!0)):(o=new Re(i>1?i:e.duration*i,e.durationUnit),l.magnitude-=o.magnitude),t.startDate=k.add(e.startDate,o.magnitude,o.unit),u?(t.fullDuration=l,e.fullDuration=o):(t.duration=l.magnitude,e.duration=o.magnitude),n&&(n.add(t),s&&!n.usesSingleAssignment&&s.add(e.assignments.map(c=>{const d=Object.assign({},c.data,{eventId:t.id,event:null,resource:null});return delete d.id,d}))),t}toICSString(i={}){if(!this.isScheduled)return"";const{startDate:e,endDate:t}=this,r=i.DTSTAMP||k.format(new Date,"uu");delete i.DTSTAMP;let n={};this.allDay?n={"DTSTART;VALUE=DATE":k.format(e,"u"),"DTEND;VALUE=DATE":k.format(t,"u")}:n={DTSTART:k.format(e,"uu"),DTEND:k.format(t,"uu")};const s=ie.scheduler&&ie.getVersion("scheduler")||ie.calendar&&ie.getVersion("calendar")||"",a={BEGIN:"VCALENDAR",VERSION:"2.0",CALSCALE:"GREGORIAN",PRODID:`-//Bryntum AB//Bryntum Scheduler ${s} //EN`,END:"VCALENDAR"},l={BEGIN:"VEVENT",UID:this.id+"@bryntum.com",CLASS:"PUBLIC",SUMMARY:this.name,DTSTAMP:r,...n,...this.recurrenceRule?{RRULE:this.recurrenceRule}:{},...i,END:"VEVENT"},o=Object.keys(a).map(c=>`${c}:${a[c]}`),u=Object.keys(l).map(c=>`${c}:${l[c]}`);return o.splice(o.length-1,0,...u),o.join(`
`)}exportToICS(i){if(this.isScheduled){const e=new Blob([this.toICSString(i)],{type:"text/calendar"});U.downloadBlob(e,(this.name||"Event")+".ics")}}isEditable(i){return this.getFieldDefinition(i)?!0:void 0}isFieldModified(i){return i==="fullDuration"?super.isFieldModified("duration")||super.isFieldModified("durationUnit"):super.isFieldModified(i)}};y(hr,"$name","TimeSpan"),y(hr,"fields",[{name:"startDate",type:"date"},{name:"endDate",type:"date"},{name:"duration",type:"number",allowNull:!0,internal:!0},{type:"durationunit",name:"durationUnit",defaultValue:"d",internal:!0},{name:"fullDuration",persist:!1,column:{type:"duration"},useProp:!0},{name:"cls",defaultValue:"",internal:!0},{name:"iconCls",internal:!0},{name:"style",type:"object",internal:!0},{name:"name",type:"string",defaultValue:""}]),hr._$name="TimeSpan";var IS=/^([+-]?[0-9])?(SU|MO|TU|WE|TH|FR|SA)$/,Mg=["SU","MO","TU","WE","TH","FR","SA"],Ds=class extends F{static decodeDay(i){let e,t;return(e=IS.exec(i))&&(t=[Mg.indexOf(e[2])],e[1]&&(e[1]=parseInt(e[1],10),t.push(e[1]))),t}static encodeDay(i){let e;return Array.isArray(i)&&([i,e]=i),(e?e.toString():"")+Mg[i]}static decode(i){const e=[];let t;if(i)for(let r=0;r<i.length;r++)(t=this.decodeDay(i[r]))&&e.push(t);return e}static encode(i){const e=[];let t;if(i)for(let r=0;r<i.length;r++)(t=this.encodeDay(i[r]))&&e.push(t);return e}};Ds._$name="RecurrenceDayRuleEncoder";var MS=/ly$/i,Du=i=>{const e=i.replace(MS,"");return e==="DAI"?"DAY":e},RS=(i,e,t,r)=>r.buildOccurrence(i,t),_S=i=>Tu=i,Tu,fr=class extends F{static processIterationConfig(i){const{recurrence:e}=i,{frequency:t,interval:r,timeSpan:n,endDate:s,count:a}=e;if(!i.syncingStartDate&&!n.meta.isSyncedWithRule){const d=k.add(n.startDate,r,Du(t)),h=k.min(d,i.endDate||d);this.forEachDate({syncingStartDate:!0,startDate:n.startDate,endDate:h,recurrence:e,fn:RS})}const l=n.startDate;let{startDate:o=l,endDate:u=s}=i;o<l&&(o=l),s?(!u||u>s)&&(u=s):a&&o>l&&(this.forEachDate({recurrence:e,fn:_S}),(!u||u>Tu)&&(u=new Date(Tu.getTime()+1)));const c=o;return i.startOnly||(o=new Date(k.max(k.add(o,-r,Du(t)),l))),Object.assign({extraArgs:[],startOnly:!n.durationMS},i,{startDate:o,endDate:u,timeSpan:n,timeSpanStart:l,earliestVisibleDate:c,endDateMS:u==null?void 0:u.getTime(),timeSpanStartMS:l.getTime(),earliestVisibleDateMS:c.getTime(),durationMS:n.durationMS,spansStart:o<=l&&u>l})}static getOccurrenceIndex(i){if(i.isOccurrence)return k.diff(i.recurringTimeSpan.startDate,i.startDate,Du(i.recurringTimeSpan.recurrence.frequency))}static getNthDayInPeriod(i,e,t,r){let n,s,a;if(r){r>0?(s=1,a=i):(s=-1,a=e);const l=t-a.getDay();s*l<0&&(r+=s),n=new Date(a),n.setDate(a.getDate()+(r-s)*7+l),(n<i||n>e)&&(n=null)}return n}static buildDate(i,e,t){const r=new Date(i,e,t);if(r.getFullYear()===i&&r.getMonth()===e&&r.getDate()===t)return r}static isValidPosition(i){return!!i}static forEachDateAtPositions(i,e,t,r){const n=i.length,s={};for(let a=0;a<e.length;a++){const l=e[a];if(this.isValidPosition(l)){const o=l>0?i[l-1]:i[n+l];if(o&&!s[o.getTime()]&&(s[o.getTime()]=!0,t.call(r,o)===!1))return!1}}}static isInView(i,e,t,r,n){return(i?e>=t:e.valueOf()+r>t)&&!n.hasException(e)}static isInViewMS(i,e,t,r,n,s){return(i?t>=r:t+n>r)&&!s.hasException(e)}};y(fr,"frequency","NONE"),y(fr,"MAX_OCCURRENCES_COUNT",1e6),fr._$name="AbstractRecurrenceIterator";var xu=class extends fr{static forEachDate(i){const{startOnly:e,startDate:t,endDate:r,endDateMS:n,timeSpan:s,timeSpanStart:a,earliestVisibleDateMS:l,durationMS:o,spansStart:u,recurrence:c,fn:d,extraArgs:h,scope:g=this}=this.processIterationConfig(i),{interval:f}=c,m=t-a,p=f*864e5,v=Math.floor(m/p);let{count:b}=c,w=0,S=k.add(a,v*f,"day"),C=S.getTime();for(!r&&!b&&(b=this.MAX_OCCURRENCES_COUNT);!n||C<n;){const T=this.isInViewMS(e,S,C,l,o,s);if(w++,T&&(n&&C>n||d.apply(g,[S,w,w===1&&u,s,...h])===!1||b&&w>=b))break;S=k.add(S,f,"day"),C=S.getTime()}}};y(xu,"frequency","DAILY"),xu._$name="DailyRecurrenceIterator";var Eu=class extends fr{static forEachDate(i){const{startOnly:e,startDate:t,endDateMS:r,timeSpan:n,timeSpanStart:s,timeSpanStartMS:a,earliestVisibleDateMS:l,durationMS:o,spansStart:u,recurrence:c,fn:d,extraArgs:h,scope:g=this}=this.processIterationConfig(i),{interval:f,days:m}=c,{weekStartDay:p}=k,v=s.getHours(),b=s.getMinutes(),w=s.getSeconds(),S=s.getMilliseconds();let C=0,{count:T}=c,E=Ds.decode(m),I,R;if(E!=null&&E.length||(E=[[s.getDay()]]),p>0)for(let M=0;M<E.length;M++)p>E[M][0]?E[M][0]=7-p-E[M][0]:E[M][0]-=p;for(E.sort((M,O)=>M[0]-O[0]),I=k.getNext(T||f>1?s:t,"week",0),!r&&!T&&(T=this.MAX_OCCURRENCES_COUNT);!r||I.getTime()<r;){for(let M=0;M<E.length;M++){R=new Date(I.getFullYear(),I.getMonth(),I.getDate()+E[M][0],v,b,w,S);const O=R.getTime();if(O>=a){const A=this.isInViewMS(e,R,O,l,o,n);if(C++,A&&(r&&O>=r||d.apply(g,[R,C,C===1&&u,n,...h])===!1||T&&C>=T))return}}I=k.getNext(I,"week",f)}}};y(Eu,"frequency","WEEKLY"),Eu._$name="WeeklyRecurrenceIterator";var ku=class extends fr{static getNthDayOfMonth(i,e){const t=k.daysInMonth(i);let r=null;return e&&Math.abs(e)<=t&&(r=new Date(i.getFullYear(),i.getMonth(),e<0?t+e+1:e)),r}static isValidPosition(i){return i&&Math.abs(i)>0&&Math.abs(i)<=31}static forEachDate(i){const{startOnly:e,startDate:t,endDate:r,timeSpan:n,timeSpanStart:s,earliestVisibleDate:a,durationMS:l,spansStart:o,recurrence:u,fn:c,extraArgs:d,scope:h=this}=this.processIterationConfig(i),{interval:g,days:f,count:m,positions:p}=u,v=Ds.decode(f),b=p&&p.length,w={};let{monthDays:S}=u,C=0,T,E,I,R,M,O;for(E=k.startOf(m||g>1?s:t,"month"),I=new Date(k.getNext(E,"month",1)-1),!(S&&S.length)&&!(v&&v.length)&&(S=[s.getDate()]),v&&v.length&&v.forEach(A=>{A[1]&&(T=T||{},T[A[0]]=A[1])});(!r||r>E)&&(!m||C<m);){if(R=[],v&&v.length){if(v.forEach(A=>{const B=A[0];let L=1,Y=53;for(A[1]&&(L=Y=A[1]),O=L;O<=Y;O++)(M=this.getNthDayInPeriod(E,I,B,O))&&(M=k.copyTimeValues(M,s),w[M.getTime()]||(w[M.getTime()]=!0,R.push(M)))}),R.sort((A,B)=>A-B),!b){for(O=0;O<R.length;O++)if(M=R[O],M>=s){const A=this.isInView(e,M,a,l,n);if(C++,A&&(r&&M>=r||c.apply(h,[M,C,C===1&&o,n,...d])===!1||m&&C>=m))return!1}}}else{const A=[];for(O=0;O<S.length;O++)(M=this.getNthDayOfMonth(E,S[O]))&&!w[M.getTime()]&&(w[M.getTime()]=!0,A.push(M));for(A.sort((B,L)=>B-L),O=0;O<A.length;O++)if(M=k.copyTimeValues(A[O],s),b)R.push(M);else if(M>=s){const B=this.isInView(e,M,a,l,n);if(C++,B&&(r&&M>r||c.apply(h,[M,C,C===1&&o,n,...d])===!1||m&&C>=m))return}}b&&R.length&&this.forEachDateAtPositions(R,p,A=>{if(A>=s){const B=e?A>=a:A.valueOf()+l>a&&!n.hasException(A);if(C++,B&&(!r||A<=r)&&(c.apply(h,[A,C,C===1&&o,n,...d])===!1||m&&C>=m))return!1}}),E=k.getNext(E,"month",g),I=new Date(k.getNext(E,"month",1)-1)}}};y(ku,"frequency","MONTHLY"),ku._$name="MonthlyRecurrenceIterator";var Iu=class extends fr{static forEachDate(i){const{startOnly:e,startDate:t,endDate:r,timeSpan:n,timeSpanStart:s,earliestVisibleDate:a,durationMS:l,spansStart:o,recurrence:u,fn:c,extraArgs:d,scope:h=this}=this.processIterationConfig(i),{interval:g,days:f,count:m,positions:p}=u,v=Ds.decode(f),b=p&&p.length,w={};let{months:S}=u,C=0,T,E,I,R,M,O;for(R=k.startOf(m||g>1?s:t,"year"),M=new Date(k.getNext(R,"year",1)-1),S&&S.sort((A,B)=>A-B),!(S&&S.length)&&!(v&&v.length)&&(S=[s.getMonth()+1]),v&&v.length&&v.forEach(A=>{A[1]&&(O=O||{},O[A[0]]=A[1])});(!r||r>R)&&(!m||C<m);){if(I=[],v&&v.length){if(v.forEach(A=>{const B=A[0];let L=1,Y=53;for(A[1]&&(L=Y=A[1]),T=L;T<=Y;T++)(E=this.getNthDayInPeriod(R,M,B,T))&&(E=k.copyTimeValues(E,s),w[E.getTime()]||(w[E.getTime()]=!0,I.push(E)))}),I.sort((A,B)=>A-B),!b){for(T=0;T<I.length;T++)if(E=I[T],E>=s){const A=this.isInView(e,E,a,l,n);if(C++,A&&(r&&E>=r||c.apply(h,[E,C,C===1&&o,n,...d])===!1||m&&C>=m))return}}}else for(T=0;T<S.length;T++)if((E=this.buildDate(R.getFullYear(),S[T]-1,s.getDate()))&&(E=k.copyTimeValues(E,s),!w[E.getTime()])){if(w[E.getTime()]=!0,b)I.push(E);else if(E>=s){const A=e?E>=a:E.valueOf()+l>a&&!n.hasException(E);if(C++,A&&(r&&E>=r||c.apply(h,[E,C,C===1&&o,n,...d])===!1||m&&C>=m))return}}b&&I.length&&this.forEachDateAtPositions(I,p,A=>{if(A>=s){const B=e?A>=a:A.valueOf()+l>a&&!n.hasException(A);if(C++,B&&(!r||A<r)&&(c.apply(h,[A,C,C===1&&o,n,...d])===!1||m&&C>=m))return!1}}),R=k.getNext(R,"year",g),M=new Date(k.getNext(R,"year",1)-1)}}};y(Iu,"frequency","YEARLY"),Iu._$name="YearlyRecurrenceIterator";var Rg={};[xu,Eu,ku,Iu].forEach(i=>{Rg[i.frequency]=i});function Mu(i){return i?typeof i=="string"&&(i=i.split(",").map(e=>parseInt(e,10))):i=null,i}function OS(i){return i?typeof i=="string"&&(i=i.split(",")):i=null,i}function Ga(i,e){return String(i)===String(e)}function _g(i){return this.defaultValue&&i===void 0?this.defaultValue:this.allowNull&&i==null?null:(i=parseInt(i),isNaN(i)?void 0:i)}var Ru=class extends Q{static get $name(){return"RecurrenceModel"}get isRecurrenceModel(){return!0}static get fields(){return[{name:"frequency",defaultValue:"DAILY"},{name:"interval",defaultValue:1,convert:_g},{name:"endDate",type:"date"},{name:"count",allowNull:!0,convert:_g},{name:"days",convert:OS,isEqual:Ga},{name:"monthDays",convert:Mu,isEqual:Ga},{name:"months",convert:Mu,isEqual:Ga},{name:"positions",convert:Mu,isEqual:Ga}]}get dateFormat(){return this._dateFormat||"YYYYMMDDTHHmmss"}set dateFormat(i){this._dateFormat=i}get recurrenceIterator(){return Rg[this.frequency]}get timeSpan(){return this._timeSpan}set timeSpan(i){this._timeSpan=i}get rule(){const i=this,e=[];return i.frequency&&(e.push(`FREQ=${i.frequency}`),i.interval>1&&e.push(`INTERVAL=${i.interval}`),i.days&&i.days.length&&e.push("BYDAY="+i.days.join(",")),i.monthDays&&i.monthDays.length&&e.push("BYMONTHDAY="+i.monthDays.join(",")),i.months&&i.months.length&&e.push("BYMONTH="+i.months.join(",")),i.count&&e.push(`COUNT=${i.count}`),i.endDate&&e.push("UNTIL="+k.format(i.endDate,i.dateFormat)),i.positions&&i.positions.length&&e.push("BYSETPOS="+i.positions.join(","))),e.join(";")}set rule(i){const e=this,t={frequency:null,interval:null,count:null,endDate:null,days:null,monthDays:null,months:null,positions:null};if(e.beginBatch(),i){const r=i.split(";");for(let n=0,s=r.length;n<s;n++){const a=r[n].split("="),l=a[1];switch(a[0]){case"FREQ":t.frequency=l;break;case"INTERVAL":t.interval=l;break;case"COUNT":t.count=l,t.until=null;break;case"UNTIL":l?t.endDate=k.parse(l,e.dateFormat):t.endDate=null,t.count=null;break;case"BYDAY":t.days=l;break;case"BYMONTHDAY":t.monthDays=l;break;case"BYMONTH":t.months=l;break;case"BYSETPOS":t.positions=l;break}}}e.set(t),i&&e.sanitize(),e.endBatch()}construct(i={}){const e=this,{rule:t,timeSpan:r}=i;e._suspendedTimeSpanNotifying=0,delete i.timeSpan,delete i.rule,super.construct(...arguments),t&&(e.suspendTimeSpanNotifying(),e.rule=t,e.resumeTimeSpanNotifying()),e.timeSpan=r}forEachOccurrence(i,e,t){this.timeSpan.startDate&&this.recurrenceIterator.forEachDate({recurrence:this,startDate:i,endDate:e,fn(r,n,s,a){return t(a.buildOccurrence(r,s),s,n,r)}})}sanitize(){var i,e;const t=this,r=(i=t.timeSpan)==null?void 0:i.startDate,n={};switch(t.isSanitizing=!0,t.frequency){case"DAILY":n.positions=null,n.days=null,n.monthDays=null,n.months=null;break;case"WEEKLY":{n.positions=null,n.monthDays=null,n.months=null;const{days:s}=t;r&&(s==null?void 0:s.length)===1&&s[0]===Ds.encodeDay(r.getDay())&&(n.days=null);break}case"MONTHLY":{(e=t.monthDays)!=null&&e.length&&(n.positions=null,n.days=null),n.months=null;const{monthDays:s}=t;r&&(s==null?void 0:s.length)===1&&s[0]===r.getDate()&&(n.monthDays=null);break}case"YEARLY":{n.monthDays=null;const{months:s}=t;r&&(s==null?void 0:s.length)===1&&s[0]===r.getMonth()+1&&(n.months=null);break}}t.set(n),t.isSanitizing=!1}copy(...i){const e=super.copy(...i);return e.dateFormat=this.dateFormat,e.timeSpan=this.timeSpan,e}afterChange(i,e,t){const r=super.afterChange(i,e,t),{timeSpan:n}=this;return this.isSanitizing||this.sanitize(),n&&(n.sanitizeRecurrenceData(this),this.isTimeSpanNotifyingSuspended||n.onRecurrenceChanged()),r}set(i,e,...t){const r=typeof i=="object"?i:{[i]:e};r.count?r.endDate=null:r.endDate&&(r.count=null),super.set(r,void 0,...t)}get isTimeSpanNotifyingSuspended(){return!!this._suspendedTimeSpanNotifying}suspendTimeSpanNotifying(){this._suspendedTimeSpanNotifying++}resumeTimeSpanNotifying(){this._suspendedTimeSpanNotifying&&this._suspendedTimeSpanNotifying--}};Ru._$name="RecurrenceModel";function AS(i){const e={},{dateFormat:t}=this;return i&&(i=typeof i=="string"?i.split(","):z.asArray(i),i.forEach(r=>{typeof r=="string"&&(r=k.parse(r,t)),isNaN(r)||(e[k.makeKey(r)]=1)})),e}function PS(i){const e=[],{dateFormat:t}=this;for(const r in i)i[r]&&e.push(k.format(k.parseKey(r),t));return e}var FS=[],Xa=i=>class extends(i||hr){static get $name(){return"RecurringTimeSpan"}get supportsRecurring(){return!0}static get fields(){return[{name:"recurrenceRule",internal:!0},{name:"exceptionDates",convert:AS,serialize:PS,internal:!0}]}remove(){if(this.isOccurrence){const t=this,{recurringTimeSpan:r}=t;t.cancelBatch(),r.beginBatch(),t.detachFromRecurringEvent(),r.endBatch()}else return super.remove(...arguments)}get eventStore(){var t,r;let n=this.isOccurrence&&((t=this.recurringEvent)==null?void 0:t.eventStore)||super.eventStore;return!n&&((r=this.firstStore)!=null&&r.isRecurringTimeSpansMixin)&&(n=this.firstStore),n}get recurrenceModel(){return this._recurrenceModel||Ru}set recurrenceModel(t){this._recurrenceModel=t}setRecurrence(t,r,n){const s=this;let a;t&&(t.isRecurrenceModel||(typeof t=="string"&&(t={frequency:t},r&&(t.interval=r),n&&(n instanceof Date?t.endDate=n:t.count=n)),t=new s.recurrenceModel(t)),t.timeSpan=s,a=t.rule),s.recurrence=t,s.recurrenceRule=a}get recurrence(){const t=this,r=t.recurrenceRule;return!t._recurrence&&r&&(t._recurrence=new t.recurrenceModel({rule:r,timeSpan:t,id:`${t.id}-recurrence`})),t._recurrence}set recurrence(t){const r=this;r._recurrence=t,t?(t.timeSpan=r,r.recurrenceRule=t.rule):r.isOccurrence?r.setData("recurrenceRule",null):r.recurrenceRule=null}get isRecurring(){return!!(!this.isOccurrence&&this.recurrence)}get isOccurrence(){return!!this.recurringTimeSpan}get recurringTimeSpan(){return this._recurringTimeSpan}get isPersistable(){return super.isPersistable&&(!this.supportsRecurring||!this.isOccurrence)}set recurringTimeSpan(t){this._recurringTimeSpan=t}getOccurrencesForDateRange(t,r=t){return this.eventStore.getOccurrencesForTimeSpan(this,t,r)}get occurrences(){if(this.isRecurring){const t=[];return this.occurrenceMap.forEach(r=>{r!==this&&t.push(r)}),t}return FS}get occurrenceMap(){return this._occurrencesMap||(this._occurrencesMap=new Map)}removeOccurrence(t,r=this.eventStore){const n=t.isTimeSpan?t.occurrenceDate:t;r==null||r.globalOccurrences.delete(this.createRecurrenceKey(n)),this.occurrenceMap.delete(k.makeKey(n))}removeOccurrencesFrom(t){this.occurrenceMap.forEach((r,n)=>{k.parseKey(n)>=t&&this.removeOccurrence(r)})}removeOccurrences(t){[this,...this.occurrences].forEach(r=>this.removeOccurrence(r,t))}onRecurrenceChanged(){var t;this.recurrenceRule=((t=this.recurrence)==null?void 0:t.rule)||null}sanitizeRecurrenceData(t=this.recurrence){if(t.endDate){const r=k.clearTime(t.endDate),{exceptionDates:n}=this;if(this.removeOccurrencesFrom(r),n)for(const s in n)k.parseKey(s)>=r&&delete n[s]}}get occurrenceDate(){var t;return((t=this.meta.modified)==null?void 0:t.startDate)||this.startDate}get occurrenceIndex(){return fr.getOccurrenceIndex(this)}buildOccurrence(t,r){var n;const s=this,{occurrenceMap:a,recurrence:l,meta:o}=s,u=(n=s.eventStore)==null?void 0:n.globalOccurrences,c=k.makeKey(t),d=s.createRecurrenceKey(t,c),h=!(t-s.startDate),{fieldMap:g}=s.constructor;let f=u==null?void 0:u.get(d),{duration:m}=s;s.endDate&&(s.allDay||!m)&&(m=k.as(s.durationUnit,s.endDate.getTime()-s.startDate.getTime()));const p=m!==void 0?k.add(t,m,s.durationUnit):void 0;return f||(r||h?(f=s,h||(s.setStartEndDate(t,p,!0),l.suspendTimeSpanNotifying(),l.sanitize(),l.resumeTimeSpanNotifying()),o.isSyncedWithRule=!0):(f=s.copy({[g.id.dataSource]:d,[g.startDate.dataSource]:t,[g.endDate.dataSource]:p,[g.duration.dataSource]:m,constraintDate:null,constraintType:null},{creatingOccurrence:!0}),f.recurringTimeSpan=s),u==null||u.set(d,f),a.set(c,f)),f}createRecurrenceKey(t=this.startDate,r=null){return`_generated:${this.id}:${r||k.makeKey(t)}`}convertToRealEvent(t,r){var n;if(!this.isOccurrence)return;const s=this,{recurringTimeSpan:a,resource:l,occurrenceIndex:o,recurrence:u}=s,c=u&&a.recurrence.count,d=((n=t==null?void 0:t.resourceRecords)==null?void 0:n.value)||s.data.newResource;a.beginBatch(),s.detachFromRecurringEvent(),s.clearChanges(),s.setData("id",s.generateId(a.eventStore)),d&&delete s.data.resourceId,a.eventStore.add(s,r),c&&(s.recurrence.count=c-o),(d||l)&&s.assign(d||l),d&&delete s.data.resourceRecords,t&&delete t.resourceRecords,a.endBatch()}afterChange(t,r,n,...s){const a=this,{eventStore:l}=a;return"recurrenceRule"in r&&(a._recurrence=null,l==null||l.recurringEvents[r.recurrenceRule.value?"add":"delete"](a)),a.isOccurrence?a.convertToRealEvent(r,n):"newExceptionDate"in r&&(a.meta.modified.exceptionDates=!0,delete a.meta.modified.newExceptionDate,a.removeOccurrence(r.newExceptionDate.value)),super.afterChange(t,r,n,...s)}detachFromRecurringEvent(){const t=this,{recurringTimeSpan:r,occurrenceDate:n,startDate:s}=t;t.recurringTimeSpan=null,r.addExceptionDate(n),t.recurrenceRule&&(r.recurrence.endDate=k.add(s,-1,"minute"))}set newExceptionDate(t){if(t){const r=this.exceptionDates||(this.exceptionDates={});r[k.makeKey(t)]=1}}addExceptionDate(t){return this.set({newExceptionDate:t})}hasException(t){var r;return(r=this.exceptionDates)==null?void 0:r[k.makeKey(t)]}},gr=class extends hr.mixin(Xa){get domId(){return`${this.constructor.domIdPrefix}-${this.id}`}get isResourceTimeRange(){return!0}get resources(){return this.resource?[this.resource]:[]}get $linkedResources(){return this.resources}};y(gr,"$name","ResourceTimeRangeModel"),y(gr,"fields",["resourceId","timeRangeColor"]),y(gr,"relations",{resource:{foreignKey:"resourceId",foreignStore:"resourceStore",relatedCollectionName:"timeRanges",nullFieldOnRemove:!0}}),y(gr,"domIdPrefix","resourcetimerange"),gr._$name="ResourceTimeRangeModel";var Og=Object.freeze([]),Za=i=>class extends(i||F){static get $name(){return"RecurringTimeSpansMixin"}construct(...t){const r=this;r.globalOccurrences=new Map,r.recurringEvents=new Set,super.construct(...t)}afterLoadData(){this.globalOccurrences.clear(),this.refreshRecurringEventsCache("clear"),this.refreshRecurringEventsCache("splice",this.storage.allValues),super.afterLoadData&&super.afterLoadData()}onDataChange({action:t,added:r,removed:n,replaced:s}){this.refreshRecurringEventsCache(t,r,n,s),super.onDataChange(...arguments)}refreshRecurringEventsCache(t,r=Og,n=Og,s){const a=this,{recurringEvents:l}=a,o=s==null?void 0:s.length;switch(t){case"clear":l.clear();break;case"splice":{if(o){r=r.slice(),n=n.slice();for(let d=0;d<o;d++)n.push(s[d][0]),r.push(s[d][1])}const u=r.length,c=n.length;if(c&&l.size)for(let d=0;d<c;d++)l.delete(n[d]);if(u)for(let d=0;d<u;d++){const h=r[d];h.isRecurring&&l.add(h)}break}}}getById(t){let r=super.getById(t);return r||(r=this.globalOccurrences.get(this.modelClass.asId(t))),r}onModelChange(t,r,n,s,a){const l=!s&&this.isRecurrenceRelatedFieldChange(t,n);if(l&&t.removeOccurrences(),super.onModelChange(...arguments),l){const o={action:"batch",records:this.storage.values};this.trigger("refresh",o),this.trigger("change",o)}}isRecurrenceRelatedFieldChange(t,r){return t.isRecurring||"recurrenceRule"in r}getOccurrencesForTimeSpan(t,r,n){const s=[];return t.isRecurring&&t.recurrence.forEachOccurrence(r,n,a=>s.push(a)),s}set data(t){this.globalOccurrences.clear(),super.data=t}getRecurringTimeSpans(){return[...this.recurringEvents]}},Ja=class extends Xe.mixin(Za){static get defaultConfig(){return{loadPriority:500,syncPriority:500,resourceStore:null,modelClass:gr,storeId:"resourceTimeRanges"}}set resourceStore(i){this._resourceStore=i,this.isConfiguring||this.initRelations(!0)}get resourceStore(){return this._resourceStore}getResourcesForEvent(i){return[i.resource]}getRanges({resourceRecord:i,startDate:e,endDate:t}){return i.timeRanges.flatMap(n=>n.supportsRecurring?n.getOccurrencesForDateRange(e,t):n.intersectsRange(e,t)?n:[]).sort((n,s)=>n.startDate-s.startDate)}};y(Ja,"$name","ResourceTimeRangeStore"),Ja._$name="ResourceTimeRangeStore";var Ts=class extends Ut{get timeZone(){return this.client.project.timeZone}processRecord(i,e){(e||this.client.isLoadingData||i.timeZone!==void 0)&&this.convertRecordToTimeZone(i)}convertRecordToTimeZone(i,e=this.timeZone){var t,r;if(i.timeZone!==e){if(i.$ignoreChange=!0,(t=i.baselines)!=null&&t.count)for(const n of i.baselines)i.timeZone!==n.timeZone&&(n.timeZone=i.timeZone),n.convertToTimeZone(e);if((r=i.occurrences)!=null&&r.length)for(const n of i.occurrences)i.timeZone!==n.timeZone&&(n.timeZone=i.timeZone),n.convertToTimeZone(e);i.convertToTimeZone(e),i.$ignoreChange=!1}}beforeSyncRecord({record:i}){i.timeZone!=null&&(i.$restoreTimeZone=i.timeZone,i.convertToTimeZone())}afterSyncRecord({record:i}){i.$restoreTimeZone&&(i.convertToTimeZone(i.$restoreTimeZone),i.$restoreTimeZone=null)}};y(Ts,"$name","storeTimeZonePlugin"),y(Ts,"pluginConfig",{before:["processRecord"],assign:["beforeSyncRecord","afterSyncRecord"]}),Ts._$name="StoreTimeZonePlugin";var Ag=i=>{var e;return e=class extends(i||Q){get _storesWithDates(){return[this.taskStore,this.timeRangeStore,this.resourceTimeRangeStore].filter(t=>t)}plugStore(t){t.hasPlugin(Ts)||t.addPlugins(Ts)}unplugStore(t){var r;(r=t.plugins.storeTimeZonePlugin)==null||r.destroy()}attachStore(t){super.attachStore(t),t&&this.timeZone!=null&&this._storesWithDates.includes(t)&&(this.plugStore(t),this.convertStoresToTimeZone([t]))}detachStore(t){super.detachStore(t),t&&!t.isDestroyed&&this.timeZone!=null&&(this.convertStoresToTimeZone([t],null),this.unplugStore(t))}relayStoreChange({source:t,action:r,records:n,replaced:s}){const a=this;a.timeZone!=null&&a._storesWithDates.includes(t)&&["add","replace"].includes(r)&&(!(n!=null&&n.length)&&(s!=null&&s.length)&&(n=s),n.length&&n.forEach(l=>l.timeZone=a.timeZone))}convertStoresToTimeZone(t,r=this.timeZone){var n;const s=this,a=(n=s.stm)==null?void 0:n.autoRecord;a&&(s.stm.autoRecord=!1);for(const l of t)l==null||l.forEach(o=>l.plugins.storeTimeZonePlugin.convertRecordToTimeZone(o,r));a&&(s.stmAutoRecord=a)}updateTimeZone(t,r){const n=this,s=n._isConfiguringTimeZone||n.isConfiguring;if(n.trigger("beforeTimeZoneChange",{timeZone:t,oldTimeZone:r,isConfiguring:s}),n.calendarManagerStore.forEach(a=>a.bumpVersion()),n._storesWithDates.forEach(a=>n.plugStore(a)),n.convertStoresToTimeZone(n._storesWithDates),n.startDate){const a=r!=null?Ve.fromTimeZone(n.startDate,r):n.startDate;n.startDate=t!=null?Ve.toTimeZone(a,t):a}n.ignoreRecordChanges=!0,n.commitAsync().then(()=>{n.isDestroyed||n.trigger("timeZoneChange",{timeZone:t,oldTimeZone:r,isConfiguring:s}),delete n._isConfiguringTimeZone})}},y(e,"$name","ProjectModelTimeZoneMixin"),y(e,"configurable",{timeZone:{$config:"lazy",value:null}}),e},xs=class extends hr.mixin(Xa){afterConstruct(){this.endDate||(this.endDate=this.startDate),super.afterConstruct()}};y(xs,"$name","TimeRangeModel"),xs._$name="TimeRangeModel";var Es=class extends Xe.mixin(Za){};y(Es,"$name","TimeRangeStore"),y(Es,"defaultConfig",{loadPriority:500,syncPriority:500,modelClass:xs,storeId:"timeRanges"}),Es._$name="TimeRangeStore";var Pg=i=>{var e;return e=class extends(i||Q).mixin(kg,Ag){static get $name(){return"ProjectModelMixin"}static get defaultConfig(){return{stm:{},timeRangeModelClass:xs,resourceTimeRangeModelClass:gr,timeRangeStoreClass:Es,resourceTimeRangeStoreClass:Ja,eventStore:{},assignmentStore:{},dependencyStore:{},resourceStore:{},timeRangesData:null,resourceTimeRangesData:null}}get inlineData(){return P.safeJsonParse(super.json)}set inlineData(t){this.json=t}construct(t={}){super.construct(...arguments),t.timeRangesData&&(this.timeRangeStore.data=t.timeRangesData),t.resourceTimeRangesData&&(this.resourceTimeRangeStore.data=t.resourceTimeRangesData)}afterConstruct(){super.afterConstruct();const t=this;!t.timeRangeStore.stm&&t.stm.addStore(t.timeRangeStore),!t.resourceTimeRangeStore.stm&&t.stm.addStore(t.resourceTimeRangeStore)}attachStore(t){t&&t.ion({name:t.$$name,change:"relayStoreChange",thisObj:this}),super.attachStore(t)}detachStore(t){t&&(this.detachListeners(t.$$name),super.detachStore(t))}relayStoreChange(t){return super.relayStoreChange(t),this.trigger("change",{store:t.source,...t,source:this})}updateTimeRangeStore(t,r){this.detachStore(r),this.attachStore(t),r&&(r.project=null),t&&(t.project=this)}setTimeRangeStore(t){this.timeRangeStore=t}changeTimeRangeStore(t){return t&&!t.isStore&&(t=this.timeRangeStoreClass.new({modelClass:this.timeRangeModelClass},t)),t}updateResourceTimeRangeStore(t,r){this.detachStore(r),this.attachStore(t),r&&(r.project=null),t&&(t.project=this)}changeResourceTimeRangeStore(t){return t&&!t.isStore&&(t=this.resourceTimeRangeStoreClass.new({modelClass:this.resourceTimeRangeModelClass},t)),t}setResourceTimeRangeStore(t){this.resourceTimeRangeStore=t}get events(){return this.eventStore.allRecords}updateEvents(t){this.eventStore.data=t}get resourceTimeRanges(){return this.resourceTimeRangeStore.allRecords}updateResourceTimeRanges(t){this.resourceTimeRangeStore.data=t}async loadInlineData(t){return this.isLoadingInlineData=!0,t.resourceTimeRangesData&&(this.resourceTimeRangeStore.data=t.resourceTimeRangesData),t.timeRangesData&&(this.timeRangeStore.data=t.timeRangesData),super.loadInlineData(t)}toJSON(){const t=this,r={eventsData:t.eventStore.toJSON(),resourcesData:t.resourceStore.toJSON(),dependenciesData:t.dependencyStore.toJSON(),timeRangesData:t.timeRangeStore.toJSON(),resourceTimeRangesData:t.resourceTimeRangeStore.toJSON()};return t.eventStore.usesSingleAssignment||(r.assignmentsData=t.assignmentStore.toJSON()),r}get json(){return super.json}changeJson(t){return typeof t=="string"&&(t=P.safeJsonParse(t)),t}updateJson(t){t&&this.loadInlineData(t)}afterChange(t,r){super.afterChange(...arguments),r.calendar&&this.trigger("calendarChange")}doDestroy(){this.timeRangeStore.destroy(),this.resourceTimeRangeStore.destroy(),super.doDestroy()}},y(e,"configurable",{json:null,timeRangeStore:{value:{},$config:"nullify"},resourceTimeRangeStore:{value:{},$config:"nullify"},events:null,resourceTimeRanges:null}),e},LS=i=>class extends i{getCurrentConfig(t){const r=this,n=super.getCurrentConfig(t);if(n){for(const s of["eventStore","resourceStore","assignmentStore","dependencyStore","timeRangeStore","resourceTimeRangeStore"]){const a=r[s];if(a){a.count&&(n[a.id+"Data"]=a.getInlineData(t));const l=a.getCurrentConfig(t);l&&Object.keys(l).length>0?n[s]=Object.assign(n[s]||{},l):n[s]&&Object.keys(n[s]).length===0&&delete n[s]}}return r.taskStore.isTaskStore&&(delete n.eventModelClass,delete n.eventStoreClass,delete n.children),n}}},Fg=class extends F{set eventStore(i){const e=this;e.eventStoreDetacher&&e.eventStoreDetacher(),e._eventStore=i,i&&i.autoCommit&&(e.eventStoreDetacher=i.ion({beforecommit:e.onEventStoreBeforeSync,thisObj:e,detachable:!0,prio:100}))}get eventStore(){return this._eventStore}set resourceStore(i){const e=this;e.resourceStoreDetacher&&e.resourceStoreDetacher(),e._resourceStore=i,i&&i.autoCommit&&(e.resourceStoreDetacher=i.ion({beforecommit:e.onResourceStoreBeforeSync,thisObj:e,detachable:!0,prio:100}))}get resourceStore(){return this._resourceStore}set assignmentStore(i){const e=this;e.assignmentStoreDetacher&&e.assignmentStoreDetacher(),e._assignmentStore=i,i&&i.autoSync&&(e.assignmentStoreDetacher=i.ion({beforecommit:e.onAssignmentStoreBeforeSync,thisObj:e,detachable:!0,prio:100}))}get assignmentStore(){return this._assignmentStore}set dependencyStore(i){const e=this;e.dependencyStoreDetacher&&e.dependencyStoreDetacher(),e._dependencyStore=i,i&&i.autoSync&&(e.dependencyStoreDetacher=i.ion({beforecommit:e.onDependencyStoreBeforeSync,thisObj:e,detachable:!0,prio:100}))}get dependencyStore(){return this._dependencyStore}onEventStoreBeforeSync({changes:i}){const e=this;return e.removeNonPersistableRecordsToCreate(i),e.shallContinueSync(i)}onResourceStoreBeforeSync({changes:i}){const e=this;return e.removeNonPersistableRecordsToCreate(i),e.shallContinueSync(i)}onAssignmentStoreBeforeSync({changes:i}){const e=this;return e.removeNonPersistableRecordsToCreate(i),e.shallContinueSync(i)}onDependencyStoreBeforeSync({changes:i}){const e=this;return e.removeNonPersistableRecordsToCreate(i),e.shallContinueSync(i)}removeNonPersistableRecordsToCreate(i){const e=i.added||[];let t,r;for(r=e.length-1;r>=0;--r)t=e[r],t.isPersistable||e.splice(e.indexOf(t),1);e.length===0&&(i.added.length=0)}shallContinueSync(i){return!!(i.added&&i.added.length>0||i.modified&&i.modified.length>0||i.removed&&i.removed.length>0)}};Fg._$name="ModelPersistencyManager";var $S=1e3*60*60*24,Lg=i=>class extends i{static get $name(){return"EventModelMixin"}static get isEventModel(){return!0}static get fields(){return[{name:"resourceId",internal:!0},{name:"resourceIds",type:"array",persist:!1,internal:!0},{name:"resources",column:{type:"resourceassignment"},persist:!1,internal:!0,useProp:!0},{name:"draggable",type:"boolean",persist:!1,defaultValue:!0,internal:!0},{name:"resizable",persist:!1,defaultValue:!0,internal:!0},{name:"allDay",type:"boolean",defaultValue:!1},{name:"eventStyle",internal:!0},{name:"eventColor",internal:!0},{name:"milestoneWidth",internal:!0},{name:"stickyContents",internal:!0}]}updateAssignmentEventIds(){this.assigned.forEach(t=>{t.eventId=this.id})}syncId(t){super.syncId(t),this.updateAssignmentEventIds()}setValue(t,r){var n;if(t==="resource"&&!this.usesSingleAssignment)this.resources=(n=z.asArray(r))!=null?n:[];else return super.setValue(t,r)}get resources(){return this.assignments.reduce((t,{resource:r})=>(r&&t.push(r.$original),t),[])}set resources(t){var r;t=z.asArray(t);const n=this,s=t.map(n.constructor.asId);if(n.usesSingleAssignment)n.set("resourceId",s[0]);else if((r=n.fieldMap)!=null&&r.resourceIds.persist)n.resourceIds=s;else{const a=n.assignments.map(u=>u.resource.id),{onlyInA:l,onlyInB:o}=z.delta(s,a);n.assignmentStore.add(l.map(u=>({resource:u,event:n}))),n.assignmentStore.remove(o.map(u=>n.assignments.find(c=>c.resource.id===u)))}}forEachResource(t,r=this){for(const n of this.resources)if(t.call(r,n)===!1)return}getResource(t){return t==null?this.resource:this.resourceStore?this.resourceStore.getById(t):null}get startDate(){var t;let r;return this.isOccurrence?r=this.get("startDate"):r=(t=this._startDate)!=null?t:super.startDate,this.allDay&&(r=this.constructor.getAllDayStartDate(r)),r}set startDate(t){this.batching?(this._startDate=t,this.set({startDate:t})):super.startDate=t}get endDate(){var t;let r;return this.isOccurrence?r=this.get("endDate"):r=(t=this._endDate)!=null?t:super.endDate,this.allDay&&(r=this.constructor.getAllDayEndDate(r)),r}set endDate(t){this.batching?(this._endDate=t,this.set({endDate:t})):super.endDate=t}get wrapStartDate(){return this.startDate}set wrapStartDate(t){}get wrapEndDate(){return this.endDate}set wrapEndDate(t){}get isEvent(){return!0}get isDraggable(){return!this.readOnly&&this.draggable}get isResizable(){return!this.isMilestone&&(!this.isParent||this.manuallyScheduled)&&this.resizable}get isPersistable(){return super.isPersistable&&!this.isCreating}endBatch(t,r,n){const s=this,a=s.isPersistable;if(super.endBatch(t,r,n),s.isPersistable&&!a&&!s.ignoreBag&&s.assigned)for(const l of s.assigned)l.stores.forEach(o=>o.updateModifiedBagForRecord(l))}get isCreating(){return super.isCreating}set isCreating(t){var r,n;super.isCreating=t,(r=this.assignmentStore)==null||r.suspendAutoCommit(),this.assignments.forEach(s=>s.isCreating=t),(n=this.assignmentStore)==null||n.resumeAutoCommit()}get usesSingleAssignment(){return!this.eventStore||this.eventStore.usesSingleAssignment}copy(...t){const r=super.copy(...t);return this.usesSingleAssignment||(r.resourceId=null),r}get persistableData(){const t=super.persistableData;return this.usesSingleAssignment||delete t.resourceId,t}get resource(){const{resources:t}=this;return t.length?t[0]:null}set resource(t){this.resourceId=this.constructor.asId(t)}get resourceId(){var t;return this.usesSingleAssignment?this.get("resourceId"):(t=this.assignments[0])==null?void 0:t.resourceId}set resourceId(t){this.applyResourceId(t)}get resourceIds(){var t,r,n;return(t=this.fieldMap)!=null&&t.resourceIds.persist?this.get("resourceIds"):(n=(r=this.resources)==null?void 0:r.map(s=>s.id))!=null?n:[]}set resourceIds(t){this.set("resourceIds",t)}get $linkedResources(){var t,r;return(r=(t=this.resources)==null?void 0:t.flatMap(n=>[n,...n.$links]))!=null?r:[]}applyResourceId(t,r=!1){var n,s;const a=this,{eventStore:l,assignments:o}=a;if(l){const u=l.assignmentStore||((n=l.crudManager)==null?void 0:n.assignmentStore);if(t!=null)if(a.meta.skipEnforcingSingleAssignment||(l.usesSingleAssignment=!0),o!=null&&o.length&&t!==o[0].resourceId){const c=!!l.eventsSuspended;c&&u.suspendEvents(),o[0].resource=t,c&&u.resumeEvents()}else u.assignEventToResource(a,t);else(a.usesSingleAssignment||(s=a.resourceIds)!=null&&s.length)&&u.remove(o)}else r||a.set({resourceId:t})}applyResourceIds(t,r=!1){var n;const s=this,{eventStore:a,assignments:l}=s;if(s.fieldMap.resourceIds.persist===!1)return!1;if(t=[...new Set(t)],a){const o=a.assignmentStore||((n=a.crudManager)==null?void 0:n.assignmentStore);if(t!=null&&t.length)if(l!=null&&l.length){const u=!!a.eventsSuspended;u&&o.suspendEvents(),l.forEach(h=>{const g=t.find(f=>!l.some(m=>m.resourceId===f));g&&(h.resource=g)});const{onlyInA:c,onlyInB:d}=z.delta(t,l.map(h=>h.resourceId));o.add(c.map(h=>({resource:h,event:s}))),o.remove(d.map(h=>l.find(g=>g.resource.id===h))),u&&o.resumeEvents()}else o.add(t.map(u=>({resource:u,event:s})));else o.remove(l)}else r||s.set({resourceIds:t})}applyValue(t,r,n,s,a){if(a&&!this.meta.isAssigning){const{eventStore:l}=this;switch(a.name){case"resourceId":l&&(l.isAssigning=!0),this.applyResourceId(n,!0);break;case"resourceIds":l&&(l.isAssigning=!0),this.applyResourceIds(n,!0);break}l&&(l.isAssigning=!1)}super.applyValue(t,r,n,s,a)}get assignments(){return[...this.assigned||[]]}assign(t,r=!1){const{eventStore:n}=this;n&&!n.usesSingleAssignment?n.assignEventToResource(this,t,r):(this.resourceId=this.constructor.asId(t),n||(this.meta.skipEnforcingSingleAssignment=!0))}unassign(t,r=!1){var n;const s=this;t=s.constructor.asId(t),s.meta.removingResource=r,(n=s.eventStore)==null||n.unassignEventFromResource(s,t),s.meta.removingResource=null}reassign(t,r){this.eventStore&&this.eventStore.reassignEventFromResourceToResource(this,t,r)}isAssignedTo(t){const r=this.constructor.asId(t);return this.assignments.some(n=>n.resourceId===r)}get predecessors(){var t;return[...(t=this.incomingDeps)!=null?t:[]]}get successors(){var t;return[...(t=this.outgoingDeps)!=null?t:[]]}get dependencies(){var t,r;return[...(t=this.incomingDeps)!=null?t:[],...(r=this.outgoingDeps)!=null?r:[]]}normalize(){}inSetNormalize(){}get recurringEvent(){return this.recurringTimeSpan}get isInterDay(){const{durationMS:t}=this;if(t>=$S||!t&&this.allDay)return!0;const{endDate:r,startDate:n}=this,s=k.clearTime(n);if(n&&r)return s.setDate(s.getDate()+1),(r||k.add(n,t))>s}static getAllDayStartDate(t){return t&&t.isEvent&&(t=t.get("startDate")),t&&(t=k.clearTime(t,!0)),t}static getAllDayEndDate(t){return t&&t.isEvent&&(t=t.get("endDate")),t&&(t.getHours()>0||t.getMinutes()>0||t.getSeconds()>0||t.getMilliseconds()>0)&&(t=k.getNext(t,"d",1)),t}static getAllDayDisplayStartDate(t){return t&&t.isEvent&&(t=t.get("startDate")),k.clearTime(t,!0)}static getAllDayDisplayEndDate(t,r){return t&&t.isEvent&&(r=t.get("endDate"),t=t.get("startDate")),r&&(t=this.constructor.getAllDayDisplayStartDate(t),k.clearTime(r,!0).valueOf()===r.valueOf()?r=k.add(r,k.DAY,-1):t.valueOf()!==r.valueOf()&&(r=k.clearTime(r,!0))),r}isEditable(t){switch(t){case"endDate":case"duration":case"fullDuration":return this.isLeaf}return super.isEditable(t)}},Ot=i=>class extends(i||F){static get $name(){return"PartOfProject"}},NS=Ka,Ui=class extends NS.derive(hr).mixin(Xa,Ot,Lg){static get $name(){return"EventModel"}};Ui.exposeProperties(),Ui._$name="EventModel";var BS=["SS","SF","FS","FF"],ks=class qu extends Q{static get $name(){return"DependencyBaseModel"}static get Type(){return{StartToStart:0,StartToEnd:1,EndToStart:2,EndToEnd:3}}static get fields(){return[{name:"from"},{name:"to"},{name:"type",type:"int",defaultValue:2},{name:"cls",defaultValue:""},{name:"bidirectional",type:"boolean"},{name:"fromSide",type:"string"},{name:"toSide",type:"string"},{name:"lag",type:"number",allowNull:!0,defaultValue:0},{name:"lagUnit",type:"string",defaultValue:"d"},{name:"highlighted",persist:!1,internal:!0}]}construct(e){const t=e[this.fieldMap.from.dataSource],r=e[this.fieldMap.to.dataSource];t!=null&&(e.fromEvent=t),r!=null&&(e.toEvent=r),super.construct(...arguments)}get eventStore(){var e;return this.eventStore||((e=this.unjoinedStores[0])==null?void 0:e.eventStore)}set from(e){const{fromEvent:t}=this;t!=null&&t.isModel&&t.id===e?this.set("from",e):this.fromEvent=e}get from(){return this.get("from")}set to(e){const{toEvent:t}=this;t!=null&&t.isModel&&t.id===e?this.set("to",e):this.toEvent=e}get to(){return this.get("to")}get hardType(){return this.getHardType()}set hardType(e){this.setHardType(e)}getHardType(){return this.get("type")}setHardType(e){let t;return e!==this.hardType&&(t=this.set({type:e,fromSide:null,toSide:null})),t}get lag(){return this.get("lag")}set lag(e){this.setLag(e)}setLag(e,t=this.lagUnit){if(arguments.length===1){typeof e=="number"?this.lag=e:(e=k.parseDuration(e),this.set({lag:e.magnitude,lagUnit:e.unit}));return}e=parseFloat(e),this.set({lag:e,lagUnit:t})}getLag(){return this.lag?`${this.lag<0?"-":"+"}${Math.abs(this.lag)}${k.getShortNameOfUnit(this.lagUnit)}`:""}get fullLag(){return new Re({unit:this.lagUnit,magnitude:this.lag})}set fullLag(e){typeof e=="string"?this.setLag(e):this.setLag(e.magnitude,e.unit)}get isPersistable(){const e=this,{stores:t,unjoinedStores:r}=e,n=t[0];let s;if(n){const{fromEvent:a,toEvent:l}=e,o=n.crudManager;s=a&&(o||!a.hasGeneratedId)&&l&&(o||!l.hasGeneratedId)}else s=!!r[0];return s&&super.isPersistable}getDateRange(){const{fromEvent:e,toEvent:t}=this;if(e!=null&&e.isScheduled&&(t!=null&&t.isScheduled)){const r=qu.Type;let n,s;switch(this.type){case r.StartToStart:n=e.startDateMS,s=t.startDateMS;break;case r.StartToEnd:n=e.startDateMS,s=t.endDateMS;break;case r.EndToEnd:n=e.endDateMS,s=t.endDateMS;break;case r.EndToStart:n=e.endDateMS,s=t.startDateMS;break;default:throw new Error("Invalid dependency type: "+this.type)}return{start:Math.min(n,s),end:Math.max(n,s)}}return null}highlight(e){var t,r;const n=(r=(t=this.highlighted)==null?void 0:t.split(" "))!=null?r:[];n.includes(e)||(this.highlighted=n.concat(e).join(" "))}unhighlight(e){const{highlighted:t}=this;if(t){const r=t.split(" "),n=r.indexOf(e);n>=0&&(r.splice(n,1),this.highlighted=r.join(" "))}}isHighlightedWith(e){return this.highlighted&&this.highlighted.split(" ").includes(e)}getConnectorString(e){const t=BS[this.type];return e?t:this.type===qu.Type.EndToStart?"":t}toString(){return`${this.from}${this.getConnectorString()}${this.getLag()}`}get isValid(){const{fromEvent:e,toEvent:t,type:r}=this;return typeof r=="number"&&e&&t&&e!==t}get fromEventName(){var e;return((e=this.fromEvent)==null?void 0:e.name)||""}get toEventName(){var e;return((e=this.toEvent)==null?void 0:e.name)||""}shouldRecordFieldChange(e,t,r){var n;if(!super.shouldRecordFieldChange(e,t,r))return!1;if(e==="from"||e==="to"||e==="fromEvent"||e==="toEvent"){const s=(n=this.project)==null?void 0:n.eventStore;if(s&&s.oldIdMap[t]===s.getById(r))return!1}return!0}};ks.exposeProperties(),ks._$name="DependencyBaseModel";var VS=qa,Is=class extends Ot(VS.derive(ks)){static get $name(){return"DependencyModel"}getTypeFromSides(i,e,t){const r=ks.Type,n=t?"right":"left",s=t?"left":"right";return i===n?e===n?r.StartToStart:r.StartToEnd:e===s?r.EndToEnd:r.EndToStart}};Is.exposeProperties(),Is._$name="DependencyModel";var Qa=class extends Q{static get fields(){return[{name:"iconCls",internal:!0},{name:"cls",internal:!0},{name:"rowHeight",internal:!0},{name:"href",internal:!0},{name:"target",internal:!0}]}};Qa.exposeProperties(),Qa._$name="GridRowModel";var $g=i=>class extends i{static get $name(){return"ResourceModelMixin"}static get isResourceModel(){return!0}static get fields(){return[{name:"name",type:"string",persist:!0},"eventColor","eventStyle","imageUrl","image","resourceMargin",{name:"barMargin",type:"number"},"eventLayout"]}updateAssignmentResourceIds(){this.assigned.forEach(t=>{t.resourceId=this.id})}syncId(t){super.syncId(t),this.updateAssignmentResourceIds()}get events(){return this.assignments.reduce((t,r)=>(r.event&&t.push(r.event),t),[])}get assignments(){return this.assigned?[...this.assigned]:[]}set assignments(t){this.assignmentStore.remove(this.assignments),t.forEach(r=>{r.resource=this})}getEvents(){return ie.deprecate("scheduler","6.0.0","getEvents() is deprecated, use the events property instead"),this.events}get isPersistable(){return super.isPersistable&&(!this.parent||this.parent.isPersistable)}unassignAll(){this.assignments&&this.assignmentStore.remove(this.assignments)}get initials(){const{name:t=""}=this;if(!t)return"";const r=t.split(" "),n=r[0][0],s=r.length>1?r[r.length-1][0]:"";return n+s}isWorkingTime(t){var r,n;const s=this.effectiveCalendar||((r=this.project)==null?void 0:r.calendar);return!s||((n=s.isWorkingTime)==null?void 0:n.call(s,t))}},jS=Ni,qi=class extends $g(Ot(jS.derive(Qa))){};y(qi,"$name","ResourceModel"),qi.exposeProperties(),qi._$name="ResourceModel";var Ng=i=>class extends i{static get $name(){return"AssignmentModelMixin"}static get fields(){return["resourceId","eventId",{name:"drawDependencies",type:"boolean"},"event","resource"]}construct(t,...r){t=t||{};const{fieldMap:n}=this,s=n.eventId.dataSource,a=n.resourceId.dataSource,l=n.event.dataSource,o=n.resource.dataSource,u=t[s],c=t[a],d=t[l],h=t[o];u!=null?t[l]=u:d!=null&&(t[s]=d.isModel?d.id:d),c!=null?t[o]=c:h!=null&&(t[a]=h.isModel?h.id:h),super.construct(t,...r)}get eventResourceKey(){return this.buildEventResourceKey(this.event,this.resource)}buildEventResourceKey(t,r){let n,s;return t?n=t.isModel?t.id:t:n=this.internalId,r?s=r.isModel?r.id:r:s=this.internalId,`${n}-${s}`}buildIndexKey({event:t,resource:r}){return this.buildEventResourceKey(t,r)}set(t,r,...n){var s,a;const l=this.fieldToKeys(t,r);return"resource"in l?((s=l.resource)==null?void 0:s.id)!==void 0&&(l.resourceId=l.resource.id):"resourceId"in l&&this.constructor.isProAssignmentModel&&(l.resource=l.resourceId),"event"in l?((a=l.event)==null?void 0:a.id)!==void 0&&(l.eventId=l.event.id):"eventId"in l&&this.constructor.isProAssignmentModel&&(l.event=l.eventId),super.set(l,null,...n)}afterChange(t,r,n,s,a){var l,o;const u=this;return!u.constructor.isProAssignmentModel&&(r!=null&&r.resourceId)&&((l=u.resource)==null?void 0:l.id)!==r.resourceId.value?u.resource=r.resourceId.value:u.constructor.isProAssignmentModel&&((o=u.project)!=null&&o.propagatingSyncChanges)&&(r!=null&&r.eventId)&&!(r!=null&&r.event)&&(t.event.value===r.eventId.value||t.event.value.id===r.eventId.value)&&(delete r.eventId,delete u.meta.modified.eventId),super.afterChange(...arguments)}set resourceId(t){const{resource:r}=this;r!=null&&r.isModel&&r.id===t?this.set("resourceId",t):this.resource=t}get resourceId(){var t,r;return(r=(t=this.resource)==null?void 0:t.id)!=null?r:this.get("resourceId")}set eventId(t){const{event:r}=this;r!=null&&r.isModel&&r.id===t?this.set("eventId",t):this.event=t}get eventId(){var t,r;return(r=(t=this.event)==null?void 0:t.id)!=null?r:this.get("eventId")}get eventName(){var t;return(t=this.event)==null?void 0:t.name}get resourceName(){var t;return(t=this.resource)==null?void 0:t.name}getResource(){return this.resource}get isAssignment(){return!0}get isPersistable(){var t;const{event:r,resource:n,unjoinedStores:s,assignmentStore:a}=this,l=a==null?void 0:a.crudManager;let o;return a?o=this.isValid&&r.isPersistable&&(l||!r.hasGeneratedId&&!n.hasGeneratedId):o=!this.isPhantom&&!!s[0],o&&super.isPersistable&&!((t=this.event)!=null&&t.isCreating)}get isValid(){return this.resource!=null&&this.event!=null}toString(){return this.resourceName?`${this.resourceName} ${Math.round(this.units)}%`:""}shouldRecordFieldChange(t,r,n){var s,a;if(!super.shouldRecordFieldChange(t,r,n))return!1;if(t==="event"||t==="eventId"){const l=(s=this.project)==null?void 0:s.eventStore;if(l&&l.oldIdMap[r]===l.getById(n))return!1}if(t==="resource"||t==="resourceId"){const l=(a=this.project)==null?void 0:a.resourceStore;if(l&&l.oldIdMap[r]===l.getById(n))return!1}return!0}},zS=Ua,Ms=class extends Ng(Ot(zS.derive(Q))){static get $name(){return"AssignmentModel"}};Ms.exposeProperties(),Ms._$name="AssignmentModel";var Bg=i=>{var e;return e=class extends(i||F){static get defaultConfig(){return{loadPriority:100,syncPriority:200,storeId:"events",removeUnassignedEvent:!0,singleAssignment:null}}construct(t){if(super.construct(t),this.autoTree=!0,this.singleAssignment&&(this.usesSingleAssignment=!0),!this.modelClass.isEventModel)throw new Error("The model for the EventStore must subclass EventModel")}set filtersFunction(t){super.filtersFunction=t}get filtersFunction(){const t=super.filtersFunction;return t&&t!==ue.returnTrue?r=>r.isCreating||t(r):t}getEventCounts(t){const r=this,{filtersFunction:n,added:s}=r,a=r.getEvents({...t,storeFilterFn:r.isFiltered?r.reapplyFilterOnAdd?n:l=>s.includes(l)?r.indexOf(l)>-1:n(l):null,dateMap:t.dateMap||!0});return a.forEach((l,o)=>a.set(o,l.length)),a}forEachScheduledEvent(t,r=this){this.forEach(n=>{const{startDate:s,endDate:a}=n;if(s&&a)return t.call(r,n,s,a)})}getTotalTimeSpan(){let t=new Date(9999,0,1),r=new Date(0);return this.forEach(n=>{n.startDate&&(t=k.min(n.startDate,t)),n.endDate&&(r=k.max(n.endDate,r))}),t=t<new Date(9999,0,1)?t:null,r=r>new Date(0)?r:null,this.lastTotalTimeSpan={startDate:t||null,endDate:r||t||null}}isEventPersistable(t){return t.isPersistable}isDateRangeAvailable(t,r,n,s){if(s.data.generatedParent)return!1;const a=new Set(this.getEventsForResource(s));if(n!=null&&n.isAssignment&&n.event.resources.forEach(c=>{c.id!==n.resourceId&&this.getEventsForResource(c).forEach(d=>a.add(d))}),n){const o=n.isAssignment?n.event:n;a.delete(o)}const l=Array.from(a);return t.getTime()===r.getTime()?!l.some(o=>o.isScheduled&&(o.duration===0?o.startDate.getTime()===t.getTime():k.intersectSpans(t,r,o.startDate,o.endDate))):!l.some(o=>o.isScheduled&&k.intersectSpans(t,r,o.startDate,o.endDate))}filterEventsForResource(t,r,n=this){return t.getEvents(this).filter(r.bind(n))}getResourcesForEvent(t){return t.isOccurrence&&(t=t.recurringTimeSpan),this.assignmentStore.getResourcesForEvent(t)}getEventsForResource(t){return this.assignmentStore.getEventsForResource(t)}getAssignmentsForEvent(t){return this.assignmentStore.getAssignmentsForEvent(t)||[]}getAssignmentsForResource(t){return this.assignmentStore.getAssignmentsForResource(t)||[]}assignEventToResource(t,r,n=!1){return this.assignmentStore.assignEventToResource(t,r,void 0,n)}unassignEventFromResource(t,r){this.assignmentStore.unassignEventFromResource(t,r)}reassignEventFromResourceToResource(t,r,n){const s=this,a=Q.asId(n),l=s.assignmentStore.getAssignmentForEventAndResource(t,r);l?l.resourceId=a:s.assignmentStore.assignEventToResource(t,n)}isEventAssignedToResource(t,r){return this.assignmentStore.isEventAssignedToResource(t,r)}removeAssignmentsForEvent(t){this.assignmentStore.removeAssignmentsForEvent(t)}removeAssignmentsForResource(t){this.assignmentStore.removeAssignmentsForResource(t)}append(t){return this.add(t)}get project(){return super.project}set project(t){var r;super.project=t,this.detachListeners("project"),t&&((r=t.assignmentStore)!=null&&r.isAssignmentStore&&this.attachToAssignmentStore(t.assignmentStore),t.ion({name:"project",assignmentStoreChange:"onProjectAssignmentStoreChange",thisObj:this,prio:200}))}get usesResourceIds(){var t,r;return(r=(t=this.modelClass.fieldMap)==null?void 0:t.resourceIds.persist)!=null?r:!1}get usesSingleAssignment(){return this.isChained?this.masterStore.usesSingleAssignment:this._usesSingleAssignment}set usesSingleAssignment(t){this._usesSingleAssignment=t;const{assignmentStore:r}=this;r!=null&&r.isStore&&!r.hasGenerateIdOverride&&(r.modelClass.generateId=function(){return this.singleAssignmentIdCounter==null&&(this.singleAssignmentIdCounter=0),`a-${++this.singleAssignmentIdCounter}`},r.hasGenerateIdOverride=!0)}processRecords(t){var r;const{assignmentStore:n}=this,s=[];return n&&(n.skipInvalidateIndices=!0),t=super.processRecords(t,n&&!((r=this.stm)!=null&&r.isRestoring)&&(a=>{const l=a.get("resourceId");!a.reassignedFromReplace&&l!=null&&(n.includesAssignment(a.id,l)||s.push({id:n.modelClass.generateId(""),resourceId:l,eventId:a.id})),a.reassignedFromReplace=!1})||void 0),n&&(n.storage.invalidateIndices(),n.skipInvalidateIndices=!1,n.add(s)),t}joinRecordsToStore(t){const{assignmentStore:r}=this;r?(r.skipInvalidateIndices=!0,super.joinRecordsToStore(t),r.storage.invalidateIndices(),r.skipInvalidateIndices=!1):super.joinRecordsToStore(t)}processRecord(t,r=!1){var n,s;t=super.processRecord(t,r);const a=this,l=(s=a.assignmentStore)!=null?s:(n=a.crudManager)==null?void 0:n.assignmentStore,o=t.get("resourceId"),{resourceIds:u}=t;if(u!=null&&u.length&&t.meta.skipEnforcingSingleAssignment!==!1&&a.usesResourceIds)l?l.add(u.filter(c=>!l.some(d=>d.eventId===t.id&&d.resourceId===c)).map(c=>({resource:c,event:t}))):a.$processResourceIds=!0;else if(o!=null&&!t.meta.skipEnforcingSingleAssignment){const c=a.getById(t.id);if(c&&c!==t&&!r){const h=l.storage.findItem("eventId",t.id);if(h!=null&&h.size){const g=h.values().next().value;g.resource=o,t.reassignedFromReplace=!0}}else a.$processResourceIds=!0;a.usesSingleAssignment=!0}return t}processResourceIds(){var t,r,n;const s=this,a=(r=s.assignmentStore)!=null?r:(t=s.crudManager)==null?void 0:t.assignmentStore;if(s.$processResourceIds&&(a!=null&&a.isAssignmentStore)&&!((n=s.project)!=null&&n.isSharingAssignmentStore&&s.isChained)){const l=[];s.forEach(o=>{const{resourceId:u,resourceIds:c,id:d}=o;u!=null?l.push({id:a.modelClass.generateId(""),resourceId:u,eventId:d}):c!=null&&c.length&&c.forEach(h=>{l.push({id:a.modelClass.generateId(""),resourceId:h,eventId:d})})},s,{includeFilteredOutRecords:!0}),a.useRawData={disableDefaultValue:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0},a.usesSingleAssignment=!1,a.verifyNoGeneratedIds=!1,a.data=l,a.usesSingleAssignment=!0,s.$processResourceIds=!1}}loadData(){super.loadData(...arguments),this.processResourceIds()}onBeforeRemoveAssignment({records:t}){var r;const n=this;if(n.removeUnassignedEvent&&!n.isRemoving&&!n.isSettingData&&!((r=n.stm)!=null&&r.isRestoring)&&!n.usesSingleAssignment&&!n.assignmentStore.isSyncingDataOnLoad&&!n.resourceStore.isSyncingDataOnLoad){const s=new Set;t.forEach(a=>{const{event:l}=a;l&&!l.isRemoved&&l.assignments.every(o=>t.includes(o))&&s.add(l)}),s.size&&n.remove([...s])}}onProjectAssignmentStoreChange({store:t}){this.attachToAssignmentStore(t)}attachToAssignmentStore(t){const r=this;r.detachListeners("assignmentStore"),t&&(r.processResourceIds(),t.ion({name:"assignmentStore",addPreCommit({records:n}){!r.isSettingData&&!r.isAssigning&&(r.usesSingleAssignment?n.forEach(s=>{const{event:a}=s;a!=null&&a.isEvent&&a.resourceId!==s.resourceId&&(a.meta.isAssigning=!0,a.set("resourceId",s.resourceId),a.meta.isAssigning=!1)}):r.usesResourceIds&&n.forEach(s=>{var a;const{event:l}=s;if(l!=null&&l.isEvent){l.meta.isAssigning=!0;const o=(a=l.resourceIds)!=null?a:[];o.includes(s.resourceId)||(l.resourceIds=[...o,s.resourceId]),l.meta.isAssigning=!1}}))},beforeRemove:"onBeforeRemoveAssignment",removePreCommit({records:n}){!r.isSettingData&&!r.isAssigning&&(r.usesSingleAssignment?n.forEach(s=>{var a;(a=r.getById(s.eventId))==null||a.set("resourceId",null)}):r.usesResourceIds&&n.forEach(({event:s,resourceId:a})=>{const l=s.resourceIds.slice(),o=l==null?void 0:l.indexOf(a);o>=0&&(l.splice(o,1),s.resourceIds=l)}))},removeAllPreCommit(){!r.isSettingData&&!r.isAssigning&&(r.usesSingleAssignment?r.allRecords.forEach(n=>n.set("resourceId",null)):r.usesResourceIds&&r.allRecords.forEach(n=>{n.resourceIds=[]}))},update({record:n,changes:s}){if("resourceId"in s){const{event:a}=n;if(r.usesSingleAssignment)a.meta.isAssigning=!0,a.set("resourceId",s.resourceId.value),a.meta.isAssigning=!1;else if(r.usesResourceIds){a.meta.isAssigning=!0;const l=a.resourceIds.slice(),o=l==null?void 0:l.indexOf(s.resourceId.oldValue);o>=0&&l.splice(o,1),l!=null&&l.includes(s.resourceId.value)||(l.push(s.resourceId.value),a.resourceIds=l),a.meta.isAssigning=!1}}},change({action:n,records:s}){n==="dataset"&&r.usesResourceIds&&s.forEach(({event:a,resourceId:l})=>{var o;const u=(o=a.resourceIds)!=null?o:[];u.includes(l)||(u.push(l),a.meta.isAssigning=!0,a.setData("resourceIds",u),a.meta.isAssigning=!1)})},thisObj:r}))}set data(t){this.isSettingData=!0,this.usesSingleAssignment&&!this.syncDataOnLoad&&!this.isChained&&this.assignmentStore.removeAll(!0),super.data=t,this.isSettingData=!1}trigger(t,r){var n;const{changes:s}=r||{};return s&&"resourceId"in s&&Object.keys(s).length===1&&!((n=this.stm)!=null&&n.isRestoring)&&(r.isAssign=!0),super.trigger(...arguments)}remove(t,...r){var n,s;const a=super.remove(t,...r);if(a.length&&this.usesSingleAssignment)for(const l of a)l.isOccurrence||(s=this.assignmentStore||((n=this.crudManager)==null?void 0:n.assignmentStore))==null||s.remove(l.assignments,!0);return a}},y(e,"$name","EventStoreMixin"),e},WS=()=>!0,HS=i=>!i.isRecurring,Vg=i=>{var e;return e=class extends i{getEvents({filter:t,date:r,startDate:n,endDate:s,startOnly:a,includeOccurrences:l,allowPartial:o,onlyAssigned:u=!1,dateMap:c=!1,dayTime:d=null,getDateIndex:h}){const g=this,f=arguments[0],{lastDateRange:m,added:p,filtersFunction:v}=g,b=t;if(u&&(f.filter=b?S=>b(S)&&S.resources.length:S=>S.resources.length),"startDate"in f||(n=f.startDate=r),"includeOccurrences"in f||(l=f.includeOccurrences=!0),"allowPartial"in f||(o=f.allowPartial=!a),f.storeFilterFn=g.isFiltered&&!f.ignoreFilters?g.reapplyFilterOnAdd?v:S=>p.includes(S)?g.indexOf(S)>-1:v(S):null,!s)if(n)s=f.endDate=k.clearTime(n),s.setDate(s.getDate()+1);else{if(l)throw new Error("getEvents MUST be passed startDate and endDate if recurring occurrences are requested");f.dateFilter=WS}f.dateFilter||(a?f.dateFilter=S=>{const C=S.hasBatchedChange("startDate")?S.get("startDate"):S.startDate;return C&&!(k.clearTime(C)-n)}:o?f.dateFilter=S=>{const C=S.hasBatchedChange("startDate")?S.get("startDate"):S.startDate,T=S.hasBatchedChange("endDate")?S.get("endDate"):S.endDate||C,E=!(C-T);return C&&(E?k.betweenLesserEqual(C,n,s):k.intersectSpans(C,T,n,s))}:f.dateFilter=S=>{const C=S.hasBatchedChange("startDate")?S.get("startDate"):S.startDate,T=S.hasBatchedChange("endDate")?S.get("endDate"):S.endDate||C;return C&&C>=n&&T<=s});const w={startDate:n,endDate:s};return g.processConfiguredListeners(),g.trigger("loadDateRange",{old:m||{},new:H.clone(w),changed:!!(!m||m.startDate-w.startDate||m.endDate-w.endDate)}),g.lastDateRange=H.clone(w),c?g.getEventsAsMap(f):g.getEventsAsArray(f)}getEventsAsArray({filter:t,date:r,resourceRecord:n,startDate:s=r,endDate:a,startOnly:l,includeOccurrences:o=!0,dayTime:u=null,dateFilter:c,storeFilterFn:d,getDateIndex:h}){const g=this,f=[];if(d?g.count:g.allCount){let p=n?g.getEventsForResource(n):null;if(!n){const v=g.useDayIndex(u),b=new Set,w=l?"startDate":"date";g.recurringEvents.forEach(S=>{v.dayTime.startOfDay(S.startDate)<=s&&b.add(S)});for(const S=new Date(s);S<a;S.setDate(S.getDate()+1)){const C=v.get(h?h(S):w,S);C==null||C.forEach(T=>b.add(T))}p=[...b]}d&&(p=p.filter(d));for(let v=0,{length:b}=p;v<b;v++){const w=p[v];o&&w.isRecurring?f.push.apply(f,w.getOccurrencesForDateRange(s,a).filter(c)):c(w)&&f.push(w)}}return t?f.filter(t):f}getEventsAsMap({filter:t,date:r,resourceRecord:n,startDate:s=r,endDate:a,startOnly:l,includeOccurrences:o=!0,dateMap:u,dayTime:c=null,storeFilterFn:d,getDateIndex:h}){var g;const f=this;if(u!=null&&u.clear?u.clear():u=new Map,f.count){const m=f.useDayIndex(c),p=l?"startDate":"date",v=[],b=S=>(!t||t(S))&&(!d||d(S)),w=S=>HS(S)&&b(S);if(c=m.dayTime,n)throw new Error("Querying for events for a resource and returning a date-keyed Map is not supported");(g=f.recurringEvents)==null||g.forEach(S=>{c.startOfDay(S.startDate)<a&&v.push(S)});for(const S=new Date(s);S<a;S.setDate(S.getDate()+1)){let[C,T]=m.get(h?h(S):p,S,!0);C!=null&&C.size&&(C=[...C].filter(w),C.length&&(u.get(T)||u.set(T,[]).get(T)).push(...C))}for(let S=0,{length:C}=v;S<C;S++){const T=v[S],E=(o?T.getOccurrencesForDateRange(s,a):[T]).filter(b),I=k.add(a,1,"day");for(let R,M=0,{length:O}=E;M<O;M++){const A=E[M],B=c.startOfDay(A.startDate),L=h?h(B):l?"startDate":"date",Y=L==="startDate"||!A.durationMS?k.add(B,1,"day"):k.min(A.endDate||k.add(A.startDate,A.duration,A.durationUnit),I);for(;B<Y;B.setDate(B.getDate()+1)){const K=c.dateKey(B);(R=u.get(K))||u.set(K,R=[]),R.push(A)}}}}return u}},y(e,"$name","GetEventsMixin"),e},el={date:"_dateIndex",startDate:"_startDateIndex"},_u=Object.values(el),jg=Object.freeze([]),{MILLIS_PER_DAY:zg}=it,Ou=class{constructor(i,e){this.dayTime=e||it.MIDNIGHT,this.store=i,this.users=[this.dayTime]}add(i,e,t){const r=this[el[i]],n=this.dayTime.dateKey(e);(r[n]||(r[n]=new Set)).add(t)}addEvent(i){var e,t,r;let n=(e=this.dayTime.startOfDay(i.startDate))==null?void 0:e.getTime(),s;if(n){s=(r=(t=i.endDate)==null?void 0:t.getTime())!=null?r:n,this.add("startDate",n,i);do this.add("date",n,i),n+=zg;while(n<s)}}clear(){_u.forEach(i=>this[i]=Object.create(null))}get(i,e,t){!this.initialized&&this.initialize();let r=this[el[i]],n;return e&&(n=this.dayTime.dateKey(e),r=t?[r[n],n]:r[n]),r}initialize(){this.initialized=!0,this.clear(),this.sync("splice",this.store.storage.allValues)}invalidate(){this.initialized=!1,_u.forEach(i=>this[i]=null)}matches(i){return this.dayTime.startShift===i.startShift}remove(i,e,t){const r=this[el[i]],n=this.dayTime.dateKey(e),s=r[n];s&&s.delete(t)}removeEvent(i,e,t){var r,n;let s=(r=this.dayTime.startOfDay(e))==null?void 0:r.getTime(),a;if(s){a=(n=t==null?void 0:t.getTime())!=null?n:s,this.remove("startDate",s,i);do this.remove("date",s,i),s+=zg;while(s<a)}}sync(i,e,t,r,n){var s,a;e=e||jg,t=t||jg;const l=this,o=e.length,u=t.length,c=r==null?void 0:r.length;let d,h,g;if(l.initialized)switch(i){case"clear":l.clear();break;case"splice":if(c)for(e=e.slice(),t=t.slice(),d=0;d<c;d++)t.push(r[d][0]),e.push(r[d][1]);if(u)for(d=0;d<u;d++)g=t[d],l.removeEvent(g,g.startDate,g.endDate);if(o)for(d=0;d<o;d++)h=e[d],h.isScheduled&&!h.isParent&&l.addEvent(h);break;case"reschedule":g=e[0],l.removeEvent(g,((s=n.startDate)==null?void 0:s.oldValue)||g.startDate,((a=n.endDate)==null?void 0:a.oldValue)||g.endDate),l.sync("splice",e);break}}register(i){this.users.push(i)}unregister(i){const{users:e}=this,t=e.indexOf(i);return t>-1&&e.splice(t,1),!e.length}},Wg=Ou.prototype;_u.forEach(i=>Wg[i]=null),Wg.initialized=!1,Ou._$name="EventDayIndex";var{MIDNIGHT:Hg}=it,YS=i=>{var e;return e=class extends i{construct(t){super.construct(t),this.dayIndices=null}afterLoadData(){var t;this.syncIndices("splice",this.storage.allValues),(t=super.afterLoadData)==null||t.call(this)}onDataChange({action:t,added:r,removed:n,replaced:s}){this.syncIndices(t,r,n,s),super.onDataChange(...arguments)}onDataReplaced(t,r){this.syncIndices("clear"),this.syncIndices("splice",this.storage.values),super.onDataReplaced(t,r)}onModelChange(t,r,n,s,a){("startDate"in n||"endDate"in n)&&this.syncIndices("reschedule",[t],null,null,n),super.onModelChange(...arguments)}invalidateDayIndices(){var t;(t=this.dayIndices)==null||t.forEach(r=>r.invalidate())}registerDayIndex(t){const r=this,n=r.dayIndices||(r.dayIndices=[]);let s,a;for(a=0;!s&&a<n.length;++a)n[a].matches(t)&&(s=n[a]).register(t);return!s&&n.push(s=new Ou(r,t)),s}syncIndices(...t){var r;(r=this.dayIndices)==null||r.forEach(n=>n.sync(...t))}unregisterDayIndex(t){const r=this,{dayIndices:n}=r;for(let s=n==null?void 0:n.length;s-- >0;)if(n[s].matches(t)){n[s].unregister(t)&&n.splice(s,1);break}}useDayIndex(t){const r=this,{dayIndices:n}=r;t=t||Hg;for(let s=0;n&&s<n.length;++s)if(n[s].matches(t))return n[s];if(t.startShift)throw new Error(`No day index registered for ${t} on ${r.id}`);return r.registerDayIndex(Hg)}},y(e,"$name","DayIndexMixin"),e},Yg=i=>class extends Za(i||F){static get $name(){return"RecurringEventsMixin"}getRecurringEvents(){return this.getRecurringTimeSpans()}isEventPersistable(t){return super.isEventPersistable(t)&&(!t.supportsRecurring||!t.isOccurrence)}},US=Ot(Cu.derive(Xe)),Ki=class extends US.mixin(Yg,Bg,YS,Vg){static get defaultConfig(){return{modelClass:Ui}}};y(Ki,"$name","EventStore"),Ki._$name="EventStore";var Ug=i=>class extends i{static get $name(){return"DependencyStoreMixin"}static get defaultConfig(){return{loadPriority:400,syncPriority:400,storeId:"dependencies"}}reduceEventDependencies(t,r,n,s=!0,a){return a=a||(l=>this.getEventDependencies(l)),t=z.asArray(t),t.reduce((l,o)=>{o.children&&!s?o.traverse(u=>{l=a(u).reduce(r,l)}):l=a(o).reduce(r,l)},n),n}mapEventDependencies(t,r,n,s,a){return this.reduceEventDependencies(t,(l,o)=>(n(o)&&l.push(o),l),[],s,a)}mapEventPredecessors(t,r,n,s){return this.reduceEventPredecessors(t,(a,l)=>(n(l)&&a.push(l),a),[],s)}mapEventSuccessors(t,r,n,s){return this.reduceEventSuccessors(t,(a,l)=>(n(l)&&a.push(l),a),[],s)}getEventDependencies(t){return[].concat(t.predecessors||[],t.successors||[])}removeEventDependencies(t){this.remove(this.getEventDependencies(t))}removeEventPredecessors(t){this.remove(t.predecessors)}removeEventSuccessors(t,r){this.remove(t.successors)}getBySourceTargetId(t){return this.records.find(r=>t==this.constructor.makeDependencySourceTargetCompositeKey(r.from,r.to))}getDependencyForSourceAndTargetEvents(t,r){return t=Q.asId(t),r=Q.asId(r),this.getBySourceTargetId(this.constructor.makeDependencySourceTargetCompositeKey(t,r))}getEventsLinkingDependency(t,r){return this.getDependencyForSourceAndTargetEvents(t,r)||this.getDependencyForSourceAndTargetEvents(r,t)}async isValidDependency(t,r,n){let s=t,a=r;return t==null?!1:(t.isDependencyModel&&({fromEvent:s,toEvent:a}=t),s=this.eventStore.getById(s),a=this.eventStore.getById(a),s&&a?!s.project||!a.project?!1:this.project.isValidDependency(s,a,n):t!==r)}isValidDependencyToCreate(t,r,n){return this.isValidDependency(t,r,n)}getHighlightedDependencies(t){return this.records.reduce((r,n)=>(n.isHighlightedWith(t)&&r.push(n),r),[])}static makeDependencySourceTargetCompositeKey(t,r){return`source(${t})-target(${r})`}getTimeSpanDependencies(t){return this.getEventDependencies(t)}},qS=Ot(bu.derive(Xe)),tl=class extends Ug(qS.derive(Xe)){static get defaultConfig(){return{modelClass:Is}}};tl._$name="DependencyStore";var qg=i=>class extends(i||F){static get $name(){return"ResourceStoreMixin"}get isResourceStore(){return!0}static get defaultConfig(){return{loadPriority:200,syncPriority:100,storeId:"resources",autoTree:!0}}construct(t){if(super.construct(t),!this.modelClass.isResourceModel)throw new Error("Model for ResourceStore must subclass ResourceModel")}removeAll(){const t=super.removeAll(...arguments);return t&&this.assignmentStore.removeAll(),t}onRecordIdChange({record:t,oldValue:r,value:n}){super.onRecordIdChange({record:t,oldValue:r,value:n}),t.isFieldModified("id")&&(this.isChangingId=!0,t.updateAssignmentResourceIds(),this.isChangingId=!1)}get allResourceRecords(){return this._allResourceRecords||(this._allResourceRecords=this.getAllDataRecords())}getAvailableResources({startDate:t,endDate:r}){return this.query(n=>this.eventStore.isDateRangeAvailable(t,r,null,n))}},KS=Ot(Su.derive(Xe)),rl=class extends qg(KS){static get defaultConfig(){return{modelClass:qi}}};rl._$name="ResourceStore";var Kg=i=>class extends i{static get $name(){return"AssignmentStoreMixin"}static get defaultConfig(){return{loadPriority:300,syncPriority:300,storeId:"assignments"}}add(t,...r){var n;t=z.asArray(t);for(let s=0;s<t.length;s++){let a=t[s];if(a instanceof Q||(t[s]=a=this.createRecord(a)),!this.isSyncingDataOnLoad&&this.storage.findIndex("eventResourceKey",a.eventResourceKey,!0)!==-1)throw new Error(`Duplicate assignment Event: ${a.eventId} to resource: ${a.resourceId}`);(n=a.event)!=null&&n.isCreating&&(a.isCreating=!0)}return super.add(t,...r)}includesAssignment(t,r){return this.storage.findIndex("eventResourceKey",`${t}-${r}`,!0)!==-1}setStoreData(t){if(this.usesSingleAssignment)throw new Error("Data loading into AssignmentStore (multi-assignment mode) cannot be combined EventStore data containing resourceId (single-assignment mode)");super.setStoreData(t)}set storage(t){super.storage=t,this.storage.addIndex({property:"eventResourceKey",dependentOn:{event:!0,resource:!0},onDuplicate(r){console.warn(`Duplicate assignment of event ${r.eventId} to resource ${r.resourceId}`)}})}get storage(){return this._storage||super.storage}get isAssignmentStore(){return!0}getOccurrence(t,r){if(!t||!(r!=null&&r.isOccurrence))return t;const n=this;return{id:`${r.id}:a${t.id}`,event:r,resource:t.resource,eventId:r.id,resourceId:t.resource.id,isAssignment:!0,isOccurrenceAssignment:!0,instanceMeta(s){return n.occurrenceInstanceMeta(this,s)}}}occurrenceInstanceMeta(t,r){const n=this,s=r.id||r,{id:a}=t;let{occurrenceMeta:l}=n;return l||(l=n.occurrenceMeta={}),l[a]||(l[a]={}),l[a][s]||(l[a][s]={})}mapAssignmentsForEvent(t,r,n){t=this.eventStore.getById(t);const s=!!r,a=!!n;return s||a?t.assignments.reduce((l,o)=>{const u=s?r(o):o;return(!a||n(u))&&l.push(u),l},[]):t.assignments}mapAssignmentsForResource(t,r,n){t=this.resourceStore.getById(t);const s=!!r,a=!!n;return s||a?t.assignments.reduce((l,o)=>{const u=s?r(o):o;return(!a||n(u))&&l.push(u),l},[]):t.assignments}getAssignmentsForEvent(t){return t.assignments}removeAssignmentsForEvent(t){return this.remove(t.assignments)}getAssignmentsForResource(t){return t=this.resourceStore.getById(t),t.assignments}removeAssignmentsForResource(t){this.remove(this.getAssignmentsForResource(t))}getResourcesForEvent(t){return t.resources}getEventsForResource(t){return t=this.resourceStore.getById(t),t==null?void 0:t.events}assignEventToResource(t,r,n=null,s=!1){var a,l,o;const u=this,c=s?new Set(t.assignments):null;if(r=z.asArray(r).map(h=>{var g;return(g=h.$original)!=null?g:h}),(a=u.eventStore)!=null&&a.usesSingleAssignment){if((l=t.assignments)!=null&&l.length)return u.isEventAssignedToResource(t,r[0])||(t.resource=r[0]),[];t.resourceId=(o=r[0])==null?void 0:o.id}let d=[];return u.suspendAutoCommit(),r.forEach(h=>{var g;const f=u.getAssignmentForEventAndResource(t,h);if(f)s&&c.delete(f);else{const m={event:t,resource:h};d.push((g=n==null?void 0:n(m))!=null?g:m)}}),d=u.add(d),s&&u.remove(Array.from(c)),u.resumeAutoCommit(),d}unassignEventFromResource(t,r){const n=this,s=[];if(!r)return n.removeAssignmentsForEvent(t);r=z.asArray(r);for(let a=0;a<r.length;a++)n.isEventAssignedToResource(t,r[a])&&s.push(n.getAssignmentForEventAndResource(t,r[a]));return n.remove(s)}isEventAssignedToResource(t,r){return!!this.getAssignmentForEventAndResource(t,r)}getAssignmentForEventAndResource(t,r){let n;return!(t=this.eventStore.getById(t))||!(n=t.assignments)||!(r=this.resourceStore.$master.getById(r))?null:this.getOccurrence(n.find(s=>{var a;return((a=s.resource)==null?void 0:a.$original)===r.$original}),t)}},GS=Ot(vu.derive(Xe)),Rs=class extends Kg(GS){static get defaultConfig(){return{modelClass:Ms}}};y(Rs,"$name","AssignmentStore"),Rs._$name="AssignmentStore";var XS=Tg,Gi=class extends LS(Pg(XS)){static get $name(){return"ProjectModel"}static get defaultConfig(){return{eventModelClass:Ui,dependencyModelClass:Is,resourceModelClass:qi,assignmentModelClass:Ms,eventStoreClass:Ki,dependencyStoreClass:tl,resourceStoreClass:rl,assignmentStoreClass:Rs}}construct(...i){super.construct(...i),ie.isTestEnv&&(globalThis.bryntum.testProject=this),this.modelPersistencyManager=this.createModelPersistencyManager()}createModelPersistencyManager(){return new Fg({eventStore:this,resourceStore:this.resourceStore,assignmentStore:this.assignmentStore,dependencyStore:this.dependencyStore})}doDestroy(){this.modelPersistencyManager.destroy(),super.doDestroy()}get taskStore(){return this.eventStore}};Gi.applyConfigs=!0,Gi.initClass(),Gi._$name="ProjectModel";var Gg=i=>class extends i{static get $name(){return"AbstractCrudManagerValidation"}static get configurable(){return{validateResponse:!0,skipSuccessProperty:!0,crudLoadValidationWarningPrefix:"CrudManager load response error(s):",crudSyncValidationWarningPrefix:"CrudManager sync response error(s):",supportShortSyncResponseNote:'Note: Please consider enabling "supportShortSyncResponse" option to allow less detailed sync responses (https://bryntum.com/products/scheduler/docs/api/Scheduler/crud/AbstractCrudManagerMixin#config-supportShortSyncResponse)',disableValidationNote:'Note: To disable this validation please set the "validateResponse" config to false'}}get crudLoadValidationMandatoryStores(){return[]}getStoreLoadResponseWarnings(t,r,n){const s=[],{storeId:a}=t,l=this.crudLoadValidationMandatoryStores,o={[a]:{}};return r?r.rows||(s.push(`- "${a}" store section should have a "rows" property with an array of the store records.`),o[a].rows=["..."]):l!=null&&l.includes(a)&&(s.push(`- No "${a}" store section found. It should contain the store data.`),o[a].rows=["..."]),s.length&&Object.assign(n,o),s}getLoadResponseWarnings(t){const r=[],n={};return this.skipSuccessProperty||(n.success=!0),this.forEachCrudStore((s,a,l)=>{r.push(...this.getStoreLoadResponseWarnings(l,t==null?void 0:t[a],n))}),r.length&&(r.push(`Please adjust your response to look like this:
`+JSON.stringify(n,null,4).replace(/"\.\.\."/g,"...")),r.push(this.disableValidationNote)),r}validateLoadResponse(t){const r=this.getLoadResponseWarnings(t);r.length&&console.warn(this.crudLoadValidationWarningPrefix+`
`+r.join(`
`))}getStoreSyncResponseWarnings(t,r,n,s){const a=[],l=[],o=[],{storeId:u}=t,c={[u]:{}},d=t.phantomIdField||this.phantomIdField,{modelClass:h}=t.store,{idField:g}=h,f=(n==null?void 0:n.rows)||[],m=(n==null?void 0:n.removed)||[];let p=!1;if(r!=null&&r.added&&(l.push(...r.added.filter(v=>!f.find(b=>b[d]==v[d])&&!m.find(b=>b[d]==v[d]||b[g]==v[d])).map(v=>({[d]:v[d],[g]:"..."}))),l.length)){const v=l.map(b=>"#"+b[d]).join(", ");a.push(`- "${u}" store "rows" section should mention added record(s) ${v} sent in the request. It should contain the added records identifiers (both phantom and "real" ones assigned by the backend).`)}if(this.supportShortSyncResponse)!l.length&&n&&((typeof n!="object"||Array.isArray(n))&&(a.push(`- "${u}" store section should be an Object.`),c[u]["..."]="..."),n.rows&&!Array.isArray(n.rows)&&(a.push(`- "${u}" store "rows" section should be an array`),l.push("...")),n.removed&&!Array.isArray(n.removed)&&(a.push(`- "${u}" store "removed" section should be an array:`),o.push("...")));else{if(r!=null&&r.updated){const v=r.updated.filter(b=>!f.find(w=>w[g]==b[g])).map(b=>({[g]:b[g]}));if(l.push(...v),v.length){const b=v.map(w=>"#"+w[g]).join(", ");a.push(`- "${u}" store "rows" section should mention updated record(s) ${b} sent in the request. It should contain the updated record identifiers.`),p=!0}}if(l.length&&l.push("..."),r!=null&&r.removed&&(o.push(...r.removed.filter(v=>!f.find(b=>b[g]==v[g])).map(v=>({[g]:v[g]}))),o.length)){const v=o.map(b=>"#"+b[g]).join(", ");a.push(`- "${u}" store "removed" section should mention removed record(s) ${v} sent in the request. It should contain the removed record identifiers.`),c[u].removed=o,o.push("..."),p=!0}}return l.length&&(c[u].rows=l),a.length||delete c[u],Object.assign(s,c),{messages:a,showSupportShortSyncResponseNote:p}}getSyncResponseWarnings(t,r){const n=[],s={},a=r.pack;this.skipSuccessProperty||(s.success=!0);let l=!1;return this.forEachCrudStore((o,u,c)=>{const d=this.getStoreSyncResponseWarnings(c,a==null?void 0:a[u],t[u],s);l=l||d.showSupportShortSyncResponseNote,n.push(...d.messages)}),n.length&&(n.push(`Please adjust your response to look like this:
`+JSON.stringify(s,null,4).replace(/"\.\.\.":\s*"\.\.\."/g,",,,").replace(/"\.\.\."/g,"...")),l&&n.push(this.supportShortSyncResponseNote),n.push(this.disableValidationNote)),n}validateSyncResponse(t,r){const n=this.getSyncResponseWarnings(t,r);n.length&&console.warn(this.crudSyncValidationWarningPrefix+`
`+n.join(`
`))}},ZS=class extends Error{},Xg=class extends ZS{constructor(i={}){var e,t;super(i.message||i.request&&P.capitalize((e=i.request)==null?void 0:e.type)+" failed"||"Crud Manager request failed"),Object.assign(this,i),this.action=(t=this.request)==null?void 0:t.type}},Zg=function(i,e,t){return i.store&&(i=i.store),e.store&&(e=e.store),i=i[t]||0,e=e[t]||0,i<e?-1:i>e?1:0},JS=function(i,e){return Zg(i,e,"loadPriority")},QS=function(i,e){return Zg(i,e,"syncPriority")},Au=i=>{var e;i.$$meta=i.$meta;const t=[];return i.isEvents||t.push(fe),i.isDelayable||t.push(xe),t.push(Gg),e=class extends(i||F).mixin(...t){static get $name(){return"AbstractCrudManagerMixin"}static get defaultConfig(){return{crudRevision:null,crudStores:[],storeIdProperty:"storeId",crudFilterParam:"filter",transport:{},trackResponseType:!1,supportShortSyncResponse:!0,phantomIdField:"$PhantomId",phantomParentIdField:"$PhantomParentId",autoLoad:!1,autoSyncTimeout:100,autoSync:!1,resetIdsBeforeSync:!0,syncApplySequence:[],orderedCrudStores:[],writeAllFields:!1,crudIgnoreUpdates:0,autoSyncSuspendCounter:0,crudLoaded:!1,applyingLoadResponse:!1,applyingSyncResponse:!1,callOnFunctions:!0}}get isCrudManager(){return!0}construct(r={}){this._requestId=0,this.activeRequests={},this.crudStoresIndex={},super.construct(r)}afterConstruct(){super.afterConstruct(),this.autoLoad&&(this._autoLoadPromise=this.doAutoLoad())}get loadUrl(){var r,n;return(n=(r=this.transport)==null?void 0:r.load)==null?void 0:n.url}updateLoadUrl(r){x.setPath(this,"transport.load.url",r)}get syncUrl(){var r,n;return(n=(r=this.transport)==null?void 0:r.sync)==null?void 0:n.url}updateSyncUrl(r){x.setPath(this,"transport.sync.url",r)}getStoreDescriptor(r){return r?r instanceof re?this.crudStores.find(n=>n.store===r):typeof r=="object"?this.crudStoresIndex[r.storeId]:this.crudStoresIndex[r]||this.getStoreDescriptor(re.getStore(r)):null}fillStoreDescriptor(r){const{store:n}=r,{storeIdProperty:s=this.storeIdProperty,modelClass:a}=n;return r.storeId||(r.storeId=n[s]||n.id),r.idField||(r.idField=a.idField),r.phantomIdField||(r.phantomIdField=a.phantomIdField),r.phantomParentIdField||(r.phantomParentIdField=a.phantomParentIdField),"writeAllFields"in r||(r.writeAllFields=n.writeAllFields),r}updateCrudStoreIndex(){const r=this.crudStoresIndex={};this.crudStores.forEach(n=>n.storeId&&(r[n.storeId]=n))}getCrudStore(r){const n=this.getStoreDescriptor(r);return n==null?void 0:n.store}forEachCrudStore(r,n=this){if(!r)throw new Error("Iterator function must be provided");this.crudStores.every(s=>r.call(n,s.store,s.storeId,s)!==!1)}set crudStores(r){this._crudStores=[],this.addCrudStore(r);for(const n of this._crudStores)n.loadPriority=n.syncPriority=0}get crudStores(){return this._crudStores}get orderedCrudStores(){return this._orderedCrudStores}set orderedCrudStores(r){return this._orderedCrudStores=r}set syncApplySequence(r){this._syncApplySequence=[],this.addStoreToApplySequence(r)}get syncApplySequence(){return this._syncApplySequence}internalAddCrudStore(r){const n=this;let s;return r instanceof re?s={store:r}:typeof r=="object"?(r.store||(r={storeId:r.id,store:new re(r)}),s=r):s={store:re.getStore(r)},n.fillStoreDescriptor(s),r=s.store,r.setCrudManager?r.setCrudManager(n):r.crudManager=n,r.pageSize=null,(n.loadUrl||n.syncUrl)&&(r.autoCommit=!1,r.autoLoad=!1,(r.createUrl||r.updateUrl||r.deleteUrl||r.readUrl)&&console.warn("You have configured an URL on a Store that is handled by a CrudManager that is also configured with an URL. The Store URL's should be removed.")),n.bindCrudStoreListeners(r),s}addCrudStore(r,n,s){if(r=z.asArray(r),!(r!=null&&r.length))return;const a=this,l=r.map(a.internalAddCrudStore,a);typeof n=="undefined"?a.crudStores.push(...l):(s&&((s instanceof re||typeof s!="object")&&(s=a.getStoreDescriptor(s)),n+=a.crudStores.indexOf(s)),a.crudStores.splice(n,0,...l)),a.orderedCrudStores.push(...l),a.updateCrudStoreIndex()}addPrioritizedStore(r){const n=this;n.hasCrudStore(r)||n.addCrudStore(r,z.findInsertionIndex(r,n.crudStores,JS)),n.hasApplySequenceStore(r)||n.addStoreToApplySequence(r,z.findInsertionIndex(r,n.syncApplySequence,QS))}hasCrudStore(r){var n;return(n=this.crudStores)==null?void 0:n.some(s=>s===r||s.store===r||s.storeId===r)}removeCrudStore(r){const n=this,s=n.crudStores,a=s.find(l=>l===r||l.store===r||l.storeId===r);if(a)n.unbindCrudStoreListeners(a.store),delete n.crudStoresIndex[a.storeId],z.remove(s,a),n.syncApplySequence&&n.removeStoreFromApplySequence(r);else throw new Error("Store not found in stores collection")}bindCrudStoreListeners(r){r.ion({name:r.id,addConfirmed:"onCrudStoreChange",change:"onCrudStoreChange",destroy:"onCrudStoreDestroy",thisObj:this})}unbindCrudStoreListeners(r){this.detachListeners(r.id)}addStoreToApplySequence(r,n,s){if(!r)return;r=z.asArray(r);const a=this,l=r.reduce((u,c)=>{const d=a.getStoreDescriptor(c);return d&&u.push(d),u},[]);if(typeof n=="undefined")a.syncApplySequence.push(...l);else{let u=n;s&&((s instanceof re||typeof s!="object")&&(s=a.getStoreDescriptor(s)),u+=a.syncApplySequence.indexOf(s)),a.syncApplySequence.splice(u,0,...l)}const o=a.syncApplySequence.map(({storeId:u})=>u);a.orderedCrudStores=[...a.syncApplySequence],a.crudStores.forEach(u=>{o.includes(u.storeId)||a.orderedCrudStores.push(u)})}removeStoreFromApplySequence(r){const n=this.syncApplySequence.findIndex(s=>s===r||s.store===r||s.storeId===r);n>-1&&(this.syncApplySequence.splice(n,1),this.orderedCrudStores.splice(n,1))}hasApplySequenceStore(r){return this.syncApplySequence.some(n=>n===r||n.store===r||n.storeId===r)}onCrudStoreDestroy({source:r}){this.removeCrudStore(r)}onCrudStoreChange(r){const n=this;n.crudIgnoreUpdates||(n.crudStoreHasChanges(r==null?void 0:r.source)?(n.trigger("hasChanges"),n.autoSync&&n.scheduleAutoSync()):n.trigger("noChanges"))}suspendAutoSync(){this.autoSyncSuspendCounter++}resumeAutoSync(r=!0){const n=this;n.autoSyncSuspendCounter--,n.autoSyncSuspendCounter<=0&&(n.autoSyncSuspendCounter=0,r&&n.autoSync&&n.crudStoreHasChanges()&&n.scheduleAutoSync())}get isAutoSyncSuspended(){return this.autoSyncSuspendCounter>0}scheduleAutoSync(){const r=this;!r.hasTimeout("autoSync")&&!r.isAutoSyncSuspended&&r.setTimeout({name:"autoSync",fn:()=>{r.sync().catch(n=>{})},delay:r.autoSyncTimeout})}async triggerFailedRequestEvents(r,n,s,a){const{options:l,type:o}=r;this.trigger("requestFail",{requestType:o,response:n,responseText:s,responseOptions:a}),this.trigger(o+"Fail",{response:n,responseOptions:a,responseText:s,options:l})}async internalOnResponse(r,n,s){const a=this,l=n?a.decode(n):null,{options:o,type:u}=r;if(n&&!l&&console.error("Failed to parse response: "+n),!l||(a.skipSuccessProperty?l.success===!1:!l.success))a.triggerFailedRequestEvents(r,l,n,s);else if(a.trigger("beforeResponseApply",{requestType:u,response:l})!==!1&&a.trigger(`before${P.capitalize(u)}Apply`,{response:l,options:o})!==!1){if(a.crudRevision=l.revision,await a.applyResponse(r,l,o),a.isDestroyed)return;a.trigger("requestDone",{requestType:u,response:l,responseOptions:s}),a.trigger(u,{response:l,responseOptions:s,options:o}),(u==="load"||!a.crudStoreHasChanges())&&(a.trigger("noChanges"),u==="load"&&a.emitCrudStoreEvents(r.pack.stores,"afterRequest"))}return l}suspendChangeTracking(){this.crudIgnoreUpdates++}resumeChangeTracking(r){this.crudIgnoreUpdates&&!--this.crudIgnoreUpdates&&!r&&this.onCrudStoreChange()}get isChangeTrackingSuspended(){return this.crudIgnoreUpdates>0}crudStoreHasChanges(r){return r?this.isCrudStoreDirty(this.getCrudStore(r)):this.crudStores.some(n=>this.isCrudStoreDirty(n.store))}isCrudStoreDirty(r){return!!r.changes}doAutoLoad(){return this.load().catch(r=>{})}emitCrudStoreEvents(r,n,s){const a={action:"read"+n,...s};for(const l of this.crudStores)r.includes(l.storeId)&&l.store.trigger(n,a)}getLoadPackage(r){const n={type:"load",requestId:this.requestId},s=this.crudStores,a=Object.assign({},r);return delete a.request,n.stores=s.map(l=>{var o;const u=a==null?void 0:a[l.storeId],c=l.pageSize||((o=l.store)==null?void 0:o.pageSize);if(u||c){const d=Object.assign({storeId:l.storeId,page:1},u);return c&&(d.pageSize=c),l.currentPage=d.page,u&&delete a[l.storeId],d}return l.storeId}),Object.assign(n,a),n}loadCrudStore(r,n,s){const a=n==null?void 0:n.rows;s!=null&&s.append||n!=null&&n.append?r.add(a,!1,{clean:!0}):r.data=a,r.trigger("load",{data:a})}loadDataToCrudStore(r,n,s){const a=r.store,l=n==null?void 0:n.rows;a.__loading=!0,l&&this.loadCrudStore(a,n,s,r),a.__loading=!1}loadCrudManagerData(r,n={}){const s=this;s.trigger("beforeLoadCrudManagerData"),s.suspendChangeTracking(),s.crudStores.forEach(a=>{const l=a.storeId,o=r[l];o&&s.loadDataToCrudStore(a,o,n[l])}),s.resumeChangeTracking(!0),s.trigger("loadCrudManagerData")}get isCrudManagerLoading(){return!!(this.activeRequests.load||this.applyingLoadResponse)}get isCrudManagerSyncing(){return!!(this.activeRequests.sync||this.applyingSyncResponse)}get isLoadingOrSyncing(){return!!(this.isCrudManagerLoading||this.isCrudManagerSyncing)}load(r){typeof r=="string"&&(r={request:{url:r}});const n=this,s=n.getLoadPackage(r);return n._autoLoadPromise=null,new Promise((a,l)=>{if(n.trigger("beforeLoad",{pack:s})!==!1){const{load:o}=n.activeRequests;o&&(n.cancelRequest(o.desc,o.reject),n.trigger("loadCanceled",{pack:s}));const u=H.assign({id:s.requestId,data:n.encode(s),type:"load",success:n.onCrudRequestSuccess,failure:n.onCrudRequestFailure,thisObj:n},r==null?void 0:r.request);n.activeRequests.load={type:"load",options:r,pack:s,resolve:a,reject(...c){u.success=u.failure=null,l(...c)},id:s.requestId,desc:n.sendRequest(u)},n.emitCrudStoreEvents(s.stores,"loadStart"),n.trigger("loadStart",{pack:s})}else n.trigger("loadCanceled",{pack:s}),l({cancelled:!0})})}getActiveCrudManagerRequest(r){let n=this.activeRequests[r];return!n&&this.trackResponseType&&(n=Object.values(this.activeRequests)[0]),n}prepareAddedRecordData(r,n){const s=this,{store:a}=n,{isTree:l}=a,o=n.phantomIdField||s.phantomIdField,u=n.phantomParentIdField||s.phantomParentIdField,c=a.modelClass.allFields.filter(g=>g.subStore),d=r.constructor,h=Object.assign(r.persistableData,{[o]:r.id});if(l){const{parent:g}=r;g&&!g.isRoot&&g.isPhantom&&(h[u]=g.id)}return s.resetIdsBeforeSync&&x.deletePath(h,d.idField),c.forEach(g=>{const f=r.get(g.name);f.allCount&&(h[g.dataSource]={added:f.getRange().map(m=>s.prepareAddedRecordData(m,{store:f}))})}),h}prepareAdded(r,n){return r.filter(s=>s.isValid).map(s=>this.prepareAddedRecordData(s,n))}prepareUpdated(r,n){const{store:s}=n,{isTree:a}=s,l=n.writeAllFields||n.writeAllFields!==!1&&this.writeAllFields,o=n.phantomParentIdField||this.phantomParentIdField,u=s.modelClass.allFields.filter(c=>c.subStore);if(n.store.tree){const c=n.store.rootNode;r=r.filter(d=>d!==c)}return r.filter(c=>c.isValid).reduce((c,d)=>{let h;if(l?h=d.persistableData:h=d.modificationDataToWrite,a){const{parent:g}=d;g&&!g.isRoot&&g.isPhantom&&(h[o]=g.id)}return u.forEach(g=>{const f=d.get(g.name);h[g.dataSource]=this.getCrudStoreChanges({store:f})}),x.isEmpty(h)||c.push(h),c},[])}prepareRemoved(r){return r.map(n=>{const s=n.constructor;return x.setPath({},s.idField,n.id)})}getCrudStoreChanges(r){const{store:n}=r;let{added:s=[],modified:a=[],removed:l=[]}=n.changes||{},o;return s.length&&(s=this.prepareAdded(s,r)),a.length&&(a=this.prepareUpdated(a,r)),l.length&&(l=this.prepareRemoved(l)),(s.length||a.length||l.length)&&(o={},s.length&&(o.added=s),a.length&&(o.updated=a),l.length&&(o.removed=l)),o}getChangesetPackage(){const{changes:r}=this;return r||this.forceSync?{type:"sync",requestId:this.requestId,revision:this.crudRevision,...r}:null}get changes(){const r={};return this.crudStores.forEach(n=>{const s=this.getCrudStoreChanges(n);s&&(r[n.storeId]=s)}),Object.keys(r).length>0?r:null}getRowsToApplyChangesTo({store:r,storeId:n},s,a){var l,o;const u=this,{modelClass:c}=r,d=c.idField,{updated:h,removed:g}=a||{};let f,m,p;if(s){p=!0;const v={};f=((l=s.rows)==null?void 0:l.slice())||[],m=((o=s.removed)==null?void 0:o.slice())||[],[...f,...m].forEach(b=>{const w=x.getPath(b,d);v[w]=!0}),u.supportShortSyncResponse&&(h==null||h.forEach(b=>{const w=x.getPath(b,d);v[w]||f.push({[d]:w})}),g==null||g.forEach(b=>{const w=x.getPath(b,d);v[w]||m.push({[d]:w})}))}else(h||g)&&(p=!1,f=h,m=g);return f=f!=null&&f.length?f:null,m=m!=null&&m.length?m:null,{rows:f,removed:m,remote:p}}applyChangesToStore(r,n,s){var a;const l=this,o=r.phantomIdField||l.phantomIdField,{store:u}=r,c=u.modelClass.getFieldDataSource("id"),d=u.modelClass.allFields.filter(w=>w.subStore),{rows:h,removed:g,remote:f}=l.getRowsToApplyChangesTo(r,n,s),m=[],p=[];if(h)for(const w of h)u.getById((a=w[o])!=null?a:w[c])?p.push(w):m.push(w);const v=[];p.length&&d.length&&p.forEach(w=>{var S,C,T;const E=u.getById((S=w[o])!=null?S:w[c]),I=((C=s.added)==null?void 0:C.find(M=>M[o]==w[o]))||((T=s.updated)==null?void 0:T.find(M=>M[c]==w[c])),R={};d.forEach(M=>{const O=E.get(M.name);l.applyChangesToStore({store:O},w[M.dataSource],I==null?void 0:I[M.dataSource]),R[M.dataSource]="foo",delete w[M.dataSource]}),v.push([E,R])});const b=u.applyChangeset({removed:g,added:m,updated:p},null,o,f,!0);return v.forEach(([w,S])=>Object.assign(b.get(w.id),S)),b}applySyncResponse(r,n){var s;const a=this,l=a.orderedCrudStores;a.applyingChangeset=a.applyingSyncResponse=!0,a.suspendChangeTracking();for(const o of l)a.applyChangesToStore(o,r[o.storeId],(s=n==null?void 0:n.pack)==null?void 0:s[o.storeId]);a.resumeChangeTracking(!0),a.applyingChangeset=a.applyingSyncResponse=!1}applyLoadResponse(r,n){this.applyingLoadResponse=!0,this.loadCrudManagerData(r,n),this.applyingLoadResponse=!1}async applyResponse(r,n,s){const a=this;switch(a.trackResponseType&&n.type||r.type){case"load":a.validateResponse&&a.validateLoadResponse(n),a.applyLoadResponse(n,s);break;case"sync":a.validateResponse&&a.validateSyncResponse(n,r),a.applySyncResponse(n,r);break}}applyChangeset(r,n=null,s,a=!1){const l=this,o=a?new Map:void 0;l.suspendAutoSync(),l.suspendChangeTracking();for(const{store:u,phantomIdField:c}of l.orderedCrudStores)if(r[u.id]){const d=u.applyChangeset(r[u.id],n,c||l.phantomIdField,!0,a);d&&o.set(u.id,d)}return l.resumeChangeTracking(!0),l.resumeAutoSync(!1),o}get requestId(){return Number.parseInt(`${Date.now()}${this._requestId++}`)}sync(){const r=this;return r.clearTimeout("autoSync"),r.activeRequests.sync?(r.trigger("syncDelayed"),r.activeSyncPromise=r.activeSyncPromise.finally(()=>r.sync())):r.activeSyncPromise=new Promise((n,s)=>{const a=r.getChangesetPackage();if(!a){n(null);return}r.trigger("beforeSync",{pack:a})!==!1?(r.trigger("syncStart",{pack:a}),r.activeRequests.sync={type:"sync",pack:a,resolve:n,reject:s,id:a.requestId,desc:r.sendRequest({id:a.requestId,data:r.encode(a),type:"sync",success:r.onCrudRequestSuccess,failure:r.onCrudRequestFailure,thisObj:r})}):(r.trigger("syncCanceled",{pack:a}),s({cancelled:!0}))}).catch(n=>{if(n&&!n.cancelled)throw n;return n})}async onCrudRequestSuccess(r,n,s){const a=this,{type:l,id:o}=s;if(a.isDestroyed)return;let u="";s=a.activeRequests[l];try{u=await r.text()}catch(d){}if(a.isDestroyed)return;if((s==null?void 0:s.id)!==o)throw new Error(`Interleaved ${l} operation detected`);a.activeRequests[l]=null;const c=await a.internalOnResponse(s,u,n);if(!a.isDestroyed){if(!c||(a.skipSuccessProperty?(c==null?void 0:c.success)===!1:!(c!=null&&c.success))){const d={rawResponse:r,response:c,request:s};c!=null&&c.message&&(d.message=c.message),s.reject(new Xg(d))}a["crud"+P.capitalize(s.type)+"ed"]=!0,s.resolve({response:c,rawResponse:r,responseText:u,request:s})}}async onCrudRequestFailure(r,n,s){var a;const l=this;if(l.isDestroyed)return;s=l.activeRequests[s.type];const o=(a=n==null?void 0:n.abortController)==null?void 0:a.signal;if(!!!(o!=null&&o.aborted)){let c,d="";try{d=await r.text(),c=l.decode(d)}catch(h){}if(l.isDestroyed||(l.triggerFailedRequestEvents(s,c,d,n),l.isDestroyed))return;s.reject(new Xg({rawResponse:r,request:s}))}l.activeRequests[s.type]=null}acceptChanges(){this.crudStores.forEach(r=>r.store.acceptChanges())}revertChanges(){this.revertCrudStoreChanges()}revertCrudStoreChanges(){const{usesSingleAssignment:r}=this.eventStore;this.orderedCrudStores.forEach(({store:n})=>(!n.isAssignmentStore||!r)&&n.revertChanges())}doDestroy(){const r=this,{load:n,sync:s}=r.activeRequests;for(n&&r.cancelRequest(n.desc,n.reject),s&&r.cancelRequest(s.desc,s.reject);r.crudStores.length>0;)r.removeCrudStore(r.crudStores[0]);super.doDestroy&&super.doDestroy()}},y(e,"configurable",{loadUrl:null,syncUrl:null,forceSync:null}),y(e,"delayable",{doAutoLoad:"raf"}),e},Pu=i=>class km extends(i||F){static get $name(){return"AjaxTransport"}static get defaultMethod(){return{load:"GET",sync:"POST"}}cancelRequest(t,r){var n;(n=t.abort)==null||n.call(t),this.isDestroying||r({cancelled:!0})}shouldUseBodyForRequestData(t,r,n){return!(r==="HEAD"||r==="GET")&&!n}sendRequest(t){const r=this,{data:n}=t,s=r.transport[t.type]||{},a=H.assign({},s,s.requestConfig);t.url&&(a.url=t.url),a.method=a.method||km.defaultMethod[t.type],a.params=H.assign(a.params||{},t.params);let{paramName:l}=a;if(r.shouldUseBodyForRequestData(s,a.method,l)?(a.body=n,a.headers=a.headers||{},a.headers["Content-Type"]=a.headers["Content-Type"]||"application/json"):(l=l||"data",a.params[l]=n),!a.url)throw new Error("Trying to request without URL specified");delete a.requestConfig,delete a.paramName;let o,u;function c(){a.queryParams=a.params,delete a.params;let h=!1;const g=H.assign({},a,a.fetchOptions);return o=Vt.fetch(a.url,g),o.catch(f=>{var m,p;o.done=!0,(m=r.trigger)==null||m.call(r,"responseReceived",{success:!1});const v=(p=g.abortController)==null?void 0:p.signal;return v&&(h=v.aborted,h||console.warn(f)),{error:f,cancelled:h}}).then(f=>{var m;o.done=!0,(m=r.trigger)==null||m.call(r,"responseReceived",{success:!!(f!=null&&f.ok)});const p=f!=null&&f.ok?t.success:t.failure;return p==null?void 0:p.call(t.thisObj||r,f,g,t)})}const d=r.trigger("beforeSend",{params:a.params,requestType:t.type,requestConfig:a,config:t});return H.isPromise(d)?u=d.then(c):u=c(),u.abort=()=>{var h;o.done||(h=o.abort)==null||h.call(o)},u}},Fu=i=>class extends(i||F){static get $name(){return"JsonEncoder"}static get defaultConfig(){return{encoder:{}}}encode(t){var r;return t=Object.assign({},(r=this.encoder)==null?void 0:r.requestData,t),P.safeJsonStringify(t)}decode(t){return P.safeJsonParse(t)}},Lu=i=>class extends(i||F).mixin(Au,Pu,Fu){static get defaultConfig(){return{project:null}}startConfigure(t){this.getConfig("project"),super.startConfigure(t),this._changesToClear=new Map}async doAutoLoad(){const{project:t}=this;return t&&await t.commitAsync(),super.doAutoLoad()}applyProjectResponse(t){const r=this,{project:n}=r;r.applyingProjectResponse=!0;const s=n.fieldMap.startDate,a=n.fieldMap.endDate,l=x.getPath(t,s.dataSource),o=x.getPath(t,a.dataSource);typeof l=="string"&&x.setPath(t,s.dataSource,s.convert(l)),typeof o=="string"&&x.setPath(t,a.dataSource,a.convert(o)),n.setByDataSource(t),r._changesToClear.set(r,t),r.applyingProjectResponse=!1}loadCrudManagerData(t,r={}){const n=this,{project:s}=n;n.suspendChangeTracking(),super.loadCrudManagerData(...arguments),t!=null&&t.project&&(s.delayEnteringReplica&&s.hasDataInStores?s.ion({recordsUnlinked:()=>{n.suspendChangeTracking(),n.applyProjectResponse(t.project),n.resumeChangeTracking()},once:!0}):n.applyProjectResponse(t.project)),n.resumeChangeTracking()}async sync(){const{project:t}=this;if(this.suspendAutoSync(),t&&await t.commitAsync(),!this.isDestroying)return this.resumeAutoSync(!1),super.sync()}async applyResponse(t,r,n){var s,a,l,o,u,c;const d=this;if(!(d.isDestroyed||(s=d.project)!=null&&s.isDestroyed)){if(d.trigger("beforeApplyResponse"),await super.applyResponse(t,r,n),(r!=null&&r.project||d.supportShortSyncResponse&&((a=t==null?void 0:t.pack)!=null&&a.project))&&d.applyProjectResponse(r.project||((l=t==null?void 0:t.pack)==null?void 0:l.project)),d.project){let h=t.type;d.trackResponseType&&(h=r.type||h);const g=`propagating${P.capitalize(h)}Changes`;d.suspendAutoSync(),d[g]=!0;const f=d.project.isInitialCommit&&!d.project.silenceInitialCommit;await d.project.commitAsync(),d[g]=!1,(o=d.resumeAutoSync)==null||o.call(d,f),(u=d.commitRespondedChanges)==null||u.call(d)}(c=d.trigger)==null||c.call(d,"applyResponse")}}applySyncResponse(...t){var r;const n=this,s=(r=n.project)==null?void 0:r.stm.disabled;s===!1&&n.ignoreRemoteChangesInSTM&&n.project.stm.disable(),super.applySyncResponse(...t),s===!1&&n.project.stm.enable()}shouldClearRecordFieldChange(t,r,n){const s=t.getValue(r);return r=t.getFieldDefinition(r),r!=null&&r.isEqual?r.isEqual(s,n):x.isEqual(s,n)}commitRespondedChanges(){this._changesToClear.forEach((t,r)=>{Object.entries(t).forEach(([n,s])=>{this.shouldClearRecordFieldChange(r,n,s)&&delete r.meta.modified[n]})}),this._changesToClear.clear()}applyChangesToStore(t,r,n,...s){const a=super.applyChangesToStore(t,r,n,...s);if(a.size&&this.project)for(const[l,o]of a){const u=t.store.getById(l);u&&this._changesToClear.set(u,o)}return a}},Xr=class extends Ui{};y(Xr,"$name","TaskModel"),y(Xr,"fields",["status","prio","description","eventColor",{name:"weight",type:"number"},{name:"readOnly",type:"boolean"}]),Xr._$name="TaskModel";var _s=class extends Ki{afterLoadData(){const{records:i}=this;if(this.autoAssignWeight&&!i.some(e=>e.weight!=null))for(let e=0;e<i.length;e++)i[e].setData("weight",(e+1)*100)}};y(_s,"configurable",{autoAssignWeight:!0,storeId:"tasks",modelClass:Xr,removeUnassignedEvent:!1,sorters:[{field:"weight",ascending:!0}]}),_s._$name="TaskStore";var il=class extends Gi.mixin(Lu){construct(i){i.tasks&&(i.eventsData=i.tasks),i.tasksData&&(i.eventsData=i.tasksData),i.taskStore&&(i.eventStore=i.taskStore),i.taskModelClass&&(i.eventModelClass=i.taskModelClass),i.taskStoreClass&&(i.eventStoreClass=i.taskStoreClass),super.construct(i);const e=this;e.addPrioritizedStore(e.assignmentStore),e.addPrioritizedStore(e.resourceStore),e.addPrioritizedStore(e.taskStore)}get taskStore(){return this.eventStore}set taskStore(i){this.eventStore=i}get tasksData(){return this.eventsData}set tasksData(i){this.eventsData=i}get tasks(){return this.eventsData}set tasks(i){this.events=i}toJSON(){const{taskStore:i,assignmentStore:e,resourceStore:t}=this,r={tasksData:i.toJSON()};return e!=null&&e.count&&(r.assignmentsData=e.toJSON()),t!=null&&t.count&&(r.resourcesData=t.toJSON()),r}};y(il,"configurable",{eventStoreClass:_s,eventModelClass:Xr,taskStoreClass:_s,taskModelClass:Xr}),il._$name="ProjectModel";var Os=class extends Q{get taskBoard(){return this.firstStore.taskBoard}async collapse(){this.taskBoard.collapse(this)}async expand(){return this.taskBoard.expand(this)}get tasks(){return[...this.taskBoard.getSwimlaneTasks(this)||[]]}};y(Os,"$name","SwimlaneModel"),y(Os,"fields",[{name:"text",type:"string"},{name:"color",type:"string"},{name:"collapsible",type:"boolean",defaultValue:!0},{name:"collapsed",type:"boolean"},{name:"hidden",type:"boolean"},{name:"height",type:"number"},{name:"flex",type:"number"},"tasksPerRow"]),Os._$name="SwimlaneModel";var Jg=i=>{var e;return e=class extends(i||F){get widgetClass(){}changeShowCollapseInHeader(t){return x.assertBoolean(t,"showCollapseInHeader"),t}async collapse(t){return this.toggleCollapse(t,!0)}async expand(t){return this.toggleCollapse(t,!1)}async toggleCollapse(t,r=!t.collapsed){t.isSwimlaneModel?await this.toggleSwimlaneCollapse(t,r):await this.toggleColumnCollapse(t,r)}async toggleSwimlaneCollapse(t,r=!t.collapsed){return new Promise(n=>{const s=this,a=s.getSwimlaneElement(t),l=de.getChild(a,"body");r&&(l.style.height=`${l.getBoundingClientRect().height}px`),$.onTransitionEnd({element:l,property:"height",handler(){r?a.style.height="":(l.style.height="",a.style.height=`${t.height}px`),a.classList.remove(r?"b-collapsing":"b-expanding"),s.recompose.flush(),n()},thisObj:s}),a.classList.add(r?"b-collapsing":"b-expanding"),s.suspendDomTransition(),t.collapsed=r,s.trigger(`swimlane${r?"Collapse":"Expand"}`,{swimlaneRecord:t}),s.trigger("swimlaneToggle",{swimlaneRecord:t,collapse:r}),s.resumeDomTransition()})}async toggleColumnCollapse(t,r=!t.collapsed){return new Promise(n=>{var s,a;const l=this,{documentRoot:o}=l,u=l.getColumnElements(t),c=de.getChild(l.bodyElement,`header.${t.domId}`),d=t.width&&!t.flex,h=o.querySelectorAll(`.b-taskboard-card[data-column="${t.domId}"]`),g=`${(s=h[0])==null?void 0:s.getBoundingClientRect().width}px`,f=`${(a=u[0])==null?void 0:a.getBoundingClientRect().width}px`;h.forEach(m=>{r&&(m.style.width=g)}),u.unshift(c),u.forEach(m=>{r?(d||(m.style.width=f),m.classList.add("b-collapsing")):m.classList.add("b-expanding")}),$.onTransitionEnd({element:c,property:"width",handler(){h.forEach(m=>{r||(m.style.width="")}),u.forEach(m=>{r?m.classList.remove("b-collapsing"):(d||(m.style.width=""),m.classList.remove("b-expanding"))}),l.recompose.flush(),l.scrollable.syncOverflowState(),n()},thisObj:l}),c.offsetWidth,l.suspendDomTransition(),t.collapsed=r,l.trigger(`column${r?"Collapse":"Expand"}`,{columnRecord:t}),l.trigger("columnToggle",{columnRecord:t,collapse:r}),l.resumeDomTransition()})}populateColumnHeader(t){var r;(r=super.populateColumnHeader)==null||r.call(this,t);const{showCollapseInHeader:n,collapseTitle:s,hasSwimlanes:a,showCollapseTooltip:l}=this,{columnRecord:o,columnHeaderConfig:u}=t,{text:c,collapsed:d,collapsible:h}=o;D.merge(u,{class:{"b-collapsed":d,"b-rotate-title":d&&!s&&!a},style:{minWidth:d?null:o.minWidth},children:{padder:{children:{expander:n&&h&&{tag:"button",class:{"b-taskboard-column-expander":1,"b-fw-icon":1,"b-icon-expand-column":1},dataset:{btip:l?P.xss`${this.L(d?"L{TaskBoard.expand}":"L{TaskBoard.collapse}",c)}`:null}}}}}})}populateColumn(t){var r;(r=super.populateColumn)==null||r.call(this,t);const{columnRecord:n,columnConfig:s}=t,{collapsed:a}=n;s.class["b-collapsed"]=a,a&&(s.style.minWidth=null)}populateSwimlane(t){var r;(r=super.populateColumn)==null||r.call(this,t);const{swimlaneRecord:n,swimlaneConfig:s}=t;if(n){const{showCollapseInHeader:a,showCollapseTooltip:l}=this,{text:o,collapsed:u,collapsible:c}=n;D.merge(s,{class:{"b-collapsed":u,"b-collapsible":c},children:{header:{children:{title:{children:{"expander > text":a&&c&&{tag:"button",class:{"b-taskboard-swimlane-expander":1,"b-icon":1,"b-icon-expand-row":1},dataset:{btip:l?P.xss`${this.L(u?"L{TaskBoard.expand}":"L{TaskBoard.collapse}",o)}`:null}}}}}},body:{[u?"inert":null]:!0}}})}}onColumnHeaderClick({event:t,columnRecord:r}){(t.target.matches(".b-taskboard-column-expander")||r.collapsed)&&this.toggleCollapse(r)}onColumnClick({columnRecord:t}){t.collapsed&&this.toggleCollapse(t)}onSwimlaneHeaderClick({swimlaneRecord:t}){this.toggleCollapse(t)}},y(e,"$name","ExpandCollapse"),y(e,"configurable",{showCollapseInHeader:!0,collapseTitle:!1,showCollapseTooltip:!0}),e},Qg=i=>{var e;return e=class extends(i||F){constructor(){super(...arguments),y(this,"responsivenessSuspended",0)}get widgetClass(){}changeCardSizes(t){return x.assertArray(t,"cardSizes"),t}suspendResponsiveness(){this.responsivenessSuspended++}resumeResponsiveness(){this.responsivenessSuspended--}getCardSize(t,r){const n=this,{cardSizes:s}=n,a=n.getTasksPerRow(t,r),l=n.getColumnWidth(t),o=(l-n.cardGap*(a-1))/a;return(s==null?void 0:s.find(u=>o<u.maxWidth))||(s==null?void 0:s[s.length-1])}getColumnWidth(t){return t.instanceMeta(this).width}getTasksPerRow(t,r){return t.tasksPerRow||(r==null?void 0:r.tasksPerRow)||this.tasksPerRow}onChildResize(t){const r=this;if(r.recompose.suspended||r.responsivenessSuspended)return;let n=!1;for(const s of t){const{target:a,contentRect:l}=s;if(a.observedWidth!==l.width){const o=r.resolveColumnRecord(a),u=o&&r.columns.includes(o)&&r.getColumnElements(o);if(!o||o.collapsed||o.hidden||!u)return;o.instanceMeta(r).width=a.observedWidth=l.width;for(const c of u){const d=r.resolveSwimlaneRecord(c),h=r.getCardSize(o,d);h&&c.elementData.cardSize!==h.name&&(n=!0)}}}n&&(r.recompose.now(),r.scrollable.syncOverflowState())}changeResizeObserver(t,r){return r==null||r.disconnect(),this.isDestroying||!ResizeObserver?null:new ResizeObserver(this.onChildResize.bind(this))}populateColumn(t){var r;(r=super.populateColumn)==null||r.call(this,t);const{columnRecord:n,swimlaneRecord:s,columnConfig:a}=t,l=t.cardSize=this.getCardSize(n,s);l&&(a.class[`b-${l.name}-cards`]=l,a.elementData.cardSize=l.name)}},y(e,"$name","ResponsiveCards"),y(e,"configurable",{cardSizes:[{maxWidth:50,name:"micro",maxAvatars:1,headerItems:{text:null},bodyItems:{text:null}},{maxWidth:75,name:"tiny",maxAvatars:1,bodyItems:{text:null}},{maxWidth:175,name:"small",maxAvatars:2,bodyItems:{text:null}},{maxWidth:250,name:"medium",maxAvatars:3},{name:"large",maxAvatars:7}],resizeObserver:{value:!0,$config:["nullify"]}}),e},e0={remove:1,move:1,update:1,filter:1},em=i=>{var e;return e=class extends(i||F){get widgetClass(){}changeAutoGenerateColumns(t){return x.assertBoolean(t,"autoGenerateColumns"),t}changeColumnField(t){return x.assertString(t,"columnField"),t}updateColumnField(t,r){if(r){const{storage:n}=this.project.taskStore;r!==this.swimlaneField&&n.removeIndex(r),n.addIndex({property:t,unique:!1})}this.shouldAutoGenerateColumns=t&&this.autoGenerateColumns}changeColumns(t){return re.from(t,{objectify:!0,modelClass:ws},r=>typeof r=="string"?{id:r,text:P.capitalize(r)}:r)}updateColumns(t){this.detachListeners("columns"),t&&((t.$store||t).taskBoard=this,t.ion({change:"onColumnsChange",refresh:"onColumnsChange",thisObj:this}))}get columns(){const t=this,{taskStore:r}=t.project;return t.shouldAutoGenerateColumns&&r.count&&(t.columns=r.getDistinctValues(t.columnField).sort(),t.shouldAutoGenerateColumns=!1),t._columns}onColumnsChange({action:t}){if((t==="add"||t==="remove"||t==="removeAll"||t==="update")&&this.project.taskStore.storage.invalidateIndices(),e0[t]){const r={};(t==="update"||t==="remove")&&(r.addTransition={width:1,opacity:1},r.removeTransition={width:1,opacity:1}),this.recomposeWithDomTransition(r)}else this.recompose()}getColumnTasks(t,r=!1){const n=this,{taskStore:s}=n.project,a=s.storage.findItem(n.columnField,t.id),l=a?[...a]:[];if(r&&a)if(n.swimlanes){const{swimlaneField:o}=n,u=n.swimlanes.map(c=>c.id);if(l.sort((c,d)=>{const h=u.indexOf(c[o])-u.indexOf(d[o]);return h!==0?h:c.weight!=null||d.weight!=null?c.weight-d.weight:s.indexOf(c)-s.indexOf(d)}),u.length&&o)return l.filter(c=>u.includes(c[o]))}else l.sort((o,u)=>o.weight-u.weight);return l}getColumn(t){return this.columns.getById(t.getValue(this.columnField))}getNextTask(t,r=!0){const n=this.getColumn(t),s=n.tasks;let a=s.indexOf(t)+1;if(a===s.length)if(r)a=0;else return null;return s[a]}getPreviousTask(t,r=!0){const n=this.getColumn(t),s=n.tasks;let a=s.indexOf(t)-1;if(a<0)if(r)a=s.length-1;else return null;return s[a]}},y(e,"$name","TaskBoardColumns"),y(e,"configurable",{columns:{},autoGenerateColumns:!1,columnField:null}),y(e,"properties",{shouldAutoGenerateColumns:!1}),e},tm=i=>{var e;return e=class extends(i||F){get widgetClass(){}resolveTaskRecord(t){var r;return t=t.closest(".b-taskboard-card"),t&&this.project.taskStore.getById((r=t.elementData)==null?void 0:r.taskId)}resolveColumnRecord(t){var r;return t=t.closest(".b-taskboard-column, .b-taskboard-column-header"),t&&this.columns.getById((r=t.elementData)==null?void 0:r.columnId)}resolveSwimlaneRecord(t){var r;return t=t.closest(".b-taskboard-swimlane"),t&&((r=this.swimlanes)==null?void 0:r.getById(t.elementData.laneId))}getTaskElement(t){const r=this.getTaskColumnElement(t);return r&&de.getChild(r,`body.inner.${t.domId}`)}getTaskColumnElement(t){const r=this.columns.getById(t.getValue(this.columnField));return r&&de.getChild(this.getTaskSwimlaneElement(t),`body.${r.domId}`)}getTaskSwimlaneElement(t){var r,n;const s=(r=this.swimlanes)!=null&&r.count?(n=this.swimlanes.getById(t.getValue(this.swimlaneField)))==null?void 0:n.domId:"default";return de.getChild(this.bodyElement,s)}getSwimlaneElement(t){return de.getChild(this.bodyElement,t.domId)}getSwimlaneColumnElement(t,r){return t?de.getChild(this.getSwimlaneElement(t),`body.${r.domId}`):this.getColumnElement(r)}getColumnElement(t){var r;return(r=this.getColumnElements(t))==null?void 0:r[0]}getColumnElements(t){var r;return(r=this.swimlanes)!=null&&r.count?this.swimlanes.reduce((n,s)=>(s.hidden||n.push(this.getSwimlaneColumnElement(s,t)),n),[]):[this.getSwimlaneColumnElement({domId:"default"},t)]}getColumnHeaderElement(t){return de.getChild(this.bodyElement,`header.${t.domId}`)}getCardAt(t,r,n=".b-taskboard-card"){var s;return(s=this.documentRoot.elementFromPoint(t,r))==null?void 0:s.closest(n)}cacheCSSVar(t,r){const n=this;let s=n[`_${t}`];if(s==null){const a=n.css[t];s=D.measureSize(a||r,n.element),a&&(n[`_${t}`]=s)}return s}get cardGap(){return this.cacheCSSVar("cardGap","1em")}},y(e,"$name","TaskBoardDom"),e},rm=i=>{var e,t;return e=class extends(i||F){constructor(){super(...arguments),Om(this,t,null)}get widgetClass(){}changeDomListeners(r){if(r)for(const n in this.domEvents)r[n]="triggerDomEvent";return r}resolveEvent(r){const{target:n}=r,s=this.resolveTaskRecord(n),a=this.resolveColumnRecord(n),l=this.resolveSwimlaneRecord(n);return{taskRecord:s,columnRecord:a,swimlaneRecord:l,event:r}}triggerDomEvent(r){const n=this,s=n.resolveEvent(r),a=n.domEvents[r.type],{target:l}=r;if(n.isScrolling||l.closest(".b-widget")!==n._element)return;r.taskBoardData=s;let o;if(s.taskRecord){const u=`task${P.capitalize(a)}`;o=n.trigger(u,s),u===n.activateTaskEvent&&!r.defaultPrevented&&n.trigger("activateTask",{taskRecord:s.taskRecord,event:r})}else s.columnRecord?l.closest(".b-taskboard-column-header")?o=n.trigger(`columnHeader${P.capitalize(a)}`,s):o=n.trigger(`column${P.capitalize(a)}`,s):s.swimlaneRecord&&(l.closest(".b-taskboard-swimlane-header")?o=n.trigger(`swimlaneHeader${P.capitalize(a)}`,s):o=n.trigger(`swimlane${P.capitalize(a)}`,s));if(o!==!1&&(n.trigger(a,s),(a==="mouseOver"||a==="mouseOut")&&s.taskRecord)){const u=l.closest(".b-taskboard-card");a==="mouseOver"&&u!==_m(n,t)&&(Gu(n,t,u),n.trigger("taskMouseEnter",s)),a==="mouseOut"&&!u.contains(r.relatedTarget)&&(Gu(n,t,null),n.trigger("taskMouseLeave",s))}}domSyncCallback({action:r,domConfig:n,lastDomConfig:s,targetElement:a,syncId:l,jsx:o}){var u,c,d,h,g,f;const m=this,{elementType:p}=(u=n==null?void 0:n.elementData)!=null?u:{},v=r==="reuseOwnElement",{reactComponent:b}=this;if(o&&this.processTaskItemContent){this.processTaskItemContent({jsx:o,targetElement:a,reactComponent:b,domConfig:n});return}if(n)if(p==="task"){const{taskId:w}=n.elementData,S=m.project.taskStore.getById(w);r==="newElement"&&((c=m.cardIntersectionObserver)==null||c.observe(a)),r==="newElement"||r==="reuseOwnElement"?(!m.isVirtualized||S.instanceMeta(m).intersects)&&m.trigger("renderTask",{taskRecord:S,element:a,isRefresh:v}):r==="removeElement"&&((d=m.cardIntersectionObserver)==null||d.unobserve(a),m.trigger("removeTaskElement",{taskId:w,element:a}))}else if(p==="column"){const{columnId:w,laneId:S}=n.elementData,C=m.columns.getById(w),T=S!=null&&((h=m.swimlanes)==null?void 0:h.getById(S));r==="newElement"||r==="reuseOwnElement"?m.trigger("renderColumn",{columnRecord:C,swimlaneRecord:T,element:a,isRefresh:v}):r==="removeElement"&&m.trigger("removeColumnElement",{columnId:w,swimlaneRecord:T,element:a})}else if(p==="swimlane"){const{laneId:w}=n.elementData,S=w!=null&&w!=="default"&&((g=m.swimlanes)==null?void 0:g.getById(w));w!=="default"&&(r==="newElement"||r==="reuseOwnElement"?m.trigger("renderSwimlane",{swimlaneRecord:S,element:a,isRefresh:v}):r==="removeElement"&&m.trigger("removeSwimlaneElement",{swimlaneId:w,element:a}))}else(f=n.class)!=null&&f["b-taskboard-column-header-padder"]&&m.resizeObserver&&(r==="newElement"&&(a.isResizeObserved||(m.resizeObserver.observe(a),a.isResizeObserved=!0)),r==="removeElement"&&a.isResizeObserved&&(m.resizeObserver.unobserve(a),delete a.isResizeObserved))}onClick(){}onMouseMove(){}onMouseUp(){}onTaskMouseDown(){}onTaskClick(){}onTaskDblClick(){}onTaskContextMenu(){}onColumnMouseDown(){}onColumnHeaderClick(...r){super.onColumnHeaderClick(...r)}onSwimlaneHeaderClick(...r){super.onSwimlaneHeaderClick(...r)}onActivateTask(){}},t=new WeakMap,y(e,"$name","TaskBoardDomEvents"),y(e,"configurable",{activateTaskEvent:"taskDblClick",domEvents:{click:"click",dblclick:"dblClick",mouseup:"mouseUp",mousedown:"mouseDown",mousemove:"mouseMove",mouseover:"mouseOver",mouseout:"mouseOut",keydown:"keyDown",contextmenu:"contextMenu"},domListeners:{}}),e},im=i=>{var e;return e=class extends(i||F){get widgetClass(){}onInternalPaint({firstPaint:t}){if(t){const r=this;$.on({element:r.element,scroll(){r.isScrolling=!0,r.onScrollEnd()},capture:!0,thisObj:r})}}onScrollEnd(){this.isScrolling=!1,this.recomposeOnScrollEnd&&(this.recompose(),this.recomposeOnScrollEnd=!1)}changeScrollOptions(t){return x.assertObject(t,"scrollOptions"),t}async scrollToSwimlane(t,r=this.scrollOptions){const n=this.swimlanes.getById(t),s=n&&this.getSwimlaneElement(n);if(s)return r=x.assign({x:!1,animate:(r==null?void 0:r.animate)||(r==null?void 0:r.behavior)==="smooth"},r),Gt.scrollIntoView(s,r,this.rtl)}async scrollToColumn(t,r=this.scrollOptions){const n=this.columns.getById(t),s=n&&this.getColumnHeaderElement(n);if(s)return r=x.assign({animate:(r==null?void 0:r.animate)||(r==null?void 0:r.behavior)==="smooth",y:!1},r),Gt.scrollIntoView(s,r,this.rtl)}async scrollToIntersection(t,r,n=this.scrollOptions){const s=this.swimlanes.getById(t),a=this.columns.getById(r),l=s&&a&&this.getSwimlaneColumnElement(s,a);if(l)return n=x.assign({animate:(n==null?void 0:n.animate)||(n==null?void 0:n.behavior)==="smooth",edgeOffset:10},n),Gt.scrollIntoView(l,n,this.rtl)}async scrollToTask(t,r=this.scrollOptions){const n=this,s=n.project.taskStore.getById(t),a=s&&n.getTaskElement(s);if(a){const l={start:10,end:10,top:10,bottom:10};return n.stickyHeaders&&(n.hasSwimlanes&&(l.top+=n.getTaskSwimlaneElement(s).syncIdMap.header.offsetHeight),l.top+=n.bodyElement.syncIdMap.header.offsetHeight),n.isVirtualized&&!n.getTaskHeight&&(a.scrollIntoView(),await new Promise((o,u)=>{const c=n.ion({renderTask({taskRecord:d}){d===s&&(c(),o())},expires:{delay:200,alt:u}})})),r=x.assign({animate:(r==null?void 0:r.animate)||(r==null?void 0:r.behavior)==="smooth",edgeOffset:l},r),Gt.scrollIntoView(a,r,n.rtl)}}},y(e,"$name","TaskBoardScroll"),y(e,"configurable",{scrollOptions:{animate:!0,block:"nearest",highlight:!0},testConfig:{scrollOptions:{animate:!1,block:"nearest"}}}),y(e,"delayable",{onScrollEnd:ie.isTestEnv?300:100}),e},nm=i=>{var e;return e=class extends(i||F){get widgetClass(){}get assignments(){return this.project.assignmentStore.records}updateAssignments(t){this.project.assignmentStore.data=t}get resources(){return this.project.resourceStore.records}updateResources(t){this.project.resourceStore.data=t}get tasks(){return this.project.taskStore.records}updateTasks(t){this.project.taskStore.data=t}changeNewTaskDefaults(t){return x.assertObject(t,"newTaskDefaults"),t}changeProject(t){return t&&!t.isModel&&(t=this.projectModelClass.new(t)),this.attachToProject(t),t}attachToProject(t){const r=this;if(r.bindCrudManager(t),t){const{taskStore:n}=t;if(n){const{storage:s}=n;s.addIndex({property:r.columnField,unique:!1}),r.swimlaneField&&s.addIndex({property:r.swimlaneField,unique:!1}),Reflect.defineProperty(n.$master.modelClass.prototype,"columnSwimlaneIntersection",{get(){return this.buildIndexKey({[r.columnField]:this[r.columnField],[r.swimlaneField]:this[r.swimlaneField]})}}),n.$master.modelClass.prototype.buildIndexKey=function(a){var l;return`${a[r.columnField]}-/-${((l=r.swimlanes)==null?void 0:l.count)&&a[r.swimlaneField]||"default"}`},s.addIndex({property:"columnSwimlaneIntersection",unique:!1,dependentOn:{[r.swimlaneField]:!0,[r.columnField]:!0}})}r.attachToProjectStore(t.taskStore,{change:"onTaskStoreChange",changePreCommit:"onTaskStoreEarlyChange",refresh:"onTaskStoreRefresh"}),r.attachToProjectStore(t.assignmentStore),r.attachToProjectStore(t.resourceStore)}}attachToProjectStore(t,r={}){this.detachListeners(t.$name),t==null||t.ion({name:t.$name,change:"recompose",refresh:"recompose",thisObj:this,...r})}onTaskStoreEarlyChange({action:t}){t==="add"&&this.recomposeWithDomTransition({addTransition:{height:1,opacity:1}})}onTaskStoreChange({action:t,changes:r}){const{columnField:n,swimlaneField:s}=this;t==="remove"||t==="filter"||t==="update"&&(r[n]||s&&r[s])?this.recomposeWithDomTransition({removeTransition:{height:1,opacity:1}}):this.recompose()}onTaskStoreRefresh({action:t}){t==="sort"?!this.taskSorterFn&&this.recomposeWithDomTransition():this.recompose()}async addTask(t,r=null,n={}){var s;const a=this,{swimlaneField:l,swimlanes:o,project:u}=a,c=a.getColumnElement(t).syncIdMap.body,d=c.lastElementChild,h={[a.columnField]:t.id,name:a.L("L{TaskBoard.newTaskName}"),weight:((s=u.taskStore.max("weight"))!=null?s:0)+100,...a.newTaskDefaults,...n};let g=!1;l&&(r?h[l]=r.id:o!=null&&o.count&&(h[l]=o.first.id)),d&&d.offsetTop+d.offsetHeight>c.clientHeight-100&&(a.suspendDomTransition(),g=!0);const f=u.autoSync&&u.await("sync",!1),[m]=u.taskStore.add(h);if(a.recompose.now(),a.useDomTransition&&!a.domTransitionSuspended&&await a.await("transitionedRecompose",!1),!a.isDestroyed&&(await a.scrollToTask(m,x.assign({},a.scrollOptions,{highlight:!1,block:"nearest"})),!a.isDestroyed)){if(f){if(await f,a.isDestroyed)return;a.recompose.now()}return g&&a.resumeDomTransition(),a.features.simpleTaskEdit&&a.editTask(m),m}}async removeTask(t){const r=z.asArray(t);return await this.trigger("beforeTaskRemove",{taskRecords:r})!==!1?(this.project.taskStore.remove(r),!0):!1}},y(e,"$name","TaskBoardStores"),y(e,"configurable",{projectModelClass:il,project:{},assignments:null,resources:null,tasks:null,newTaskDefaults:{},loadMaskDefaults:{useTransition:!0,showDelay:100},syncMask:null}),e},sm=i=>{var e;return e=class extends(i||F){get widgetClass(){}changeAutoGenerateSwimlanes(t){return x.assertBoolean(t,"autoGenerateSwimlanes"),t}changeSwimlaneField(t){return x.assertString(t,"swimlaneField"),t}updateSwimlaneField(t,r){if(!this.isConfiguring){const{storage:n}=this.project.taskStore;r&&r!==this.columnField&&n.removeIndex(r),n.addIndex({property:t,unique:!1})}this.shouldAutoGenerateSwimlanes=t&&this.autoGenerateSwimlanes}changeSwimlanes(t){return re.from(t,{objectify:!0,modelClass:Os},r=>typeof r=="string"?{id:r,text:P.capitalize(r)}:r)}updateSwimlanes(t){this.detachListeners("swimlanes"),t&&((t.$store||t).taskBoard=this,t.ion({change:"onSwimlanesChange",refresh:"onSwimlanesChange",thisObj:this}))}get swimlanes(){const t=this,{taskStore:r}=t.project;return t.shouldAutoGenerateSwimlanes&&r.count&&(t.swimlanes=r.getDistinctValues(t.swimlaneField).sort(),t.shouldAutoGenerateSwimlanes=!1),t._swimlanes}onSwimlanesChange({action:t}){if((t==="add"||t==="remove"||t==="removeAll"||t==="update")&&this.project.taskStore.storage.invalidateIndices(),t==="remove"||t==="update"||t==="filter"){const r={};t==="update"&&(r.addTransition={height:1,opacity:1},r.removeTransition={height:1,opacity:1}),this.recomposeWithDomTransition(r);return}this.recompose()}get hasSwimlanes(){var t;return!!(this.swimlaneField&&((t=this.swimlanes)!=null&&t.count))}getSwimlaneTasks(t){return this.project.taskStore.storage.findItem(this.swimlaneField,t.id)}getSwimlane(t){var r;return this.swimlaneField&&((r=this.swimlanes)==null?void 0:r.getById(t.getValue(this.swimlaneField)))}},y(e,"$name","TaskBoardSwimlanes"),y(e,"configurable",{swimlanes:{},autoGenerateSwimlanes:!1,swimlaneField:null}),y(e,"properties",{shouldAutoGenerateSwimlanes:!1}),e},am=i=>{var e;return e=class extends(i||F){get widgetClass(){}changeVirtualize(t){return x.assertBoolean(t,"virtualize"),t}updateVirtualize(t){var r;const n=this;(r=n.cardIntersectionObserver)==null||r.disconnect(),n.cardIntersectionObserver=null,t&&(n.cardIntersectionObserver=new IntersectionObserver(s=>{for(const a of s)n.onCardIntersection(a.target,a.isIntersecting,a)})),!this.isConfiguring&&!this.isDestroying&&this.refreshVirtualizedCards()}refreshVirtualizedCards(){const t=this;if(t.recompose.now(),t.cardIntersectionObserver)for(const r of t.element.querySelectorAll(".b-taskboard-card"))t.cardIntersectionObserver.observe(r)}changeGetTaskHeight(t){return t&&x.assertFunction(t,"getTaskHeight"),t}updateGetTaskHeight(t){!this.isConfiguring&&!this.isDestroying&&this.refreshVirtualizedCards()}compose(t){return t.class["b-virtualized"]=this.isVirtualized,super.compose(t)}get isVirtualized(){return!!this.cardIntersectionObserver}onCardIntersection(t,r,n){const s=this,{taskRecord:a}=t.elementData,l=a.instanceMeta(s),o=l.intersects;o!==r&&(l.intersects=r,!r&&o&&(l.lastHeight=n.boundingClientRect.height),(!s.isScrolling||s.drawOnScroll)&&s.queueColumnRecompose(s.getColumn(a),s.getSwimlane(a)),s.isScrolling&&(s.recomposeOnScrollEnd=!0))}renderCardOutline(t,r,n){var s;const a=this,{id:l,domId:o,weight:u}=t;return{id:`${a.id}-card-${o}`,class:{"b-taskboard-card":!0,"b-out-of-view":!0},tabIndex:0,dataset:{task:o,column:r.id,lane:n==null?void 0:n.id,weight:u,domTransition:!0},elementData:{elementType:"task",taskId:l,taskRecord:t,columnRecord:r,swimlaneRecord:n},style:{height:((s=a.getTaskHeight)==null?void 0:s.call(a,t))||t.instanceMeta(a).lastHeight}}}renderCard(t,r,n){const{isVirtualized:s}=this,a=t.instanceMeta(this);if(s&&!a.dragging&&!a.intersects&&!this.isSelected(t))return this.renderCardOutline(t,r,n)}},y(e,"$name","TaskBoardVirtualization"),y(e,"configurable",{getTaskHeight:null,virtualize:{value:null,$config:"nullify"},drawOnScroll:!0}),e},As=class extends ke{static render({domConfig:i,value:e,taskRecord:t,config:r}){r.field==="id"&&t.hasGeneratedId?(i.class["b-generated-id"]=1,i.text="\u273B"):i.text=t.getFieldDefinition(r.field).print(e)}};y(As,"$name","TextItem"),y(As,"type","text"),As.initClass(),As._$name="TextItem";var Xi=class extends ke{static render({taskBoard:i,domConfig:e,config:t,taskRecord:r,cardSize:n}){var s,a;const l=(a=(s=n==null?void 0:n.maxAvatars)!=null?s:t.maxAvatars)!=null?a:7,{resourceImagePath:o}=i,{resources:u}=r,c=u.length>l,d=u.length-l+1,h=u[l];let{avatarRendering:g}=i;if(g||(g=i.avatarRendering=new ms({element:i.element,colorPrefix:"b-taskboard-background-color-"})),!i.project.resourceStore.count)return!1;x.merge(e,{class:{"b-overlap":t.overlap},children:[...u.sort((f,m)=>f.name.localeCompare(m.name)).slice(0,l-(c?1:0)).map((f,m)=>({class:{"b-taskboard-resource-avatar-wrap":1},dataset:{resourceId:f.id},children:[g.getResourceAvatar({resourceRecord:f,imageUrl:f.image===!1?null:f.imageUrl||f.image&&(o||"")+f.image,initials:f.initials,color:f.eventColor,dataset:{btip:P.encodeHtml(f.name)}})]})),c&&{class:{"b-taskboard-resource-avatar-overflow":1},dataset:{resourceId:"$overflow",btip:u.slice(-d).map(f=>P.encodeHtml(f.name)).join(", "),count:d},children:[g.getResourceAvatar({resourceRecord:h,imageUrl:h.image===!1?null:h.imageUrl||h.image&&o+h.image,initials:h.initials})]}],syncOptions:{syncIdField:"resourceId"}})}static onClick({source:i,taskRecord:e,event:t}){const r=t.target.closest(".b-resource-avatar, .b-taskboard-resource-avatar-overflow");if(r){if(r.matches(".b-resource-avatar")){const n=i.project.resourceStore.getById(r.dataset.resourceId);i.trigger("resourceAvatarClick",{resourceRecord:n,taskRecord:e,element:r,event:t})}else i.trigger("resourceAvatarOverflowClick",{taskRecord:e,element:r,event:t});return!1}}};y(Xi,"$name","ResourceAvatarsItem"),y(Xi,"type","resourceAvatars"),y(Xi,"defaultEditor",{type:"resourcescombo",pickerWidth:"13em"}),Xi.initClass(),Xi._$name="ResourceAvatarsItem";var t0={resourceAvatars:1,separator:1,taskMenu:1},$u=".b-taskboard-taskitem",r0=/\s*<\s*/,i0=/\s*>\s*/,lm=i=>{var e;return e=class extends(i||F){get widgetClass(){}changeProcessItems(t){return x.assertFunction(t,"processItems"),t}mergeItems(t,r){return r&&t&&(t=x.mergeItems(r,t)),t}changeHeaderItems(t,r){return x.assertObject(t,"headerItems"),this.mergeItems(t,r)}changeBodyItems(t,r){return x.assertObject(t,"bodyItems"),this.mergeItems(t,r)}changeFooterItems(t,r){return x.assertObject(t,"footerItems"),this.mergeItems(t,r)}renderItems(t,r,n,s){for(const a in r){const l=r[a];if(l&&!l.hidden){"field"in l||(a.includes(">")?[l.field]=a.split(i0):a.includes("<")?[,l.field]=a.split(r0):l.field=a);const{field:o}=l,u=t.getValue(o);if(u!=null||t0[l.type]||l.renderNull){const c=ke.resolveType(l.type),d=`b-taskboard-${P.hyphenate(l.type)}`,h={class:{"b-taskboard-taskitem":1,[d]:1,[l.cls]:l.cls,"b-editable":!t.readOnly&&c.getEditorConfig({config:l,item:c})},dataset:{role:`item-${o}`,field:o,ref:a},elementData:{item:c,taskRecord:t,config:l},style:{order:l.order,style:l.style}};c.render({taskBoard:this,domConfig:h,value:u,config:l,taskRecord:t,cardSize:s})!==!1&&(n.children[a]=h)}}}}populateCard(t){var r;(r=super.populateCard)==null||r.call(this,t);const n=this,{processItems:s}=n,{taskRecord:a,cardConfig:l,cardSize:o}=t,{headerItems:u,bodyItems:c,footerItems:d}=o||{},{header:h,body:g,footer:f}=l.children;let{headerItems:m,bodyItems:p,footerItems:v}=n;(u||s)&&(m=x.clone(m)),(c||s)&&(p=x.clone(p)),(d||s)&&(v=x.clone(v)),u&&x.merge(m,u),c&&x.merge(p,c),d&&x.merge(v,d),s==null||s({headerItems:m,bodyItems:p,footerItems:v,taskRecord:a,cardSize:o}),n.renderItems(a,m,h,o),n.renderItems(a,p,g,o),n.renderItems(a,v,f,o)}resolveTaskItem(t){const r=t.closest($u)||t.querySelector(`:scope > * > ${$u}, :scope > ${$u}`);return r?{...r.elementData,element:r}:null}onTaskClick(t){var r;const n=this.resolveTaskItem(t.event.target);if(n){const{config:s,item:a}=n;(r=a.onClick)==null||r.call(a,{config:s,...t})}super.onTaskClick(t)}onTaskDblClick(t){var r;const n=this.resolveTaskItem(t.event.target);if(n){const{config:s,item:a}=n;(r=a.onDblClick)==null||r.call(a,{config:s,...t})}super.onTaskDblClick(t)}},y(e,"$name","TaskItems"),y(e,"configurable",{headerItems:{value:{text:{type:"text",field:"name"}},$config:{merge:"items"}},bodyItems:{value:{text:{type:"text",field:"description"}},$config:{merge:"items"}},footerItems:{value:{resourceAvatars:{type:"resourceAvatars",field:"resources"}},$config:{merge:"items"}},processItems:null}),e},n0=["navigateDown","navigateLeft","navigateUp","navigateRight","activate"],om=i=>{var e;return e=class extends(i||F){get widgetClass(){}getTaskNear(t,r){var n,s,a;const{documentRoot:l}=this,o=D.measureSize(this.css.cardGap||"1em",this.bodyElement.querySelector(".b-taskboard-swimlane-body .b-taskboard-column"));let u=(n=l.elementFromPoint(t,r))==null?void 0:n.closest(".b-taskboard-card");return u||(u=(s=l.elementFromPoint(t,r-o))==null?void 0:s.closest(".b-taskboard-card")),u||(u=(a=l.elementFromPoint(t,r+o))==null?void 0:a.closest(".b-taskboard-card")),u}focusAndOptionallySelect(t,r){if(t){const n=this,s=n.resolveTaskRecord(document.activeElement);if(r&&s&&!n.isSelected(s)&&n.selectTask(s,!0),n.selectOnNavigation||r){const a=n.resolveTaskRecord(t);n.isSelected(a)?r&&n.deselectTask(s):n.selectTask(a,r)}t.focus()}}navigateNext(t,r){const n=this,{taskRecord:s,swimlaneRecord:a,columnRecord:l}=t.taskBoardData,o=n.getTaskElement(s);let u=null,c=l;do if(c=n.columns.getNext(c,!0),!c.hidden){const d=n.getSwimlaneColumnElement(a,c),h=V.from(d,null,!0).center.x,g=V.from(o,null,!0).center.y;u=n.getTaskNear(h,g)}while(!u&&c!==l);n.focusAndOptionallySelect(u,r)}navigatePrev(t,r){const n=this,{taskRecord:s,swimlaneRecord:a,columnRecord:l}=t.taskBoardData,o=n.getTaskElement(s);let u=null,c=l;do if(c=n.columns.getPrev(c,!0),!c.hidden){const d=n.getSwimlaneColumnElement(a,c),h=V.from(d,null,!0).center.x,g=V.from(o,null,!0).center.y;u=n.getTaskNear(h,g)}while(!u&&c!==l);n.focusAndOptionallySelect(u,r)}navigateRight(t,r=!1){this["navigate"+(this.rtl?"Prev":"Next")](t,r)}navigateLeft(t,r=!1){this["navigate"+(this.rtl?"Next":"Prev")](t,r)}navigateDown(t,r=!1){const{taskRecord:n}=t.taskBoardData,s=this.getNextTask(n,!0);this.focusAndOptionallySelect(this.getTaskElement(s),r)}navigateUp(t,r=!1){const{taskRecord:n}=t.taskBoardData,s=this.getPreviousTask(n,!0);this.focusAndOptionallySelect(this.getTaskElement(s),r)}activate(t){const{taskRecord:r}=this.resolveEvent(t);r&&this.trigger("activateTask",{taskRecord:r,event:t})}isActionAvailable({action:t,event:r}){const n=this.resolveEvent(r);return r.taskBoardData=n,t==="activate"&&n.taskRecord&&r.target!==this.getTaskElement(n.taskRecord)?!1:!!((this.navigateable||!n0.includes(t))&&(n!=null&&n.taskRecord))}},y(e,"$name","TaskNavigation"),y(e,"configurable",{keyMap:{ArrowDown:"navigateDown",ArrowLeft:"navigateLeft",ArrowUp:"navigateUp",ArrowRight:"navigateRight",Enter:"activate"},navigateable:!0,selectOnNavigation:!1}),e},um=i=>{var e;return e=class extends(i||F){get widgetClass(){}changeSelectedTasks(t){return x.assertArray(t,"selectedTasks"),t.filter(r=>{var n;return((n=this.isTaskSelectable)==null?void 0:n.call(this,r))!==!1})}toggleTaskSelection(t,r=!1,n=null){const s=this;n==null?s.isSelected(t)?r?s.deselectTask(t):s.selectTask(t,!1):s.selectTask(t,r):n?s.selectTask(t,r):s.deselectTask(t)}selectTask(t,r=!1){var n;const{selectedTasks:s}=this,a={action:"select",select:[t]};((n=this.isTaskSelectable)==null?void 0:n.call(this,t))!==!1&&(r||(a.deselect=s.slice(),s.length=0),z.include(s,t),this.triggerSelectionChange(a),this.recompose())}deselectTask(t){z.remove(this.selectedTasks,t),this.triggerSelectionChange({action:"deselect",deselect:[t]}),this.recompose()}deselectAll(){const{selectedTasks:t}=this;if(t.length){const r=t.slice();t.length=0,this.triggerSelectionChange({action:"deselect",deselect:r}),this.recompose()}}isSelected(t){return this.selectedTasks.includes(t)}triggerSelectionChange(t){this.trigger("selectionChange",Object.assign({selection:this.selectedTasks,select:[],deselect:[]},t))}onTaskClick(t){super.onTaskClick(t);const{event:r,taskRecord:n}=t;r.defaultPrevented||this.toggleTaskSelection(n,r.ctrlKey)}keyboardSelect(t){if(!D.isEditable(t.target)){const{taskRecord:r}=this.resolveEvent(t);if(r)return this.toggleTaskSelection(r,!1),!0}return!1}keyboardToggleSelect(t){const{taskRecord:r}=this.resolveEvent(t);r&&this.toggleTaskSelection(r,!0)}onClick(t){super.onClick(t),!t.taskRecord&&this.navigateable&&this.deselectAll()}selectUp(t){this.navigateUp(t,!0)}selectDown(t){this.navigateDown(t,!0)}selectLeft(t){this.navigateLeft(t,!0)}selectRight(t){this.navigateRight(t,!0)}populateCard(t){var r;(r=super.populateCard)==null||r.call(this,t);const{taskRecord:n,cardConfig:s}=t;s.class["b-selected"]=this.isSelected(n)}populateBody(t){var r;(r=super.populateBody)==null||r.call(this,t);const{bodyConfig:n}=t;n.class["b-has-selection"]=!!this.selectedTasks.length}},y(e,"$name","TaskSelection"),y(e,"configurable",{selectedTasks:[],isTaskSelectable:null,keyMap:{" ":"keyboardSelect","Ctrl+ ":"keyboardToggleSelect","Shift+ArrowDown":"selectDown","Shift+ArrowLeft":"selectLeft","Shift+ArrowUp":"selectUp","Shift+ArrowRight":"selectRight"}}),e},Zi=class extends ke{static render({domConfig:i,value:e,config:t}){e&&Object.assign(i,{tag:"img",src:(t.baseUrl||"")+e,draggable:!1})}};y(Zi,"$name","ImageItem"),y(Zi,"type","image"),y(Zi,"defaultEditor",null),Zi.initClass(),Zi._$name="ImageItem";var Ji=class extends ke{static render({domConfig:i,config:e,taskRecord:t,value:r}){i.retainChildren=!0,i.children=[e.jsx({value:r,taskRecord:t,config:e})]}};y(Ji,"$name","JsxItem"),y(Ji,"type","jsx"),y(Ji,"defaultEditor",null),Ji.initClass(),Ji._$name="JsxItem";var Zr=class extends ke{static render({domConfig:i,value:e,config:t}){const r=Math.round(100*e/(t.max||100))+"%";i.children=[{class:"b-taskboard-progress-outline",dataset:{percent:r},children:[{class:"b-taskboard-progress-progress",style:{width:r},dataset:{percent:r}}]}],i.dataset.percent=i.dataset.btip=r}};y(Zr,"$name","ProgressItem"),y(Zr,"type","progress"),y(Zr,"configurable",{}),y(Zr,"defaultEditor",null),Zr.initClass(),Zr._$name="ProgressItem";var Qi=class extends ke{static render({domConfig:i,value:e,config:t}){const{max:r=e}=t;i.children=[];for(let n=0;n<r;n++)i.children.push({tag:"i",class:{"b-icon b-icon-star":1,"b-filled":n<e}})}};y(Qi,"$name","RatingItem"),y(Qi,"type","rating"),y(Qi,"defaultEditor",null),Qi.initClass(),Qi._$name="RatingItem";var en=class extends ke{static render({domConfig:i}){i.tag="hr"}};y(en,"$name","SeparatorItem"),y(en,"type","separator"),y(en,"defaultEditor",null),en.initClass(),en._$name="SeparatorItem";var tn=class extends ze.mixin(Fe){afterConfigure(){var i;const e=this;if(!((i=e.store)!=null&&i.count)&&e.taskBoard&&e.name){const{name:t,separator:r}=e,n=[];e.taskBoard.project.taskStore.forEach(s=>{const a=s[t];a&&(typeof a=="string"?n.push(...a.split(r)):n.push(...a))}),e.items=[...new Set(n)].sort()}}changeValue(i,e){this.$expectsString=!1,this.separator&&typeof i=="string"&&(i=i.split(this.separator),this.$expectsString=!0),super.changeValue(i,e)}get value(){const i=super.value;return this.$expectsString?i.join(this.separator):i}set value(i){super.value=i}};y(tn,"$name","TagCombo"),y(tn,"type","tagcombo"),y(tn,"configurable",{multiSelect:!0,editable:!1,separator:",",picker:{cls:"b-tag-picker"},chipView:{closable:!1}}),tn.initClass(),tn._$name="TagCombo";var rn=class extends ke{static render({domConfig:i,value:e,config:t}){let r;e&&(typeof e=="string"?r=e.split(t.separator||",").map(n=>({text:n})):Array.isArray(e)&&(r=e.map(n=>typeof n=="string"?{text:n}:{text:t.textProperty&&n[t.textProperty],cls:t.clsProperty&&n[t.clsProperty]})),r&&(i.children=r.map(n=>{const s="cls"in n?n.cls:D.makeValidId(n.text,"-").toLowerCase();return{class:{"b-taskboard-tags-tag":1,[s]:!!s},text:n.text}})))}};y(rn,"$name","TagsItem"),y(rn,"type","tags"),y(rn,"defaultEditor",{type:"tagcombo",pickerWidth:"10em"}),rn.initClass(),rn._$name="TagsItem";var nn=class extends ke{static render({domConfig:i,value:e,config:t,taskRecord:r}){const n=t.template({taskRecord:r,config:t,value:e});typeof n=="string"?i.html=n:x.isObject(n)?x.merge(i,n):Array.isArray(n)&&(i.children=n)}};y(nn,"$name","TemplateItem"),y(nn,"type","template"),y(nn,"defaultEditor",null),nn.initClass(),nn._$name="TemplateItem";var sn=class extends ke{static render({domConfig:i,value:e,config:t,taskRecord:r}){if(e){const{textField:n="text",checkedField:s="checked",clsField:a="cls",checkedIcon:l="b-icon b-icon-checked",uncheckedIcon:o="b-icon b-icon-unchecked"}=t;if(this.firstRender!==!1&&!r.getFieldDefinition(t.field).isArrayDataField)throw new Error('TodoListItem has to be mapped to a field with `type : "array"`');i.children=e.map((u,c)=>({class:{"b-taskboard-todolist-todo":1,[u[a]]:u[a],"b-checked":u[s]},children:{icon:{tag:"i",class:u[s]?l:o},text:{tag:"span",text:u[n]}},elementData:{index:c}})),this.firstRender=!1}}static onClick({source:i,taskRecord:e,event:t,config:r}){const n=t.target.closest(".b-taskboard-todolist-todo");if(n&&!e.readOnly){const{checkedField:s="checked",field:a}=r,{index:l}=n.elementData,o=e.getValue(a).slice(),u=o[l];u[s]=!u[s],e.setValue(a,o),i.trigger("todoToggle",{taskRecord:e,todo:u,checked:u[s],element:n,event:t}),t.preventDefault()}}static onDblClick({event:i}){i.preventDefault()}};y(sn,"$name","TodoListItem"),y(sn,"type","todoList"),y(sn,"defaultEditor",null),sn.initClass(),sn._$name="TodoListItem";var cm=i=>{var e;return e=class extends i.mixin(xf){static get $name(){return"CrudManagerView"}afterConstruct(){super.afterConstruct();const{crudManager:t,project:r}=this;this.loadMask&&(t||r).isCrudManagerLoading&&this.onCrudManagerLoadStart()}applySyncMask(){const{syncMask:t}=this;t&&(this.masked=xr.mergeConfigs(this.loadMaskDefaults,t))}bindCrudManager(t){this.detachListeners("crudManager");let r={};this.isTaskBoardBase||(r={beforeApplyResponse:"onCrudManagerBeforeApplyResponse",applyResponse:"onCrudManagerApplyResponse",beforeLoadCrudManagerData:"onCrudManagerBeforeLoadCrudManagerData",loadCrudManagerData:"onCrudManagerLoadCrudManagerData"}),t==null||t.ion({name:"crudManager",loadStart:"onCrudManagerLoadStart",beforeSend:"onCrudManagerBeforeSend",load:"onCrudManagerLoad",loadCanceled:"onCrudManagerLoadCanceled",syncStart:"onCrudManagerSyncStart",sync:"onCrudManagerSync",syncCanceled:"onCrudManagerSyncCanceled",requestFail:"onCrudManagerRequestFail",responseReceived:"onAjaxTransportResponseReceived",...r,thisObj:this})}onCrudManagerBeforeSend({params:t}){var r;(r=this.applyStartEndParameters)==null||r.call(this,t)}onCrudManagerLoadStart(){var t;this.applyLoadMask(),(t=this.toggleEmptyText)==null||t.call(this)}onCrudManagerSyncStart(){this.applySyncMask()}onCrudManagerBeforeApplyResponse(){this.suspendRefresh()}onCrudManagerApplyResponse(){this.resumeRefresh(!0)}onCrudManagerBeforeLoadCrudManagerData(){this.crudManager.applyingLoadResponse||this.suspendRefresh()}async onCrudManagerLoadCrudManagerData(){this.crudManager.applyingLoadResponse||(await this.project.commitAsync(),!this.isDestroyed&&this.resumeRefresh(!0))}onCrudManagerRequestFinalize(t=!0,r,n){var s;const a=this;t?(s=a.toggleEmptyText)==null||s.call(a):(a.masked||a.applyLoadMask(),a.applyMaskError(`<div class="b-grid-load-failure">
                    <div class="b-grid-load-fail">${a.L(`L{GridBase.${r}FailedMessage}`)}</div>
                    ${n&&n.message?`<div class="b-grid-load-fail">${a.L("L{CrudManagerView.serverResponseLabel}")} ${n.message}</div>`:""}
                </div>`))}onCrudManagerLoadCanceled(){this.onCrudManagerRequestFinalize(!0,"load")}onCrudManagerSyncCanceled(){this.onCrudManagerRequestFinalize(!0,"sync")}onCrudManagerLoad(){this.onCrudManagerRequestFinalize(!0,"load")}onCrudManagerSync(){this.onCrudManagerRequestFinalize(!0,"sync")}onCrudManagerRequestFail({requestType:t,response:r}){this.onCrudManagerRequestFinalize(!1,t,r)}onAjaxTransportResponseReceived(){const t=this;t.clearMaskDelay!=null?t.setTimeout(()=>t.masked=null,t.clearMaskDelay):t.masked=null}get widgetClass(){}},y(e,"config",{clearMaskDelay:null,testConfig:{clearMaskDelay:0}}),e},s0={localeName:"En",localeDesc:"English (US)",localeCode:"en-US",GridBase:{loadFailedMessage:"Data loading failed!",syncFailedMessage:"Data synchronization failed!"},CrudManagerView:{serverResponseLabel:"Server response:"},TaskBoard:{column:"column",columns:"columns",Columns:"Columns",swimlane:"swimlane",swimlanes:"swimlanes",Swimlanes:"Swimlanes",task:"task",tasks:"tasks",addTask:"Add L{TaskBoard.task}",cancel:"Cancel",changeColumn:"Change L{TaskBoard.column}",changeSwimlane:"Change L{TaskBoard.swimlane}",collapse:i=>`Collapse ${i}`,color:"Color",description:"Description",editTask:"Edit L{TaskBoard.task}",expand:i=>`Expand ${i}`,filterColumns:"Filter L{TaskBoard.columns}",filterSwimlanes:"Filter L{TaskBoard.swimlanes}",filterTasks:"Filter L{TaskBoard.tasks}",moveColumnLeft:"Move L{TaskBoard.column} left",moveColumnRight:"Move L{TaskBoard.column} right",name:"Name",newTaskName:"New L{TaskBoard.task}",removeTask:"Remove L{TaskBoard.task}",removeTasks:"Remove L{TaskBoard.tasks}",resources:"Resources",save:"Save",scrollToColumn:"Scroll to L{TaskBoard.column}",scrollToSwimlane:"Scroll to L{TaskBoard.swimlane}",zoom:"Zoom"},TodoListField:{add:"Add",newTodo:"New todo"},UndoRedo:{UndoLastAction:"Undo",RedoLastAction:"Redo"}},J0=We.publishLocale(s0),a0=(i,e)=>i.weight-e.weight,At=class extends pt.mixin(zl,sa,Tf,Kf,cm,Jg,qf,Qg,em,tm,rm,im,nm,sm,am,lm,om,um){constructor(){super(...arguments),y(this,"isInitiallyComposed",!1),y(this,"domTransitionSuspended",0),y(this,"columnRecomposeQueue",new Map)}onPaintOverride(){}onInternalPaint(...i){this.onPaintOverride()||super.onInternalPaint(...i)}changeResourceImagePath(i){return x.assertString(i,"resourceImagePath"),i}changeUseDomTransition(i){return x.assertBoolean(i,"useDomTransition"),i}changeStickyHeaders(i){return x.assertBoolean(i,"stickyHeaders"),i}changeScrollManager(i,e){return e==null||e.destroy(),i?Bo.new({element:this.element,owner:this},i):null}changeShowCountInHeader(i){return x.assertBoolean(i,"showCountInHeader"),i}changeTasksPerRow(i){return x.assertNumber(i,"tasksPerRow"),i}changeSwimlaneRenderer(i){return x.assertFunction(i,"swimlaneRenderer"),i}changeTaskRenderer(i){return x.assertFunction(i,"taskRenderer"),i}changeTaskSorterFn(i){return i===!0?a0:(i&&x.assertFunction(i,"taskSorterFn"),i)}queueColumnRecompose(i,e){this.columnRecomposeQueue.set(`${i.id}.-.${e==null?void 0:e.id}`,{columnRecord:i,swimlaneRecord:e}),this.recomposeColumns()}recomposeColumns(){for(const[,{columnRecord:i,swimlaneRecord:e}]of this.columnRecomposeQueue)this.recomposeColumn(i,e);this.columnRecomposeQueue.clear()}recomposeColumn(i,e){const t=this.getSwimlaneColumnElement(e,i),r=D.normalizeChildren(this.renderColumn(e,i));r.onlyChildren=!0,de.sync({targetElement:t,domConfig:r,callback:this.domSyncCallback,syncOptions:{syncIdField:"column",releaseThreshold:0}})}renderCard(i,e,t){var r,n,s;const a=super.renderCard(i,e,t);if(a)return a;const l=this,{id:o,domId:u,eventColor:c,weight:d}=i,h=c||(t==null?void 0:t.color)||e.color,g=D.isNamedColor(h)?h:null,f=l.getCardSize(e,t),m={id:`${l.id}-card-${u}`,class:{"b-taskboard-card":!0,[`b-taskboard-color-${g}`]:g,"b-readonly":i.readOnly,...i.cls},tabIndex:0,dataset:{task:u,column:e.id,lane:t==null?void 0:t.id,weight:d,domTransition:!0},style:{color:g?null:h,height:(n=(r=l.getTaskHeight)==null?void 0:r.call(l,i))!=null?n:null},elementData:{elementType:"task",taskId:o,taskRecord:i,columnRecord:e,swimlaneRecord:t},children:{header:{tag:"header",class:{"b-taskboard-card-header":1},children:{},syncOptions:{syncIdField:"role"}},body:{tag:"section",class:{"b-taskboard-card-body":1},children:{},syncOptions:{syncIdField:"role"}},footer:{tag:"footer",class:{"b-taskboard-card-footer":1},children:{},syncOptions:{syncIdField:"role"}}}},{children:p}=m,{header:v,body:b,footer:w}=p;return l.populateCard({taskRecord:i,columnRecord:e,swimlaneRecord:t,cardConfig:m,cardSize:f}),(s=l.taskRenderer)==null||s.call(l,{taskRecord:i,columnRecord:e,swimlaneRecord:t,cardConfig:m,cardSize:f}),v.html==null&&v.text==null&&(!v.children||Object.keys(v.children).length===0)&&(p.header=null),b.html==null&&b.text==null&&(!b.children||Object.keys(b.children).length===0)&&(p.body=null),w.html==null&&w.text==null&&(!w.children||Object.keys(w.children).length===0)&&(p.footer=null),m}renderColumnHeader(i){var e,t,r;const n=this,{text:s,id:a,domId:l,width:o,flex:u,minWidth:c,color:d,tooltip:h}=i,g=D.isNamedColor(d)?d:null,f={id:`${n.id}-column-header-${l}`,class:{"b-taskboard-column-header":1,"b-fixed-width":o&&!u,[`b-taskboard-color-${g}`]:g,"b-last":i===this.columns.last},style:{color:g?null:d,width:o,flex:u,minWidth:c},children:{padder:{class:{"b-taskboard-column-header-padder":1},children:{title:{class:{"b-taskboard-column-title":1},dataset:{btip:h},children:[{tag:"span",class:"b-column-title-text",text:s},n.showCountInHeader&&{tag:"span",class:{"b-taskboard-column-count":1},html:`(${(t=(e=n.getColumnTasks(i))==null?void 0:e.length)!=null?t:0})`}]}}}},dataset:{column:l,domTransition:!0},elementData:{elementType:"columnHeader",columnId:a}};return je.showOverflow=!0,n.populateColumnHeader({columnRecord:i,columnHeaderConfig:f}),(r=n.columnHeaderRenderer)==null||r.call(n,{columnRecord:i,columnHeaderConfig:f}),f}renderColumn(i,e){var t,r,n;const s=this,{taskSorterFn:a,stretchCards:l,columnField:o,swimlaneField:u}=s,{width:c,flex:d,id:h,domId:g,minWidth:f,color:m}=e,{taskStore:p}=s.project,v=p.isTree?p.query(T=>T[o]===h&&(!u||!i||T[u]===i.id)):Array.from(p.storage.findItem("columnSwimlaneIntersection",`${e.id}-/-${(t=i==null?void 0:i.id)!=null?t:"default"}`)||[]),b=s.getTasksPerRow(e,i),w=`${s.id}-column-${(r=i==null?void 0:i.domId)!=null?r:"default"}-${g}`,S=D.isNamedColor(m)?m:null,C={id:w,class:{"b-taskboard-column":1,"b-fixed-width":c&&!d,[`b-${b}-task${b>1?"s":""}-per-row`]:1,"b-inline":b>1,[`b-taskboard-color-${S}`]:S,"b-last":e===this.columns.last},style:{color:S?null:m,width:c,flex:d,minWidth:f},dataset:{column:g,lane:i==null?void 0:i.id,domTransition:!0},elementData:{elementType:"column",columnId:h,laneId:i==null?void 0:i.id},children:{body:{id:`${w}-body`,class:{"b-taskboard-column-body":1},dataset:{role:"body",domTransition:!0},children:[{class:{"b-taskboard-column-body-inner":1},style:{"grid-template-columns":`repeat(${l?Math.min(b,v.length):b}, 1fr)`},dataset:{role:"inner",domTransition:!0},children:(a?v.sort(a):v.sort((T,E)=>p.indexOf(T)-p.indexOf(E)),v.map(T=>s.renderCard(T,e,i))),syncOptions:{syncIdField:"task",releaseThreshold:s.isVirtualized?1e3:0}}],syncOptions:{syncIdField:"role"}}},syncOptions:{syncIdField:"role"}};return s.populateColumn({columnRecord:e,swimlaneRecord:i,columnConfig:C}),(n=s.columnRenderer)==null||n.call(s,{columnRecord:e,swimlaneRecord:i,columnConfig:C}),C}renderSwimlane(i){var e,t,r;const n=this,{showCountInHeader:s,columns:a}=n,{id:l="default",domId:o="default",text:u,height:c,flex:d,color:h}=i||{},g=`${n.id}-swimlane-${o}`,f=D.isNamedColor(h)?h:null,m={id:g,class:{"b-taskboard-swimlane":1,"b-fixed-height":c&&!d,"b-last":!i||i===n.swimlanes.last,[`b-taskboard-color-${f}`]:f},style:{color:f?null:h,height:c,flex:d},dataset:{lane:o,domTransition:!0},elementData:{elementType:"swimlane",laneId:l},children:{header:i&&{id:`${g}-header`,tag:"header",class:{"b-taskboard-swimlane-header":1},dataset:{role:"header",domTransition:"preserve-padding"},children:{title:{class:{"b-taskboard-swimlane-title":1},children:{text:u,count:s&&{tag:"span",class:{"b-taskboard-swimlane-count":1},text:`(${(t=(e=n.getSwimlaneTasks(i))==null?void 0:e.size)!=null?t:0})`}}}}},body:{id:`${g}-body`,class:{"b-taskboard-swimlane-body":1},dataset:{role:"body",domTransition:!0},children:a.map(p=>!p.hidden&&n.renderColumn(i,p)),syncOptions:{syncIdField:"column",releaseThreshold:0}}},syncOptions:{syncIdField:"role"}};return n.populateSwimlane({swimlaneRecord:i,swimlaneConfig:m}),(r=n.swimlaneRenderer)==null||r.call(n,{swimlaneRecord:i,swimlaneConfig:m}),m}get bodyConfig(){const i=this,{stickyHeaders:e,showCountInHeader:t,columns:r,columnField:n,swimlaneField:s,tasksPerRow:a,headerItems:l,bodyItems:o,footerItems:u,selectedTasks:c,showCollapseInHeader:d,showCollapseTooltip:h,taskSorterFn:g,stretchCards:f}=i;if(!i.rendered)return i.setTimeout(()=>i.recompose(),0),{reference:"bodyElement",listeners:x.assign({thisObj:i},i.domListeners)};const m={skipClone:!0,reference:"bodyElement",class:{"b-taskboard-body":1,"b-sticky-headers":e},children:[{tag:"header",id:`${i.id}-column-headers`,class:{"b-taskboard-column-headers":1},children:r.map(v=>!v.hidden&&i.renderColumnHeader(v)),dataset:{lane:"header",domTransition:!0},syncOptions:{syncIdField:"column"}}],syncOptions:{syncIdField:"lane",releaseThreshold:0,ignoreRefs:"children"}};let{swimlanes:p}=i;p!=null&&p.count||(p=[null]);for(const v of p)v!=null&&v.hidden||m.children.push(i.renderSwimlane(v));return i.populateBody({bodyConfig:m}),i.isComposed=!0,m}populateCard(i){var e;(e=super.populateCard)==null||e.call(this,i)}populateColumn(i){var e;(e=super.populateColumn)==null||e.call(this,i)}populateColumnHeader(i){var e;(e=super.populateColumnHeader)==null||e.call(this,i)}populateSwimlane(i){var e;(e=super.populateSwimlane)==null||e.call(this,i)}populateBody(i){var e;(e=super.populateBody)==null||e.call(this,i)}afterRecompose(){super.afterRecompose();const i=this;!i.isInitiallyComposed&&i.isComposed&&(i.isInitiallyComposed=!0,i.initialCompose()),i.project.taskStore.count>0&&i.trigger("renderTasks",{taskRecords:i.project.taskStore.allRecords}),i.transitionRecompose=null}initialCompose(){this.trigger("initialCompose")}onRenderColumn(){}onRemoveColumnElement(){}onRenderSwimlane(){}onRemoveSwimlaneElement(){}suspendDomTransition(){this.domTransitionSuspended++}resumeDomTransition(){this.domTransitionSuspended--}recomposeWithDomTransition(i){const e=this;e.useDomTransition&&!e.domTransitionSuspended&&(e.transitionRecompose={selector:"[data-dom-transition]",duration:300,element:e._bodyElement,...i}),e.recompose.suspended?e._recomposeQueued=!0:e.recompose()}resumeRecompose(){super.resumeRecompose(),this._recomposeQueued&&(this._recomposeQueued=null,this.recompose())}getCurrentConfig(i){const e=super.getCurrentConfig(i);return e.columns&&delete e.columns.modelClass,e}refresh(){this.recompose()}};y(At,"$name","TaskBoardBase"),y(At,"type","taskboardbase"),y(At,"featureable",{factory:Pe}),y(At,"configurable",{layout:"vbox",features:!0,taskRenderer:null,swimlaneRenderer:null,tasksPerRow:1,stretchCards:null,showCountInHeader:!0,stickyHeaders:!1,useDomTransition:!1,resourceImagePath:null,cssVarPrefix:"taskboard",scrollManager:{value:{},$config:["nullify","lazy"]},taskSorterFn:null,contentElMutationObserver:!1,textContent:!1,scrollable:!0}),y(At,"delayable",{recomposeColumns:"raf"}),At.initClass(),ie.setVersion("taskboard","5.6.2"),At._$name="TaskBoardBase";var Ps=class extends ke{static render({taskBoard:i,domConfig:e}){if(!i.features.taskMenu||i.features.taskMenu.disabled)return!1;e.tag="button",e.class["b-icon b-icon-menu-horizontal"]=1}static onClick({source:i,event:e}){var t;(t=i.features.taskMenu)==null||t.showContextMenu(e,{target:e.target})}};y(Ps,"$name","TaskMenuItem"),y(Ps,"type","taskMenu"),y(Ps,"defaultEditor",null),Ps.initClass(),Ps._$name="TaskMenuItem";var an=class extends At{};y(an,"$name","TaskBoard"),y(an,"type","taskboard"),y(an,"configurable",{features:{columnHeaderMenu:!0,columnToolbars:!0,taskDrag:!0,taskDragSelect:!0,taskEdit:!0,taskMenu:!0}}),an.initClass(),an._$name="TaskBoard";var ln=class extends or.mixin(Fe){};y(ln,"$name","ColumnFilterField"),y(ln,"type","columnfilterfield"),y(ln,"configurable",{store:"this.taskBoard.columns",field:"text",label:"L{TaskBoard.filterColumns}",width:"20em",triggers:{filter:{cls:"b-icon b-icon-filter",align:"start"}}}),ln.initClass(),ln._$name="ColumnFilterField";var on=class extends mt.mixin(Fe){onToggleColumn({item:i}){i.column.hidden=!i.checked}onMenuBeforeShow(i){super.onMenuBeforeShow(i),i.source.items=this.taskBoard.columns.map(e=>({ref:e.id,text:P.encodeHtml(e.text),checked:!e.hidden,column:e,onItem:"up.onToggleColumn"}))}};y(on,"$name","ColumnPickerButton"),y(on,"type","columnpickerbutton"),y(on,"configurable",{text:"L{TaskBoard.Columns}",icon:"b-icon-picker",pressedIcon:"b-icon-picker-rotated",iconAlign:"end",menuIcon:null,menu:{items:null}}),on.initClass(),on._$name="ColumnPickerButton";var un=class extends mt.mixin(Fe){onClickColumn({item:i}){this.setTimeout(()=>{var e;return(e=this.taskBoard)==null?void 0:e.scrollToColumn(i.column)},100)}changeMenu(i){return i&&(i=this.taskBoard.columns.map(e=>({ref:e.id,text:P.encodeHtml(e.text),column:e,onItem:"up.onClickColumn"}))),super.changeMenu(i)}};y(un,"$name","ColumnScrollButton"),y(un,"type","columnscrollbutton"),y(un,"configurable",{text:"L{TaskBoard.scrollToColumn}",icon:"b-icon-picker",pressedIcon:"b-icon-picker-rotated",iconAlign:"end",menuIcon:null,menu:[]}),un.initClass(),un._$name="ColumnScrollButton";var nl=class extends ze{static get $name(){return"ProjectCombo"}static get type(){return"projectcombo"}static get configurable(){return{project:null,displayField:"title",valueField:"url",highlightExternalChange:!1,editable:!1}}updateProject(i){var e;(e=i.transport.load)!=null&&e.url&&(this.value=i.transport.load.url)}onChange({value:i,userAction:e}){e&&this.project&&(this.project.transport.load.url=i,this.project.load())}};nl.initClass(),nl._$name="ProjectCombo";var cn=class extends nl.mixin(Fe){updateTaskBoard(i){i&&(this.project=i.project)}afterConfigure(){this._taskBoard||this.updateTaskBoard(this.taskBoard)}};y(cn,"$name","ProjectCombo"),y(cn,"type","taskboardprojectcombo"),y(cn,"configurable",{project:null}),cn.initClass(),cn._$name="ProjectCombo";var dn=class extends or.mixin(Fe){};y(dn,"$name","SwimlaneFilterField"),y(dn,"type","swimlanefilterfield"),y(dn,"configurable",{store:"this.taskBoard.swimlanes",field:"text",label:"L{TaskBoard.filterSwimlanes}",width:"20em",triggers:{filter:{cls:"b-icon b-icon-filter",align:"start"}}}),dn.initClass(),dn._$name="SwimlaneFilterField";var hn=class extends mt.mixin(Fe){onToggleSwimlane({item:i}){i.swimlane.hidden=!i.checked}onMenuBeforeShow(i){super.onMenuBeforeShow(i),i.source.items=this.taskBoard.swimlanes.map(e=>({ref:e.id,text:P.encodeHtml(e.text),checked:!e.hidden,swimlane:e,onItem:"up.onToggleSwimlane"}))}};y(hn,"$name","SwimlanePickerButton"),y(hn,"type","swimlanepickerbutton"),y(hn,"configurable",{text:"L{TaskBoard.Swimlanes}",icon:"b-icon-picker",pressedIcon:"b-icon-picker-rotated",iconAlign:"end",menuIcon:null,menu:{items:null}}),hn.initClass(),hn._$name="SwimlanePickerButton";var fn=class extends mt.mixin(Fe){onClickSwimlane({item:i}){this.setTimeout(()=>{var e;return(e=this.taskBoard)==null?void 0:e.scrollToSwimlane(i.swimlane)},100)}changeMenu(i){return i&&(i=this.taskBoard.swimlanes.map(e=>({ref:e.id,text:P.encodeHtml(e.text),swimlane:e,onItem:"up.onClickSwimlane"}))),super.changeMenu(i)}};y(fn,"$name","SwimlaneScrollButton"),y(fn,"type","swimlanescrollbutton"),y(fn,"configurable",{text:"L{TaskBoard.scrollToSwimlane}",icon:"b-icon-picker",pressedIcon:"b-icon-picker-rotated",iconAlign:"end",menuIcon:null,menu:[]}),fn.initClass(),fn._$name="SwimlaneScrollButton";var gn=class extends or.mixin(Fe){};y(gn,"$name","TaskFilterField"),y(gn,"type","taskfilterfield"),y(gn,"configurable",{store:"this.taskBoard.project.taskStore",field:"name",label:"L{TaskBoard.filterTasks}",width:"20em",triggers:{filter:{cls:"b-icon b-icon-filter",align:"start"}}}),gn.initClass(),gn._$name="TaskFilterField";var Jr=class extends De{compose(){const{editableItems:i}=this;return{class:{"b-editable":i}}}changeList(i){return j.create(x.assign({itemTpl:e=>P.xss`<div class="b-todo-text">${e.getValue(this.textField)}</div><i class='b-todo-edit b-icon b-icon-edit' data-noselect></i>`},i))}updateList(i){i.ion({item:"onItemClick",thisObj:this}),i.ion({selectionChange:"onSelectionChange",thisObj:this})}changeAddButton(i){const e=j.create(i);return this.ariaElement=e.element,e}updateAddButton(i){i.ion({click:"onAddClick",thisObj:this})}get childItems(){return[this.list,this.addButton]}get inputElement(){return this.list.element}get innerElements(){return super.innerElements.concat(this.addButton.element)}changeValue(i){i=i||[];let e=!1;return this.eachAncestor(t=>{if(t.autoUpdateRecord)return e=!0,!1}),this.originalValue=e?i:x.clone(i),i&&(i=x.clone(i),i.forEach((t,r)=>{t.id=r+1,t.originalIndex=r})),i}updateValue(i){if(i){const e=this;e.list.items=i,e.isSettingValue=!0,e.list.selected.values=i.filter(t=>t[e.checkedField]),e.isSettingValue=!1}}get value(){return this.originalValue.slice()}set value(i){super.value=i}get isValid(){return!0}editItem(i,e){const t=this,r=new sr({appendTo:t.element,owner:t,cls:"b-todo-editor",inputField:{type:"text",triggers:{remove:{cls:"b-todo-remove b-icon-trash",handler(){t.removeItem(i),r.cancelEdit()}}}},style:"z-index : 20000",internalListeners:{complete({value:n}){t.originalValue[i.originalIndex][t.textField]=n,t.triggerFieldChange({value:t.value,userAction:!0})},finishEdit(){r.destroy()},thisObj:t}});r.startEdit({target:e,record:i,field:t.textField})}removeItem(i){const e=this,{originalIndex:t}=i;e.list.store.forEach(r=>{r.parentIndex>i.parentIndex&&r.originalIndex--}),e.list.store.remove(i),e.originalValue.splice(t,1),e.triggerFieldChange({value:e.value,userAction:!0})}onSelectionChange(){const i=this,{list:e}=i;i.isSettingValue||(i.originalValue.forEach((t,r)=>{const n=e.store.getAt(r);n&&(t[i.checkedField]=e.selected.includes(n))}),i.triggerFieldChange({value:i.value,userAction:!0}))}onItemClick({record:i,event:e}){e.target.matches(".b-todo-edit")&&this.editItem(i,e.target.closest(".b-list-item"))}onAddClick(){const i=this;i.originalValue.push({[i.textField]:i.L("L{newTodo}"),[i.checkedField]:!1}),i.value=i.originalValue,i.triggerFieldChange({value:i.value,userAction:!0})}};y(Jr,"$name","TodoListField"),y(Jr,"type","todolistfield"),y(Jr,"alias","todolist"),y(Jr,"configurable",{textField:"text",checkedField:"checked",editableItems:!0,list:{type:"list",multiSelect:!0,store:{fields:[]},itemIconTpl(){return'<i class="b-todo-checkbox b-icon"></i>'}},addButton:{type:"button",cls:"b-todo-add",icon:"b-icon-add",text:"L{TodoListField.add}"},role:null}),Jr.initClass(),Jr._$name="TodoListField";var Fs=class extends Si.mixin(Fe){construct(){super.construct(...arguments),this.stm=this.taskBoard.project.stm}};y(Fs,"$name","UndoRedo"),y(Fs,"type","taskboardundoredo"),Fs.initClass(),Fs._$name="UndoRedo";var mn=class extends _i.mixin(Fe){calculateValue(i){return this.max-i+1}afterConstruct(){this.value=this.calculateValue(this.taskBoard.tasksPerRow)}onInput({value:i}){this.taskBoard.tasksPerRow=this.calculateValue(i)}updateValue(i){super.updateValue(i),this.onInput({value:i})}getTooltipHtml(i){const e=this.calculateValue(i);return`${e} card${e===1?"":"s"} per row`}};y(mn,"$name","ZoomSlider"),y(mn,"type","zoomslider"),y(mn,"configurable",{text:"L{TaskBoard.zoom}",max:10,min:1,value:null,showValue:!1}),mn.initClass(),mn._$name="ZoomSlider";var Nu=class extends F.mixin(Au){get revision(){return this.crudRevision}set revision(i){this.crudRevision=i}get json(){return P.safeJsonStringify(this)}set json(i){typeof i=="string"&&(i=P.safeJsonParse(i)),this.forEachCrudStore(e=>{const t=`${e.storeId}Data`;i[t]&&(e.data=i[t])})}static get defaultConfig(){return{stores:null}}construct(i={}){i.stores&&(i.crudStores=i.stores,delete i.stores),super.construct(i)}toJSON(){const i={};return this.forEachCrudStore((e,t)=>i[`${t}Data`]=e.toJSON()),i}get inlineData(){return this.toJSON()}set inlineData(i){this.json=i}set stores(i){i!==this.crudStores&&(this.crudStores=i)}get stores(){return this.crudStores}get isLoading(){return this.isCrudManagerLoading}addStore(...i){return this.addCrudStore(...i)}removeStore(...i){return this.removeCrudStore(...i)}getStore(...i){return this.getCrudStore(...i)}hasChanges(...i){return this.crudStoreHasChanges(...i)}loadData(...i){return this.loadCrudManagerData(...i)}};Nu._$name="AbstractCrudManager";var Bu=class extends Nu.mixin(Lu,Pu,Fu){static get defaultConfig(){return{projectClass:Gi,resourceStoreClass:rl,eventStoreClass:Ki,assignmentStoreClass:Rs,dependencyStoreClass:tl,resourceStore:{},eventStore:{},assignmentStore:{},dependencyStore:{},project:null}}buildProject(){return new this.projectClass(this.buildProjectConfig())}buildProjectConfig(){return x.cleanupProperties({eventStore:this.eventStore,resourceStore:this.resourceStore,assignmentStore:this.assignmentStore,dependencyStore:this.dependencyStore,resourceTimeRangeStore:this.resourceTimeRangeStore})}set project(i){const e=this;i!==e._project&&(e.detachListeners("beforeDataReady"),e.detachListeners("afterDataReady"),e._project=i,i&&(e.eventStore=i.eventStore,e.resourceStore=i.resourceStore,e.assignmentStore=i.assignmentStore,e.dependencyStore=i.dependencyStore,e.timeRangeStore=i.timeRangeStore,e.resourceTimeRangeStore=i.resourceTimeRangeStore,i.ion({name:"beforeDataReady",dataReady:()=>e.suspendChangeTracking(),prio:100,thisObj:e}),i.ion({name:"afterDataReady",dataReady:()=>e.resumeChangeTracking(),prio:-100,thisObj:e})),e.eventStore||(e.eventStore={}),e.resourceStore||(e.resourceStore={}),e.assignmentStore||(e.assignmentStore={}),e.dependencyStore||(e.dependencyStore={}))}get project(){return this._project}get timeRangeStore(){var i;return(i=this._timeRangeStore)==null?void 0:i.store}set timeRangeStore(i){var e;this.setFeaturedStore("_timeRangeStore",i,(e=this.project)==null?void 0:e.timeRangeStoreClass)}get resourceTimeRangeStore(){var i;return(i=this._resourceTimeRangeStore)==null?void 0:i.store}set resourceTimeRangeStore(i){var e;this.setFeaturedStore("_resourceTimeRangeStore",i,(e=this.project)==null?void 0:e.resourceTimeRangeStoreClass)}get resourceStore(){var i;return(i=this._resourceStore)==null?void 0:i.store}set resourceStore(i){const e=this;e.setFeaturedStore("_resourceStore",i,e.resourceStoreClass)}get eventStore(){var i;return(i=this._eventStore)==null?void 0:i.store}set eventStore(i){const e=this;e.setFeaturedStore("_eventStore",i,e.eventStoreClass)}get assignmentStore(){var i;return(i=this._assignmentStore)==null?void 0:i.store}set assignmentStore(i){this.setFeaturedStore("_assignmentStore",i,this.assignmentStoreClass)}get dependencyStore(){var i;return(i=this._dependencyStore)==null?void 0:i.store}set dependencyStore(i){this.setFeaturedStore("_dependencyStore",i,this.dependencyStoreClass)}setFeaturedStore(i,e,t){var r;const n=this,s=(r=n[i])==null?void 0:r.store;return s!==e&&(e=re.getStore(e,(e==null?void 0:e.storeClass)||t),s&&n.removeStore(s),n[i]=e&&{store:e}||null,n.addPrioritizedStore(n[i])),n[i]}getChangesetPackage(){var i,e;const t=super.getChangesetPackage();return t&&(this.eventStore.usesSingleAssignment||(e=(i=this.eventStore.modelClass.fieldMap)==null?void 0:i.resourceIds)!=null&&e.persist)&&(delete t[this.assignmentStore.storeId],!this.crudStores.some(r=>t[r.storeId]))?null:t}get crudLoadValidationMandatoryStores(){return[this._eventStore.storeId,this._resourceStore.storeId]}};y(Bu,"$name","CrudManager"),Bu._$name="CrudManager";export{fg as AbstractAssignmentStoreMixin,gg as AbstractCalendarManagerStoreMixin,cg as AbstractCalendarMixin,Nu as AbstractCrudManager,Au as AbstractCrudManagerMixin,Gg as AbstractCrudManagerValidation,mg as AbstractDependencyStoreMixin,pg as AbstractEventStoreMixin,dg as AbstractHasAssignmentsMixin,Wa as AbstractPartOfProjectGenericMixin,bs as AbstractPartOfProjectModelMixin,nt as AbstractPartOfProjectStoreMixin,vg as AbstractResourceStoreMixin,kt as ActionBase,no as AddAction,Vt as AjaxHelper,Xe as AjaxStore,Pu as AjaxTransport,Ae as Animator,Mn as ArrayDataField,z as ArrayHelper,Ms as AssignmentModel,Ng as AssignmentModelMixin,Rs as AssignmentStore,Kg as AssignmentStoreMixin,Us as AsyncHelper,ms as AvatarRendering,To as Badge,Fn as Bag,F as Base,rs as BooleanCombo,li as BooleanDataField,U as BrowserHelper,mt as Button,Uo as ButtonGroup,cr as CI,pu as CIFromSetOrArrayOrValue,uo as CSSHelper,fu as CalendarCache,ig as CalendarCacheInterval,ng as CalendarCacheIntervalMultiple,ag as CalendarCacheMultiple,lg as CalendarCacheSingle,mu as CalendarIntervalMixin,og as CalendarIntervalStore,Je as CalendarIteratorResult,tr as CalendarPanel,rr as Checkbox,bi as ChipView,dS as ChronoMixinBase,ba as ClickRepeater,Ub as Clipboardable,Wn as CollapseTool,wr as Collection,Oe as CollectionFilter,An as CollectionSorter,Ur as ColorBoxCombo,Fr as ColorField,Pr as ColorPicker,Cs as ColumnCombo,Vi as ColumnDrag,ln as ColumnFilterField,jr as ColumnHeaderMenu,ws as ColumnModel,on as ColumnPickerButton,un as ColumnScrollButton,zr as ColumnToolbars,ze as Combo,me as Config,hu as ConstraintIntervalSide,su as ConstraintType,Be as Container,xa as ContextMenuBase,Ua as CoreAssignmentMixin,vu as CoreAssignmentStoreMixin,bg as CoreCalendarManagerStoreMixin,yu as CoreCalendarMixin,qa as CoreDependencyMixin,bu as CoreDependencyStoreMixin,_t as CoreEventMixin,Cu as CoreEventStoreMixin,Sg as CoreHasAssignmentsMixin,wg as CoreHasDependenciesMixin,Ha as CorePartOfProjectGenericMixin,$i as CorePartOfProjectModelMixin,Bi as CorePartOfProjectStoreMixin,Ni as CoreResourceMixin,Su as CoreResourceStoreMixin,Bu as CrudManager,cm as CrudManagerView,Ge as DataField,vf as DataGenerator,ql as DateDataField,Ti as DateField,k as DateHelper,Di as DatePicker,$r as DateTimeField,it as DayTime,xe as Delayable,Dg as DelayableWrapper,yf as DemoBot,uu as DependenciesCalendar,ks as DependencyBaseModel,Is as DependencyModel,tl as DependencyStore,Ug as DependencyStoreMixin,ou as DependencyType,lu as DependencyValidationResult,du as Direction,wi as DisplayField,J as DomClassList,Dr as DomDataStore,D as DomHelper,de as DomSync,yi as DragContext,uf as DragHelper,Zn as DragProxy,jo as DragTipProxy,Ra as Draggable,_a as Droppable,Re as Duration,Ei as DurationField,Ir as DynamicObject,Br as EdgeInclusion,sr as Editor,$ as EventHelper,Ui as EventModel,Lg as EventModelMixin,Ki as EventStore,Bg as EventStoreMixin,fe as Events,Jg as ExpandCollapse,Et as Factoryable,Tf as Featureable,Mf as Fencible,De as Field,ts as FieldContainer,qo as FieldFilterPicker,Ko as FieldFilterPickerGroup,Ii as FieldSet,ns as FileField,ss as FilePicker,or as FilterField,wf as Finalizable,Xn as Formatter,ft as Fullscreen,ue as FunctionHelper,Vg as GetEventsMixin,Me as GlobalEvents,Qa as GridRowModel,Fi as Histogram,Xb as Hoverable,On as IdHelper,ai as Identifiable,Zi as ImageItem,Vr as IndexPosition,so as InsertAction,ro as InsertChildAction,Ut as InstancePlugin,oi as IntegerDataField,gu as IntervalCache,Fu as JsonEncoder,Ji as JsxItem,Mh as KeyMap,ki as Label,zo as Labelable,gt as Layout,yt as List,xf as LoadMaskable,We as LocaleHelper,Te as LocaleManager,bn as Localizable,dr as MAX_DATE,eg as MI,Nr as MIN_DATE,xr as Mask,Zt as Menu,Or as MenuItem,_C as MessageDialog,$C as Minifiable,Q as Model,la as ModelDataField,gd as ModelLink,dd as ModelStm,Jn as Month,pi as Navigator,ui as NumberDataField,xi as NumberField,vi as NumberFormat,Kl as ObjectDataField,x as ObjectHelper,H as Objects,Ef as Override,as as PagingToolbar,pt as Panel,It as PanelCollapser,ls as PanelCollapserOverlay,dC as Parser,Ot as PartOfProject,Mi as PasswordField,Qt as PickerField,zl as Pluggable,ot as Point,_r as Popup,Zr as ProgressItem,cn as ProjectCombo,nu as ProjectConstraintResolution,Lu as ProjectCrudManager,il as ProjectModel,kg as ProjectModelCommon,Pg as ProjectModelMixin,Ag as ProjectModelTimeZoneMixin,cu as ProjectType,pa as Promissory,Rh as RTL,Ri as Radio,os as RadioGroup,mi as RandomGenerator,Qi as RatingItem,V as Rectangle,Ru as RecurrenceModel,Yg as RecurringEventsMixin,Xa as RecurringTimeSpan,Za as RecurringTimeSpansMixin,ao as RemoveAction,lo as RemoveAllAction,io as RemoveChildAction,Bn as Renderable,Ro as ResizeHelper,Ee as ResizeMonitor,Xi as ResourceAvatarsItem,qi as ResourceModel,$g as ResourceModelMixin,rl as ResourceStore,qg as ResourceStoreMixin,gr as ResourceTimeRangeModel,Ja as ResourceTimeRangeStore,zi as ResourcesCombo,qf as Responsive,Qg as ResponsiveCards,jn as Ripple,Ca as Rotatable,gs as Scale,Ka as SchedulerCoreEvent,Tg as SchedulerCoreProjectMixin,nl as SchedulerProjectCombo,Gi as SchedulerProjectModel,au as SchedulingMode,Bo as ScrollManager,Gt as Scroller,en as SeparatorItem,Wr as SimpleTaskEdit,us as SlideToggle,_i as Slider,sg as SortedMap,cs as Splitter,sa as State,qt as StateBase,In as StateProvider,si as StateStorage,oo as StateTrackingManager,re as Store,xd as StoreCRUD,Ld as StoreChained,Ed as StoreChanges,Rn as StoreDataField,kd as StoreFilter,Id as StoreGroup,Md as StoreProxy,Rd as StoreRelation,Ad as StoreSearch,Pd as StoreSort,$d as StoreState,jd as StoreStm,_d as StoreSum,Bd as StoreSync,Nd as StoreTree,aa as StringDataField,P as StringHelper,Kf as Styleable,Ss as SwimlaneCombo,ji as SwimlaneDrag,dn as SwimlaneFilterField,Os as SwimlaneModel,hn as SwimlanePickerButton,fn as SwimlaneScrollButton,Oi as Tab,ds as TabBar,Ai as TabPanel,tn as TagCombo,rn as TagsItem,an as TaskBoard,At as TaskBoardBase,em as TaskBoardColumns,tm as TaskBoardDom,rm as TaskBoardDomEvents,Pe as TaskBoardFeature,Fe as TaskBoardLinked,im as TaskBoardScroll,nm as TaskBoardStores,sm as TaskBoardSwimlanes,am as TaskBoardVirtualization,Hi as TaskColorCombo,Wi as TaskColorPicker,Hr as TaskDrag,Yr as TaskDragSelect,qr as TaskEdit,Yi as TaskEditor,gn as TaskFilterField,ke as TaskItem,lm as TaskItems,Kr as TaskMenu,Xr as TaskModel,om as TaskNavigation,um as TaskSelection,_s as TaskStore,Gr as TaskTooltip,gi as TemplateHelper,nn as TemplateItem,Pi as TextAreaField,eu as TextAreaPickerField,vt as TextField,As as TextItem,nr as TimeField,Lr as TimePicker,xs as TimeRangeModel,Es as TimeRangeStore,hr as TimeSpan,Li as TimeUnit,Ve as TimeZoneHelper,Ig as TimeZonedDatesMixin,Kn as Toast,Jr as TodoListField,sn as TodoListItem,kr as Tool,Do as Toolable,Un as Toolbar,je as Tooltip,fa as Transaction,hd as TreeNode,Fs as UndoRedo,Si as UndoRedoBase,ug as UnspecifiedTimeIntervalModel,to as UpdateAction,ie as VersionHelper,ca as WalkHelper,ua as Wbs,Ia as WebSocketManager,j as Widget,mf as WidgetHelper,pf as XMLHelper,ir as YearPicker,mn as ZoomSlider,ys as binarySearch,mS as combineCalendars,hg as delay,vS as format,fS as isDateFinite,hS as isEqualEffectiveDirection,pS as isNotNumber,tu as later,vs as stripDuplicates,xt as unitMagnitudes};
//# sourceMappingURL=taskboard.module.min.js.map
