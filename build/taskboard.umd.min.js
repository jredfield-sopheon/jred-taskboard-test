/*!
 *
 * Bryntum TaskBoard 5.6.2
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(((e="undefined"!=typeof globalThis?globalThis:e||self).bryntum=e.bryntum||{},e.bryntum.taskboard={}))}(this,(function(e){"use strict";const t="taskboard";var n;class r{static supportsPointerEvents=Boolean(globalThis.PointerEvent||globalThis.MSPointerEvent);static supportsPointerEventConstructor="undefined"!=typeof PointerEvent;static PointerEventConstructor=globalThis.PointerEvent||globalThis.CustomEvent;static isPhone=null===(n=globalThis.matchMedia)||void 0===n?void 0:n.call(globalThis,"(max-height:414px) or (max-width:414px)").matches;static cacheFlags(e=navigator.platform,t=navigator.userAgent){const n=this;n._isLinux=Boolean(e.match(/Linux/)),n._isMac=Boolean(e.match(/Mac/)),n._isWindows=Boolean(e.match(/Win32/)),n._isMobile=Boolean(t.match(/Mobile|Opera Mini|Opera Mobi|Puffin/)||"number"==typeof globalThis.orientation),n._isWebkit=Boolean(t.match(/WebKit/)&&!t.match(/Edg/)),n._firefoxVersion=n.getVersion(t,/Firefox\/(\d+)\./),n._isFirefox=n._firefoxVersion>0,n._chromeVersion=n.getVersion(t,/Chrom(?:e|ium)\/(\d+)\./),n._isChrome=n._chromeVersion>0,n._isSafari=Boolean(t.match(/Safari/))&&!n._isChrome,n._isMobileSafari=Boolean(t.match(/Mobile.*Safari/)),n._safariVersion=n.getVersion(t,/Version\/(.*).Safari/),n._isAndroid=Boolean(t.match(/Android/g))}static get supportsOverflowClip(){if(null==this._supportsOverflowClip){const e=document.createElement("div");e.style.overflow="clip",e.style.display="none",document.documentElement.appendChild(e),this._supportsOverflowClip="clip"===e.ownerDocument.defaultView.getComputedStyle(e).getPropertyValue("overflow"),e.remove()}return this._supportsOverflowClip}static get supportsSticky(){return!0}static getVersion(e,t){const n=e.match(t);return n?parseFloat(n[1]):0}static get isTouchDevice(){return void 0===this._isTouchDevice&&(this._isTouchDevice=globalThis.matchMedia("(pointer:coarse)").matches),this._isTouchDevice}static get isHoverableDevice(){return void 0===this._isHoverableDevice&&(this._isHoverableDevice=globalThis.matchMedia("(any-hover: hover)").matches),this._isHoverableDevice}static get isBrowserEnv(){return"undefined"!=typeof window}static get isMac(){return this._isMac}static get isWindows(){return this._isWindows}static get isLinux(){return this._isLinux}static get isAndroid(){return this._isAndroid}static get isWebkit(){return this._isWebkit}static get isChrome(){return this._isChrome}static get chromeVersion(){return this._chromeVersion}static get isFirefox(){return this._isFirefox}static get firefoxVersion(){return this._firefoxVersion}static get isSafari(){return this._isSafari}static get safariVersion(){return this._safariVersion}static get isMobileSafari(){return this._isMobileSafari}static get isMobile(){return this._isMobile}static get platform(){const e=this;return e._isLinux?"linux":e._isMac?"mac":e._isWindows?"windows":e._isAndroid?"android":e._isMobileSafari?"ios":null}static get supportsPassive(){return!0}static get supportsRandomUUID(){if(void 0===this._supportsRandomUUID)try{this._supportsRandomUUID=Boolean(globalThis.crypto.randomUUID().length>0)}catch(e){this._supportsRandomUUID=!1}return this._supportsRandomUUID}static get storageAvailable(){let e,t;try{return e=localStorage,t="__storage_test__",e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==e.length}}static setLocalStorageItem(e,t){this.storageAvailable&&localStorage.setItem(e,t)}static getLocalStorageItem(e){return this.storageAvailable&&localStorage.getItem(e)}static removeLocalStorageItem(e){this.storageAvailable&&localStorage.removeItem(e)}static searchParam(e,t=null,n=document.location.search){const r=new RegExp(`[?&]${e}=?([^&]*)`),s=n.match(r);return s&&s[1]||t}static getCookie(e){const t=encodeURIComponent(e)+"=",n=document.cookie.split(";");for(let e=0;e<n.length;e++){let r=n[e];for(;" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(t))return decodeURIComponent(r.substring(t.length,r.length))}return""}static download(e,t){const n=document.createElement("a");n.download=e,n.href=t||e,n.style.cssText="display:none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}static downloadBlob(e,t){const n=globalThis.URL.createObjectURL(e);this.download(t,n),globalThis.URL.revokeObjectURL(n)}static get queryString(){var e;const t=new URL(globalThis.location.href).searchParams;return null===(e=Object.fromEntries)||void 0===e?void 0:e.call(Object,t.entries())}static copyToClipboard(e){let t=!0;const n=document.createElement("textarea");n.value=e,n.style.height=n.style.width=0,document.body.appendChild(n),n.select();try{document.execCommand("copy")}catch(e){t=!1}return n.remove(),t}static isBryntumOnline(e){var t;return e=Array.isArray(e)?e:[e],Boolean(/^(www\.)?bryntum\.com/.test(globalThis.location.host)||(null===(t=e)||void 0===t?void 0:t.some((e=>null!=this.queryString[e]))))}static get isCSP(){const{bryntum:e,document:t}=globalThis;return null==e.CSP&&(e.CSP=Boolean(t.querySelector('meta[http-equiv="Content-Security-Policy"]'))),e.CSP}}let s,i,a,o;r.isBrowserEnv&&r.cacheFlags(),r._$name="BrowserHelper";const l=/([a-z])([A-Z])/g,c=/[\n\r]/g,d=/[.*+?^${}()|[\]\\]/g,u=/[&<]/,h=/(^[^a-z]+[^\w]+)/gi,g=/\s+/,m=/^[^a-z]+|[^\w:.-]+/gi,p=(e,t)=>i[t.toLowerCase()]||String.fromCharCode(parseInt(t.substr(2),10)),f=(e,t)=>s[t],v=(e,t,n)=>`${t}-${n.toLowerCase()}`,y=(e,t,n)=>`${t} ${n.toLowerCase()}`,b=e=>e?`_x${[...e].map((e=>e.charCodeAt(0).toString(16))).join("")}`:"__blank__",C={},S={},w=[],D=function(e,t){if(t&&"object"==typeof t){for(;w.length&&w[w.length-1]!==this;)w.pop();if(w.includes(t))return"[Circular]";w.push(t)}return t};class T{static capitalize(e){return e&&e[0].toUpperCase()+e.substr(1)}static uncapitalize(e){return e&&e[0].toLowerCase()+e.substr(1)}static hyphenate(e){const t=C[e];return t||(C[e]=e.replace(l,v))}static separate(e){const t=S[e];return t||(S[e]=this.capitalize(e.replace(l,y)))}static createId(e){return String(e).replace(h,b)}static makeValidDomId(e,t=""){return null==e?null:String(e).replace(m,t)}static escapeRegExp(e,t){let n=e.replace(d,"\\$&");return void 0!==t&&(n=new RegExp(n,t)),n}static decodeHtml(e){return e&&String(e).replace(o,p)}static encodeHtml(e=""){return e&&String(e).replace(a,f)}static encodeHtmlBR(e){var t;return null===(t=T.encodeHtml(e))||void 0===t?void 0:t.replace(c,"<br>")}static isHtml(e){return"string"==typeof e&&u.test(e||"")}static initHtmlEntities(e){e=e||{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};const t=Object.keys(e);s=e,i=t.reduce(((t,n)=>(t[e[n]]=n,t)),{}),a=new RegExp(`([${t.map((e=>"[-]".includes(e)?"\\"+e:e)).join("")}])`,"g"),o=new RegExp(`(${Object.values(e).join("|")}|&#[0-9]+;)`,"ig")}static safeJsonParse(e){let t=null;try{t=JSON.parse(e)}catch(e){}return t}static safeJsonStringify(e,t=null,n=null){let r=null;try{"circular"===t&&(w.length=0,t=D),r=JSON.stringify(e,t,n)}catch{}return r}static joinPaths(e,t="/"){return e.join(t).replace(new RegExp("\\"+t+"+","g"),t)}static split(e,t=g){let n=e;return"string"==typeof n&&(n=e.trim(),n=n?n.split(t):[]),n}static xss(e,...t){const n=[];let r=t.length;for(n[r]=e[r];r-- >0;)n[r]=e[r]+T.encodeHtml(t[r]);return n.join("")}static xssBR(e,...t){const n=[];let r=t.length;for(n[r]=e[r];r-- >0;)n[r]=e[r]+T.encodeHtmlBR(t[r]);return n.join("")}static toJavaScriptValue(e,t){const n=F.typeOf(e);if("boolean"===n||"string"===n||"number"===n||null===e)return T.safeJsonStringify(e);if(e===globalThis)return"window";if("date"===n)return`new Date(${e.getFullYear()}, ${e.getMonth()}, ${e.getDate()}, ${e.getHours()}, ${e.getMinutes()}, ${e.getSeconds()}, ${e.getMilliseconds()})`;if("array"===n)return`[${e.map((e=>T.toJavaScriptValue(e,t)))}]`;if("object"===n||"instance"===n)return this.toJavaScriptString(e,t);if("function"===n){let t=e.toString();return t.match(/^async (\w+?)\(/)?t=t.replace(/^async (\w+?)\(/,"async function("):!t.startsWith("async(")&&t.match(/^(\w+?)\(/)&&(t=t.replace(/^(\w+?)\(/,"function(")),t}return"class"===n?e.toJavaScriptValue?e.toJavaScriptValue(t):Object.prototype.hasOwnProperty.call(e,"$name")?e.$name:e.name:void 0}static toJavaScriptString(e,t={}){const n=t.level??0;return"{\n"+Object.keys(e).map((r=>" ".repeat(2*(n+1))+(r.match(/[- *]/)?`"${r}"`:r)+`: ${T.toJavaScriptValue(e[r],{...t,level:n+1})}`)).join(",\n")+"\n"+" ".repeat(2*n)+"}"}static encodeAttributeSelector(e,t){return`[${e}="${String(t).replace(/["\\]/g,"\\$&")}"]`}static fakeNodeUUIDIndex=0;static generateUUID(){var e;return r.supportsRandomUUID?globalThis.crypto.randomUUID():null!==(e=globalThis.crypto)&&void 0!==e&&e.getRandomValues?([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^globalThis.crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))):`${Date.now()}-${++T.fakeNodeUUIDIndex}`}}T.initHtmlEntities(),T._$name="StringHelper";const{hasOwnProperty:E,toString:x}=Object.prototype,{isFrozen:k}=Object,I=/\s*<\s*/,R=/\s*>\s*/,M={},O={},A=Object.freeze({});class F{static assign(e,...t){for(let n,r,s=0;s<t.length;s++)if(n=t[s],n)for(r in n)e[r]=n[r];return e}static assignIf(e,...t){for(let n,r,s=0;s<t.length;s++)if(n=t[s],n)for(r in n)r in e&&void 0!==e[r]||(e[r]=n[r]);return e}static blend(e,t,n){n=n||M,e=e||{};const{clone:r=F.clone,merge:s=F.blend}=n;if(Array.isArray(t)){if(t.length>1)return t.forEach((t=>{e=F.blend(e,t,n)})),e;t=t[0]}if(t){let i,a,o;for(a in t)o=t[a],o&&F.isObject(o)&&(i=e[a],n.key=a,i&&F.isObject(i)?(k(i)&&(e[a]=i=r(i,n)),o=s(i,o,n)):o=k(o)?o:r(o,n)),e[a]=o}return e}static clone(e,t){let n,r=e;if(e&&"object"==typeof e){if(t&&"object"==typeof t&&t&&(t=null),F.isObject(e))if(e.skipClone)r=e;else for(n in r={},e)r[n]=F.clone(e[n]);else if(Array.isArray(e))for(r=[],n=e.length;n-- >0;)r[n]=F.clone(e[n]);else F.isDate(e)?r=new Date(e.getTime()):t&&(r=t(e))}return r}static createTruthyKeys(e){const t=T.split(e),n=t&&{};if(t)for(const e of t)e&&(n[e]=!0);return n}static getPath(e,t){return t.split(".").reduce(((e,t)=>(e||A)[t]),e)}static getPathDefault(e,t,n){const r=Array.isArray(t)?t:"string"==typeof t?t.split("."):[t],s=r.length-1;return r.reduce(((e,t,r)=>(n&&!(t in e)&&(e[t]=r===s?n:{}),(e||A)[t])),e)}static hasPath(e,t){return t.split(".").every((t=>!(!e||!(t in e))&&(e=e[t],!0)))}static getTruthyKeys(e){const t=[];for(const n in e)e[n]&&t.push(n);return t}static getTruthyValues(e){const t=[];for(const n in e)e[n]&&t.push(e[n]);return t}static isClass(e){var t;return"function"==typeof e&&(null===(t=e.prototype)||void 0===t?void 0:t.constructor)===e}static isDate(e){return Boolean(null==e?void 0:e.getUTCDate)&&"date"===F.typeOf(e)}static isPromise(e){if(Promise&&Promise.resolve)return Promise.resolve(e)===e||"function"==typeof(null==e?void 0:e.then);throw new Error("Promise not supported in your environment")}static isEmpty(e){if(e&&"object"==typeof e)for(const t in e)return!1;return!0}static isObject(e){const t=null==e?void 0:e.constructor;return Boolean(t?t===Object||t.getPrototypeOf&&t.prototype&&!Object.getPrototypeOf(t.prototype):e&&"object"==typeof e)}static isInstantiated(e){return!!e&&("object"==typeof e&&!F.isObject(e))}static merge(e,...t){return F.blend(e,t)}static mergeItems(e,t,n){let r,s,i,a,o,l,c;n=n||M;const{merge:d=F.blend}=n;if(e=e||{},Array.isArray(t))t.forEach((t=>{e=F.mergeItems(e,t,n)}));else if(t)for(o in t)if(c=t[o],r=null,o.includes(">")?([o,r]=o.split(R),s=0):o.includes("<")&&([r,o]=o.split(I),s=1),o in e)c&&e[o]&&d&&(n.key=o,c=d(e[o],c,n)),e[o]=c;else if(r){if(!a){a=new Map,i=0;for(const t in e)a.set(t,i++)}if(i=a.get(r),e[o]=c,null==i&&s)i=a.size;else{l=l||[],i=(i||0)+s;for(const e of a){const[t,n]=e;i<=n&&(l&&(l[a.size-n-1]=t),a.set(t,n+1))}if(l)for(;l.length;){const t=l.pop(),n=e[t];delete e[t],e[t]=n}}a.set(o,i)}else{var u;e[o]=c,null===(u=a)||void 0===u||u.set(o,a.size)}return e}static setPath(e,t,n){return t.split(".").reduce(((e,t,r,s)=>r===s.length-1?e[t]=n:(e[t]instanceof Object||(e[t]={}),e[t])),e),e}static typeOf(e){let t,n;return null===e?n="null":e!=e?n="nan":(n=typeof e,"object"===n?e.isBase?n="instance":Array.isArray(e)?n="array":(n=O[t=x.call(e)])||(O[t]=n=t.slice(8,-1).toLowerCase()):"function"===n&&e.isBase&&(n="class")),n}}Object.defineProperty(F,"hasOwn",{value:Object.hasOwn||((e,t)=>E.call(e,t))}),F._$name="Objects";class P{static setVersion(e,n){e=e.toLowerCase(),L[e]={version:n,isNewerThan:e=>P.semanticCompareVersion(e,n,"<"),isOlderThan:e=>P.semanticCompareVersion(e,n,">")};let s="";s=t;const i=`${s}.${e}${n.replace(/\./g,"-")}`;if(r.isBrowserEnv&&!globalThis.bryntum.silenceBundleException)if(!0===globalThis.bryntum[i]){if(!this.isTestEnv){let t=s||e;"core"===t&&(t="grid");let n=T.capitalize(t);throw"schedulerpro"===t&&(n="SchedulerPro"),new Error(`The Bryntum ${n} bundle was loaded multiple times by the application.\n\nCommon reasons you are getting this error includes:\n\n* Imports point to different types of the bundle (e.g. *.module.js and *.umd.js)\n* Imports point to both sources and bundle\n* Imports do not use the shortest relative path, JS treats them as different files\n* Cache busters differ between imports, JS treats ${t}.module.js?1 and ${t}.module.js?2 as different files\n* Imports missing file type, verify they all end in .js\n\nSee https://bryntum.com/products/${t}/docs/guide/${n}/gettingstarted/es6bundle#troubleshooting for more information\n\n`)}globalThis.BUNDLE_EXCEPTION=!0}else globalThis.bryntum[i]=!0}static getVersion(e){if(e=e.toLowerCase(),!L[e])throw new Error("No version specified! Please check that you import VersionHelper correctly into the class from where you call `deprecate` function.");return L[e].version}static semanticCompareVersion(e,t,n="="){t=t||"";const r=(e=e||"").split(/[-.]/),s=t.split(/[-.]/),i=n.includes("<"),a=(e,t)=>{const n=["rc","beta","alpha"],r=e.map((e=>{if(n.includes(e))return-n.indexOf(e)-2;const t=Number.parseInt(e);return Number.isNaN(t)?-n.length:t}));for(;r.length<t;)r.push(-1);return r},o=()=>{const e=Math.max(r.length,s.length),t=a(r,e),n=a(s,e);for(let r=0;r<e;r++)if(t[r]!==n[r])return i?t[r]<n[r]:t[r]>n[r];return!0};switch(n){case"=":return e===t;case"<=":case">=":return e===t||o();case"<":case">":return e!==t&&o()}return!1}static checkVersion(e,t,n){return P.semanticCompareVersion(L.getVersion(e),t,n)}static deprecate(e,t,n){if(!L.checkVersion(e,t,"<"))throw new Error(`Deprecated API use. ${n}`);console.warn(`Deprecation warning: You are using a deprecated API which will change in v${t}. ${n}`)}static get isTestEnv(){var e;const t=Boolean(null===(e=globalThis.bryntum)||void 0===e?void 0:e.isTestEnv);try{var n,r;return t||Boolean(null===(n=globalThis.parent)||void 0===n||null===(r=n.bryntum)||void 0===r?void 0:r.isTestEnv)}catch(e){return t}}static get isDebug(){return!1}}const L=P;r.isBrowserEnv&&(L.isTestEnv&&(r._isHoverableDevice=!0),globalThis.bryntum=Object.assign(globalThis.bryntum||{},{getVersion:L.getVersion.bind(L),checkVersion:L.checkVersion.bind(L),deprecate:L.deprecate.bind(L),license:"%LICENSE%"})),P._$name="VersionHelper";const{defineProperty:$,getOwnPropertyDescriptor:_}=Reflect,{hasOwnProperty:N,toString:j}=Object.prototype,V=Symbol("instanceProperties"),B=Symbol("configuring"),z=Symbol("lazyConfigValues"),W=j.call(new Date),H=/\s+/,U=(e,t)=>(e[t]=1,e);class Y{static get(e,t){const{cache:n}=this,r=n[e]||(n[e]=new Y(e));let s,i=r;return t&&(s=Y.makeCacheKey(e,t),(i=s&&n[s])||(i=r.extend(t),s&&(n[s]=i))),i}constructor(e){const t=this,n=e[0].toUpperCase()+e.substr(1);t.base=t,t.name=e,t.field="_"+e,t.capName=n,t.changer="change"+n,t.initializing="initializing"+n,t.updater="update"+n}get descriptor(){let e=this._descriptor;return e&&N.call(this,"_descriptor")||(this._descriptor=e=this.makeDescriptor()),e}get initDescriptor(){let e=this._initDescriptor;return e&&N.call(this,"_initDescriptor")||(this._initDescriptor=e=this.makeInitter()),e}equal(e,t){return e===t}extend(e){const t=Object.assign(Object.create(this),e),{equal:n,merge:r}=e,{equalityMethods:s}=Y;return"string"==typeof n&&(n.endsWith("[]")?t.equal=Y.makeArrayEquals(s[n.substr(0,n.length-2)]):t.equal=s[n]),"string"==typeof r&&(t.merge=Y.mergeMethods[r]),t}define(e){const t=_(e,this.name);let n=this.descriptor;t&&t.get&&(n=Object.assign({},n),n.get=t.get),$(e,this.name,n)}defineInitter(e,t){const{name:n}=this,r=e[V];let s,i;r[n]||!(i=_(e,n))||"value"in i||(r[n]=i),$(e,n,this.initDescriptor),this.lazy&&(s=e[z]||(e[z]=new Map),s.set(n,t))}static makeArrayEquals(e){return(t,n)=>{let r,s=t&&n&&t.length===(r=n.length);if(s&&Array.isArray(t)&&Array.isArray(n))if(e)for(;s&&r-- >0;)s=e(t[r],n[r]);else for(;s&&r-- >0;)s=t[r]===n[r];else s=e?e(t,n):t===n;return s}}static makeCacheKey(e,t){const n=Object.keys(t).sort();for(let e,r,s,i=n.length;i-- >0;)if(s=t[e=n[i]],null==s&&!1===s)n.splice(i,1);else{if(r=typeof s,"function"===r)return null;"string"===r?n[i]=`${e}:"${s}"`:"number"===r&&(n[i]=`${e}:${s}`)}return n.length?`${e}>${n.join("|")}`:e}makeDescriptor(){const e=this,{base:t,field:n,changer:r,updater:s,name:i}=e;return t!==e&&t.equal===e.equal?t.descriptor:{get(){var e;return null===(e=this.configObserver)||void 0===e||e.get(i,this),this[n]},set(t){const a=this;let o,l,c=a[n];if("string"==typeof t){let e=t;var d;if(t.startsWith("up."))e=null===(d=a.owner)||void 0===d?void 0:d.resolveProperty(t.substr(3));else t.startsWith("this.")&&(e=a.resolveProperty(t.substr(5)));void 0!==e&&"function"!=typeof e&&(t=e)}var u;(a[r]&&(o=void 0===(l=a[r](t,c)),o||(t=l,c=a[n])),o||(e.equal===K?c===t:e.equal(c,t)))||(a[n]=t,o=!0,null===(u=a[s])||void 0===u||u.call(a,t,c));!o||a.isDestroyed||a.onConfigChange.$nullFn||a.onConfigChange({name:i,value:t,was:c,config:e})}}}makeInitter(){const e=this;return e!==e.base?e.lazy?e.makeLazyInitter():e.base.initDescriptor:e.makeBasicInitter()}makeBasicInitter(){const e=this,{initializing:t,name:n}=e;return{configurable:!0,get(){const r=this;return e.removeInitter(r),r[t]=!0,r[n]=r[B][n],r[t]=!1,r.configDone[n]=!0,r[n]},set(t){e.removeInitter(this),this.configDone[n]=!0,this[n]=t}}}makeLazyInitter(){const e=this,{initializing:t,name:n}=e;return{configurable:!0,get(){const r=this,s=r[z].get(n);return e.removeInitter(r),r.isDestroying||(r[t]=!0,r[n]=s,r[t]=!1),r[n]},set(t){e.removeInitter(this),this[n]=t}}}removeInitter(e){const{name:t}=this,n=e[V][t],r=e[z];n?$(e,t,n):delete e[t],null!=r&&r.delete(t)&&!r.size&&delete e[z]}setDefault(e,t){$(e.prototype,this.field,{configurable:!0,writable:!0,value:t})}merge(e,t){if(t&&e&&F.isObject(e)){if(t.isBase)return t.setConfig(e);F.isObject(t)&&(e=F.merge(F.clone(t),e))}return e}}const{prototype:q}=Y,{equal:K}=q;Y.symbols={configuring:B,instanceProperties:V,lazyConfigs:z},Y.cache=Object.create(null),Y.equalityMethods={array:Y.makeArrayEquals(),date:(e,t)=>e===t||!(!e||!t||j.call(e)!==W||j.call(t)!==W)&&e.getTime()===t.getTime(),strict:Y.equal=K},Y.mergeMethods={distinct(e,t){let n=t?t.slice():[];if(null!=e)if(F.isObject(e))if(void 0===t)n=e;else{let t,r;for(t in e)r=n.indexOf(t),e[t]?r<0&&n.push(t):r>-1&&n.splice(r,1)}else Array.isArray(e)?e.forEach((e=>!n.includes(e)&&n.push(e))):n.includes(e)||n.push(e);return n},merge:Y.merge=q.merge,classList(e,t){if("string"==typeof e){if(!e.length)return t;e=e.split(H)}return Array.isArray(e)&&(e=e.reduce(U,{})),Y.merge(e,t)},objects:(e,t)=>!0===e?t||{}:Y.merge(e,t),replace:e=>e,items:(e,t,n,r)=>r?F.mergeItems(t,e,{merge:(e,t)=>q.merge(t,e)}):q.merge(e,t)},Object.assign(q,{_descriptor:null,_initDescriptor:null,lazy:!1,nullify:!1,render:!1}),Y._$name="Config";class G{constructor(e){e&&Object.assign(this,e)}getInherited(e,t=!0){let n=this[e];var r;e in this||(n=null===(r=this.super)||void 0===r?void 0:r.getInherited(e,t),(n||t)&&(this[e]=n=Object.create(n||null)));return n}}const{getPrototypeOf:X}=Object,{hasOwn:Z}=F,{defineProperty:J}=Reflect,Q=Symbol("classMetaData"),ee=Symbol("mixinTag"),te=Symbol("originalConfig"),ne=Y.symbols.configuring,re=Y.symbols.instanceProperties,se=Y.symbols.lazyConfigs,ie={merge:"replace",simple:!0},ae=()=>{},oe=e=>new G(e),le={},ce=Object.freeze({}),de=Object.freeze([]);class ue{static get isBase(){return!0}get isBase(){return!0}static get declarable(){return["declarable","configurable","defaultConfig","properties","prototypeProperties"]}constructor(...e){const t=this,n=t.constructor;t.$meta.class!==n&&n.$meta,t.construct(...e),t.afterConstruct(),t.isConstructing=!1}static new(...e){return new this((e=e.filter((e=>e))).length>1?this.mergeConfigs(...e):e[0])}construct(...e){null!==e[0]&&this.configure(...e),this.afterConfigure()}static destroy(...e){const t=e=>{null!=e&&e.destroy?e.destroy():Array.isArray(e)&&e.forEach(t)};t(e)}destroy(){const e=this,{id:t}=e;e.isDestroying=!0,e.destroy=ae,e.doDestroy(),Object.setPrototypeOf(e,null);for(const t in e)"destroy"!==t&&"isDestroying"!==t&&delete e[t];delete e[te],e.isDestroyed=!0,e.id=t}_thisIsAUsedExpression(e){}static get $$name(){return Z(this,"$name")&&this.$name||Z(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}startConfigure(e){}finishConfigure(e){}afterConfigure(){}afterConstruct(){}callback(e,t,n=de){const{handler:r,thisObj:s}=this.resolveCallback(e,"this"===t?this:t)||ce;return null==r?void 0:r.apply(s,n)}resolveProperty(e){let t=this;for(;t;){if(F.hasPath(t,e))return F.getPath(t,e);t=t.owner}}resolveCallback(e,t=this,n=!0){var r;if(null!==(r=e)&&void 0!==r&&r.substring){if(e.endsWith("?")&&(n=!1,e=e.substring(0,e.length-1)),e.startsWith("up.")){for(e=e.substring(3),t=this.owner;t&&!t[e];t=t.owner);if(!t)return}else e.startsWith("this.")&&(e=e.substring(5),t=this);if(!(t&&t instanceof Object))return;e=t[e]}if("function"==typeof e)return{handler:e,thisObj:t};if(n)throw new Error(`No method named ${e} on ${t.$$name||"thisObj object"}`)}bindCallback(e,t=this){if(e){const{handler:n,thisObj:r}=this.resolveCallback(e,t);if(n)return n.bind(r)}}delay(e,t,n=e.name||e){e=this.setTimeout?e:e.bind(this);return(this.setTimeout?this:globalThis)["number"==typeof t?"setTimeout":"requestAnimationFrame"](e,t,n)}doDestroy(){const e=this,{nullify:t}=e.$meta;if(t)for(let n=0;n<t.length;++n)null!=e[t[n].field]&&(e[t[n].name]=null)}destroyProperties(...e){const t=this;let n;for(n of e){var r,s,i;if(n in t&&(!t[ne]||!t[ne][n]))null===(r=t[n])||void 0===r||null===(s=(i=r).destroy)||void 0===s||s.call(i),delete t[n]}}configure(e={}){const t=this,n=t.$meta,{beforeConfigure:r}=e,s=n.configs,i=t.getDefaultConfiguration();let a,o,l;for(o in t.initialConfig=e,t.isConfiguring=!0,Object.assign(t,t.getProperties()),e)l=e[o],a=s[o],i[o]=a?a.merge(l,i[o],null,n):l;r&&(delete i.beforeConfigure,r(t,i)),t.setConfig(t[te]=i,!0),t.isConfiguring=!1}getConfig(e){return this[e]}setConfig(e,t){const n=this,r=n[ne],s=r?n.configDone:n.configDone={},i=n.$meta.configs,a=n[se];let o,l;for(l in n[re]={},n[ne]=r?Object.setPrototypeOf(Object.assign({},e),r):e,e)null!=e[l]||Z(e,l)?(o=i[l]||Y.get(l),null!=a&&a.has(l)||o.defineInitter(n,e[l]),t||(s[l]=!1)):s[l]=!0;for(l in t&&n.startConfigure(e),e){var c;s[l]||t&&null!==(c=i[l])&&void 0!==c&&c.lazy||(n[l]=e[l])}return r?n[ne]=r:delete n[ne],t&&n.finishConfigure(e),n}hasConfig(e){var t;const n=this,r=n[ne];return Boolean(null!=n["_"+e]||null!=(null===(t=n[se])||void 0===t?void 0:t.get(e))||!n.configDone[e]&&r&&(null!=r[e]||Z(r,e)))}peekConfig(e){const t=this,n=t[se],r=t[ne];if(null!=n&&n.has(e))return n.get(e);if(r&&e in r){if(t.configDone[e])return t[e];if(null!=r[e]||Z(r,e))return r[e]}}triggerConfig(e){const t=this,{configDone:n}=t,r=t[se],s=t[ne],i=null!=r&&r.has(e)||s&&(null!=s[e]||Z(s,e))?!n[e]:null;return i&&t.getConfig(e),i}triggerConfigs(e){const t=this,n=t.$meta.configs,r=t[se],s=r?[...r.keys()].filter((t=>n[t].lazy===e)):de;for(const e of s)t.triggerConfig(e);return s.length?s:null}onConfigChange(){}get config(){const e={},t=this[te];for(const n in t)e[n]=t[n];return e}static processConfigValue(e,t){if(e===globalThis)return globalThis;if(Array.isArray(e))return e.map((e=>ue.processConfigValue(e,t)));if(e instanceof ue){if(t.visited.has(e))return;return e.getCurrentConfig(t)}if(e instanceof HTMLElement||e instanceof DocumentFragment)return null;if(F.isObject(e)){const n={};for(const r in e)"owner"!==r&&(n[r]=ue.processConfigValue(e[r],t));return n}return e}getConfigValue(e,t){var n;const r=this,s=r[se];return null!==(n=r.$meta.configs[e])&&void 0!==n&&n.lazy?null!=s&&s.has(e)?ue.processConfigValue(s.get(e),t):void 0:ue.processConfigValue(r[e],t)}preProcessCurrentConfigs(){}getCurrentConfig(e={}){const t=this,n="all"===e.configs?t.config:F.clone(t.initialConfig),r=e.visited||(e.visited=new Set),s=e.depth||(e.depth=0),i={};if(!r.has(t)){r.add(t),this.preProcessCurrentConfigs(n);for(const r in n){const n=t.getConfigValue(r,{...e,depth:s+1});void 0!==n&&(i[r]=n)}return i}}getConfigString(e={}){return T.toJavaScriptString(this.getCurrentConfig(e))}getTestCase(e={}){const t=this.isGantt?"Gantt":this.isSchedulerPro?"SchedulerPro":this.isCalendar?"Calendar":this.isScheduler?"Scheduler":this.isGrid?"Grid":this.isTaskBoard?"TaskBoard":null;if(t){const n=t.toLowerCase(),r=`../../build/${n}.module.js`;let s,i;"static"===e.import?(s=`import * as module from "${r}";Object.assign(window, module);`,i=""):(s=`import("${r}").then(module => { Object.assign(window, module);\n`,i="});");const a=P.getVersion(n);return a&&(s+=`\nconsole.log('${t} ${a}');\n`),`${s}      \nconst ${n} = new ${t}(${this.getConfigString(e)});\n${i}`}}downloadTestCase(e={}){e.output="return";const t=this.getTestCase(e);r.download("app.js","data:application/javascript;charset=utf-8,"+escape(t))}static initClass(){return this.$meta.class}static get $meta(){const e=this;let t=e[Q];return Z(e,Q)||(e[Q]=t=oe(),t.class=e,e.setupClass(t)),t}static onClassMixedIn(){}static mergeConfigs(e,...t){const n=this.$meta.configs,r=F.clone(e)||{};let s,i,a,o;for(i=0;i<t.length;++i)if(s=t[i],s)for(a in s)o=s[a],n[a]?o=n[a].merge(o,r[a]):r[a]&&o&&(o=Y.merge(o,r[a])),r[a]=o;return r}static mixin(...e){let t,n=this;for(t=0;t<e.length;++t){const r=e[t],s=r[ee]||(r[ee]=Symbol("mixinTag"));n[s]||(n=r(n),n[s]=!0,Z(n,"onClassMixedIn")&&n.onClassMixedIn())}return n}static setupClass(e){var t;const n=e.class,r=X(n).$meta,s=n.$$name,i=r.names,a=n.prototype;if(J(a,"$meta",{value:e}),Object.assign(e,{super:r,config:Object.create(r.config),configs:Object.create(r.configs),declarables:r.declarables,forkConfigs:r.forkConfigs,hierarchy:Object.freeze([...r.hierarchy,n]),names:i.includes(s)?i:Object.freeze([...i,s]),properties:r.properties,nullify:null===(t=r.nullify)||void 0===t?void 0:t.slice()}),i!==e.names){const e=`is${s}`,t=t=>{Z(t,e)||J(t,e,{get:()=>!0})};t(a),t(n)}for(let t,r,s=0;s<e.declarables.length;++s)t=e.declarables[s],Z(n,t)&&(r=le[t]||(le[t]=`setup${T.capitalize(t)}`),n[r](n,e))}static setupConfigs(e,t,n){const r=e.config,s=e.configs,i=e.class,a=e.super;let o,l,c,d,u,h,{nullify:g}=e;for(const m in t)u=t[m],n?(o=s[m])?u=o.merge(u,r[m],e,a):o=Y.get(m,ie):(l=c=d=void 0,u&&"object"==typeof u&&"$config"in u&&(c=u.$config,c&&!F.isObject(c)&&(c=F.createTruthyKeys(c)),d="default"in u,l=d?u.default:l,u=u.value),(o=s[m])?(h=o.nullify,c&&(o=o.extend(c)),u=o.merge(u,r[m],e,a)):(o=Y.get(m,c),o.define(i.prototype),d=!(o.field in i.prototype),h=!1),d&&o.setDefault(i,l),o.nullify&&!h&&(g||(g=e.nullify||(e.nullify=[]))).push(o)),u&&(F.isObject(u)||Array.isArray(u))&&!Object.isFrozen(u)&&(e.forkConfigs=!0),s[m]=o,r[m]=u}static setupConfigurable(e,t){e.setupConfigs(t,e.configurable,!1)}static setupDefaultConfig(e,t){e.setupConfigs(t,e.defaultConfig,!0)}static setupDeclarable(e,t){const n=e.declarable;let r,s,i=t.declarables;for(s=0;s<n.length;++s)i.includes(n[s])||(r||(t.declarables=r=i=i.slice()),i.push(n[s]))}static setupProperties(e,t){t.properties=t.super.properties.slice(),t.properties.push(e),Object.freeze(t.properties)}static setupPrototypeProperties(e){Object.assign(e.prototype,e.prototypeProperties)}getDefaultConfiguration(){return this.constructor.getDefaultConfiguration()}static getDefaultConfiguration(){const e=this.$meta,t=e.forkConfigs?ue.fork(e.config):Object.create(e.config);if(P.isTestEnv&&r.isBrowserEnv&&t.testConfig&&globalThis.__applyTestConfigs)for(const e in t.testConfig)t[e]=t.testConfig[e];return t}static fork(e){let t,n,r=e;if(e&&F.isObject(e)&&!Object.isFrozen(e))for(t in r=Object.create(e),e)n=e[t],n&&(F.isObject(n)?r[t]=ue.fork(n):Array.isArray(n)&&(r[t]=n.slice()));return r}getProperties(){const e=this.$meta.properties,t={};for(let n=0;n<e.length;n++)Object.assign(t,e[n].properties);return t}static get superclass(){return X(this)}classHierarchy(e){const t=this.$meta.hierarchy,n=e?t.indexOf(e):0;return n>0?t.slice(n):t}static isOfTypeName(e){return this.$meta.names.includes(e)}detachListeners(e){var t;let n=this.$detachers;if(n=null===(t=n)||void 0===t?void 0:t[e],n)for(;n.length;)n.pop()()}trackDetacher(e,t){const n=this.$detachers||(this.$detachers={});(n[e]||(n[e]=[])).push(t)}untrackDetachers(e){const t=this.$detachers;if(t)for(const n in t){const r=t[n];for(let t=r.length;t-- >0;)r[t].eventer===e&&r.splice(t,1)}}}const he=ue.prototype;he.onConfigChange.$nullFn=ae.$nullFn=!0,ue[Q]=he.$meta=oe({class:ue,config:Object.freeze({}),configs:Object.create(null),declarables:ue.declarable,forkConfigs:!1,hierarchy:Object.freeze([ue]),names:Object.freeze(["Base"]),nullify:null,properties:Object.freeze([]),super:null}),Object.assign(he,{$detachers:null,configObserver:null,isConstructing:!0,isDestroyed:!1,isDestroying:!1}),ue.emptyFn=ae,P.setVersion("core","5.6.2"),ue._$name="Base";class ge{static clean(e){return e.reduce(((e,t)=>(null==t||Array.isArray(t)&&0===t.length||""===t||e.push(t),e)),[])}static from(e,t,n){const r=[];if(e)for(const s of e)t&&!t(s)||r.push(n?n(s):s);return r}static remove(e,...t){let n,r,s=!1;t=t[0]instanceof Set?[...t[0]]:t;for(let i=0;i<t.length;i++)r=t[i],-1!==(n=e.indexOf(r))&&(e.splice(n,1),s=!0);return s}static findInsertionIndex(e,t,n=this.lexicalCompare,r){const s=t.length;let i,a;return r<s&&(i=r>0?n(t[r-1],e):0,a=r<s-1?n(e,t[r]):0,i<1&&a<1)?r:this.binarySearch(t,e,n)}static findLast(e,t,n){for(let{length:r}=e,s=r-1;s>=0;s--)if(t.call(n,e[s],s,e))return e[s]}static binarySearch(e,t,n=0,r=e.length,s=this.lexicalCompare){const i=e.length;let a,o;for(n instanceof Function?(s=n,n=0):r instanceof Function&&(s=r,r=i),--r;n<=r;)a=n+r>>1,o=s(t,e[a]),o>=0?n=a+1:o<0&&(r=a-1);return n}magnitudeCompare(e,t){return e<t?-1:e>t?1:0}lexicalCompare(e,t){return(e=String(e))<(t=String(t))?-1:e>t?1:0}static fill(e,t={},n=null){const r=[],s=Array.isArray(t)?t:[t];for(let t=0;t<e;t++)for(const e of s){const s=Object.assign({},e);n&&n(s,t),r.push(s)}return r}static populate(e,t,n=!1){const r=[];for(let s=0;s<e;s++)r.push(t(s+(n?1:0)));return r}static include(e,...t){for(const n of t)e.includes(n)||e.push(n)}static unique(e){return[...new Set(e)]}static allowNegative(e){return new Proxy(e,{get(e,t,n){if("string"!=typeof t)return Reflect.get(e,t,n);const r=Number(t);return Number.isNaN(r)?Reflect.get(e,t,n):e[r<0?e.length+r:r]},set(e,t,n,r){if("string"!=typeof t)return Reflect.set(e,t,n,r);const s=Number(t);return Number.isNaN(s)?Reflect.set(e,t,n,r):(e[s<0?e.length+s:s]=n,!0)}})}static delta(e,t,n=!1){if(!t)return n?{toAdd:e,toRemove:[],toKeep:[]}:{onlyInA:e,onlyInB:[],inBoth:[]};const r=[],s=[],i=new Set,a=new Set(t);for(let t=0;t<e.length;t++){const n=e[t];a.has(n)?i.add(n):r.push(n)}for(let e=0;e<t.length;e++){const n=t[e];i.has(n)||s.push(n)}return n?{toAdd:r,toRemove:s,toKeep:i}:{onlyInA:r,onlyInB:s,inBoth:[...i]}}static asArray(e){return null==e?e:e instanceof Set?Array.from(e):Array.isArray(e)?e:[e]}static identity(e){return e}static keyBy(e,t,n=ge.identity){const r="string"==typeof t?e=>null==e?void 0:e[t]:t,s="string"==typeof n?e=>null==e?void 0:e[n]:n;return e.reduce(((e,t)=>(e[r(t)]=s(t),e)),{})}static aggregate(e,t,n,r,s={}){const i=e.length,a=e[0].length,o=[];s.targetArray=o,s.arrays=e;for(let e=0;e<a;e++)s.entryIndex=e,o.push(r(e,s));for(let r=0;r<i;r++){const i=e[r];s.rowIndex=r;for(let e=0;e<a;e++){s.entryIndex=e;const a=t(i[e],s);o[e]=n(o[e],a,r,e,s)}}return o}static groupBy(e,t){const n="string"==typeof t?e=>null==e?void 0:e[t]:t;return e.reduce(((e,t)=>{const r=n(t);return(e[r]=e[r]||[]).push(t),e}),{})}}ge._$name="ArrayHelper";const me=/,\s*/,pe=Symbol("decompiled"),fe=/^\s*(async\s+)?([a-z_]\w*)\s*=>([\s\S]+)$/i,ve=/^\s*(async\s*)?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)\s+=>([\s\S]+)$/i,ye=/^(\s*async)?(?:\s*function)?(?:\s*([a-z_]\w*))?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)([\s\S]+)$/i,{hasOwnProperty:be}=Object.prototype;class Ce{static after(e,t,n,r,s){const i="string"==typeof n,a=!1!==(null==s?void 0:s.return),o=(...t)=>{const s=o.$nextHook.call(e,...t),l=null!=r&&r.isDestroyed?void 0:a?i?r[n](s,...t):n.call(r,s,...t):i?r[n](...t):n.call(r,...t);return void 0===l?s:l};return Ce.hookMethod(e,t,o)}static before(e,t,n,r){const s="string"==typeof n,i=(...t)=>{const a=null!=r&&r.isDestroyed?0:s?r[n](...t):n.call(r,...t);return!1===a?a:i.$nextHook.call(e,...t)};return Ce.hookMethod(e,t,i)}static curry(e){return function t(...n){return n.length>=e.length?e.apply(this,n):function(...e){return t.apply(this,n.concat(e))}}}static bindAll(e){for(const t in e)"function"==typeof e[t]&&(e[t]=e[t].bind(e))}static createInterceptor(e,t,n){return function(...r){const s=n||this;return!1!==t.call(s,...r)&&e.call(s,...r)}}static createSequence(e,t,n){return(...r)=>{const s=e.call(n,...r),i=t.call(n,...r);return void 0===i?s:i}}static createThrottled(e,t,n,r,s){let i,a,o=-Number.MAX_VALUE;const l=()=>{a=0,o=performance.now(),i.push.apply(i,r),e.apply(n,i)},c=function(...e){const c=performance.now()-o;i=e,c>=t?(clearTimeout(a),l()):(a||(a=setTimeout(l,t-c)),s&&(i.push.apply(i,r),s.apply(n,i)))};return c.cancel=()=>clearTimeout(a),c}static createBuffered(e,t,n,r){let s,i;const a=()=>{i=0,o.isPending=!1,s.push.apply(s,r),e.apply(n,s)},o=function(...e){s=e,i&&clearTimeout(i),o.isPending=!0,i=setTimeout(a,t)};return o.cancel=()=>{o.isPending=!1,clearTimeout(i)},o}static decompile(e){if(!(pe in e)){var t,n;const r=e.toString();let s,i,a,o,l,c=fe.exec(r);c?(s=[c[2]],i=c[3]):(c=ve.exec(r))?(l=c[2].trim(),s=l?l.split(me):[],i=c[3]):(c=ye.exec(r))&&(a=c[2],l=c[3].trim(),s=l?l.split(me):[],i=c[4]),i=null===(t=i)||void 0===t?void 0:t.trim(),e[pe]=o=c&&{args:s,async:Boolean(c[1]),body:null!==(n=i)&&void 0!==n&&n.startsWith("{")?i.substring(1,i.length-1).trim():i},a&&(o.name=a)}return e[pe]}static hookMethod(e,t,n){return n.$nextHook=e[t],e[t]=n,()=>{if(be.call(e,t)){let i,a=e[t];var r;if(a===n)(null===(r=Object.getPrototypeOf(e))||void 0===r?void 0:r[t])===n.$nextHook?delete e[t]:e[t]=n.$nextHook;else for(;i=null===(s=a)||void 0===s?void 0:s.$nextHook;a=i){var s;if(i===n){a.$nextHook=n.$nextHook;break}}}}}static noThrow(e,t,n){const r=e[t];e[t]=(...t)=>{try{return r.apply(e,t)}catch(e){return null==n?void 0:n(e)}}}static returnTrue(){return!0}static animate(e,t,n,r="linear"){let s=!1;const i=new Promise((i=>{const a=performance.now(),o=()=>{const l=Math.min((performance.now()-a)/e,1),c=n&&n.setTimeout?n:globalThis;s||!1===t.call(n,this.easingFunctions[r](l))&&i(),s||1===l?c.requestAnimationFrame((()=>i())):c.requestAnimationFrame(o)};o()}));return i.cancel=()=>(s=!0,i.cancelled=!0,!1),i}}const Se=.5,we=1.70158,De=7.5625,Te=1.525,Ee=2/2.75,xe=2.25/2.75,ke=1/2.75,Ie=1.5/2.75,Re=2.5/2.75,Me=2.625/2.75,Oe=.75,Ae=.9375,Fe=.984375;Ce.easingFunctions={linear:e=>e,easeInQuad:e=>Math.pow(e,2),easeOutQuad:e=>-(Math.pow(e-1,2)-1),easeInOutQuad:e=>(e/=Se)<1?Se*Math.pow(e,2):-.5*((e-=2)*e-2),easeInCubic:e=>Math.pow(e,3),easeOutCubic:e=>Math.pow(e-1,3)+1,easeInOutCubic:e=>(e/=Se)<1?Se*Math.pow(e,3):Se*(Math.pow(e-2,3)+2),easeInQuart:e=>Math.pow(e,4),easeOutQuart:e=>-(Math.pow(e-1,4)-1),easeInOutQuart:e=>(e/=Se)<1?Se*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2),easeInQuint:e=>Math.pow(e,5),easeOutQuint:e=>Math.pow(e-1,5)+1,easeInOutQuint:e=>(e/=Se)<1?Se*Math.pow(e,5):Se*(Math.pow(e-2,5)+2),easeInSine:e=>1-Math.cos(e*(Math.PI/2)),easeOutSine:e=>Math.sin(e*(Math.PI/2)),easeInOutSine:e=>-.5*(Math.cos(Math.PI*e)-1),easeInExpo:e=>0===e?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>1===e?1:1-Math.pow(2,-10*e),easeInOutExpo:e=>0===e?0:1===e?1:(e/=Se)<1?Se*Math.pow(2,10*(e-1)):Se*(2-Math.pow(2,-10*--e)),easeInCirc:e=>-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-Math.pow(e-1,2)),easeInOutCirc:e=>(e/=Se)<1?-.5*(Math.sqrt(1-e*e)-1):Se*(Math.sqrt(1-(e-=2)*e)+1),easeOutBounce:e=>e<ke?De*e*e:e<Ee?De*(e-=Ie)*e+Oe:e<Re?De*(e-=xe)*e+Ae:De*(e-=Me)*e+Fe,easeInBack:e=>e*e*((we+1)*e-we),easeOutBack:e=>(e-=1)*e*((we+1)*e+we)+1,easeInOutBack:e=>{let t=1.70158;return(e/=Se)<1?Se*(e*e*((1+(t*=Te))*e-t)):Se*((e-=2)*e*((1+(t*=Te))*e+t)+2)},elastic:e=>-1*Math.pow(4,-8*e)*Math.sin((6*e-1)*(2*Math.PI)/2)+1,swingFromTo:e=>{let t=1.70158;return(e/=Se)<1?Se*(e*e*((1+(t*=Te))*e-t)):Se*((e-=2)*e*((1+(t*=Te))*e+t)+2)},swingFrom:e=>e*e*((we+1)*e-we),swingTo:e=>(e-=1)*e*((we+1)*e+we)+1,bounce:e=>e<ke?De*e*e:e<Ee?De*(e-=Ie)*e+Oe:e<Re?De*(e-=xe)*e+Ae:De*(e-=Me)*e+Fe,bouncePast:e=>e<ke?De*e*e:e<Ee?2-(De*(e-=Ie)*e+Oe):e<Re?2-(De*(e-=xe)*e+Ae):2-(De*(e-=Me)*e+Fe),easeFromTo:e=>(e/=Se)<1?Se*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2),easeFrom:e=>Math.pow(e,4),easeTo:e=>Math.pow(e,.25)},Ce._$name="FunctionHelper";const{isArray:Pe}=Array,{hasOwnProperty:Le}=Object.prototype,$e={thisObj:1,detachable:1,once:1,detacher:1,prio:1,args:1,expires:1,buffer:1,throttle:1,name:1,$internal:1},_e=(e,t)=>t.prio-e.prio;var Ne=e=>class t extends(e||ue){eventsSuspended=null;static get $name(){return"Events"}static get declarable(){return["deprecatedEvents"]}static setupDeprecatedEvents(e,t){const n=t.getInherited("deprecatedEvents"),r=e.deprecatedEvents;for(const e in r)n[e.toLowerCase()]=n[e]=r[e]}static get configurable(){return{listeners:{value:null,$config:{merge(e,t){if(null!==e){if(!e)return t;t&&(e=e?[e]:[]).push[Pe(t)?"apply":"call"](e,t)}return e}}},internalListeners:null,bubbleEvents:null}}destroy(){this.trigger("beforeDestroy"),super.destroy()}construct(e,...t){var n;(this.configuredListeners=null===(n=e)||void 0===n?void 0:n.listeners)&&delete(e=F.assign({},e)).listeners,super.construct(e,...t),this.processConfiguredListeners()}processConfiguredListeners(){if(this.configuredListeners){const e=this,{isConfiguring:t}=e;e.isConfiguring=!1,e.listeners=e.configuredListeners,e.configuredListeners=null,e.isConfiguring=t}}doDestroy(){this.trigger("destroy"),this.removeAllListeners(!1),super.doDestroy()}static setupClass(e){super.setupClass(e),t.prototype.onListen.$nullFn=!0,t.prototype.onUnlisten.$nullFn=!0}addListener(e,t,n){if(Pe(e)){for(let n=0,{length:r}=e;n<r;n++)this.addListener(e[n],t);return}const r=this,s=r.$meta.getInherited("deprecatedEvents");if("string"==typeof e)return r.addListener({[e]:t,detachable:!1!==t.detachable,thisObj:n});{t=e.thisObj=void 0!==e.thisObj?e.thisObj:t;for(const n in e)if(!$e[n]&&null!=e[n]){const a=n.toLowerCase(),o=null==s?void 0:s[a],l=r.eventListeners||(r.eventListeners={}),c=ge.asArray(e[n]);if(o){const{product:e,invalidAsOfVersion:t,message:n}=o;P.deprecate(e,t,n)}for(const s of c){var i;const o=s.expires||e.expires,c={fn:"object"==typeof s?s.fn:s,thisObj:void 0!==s.thisObj?s.thisObj:t,args:s.args||e.args,prio:void 0!==s.prio?s.prio:void 0!==e.prio?e.prio:0,once:void 0!==s.once?s.once:void 0!==e.once&&e.once,buffer:s.buffer||e.buffer,throttle:s.throttle||e.throttle,$internal:e.$internal,catchAll:"catchAll"===n};if(o){const{alt:s}=o,i=s?o.delay:o,l=e.name||n,d=()=>{r.un(a,c),s&&!c.called&&r.callback(s,t)};r.isDelayable?r.setTimeout({fn:d,name:l,cancelOutstanding:!0,delay:i}):globalThis.setTimeout(d,i)}let d=l[a]||(l[a]=[]);d.$firing&&(l[a]=d=d.slice()),d.splice(ge.findInsertionIndex(c,d,_e,d.length),0,c),!r.onListen.$nullFn&&d.length<2&&r.onListen(a),null===(i=r.afterAddListener)||void 0===i||i.call(r,a,c)}}e.relayAll&&r.relayAll(e.relayAll),t&&t!==r&&r.attachAutoDetacher(e,t);const n=!1!==e.detachable,o=e.name,l=e.expires||n||o?()=>{r.isDestroyed||r.removeListener(e,t)}:null;var a;if(l)if(l.eventer=r,l.listenerName=o,o&&null!==(a=t)&&void 0!==a&&a.trackDetacher&&t.trackDetacher(o,l),e.expires&&r.delay(l,isNaN(e.expires)?e.expires.delay:e.expires,o),n)return l}}on(e,t,n){return this.addListener(e,t,n)}ion(e){return e.$internal=!0,this.on(e)}un(...e){this.removeListener(...e)}updateInternalListeners(e,t){null==t||t.detach(),e&&(e.detach=this.ion(e))}get listeners(){return this.eventListeners}changeListeners(e){if(!this.isConfiguring){if(Array.isArray(e))for(let t=0,n=e[0],{length:r}=e;t<r;n=e[++t])"thisObj"in n||(e[t]=F.assign({thisObj:this},n));else e&&!("thisObj"in e)&&(e=F.assign({thisObj:this},e));return e}this.getConfig("internalListeners"),e&&this.on(e,this)}updateListeners(e,t){t&&this.un(t),e&&this.on(e)}removeListener(e,t=e.thisObj,n){const r=this;if("string"==typeof e)return r.removeListener({[e]:t},n);Object.entries(e).forEach((([e,n])=>{if(!$e[e]&&null!=n){e=e.toLowerCase();const{eventListeners:i}=r,a=r.findListener(e,n,t);if(a>=0){var s;let t=i[e];null===(s=r.afterRemoveListener)||void 0===s||s.call(r,e,t[a]),t.length>1?(t.$firing&&(i[e]=t=t.slice()),t.splice(a,1)):(delete i[e],r.onUnlisten.$nullFn||r.onUnlisten(e))}}})),e.thisObj&&!e.thisObj.isDestroyed&&r.detachAutoDetacher(e)}findListener(e,t,n){var r;const s=null===(r=this.eventListeners)||void 0===r?void 0:r[e],i=t.fn||t,a=t.thisObj||n;if(s)for(let e,t=0,{length:n}=s;t<n;t++)if(e=s[t],e.fn===i&&e.thisObj===a)return t;return-1}hasListener(e){var t;return Boolean(null===(t=this.eventListeners)||void 0===t?void 0:t[null==e?void 0:e.toLowerCase()])}relayAll(e,t,n=!0){this.relayAllTargets||(this.relayAllTargets=[]);const{relayAllTargets:r}=this;e.ion({beforeDestroy:({source:t})=>{if(t===e){r.filter((t=>t.through===e)).forEach((e=>ge.remove(r,e)))}}}),r.push({through:e,prefix:t,transformCase:n})}removeAllListeners(e=!0){const t=this.eventListeners;let n,r;for(const o in t){const l=t[o];for(n=l.length;n-- >0;){const t=l[n];var s,i,a;if(!t.$internal||!e)this.removeListener(o,t),r=t.thisObj,null===(s=r)||void 0===s||null===(i=(a=s).untrackDetachers)||void 0===i||i.call(a,this)}}}relayEvents(e,t,n=""){const r={detachable:!0,thisObj:this};return t.forEach((e=>{r[e]=(t,...r)=>this.trigger(n+e,t,...r)})),e.on(r)}onListen(){}onUnlisten(){}destructorInterceptor(){const{autoDetachers:e,target:t,oldDestructor:n}=this;for(let n=0;n<e.length;n++){const{dispatcher:r,config:s}=e[n];r.isDestroyed||r.removeListener(s,t)}n.call(t)}attachAutoDetacher(e,t){const n=e.thisObj||t,r="doDestroy"in n?"doDestroy":"destroy";if(r in n){let{$autoDetachers:t}=n;t||(n.$autoDetachers=t=[]),n.$oldDestructor||(n.$oldDestructor=n[r],n[r]=this.destructorInterceptor.bind({autoDetachers:t,oldDestructor:n.$oldDestructor,target:n})),t.push({config:e,dispatcher:this})}else n[r]=()=>{this.removeListener(e)}}detachAutoDetacher(e){const t=e.thisObj;t.$oldDestructor&&!t.isDestroying&&(ge.remove(t.$autoDetachers,t.$autoDetachers.find((t=>t.config===e&&t.dispatcher===this))),t.$autoDetachers.length||(t["doDestroy"in t?"doDestroy":"destroy"]=t.$oldDestructor,t.$oldDestructor=null))}once(e,t){return this.on({[e]:()=>this.callback(t),once:!0})}await(e,t={checkLog:!0,resetLog:!0,args:null}){const n=this;!1===t&&(t={checkLog:!1});const{args:r}=t;return new Promise((s=>{var i;if(t.checkLog&&null!==(i=n._triggered)&&void 0!==i&&i[e]&&(s(),t.resetLog&&n.clearLog(e)),r){const i=n.on({[e]:(...a)=>{("function"==typeof r?r(...a):Object.keys(r).every((e=>e in a[0]&&a[0][e]===r[e])))&&(s(...a),t.resetLog&&n.clearLog(e),i())},prio:-1e4})}else n.on({[e]:(...r)=>{s(...r),t.resetLog&&n.clearLog(e)},prio:-1e4,once:!0})}))}clearLog(e){this._triggered&&(e?delete this._triggered[e]:this._triggered={})}trigger(e,t){var n,r,s,i,a;const o=this,l=e.toLowerCase(),{eventsSuspended:c,relayAllTargets:d,callOnFunctions:u}=o;let h,g,m=null===(n=o.eventListeners)||void 0===n?void 0:n[l];if(o._triggered||(o._triggered={}),o._triggered[e]=!0,c)return c.shouldQueue&&c.queue.push(arguments),!0;if(null!==(r=o.eventListeners)&&void 0!==r&&r.catchall&&((m=m?m.slice():[]).push(...o.eventListeners.catchall),m.sort(_e)),!m&&!d&&!u)return!0;if(t?"source"in t||(Object.isExtensible(t)?t.source=o:t=Object.setPrototypeOf({source:o},t)):t={source:o},t.type!==l&&(t.constructor!==Object?Reflect.defineProperty(t,"type",{get:()=>l}):t.type=l),t.eventName=e,!("bubbles"in t)&&null!==(s=o.bubbleEvents)&&void 0!==s&&s[e]&&(t.bubbles=o.bubbleEvents[e]),u){const n="on"+T.capitalize(e);if(n in o){var p;const e=!o[n]||o.callback(o[n],o,[t]);let r;if(F.isPromise(e)?(h||(h=[])).push(e):r=!1===e||r,!o.isDestroyed&&Le.call(o,n)&&(null===(p=o.pluginFunctionChain)||void 0===p||!p[n])){const e=Object.getPrototypeOf(o);if(n in e){const s=e[n].call(o,t);if(F.isPromise(s)?(h||(h=[])).push(s):r=!1===s||r,o.isDestroyed)return}}if(r)return!1}}if(m){let e=0,n=!1;for(m.$firing=!0;e<m.length&&!o.isDestroyed&&!n;e++){const r=m[e];if(!1===g&&!r.$internal)continue;let s,i=r.thisObj;if(!i||!i.isDestroyed){if(r.called=!0,r.once&&o.removeListener(l,r),"string"==typeof r.fn){if(i&&(s=i[r.fn]),!s){const e=o.resolveCallback(r.fn);s=e.handler,i=e.thisObj}}else s=r.fn;if(r.buffer){if(!r.bufferFn){const e=Number(r.buffer);if("number"!=typeof e||isNaN(e))throw new Error(`Incorrect type for buffer, got "${e}" (expected a Number)`);r.bufferFn=Ce.createBuffered(s,e,i,r.args)}s=r.bufferFn}if(r.throttle){const e=Number(r.throttle);if("number"!=typeof e||isNaN(e))throw new Error(`Incorrect type for throttle, got "${e}" (expected a Number)`);r.throttledFn||(r.throttledFn=Ce.createThrottled(s,e,i,r.args)),s=r.throttledFn}const e=s.call(i||o,...r.args||[],t);!1!==g&&(g=e),r.$internal&&!1===e&&(n=!0),F.isPromise(e)&&(e.$internal=r.$internal,(h||(h=[])).push(e))}}if(m.$firing=!1,n)return!1}return null==d||d.forEach((n=>{let r=e;if(n.transformCase&&(r=T.capitalize(r)),n.prefix&&(r=n.prefix+r),!1===n.through.trigger(r,t))return!1})),t.bubbles&&o.owner&&!o.owner.isDestroyed?o.owner.trigger(e,t):(h=null===(i=h)||void 0===i?void 0:i.filter((e=>!1!==g||e.$internal)),null!==(a=h)&&void 0!==a&&a.length?new Promise((e=>{Promise.all(h).then((t=>{const n=!t.some((e=>!1===e));e(n)}))})):!1!==g)}suspendEvents(e=!1){(this.eventsSuspended||(this.eventsSuspended={shouldQueue:e,queue:[],count:0})).count++}resumeEvents(){const e=this.eventsSuspended;if(e&&0==--e.count&&(this.eventsSuspended=null,e.shouldQueue))for(const t of e.queue)this.trigger(...t);return!Boolean(this.eventsSuspended)}};class je{static animationFrame(){return new Promise((e=>{requestAnimationFrame(e)}))}static sleep(e){return new Promise((t=>{setTimeout((()=>{t()}),e)}))}static yield(){return Promise.resolve()}}je._$name="AsyncHelper";const Ve=/^(\w+)=(.*)$/;class Be{static DEFAULT_FETCH_OPTIONS={};static get(e,t){return this.fetch(e,t)}static post(e,t,n={}){return t instanceof FormData||"string"==typeof t||(t=JSON.stringify(t),n.headers=n.headers||{},n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json"),this.fetch(e,Object.assign({method:"POST",body:t},n))}static fetch(e,t){let n;if(t=F.merge({},Be.DEFAULT_FETCH_OPTIONS,t),"undefined"!=typeof AbortController&&(n=t.abortController=new AbortController,t.signal=n.signal),"credentials"in t||(t.credentials="include"),t.queryParams){const n=Object.entries(t.queryParams);if(n.length){let r=!1;if(t.headers&&!0===t.addQueryParamsToBody){let e;switch(new Headers(t.headers).get("Content-Type")){case"application/x-www-form-urlencoded":e=URLSearchParams;break;case"multipart/form-data":e=FormData}if(e){const s=t.body||(t.body=new e);s instanceof e&&(n.forEach((([e,t])=>s.set(e,t))),r=!0)}}r||(e+=(e.includes("?")?"&":"?")+n.map((([e,t])=>`${e}=${encodeURIComponent(t)}`)).join("&"))}}const r=new Promise(((n,s)=>{fetch(e,t).then((e=>{t.parseJson?e.json().then((t=>{e.parsedJson=t,n(e)})).catch((t=>{e.parsedJson=null,e.error=t,s(e)})):n(e)})).catch((e=>{e.stack=r.stack,s(e)}))}));return r.stack=(new Error).stack,r.abort=function(){var e;null===(e=n)||void 0===e||e.abort()},r}static mockUrl(e,t){const n=this;(n.mockAjaxMap||(n.mockAjaxMap={}))[e]=t,Be.originalFetch||(Be.originalFetch=Be.fetch,Be.fetch=n.mockAjaxFetch.bind(n))}static async mockAjaxFetch(e,t){const n=e.split("?");let r=this.mockAjaxMap[n[0]],s=null;if(r){"function"==typeof r&&(r=await r(n[0],n[1]&&function(e){const t={},n=e.split("&");for(const e of n){const[n,r,s]=Ve.exec(e),i=decodeURIComponent(r),a=decodeURIComponent(s);if(n){let e=t[i];e?(Array.isArray(e)||(e=t[i]=[e]),e.push(a)):t[i]=a}}return t}(n[1]),t));try{s=(null==t?void 0:t.parseJson)&&JSON.parse(r.responseText)}catch(e){s=null,r.error=e}return r=Object.assign({status:200,ok:!0,headers:new Headers,statusText:"OK",url:e,parsedJson:s,text:()=>new Promise((e=>{e(r.responseText)})),json:()=>new Promise((e=>{e(s)}))},r),new Promise((function(e,t){r.synchronous?e(r):setTimeout((function(){e(r)}),"delay"in r?r.delay:100)}))}return Be.originalFetch(e,t)}}Be._$name="AjaxHelper";const ze="undefined"!=typeof self?self:"undefined"!=typeof globalThis?globalThis:null;class We{static skipLocaleIntegrityCheck=!1;static mergeLocales(...e){const t={};return e.forEach((e=>{Object.keys(e).forEach((n=>{"object"==typeof e[n]?t[n]={...t[n],...e[n]}:t[n]=e[n]}))})),t}static trimLocale(e,t){const n=(t,n)=>{e[t]&&(n?e[t][n]&&delete e[t][n]:delete e[t])};Object.keys(t).forEach((e=>{Object.keys(t[e]).length>0?Object.keys(t[e]).forEach((t=>n(e,t))):n(e)}))}static normalizeLocale(e,t){if(!e)throw new Error('"nameOrConfig" parameter can not be empty');if("string"==typeof e){if(!t)throw new Error('"config" parameter can not be empty');t.locale?t.name=e||t.name:t.localeName=e}else t=e;let n={};if(t.name||t.locale)n=Object.assign({localeName:t.name},t.locale),t.desc&&(n.localeDesc=t.desc),t.code&&(n.localeCode=t.code),t.path&&(n.localePath=t.path);else{if(!t.localeName)throw new Error('"config" parameter doesn\'t have "localeName" property');n=Object.assign({},t)}for(const e of["name","desc","code","path"])n[e]&&delete n[e];if(!n.localeName)throw new Error("Locale name can not be empty");return n}static get locales(){return ze.bryntum.locales||{}}static set locales(e){ze.bryntum.locales=e}static get localeName(){return ze.bryntum.locale||"En"}static set localeName(e){ze.bryntum.locale=e||We.localeName}static get locale(){return We.localeName&&this.locales[We.localeName]||this.locales.En||Object.values(this.locales)[0]||{localeName:"",localeDesc:"",localeCoode:""}}static publishLocale(e,t){const{locales:n}=ze.bryntum,r=We.normalizeLocale(e,t),{localeName:s}=r;return n[s]&&!0!==t?n[s]=this.mergeLocales(n[s]||{},r||{}):n[s]=r,n[s]}}ze.bryntum=ze.bryntum||{},ze.bryntum.locales=ze.bryntum.locales||{},We._$name="LocaleHelper";class He extends(Ne(ue)){static get defaultConfig(){return{throwOnMissingLocale:P.isTestEnv}}construct(...e){const t=this;if(super.construct(...e),r.isBrowserEnv){var n;const e=document.querySelector("script[data-default-locale]");e?t.applyLocale(e.dataset.defaultLocale):null!==(n=t.locale)&&void 0!==n&&n.localeName&&t.applyLocale(t.locale.localeName)}}get locales(){return We.locales}set locales(e){We.locales=e}set locale(e){this.applyLocale(e)}get locale(){return We.locale}registerLocale(e,t){P.deprecate("Core","6.0.0","LocaleManager.registerLocale deprecated, use LocaleHelper.publishLocale instead"),We.publishLocale(e,t)}extendLocale(e,t){P.deprecate("Core","6.0.0","LocaleManager.extendLocale deprecated, use LocaleManager.applyLocale instead");const n=We.publishLocale(e,t);return this.applyLocale(n,!0)}applyLocale(e,t,n=!1){const s=this;let i;if("string"==typeof e)if("object"!=typeof t){if(i=s.locales[e],!i){if(n)return!0;throw new Error(`Locale "${e}" is not published. Publish with LocaleHelper.publishLocale() before applying.`)}}else i=We.publishLocale(e,t);else i=We.publishLocale(e);if(s.locale.localeName&&s.locale.localeName===i.localeName&&!0!==t)return s.locale;We.localeName=i.localeName;const a=()=>{s.trigger("locale",i)};return i.localePath?new Promise(((e,t)=>{s.loadLocale(i.localePath).then((t=>{t.text().then((t=>{new Function(t)(),r.isBrowserEnv&&(i=s.locales[i.localeName],i&&delete i.localePath),a(),e(i)}))})).catch((e=>t(e)))})):(a(),i)}loadLocale(e){return Be.get(e)}set throwOnMissingLocale(e){this._throwOnMissingLocale=e}get throwOnMissingLocale(){return this._throwOnMissingLocale}}const Ue=new He,Ye=Object.getPrototypeOf(Object),qe=/L{.*?}/g,Ke=/L{(.*?)}/g,Ge=/((.*?)\.)?(.+)/g,Xe=e=>e.replace(/\[\[(\d+)]]/gm,"{$1}"),Ze=Object.freeze(Object.create(null));var Je=e=>class t extends(e||ue){static get $name(){return"Localizable"}static get configurable(){return{localeClass:null,localizable:null,localizableProperties:{value:[],$config:{merge:"distinct"}}}}static clsName(e){var t,n;return"string"==typeof e?e:e===Ye?"Object":e.$$name||e.name||(null===(t=e.prototype)||void 0===t?void 0:t.$$name)||(null===(n=e.prototype)||void 0===n?void 0:n.name)}static parseLocaleString(e){var t;const n=[];let r;if(null!==(t=e)&&void 0!==t&&t.includes("L{"))for(e=e.replace(/{(\d+)}/gm,"[[$1]]"),Ke.lastIndex=0;null!=(r=Ke.exec(e));){Ge.lastIndex=0;const e=Ge.exec(r[1]);n.push({match:Xe(r[0]),localeKey:Xe(e[3]),localeClass:e[2]})}return n.length>0?n:[{match:e,localeKey:e,localeClass:void 0}]}construct(e={},...t){super.construct(e,...t),Ue.ion({locale:"updateLocalization",thisObj:this}),this.updateLocalization()}get localeClass(){return this._localeClass||null}localizeProperty(e){var n,r,s;const i=this,a=F.getPath(i,e),o=(null===(n=i.$meta.configs[e])||void 0===n?void 0:n.localeKey)||(null===(r=i.fieldMap)||void 0===r||null===(s=r[e])||void 0===s?void 0:s.defaultValue);let l;return o?(l=t.localize(o,i,i.localeClass||i),l&&!(e in(i.initialConfig||Ze))&&F.setPath(i.isColumn?i.data:i,e,l)):"string"==typeof a&&(i.originalLocales=i.originalLocales||{},l=F.getPath(i.originalLocales,e),void 0===l&&(F.setPath(i.originalLocales,e,a),l=a),l&&F.setPath(i,e,l=i.optionalL(l,i))),l||a}updateLocalization(){var e,t;!1!==this.localizable&&(null===(e=this.localizableProperties)||void 0===e||e.forEach(this.localizeProperty,this),null===(t=this.trigger)||void 0===t||t.call(this,"localized"))}static getTranslation(e,n,r){const s=Ue.locale;let i,a,o=null;if(s)for(const{match:l,localeKey:c,localeClass:d}of this.parseLocaleString(e)){const u=t=>{var i;const a=null===(i=s[t])||void 0===i?void 0:i[c];return a&&(o="function"==typeof a?null!=n?a(n):a:"object"==typeof a||e===l?a:(o||e).replace(l,a),"string"==typeof a&&a.includes("L{")&&(o=this.getTranslation(a,n,r))),a};let h=!1;for(a=r;a&&(i=t.clsName(a))&&!(h=u(i))&&"string"!=typeof a;a=Object.getPrototypeOf(a));!h&&d&&u(d)}return o}static localize(e,n=void 0,...r){var s;0===(null===(s=r)||void 0===s?void 0:s.length)&&(r=[this]);let i=null;return r.some((r=>(i=t.getTranslation(e,n,r),null!=i))),i}static L(e,n=void 0,...r){var s;0===(null===(s=r)||void 0===s?void 0:s.length)&&(r=[this]);const i=this.localize(e,n,...r);if(null==i&&Ue.throwOnMissingLocale&&e.includes("L{"))throw new Error(`Localization is not found for '${e}' in '${r.map((e=>t.clsName(e))).join(", ")}'. ${Ue.locale.localeName?`Locale : ${Ue.locale.localeName}`:""}`);return i??e}L(e,n){const{localeClass:r,constructor:s}=this;return r&&t.clsName(r)!==t.clsName(s)?t.L(e,n,r,s):t.L(e,n,s)}static optionalL(e,n=void 0,...r){var s;const i=Ue.throwOnMissingLocale;Ue.throwOnMissingLocale=i&&qe.test(e),0===(null===(s=r)||void 0===s?void 0:s.length)&&(r=[this]);const a=t.L(e,n,...r);return Ue.throwOnMissingLocale=i,a}optionalL(e,t=this,n=!1){const r=Ue.throwOnMissingLocale;Ue.throwOnMissingLocale=r&&qe.test(e)&&!n;const s=this.L(e,t);return Ue.throwOnMissingLocale=r,s}get localeManager(){return Ue}get localeHelper(){return We}};We.publishLocale({localeName:"En",localeDesc:"English (US)",localeCode:"en-US",Object:{Yes:"Yes",No:"No",Cancel:"Cancel",Ok:"OK",Week:"Week",None:"None"},ColorPicker:{noColor:"No color"},Combo:{noResults:"No results",recordNotCommitted:"Record could not be added",addNewValue:e=>`Add ${e}`},FilePicker:{file:"File"},Field:{badInput:"Invalid field value",patternMismatch:"Value should match a specific pattern",rangeOverflow:e=>`Value must be less than or equal to ${e.max}`,rangeUnderflow:e=>`Value must be greater than or equal to ${e.min}`,stepMismatch:"Value should fit the step",tooLong:"Value should be shorter",tooShort:"Value should be longer",typeMismatch:"Value is required to be in a special format",valueMissing:"This field is required",invalidValue:"Invalid field value",minimumValueViolation:"Minimum value violation",maximumValueViolation:"Maximum value violation",fieldRequired:"This field is required",validateFilter:"Value must be selected from the list"},DateField:{invalidDate:"Invalid date input"},DatePicker:{gotoPrevYear:"Go to previous year",gotoPrevMonth:"Go to previous month",gotoNextMonth:"Go to next month",gotoNextYear:"Go to next year"},NumberFormat:{locale:"en-US",currency:"USD"},DurationField:{invalidUnit:"Invalid unit"},TimeField:{invalidTime:"Invalid time input"},TimePicker:{hour:"Hour",minute:"Minute",second:"Second"},List:{loading:"Loading...",selectAll:"Select All"},GridBase:{loadMask:"Loading...",syncMask:"Saving changes, please wait..."},PagingToolbar:{firstPage:"Go to first page",prevPage:"Go to previous page",page:"Page",nextPage:"Go to next page",lastPage:"Go to last page",reload:"Reload current page",noRecords:"No records to display",pageCountTemplate:e=>`of ${e.lastPage}`,summaryTemplate:e=>`Displaying records ${e.start} - ${e.end} of ${e.allCount}`},PanelCollapser:{Collapse:"Collapse",Expand:"Expand"},Popup:{close:"Close"},UndoRedo:{Undo:"Undo",Redo:"Redo",UndoLastAction:"Undo last action",RedoLastAction:"Redo last undone action",NoActions:"No items in the undo queue"},FieldFilterPicker:{equals:"equals",doesNotEqual:"does not equal",isEmpty:"empty",isNotEmpty:"not empty",contains:"contains",doesNotContain:"does not contain",startsWith:"starts with",endsWith:"ends with",isOneOf:"one of",isNotOneOf:"not one of",isGreaterThan:"greater than",isLessThan:"less than",isGreaterThanOrEqualTo:"greater or equals",isLessThanOrEqualTo:"less or equals",isBetween:"between",isNotBetween:"not between",isBefore:"before",isAfter:"after",isToday:"today",isTomorrow:"tomorrow",isYesterday:"yesterday",isThisWeek:"this week",isNextWeek:"next week",isLastWeek:"last week",isThisMonth:"this month",isNextMonth:"next month",isLastMonth:"last month",isThisYear:"this year",isNextYear:"next year",isLastYear:"last year",isYearToDate:"year to date",isTrue:"true",isFalse:"false",selectAProperty:"Select property",selectAnOperator:"Select operator",caseSensitive:"Case-sensitive",and:"and",dateFormat:"D/M/YY",selectValue:"Select value",selectOneOrMoreValues:"Select value(s)",enterAValue:"Enter value",enterANumber:"Enter number",selectADate:"Select date",selectATime:"Select time"},FieldFilterPickerGroup:{addFilter:"Add filter"},DateHelper:{locale:"en-US",weekStartDay:0,nonWorkingDays:{0:!0,6:!0},weekends:{0:!0,6:!0},unitNames:[{single:"millisecond",plural:"ms",abbrev:"ms"},{single:"second",plural:"seconds",abbrev:"s"},{single:"minute",plural:"minutes",abbrev:"min"},{single:"hour",plural:"hours",abbrev:"h"},{single:"day",plural:"days",abbrev:"d"},{single:"week",plural:"weeks",abbrev:"w"},{single:"month",plural:"months",abbrev:"mon"},{single:"quarter",plural:"quarters",abbrev:"q"},{single:"year",plural:"years",abbrev:"yr"},{single:"decade",plural:"decades",abbrev:"dec"}],unitAbbreviations:[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],parsers:{L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A"},ordinalSuffix:e=>{let t="th";if(!["11","12","13"].find((t=>e.endsWith(t)))){t={1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th"}return e+t}}});const{toString:Qe}=Object.prototype,et=Qe.call(new Date),tt=new Date,nt=36e5,rt=(e,t)=>isNaN(e)||null==e?t:e,st=/([ES]){([^}]+)}/g,it=e=>{let t="th";if(!["11","12","13"].find((t=>e.endsWith(t)))){t={1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th"}return e+t},at=(e,t,n)=>(ft[e]||(ft[e]=new Intl.DateTimeFormat(ht,t))).format(n),ot=(e,t,n,r=!1)=>{let s=at(e,t,n);return/am|pm/i.test(s)&&(s=s.replace(/^0/,""),r&&(s=s.replace(/:00/,""))),s},lt=e=>e>=0?e:e+7,ct=/([^\w])(S+)/gm,dt=(e,t)=>t+"SSS",ut=/[:.\-/\s]/;let ht="en-US",gt=it,mt={},pt={},ft={},vt={};const yt=e=>{const t=bt[e];if(!t)throw new Error("Only international formats should be used here");if(void 0!==pt[e])return pt[e];const n=new Intl.DateTimeFormat(ht,t).formatToParts(new Date(2001,1,2,3,4,5,6)).map((e=>{const n=e.type,r=t[n];return"literal"===n?e.value.replace(/,/g,""):"day"===n?"numeric"===r?"D":"DD":"month"===n?"short"===r?"MMM":"long"===r?"MMMM":"numeric"===r?"M":"MM":"year"===n?"numeric"===r?"YYYY":"YY":void 0})).join("");return pt[e]=n},bt={l:{year:"numeric",month:"numeric",day:"numeric"},ll:{year:"numeric",month:"short",day:"numeric"}},Ct={M:e=>e.getMonth()+1,Mo:e=>gt(Ct.M(e).toString()),MM:e=>(e.getMonth()+1).toString().padStart(2,"0"),MMM:e=>at("MMM",{month:"short"},e),MMMM:e=>at("MMMM",{month:"long"},e),Q:e=>Math.ceil((e.getMonth()+1)/3),Qo:e=>gt(Ct.Q(e).toString()),D:e=>e.getDate(),Do:e=>gt(Ct.D(e).toString()),DD:e=>e.getDate().toString().padStart(2,"0"),DDD:e=>Math.ceil((new Date(e.getFullYear(),e.getMonth(),e.getDate(),12,0,0)-new Date(e.getFullYear(),0,0,12,0,0))/It.day.millisecond),DDDo:e=>gt(Ct.DDD(e).toString()),DDDD:e=>Ct.DDD(e).toString().padStart(3,"0"),d:e=>e.getDay(),do:e=>gt(e.getDay().toString()),d1:e=>at("d1",{weekday:"narrow"},e).substr(0,1),dd:e=>Ct.ddd(e).substring(0,2),ddd:e=>at("ddd",{weekday:"short"},e),dddd:e=>at("dddd",{weekday:"long"},e),u:e=>{const t=(ft.u||(ft.u=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"}))).formatToParts(e);return`${t[4].value}${t[2].value}${t[0].value}Z`},uu:e=>{const t=(ft.uu||(ft.uu=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}))).formatToParts(e);return`${t[4].value}${t[2].value}${t[0].value}T${t[6].value}${t[8].value}${t[10].value}Z`},e:e=>e.getDay(),E:e=>e.getDay()+1,W:e=>Bt.getWeekNumber(e)[1],Wo:e=>gt(Ct.W(e).toString()),WW:e=>Ct.W(e).toString().padStart(2,"0"),Wp:e=>`${Bt.localize("L{Week}")} ${Ct.W(e)}`,WWp:e=>`${Bt.localize("L{Week}")} ${Ct.WW(e)}`,Wp0:e=>`${Bt.localize("L{Week}")[0]}${Ct.W(e)}`,WWp0:e=>`${Bt.localize("L{Week}")[0]}${Ct.WW(e)}`,Y:e=>e.getFullYear(),YY:e=>(e.getFullYear()%100).toString().padStart(2,"0"),YYYY:e=>e.getFullYear(),A:e=>e.getHours()<12?"AM":"PM",a:e=>e.getHours()<12?"am":"pm",H:e=>e.getHours(),HH:e=>e.getHours().toString().padStart(2,"0"),h:e=>e.getHours()%12||12,hh:e=>Ct.h(e).toString().padStart(2,"0"),k:e=>e.getHours()||24,kk:e=>Ct.k(e).toString().padStart(2,"0"),K:e=>ot("K",{hour:"numeric"},e),KK:e=>ot("KK",{hour:"2-digit"},e),m:e=>e.getMinutes(),mm:e=>Ct.m(e).toString().padStart(2,"0"),s:e=>e.getSeconds(),ss:e=>Ct.s(e).toString().padStart(2,"0"),S:e=>Math.floor(e.getMilliseconds()/100).toString(),SS:e=>Math.floor(e.getMilliseconds()/10).toString().padStart(2,"0"),SSS:e=>e.getMilliseconds().toString().padStart(3,"0"),z:e=>at("z",{timeZoneName:"short"},e),zz:e=>at("zz",{timeZoneName:"long"},e),Z:e=>zt.getGMTOffset(e),LT:e=>ot("LT",{hour:"2-digit",minute:"2-digit"},e),LST:e=>ot("LST",{hour:"numeric",minute:"2-digit"},e,!0),LTS:e=>ot("LTS",{hour:"2-digit",minute:"2-digit",second:"2-digit"},e),L:e=>at("L",{year:"numeric",month:"2-digit",day:"2-digit"},e),l:e=>at("l",bt.l,e),LL:e=>at("LL",{year:"numeric",month:"long",day:"numeric"},e),ll:e=>at("ll",bt.ll,e),LLL:e=>at("LLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"},e),lll:e=>at("lll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},e),LLLL:e=>at("LLLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"long"},e),llll:e=>at("llll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"short"},e)},St=`^(?:${Object.keys(Ct).sort(((e,t)=>t.length-e.length)).join("|")})`,wt=()=>({}),Dt=e=>(e=>$t.test(e))(e)&&{milliseconds:parseInt(e.padEnd(3,"0").substring(0,3))},Tt={YYYY:e=>{const t=parseInt(e);return{year:t>=1e3&&t<=9999?t:NaN}},Y:e=>({year:parseInt(e)}),YY:e=>{const t=parseInt(e);return{year:t+(t>1968?1900:2e3)}},M:e=>({month:parseInt(e)-1}),MM:e=>({month:parseInt(e)-1}),Mo:e=>({month:parseInt(e)-1}),MMM:e=>{const t=(e||"").toLowerCase();for(const[e,n]of Object.entries(Bt._monthShortNamesIndex))if(t.startsWith(e))return{month:n.value}},MMMM:e=>{const t=(e||"").toLowerCase();for(const[e,n]of Object.entries(Bt._monthNamesIndex))if(t.startsWith(e))return{month:n.value}},DD:e=>({date:parseInt(e)}),D:e=>({date:parseInt(e)}),Do:e=>({date:parseInt(e)}),DDD:wt,DDDo:wt,DDDD:wt,d:wt,do:wt,d1:wt,dd:wt,ddd:wt,dddd:wt,Q:wt,Qo:wt,W:wt,Wo:wt,WW:wt,e:wt,E:wt,HH:e=>({hours:parseInt(e)}),hh:e=>({hours:parseInt(e)}),mm:e=>({minutes:parseInt(e)}),H:e=>({hours:parseInt(e)}),m:e=>({minutes:parseInt(e)}),ss:e=>({seconds:parseInt(e)}),s:e=>({seconds:parseInt(e)}),S:Dt,SS:Dt,SSS:Dt,A:e=>({amPm:e.toLowerCase()}),a:e=>({amPm:e.toLowerCase()}),L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A",l:{type:"dynamic",parser:()=>yt("l")},ll:{type:"dynamic",parser:()=>yt("ll")},Z:e=>{if(!e||!_t.test(e)&&"Z"!==e)return null;let t=0;if("Z"!==e){const n=_t.exec(e);if(n){t=("+"===n[1]?1:-1)*(60*(parseInt(n[2])||0)+(parseInt(n[3])||0))}else t=-1*(new Date).getTimezoneOffset()}return{timeZone:t}}},Et=Object.keys(Tt).sort(((e,t)=>t.length-e.length)),xt=new RegExp(`(${Et.join("|")})`),kt=new RegExp("^(LL|LLL|lll|LLLL|llll)$"),It={decade:{decade:1,year:10,quarter:40,month:120,week:520,day:3652,hour:87648,minute:5258880,second:315532800,millisecond:3155328e5},year:{decade:.1,year:1,quarter:4,month:12,week:52,day:365,hour:8760,minute:525600,second:31536e3,millisecond:31536e6},quarter:{decade:1/40,year:1/4,quarter:1,month:3,week:4,day:91,hour:2184,minute:131040,second:7862400,millisecond:78624e5},month:{decade:1/120,year:1/12,quarter:1/3,month:1,week:4,day:-30,hour:-720,minute:-43200,second:-2592e3,millisecond:-2592e6},week:{decade:-1/520,year:-1/52,quarter:-1/13,month:-1/4,day:7,hour:168,minute:10080,second:604800,millisecond:6048e5},day:{decade:-1/3652,year:-1/365,quarter:-1/91,month:-1/30,week:1/7,hour:24,minute:1440,second:86400,millisecond:864e5},hour:{decade:-1/87648,year:-1/8760,quarter:-1/2184,month:-1/720,week:1/168,day:1/24,minute:60,second:3600,millisecond:36e5},minute:{decade:-1/5258880,year:-1/525600,quarter:-1/131040,month:-1/43200,week:1/10080,day:1/1440,hour:1/60,second:60,millisecond:6e4},second:{decade:-1/315532800,year:-1/31536e3,quarter:-1/7862400,month:-1/2592e3,week:1/604800,day:1/86400,hour:1/3600,minute:1/60,millisecond:1e3},millisecond:{decade:-1/3155328e5,year:-1/31536e6,quarter:-1/78624e5,month:-1/2592e6,week:1/6048e5,day:1/864e5,hour:1/36e5,minute:1/6e4,second:.001}},Rt={ms:"millisecond",milliseconds:"millisecond",s:"second",seconds:"second",m:"minute",mi:"minute",min:"minute",minutes:"minute",h:"hour",hours:"hour",d:"day",days:"day",w:"week",weeks:"week",M:"month",mo:"month",mon:"month",months:"month",q:"quarter",quarters:"quarter",y:"year",years:"year",dec:"decade",decades:"decade"},Mt=/^\s*([-+]?\d+(?:[.,]\d*)?|[-+]?(?:[.,]\d+))\s*([^\s]+)?/i,Ot=/^\s*([-+]?\d+)(?![.,])\s*([^\s]+)?/i,At=["millisecond","second","minute","hour","day","week","month","quarter","year","decade"],Ft=[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],Pt=["decade","year","month","week","day","hour","minute","second","millisecond"],Lt=["milliseconds","seconds","minutes","hours","date","month","year"],$t=/^[0-9]+$/,_t=/([+-])(\d\d):*(\d\d)*$/,Nt={millisecond:0,second:1,minute:2,hour:3,day:4,week:5,month:6,quarter:7,year:8,decade:9},jt={round:(e,t=1)=>Math.round(e/t)*t,floor:(e,t=1)=>Math.floor(e/t)*t,ceil:(e,t=1)=>Math.ceil(e/t)*t},Vt={};class Bt extends(Je()){static MS_PER_DAY=864e5;static get $name(){return"DateHelper"}static set defaultFormat(e){zt._defaultFormat=e}static get defaultFormat(){return zt._defaultFormat||"YYYY-MM-DDTHH:mm:ssZ"}static set defaultParseFormat(e){this._defaultParseFormat=e}static get defaultParseFormat(){return this._defaultParseFormat||this._defaultFormat||"YYYY-MM-DDTHH:mm:ss.SSSZ"}static buildParser(e){const t=e.split(xt),n=[];return 1===t.length||kt.test(e)?[]:(t.reduce(((t,r,s,i)=>{if(0!==s||""!==r)if(xt.test(r)){const a=(this.localize("L{parsers}")||{})[r]||Tt[r];if("Z"===r&&s<i.length-2)throw new Error(`Invalid format ${e} TimeZone (Z) must be last token`);const o="function"==typeof a||"string"==typeof a?a:a.parser();if("string"==typeof o){const e=zt.buildParser(o),r=e.pop();delete r.last,n.push(...e),t=r}else t.pattern=r,t.fn=o}else t.splitter=r,n.push(t),t={};else Object.prototype.hasOwnProperty.call(t,"pattern")&&n.push(t);return t}),{}),n[n.length-1].last=!0,n)}static makeKey(e){if(10===e.length)return e;e.getTime&&(e=e.getTime());const t=Vt[Math.trunc(e/nt)];if(t)return t;tt.setTime(e);const n=tt.getMonth()+1,r=tt.getDate();return Vt[Math.trunc(e/nt)]=`${tt.getFullYear()}-${n<10?"0"+n:n}-${r<10?"0"+r:r}`}static parseKey(e){return zt.parse(e,"YYYY-MM-DD")}static parse(e,t=zt.defaultParseFormat,n=!1){if(e instanceof Date)return e;if("string"!=typeof e||!e)return null;const r={year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null};t=t.replace(ct,dt);let s,i=vt[t];if(i||(i=vt[t]=zt.buildParser(t)),e.includes("")&&(e=e.replace(/\s/g," ")),i.reduce(((e,t)=>{if(!t.last){let i,a,o;if("T"===t.splitter&&-1===e.indexOf("T"))i=e.indexOf(" ");else{var s;const r=e.indexOf("+");let{splitter:a}=t;!n&&ut.test(a)&&(a=ut),i=""!==t.splitter?e.search("string"==typeof a?T.escapeRegExp(a):a):(null===(s=t.pattern)||void 0===s?void 0:s.length)||-1,r>-1&&i>r&&(i=-1)}if(-1===i||"SSS"===t.pattern&&e.match(/^\d+Z$/)){const t=e.split(/([Z\-+])/);1===t.length?(a=e,o=""):(a=t[0],o=`${t[1]}${t[2]}`)}else a=e.substring(0,i)||e,o=e.substring(i+t.splitter.length);if(t.fn){const e=t.fn(a);e?Object.assign(r,e):o=a+o}return o}Object.assign(r,t.fn(e))}),e),r.year&&!r.date&&(r.date=1),r.date>31||r.month>12)return null;const a=zt.create(r,n);return a?s=a:n||(s=new Date(e)),s}static create(e,t=!1){const n={...e};let r=isNaN(n.year)||t&&(isNaN(n.month)||isNaN(n.date)),s=!1;if(!r){let e=!0;Lt.forEach((t=>{t in n&&!isNaN(n[t])||(n[t]=0),e=e&&null===n[t]})),r=e}if(r)return null;if("am"===n.amPm?n.hours=n.hours%12:"pm"===n.amPm&&(n.hours=n.hours%12+12),"timeZone"in n&&(s=!0,n.minutes-=n.timeZone),t&&(null==n.year||null==n.month||null==n.date))return null;const i=[rt(n.year,2020),rt(n.month,0),rt(n.date,1),n.hours,n.minutes,n.seconds,n.milliseconds];return s?new Date(Date.UTC(...i)):new Date(...i)}static toUTC(e){return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))}static format(e,t=zt.defaultFormat){if(!e||isNaN(e))return null;let n=mt[t],r="";if(!n){n=mt[t]=[];for(let e=0;e<t.length;e++){const r=t.slice(e).match(St),s=null==r?void 0:r[0];if(s){const t=(this.localize("L{formats}")||{})[s]||Ct[s];n.push(t),e+=s.length-1}else if("{"===t[e]){const r=t.indexOf("}",e+1);-1===r?(n.push(t.substr(e+1)),e=t.length):(n.push(t.substring(e+1,r)),e=r)}else n.push(t[e])}}return n.forEach((t=>{r+="string"==typeof t?t:t(e)})),r}static formatRange(e,t){return t.replace(st,((t,n,r)=>Bt.format(e["S"===n?0:1],r)))}static asMilliseconds(e,t=null){return"string"==typeof e&&(t=e,e=1),zt.as("millisecond",e,t)}static asMonths(e){const t=zt.as("ms",zt.daysInMonth(e),"day"),n=(e.valueOf()-zt.startOf(e,"month").valueOf())/t;return 12*e.getYear()+e.getMonth()+n}static monthsToDate(e){const t=Math.floor(e),n=e-t,r=new Date(0,t),s=zt.as("ms",zt.daysInMonth(r),"days");return r.setTime(r.getTime()+n*s),r}static formatDelta(e,t){let n,r;"boolean"==typeof t?n=t:t&&(n=t.abbrev);const s=this.getDelta(e,t),i=[],a=(null==t?void 0:t.separator)||(n?"":" ");for(r in s)i.push(`${s[r]}${a}${r}`);return!1===(null==t?void 0:t.asString)?i:i.join(", ")}static getDelta(e,t){let n,r,s,i,a,o,l;"boolean"==typeof t?n=t:t&&(n=t.abbrev,i=zt.normalizeUnit(t.precision),o=t.maxUnit,l=!n&&t.ignoreLocale);const c={},d=n?zt.getShortNameOfUnit:zt.getLocalizedNameOfUnit,u=o?Pt.slice(Pt.indexOf(o)):Pt;for(a of u)if(r=zt.as(a,e),s=i===a,r=Math[s?"round":"floor"](r),(r||s&&!c.length)&&(c[l?a:d.call(zt,a,1!==r)]=r,e-=zt.as("ms",r,a)),s||!e)break;return c}static as(e,t,n="ms"){return"string"==typeof t&&(t=zt.parseDuration(t)),"object"==typeof t&&(n=t.unit,t=t.magnitude),e===n||(e=zt.normalizeUnit(e))===(n=zt.normalizeUnit(n))?t:Nt[n]>Nt[e]?t*Math.abs(It[n][e]):t/Math.abs(It[e][n])}static formatContainsHourInfo(e){return/([HhKkmSsAa]|LT|L{3,}|l{3,})/.test(e.replace(/(\\.)/g,""))}static is24HourFormat(e){return zt.format(zt.getTime(13,0,0),e).includes("13")}static add(e,t,n="ms",r=!0){let s;if(s="string"==typeof e?zt.parse(e):r?new Date(e.getTime()):e,"string"==typeof t){const e=Bt.parseDuration(t);t=e.magnitude,n=e.unit}else t&&"object"==typeof t&&(n=t.unit,t=t.magnitude);if(!n||0===t)return s;switch(n=zt.normalizeUnit(n)){case"millisecond":s.setTime(s.getTime()+t);break;case"second":s.setTime(s.getTime()+1e3*t);break;case"minute":s.setTime(s.getTime()+6e4*t);break;case"hour":s.setTime(s.getTime()+36e5*t);break;case"day":t%1==0?(s.setDate(s.getDate()+t),23===s.getHours()&&0===e.getHours()&&s.setHours(s.getHours()+1)):s.setTime(s.getTime()+864e5*t);break;case"week":s.setDate(s.getDate()+7*t);break;case"month":{let e=s.getDate();e>28&&(e=Math.min(e,zt.getLastDateOfMonth(zt.add(zt.getFirstDateOfMonth(s),t,"month")).getDate())),s.setDate(e),s.setMonth(s.getMonth()+t);break}case"quarter":zt.add(s,3*t,"month",!1);break;case"year":s.setFullYear(s.getFullYear()+t);break;case"decade":s.setFullYear(s.getFullYear()+10*t)}return s}static diff(e,t,n="ms",r=!0){if(n=zt.normalizeUnit(n),!e||!t)return 0;let s;switch(n){case"year":s=zt.diff(e,t,"month")/12;break;case"quarter":s=zt.diff(e,t,"month")/3;break;case"month":s=12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth()),0===s&&r&&(s=zt.diff(e,t,"day",r)/zt.daysInMonth(e));break;case"week":s=zt.diff(e,t,"day")/7;break;case"day":{const n=e.getTimezoneOffset()-t.getTimezoneOffset();s=(t-e+60*n*1e3)/864e5;break}case"hour":s=(t-e)/36e5;break;case"minute":s=(t-e)/6e4;break;case"second":s=(t-e)/1e3;break;case"millisecond":s=t-e}return r?s:Math.round(s)}static startOf(e,t="day",n=!0,r=zt.weekStartDay){if(!e)return null;switch(t=zt.normalizeUnit(t),n&&(e=zt.clone(e)),t){case"year":return e.setMonth(0,1),e.setHours(0,0,0,0),e;case"quarter":return e.setMonth(3*(zt.get(e,"quarter")-1),1),e.setHours(0,0,0,0),e;case"month":return e.setDate(1),e.setHours(0,0,0,0),e;case"week":{const t=e.getDay()-r;return e.setDate(e.getDate()-t),e.setHours(0,0,0,0),e}case"day":return e.setHours(0,0,0,0),e;case"hour":e.getMinutes()>0&&e.setMinutes(0);case"minute":e.getSeconds()>0&&e.setSeconds(0);case"second":e.getMilliseconds()>0&&e.setMilliseconds(0);case"millisecond":return e}}static endOf(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}static clone(e){return new Date(e.getTime())}static clearTime(e,t=!0){return e?(t&&(e=new Date(e.getTime())),e.setHours(0,0,0,0),e):null}static midnight(e,t){let n=zt.clearTime(e);return t&&n<e&&(n=zt.add(n,1,"d")),n}static getTimeOfDay(e,t="ms"){const n=e.getHours()*It.hour.millisecond+e.getMinutes()*It.minute.millisecond+e.getSeconds()*It.second.millisecond+e.getMilliseconds();return"ms"===t?n:zt.as(t,n,"ms")}static set(e,t,n){if(!t)return e;if("string"==typeof t)switch(zt.normalizeUnit(t)){case"millisecond":(0!==n||e.getMilliseconds()>0)&&e.setMilliseconds(n);break;case"second":(0!==n||e.getSeconds()>0)&&e.setSeconds(n);break;case"minute":(0!==n||e.getMinutes()>0)&&e.setMinutes(n);break;case"hour":e.setHours(n);break;case"day":case"date":e.setDate(n);break;case"week":throw new Error("week not implemented");case"month":e.setMonth(n);break;case"quarter":e.setDate(1),e.setMonth(3*(n-1));break;case"year":e.setFullYear(n)}else Object.entries(t).sort(((e,t)=>Nt[e[0]]-Nt[t[0]])).forEach((([t,n])=>{zt.set(e,t,n)}));return e}static setDateToMidday(e,t=!0){return zt.set(zt.clearTime(e,t),"hour",12)}static constrain(e,t,n){return null!=t&&(e=zt.max(e,t)),null==n?e:zt.min(e,n)}static getTime(e,t=0,n=0,r=0){return e instanceof Date&&(r=e.getMilliseconds(),n=e.getSeconds(),t=e.getMinutes(),e=e.getHours()),new Date(2020,0,1,e,t,n,r)}static copyTimeValues(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),e}static get isDSTEnabled(){const e=(new Date).getFullYear(),t=new Date(e,0,1),n=new Date(e,6,1);return t.getTimezoneOffset()!==n.getTimezoneOffset()}static isDST(e){const t=e.getFullYear(),n=new Date(t,0,1),r=new Date(t,6,1);return e.getTimezoneOffset()<Math.max(n.getTimezoneOffset(),r.getTimezoneOffset())}static isBefore(e,t){return e<t}static isAfter(e,t){return e>t}static isEqual(e,t,n=null){return null===n?e&&t&&e.getTime()===t.getTime():zt.startOf(e,n)-zt.startOf(t,n)==0}static compare(e,t,n=null){return n&&(e=zt.startOf(e,n),t=zt.startOf(t,n)),e<t?-1:e>t?1:0}static clamp(e,t,n){if(!isNaN(e))return null!=t&&(e=Math.max(e,t)),null!=n&&(e=Math.min(e,n)),new Date(e)}static isSameDate(e,t){return 0===zt.compare(e,t,"d")}static isSameTime(e,t){return e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds()&&e.getMilliseconds()===t.getMilliseconds()}static isStartOf(e,t){return zt.isEqual(e,zt.startOf(e,t))}static betweenLesser(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<n.getTime()}static betweenLesserEqual(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<=n.getTime()}static intersectSpans(e,t,n,r){return zt.betweenLesser(e,n,r)||zt.betweenLesser(n,e,t)}static compareUnits(e,t){return Math.sign(Nt[zt.normalizeUnit(e)]-Nt[zt.normalizeUnit(t)])}static timeSpanContains(e,t,n,r){return n-e>=0&&t-r>=0}static get weekStartDay(){return null==zt._weekStartDay&&(zt._weekStartDay=this.localize("L{weekStartDay}")||0),zt._weekStartDay}static get nonWorkingDays(){return{...this.localize("L{nonWorkingDays}")}}static get nonWorkingDaysAsArray(){return Object.keys(this.nonWorkingDays).map(Number)}static get weekends(){return{...this.localize("L{weekends}")}}static get(e,t){switch(zt.normalizeUnit(t)){case"millisecond":return e.getMilliseconds();case"second":return e.getSeconds();case"minute":return e.getMinutes();case"hour":return e.getHours();case"date":case"day":return e.getDate();case"week":return Ct.W(e);case"month":return e.getMonth();case"quarter":return Math.floor(e.getMonth()/3)+1;case"year":return e.getFullYear()}return null}static daysInYear(e){const t=e.getFullYear(),n=new Date(t+1,0,1)-new Date(t,0,1);return this.as("day",n)}static daysInMonth(e){return 32-new Date(e.getFullYear(),e.getMonth(),32).getDate()}static hoursInDay(e){const t=e.getFullYear(),n=e.getMonth(),r=e.getDate(),s=new Date(t,n,r+1)-new Date(t,n,r);return this.as("hour",s)}static getNormalizedUnitDuration(e,t){let n;switch(t){case"month":n=zt.asMilliseconds(zt.daysInMonth(e),"day");break;case"year":n=zt.asMilliseconds(zt.daysInYear(e),"day");break;case"day":n=zt.asMilliseconds(zt.hoursInDay(e),"hour");break;default:n=zt.asMilliseconds(t)}return n}static getFirstDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth(),1)}static getLastDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}static min(e,t){return e.getTime()<t.getTime()?e:t}static max(e,t){return e.getTime()>t.getTime()?e:t}static getNext(e,t,n=1,r=zt.weekStartDay){if("week"===t){const t=zt.clone(e),s=t.getDay();return zt.startOf(t,"day",!1),zt.add(t,r-s+7*(n-(r<=s?0:1)),"day",!1),t.getDay()!==r&&zt.add(t,1,"hour"),t}return zt.startOf(zt.add(e,n,t),t,!1)}static isValidDate(e){return zt.isDate(e)&&!isNaN(e)}static isDate(e){return e&&Qe.call(e)===et}static getStartOfNextDay(e,t=!1,n=!1){let r=zt.add(n?e:zt.clearTime(e,t),1,"day");if(r.getDate()===e.getDate()){const n=zt.add(zt.clearTime(e,t),2,"day").getTimezoneOffset(),s=e.getTimezoneOffset();r=zt.add(r,s-n,"minute")}return r}static getEndOfPreviousDay(e,t=!1){const n=t?e:zt.clearTime(e,!0);return n-e?n:zt.add(n,-1,"day")}static getWeekDescription(e,t=e){const n=e.getMonth()===t.getMonth()?Bt.format(e,"MMMM"):`${Bt.format(e,"MMM")} - ${Bt.format(t,"MMM")}`,r=Bt.getWeekNumber(e);return`${r[1]}, ${n} ${r[0]}`}static getWeekNumber(e,t=Bt.weekStartDay){const n=new Date(e.getFullYear(),0,1),r=new Date(e.getFullYear(),11,31),s=lt(n.getDay()-t),i=lt(r.getDay()-t),a=(o=e,l=n,Math.floor((o.getTime()-l.getTime()-(o.getTimezoneOffset()-l.getTimezoneOffset())*It.minute.millisecond)/It.day.millisecond)+1);var o,l;let c;if(c=s<4?Math.floor((a+s-1)/7)+1:Math.floor((a+s-1)/7),c){let t=e.getFullYear();return 53===c&&i<3&&(t++,c=1),[t,c]}const d=Bt.getWeekNumber(new Date(e.getFullYear()-1,11,31))[1];return[e.getFullYear()-1,d]}static formatCount(e,t){return t=zt.normalizeUnit(t),1!==e&&(t+="s"),e+" "+t}static getUnitToBaseUnitRatio(e,t,n=!1){return(e=zt.normalizeUnit(e))===(t=zt.normalizeUnit(t))?1:It[e]&&It[e][t]&&(n||It[e][t]>0)?1/zt.as(t,1,e):It[t]&&It[t][e]&&(n||It[t][e]>0)?zt.as(e,1,t):-1}static getShortNameOfUnit(e){return e=zt.parseTimeUnit(e),zt.unitLookup[e].abbrev}static getLocalizedNameOfUnit(e,t=!1){const n=e.charAt(0)===e.charAt(0).toUpperCase();return e=zt.normalizeUnit(e),e=zt.parseTimeUnit(e),e=zt.unitLookup[e][t?"plural":"single"],n&&(e=T.capitalize(e)),e}static normalizeUnit(e){if(!e)return null;const t=e.toLowerCase();return"date"===t||At.includes(t)?t:Rt[e]||Rt[t]}static getUnitByName(e){return zt.normalizeUnit(e)||zt.normalizeUnit(zt.parseTimeUnit(e))}static getDurationInUnit(e,t,n,r){return zt.diff(e,t,n,r)}static doesUnitsAlign(e,t){return!(e!==t&&"week"===t)}static getSmallerUnit(e){return At[Nt[zt.normalizeUnit(e)]-1]||null}static getLargerUnit(e){return At[Nt[zt.normalizeUnit(e)]+1]||null}static round(e,t,n,r){return zt.snap("round",e,t,n,r)}static floor(e,t,n,r){return zt.snap("floor",e,t,n,r)}static ceil(e,t,n,r){return zt.snap("ceil",e,t,n,r)}static snap(e,t,n,r,s=zt.weekStartDay){const i=jt[e];if("string"==typeof n&&(n=zt.parseDuration(n)),F.isObject(n)){const a=n.magnitude||n.increment;switch(n.unit){case"week":if(!r){const e=t.getDay();r=zt.add(zt.clearTime(t),e>=s?s-e:-(e-s+7),"day")}return zt[e](t,7*a+" days",r);case"month":{let e;return t=zt.asMonths(t),e=r?(r=zt.asMonths(r))+i(t-r,a):i(t,a),zt.monthsToDate(e)}case"quarter":return zt[e](t,3*a+" months",r);case"year":return zt[e](t,12*a+" months",r);case"decade":return zt[e](t,10*a+" years",r)}n=zt.as("ms",a,n.unit)}const a=1e3*t.getTimezoneOffset()*60;if(r){const e=1e3*r.getTimezoneOffset()*60,s=t-r+e-a,o=new Date(r.getTime()+i(s,n)),l=e-1e3*o.getTimezoneOffset()*60;return l&&zt.add(o,-l,"ms",!1),new Date(o)}return new Date(i(t.valueOf()-a,n)+a)}static parseDuration(e,t=!0,n){var r;const s=(t?Mt:Ot).exec(e);if(null==e||!s)return null;const i=(e=>{const t=parseFloat(e);return isNaN(t)?null:t})(null===(r=s[1])||void 0===r?void 0:r.replace(",",".")),a=zt.parseTimeUnit(s[2])||n;return a?{magnitude:i,unit:a}:null}static parseTimeUnit(e){const t=null==e?null:zt.durationRegEx.exec(e.toLowerCase());if(!t)return null;for(let e=0;e<At.length;e++)if(t[e+1])return At[e]}static getGMTOffset(e=new Date){if(!e)return;const t=e.getTimezoneOffset();return t?(t>0?"-":"+")+Math.abs(Math.trunc(t/60)).toString().padStart(2,"0")+":"+Math.abs(t%60).toString().padStart(2,"0"):"Z"}static fillDayNames(){const e=new Date("2000-01-01T12:00:00"),t=zt._dayNames||[],n=zt._dayShortNames||[];t.length=0,n.length=0;for(let r=2;r<9;r++)e.setDate(r),t.push(zt.format(e,"dddd")),n.push(zt.format(e,"ddd"));zt._dayNames=t,zt._dayShortNames=n}static getDayNames(){return zt._dayNames}static getDayName(e){return zt._dayNames[e]}static getDayShortNames(){return zt._dayShortNames}static getDayShortName(e){return zt._dayShortNames[e]}static fillMonthNames(){const e=new Date("2000-01-15T12:00:00"),t=zt._monthNames||[],n=zt._monthShortNames||[],r={},s={};t.length=0,n.length=0;for(let i=0;i<12;i++){e.setMonth(i);const a=zt.format(e,"MMMM");t.push(a);const o=zt.format(e,"MMM");n.push(o),r[a.toLowerCase()]={name:a,value:i},s[o.toLowerCase()]={name:o,value:i}}zt._monthNames=t,zt._monthShortNames=n,zt._monthNamesIndex=r,zt._monthShortNamesIndex=s}static getMonthShortNames(){return zt._monthShortNames}static getMonthShortName(e){return zt._monthShortNames[e]}static getMonthNames(){return zt._monthNames}static getMonthName(e){return zt._monthNames[e]}static set locale(e){ht=e,ft={},mt={},pt={}}static get locale(){return ht}static setupDurationRegEx(e=[],t=[]){const n=this,r={};let s="";for(let i=0;i<t.length;i++){const a=t[i],o=e[i];o.canonicalUnitName=At[i],r[o.single]=r[o.single.toUpperCase()]=r[o.canonicalUnitName]=r[o.canonicalUnitName.toUpperCase()]=o,s+=(i?"|":"")+"(";for(let e=0;e<a.length;e++)s+=`${a[e]}|`;if(ht=n.localize("L{locale}")||"en-US","en-US"!==ht){const e=Ft[i];for(let t=0;t<e.length;t++)s+=`${e[t]}|`}s+=`${o.single}|${o.plural}|${o.canonicalUnitName}|${o.canonicalUnitName}s)`}n.unitLookup=r,n.durationRegEx=new RegExp(`^(?:${s})$`)}static applyLocale(){const e=this,t=e.localize("L{unitAbbreviations}")||[],n=e.unitNames=e.localize("L{unitNames}");"unitNames"!==n&&(ht=e.localize("L{locale}")||"en-US",gt="en-US"===ht?it:e.localize("L{ordinalSuffix}")||gt,mt={},pt={},vt={},ft={},zt._weekStartDay=null,zt.setupDurationRegEx(n,t),zt.fillDayNames(),zt.fillMonthNames())}}const zt=Bt;zt.useIntlFormat=at,Ue.ion({locale:"applyLocale",prio:1e3,thisObj:zt}),Ue.locale&&zt.applyLocale(),Bt._$name="DateHelper";const{hasOwn:Wt}=F,Ht="1.01"===1.005.toFixed(2)?null:function(e,t){const n=e.toString().split("."),r=+(n[1]?n.join(".")+"1":n[0]);return e.toFixed.call(r,t)};class Ut extends F{static transformArrayToNamedObject(e,t="ref"){const n={};return e.forEach(((e,r)=>{const s=null!=e[t]&&e[t].toString().length?e[t]:r;n[s]=e})),n}static transformNamedObjectToArray(e,t="ref"){return Object.keys(e).filter((t=>e[t])).map((n=>{const r=e[n];return r[t]=n,r}))}static isEqual(e,t,n=!1){if(null===e&&null!==t||void 0===e&&void 0!==t||null===t&&null!==e||void 0===t&&void 0!==e)return!1;if(null==e&&null==t)return!0;if(e===t)return!0;const r=typeof e;if(r===typeof t){switch(r){case"number":case"string":case"boolean":return e===t}switch(!0){case e instanceof Date&&t instanceof Date:return e.getTime()===t.getTime();case Array.isArray(e)&&Array.isArray(t):return e.length===t.length&&e.every(((e,r)=>Yt.isEqual(e,t[r],n)));case"object"===r&&e.constructor.prototype===t.constructor.prototype:return n?Yt.isDeeplyEqual(e,t,n):T.safeJsonStringify(e,"circular")===T.safeJsonStringify(t,"circular")}}return String(e)===String(t)}static isDeeplyEqual(e,t,n={}){if(e===t)return!0;if(!e||!t)return!1;const r=Yt.keys(e,n.ignore),s=Yt.keys(t,n.ignore);if(r.length!==s.length)return!1;for(let i=0;i<r.length;i++){const a=r[i],o=s[i];if(a!==o)return!1;const l=e[a],c=t[o];if(!n.shouldEvaluate||!1!==n.shouldEvaluate(a,{value:l,object:e},{value:c,object:t})){if(n.evaluate){const r=n.evaluate(a,{value:l,object:e},{value:c,object:t});if(!1===r)return!1;if(!0===r)continue}if(!Yt.isEqual(l,c,n))return!1}}return!0}static isPartial(e,t){return e=String(e).toLowerCase(),t=String(t).toLowerCase(),-1!==e.indexOf(t)}static isLessThan(e,t){return e instanceof Date&&t instanceof Date?Bt.isBefore(e,t):e<t}static isMoreThan(e,t){return e instanceof Date&&t instanceof Date?Bt.isAfter(e,t):e>t}static fork(e){let t,n,r;if(e&&e.constructor===Object)for(n in t=Object.setPrototypeOf({},e),e)r=e[n],r&&(r.constructor===Object?t[n]=Yt.fork(r):r instanceof Array&&(t[n]=r.slice()));else t=e;return t}static copyProperties(e,t,n){let r,s;for(s=0;s<n.length;s++)r=n[s],r in t&&(e[r]=t[r]);return e}static copyPropertiesIf(e,t,n){if(t)for(const r of n)!(r in e)&&r in t&&(e[r]=t[r]);return e}static entries(e,t){const n=[],r="function"==typeof t;if(e)for(const s in e)(r?t(s,e[s]):null!=t&&t[s])||n.push([s,e[s]]);return n}static fromEntries(e,t){if(t=t||{},e)for(let n=0;n<e.length;++n)t[e[n][0]]=e[n][1];return t}static keys(e,t,n){const r=[],s="function"==typeof t;if(e){let i=0;for(const a in e)(s?t(a,e[a]):null!=t&&t[a])||(r.push(n?n(a,i):a),++i)}return r}static values(e,t,n){const r=[],s="function"==typeof t;if(e){let i=0;for(const a in e)(s?t(a,e[a]):null!=t&&t[a])||(r.push(n?n(e[a],i):e[a]),++i)}return r}static pathExists(e,t){return t.split(".").every((t=>!(!e||!(t in e))&&(e=e[t],!0)))}static pathifyKeys(e,t){const n={};for(const r in e)if(Wt(e,r)){const s=null==t?void 0:t[r],i="object"===(null==s?void 0:s.type)||(null==s?void 0:s.complexMapping)||!Boolean(t);if(i&&Array.isArray(e[r]))n[r]=e[r].slice();else if(i&&e[r]instanceof Object){const t=this.pathifyKeys(e[r]);for(const e in t)n[`${r}.${e}`]=t[e]}else n[r]=e[r]}return n}static deletePath(e,t){t.split(".").reduce(((e,t,n,r)=>{if(null==e)return null;if(Wt(e,t)){if(n!==r.length-1)return e[t];delete e[t]}}),e)}static coerce(e,t){const n=F.typeOf(e),r=F.typeOf(t),s="string"==typeof e;if(n!==r)switch(r){case"string":return String(e);case"number":return Number(e);case"boolean":return!(s&&(!e||"false"===e||"0"===e))&&Boolean(e);case"null":return!(!s||e&&"null"!==e)&&null;case"undefined":return!(!s||e&&"undefined"!==e)&&void 0;case"date":return s&&isNaN(e)?Bt.parse(e):Date(Number(e))}return e}static wrapProperty(e,t,n,r,s=!0){const i={};let a=Object.getPrototypeOf(e),o=Object.getOwnPropertyDescriptor(a,t);for(;!o&&a&&s;)a=Object.getPrototypeOf(a),a&&(o=Object.getOwnPropertyDescriptor(a,t));o?(o.set?i.set=t=>{o.set.call(e,t),r&&r.call(e,o.get.call(e))}:i.set=r,o.get?i.get=()=>{let t=o.get.call(e);return n&&(t=n.call(e,t)),t}:i.get=n):(i.set=n=>{e[`_${t}`]=n,r&&r.call(e,n)},i.get=()=>{let r=e[`_${t}`];return n&&(r=n.call(e,r)),r}),Object.defineProperty(e,t,i)}static hookProperty(e,t,n){const r=Ut.getPropertyDescriptor(n.prototype,"value"),s=Ut.getPropertyDescriptor(e,t),i=`_${t}`,a=class{get value(){return s?s.get.call(this):this[i]}set value(e){s?s.set.call(this,e):this[i]=e}},o=Ut.getPropertyDescriptor(a.prototype,"value");return Object.setPrototypeOf(n.prototype,a.prototype),Object.defineProperty(e,t,{configurable:!0,get:r.get||o.get,set:r.set||o.set}),()=>delete e[t]}static getPropertyDescriptor(e,t){let n=null;for(let r=e;r&&!n&&!Wt(r,"isBase");r=Object.getPrototypeOf(r))n=Object.getOwnPropertyDescriptor(r,t);return n}static cleanupProperties(e,t=!1){return Object.entries(e).forEach((([n,r])=>{t?void 0===r&&delete e[n]:null==r&&delete e[n]})),e}static removeAllProperties(e){return Object.keys(e).forEach((t=>delete e[t])),e}static assertType(e,t,n){const r=F.typeOf(e);if(null!=e&&r!==t)throw new Error(`Incorrect type "${r}" for ${n}, expected "${t}"`)}static assertObject(e,t){Yt.assertType(e,"object",t)}static assertInstance(e,t){Yt.assertType(e,"instance",t)}static assertClass(e,t){Yt.assertType(e,"class",t)}static assertFunction(e,t){if("function"!=typeof e||e.isBase||e.$$name)throw new Error(`Incorrect type for ${t}, got "${e}" (expected a function)`)}static assertNumber(e,t){const n=Number(e);if("number"!=typeof e||isNaN(n))throw new Error(`Incorrect type for ${t}, got "${e}" (expected a Number)`)}static assertBoolean(e,t){Yt.assertType(e,"boolean",t)}static assertString(e,t){Yt.assertType(e,"string",t)}static assertArray(e,t){Yt.assertType(e,"array",t)}static toFixed(e,t){return Ht?Ht(e,t):e.toFixed(t)}static roundTo(e,t=1){return Math.round(e/t)*t}static round(e,t){if(null==t)return e;const n=10**t;return Math.round(e*n)/n}static getMapPath(e,t,n){const r=Array.isArray(t)?t:"string"==typeof t?t.split("."):[t],s=1===r.length,i=r[0],a=e.has(i)?e.get(i):e.set(i,s?n:{}).get(i);return s?a:Yt.getPathDefault(a,r.slice(1),n)}}const Yt=Ut;let qt;Ut._$name="ObjectHelper";const Kt=["border-top-width","border-right-width","border-bottom-width","border-left-width"],Gt=["margin-top","margin-right","margin-bottom","margin-left"],Xt=["padding-top","padding-right","padding-bottom","padding-left"],Zt="border-top-width",Jt="border-right-width",Qt="border-bottom-width",en="border-left-width",tn="padding-top",nn="padding-right",rn="padding-bottom",sn="padding-left",an=/^([trblc])(\d*)-([trblc])(\d*)$/i,on=/^([trblc])(\d*)$/i,ln=["top","right","bottom","left"],cn={t:0,r:1,b:2,l:3},dn=["b-t","l-r","t-b","r-l"],un={bt:1,tb:1,lr:2,rl:2},hn=Object.freeze([0,0]),gn=["width","height"],mn=(e,t=e,n=e,r=t)=>Array.isArray(e)?mn.apply(null,e):[e,t,n,r],pn=Object.freeze([]);function fn(e){return`${ln[(cn[e.myEdge]+2)%4][0]}${e.myOffset}-${ln[(cn[e.targetEdge]+2)%4][0]}${e.targetOffset}`}class vn{isRectangle=!0;static from(e,t,n){var s,i;if("string"==typeof e?e=document.querySelector(e):(null===(s=e)||void 0===s?void 0:s.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&(e=e.host||e.ownerDocument),"string"==typeof t&&(t=document.querySelector(t)),null==e||e.isRectangle)return e;if(e=e.element||e,void 0===n&&"boolean"==typeof t&&(n=t,t=null),null===(i=t)||void 0===i||!i.isRectangle)if(t){let{scrollLeft:e,scrollTop:n}=t;r.isSafari&&t===document.body&&(e=n=0),t=vn.from(t).translate(-e,-n)}else qt||(qt=new vn(0,0,0,0)),t=qt;const a=e===document||e===globalThis,o=e===document.body&&0===document.body.offsetHeight,l=o&&e.getBoundingClientRect(),c=o?new vn(l.left,l.top,l.width,document.body.parentElement.scrollHeight):a?new vn(0,0,globalThis.innerWidth,globalThis.innerHeight):e.getBoundingClientRect(),d=n||a?[0,0]:[globalThis.pageXOffset,globalThis.pageYOffset];return new vn(c.left+d[0]-t.x,c.top+d[1]-t.y,c.width,c.height)}static fromScreen(e,t){return vn.from(e,t,!0)}static inner(e,t,n=!1){const r=this.from(e,t,n);if(document.body.contains(e)){const t=yr.getStyleValue(e,Kt);r.x+=parseFloat(t[en]),r.y+=parseFloat(t[Zt]),r.right-=parseFloat(t[Jt]),r.bottom-=parseFloat(t[Qt])}return r}static content(e,t,n=!1){const r=this.from(e,t,n);if(document.body.contains(e)){const t=yr.getStyleValue(e,Kt),n=yr.getStyleValue(e,Xt);r.x+=parseFloat(t[en])+parseFloat(n[sn]),r.y+=parseFloat(t[Zt])+parseFloat(n[tn]),r.right-=parseFloat(t[Jt])+parseFloat(n[nn]),r.bottom-=parseFloat(t[Qt])+parseFloat(n[rn])}return r}static client(e,t,n=!1,r){const s=this.content(e,t,n),i=yr.scrollBarWidth,a=r?[...e.children].filter((e=>"sticky"===yr.getStyleValue(e,"position"))):pn;let o;i&&!e.classList.contains("b-hide-scroll")&&(e.scrollHeight>e.clientHeight&&"hidden"!==yr.getStyleValue(e,"overflow-y")&&(o=parseFloat(yr.getStyleValue(e,"padding-right")),s.right+=o-Math.max(o,i)),e.scrollWidth>e.clientWidth&&"hidden"!==yr.getStyleValue(e,"overflow-x")&&(o=parseFloat(yr.getStyleValue(e,"padding-bottom")),s.bottom+=o-Math.max(o,i)));for(let e=0,{length:t}=a;e<t;e++){const t=a[e],n=this.fromScreen(t);0===parseFloat(yr.getStyleValue(t,"left"))?s.x+=n.width:0===parseFloat(yr.getStyleValue(t,"right"))?s.right-=n.width:0===parseFloat(yr.getStyleValue(t,"top"))?s.y+=n.height:0===parseFloat(yr.getStyleValue(t,"bottom"))&&(s.bottom-=n.height)}return s}static outer(e,t,n=!1){const r=this.from(e,t,n);if(document.body.contains(e)){const t=yr.getStyleValue(e,Gt);r.x-=parseFloat(t["margin-left"]),r.y-=parseFloat(t["margin-top"]),r.right+=parseFloat(t["margin-right"]),r.bottom+=parseFloat(t["margin-bottom"])}return r}static union(...e){let t,{x:n,y:r,right:s,bottom:i}=e[0];if(e.length>1)for(let a=1;a<e.length;a++)t=e[a],t.x<n&&(n=t.x),t.y<r&&(r=t.y),t.right>s&&(s=t.right),t.bottom>i&&(i=t.bottom);return new vn(n,r,s-n,i-r)}roundPx(e=globalThis.devicePixelRatio||1){const t=this;return t._x=yr.roundPx(t._x,e),t._y=yr.roundPx(t._y,e),t._width=yr.roundPx(t._width,e),t._height=yr.roundPx(t._height,e),t}static get $$name(){return hasOwnProperty.call(this,"$name")&&this.$name||hasOwnProperty.call(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}constructor(e,t,n,r){Ut.assertNumber(e,"Rectangle.x"),Ut.assertNumber(t,"Rectangle.y"),Ut.assertNumber(n,"Rectangle.width"),Ut.assertNumber(r,"Rectangle.height");const s=this;n<0&&(e+=n,n=-n),r<0&&(t+=r,r=-r),s._x=e,s._y=t,s._width=n,s._height=r}clone(){const e=this,t=new vn(e.x,e.y,e.width,e.height);return t.isAlignRectangle=e.isAlignRectangle,t.minHeight=e.minHeight,t.minWidth=e.minWidth,t}contains(e){const t=this;return!!e.isRectangle&&(e._x>=t._x&&e._y>=t._y&&e.right<=t.right&&e.bottom<=t.bottom)}intersect(e,t=!1,n=!1){const r=this,s=Math.max(r.y,e.y),i=Math.min(r.right,e.right),a=Math.min(r.bottom,e.bottom),o=Math.max(r.x,e.x);return!!(n?a>=s&&i>=o:a>s&&i>o)&&(!!t||new vn(o,s,i-o,a-s))}equals(e,t=!1){const n=t?e=>Math.round(e):e=>e;return e.isRectangle&&n(e.x)===n(this.x)&&n(e.y)===n(this.y)&&n(e.width)===n(this.width)&&n(e.height)===n(this.height)}translate(e,t){return this._x+=e||0,this._y+=t||0,this}moveTo(e,t){return null!=e&&(this._x=e),null!=t&&(this._y=t),this}getDelta(e){return[e.x-this.x,e.y-this.y]}get center(){const e=new yn(this.x+this.width/2,this.y+this.height/2,0,0);return e.target=this.target,e}set x(e){const t=e-this._x;this._x=e,this._width-=t}get x(){return this._x}get start(){return this.left}set left(e){this.x=e}get left(){return this.x}set top(e){this.y=e}get top(){return this.y}set y(e){const t=e-this._y;this._y=e,this._height-=t}get y(){return this._y}set width(e){this._width=e}get width(){return this._width}set height(e){this._height=e}get height(){return this._height}set right(e){this._width=e-this._x}get right(){return this._x+this._width}get end(){return this.right}set bottom(e){this._height=e-this._y}get bottom(){return this._y+this._height}getStart(e,t=!0){return t?e?this.right:this.left:this.top}getEnd(e,t=!0){return t?e?this.left:this.right:this.bottom}get area(){return this.width*this.height}set minWidth(e){const t=this;isNaN(e)?t._minWidth=null:(t._minWidth=Number(e),t.isAlignRectangle||(t.width=Math.max(t.width,t._minWidth)))}get minWidth(){return this._minWidth}set minHeight(e){const t=this;isNaN(e)?t._minHeight=null:(t._minHeight=Number(e),t.isAlignRectangle||(t.height=Math.max(t.height,t._minHeight)))}get minHeight(){return this._minHeight}adjust(e,t,n,r){const s=this;return s.x+=e,s.y+=t,s.width+=n,s.height+=r,s}inflate(e,t=e,n=e,r=t){return Array.isArray(e)&&([e,t,n,r]=mn(e)),this.adjust(-r,-e,t,n)}deflate(e,t=e,n=e,r=t){return Array.isArray(e)&&([e,t,n,r]=mn(e)),this.adjust(r,e,-t,-n)}constrainTo(e,t){const n=this,r=n.height,s=n.y,i=n.minWidth||n.width,a=n.minHeight||n.height;if(n.height>=e.height){if(t&&a>e.height)return!1;n._y=e.y,n.height=e.height}if(n.width>=e.width){if(t&&i>e.width)return n.y=s,n.height=r,!1;n._x=e.x,n.width=e.width}return n.translate.apply(n,n.constrainVector=[Math.min(e.right-n.right,0),Math.min(e.bottom-n.bottom,0)]),n.translate(Math.max(e.x-n.x,0),Math.max(e.y-n.y,0)),n}alignTo(e){let t,n,r,s,i=this.clone(),{target:a,constrainTo:o,constrainPadding:l}=e;if(a&&!a.isRectangle&&(a=vn.from(a.element?a.element:a)),o){if(!o.isRectangle){s=o===globalThis||o===document;const t="ignorePageScroll"in e?e.ignorePageScroll:!s;o=vn.from(o.element?o.element:o,null,t)}l&&(l=mn(l),l[0]=Math.min(l[0],a.top),l[1]=Math.min(l[1],o.right-a.right),l[2]=Math.min(l[2],o.bottom-a.bottom),l[3]=Math.min(l[3],a.left),o=o.deflate.apply(o.clone(),l))}const c=this,d=null==(T=e.offset)?hn:"number"==typeof T?[T,T]:T,{align:u,axisLock:h,anchorSize:g,anchorPosition:m,matchSize:p,position:f,rtl:v}=e,y=function(e,t){const n=an.exec(e),r=n[1],s=n[3],i=parseInt(n[2]||50),a=parseInt(n[4]||50),o=!t||1&cn[r]?i:100-i,l=!t||1&cn[s]?a:100-a;return{myAlignmentPoint:r+o,myEdge:r,myOffset:o,targetAlignmentPoint:s+l,targetEdge:s,targetOffset:l,startZone:cn[s],edgeAligned:un[r+s]}}(u,v),b=o&&o.clone(),C=[],S=[{zone:n=y.startZone,align:u}],w=p&&gn[1&y.startZone],D=c[w];var T;if(w&&h?i[w]=a[w]:!y.edgeAligned&&p&&(i.width=a.width,i.height=a.height),o&&i.constrainTo(o),o&&null!=y.startZone)if(h)S.push({zone:n=(n+2)%4,align:fn(y)}),"flexible"===h&&(S.push({zone:n=(y.startZone+1)%4,align:dn[n]}),S.push({zone:n=(n+2)%4,align:dn[n]}));else for(let e=1;e<4;e++)S.push({zone:n=(n+1)%4,align:dn[n]});if(m){const e=1&y.startZone?"y":"x";t={[e]:m[e],edge:ln[(y.startZone+2)%4]}}if(b&&a&&(b.adjust(-a.width,-a.height,a.width,a.height),a.constrainTo(b)),i.minWidth=c.minWidth,i.minHeight=c.minHeight,f)i.moveTo(f.x,f.y),i.translate.apply(i,d),o&&i.constrainTo(o);else{const e="c"===y.myEdge||"c"===y.targetEdge,n=g&&!e?[g[1]+d[0],g[1]+d[1]]:d,l=a.getAlignmentPoint(y.targetAlignmentPoint,n),u=i.getAlignmentPoint(y.myAlignmentPoint);i.translate(l[0]-u[0],l[1]-u[1]);let m=i.intersect(a,!0);if(m)o&&i.constrainTo(o),r=y.startZone,i.translate(...n);else if(o&&!o.contains(i)){const e=i.clone(),l=[];let d,u;t=null,C[0]=d=o.clone(),d.bottom=a.y-n[1],C[1]=d=o.clone(),d.x=a.right+n[0],C[2]=d=o.clone(),d.y=a.bottom+n[1],C[3]=d=o.clone(),d.right=a.x-n[0];for(let e=0;e<S.length;e++){if(w&&2==e&&(i[w]=D),d=C[r=S[e].zone],i=i.alignTo({target:a,offsets:n,align:S[e].align}),i.constrainTo(d,!0)&&(l.push({result:i,zone:r}),!u||i.width<c.width||i.height<c.height)){i.align=S[e].align;break}if(!u||d.area>u.area){const e=i.clone();switch(r){case 0:e.moveTo(null,d.bottom-e.height);break;case 1:e.moveTo(d.left);break;case 2:e.moveTo(null,d.top);break;case 3:e.moveTo(d.right-e.width)}u={area:d.area,result:e,zone:r}}}l.length?(l.length>1&&!h&&l.sort(((t,n)=>Math.sqrt((e.x-t.result.x)**2+(e.y-t.result.y)**2)-Math.sqrt((e.x-n.result.x)**2+(e.y-n.result.y)**2))),i=l[0].result,r=l[0].zone):(i=u.result,r=u.zone,s&&i.constrainTo(o))}else r=y.startZone;if(i.zone=r,i.overlap=m=i.intersect(a,!0),g&&!m){if(!t){const e=1&r,n=e?"y":"x",s=e?"bottom":"right",o=Math.max(a[n],i[n]);let l=o+(Math.min(a[s],i[s])-o)/2-g[0]/2;const c=l+g[0];c>i[s]&&(l-=c-i[s]),l<i[n]&&(l+=i[n]-l),t={[n]:l-i[n],edge:ln[(r+2)%4]}}i.anchor=t}}return i}getAlignmentPoint(e,t=hn){const n=this,r=on.exec(e),s=r[1].toLowerCase(),i=Math.min(Math.max(parseInt(r[2]||50),0),100)/100;switch(s){case"t":return[n.x+n.width*i,n.y-t[1]];case"r":return[n.right+t[0],n.y+n.height*i];case"b":return[n.x+n.width*i,n.bottom+t[1]];case"l":return[n.x-t[0],n.y+n.height*i];case"c":return[n.x+n.width/2,n.y+n.height/2]}}highlight(){const e=this,t=yr.createElement({parent:document.body,style:`position:absolute;z-index:9999999;pointer-events:none;\n                            left:${e.x}px;top:${e.y}px;width:${e.width}px;height:${e.height}px`});return yr.highlight(t).then((()=>t.remove()))}visualize(e,t){const n=this,r=Ut.merge({style:{left:`${n.x}px`,top:`${n.y}px`,width:`${n.width}px`,height:`${n.height}px`,pointerEvents:"none",...e.class?{}:{position:"absolute","z-index":9999999}}},e);return t?r:yr.createElement(r)}toString(e=","){return[`${this.top}px`,`${this.right}px`,`${this.bottom}px`,`${this.left}px`].join(e)}}class yn extends vn{static from(e){const t=e.changedTouches,n=t?t[0].screenX:e.screenX,r=t?t[0].screenY:e.pageY;return new this.constructor(n,r)}constructor(e,t){super(e,t,0,0)}constrain(e){return this.x=Math.min(Math.max(this.x,e.x),e.right-1),this.y=Math.min(Math.max(this.y,e.y),e.bottom-1),this}toArray(){return[this.x,this.y]}}vn._$name="Rectangle";const bn=Symbol("value"),Cn=Symbol("length");class Sn{static change(e,t,n,r="string"){n=Sn.normalize(n,"object");const s=Sn.normalize(e,"array").filter((e=>!n[e]));if(t){t=Sn.normalize(t,"array");for(let e=0;e<t.length;++e)s.includes(t[e])||s.push(t[e])}return Sn.normalize(s,r)}static from(e,t){return e&&(e.isDomClassList?t=t??!0:(t=t??(F.isObject(e)&&!F.isEmpty(e)),e=new Sn(e)),e.value||t||(e=null)),e||(t?new Sn:null)}static normalize(e,t="string"){const n=typeof(e=e||""),r="array"===t,s=!r&&!("object"===t);let i,a,o,l="string"===n;var c;"object"===n&&(e.nodeType===Element.ELEMENT_NODE&&"function"==typeof e.getAttribute?(e=e.getAttribute("class")||"",l=!0):null!==(c=e)&&void 0!==c&&c.isDomClassList?e=e.values:e instanceof DOMTokenList?e=Array.from(e):e instanceof Map?e=Array.from(e.keys()).filter((t=>e.get(t))):e instanceof Set?e=Array.from(e):Array.isArray(e)||(e=F.getTruthyKeys(e)));for(l&&(e=[...new Set(T.split(e))]),a=e.length;a-- >0;)i=e[a],i.length?i.includes(" ")&&e.splice(a,1,...T.split(i)):e.splice(a,1);if(r)o=e;else if(s)o=e.join(" ");else for(o=Object.create(null),a=0;a<e.length;++a)o[e[a]]=!0;return o}constructor(...e){this.process(1,e)}clear(){for(const e in this)this[e]=!1;return this}set(...e){return this.clear().process(1,e)}get isDomClassList(){return!0}clone(){return new Sn(this)}contains(e){return!("string"!=typeof e||!e)&&Boolean(this[e])}toString(){return this.length?`${this.value} `:""}toJSON(){return this.toString()}trim(){return this.value}isEqual(e){const t=Sn.normalize(e,"array"),n=t.length;if(this.length===n){for(let e=0;e<n;e++)if(!this[t[e]])return!1;return!0}return!1}get value(){let e,t=this[bn];return null==t&&(e=F.getTruthyKeys(this),this[Cn]=e.length,this[bn]=t=e.join(" ")),t}set value(e){const t=this,n=Object.keys(t),r=n.length;for(let e=0;e<r;e++)delete t[n[e]];e?t.process(1,[e]):delete t[bn]}get values(){return F.getTruthyKeys(this)}get length(){return this.value?this[Cn]:0}process(e,t){for(let n,r,s=0;s<t.length;s++)if(t[s])if(n=t[s],n.isDomClassList||F.isObject(n))for(r in n)this[r]=e?n[r]:!n[r];else for(n=Sn.normalize(t[s],"array"),r=0;r<n.length;++r)this[n[r]]=e;return delete this[bn],this}assign(e){for(const t in e)!this[t]!=!e[t]&&(this[t]=e[t],delete this[bn]);return this}assignTo(e){const t=e.nodeType===Element.ELEMENT_NODE?e.classList:e,n=Sn.from(t);n.add(this),t.value=n.value}add(...e){return this.process(1,e)}remove(...e){return this.process(0,e)}toggle(e,t=Boolean(!this[e])){if(t=Boolean(t),Boolean(this[e])!==t)return this[e]=t,delete this[bn],!0}split(){return F.getTruthyKeys(this)}forEach(e){return F.getTruthyKeys(this).forEach(e)}}Sn.prototype[bn]=null,Sn._$name="DomClassList";const wn=["clientX","clientY","pageX","pageY","screenX","screenY"],Dn={element:1,thisObj:1,once:1,delegate:1,delay:1,capture:1,passive:1,throttled:1,autoDetach:1,expires:1,block:1},Tn=!0,En={configurable:Tn,value:!0},xn={Spacebar:"Space",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},kn={Control:"ctrl",Alt:"alt",Shift:"shift"},In=/^(ctrl|shift|alt|meta)$/,Rn=["altKey","bubbles","button","buttons","cancelBubble","cancelable","clientX","clientY","ctrlKey","layerX","layerY","metaKey","pageX","pageY","returnValue","screenX","screenY","shiftKey"];class Mn{static eventNameMap={mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseenter:"MouseEnter",mouseleave:"MouseLeave",mousemove:"MouseMove",mouseover:"MouseOver",mouseout:"MouseOut",keyup:"KeyUp",keydown:"KeyDown",keypress:"KeyPress"};static normalizeEvent(e){return Ut.copyPropertiesIf(e,e.changedTouches[0]||e.touches[0],wn)}static copyEvent(e,t){return Ut.copyProperties(e,t,Rn)}static getXY(e){return e.touches&&(e=e.touches[0]),[e.clientX,e.clientY]}static getDistanceBetween(e,t){const n=On.getXY(e),r=On.getXY(t);return Math.sqrt(Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2))}static getPagePoint(e){return new yn(e.pageX,e.pageY)}static getClientPoint(e){return new yn(e.clientX,e.clientY)}static addListener(e,t,n,r){return r=e.nodeType?"string"==typeof t?Object.assign({element:e,[t]:n},r):Object.assign({element:e},t):e,On.on(r)}static on(e){const t=e.element,n=e.thisObj,r=[];for(const n in e)if(!Dn[n]){let s=e[n];"object"!=typeof s&&(s={handler:s});const i=s.element||t;r.push(On.addElementListener(i,n,s,e))}const s=()=>{for(let e,t=0;t<r.length;t++)e=r[t],On.removeEventListener(e[0],e[1],e[2]);r.length=0};return n&&!1!==e.autoDetach&&(n.doDestroy=Ce.createInterceptor(n.doDestroy,s,n)),s}static addElementListener(e,t,n,r){const s=On.createHandler(e,t,n,r),{spec:i}=s,a=n.expires||r.expires,o=null!=i.capture||null!=i.passive?{capture:i.capture,passive:i.passive}:void 0;if(e.addEventListener(t,s,o),a){const i=n.thisObj||r.thisObj,o=null!=i&&i.isDelayable?i:globalThis,{alt:l}=a,c=l?a.delay:a,{spec:d}=s;d.expires=a,d.timerId=o["number"==typeof c?"setTimeout":"requestAnimationFrame"]((()=>{d.timerId=null,On.removeEventListener(e,t,s),l&&!s.called&&("string"==typeof l?i[l]:l).call(i)}),c,`listener-timer-${performance.now()}`)}return[e,t,s,o]}static getComposedPathTarget(e){return e.composedPath()[0]||e.path[0]}static fixEvent(e){var t,n,s;if(e.fixed)return e;const{type:i,target:a}=e;if((null!=a&&a.shadowRoot||null!=a&&null!==(t=a.getRootNode)&&void 0!==t&&null!==(n=t.call(a))&&void 0!==n&&n.host)&&e.composedPath){const t=this.getComposedPathTarget(e),n=a;Object.defineProperty(e,"target",{value:t,configurable:Tn}),Object.defineProperty(e,"originalTarget",{value:n,configurable:Tn})}if(Object.defineProperty(e,"fixed",En),i.startsWith("key")){const t=xn[e.key];t&&Object.defineProperty(e,"key",{value:t,configurable:Tn})," "!==e.key||e.code||Object.defineProperty(e,"code",{value:"Space",configurable:Tn})}if(e.metaKey&&!e.ctrlKey&&Object.defineProperty(e,"ctrlKey",En),a&&"offsetX"in e&&(Object.getOwnPropertyDescriptor(e,"borderOffsetX")||Object.defineProperty(e,"borderOffsetX",{get:()=>e.offsetX+(r.isSafari?0:parseInt(a.ownerDocument.defaultView.getComputedStyle(a).getPropertyValue("border-left-width")))}),Object.getOwnPropertyDescriptor(e,"borderOffsetY")||Object.defineProperty(e,"borderOffsetY",{get:()=>e.offsetY+(r.isSafari?0:parseInt(a.ownerDocument.defaultView.getComputedStyle(a).getPropertyValue("border-top-width")))})),(null==a?void 0:a.nodeType)===Element.DOCUMENT_NODE&&"clientX"in e){const t=yr.elementFromPoint(e.clientX,e.clientY);Object.defineProperty(e,"target",{value:t,configurable:Tn})}if((null==a?void 0:a.nodeType)===Element.TEXT_NODE){const t=e.target.parentElement;Object.defineProperty(e,"target",{value:t,configurable:Tn})}if((null===(s=e.relatedTarget)||void 0===s?void 0:s.nodeType)===Element.TEXT_NODE){const t=e.target.parentElement;Object.defineProperty(e,"relatedTarget",{value:t,configurable:Tn})}return i.startsWith("touch")&&e.touches.length&&this.normalizeEvent(e),e}static createHandler(e,t,n,r){const s=n.delay||r.delay,i=n.throttled||r.throttled,a=n.block||r.block,o="once"in n?n.once:r.once,l="capture"in n?n.capture:r.capture,c="passive"in n?n.passive:r.passive,d="delegate"in n?n.delegate:r.delegate,u=n.handler,h=n.expires,g=n.thisObj||r.thisObj,{rtlSource:m=g}=g||{};let p=(e,...t)=>{On.playingDemo&&e.isTrusted||null!=g&&g.isDestroyed||(e=On.fixEvent(e,null==m?void 0:m.rtl),p.called=!0,("string"==typeof u?g[u]:u).call(g,e,...t),delete e.target,delete e.relatedTarget,delete e.originalarget,delete e.key,delete e.code,delete e.ctrlKey,delete e.fixed)};if(a){const e=p;let t,n;p=(r,...s)=>{const i=performance.now();(!t||r.target!==n||i-t>a)&&(n=r.target,t=i,e(r,...s))}}if(null!=s){const e=p,t=null!=g&&g.setTimeout?g:globalThis;p=(...n)=>{t.setTimeout((()=>{e(...n)}),s)}}if(null!=i){let e,t=i;i.buffer&&(e=e=>i.alt.call(On,On.fixEvent(e,null==m?void 0:m.rtl)),t=i.buffer),p=null!=g&&g.isDelayable?g.throttle(p,{delay:t,throttled:e}):Ce.createThrottled(p,t,g,null,e)}if(o){const n=p;p=(...r)=>{On.removeEventListener(e,t,p),n(...r)}}if(d){const e=p;p=(t,...n)=>{var r;const s=(null===(r=(t=On.fixEvent(t,null==m?void 0:m.rtl)).target.closest)||void 0===r?void 0:r.call)&&t.target.closest(d);s&&(Object.defineProperty(t,"currentTarget",{get:()=>s,configurable:!0}),e(t,...n))}}return n.thisObj&&!1!==n.autoDetach&&(g.doDestroy=Ce.createInterceptor(g.doDestroy,(()=>On.removeEventListener(e,t,p)),g)),p.spec={delay:s,throttled:i,block:a,once:o,thisObj:g,capture:l,expires:h,passive:c,delegate:d},p}static removeEventListener(e,t,n){const{expires:r,timerId:s,thisObj:i,capture:a}=n.spec;if(null!=r&&r.alt&&s){(null!=i&&i.isDelayable?i:globalThis)["number"==typeof r.delay?"clearTimeout":"cancelAnimationFrame"](s)}e.removeEventListener(t,n,a)}static onTransitionEnd({element:e,animationName:t,property:n,handler:r,mode:s=(t?"animation":"transition"),duration:i=yr[`get${"transition"===s?"Property":""}${T.capitalize(s)}Duration`](e,n),thisObj:a=globalThis,args:o=[],timerSource:l,runOnDestroy:c}){let d;l=l||(a.isDelayable?a:globalThis);const u=[e,n,...o],h=()=>{g(),a.isDestroyed||(a.callback?a.callback(r,a,u):r.apply(a,u))},g=On.on({element:e,[`${s}end`]({animationName:r,propertyName:s,target:i}){if(i===e&&(s===n||null!=r&&r.match(t))){var a,o;if(d)null===(a=(o=l).clearTimeout)||void 0===a||a.call(o,d),d=null;h()}}});return null!=i&&(d=l.setTimeout(h,i+50,"onTransitionEnd",c)),g}static async waitForTransitionEnd(e){return new Promise((t=>{e.handler=t,Mn.onTransitionEnd(e)}))}static createDblClickWrapper(e,t,n){let r,s,i;return()=>{s||(s=On.on({element:e,touchstart:e=>{r=e.changedTouches[0].identifier,e.preventDefault()},touchend:e=>{if(e.changedTouches[0].identifier===r){e.preventDefault(),clearTimeout(i),r=s=null;const a=vn.from(e.changedTouches[0].target,null,!0),o=e.changedTouches[0].pageX-a.x,l=e.changedTouches[0].pageY-a.y,c=Object.assign({browserEvent:e},e),d=new MouseEvent("dblclick",c);Object.defineProperties(d,{target:{value:e.target},offsetX:{value:o},offsetY:{value:l}}),"string"==typeof t&&(t=n[t]),t.call(n,d)}},once:!0}),i=setTimeout((()=>{s(),r=s=null}),On.dblClickTime))}}static toSpecialKey(e,t=(r.isMac?"metaKey":"ctrlKey")){let n=!1;return!0===e?n=t:"string"==typeof e&&(e=e.toLowerCase()).match(In)&&(n=`${e}Key`),n}static specialKeyFromEventKey(e){return kn[e]||"no-special-key"}}const On=Mn;On.longPressTime=700,On.dblClickTime=300,r.isTouchDevice&&On.on({element:document,touchmove:e=>{e.target.closest(".b-dragging")&&e.preventDefault()},passive:!1,capture:!0}),Mn._$name="EventHelper";const An={align:"t0-t0"},Fn=Node.ELEMENT_NODE,Pn=Node.TEXT_NODE,{isObject:Ln}=Ut,$n=/[+-]?\d*\.?\d+[eE]?-?\d*/g,_n=$n.source,Nn=new RegExp(`matrix\\((?:${_n}),\\s?(?:${_n}),\\s?(?:${_n}),\\s?(?:${_n}),\\s?(${_n}),\\s?(${_n})`),jn=new RegExp("matrix3d\\((?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(-?\\d*),\\s?(-?\\d*)"),Vn=new RegExp(`(?:${Nn.source})|(?:${jn.source})`),Bn=new RegExp(`translate(3d|X)?\\((${_n})px(?:,\\s?(${_n})px)?`),zn=new RegExp(`translate(3d|Y)?\\((${_n})px(?:,\\s?(${_n})px)?`),Wn=/\s+/,Hn=/\s*;\s*/,Un=/\s*:\s*/,Yn=/^-?((\d+(\.\d*)?)|(\.?\d+))$/,qn={elementData:"",for:"htmlFor",retainElement:""},Kn={tag:1,html:1,text:1,children:1,tooltip:1,style:1,dataset:1,parent:1,nextSibling:1,ns:1,reference:1,class:1,className:1,unmatched:1,onlyChildren:1,listeners:1,compareHtml:1,syncOptions:1,keepChildren:1},Gn={length:1,parentRule:1,style:1},Xn={INPUT:1,TEXTAREA:1},Zn={BUTTON:1,IFRAME:1,EMBED:1,INPUT:1,OBJECT:1,SELECT:1,TEXTAREA:1,BODY:1},Jn=globalThis,Qn=document,er=Object.freeze({}),tr=Array.prototype.slice,nr=Promise.resolve(),rr=["font-size","font-size-adjust","font-style","font-weight","font-family","font-kerning","font-stretch","line-height","text-transform","text-decoration","letter-spacing","word-break"],sr=e=>e._hidden,ir=(e,t,n)=>"children"===n.key?Ut.mergeItems(e,t,n):Ut.blend(e,t,n),ar=e=>{const t=e.ownerDocument.defaultView.getComputedStyle(e);return"none"!==t.getPropertyValue("display")&&"hidden"!==t.getPropertyValue("visibility")},or=e=>e&&(e===Qn.body||Boolean(e.offsetParent)||(e.ownerDocument.defaultView&&"offsetParent"in e&&"fixed"!==yr.getStyleValue(e,"position")?e.offsetParent:or(e.parentNode))),lr=e=>e instanceof Node?e:"string"==typeof e?br.createElementFromTemplate(e):br.createElement(e),cr=Object.create(null),dr=(e,t)=>{const n=cr[e]||[T.hyphenate(e),t];return cr[e]||(cr[n[0]]=cr[e]=n),n},ur=/b-slide-in-from-\w+/;["top","right","bottom","left","width","height","maxWidth","maxHeight","minWidth","minHeight","borderSpacing","borderWidth","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","letterSpacing","lineHeight","outlineWidth","textIndent","wordSpacing"].forEach((e=>dr(e,!0)));let hr,gr,mr,pr=null,fr=0,vr=null;class yr{static async slideIn(e,t=1){const n="b-slide-in-"+(t>0?"next":"previous"),{classList:r,parentNode:{classList:s}}=e;s.add(".b-sliding-child-element"),r.add(n),await Mn.waitForTransitionEnd({element:e,animationName:ur}),r.remove(n),s.remove(".b-sliding-child-element")}static isFocusable(e,t=!1){if(!t&&(!br.isVisible(e)||br.Widget.fromElement(e,sr)))return!1;const n=e.nodeName;return Zn[n]||("A"===n||"LINK"===n)&&!!e.href||null!=e.getAttribute("tabIndex")||"true"===e.contentEditable}static isEditable(e){return e.isContentEditable||Xn[e.nodeName]}static isInView(e,t=!1,n){if(!or(e))return!1;const r=(null==n?void 0:n.positioned)&&"fixed"!==yr.getStyleValue(n.element,"position"),s=vn.from(globalThis),i=t?"contains":"intersect",a=r&&n.element.offsetParent,o=r&&vn.from(a);if(s.height=Qn.scrollingElement.scrollHeight,e===Qn.body)return s;const l=this.getViewportIntersection(e,s,i);return l&&r&&l.translate(Qn.scrollingElement.scrollLeft,Qn.scrollingElement.scrollTop),r&&l?l.translate(-o.x+a.scrollLeft,-o.y+a.scrollTop):l}static getViewportIntersection(e,t,n){const{parentNode:r}=e,{parentElement:s}=r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.getRootNode().host:e,i=s.ownerDocument.defaultView.getComputedStyle(s),a="visible"!==i.overflowX||"visible"!==i.overflowY,o=(l=e).ownerSVGElement?l.ownerSVGElement.parentNode:l.offsetParent;var l;let c=vn.from(e,null,!0);for(let r=a?e.parentNode:o;c&&r!==Qn.documentElement;r=r.parentNode){r.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&r.host&&(r=r.host.parentNode);const e=r===Qn.body,s=r.ownerDocument.defaultView.getComputedStyle(r);if("contents"!==s.display&&(e||"visible"!==s.overflow)){c=(e?t:vn.client(r,null,!0,!0))[n](c,!1,!0)}}return c}static isVisible(e){const t=e.ownerDocument;for(;e;e=(n=e).parentNode||n.host){if(e===t)return!0;if(e.nodeType===e.ELEMENT_NODE&&!ar(e))return!1}var n;return!1}static isDOMEvent(e){return e instanceof Event}static merge(e,...t){return Ut.blend(e,t,{merge:ir})}static normalizeChildren(e,t,n){var r;let s,i,a,o,l,c=null==e?void 0:e.children;if(null!=e&&null!==(r=e.syncOptions)&&void 0!==r&&r.ignoreRefs&&(n=!0),c&&!(e instanceof Node))if(Array.isArray(c))for(i=0;i<c.length;++i)br.normalizeChildren(c[i],t,n);else for(a in o=c,e.children=c=[],o){var d;s=o[a],null!==(d=s)&&void 0!==d&&d.isWidget&&(s=s.element),l=!a.startsWith("$")&&!br.isElement(s),l&&(null==t||t(a,!n)),s&&(s instanceof Node||(!1===s.reference?delete s.reference:l&&"string"!=typeof s&&(s.reference=a),br.normalizeChildren(s,t,n)),c.push(s))}return e}static roundPx(e,t=globalThis.devicePixelRatio||1){const n=1/t;return Math.round(e/n)*n}static floorPx(e,t=globalThis.devicePixelRatio||1){const n=1/t;return Math.floor(e*n)/n}static isCustomElement(e){return Boolean(null==e?void 0:e.shadowRoot)}static elementFromPoint(e,t){let n=document.elementFromPoint(e,t);return br.isCustomElement(n)&&(n=n.shadowRoot.elementFromPoint(e,t)||n),n}static childFromPoint(e,t,n,r=e){const s=null==n?t:new vn(t,n,0,0);let i=null;return Array.from(e.children).reverse().some((e=>{if(vn.from(e,r).contains(s))return i=e.children.length&&br.childFromPoint(e,s,null,r)||e,!0})),i}static unitize(e,t,n="px"){const[r,s]=dr(e);return null!=t&&(t=String(t),t=s&&Yn.test(t)?t+n:t),[r,t]}static get activeElement(){let e=document.activeElement;for(;e.shadowRoot;)e=e.shadowRoot.activeElement;return e}static getActiveElement(e){var t,n;null!==(t=e)&&void 0!==t&&t.isWidget&&(e=e.element);let r=((null===(n=e)||void 0===n?void 0:n.getRootNode())||document).activeElement;for(;null!==(s=r)&&void 0!==s&&s.shadowRoot;){var s;r=r.shadowRoot.activeElement}return r}static getRootElement(e){var t;const n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e),{nodeType:r}=n;return r===Node.DOCUMENT_NODE?n.body:r===Node.DOCUMENT_FRAGMENT_NODE?n:e.ownerDocument.contains(e)?e.ownerDocument.body:null}static getOutermostElement(e){var t,n;const r=null===(t=(n=e).getRootNode)||void 0===t?void 0:t.call(n);if(null!=r&&r.body)return null==r?void 0:r.body;for(;e.parentNode!==r&&e.parentNode;)e=e.parentNode;return e}static isValidFloatRootParent(e){return e===document.body||"ShadowRoot"===e.constructor.name}static getId(e){return e.id||(e.id="b-element-"+ ++fr)}static getCommonAncestor(e,t){if(e===t)return e;for(;e&&!(null!==(n=(r=e)[e.isWidget?"owns":"contains"])&&void 0!==n&&n.call(r,t)||e===t);){var n,r,s;e=null!==(s=e.owner)&&void 0!==s&&s.isWidget&&e.owner!==e?e.owner:e.parentNode}return e}static getElement(e){return e instanceof Element?e:Qn.querySelector(e)}static setAttributes(e,t){const n=br.getElement(e);if(n&&t)for(const e in t)null==t[e]?n.removeAttribute(e):n.setAttribute(e,t[e])}static setLength(e,t,n){return n=1===arguments.length?"number"==typeof e?`${e}px`:e??"":(e=br.getElement(e)).style[t]="number"==typeof n?`${n}px`:n??""}static percentify(e,t=2){const n=Math.pow(10,t);return null==e||""===e||isNaN(e)?"":Math.round(e*n)/n+"%"}static getChild(e,t){return e.querySelector(":scope>"+t)}static hasChild(e,t){return null!=br.getChild(e,t)}static children(e,t){return(">"===t[0]||t.startsWith("# "))&&("#"===t[0]&&(t=t.substr(2)),t=":scope "+t),Array.from(e.querySelectorAll(t))}static getChildElementCount(e){return e.childElementCount}static down(e,t){return e?e.matches&&e.matches(t)?e:(t=":scope "+t,e.querySelector(t)):null}static isDescendant(e,t){const n=br.getRootElement(e),r=br.getRootElement(t);return r&&n!==r&&r.host?br.isDescendant(n,r.host):e.contains(t)}static getEventElement(e,t="target"){return!e||br.isElement(e)?e:e[t]}static isElement(e){return(null==e?void 0:e.nodeType)===document.ELEMENT_NODE&&br.isNode(e)}static isReactElement(e){return(null==e?void 0:e.$$typeof)===Symbol.for("react.element")}static isNode(e){return Boolean(e)&&"number"==typeof e.nodeType&&!Ln(e)}static forEachSelector(e,t,n){if("string"==typeof e)throw new Error("DomHelper.forEachSelector must provide a root element context (for shadow root scenario)");br.children(e,t).forEach(n)}static forEachChild(e,t){Array.from(e.children).forEach(t)}static removeEachSelector(e,t){br.forEachSelector(e,t,(e=>e.remove()))}static removeClsGlobally(e,...t){t.forEach((t=>br.forEachSelector(e,"."+t,(e=>e.classList.remove(t)))))}static up(e,t){return P.deprecate("Core","6.0.0","DomHelper.up() deprecated, use native `element.closest()` instead"),e.closest(t)}static getAncestor(e,t,n=null){let r,s=!1,i=e;for(t=ge.asArray(t);i=i.parentElement;){if(t.includes(i)){s=!0;break}if(n&&i===n)break;r=i}return s?r||e:null}static getParents(e){const t=[];for(;e.parentElement;)t.push(e.parentElement),e=e.parentElement;return t}static makeValidId(e,t=""){return T.makeValidDomId(e,t)}static createElement(e={},t){var n,r,s;let i,a,o,l,c,d,u,h,g,m,p,f=t;if("boolean"==typeof f)throw new Error("Clean up");t&&(c=t.ignoreRefs,g=t.refOwner,m=t.refs,f=t.returnAll,p=t.syncIdField,c&&(o=!0,c="children"!==c)),"string"==typeof e.parent&&(e.parent=document.getElementById(e.parent));const v=e.parent||e.nextSibling&&e.nextSibling.parentNode,{dataset:y,html:b,reference:C,syncOptions:S,text:w}=e;if(S&&(p=S.syncIdField||p,l=S.ignoreRefs,l&&(o=!0,c="children"!==l,t={...t,ignoreRefs:!0})),c&&(g=null),i=e.ns?Qn.createElementNS(e.ns,e.tag||"svg"):Qn.createElement(e.tag||"div"),null!=w?br.setInnerText(i,w):null!=b&&(b instanceof DocumentFragment?i.appendChild(b):i.innerHTML=b),e.tooltip&&br.Widget.attachTooltip(i,e.tooltip),e.style&&br.applyStyle(i,e.style),y)for(u in y)h=y[u],null!=h&&(i.dataset[u]=h);v&&this.addChild(v,i,e.nextSibling),g&&(i.$refOwnerId=g.id),C&&!c&&(g?(i.$reference=C,g.attachRef(C,i,e)):(m||((t=Object.assign({},t)).refs=m={}),m[C]=i,i.setAttribute("data-reference",C)));const D=e.className||e.class,T=Object.keys(e);for(D&&i.setAttribute("class",Sn.normalize(D)),a=0;a<T.length;++a)u=T[a],h=e[u],null!=(d=qn[u])?i[d||u]=h:!Kn[u]&&u&&null!=h&&i.setAttribute(u,h);e["aria-hidden"]||e.role||e.tabIndex||yr.isFocusable(i,!0)||i.htmlFor||i.setAttribute("role","presentation"),null===(n=t)||void 0===n||null===(r=n.callback)||void 0===r||r.call(n,{action:"newElement",domConfig:e,targetElement:i,syncId:g?C:t.syncIdField&&(null===(s=e.dataset)||void 0===s?void 0:s[t.syncIdField])}),!0===f?t.returnAll=f=[i]:Array.isArray(f)&&f.push(i),e.children&&(p&&(i.syncIdMap={}),e.children.forEach((n=>{if(n)if("string"==typeof n){const e=document.createTextNode(n);g&&(e.$refOwnerId=g.id),i.appendChild(e)}else if(isNaN(n.nodeType)){var r,s;n.parent=i,!n.ns&&e.ns&&(n.ns=e.ns);const a=br.createElement(n,{...t,ignoreRefs:(null===(r=e.syncOptions)||void 0===r?void 0:r.ignoreRef)??o}),l=null===(s=n.dataset)||void 0===s?void 0:s[p];null!=l&&(i.syncIdMap[l]=a),delete n.parent}else i.appendChild(n)}))),i.lastDomConfig=e;const E=m||f||i;return e.replaceElement&&e.replaceElement.replaceWith(E),E}static createElementFromTemplate(e,t=er){const{array:n,raw:r,fragment:s}=t;let i;if(br.supportsTemplate){if((hr||(hr=Qn.createElement("template"))).innerHTML=e,i=hr.content,s)return i.cloneNode(!0)}else if(i=(gr||(gr=new DOMParser)).parseFromString(e,"text/html").body,s){const e=i.childNodes;for(i=document.createDocumentFragment();e.length;)i.appendChild(e[0]);return i}return i=r?i.childNodes:i.children,1!==i.length||n?tr.call(i):i[0]}static triggerMouseEvent(e,t="contextmenu"){const n=(this.isInView(e)||vn.from(e)).center,r=new MouseEvent(t,{clientX:n.x,clientY:n.y,bubbles:!0});e.dispatchEvent(r)}static insertFirst(e,t){return t&&t.nodeType!==Fn&&t.tag&&(t=br.createElement(t)),e.insertBefore(t,e.firstElementChild)}static insertBefore(e,t,n){return t&&t.nodeType!==Fn&&t.tag&&(t=br.createElement(t)),n?e.insertBefore(t,n):br.insertFirst(e,t)}static insertAt(e,t,n){const r=Array.from(e.children);if(n>=r.length)return br.append(e,t);const s=r[n];return br.insertBefore(e,t,s)}static append(e,t){if(t.forEach){if(Array.isArray(t)&&(t=t.map((e=>lr(e)))),e.append)e.append(...t);else{const n=document.createDocumentFragment();t.forEach((function(e){n.appendChild(e)})),e.appendChild(n)}return t}return e.appendChild(lr(t))}static getTranslateX(e){const t=e.style.transform;let n=Bn.exec(t);return n?parseFloat(n[2]):(n=Vn.exec(t)||Vn.exec(br.getStyleValue(e,"transform")),n?parseFloat(n[1]||n[3]):0)}static getTranslateY(e){const t=e.style.transform;let n=zn.exec(t);if(n){const e=parseFloat(n["Y"===n[1]?2:3]);return isNaN(e)?0:e}return n=Vn.exec(t)||Vn.exec(br.getStyleValue(e,"transform")),n?parseFloat(n[2]||n[4]):0}static getTranslateXY(e){return[br.getTranslateX(e),br.getTranslateY(e)]}static getOffsetX(e,t=null){return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:e.offsetLeft}static getOffsetY(e,t=null){return t?e.getBoundingClientRect().top-t.getBoundingClientRect().top:e.offsetTop}static getOffsetXY(e,t=null){return[br.getOffsetX(e,t),br.getOffsetY(e,t)]}static focusWithoutScrolling(e){if(!r.isSafari)e.focus({preventScroll:!0});else{const t=br.getParents(e).map((e=>({element:e,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop})));e.focus(),setTimeout((()=>function(e){e.forEach((({element:e,scrollLeft:t,scrollTop:n})=>{e.scrollLeft!==t&&(e.scrollLeft=t),e.scrollTop!==n&&(e.scrollTop=n)}))}(t)),0)}}static getPageX(e){return e.getBoundingClientRect().left+Jn.pageXOffset}static getPageY(e){return e.getBoundingClientRect().top+Jn.pageYOffset}static getExtremalSizePX(e,t){const n=T.hyphenate(t),r=n.split("-")[1];let s=br.getStyleValue(e,n);return s=/%/.test(s)?e.parentElement?parseInt(br.getStyleValue(e.parentElement,r),10):NaN:parseInt(s,10),s}static setScale(e,t,n=t){const r=br.getStyleValue(e,"transform").split(/,\s*/);r.length>1?(r[0].startsWith("matrix3d")?(r[0]=`matrix3d(${t}`,r[5]=n):(r[0]=`matrix(${t}`,r[3]=n),e.style.transform=r.join(",")):e.style.transform=`scale(${t}, ${n})`}static setTranslateX(e,t){const n=br.getStyleValue(e,"transform").split(/,\s*/);t=br.roundPx(t),n.length>1?(n[n[0].startsWith("matrix3d")?12:4]=t,e.style.transform=n.join(",")):e.style.transform=`translateX(${t}px)`}static setTranslateY(e,t){const n=br.getStyleValue(e,"transform").split(/,\s*/);t=br.roundPx(t),n.length>1?(n[n[0].startsWith("matrix3d")?13:5]=t,e.style.transform=n.join(",")+")"):e.style.transform=`translateY(${t}px)`}static setTop(e,t){br.setLength(e,"top",t)}static setLeft(e,t){br.setLength(e,"left",t)}static setTopLeft(e,t,n){br.setLength(e,"top",t),br.setLength(e,"left",n)}static setRect(e,{x:t,y:n,width:r,height:s}){br.setTopLeft(e,n,t),br.setLength(e,"width",r),br.setLength(e,"height",s)}static setTranslateXY(e,t,n){if(null==t)return br.setTranslateY(e,n);if(null==n)return br.setTranslateX(e,t);t=br.roundPx(t),n=br.roundPx(n);const r=br.getStyleValue(e,"transform").split(/,\s*/),s=r[0].startsWith("matrix3d");r.length>1?(r[s?12:4]=t,r[s?13:5]=n,e.style.transform=r.join(",")+")"):e.style.transform=`translate(${t}px, ${n}px)`}static addTranslateX(e,t){br.setTranslateX(e,br.getTranslateX(e)+t)}static addTranslateY(e,t){br.setTranslateY(e,br.getTranslateY(e)+t)}static addLeft(e,t){br.setLeft(e,br.getOffsetX(e)+t)}static addTop(e,t){br.setTop(e,br.getOffsetY(e)+t)}static alignTo(e,t,n=An,r){t=t instanceof vn?t:vn.from(t,!0);const s=br.getTranslateXY(e),i=vn.from(e,!0);r&&(i.roundPx(),t.roundPx());const a=i.alignTo(Object.assign(n,{target:t}));br.setTranslateXY(e,s[0]+a.x-i.x,s[1]+a.y-i.y)}static getStyleValue(e,t,n,r){const s=n?e.style:e.ownerDocument.defaultView.getComputedStyle(e,r);if(Array.isArray(t)){const e={};for(const n of t)e[n]=s.getPropertyValue(T.hyphenate(n));return e}return s.getPropertyValue(T.hyphenate(t))}static getEdgeSize(e,t,n){const r="border"===t?"-width":"",s={raw:{}};for(const i of["top","right","bottom","left"])n&&!n.includes(i[0])||(s[i]=parseFloat(s.raw[i]=br.getStyleValue(e,`${t}-${i}${r}`)));return s.width=(s.left||0)+(s.right||0),s.height=(s.top||0)+(s.bottom||0),s}static parseStyle(e){if("string"==typeof e){const t=e.split(Hn);e={};for(let n=0,{length:r}=t;n<r;n++){const r=t[n].split(Un);e[r[0]]=r[1]}}return e||{}}static applyStyle(e,t,n=!1){if("string"==typeof t)n?(t.length||e.style.cssText.length)&&(e.style.cssText=t):e.style.cssText+=t;else if(t){let r,s;for(r in n&&(e.style.cssText=""),t.style&&"string"!=typeof t.style&&(t=Ut.assign({},t,t.style)),t)Gn[r]||([r,s]=br.unitize(r,t[r]),null==s?e.style.removeProperty(r):e.style.setProperty(r,s));"string"==typeof t.style&&(e.style.cssText+=t.style)}}static getCSSText(e){if("string"==typeof e)return e;let t="";for(const n in e)Gn[n]||(t+=`${T.hyphenate(n)}:${e[n]};`);return t}static addClasses(e,t){P.deprecate("Core","6.0.0","DomHelper.addClasses should be replaced by native classList.add"),e.classList.add(...t)}static removeClasses(e,t){P.deprecate("Core","6.0.0","DomHelper.removeClasses should be replaced by native classList.remove"),e.classList.remove(...t)}static toggleClasses(e,t,n=null){t=ge.asArray(t),!0===n?e.classList.add(...t):!1===n?e.classList.remove(...t):t.forEach((t=>e.classList.toggle(t)))}static addTemporaryClass(e,t,n,r=globalThis,s=t){n>0&&(e.classList.add(t),r.setTimeout({fn:t=>e.classList.remove(t),delay:n,name:s,args:[t],cancelOutstanding:!0}))}static getPropertyTransitionDuration(e,t){const n=globalThis.getComputedStyle(e),r=n.transitionProperty.split(", "),s=n.transitionDuration.split(", "),i=r.indexOf(T.hyphenate(t));let a;return-1!==i&&(a=1e3*parseFloat(s[i])),a}static getAnimationDuration(e){return 1e3*parseFloat(br.getStyleValue(e,"animation-duration"))}static highlight(e,t=globalThis){return e instanceof vn?e.highlight():new Promise((n=>{t.setTimeout((()=>{e.classList.add("b-fx-highlight"),t.setTimeout((()=>{e.classList.remove("b-fx-highlight"),n()}),1e3)}),0)}))}static get scrollBarWidth(){if(null===pr){const e=mr||(mr=br.createElement({parent:Qn.documentElement,className:"b-scrollbar-measure-element",style:"position:absolute;top:-9999em;height:100px;overflow-y:scroll"}));e.parentNode!==Qn.documentElement&&Qn.documentElement.appendChild(e),pr=e.offsetWidth}return pr}static get scrollBarPadElement(){return{className:"b-yscroll-pad",children:[{className:"b-yscroll-pad-sizer"}]}}static resetScrollBarWidth(){pr=null}static measureText(e,t,n=!1,r=void 0){const s=br.getMeasureElement(t,r);s[n?"innerHTML":"innerText"]=e;const i=s.clientWidth;return s.className="",i}static measureSize(e,t,n=!0){if(!e)return 0;if("number"==typeof e)return e;if(!e.length)return 0;if(/^\d+(px)?$/.test(e))return parseInt(e);if(t){const r=br.getMeasureElement(t);r.innerHTML="",r.style.width=br.setLength(e);const s=n?r.offsetWidth:r.getBoundingClientRect().width;return r.style.width=r.className="",s}return/^\d+em$/.test(e)?14*parseInt(e):isNaN(e)?0:parseInt(e)}static getMeasureElement(e,t=Qn.body){const n=Jn.getComputedStyle(e),r=t.offScreenDiv=t.offScreenDiv||br.createElement({parent:t,style:"position:fixed;top:-10000px;left:-10000px;visibility:hidden;contain:strict",className:"b-measure-element",children:[{style:"white-space:nowrap;display:inline-block;will-change:contents;width:auto;contain:none"}]},{returnAll:!0})[1];return rr.forEach((e=>{r.style[e]!==n[e]&&(r.style[e]=n[e])})),r.className=e.className,r.parentElement.parentElement!==t&&t.appendChild(r.parentElement),r}static stripTags(e){return(br.$domParser||(br.$domParser=new DOMParser)).parseFromString(e,"text/html").body.textContent}static sync(e,t){if("string"==typeof e){if(""===e)return void(t.innerHTML="");e=br.createElementFromTemplate(e)}return br.performSync(e,t),t}static performSync(e,t){return e.outerHTML!==t.outerHTML&&(br.syncAttributes(e,t),br.syncContent(e,t),br.syncChildren(e,t),!0)}static getSyncAttributes(e){const t={},n=[];for(let r=0;r<e.attributes.length;r++){const s=e.attributes[r];if(s.specified){const e=s.name.toLowerCase();t[e]=s.value,n.push(e)}}return{attributes:t,names:n}}static syncAttributes(e,t){const{attributes:n,names:r}=br.getSyncAttributes(e),{attributes:s,names:i}=br.getSyncAttributes(t),a=r.includes("dataset"),o=r.filter((e=>!i.includes(e))),l=i.filter((e=>!(r.includes(e)||a&&e.startsWith("data-")))),c=r.filter((e=>i.includes(e)));if(o.length>0)for(let e=0;e<o.length;e++){const r=o[e];"style"===r?br.applyStyle(t,n.style,!0):"dataset"===r?Object.assign(t.dataset,n.dataset):t.setAttribute(r,n[r])}if(l.length>0)for(let e=0;e<l.length;e++)t.removeAttribute(l[e]);if(c.length>0)for(let e=0;e<c.length;e++){const r=c[e];if("style"===r)br.applyStyle(t,n.style,!0);else if("dataset"===r)Object.assign(t.dataset,n.dataset);else if("class"!==r||!n.class.isDomClassList&&"object"!=typeof n.class)s[r]!==n[r]&&t.setAttribute(r,n[r]);else{let e;e=n.class.isDomClassList?n.class:new Sn(n.class),e.isEqual(s.class)||t.setAttribute("class",e)}}}static syncContent(e,t){0===br.getChildElementCount(e)&&(t.innerText=e.innerText)}static setInnerText(e,t){const{firstChild:n}=e;(null==n?void 0:n.nodeType)===Element.TEXT_NODE?n.data=t:e.textContent=t}static syncChildren(e,t){const n=this,r=tr.call(e.childNodes),s=tr.call(t.childNodes);for(;r.length;){const e=r.shift(),i=s.shift();if(e&&e.nodeType!==Pn&&e.nodeType!==Fn)throw new Error(`Source node type ${e.nodeType} not supported by DomHelper.sync()`);if(i&&i.nodeType!==Pn&&i.nodeType!==Fn)throw new Error(`Target node type ${i.nodeType} not supported by DomHelper.sync()`);if(i)if(e.nodeType===i.nodeType)e.nodeType===Pn?i.data=e.data:e.tagName===i.tagName?n.performSync(e,i):(t.insertBefore(e,i),i.remove());else{if(e.nodeType!==Pn||i.nodeType!==Fn){const t=e.parentElement||e;throw new Error(`Currently no support for transforming nodeType.\n${t.outerHTML}`)}t.innerText=e.data.trim()}else t.appendChild(e)}s.forEach((e=>{e.remove()}))}static syncClassList(e,t){const{classList:n}=e,r="string"==typeof t,s=r?t.split(Wn):Sn.normalize(t,"array"),i=s.length;let a,o=n.length!==i;for(a=0;!o&&a<i;a++)o=!n.contains(s[a]);return o&&(e.className=r?t:s.join(" ")),o}static updateClassList(e,t){const{classList:n}=e;let r,s,i=!1;for(r in t)s=Boolean(t[r]),n.contains(r)!==s&&(n[s?"add":"remove"](r),i=!0);return i}static setTheme(e,t){e=e.toLowerCase();const{head:n}=document,r=br.getThemeInfo(t).name.toLowerCase();let s=n.querySelectorAll("[data-bryntum-theme]:not([data-loading])"),i=0;if(r===e)return nr;br.removeEachSelector(n,"#bryntum-theme[data-loading],link[data-bryntum-theme][data-loading]");const a={theme:e,prev:r};function o(t,n,o){const l=yr.createElement({tag:"link",rel:"stylesheet",dataset:{loading:!0,bryntumTheme:!0},href:t.href.replace(r,e),nextSibling:t});l.addEventListener("load",(()=>{delete l.dataset.loading,vr=null,++i===s.length&&(s.forEach((e=>e.remove())),xr.trigger("theme",a),n(a))})),l.addEventListener("error",(e=>{delete l.dataset.loading,o(e)}))}if(s.length)return new Promise(((e,t)=>{s.forEach(((n,r)=>{o(n,e,t,s.length)}))}));{const e=n.querySelector("#bryntum-theme:not([data-loading])")||n.querySelector(`[href*="${r}.css"]:not([data-loading])`);if(null==e||!e.href.includes(`${r}.css`))throw new Error(`Theme link for ${r} not found`);return s=[e],new Promise(((t,n)=>o(e,t,n)))}}static get themeInfo(){return yr.getThemeInfo()}static getThemeInfo(e){if(!vr){const t=br.createElement({parent:document.body,className:"b-theme-info"}),n=br.getStyleValue(t,"content",!1,":before");if(n)try{vr=JSON.parse(n.replace(/^["']|["']$|\\/g,""))}catch(e){vr=null}vr=vr||(e?{name:e}:null),t.remove()}return vr}static async transition({element:e,selector:t="[data-dom-transition]",duration:n,action:r,thisObj:s=this,addTransition:i={},removeTransition:a={}}){const o=new Set,l=Array.from(e.querySelectorAll(t)),c=new Map(l.map((t=>{let n=0,r=t.parentElement;for(;r&&r!==e;)n++,r=r.parentElement;t.$depth=n,t.scrollHeight>t.offsetHeight&&"auto"===getComputedStyle(t).overflow&&(t.$scrollTop=t.scrollTop,o.add(t));const{parentElement:s}=t,i=vn.from(t,e),a=vn.from(t,s),l=getComputedStyle(s),c=parseFloat(l.borderLeftWidth);return c&&(i.left-=c,a.left-=c),[t.id,{element:t,globalBounds:i,localBounds:a,depth:n,parentElement:s}]})));r.call(s);const d=Array.from(e.querySelectorAll(t)),u=new Map(d.map((t=>{const n=vn.from(t,e),r=vn.from(t,t.parentElement),s=globalThis.getComputedStyle(t.parentElement),i=parseFloat(s.borderLeftWidth);return i&&(n.left-=i,r.left-=i),[t.id,{element:t,globalBounds:n,localBounds:r}]}))),h=["position","top","left","width","height","padding","margin","zIndex","minWidth","minHeight","opacity","overflow"];for(const[t,n]of c){const r=u.get(t);if(r){const{element:t}=r,{style:s,parentElement:i}=t,a=parseInt(br.getStyleValue(t,"zIndex")),{globalBounds:l,localBounds:c,depth:d,parentElement:u}=n,g=u!==i;let m;Ut.copyProperties(t.$initial={parentElement:i},s,h),g?(r.bounds=r.globalBounds,m=l,e.appendChild(t)):(r.bounds=r.localBounds,m=c,u.appendChild(t));let p="hidden";o.has(t)&&(t.$scrollPlaceholder=br.createElement({parent:t,style:{height:t.scrollHeight}}),p="auto");const f={position:"absolute",top:`${m.top}px`,left:`${m.left}px`,width:`${m.width}px`,height:`${m.height}px`,minWidth:0,minHeight:0,margin:0,zIndex:d+(a||0),overflow:p};"preserve-padding"!==t.dataset.domTransition&&(f.padding=0),Object.assign(s,f),r.processed=!0}else{const{element:e,localBounds:r,depth:s,parentElement:i}=n;e.$initial={removed:!0},Object.assign(e.style,{position:"absolute",top:`${r.top}px`,left:`${r.left}px`,width:`${r.width}px`,height:`${r.height}px`,minWidth:0,minHeight:0,padding:0,margin:0,zIndex:s,overflow:"hidden"}),i.appendChild(e),u.set(t,{element:e,bounds:r,removed:!0,processed:!0}),d.push(e)}}for(const[,e]of u)if(!e.processed){const{element:t}=e,{style:n,parentElement:r}=t,s=e.bounds=e.localBounds;t.classList.add("b-dom-transition-adding"),Ut.copyProperties(t.$initial={parentElement:r},n,h),Object.assign(n,{position:"absolute",top:i.top?0:`${s.top}px`,left:i.left?0:`${s.left}px`,width:i.width?0:`${s.width}px`,height:i.height?0:`${s.height}px`,opacity:i.opacity?0:null,zIndex:r.$depth+1,overflow:"hidden"})}for(const e of o)e.scrollTop=e.$scrollTop;e.classList.add("b-dom-transition"),e.firstElementChild.offsetWidth;for(const[,{element:e,bounds:t,removed:n}]of u)n?Object.assign(e.style,{top:a.top?0:`${t.top}px`,left:a.left?0:`${t.left}px`,width:a.width?0:`${t.width}px`,height:a.height?0:`${t.height}px`,opacity:a.opacity?0:e.$initial.opacity}):Object.assign(e.style,{top:`${t.top}px`,left:`${t.left}px`,width:`${t.width}px`,height:`${t.height}px`,opacity:e.$initial.opacity});await je.sleep(n),e.classList.remove("b-dom-transition");for(const e of d)e.$initial&&(e.$initial.removed?e.remove():(Ut.copyProperties(e.style,e.$initial,h),e.$scrollPlaceholder&&(e.$scrollPlaceholder.remove(),delete e.$scrollPlaceholder),e.classList.remove("b-dom-transition-adding"),e.$initial.parentElement.appendChild(e)));for(const e of o)e.scrollTop=e.$scrollTop,delete e.$scrollTop}static async loadScript(e){return new Promise(((t,n)=>{const r=document.createElement("script");r.src=e,r.onload=t,r.onerror=n,document.head.appendChild(r)}))}static isNamedColor(e){return e&&!/^(#|hsl|rgb|hwb|lab|lch|oklab|oklch)/.test(e)}static createColorStyle(e){return null!=e&&e.length?this.isNamedColor(e)?`var(--cal-color-${e})`:e:""}static get NodeFilter(){return NodeFilter}static addChild(e,t,n){e.insertBefore(t,n)}static cloneStylesIntoShadowRoot(e,t){return new Promise(((n,r)=>{t&&e.querySelectorAll('style, link[rel="stylesheet"]').forEach((e=>e.remove()));const s=document.querySelectorAll('link[rel="stylesheet"]');let i=0;s.forEach((t=>{const a=t.cloneNode();a.addEventListener("load",(()=>{i+=1,i===s.length&&n()})),a.addEventListener("error",(e=>{r(a.href)})),e.appendChild(a)})),document.querySelectorAll("style").forEach((t=>{const n=t.cloneNode();n.innerText=t.innerText,e.appendChild(n)})),s.length||n()}))}}const br=yr;let Cr;const Sr=()=>br.isTouchEvent=!1,wr=()=>{br.isTouchEvent=!0,clearTimeout(Cr),Cr=setTimeout(Sr,400)};if(Qn.addEventListener("touchstart",wr,!0),Qn.addEventListener("touchend",wr,!0),br.canonicalStyles=cr,br.supportsTemplate="content"in Qn.createElement("template"),br.elementPropKey="$bryntum",br.numberRe=$n,!("children"in Node.prototype)){const e=e=>e.nodeType===e.ELEMENT_NODE;Object.defineProperty(Node.prototype,"children",{get:function(){return Array.prototype.filter.call(this.childNodes,e)}})}Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){const t=(this.document||this.ownerDocument).querySelectorAll(e);let n=t.length;for(;--n>=0&&t.item(n)!==this;);return n>-1}),Jn.Element&&!Element.prototype.closest?Node.prototype.closest=Element.prototype.closest=function(e){let t=this;if(!Qn.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&t.nodeType===t.ELEMENT_NODE);return null}:Node.prototype.closest=function(e){var t;return null===(t=this.parentNode)||void 0===t?void 0:t.closest(e)},[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(e){Object.prototype.hasOwnProperty.call(e,"remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})),globalThis.addEventListener("resize",(()=>pr=null)),yr._$name="DomHelper";const Dr=e=>e.floating,Tr={touchend:1,pointerup:1},Er={Meta:1,Control:1,Alt:1},xr=new class extends(ue.mixin(Ne)){suspendFocusEvents(){$r=!0}resumeFocusEvents(){$r=!1}setupFocusListenersOnce(e,t){e&&!xr.observedElements.has(e)&&(xr.setupFocusListeners(e,t),xr.observedElements.add(e))}detachFocusListeners(e){e.$globalEventsDetacher&&(e.$globalEventsDetacher(),e.$globalEventsDetacher=null,xr.observedElements.delete(e))}setupFocusListeners(e=document,t,n=!1){var s;const i={element:e,touchstart(e){if(Ir||1!==e.changedTouches.length)Ir=null;else if(Ir=e.changedTouches[0],!r.isAndroid){const n=({clientX:e,clientY:t,type:n})=>{(Tr[n]||Math.max(Math.abs(e-Ir.clientX),Math.abs(t-Ir.clientY))>5)&&(Rr=null,r(),clearTimeout(s))},r=t.on({element:document,touchmove:n,touchend:n,pointermove:n,pointerup:n,capture:!0}),s=setTimeout((()=>{Rr=Ir.identifier,r(),e.target.dispatchEvent(new MouseEvent("contextmenu",t.copyEvent({},e)))}),t.longPressTime)}},touchend:{handler:e=>{Ir&&(e.changedTouches[0].identifier===Rr?(e.stopImmediatePropagation(),!1!==e.cancelable&&e.preventDefault()):1===e.changedTouches.length&&e.changedTouches[0].identifier===Ir.identifier&&xr.trigger("globaltap",{event:e}),Ir=null)},passive:!1},mousedown:{handler:e=>{Mr="mouse",Ir||xr.trigger("globaltap",{event:e}),Ar=e;const t=e.ctrlKey||e.altKey||e.shiftKey||e.metaKey;!Or&&t?Or=new KeyboardEvent("keydown",{key:e.ctrlKey?"Control":e.shiftKey?"Shift":e.altKey?"Alt":"Meta",ctrlKey:e.ctrlKey,altKey:e.altKey,shiftKey:e.shiftKey,metaKey:e.metaKey}):Or&&!t&&(Or=null)},passive:!1},mouseup(){Ar=null},pointerdown:{passive:!1,handler:t=>{var n;Fr=t,yr.usingKeyboard=!1,null===(n=e.classList)||void 0===n||n.remove("b-using-keyboard"),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&yr.removeClsGlobally(e,"b-using-keyboard")}},pointerup:{passive:!1,handler:e=>{var t;(null===(t=Fr)||void 0===t?void 0:t.pointerId)===e.pointerId&&(Fr=null)}},keydown(t){if(Mr="key",Or=t,Pr=t.target,!Er[t.key])if(yr.usingKeyboard=!0,e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(const t of e.children)t.matches(".b-outer")&&t.classList.add("b-using-keyboard");else e.classList.add("b-using-keyboard")},mouseenter(e){Pr=e.target},keypress(){Mr="key"},keyup(){Or=null},focusin(e){var t,n;const{Widget:r}=xr;if(null!==(t=e.target)&&void 0!==t&&t.shadowRoot||null!==(n=e.target)&&void 0!==n&&n._shadowRoot)return;if(r.resetFloatRootScroll(),$r)return;const s=e.relatedTarget?e.relatedTarget instanceof HTMLElement?e.relatedTarget:document.body:null,i=e.target||document.body,a=r.fromElement(s),o=r.fromElement(i),l=yr.getCommonAncestor(a,o),c=!!(s&&4&i.compareDocumentPosition(s)),d=r.query(kr);let u=null;if(u=i&&i!==document.body?yr.getActiveElement(i):yr.getActiveElement(document),d&&!d._isRevertingFocus&&(!o||!d.owns(o)&&!(4&d.element.compareDocumentPosition(o.element)&&o.up(Dr))))return d.focus();let h=_r("focusout",s,e.target,a,o,c);for(let t,n=a;n&&n!==l;n=t)if(t=n.owner,!n.isDestroying&&n.onFocusOut&&(n.onFocusOut(h),e.target&&u!==yr.getActiveElement(e.target)))return;if(l&&e.target===l.element)!l.isDestroying&&yr.getActiveElement(l)===i&&l.focusElement&&l.focusElement!==l.element&&(l.element.contains(u)&&!l.focusDescendant||l.setTimeout((()=>{var e;return null===(e=l.focus)||void 0===e?void 0:e.call(l)}),0));else{h=_r("focusin",i,s,a,o,c);for(let e=o;e&&e!==l;e=e.owner){var g,m;if(!e.isDestroying)null===(g=(m=e).onFocusIn)||void 0===g||g.call(m,h)}}const p=yr.getCommonAncestor((null==s?void 0:s.nodeType)===Element.ELEMENT_NODE?s:null,i)||i.parentNode;p&&(h=_r("focusmove",i,s,a,o,c,{bubbles:!0}),p.dispatchEvent(h))},focusout(e){if(!($r||e.relatedTarget&&xr.Widget.fromElement(e.relatedTarget))){const t=e.relatedTarget&&e.relatedTarget instanceof HTMLElement?e.relatedTarget:null;i.focusin({target:t,relatedTarget:e.target}),Or=Ar=null}},blur:{element:globalThis,handler(e){e.target===globalThis&&(Or=null,Ar=null)}},capture:!0,passive:!0};n&&(null===(s=Lr)||void 0===s||s()),Lr=this.detachEvents=e.$globalEventsDetacher=t.on(i)}get lastInteractionType(){return Mr}get shiftKeyDown(){var e;return null===(e=Or)||void 0===e?void 0:e.shiftKey}get ctrlKeyDown(){var e,t;return(null===(e=Or)||void 0===e?void 0:e.ctrlKey)||(null===(t=Or)||void 0===t?void 0:t.metaKey)}get altKeyDown(){var e;return null===(e=Or)||void 0===e?void 0:e.altKey}get currentOverElement(){return Pr}isKeyDown(e){var t;return e?(null===(t=Or)||void 0===t?void 0:t.key)===e||!0===Or[(null==e?void 0:e.toLowerCase())+"Key"]:Boolean(Or)}isMouseDown(e=0){var t;return(null===(t=Ar)||void 0===t?void 0:t.button)===e}get currentMouseDown(){return Ar}get currentPointerDown(){return Fr}get currentTouch(){return Ir}get currentKeyDown(){return Or}},kr=e=>e.isVisible&&e.isTopModal;xr.observedElements=new Set;let Ir,Rr,Mr,Or,Ar,Fr,Pr,Lr,$r=!1;function _r(e,t,n,r,s,i,a){const o=new CustomEvent(e,a);return Object.defineProperty(o,"_target",{get:()=>t}),Object.defineProperty(o,"relatedTarget",{get:()=>n}),o.fromWidget=r,o.toWidget=s,o.backwards=i,o}class Nr extends(ue.mixin(Ne,Je)){static $name="InstancePlugin";static get configurable(){return{clientListeners:null,disabled:!1,client:null,keyMap:null}}updateClient(e){this.owner||(this.owner=e)}updateKeyMap(e){const{client:t}=this;t.keyMap=t.mergeKeyMaps(t.keyMap,e,T.uncapitalize(this.constructor.$name))}static initPlugins(e,...t){const n=e.plugins||(e.plugins={});for(const r of t)n[r.$$name]=new r(e)}get enabled(){return!this.disabled}getFocusRevertTarget(){var e;return null===(e=this.client)||void 0===e?void 0:e.getFocusRevertTarget()}construct(...e){const t=this;let n,[r,s]=e;1===e.length?Ut.isObject(r)&&(s=r,r=s.client):(s=Ut.assign({},s),delete s.client),t.client=r,super.construct(s),t.applyPluginConfig(r),n=t.clientListeners,n&&(n=Ut.assign({},n),n.thisObj=t,r.ion(n))}applyPluginConfig(e){const t=this,n=t.pluginConfig||t.constructor.pluginConfig;if(n){const{assign:r,chain:s,after:i,before:a,override:o}=n;r&&t.applyAssign(e,r),(s||i)&&t.applyChain(e,s||i),a&&t.applyChain(e,a,!1),o&&t.applyOverride(e,o)}}applyAssign(e,t){t.forEach((t=>this.assign(e,t)))}applyChain(e,t,n=!0){if(Array.isArray(t))for(const r of t)this.chain(e,r,r,n);else for(const r in t)this.chain(e,r,t[r],n)}applyOverride(e,t){const n=this;n.overridden||(n.overridden={}),t.forEach((t=>{if(!n[t])throw new Error(`Trying to chain fn ${e.$$name}#${t}, but plugin fn ${n.$$name}#${t} does not exist`);"function"==typeof e[t]&&(n.overridden[t]=e[t].bind(e)),e[t]=n[t].bind(n)}))}assign(e,t){const n=this,r=function(e,t){const n=Ut.getPropertyDescriptor(e,t);return n&&(n.get||n.set)?n:null}(n,t);r?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:r.get&&r.get.bind(n),set:r.set&&r.set.bind(n)}):e[t]=n[t].bind(n)}chain(e,t,n,r=!0){let s=0;"object"==typeof t&&(t=t.fn),"object"==typeof n&&(s=n.prio||0,n=n.fn);const i=this,a=e.pluginFunctionChain||(e.pluginFunctionChain={}),o=i[n]&&i[n].bind(i),l=i.functionChainRunner;if(!o)throw new Error(`Trying to chain fn ${e.$$name}#${n}, but plugin fn ${i.$$name}#${n} does not exist`);if(!a[t]){let n=e[t];n&&(n=n.bind(e),n.$this=e,n.$prio=0),a[t]=n?[n]:[],e[t]=(...e)=>l(a[t],e)}o.$this=i,o.$prio=s,a[t][r?"push":"unshift"](o),a[t].$sorted=!1}functionChainRunner(e,t){let n,r,s;for(e.$sorted||(e.sort(((e,t)=>t.$prio-e.$prio)),e.$sorted=!0),r=0;r<e.length&&(n=e[r],n.$this.isDestroyed||(s=n(...t),!1!==s));r++);return s}doDisable(e){const t=this,{constructor:n}=t,r="featureClass"in n?n.featureClass:`b-${n.$$name.toLowerCase()}`,s=T.uncapitalize(n.$$name);var i,a,o,l;r&&(null===(i=t.client)||void 0===i||null===(a=i._element)||void 0===a||a.classList[e?"remove":"add"](r));t.isConfiguring||(e?t.trigger("disable"):t.trigger("enable"),null===(o=(l=t.client).syncSplits)||void 0===o||o.call(l,(t=>{const n=t.features[s];n&&(n.disabled=e)})))}updateDisabled(e){this.doDisable(e)}throwOverrideIsMissing(e){throw new Error(`Trying to override fn ${e.plugIntoName}#${e.fnName}, but plugin fn ${e.pluginName}#${e.fnName} does not exist`)}get rootElement(){return this.client.rootElement}}Nr._$name="InstancePlugin";var jr=e=>class extends(e||ue){static get $name(){return"Pluggable"}get plugins(){return this._plugins||(this._plugins={}),this._plugins}set plugins(e){e&&(Array.isArray(e)||(e=[e]),Nr.initPlugins(this,...e)),this.initPlugins()}initPlugins(){}addPlugins(...e){Nr.initPlugins(this,...e)}hasPlugin(e){return null!=this.getPlugin(e)}getPlugin(e){var t;return"function"==typeof e&&(e=e.$$name),null===(t=this.plugins)||void 0===t?void 0:t[e]}get widgetClass(){}};const{defineProperty:Vr}=Reflect;let Br;Br=r.isBrowserEnv?globalThis.performance:{now:()=>(new Date).getTime()};let zr=null;if(P.isTestEnv){const e=globalThis.bryntum||(globalThis.bryntum={});zr=e.globalDelays={timeouts:new Map,intervals:new Map,animationFrames:new Map,idleCallbacks:new Map,isEmpty:(e=!1)=>zr.timeouts.size+zr.animationFrames.size+zr.idleCallbacks.size+(e?zr.intervals.size:0)===0,getFiltered({ignoreTimeouts:e=[],maxDelay:t=5e3,includeIntervals:n=!1}){const r=[],s=["timeouts","animationFrames","idleCallbacks"];n&&s.push("intervals");for(const n of s){const s=zr[n];for(const[,n]of s.entries())e.includes(n.name)||Number.isInteger(n.delay)&&!(n.delay<t)||r.push(n)}return r}}}const Wr=(e,t,n,r)=>{const s="string"==typeof t,i=(null==r?void 0:r.appendArgs)||[],a=()=>{n.timerId=null,n.lastCallTime=Br.now();const r=n.args;n.args=null,s?e[t](...r,...i):t.call(e,...r,...i),n.called=!0,++n.calls};return r&&(e=r.thisObj||e),n.lastCallTime=-9e9,n.calls=0,n.invoker=a,a.wrapFn=n,a},Hr=(e,t,n="clearTimeout")=>(t.cancel=()=>{t.isPending&&(e[n](t.timerId),t.args=t.timerId=null)},t.flush=()=>{t.isPending&&(e[n](t.timerId),t.timerId=null,t.invoker())},t.now=(...e)=>{t.cancel(),t.args=e,t.invoker()},t.resume=e=>{const n=t.suspended;t.suspended=e||n<1?0:n-1},t.suspend=()=>{++t.suspended},t.immediate=!1,t.suspended=0,t.timerId=null,Vr(t,"isPending",{get:()=>null!==t.timerId}),t);var Ur=e=>class extends(e||ue){static get $name(){return"Delayable"}static get declarable(){return["delayable"]}doDestroy(){const e=this;super.doDestroy(),e.timeoutIds&&(e.timeoutIds.forEach(((e,t)=>{var n;"function"==typeof e&&e(),clearTimeout(t),null===(n=zr)||void 0===n||n.timeouts.delete(t)})),e.timeoutIds=null),e.timeoutMap&&(e.timeoutMap.forEach(((e,t)=>clearTimeout(t))),e.timeoutMap=null),e.intervalIds&&(e.intervalIds.forEach((e=>{var t;clearInterval(e),null===(t=zr)||void 0===t||t.intervals.delete(e)})),e.intervalIds=null),e.animationFrameIds&&(e.animationFrameIds.forEach((e=>{var t;cancelAnimationFrame(e),null===(t=zr)||void 0===t||t.animationFrames.delete(e)})),e.animationFrameIds=null),e.idleCallbackIds&&(e.idleCallbackIds.forEach((e=>{var t;cancelIdleCallback(e),null===(t=zr)||void 0===t||t.idleCallbacks.delete(e)})),e.idleCallbackIds=null)}hasTimeout(e){var t;return Boolean(null===(t=this.timeoutMap)||void 0===t?void 0:t.has(e))}setTimeout({fn:e,delay:t,name:n,runOnDestroy:r,cancelOutstanding:s,args:i}){var a;(arguments.length>1||"function"==typeof arguments[0])&&([e,t,n,r]=arguments),"string"==typeof e?n=e:n||(n=e.name||e),s&&this.clearTimeout(n);const o=this,l=o.timeoutIds||(o.timeoutIds=new Map),c=o.timeoutMap||(o.timeoutMap=new Map),d=setTimeout((()=>{var t;"string"==typeof e&&(e=o[n]),null==l||l.delete(d),null==c||c.delete(n),null===(t=zr)||void 0===t||t.timeouts.delete(d),e.apply(o,i)}),t);return l.set(d,!r||e),null===(a=zr)||void 0===a||a.timeouts.set(d,{fn:e,delay:t,name:n}),n&&c.set(n,d),d}clearTimeout(e){var t,n;let r=e;if("string"==typeof r){if(!this.timeoutMap)return;r=this.timeoutMap.get(e),this.timeoutMap.delete(e)}clearTimeout(r),null===(t=this.timeoutIds)||void 0===t||t.delete(r),null===(n=zr)||void 0===n||n.timeouts.delete(r)}clearInterval(e){var t,n;clearInterval(e),null===(t=this.intervalIds)||void 0===t||t.delete(e),null===(n=zr)||void 0===n||n.intervals.delete(e)}setInterval(e,t,n){var r;const s=setInterval(e,t);return(this.intervalIds||(this.intervalIds=new Set)).add(s),null===(r=zr)||void 0===r||r.intervals.set(s,{fn:e,delay:t,name:n}),s}requestAnimationFrame(e,t=[],n=this){var r;const s=this.animationFrameIds||(this.animationFrameIds=new Set),i=requestAnimationFrame((()=>{var r;null===(r=zr)||void 0===r||r.animationFrames.delete(i),s.delete(i)&&e.apply(n,t)}));return s.add(i),null===(r=zr)||void 0===r||r.animationFrames.set(i,{fn:e,extraArgs:t,thisObj:n}),i}requestIdleCallback(e,t=[],n=this){var r;const s=this.idleCallbackIds||(this.idleCallbackIds=new Set),i=requestIdleCallback((()=>{var r;null===(r=zr)||void 0===r||r.idleCallbacks.delete(i),s.delete(i)&&e.apply(n,t)}));return s.add(i),null===(r=zr)||void 0===r||r.idleCallbacks.set(i,{fn:e,extraArgs:t,thisObj:n}),i}createOnFrame(e,t=[],n=this,r){let s;const i=(...i)=>{null!=s&&r&&(this.cancelAnimationFrame(s),s=null),null==s&&(s=this.requestAnimationFrame((()=>{"string"==typeof e&&(e=n[e]),s=null,i.push(...t),e.apply(n,i)})))};return i.cancel=()=>this.cancelAnimationFrame(s),i}cancelAnimationFrame(e){var t,n;cancelAnimationFrame(e),null===(t=this.animationFrameIds)||void 0===t||t.delete(e),null===(n=zr)||void 0===n||n.animationFrames.delete(e)}cancelIdleCallback(e){var t,n;cancelIdleCallback(e),null===(t=this.idleCallbackIds)||void 0===t||t.delete(e),null===(n=zr)||void 0===n||n.idleCallbacks.delete(e)}async nextAnimationFrame(){return new Promise((e=>this.requestAnimationFrame(e)))}buffer(e,t){let n=t;t&&"number"!=typeof t?n=t.delay:t=null;const r=(...e)=>{if(r.suspended)return;const{delay:t}=r;r.cancel(),r.called=!1,r.args=e,r.immediate||!t?s():r.timerId=this.setTimeout(s,t)},s=Wr(this,e,r,t);return r.delay=n,Hr(this,r)}raf(e,t){let n=t;t&&"boolean"!=typeof t?n=t.cancelOutstanding:t=null;const r=(...e)=>{r.suspended||(r.cancelOutstanding&&r.cancel(),r.called=!1,r.args=e,r.immediate?s():r.isPending||(r.timerId=this.requestAnimationFrame(s)))},s=Wr(this,e,r,t);return r.cancelOutstanding=n,Hr(this,r,"cancelAnimationFrame")}idle(e,t){let n=t;t&&"boolean"!=typeof t?n=t.cancelOutstanding:t=null;const r=(...e)=>{r.suspended||(r.cancelOutstanding&&r.cancel(),r.called=!1,r.args=e,r.immediate?s():r.isPending||(r.timerId=this.requestIdleCallback(s)))},s=Wr(this,e,r,t);return r.cancelOutstanding=n,this.setTimeout((()=>this.idleCallbackIds.delete(r.timerId)&&r.now()),100),Hr(this,r,"cancelIdleCallback")}throttle(e,t){let n,r=t;t&&"number"!=typeof t?(r=t.delay,n=t.throttled):t=null;const s=this,i=(...e)=>{if(i.suspended)return;const{delay:t}=i,r=Br.now()-i.lastCallTime;i.args=e,i.immediate||r>=t?(s.clearTimeout(i.timerId),a()):(i.isPending||(i.timerId=s.setTimeout(a,t-r),i.called=!1),n&&(n.wrapFn.args=e,n()))},a=Wr(s,e,i,t);return i.delay=r,n&&(n=Wr(s,n,(()=>{}),t)),Hr(s,i)}static setupDelayable(e){e.setupDelayableMethods(e.delayable)}static setupDelayableMethods(e,t=null){const n=e.static,r=t||this.prototype;n&&delete e.static;for(const t in e){let n=e[t];const s=t+"Now",i=typeof n;r[s]||(r[s]=r[t]),"number"===i?n={type:"buffer",delay:n}:"string"===i&&(n={type:n}),Vr(r,t,{get(){const e=this[n.type](((...e)=>{this[s](...e)}),n);return Vr(this,t,{value:e}),e}})}}get widgetClass(){}};class Yr{get data(){return Object.create(null)}get keys(){return[]}clear(){}getItem(e){return null}removeItem(e){}setItem(e,t){}}Yr._$name="StateStorage";const qr=()=>Object.create(null),Kr=(e,t=0)=>{const n=[],r=localStorage.length;for(let s,i=0;i<r;++i)s=localStorage.key(i),s.startsWith(e)&&n.push(s.slice(t));return n},Gr=new Yr,Xr={local:class extends Yr{constructor(e){super(),this.prefix=e.prefix||""}get isLocal(){return!0}get data(){const e=qr(),t=this.keys;for(const n of t)e[n]=this.getItem(n);return e}get keys(){return Kr(this.prefix,this.prefix.length)}clear(){const e=Kr(this.prefix);for(const t of e)localStorage.removeItem(t)}getItem(e){const t=localStorage.getItem(this.prefix+e);return null===t?t:JSON.parse(t)}removeItem(e){return localStorage.removeItem(this.prefix+e)}setItem(e,t){return localStorage.setItem(this.prefix+e,JSON.stringify(t))}},memory:class extends Yr{constructor(){super(),this.clear()}get isMemory(){return!0}get data(){return Ut.clone(this._data)}get keys(){return Object.keys(this._data)}clear(){this._data=qr()}getItem(e){return e in this._data?this._data[e]:null}removeItem(e){delete this._data[e]}setItem(e,t){this._data[e]=t}}};class Zr extends(ue.mixin(Ur,Ne)){static get $name(){return"StateProvider"}static get configurable(){return{prefix:"bryntum-state:",storage:"local"}}static get delayable(){return{writeStatefuls:50}}static get instance(){return this._instance}static set instance(e){null==e?e=Jr:(("string"==typeof e||Ut.isClass(e)||e instanceof Yr)&&(e={storage:e}),Ut.isObject(e)&&(e=new Zr(e))),this._instance=e}static setup(e){return this.instance=e,this.instance}doDestroy(){self.writeStatefuls.flush(),super.doDestroy()}get data(){return this.storage.data}set data(e){if(e)for(const t in e)this.setValue(t,e[t]);else this.clear()}clear(){return this.storage.clear(),this}changeStorage(e){if(null==e)e=Gr;else{if("string"==typeof e){if(!Xr[e])throw new Error(`Invalid storage type "${e}" (expected one of: "${Object.keys(Xr).join('", "')}")`);e=Xr[e]}Ut.isClass(e)&&(e=new e(this))}return e}saveStateful(e,t){(this.pendingSaves||(this.pendingSaves=[])).push([e,t]),this.writeStatefuls()}writeStatefuls(){const e=this,{pendingSaves:t}=e,n=null==t?void 0:t.length,r=[],s=[];if(e.pendingSaves=null,n){for(let e,i,a,o=0;o<n;++o)[i,e]=t[o],!i.isDestroying&&i.isSaveStatePending&&(a=i.saveState({...e,immediate:!0}),a&&(r.push(a),s.push(i)));r.length&&e.trigger("save",{stateIds:r,saved:s})}}getValue(e){return this.writeStatefuls.flush(),this.storage.getItem(e)}setValue(e,t){const n=this,{storage:r}=n,s=n.getValue(e);return null!=t?(r.setItem(e,t),n.trigger("set",{key:e,value:t,was:s})):null!==s&&(r.removeItem(e),n.trigger("remove",{key:e,was:s})),n}}const Jr=new Zr({storage:Gr});Zr._instance=Jr,Zr._$name="StateProvider";const Qr=/boolean|number|string/;var es=e=>class extends(e||ue){static $name="State";static configurable={stateful:{value:null,$config:{merge:"classList"}},statefulEvents:{$config:{merge:"classList"},value:["stateChange"]},stateId:null,stateProvider:null};static prototypeProperties={statefulLoaded:!1,statefulSuspended:0};afterConstruct(){super.afterConstruct(),this.loadState()}finalizeInit(){this.loadState(),super.finalizeInit()}get isStateful(){return!0}get isStatefulActive(){return!this.statefulSuspended&&!this.isResponsivePending&&!this.isResponsiveUpdating}get state(){return this._state=this.getState()}set state(e){this._state=e,e&&this.applyState(e)}updateStatefulEvents(e){const t=this,n={name:"statefulEvents",thisObj:t};if(t.detachListeners(n.name),e&&("string"==typeof e?e=T.split(e):Array.isArray(e)||(e=Ut.getTruthyKeys(e)),e.length)){var r;for(const t of e)n[t]="onStatefulEvent";null===(r=t.ion)||void 0===r||r.call(t,n)}}get statefulId(){const e=this,{responsiveState:t}=e;let n=e.stateId;return null==n&&!1===e.hasGeneratedId&&!1!==e.stateful&&(n=e.id),n&&t&&(n=`${n}[${t}]`),n}get statefulness(){const{stateful:e}=this;return Array.isArray(e)?Ut.createTruthyKeys(e):e}get stateProvider(){return this._stateProvider||Zr.instance}applyState(e){(e=this.pruneState(e))&&this.setConfig(e)}getState(){const e=this,{initialConfig:t,statefulness:n,isConstructing:r}=e,{configs:s}=e.$meta,i=r?Object.setPrototypeOf(t,e.$meta.config):e;let a,o,l=null;if(n)for(a in l={},n)if(n[a]){var c;if(o=i[a],null!==(c=o)&&void 0!==c&&c.isStateful)o=o.state;else if(!r&&(Ut.isDate(o)&&(o=Bt.format(o,"YYYY-MM-DDTHH:mm:ssZ")),s[a].equal(o,null==t?void 0:t[a])||!Qr.test(typeof o)))continue;l[a]=o}return l}loadState(e,t){"boolean"==typeof e&&(t=e,e=null);const n=this,{statefulLoaded:r}=n;if(n.isStatefulActive&&(t||!r)){const t=n.loadStatefulData(e||(e=n.statefulId));!r&&e&&(n.defaultState=n.state,n.statefulLoaded=!0),t&&(n.state=t)}}loadStatefulData(e){var t;return(e=this.isStatefulActive?e||this.statefulId:null)&&(null===(t=this.stateProvider)||void 0===t?void 0:t.getValue(e))}resetDefaultState(){this.defaultState&&(this.state=this.defaultState)}resumeStateful(e=!1){this.statefulSuspended=e?0:Math.max(this.statefulSuspended-1,0)}saveState(e){e="string"==typeof e?{id:e}:e||{};const t=this,{stateProvider:n}=t,r=e.id||t.isStatefulActive&&t.statefulId;if(r&&n)return e.immediate?(t.isSaveStatePending=!1,n.setValue(r,t.state)):t.isSaveStatePending||(t.isSaveStatePending=!0,n.saveStateful(t,e)),r}suspendStateful(){++this.statefulSuspended}onConfigChange({name:e,value:t,was:n,config:r}){if(super.onConfigChange({name:e,value:t,was:n,config:r}),!this.isConstructing&&this.isStatefulActive&&this.statefulId){const{stateful:t}=this;(Array.isArray(t)?t.includes(e):null==t?void 0:t[e])&&this.saveState()}}onStatefulEvent(){this.isConstructing||this.saveState()}pruneState(e){const{statefulness:t}=this;if(t){const n={};for(const r in e)t[r]&&(n[r]=e[r]);e=n}return e}get widgetClass(){}};const ts=Ut.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null)),ns={string:1,number:1};var rs=e=>class extends(e||ue){static get $name(){return"Identifiable"}static get declarable(){return["identifiable"]}static get configurable(){return{id:""}}static setupIdentifiable(e,t){const{identifiable:n}=e;n.idMap=Object.create(null),Reflect.defineProperty(e,"identifiable",{get:()=>n})}doDestroy(){this.constructor.unregisterInstance(this),super.doDestroy()}changeId(e){return(this.hasGeneratedId=!e)?this.generateAutoId():e}updateId(e,t){const n=this,r=n.constructor;t&&r.unregisterInstance(n,t),n.hasGeneratedId&&!1===r.identifiable.registerGeneratedId||r.registerInstance(n,e)}generateAutoId(){return this.constructor.generateId(`b-${this.$$name.toLowerCase()}-`)}static get all(){return Object.values(this.identifiable.idMap)}static generateId(e="generatedId"){return e+(ts[e]=(ts[e]||0)+1)}static registerInstance(e,t=e.id){const{idMap:n}=this.identifiable;if(t in n&&!this.disableThrow)throw new Error("Id "+t+" already in use");n[t]=e}static unregisterInstance(e,t=e.id){const{idMap:n}=this.identifiable;ns[typeof e]?delete n[e]:n[t]===e&&delete n[t]}static getById(e){const t=this.identifiable.idMap;if(t)return t[e]}static get registeredInstances(){const e=this.identifiable.idMap;return e?Object.values(e):[]}};const ss=Symbol("STM_PROP"),is={parentIndex:1};var as=e=>class extends(e||ue){static get $name(){return"ModelStm"}static get defaultConfig(){return{stm:null}}joinStore(e){this.stm||(this.stm=e.stm)}unjoinStore(e,t=!1){var n;this.stm===e.stm&&(this.stm=null),null===(n=super.unjoinStore)||void 0===n||n.call(this,e,t)}get stm(){return this[ss]}set stm(e){this[ss]=e}beforeChronoFieldSet(e,t){var n;const r=this;return r.inSetting||null===(n=r.stm)||void 0===n||!n.enabled||is[e]||r.constructor.nonPersistableFields[e]||!r.getFieldDefinition(e)?null:{[e]:{value:t,oldValue:r[e]}}}afterChronoFieldSet(e,t,n){n&&this.afterSet(e,t,!1,!1,n,!0)}shouldRecordFieldChange(e,t,n){const r=this.firstStore;return!(this.constructor.nonPersistableFields[e]||null==t&&null==n||t===n||t instanceof Date&&n instanceof Date&&t.getTime()===n.getTime()||"id"===e||"$PhantomId"===e||"parentId"===e&&r&&r.oldIdMap[t]===r.getById(n))}afterSet(e,t,n,r,s,i){const{stm:a}=this,o=this.constructor.nonPersistableFields;if(null!=a&&a.isBase&&a.enabled&&!is[e]&&!o[e]&&s){let e;const[t,n]=Object.keys(s).reduce(((t,n)=>{const{value:r,oldValue:i}=s[n];return this.shouldRecordFieldChange(n,i,r)&&(e=!0,t[0][n]=r,t[1][n]=i),t}),[{},{}]);e&&a.onModelUpdate(this,t,n,i)}}beforeInsertChild(e){var t;const n=(null===(t=super.beforeInsertChild)||void 0===t?void 0:t.call(this,e))||[],{stm:r}=this;return null!=r&&r.enabled&&n.push(e.reduce(((e,t)=>(t.root===this.root&&e.set(t,{parent:t.parent,index:t.parent?t.parentIndex:void 0}),e)),new Map)),n}afterInsertChild(e,t,n,r){var s;const{stm:i}=this;if(null!=i&&i.enabled){const t=n.pop();r&&i.onModelInsertChild(this,e,r,t)}null===(s=super.afterInsertChild)||void 0===s||s.call(this,e,t,n,r)}beforeRemoveChild(e,t){const n=super.beforeRemoveChild?super.beforeRemoveChild(e,t):[],{stm:r}=this;return null!=r&&r.enabled&&!t&&n.push(e.reduce(((e,t)=>(e.set(t,{parentIndex:t.parentIndex,orderedParentIndex:t.orderedParentIndex}),e)),new Map)),n}afterRemoveChild(e,t,n){var r;const{stm:s}=this;if(null!=s&&s.enabled&&!n){const n=t.pop();e&&e.length&&s.onModelRemoveChild(this,e,n)}null===(r=super.afterRemoveChild)||void 0===r||r.call(this,e,t,n)}};const os={includeFilteredOutRecords:!1},ls=e=>("boolean"==typeof(e=e||!1)&&(e={includeFilteredOutRecords:e}),e||os);var cs=e=>class extends(e||ue){static get $name(){return"TreeNode"}static set convertEmptyParentToLeaf(e){!0===e?e={onLoad:!0,onRemove:!0}:!1===e&&(e={onLoad:!1,onRemove:!1}),this._convertEmptyParentToLeaf=e}constructor(...e){super(...e),this.children&&(this.orderedChildren=this.orderedChildren||[])}static get convertEmptyParentToLeaf(){return this._convertEmptyParentToLeaf||{onLoad:!1,onRemove:!1}}ingestChildren(e,t=this.stores){const{inProcessChildren:n,constructor:r}=this,s=t[0];if(!0===e)return!!n||[];if(e){const t=(e=ge.asArray(e)).length,n=[];for(let i,a=0;a<t;a++)i=e[a],i=i.isModel?i:s?s.createRecord(i,!1,!0):new r(i,null,null,!0),i=s?s.processRecord(i):i,n.push(i);if(!0===this.children&&s){const e=s.createSorterFn(s.sorters);n.sort(e)}return n}}processChildren(e=this.stores){const t=this,{meta:n}=t;t.inProcessChildren=!0;const r=t.ingestChildren(t.data[t.constructor.childrenField],e);if(r){const{convertEmptyParentToLeaf:e}=t.constructor;if(!0===e||e.onLoad?r.length:Array.isArray(r)){if(n.isLeaf=!1,!0===t.children)t.children=[];else if(0===r.length)return void(t.children=r);t.insertChild(r)}else!0===r?(n.isLeaf=!1,t.children=!0):t.isRoot||(n.isLeaf=t.constructor.convertEmptyParentToLeaf.onLoad)}t.inProcessChildren=!1}ancestorsExpanded(e=this.firstStore){const{parent:t}=this;return!t||t.isExpanded(e)&&t.ancestorsExpanded(e)}isExpanded(e=this.firstStore){const t=this.instanceMeta(e.id);return Object.prototype.hasOwnProperty.call(t,"collapsed")||(t.collapsed=!this.expanded),!t.collapsed}get expanded(){return this.data.expanded}get childLevel(){let e=this,t=-1;for(;e&&!e.isRoot;)++t,e=e.parent;return t}get isLeaf(){return!1!==this.meta.isLeaf&&!this.isRoot}get isParent(){return!this.isLeaf}get isLoaded(){return this.isParent&&Array.isArray(this.children)}get descendantCount(){return this.getDescendantCount()}get visibleDescendantCount(){return this.getDescendantCount(!0)}getDescendantCount(e=!1,t=this.firstStore){const{children:n}=this;return!n||!Array.isArray(n)||e&&!this.isExpanded(t)?0:n.reduce(((t,n)=>t+n.getDescendantCount(e)),n.length)}get allChildren(){return this.getAllChildren(!1)}get allUnfilteredChildren(){return this.getAllChildren(!0)}getAllChildren(e=!1){const{[e?"unfilteredChildren":"children"]:t}=this;return t&&!0!==t?t.reduce(((t,n)=>(t.push(n),t.push.apply(t,e?n.allUnfilteredChildren:n.allChildren),t)),[]):[]}get firstChild(){const{children:e}=this;return(null==e?void 0:e.length)&&e[0]||null}get lastChild(){const{children:e}=this;return(null==e?void 0:e.length)&&e[e.length-1]||null}get previousSiblingsTotalCount(){let e=this.previousSibling,t=this.parentIndex;for(;e;)t+=e.descendantCount,e=e.previousSibling;return t}get previousOrderedSibling(){var e;return(null===(e=this.parent)||void 0===e?void 0:e.orderedChildren[this.orderedParentIndex-1])??null}get nextOrderedSibling(){var e;return(null===(e=this.parent)||void 0===e?void 0:e.orderedChildren[this.orderedParentIndex+1])??null}get root(){var e;return(null===(e=this.parent)||void 0===e?void 0:e.root)||this}get parentId(){return this.parent&&!this.parent.isAutoRoot?this.parent.id:null}set parentId(e){const t=this,{parent:n}=t,r=null===e?t.firstStore.rootNode:t.firstStore.getById(e);r!==n&&(n||r)&&(t.isBatchUpdating?t.meta.batchChanges.parentId=e:r?r.appendChild(t):t.parent.removeChild(t))}static set parentIdField(e){this._parentIdField=e,Object.defineProperty(this.prototype,e,{set:function(e){this.parentId=e},get:function(){return this.parentId}})}static get parentIdField(){return this._parentIdField||"parentId"}getChildren(e){let t;return t=e.includeFilteredOutRecords?this.unfilteredChildren||this.children:e.useOrderedTree?this.orderedChildren:this.children,t}traverse(e,t,n){n=ls(n);const r=this,s=r.getChildren(n);t||e.call(r,r);for(let t=0,r=null==s?void 0:s.length;t<r;t++)s[t].traverse(e,!1,n)}traverseBefore(e,t,n){n=ls(n);const r=this,s=r.getChildren(n);for(let t=0,r=null==s?void 0:s.length;t<r;t++)s[t].traverse(e,!1,n);t||e.call(r,r)}traverseWhile(e,t,n){n=ls(n);const r=this;let s=t||!1!==e.call(r,r);if(s){const t=r.getChildren(n);null!=t&&t.length&&(s=t.every((t=>t.traverseWhile(e,!1,n))))}return s}bubble(e,t=!1){let n=this;for(t||e.call(n,n);n.parent;)n=n.parent,e.call(n,n)}bubbleWhile(e,t=!1){let n=this,r=!0;for(t||(r=e.call(n,n));r&&n.parent;)n=n.parent,r=e.call(n,n);return r}contains(e,t=!1){return e&&"object"==typeof e&&(e=e.id),!this.traverseWhile((t=>t.id!=e),t)}getTopParent(e){let t;return e?(t=[],this.bubbleWhile((e=>(t.push(e),e.parent&&!e.parent.isRoot)))):(t=null,this.bubbleWhile((e=>(t=e,e.parent&&!e.parent.isRoot)))),t}appendChild(e,t=!1,n={}){return this.insertChild(e,null,t,n)}insertChild(e,t=null,n=!1,r={}){var s,i,a,o;const l=this,c=Array.isArray(e);var d;(e=ge.asArray(e),"number"==typeof t)&&(t=(null===(d=l.children)||void 0===d?void 0:d[t])??null);if(!n&&!l.stores.every((t=>!1!==t.trigger("beforeAdd",{records:e,parent:l}))))return null;e=l.ingestChildren(e);const u=(null===(s=t)||void 0===s?void 0:s.parentIndex)??(null===(i=l.children)||void 0===i?void 0:i.length)??0,h=null===(a=l.beforeInsertChild)||void 0===a?void 0:a.call(l,e),g=l.internalAppendInsert(e,t,n,r);return g.length&&l.convertToParent(n),null===(o=l.afterInsertChild)||void 0===o||o.call(l,u,e,h,g),c||!g?g:g[0]}convertToParent(e=!1){const t=this,n=t.isLeaf;t.meta.isLeaf=!1,t.children||(t.children=[]),!n||t.root.isLoading||e||t.signalNodeChanged({isLeaf:{value:!1,oldValue:!0}})}signalNodeChanged(e,t=this.stores){t.forEach((t=>{t.trigger("update",{record:this,records:[this],changes:e}),t.trigger("change",{action:"update",record:this,records:[this],changes:e})}))}tryInsertChild(){return this.insertChild(...arguments)}internalAppendInsert(e,t,n,r){const s=this,{stores:i,root:a,children:o}=s,{firstStore:l}=a,{parentIdField:c}=s.constructor,d=s.id;let u,h,g,m,p,f;if(!a.isLoading&&l)for(f={},p=[],g=0;g<e.length;g++){const t=e[g];f[t.id]=t.root===a,p[g]=t.parentIndex}if(t&&t.parent!==s&&(t=null),o){const n=t?t.parentIndex:o.length;if(o[h=n]===e[0]||o[h=n-1]===e[0])for(u=!0,g=0;u&&g<e.length;g++)e[g]!==o[h+g]&&(u=!1)}if(u)return e;for(g=0;g<e.length;g++){var v;const t=e[g],i=t.parent;if(l&&!a.isLoading&&t.traverse((e=>{e.root===a&&(f[e.id]=!0)})),!1===(null==i?void 0:i.removeChild(t,null===(v=f)||void 0===v?void 0:v[t.id],n,{isInserting:!0,...r})))m||(e=e.slice(),m=!0),e.splice(g--,1);else{t.parent=s,t.data[c]=d;const{meta:e}=t;e.modified[c]!==d||i||(e.oldParentId=d),i&&(e.oldParentId=i.id)}}if(e.length){Array.isArray(o)||(s.children=[]),Array.isArray(s.orderedChildren)||(s.orderedChildren=[]);const a=s.addToChildren(t,e,r);i.forEach((t=>{t.isChained||(e.forEach((e=>{e.joinStore(t)})),t.onNodeAddChild(s,e,a,f,n),e.forEach(((e,r)=>{if(null!=e.meta.oldParentId&&!s.inProcessChildren&&!s.isLoading){const i={[c]:d,[s.getDataSource("parentIndex")]:e.parentIndex},a={},{modified:o,oldParentId:l}=e.meta,u=p[r];if(delete e.meta.oldParentId,s.id!==l&&(a[c]={value:d,oldValue:l}),e.parentIndex!==u&&(a.parentIndex={value:e.parentIndex,oldValue:u}),o[c]===s.id?Reflect.deleteProperty(o,c):c in o||(o[c]=l),f[e.id]){const e=t.getById(l);e.isLeaf&&!n&&e.signalNodeChanged({isLeaf:{value:!0,oldValue:!1}},[t])}e.afterChange(i,a)}e.traverse((e=>{e.ignoreBag||e.isLinked||t.updateModifiedBagForRecord(e)}))})))}))}return e}removeChild(e,t=!1,n=!1,r={}){var s,i;const a=this,o=[],l=a.isLeaf,{children:c,stores:d}=a;if(e=(e=ge.asArray(e)).filter((e=>e.parent===a)),!n)for(const n of d)if(!n.isChained&&!1===n.trigger("beforeRemove",{parent:a,records:e,isMove:t}))return!1;const u=null===(s=a.beforeRemoveChild)||void 0===s?void 0:s.call(a,e,t);for(const s of e){const{parentIdField:e}=s.constructor,{modified:i}=s.meta,l=s.parent?s.parent.id:null;e in i||s.isLinked||(i[e]=l);const c=a.removeFromChildren(s,r);d.forEach((e=>{if(!e.isChained){const{isRemoving:r}=e;e.isRemoving=!0,o.push(...e.onNodeRemoveChild(a,[s],c,{isMove:t,silent:n})),e.isRemoving=r}})),t||(s.parent=s.parentIndex=s.unfilteredIndex=s.nextSibling=s.previousSibling=null,s.data[e]=null)}return 0===(a.unfilteredChildren||c).length&&a.constructor.convertEmptyParentToLeaf.onRemove&&!a.isRoot&&(a.meta.isLeaf=!0),a.isLeaf===l||n||t||a.signalNodeChanged({isLeaf:{value:!0,oldValue:!1}}),null===(i=a.afterRemoveChild)||void 0===i||i.call(a,e,u,t),o}clearParentId(){const e=this;Reflect.deleteProperty(e.data,e.parentIdField),Reflect.deleteProperty(e.originalData,e.parentIdField),e.meta.modified&&Reflect.deleteProperty(e.meta.modified,e.parentIdField)}replaceChildren(e){return this.clearChildren(),this.data[this.constructor.childrenField]=e,this.processChildren(),this.children}clearChildren(e=!1){const t=this,{stores:n}=t,r=t.unfilteredChildren||t.children;t.children=[],t.orderedChildren=[],r&&!0!==r&&(n.forEach((n=>{n.isChained||n.onNodeRemoveChild(t,r,0,{unfiltered:!0,silent:e})})),t.unfilteredChildren&&(t.unfilteredChildren=[]))}clear(){var e;const t=this,{stores:n}=t,r=null===(e=t.children)||void 0===e?void 0:e.slice();if(t.isRoot&&r){for(const e of n)if(!e.isChained&&!1===e.trigger("beforeRemove",{parent:t,records:r,isMove:!1,removingAll:!0}))return!1;t.children.length=0,t.unfilteredChildren&&(t.unfilteredChildren.length=0),n.forEach((e=>{r.forEach((t=>{t.stores.includes(e)&&t.unjoinStore(e),t.parent=t.parentIndex=t.nextSibling=t.previousSibling=null})),e.storage.suspendEvents(),e.storage.clear(),e.storage.resumeEvents(),e.added.clear(),e.modified.clear(),e.trigger("removeAll"),e.trigger("change",{action:"removeall"})}))}}updateChildrenIndices(e,t,n=!1){let r=null;for(let s=0;s<e.length;s++){const i=e[s],a=i[t];"parentIndex"===t||"orderedParentIndex"===t?void 0===a||n?i.setData(t,s):a!==s&&i.set(t,s,!0):i[t]=s,"parentIndex"===t&&(i.previousSibling=r,r&&(r.nextSibling=i),s===e.length-1&&(i.nextSibling=null),r=i)}}addToChildren(e,t,n={}){const r=this,s=[[r.children,"parentIndex",e],[r.unfilteredChildren,"unfilteredIndex",e],[r.orderedChildren,"orderedParentIndex",void 0===(null==n?void 0:n.orderedBeforeNode)?void 0!==(null==n?void 0:n.orderedParentIndex)?r.orderedChildren[null==n?void 0:n.orderedParentIndex]:e:null==n?void 0:n.orderedBeforeNode]];for(const e of s){const[s,a,o]=e;if(s){var i;const l=o?"orderedParentIndex"===a?s.indexOf(o):o[a]:s.length;e.push(l),s.splice(l,0,...t),null!=n&&null!==(i=n[a])&&void 0!==i&&i.skip||r.updateChildrenIndices(s,a)}}return s[0][3]}removeFromChildren(e,t){const n=[[this.children,"parentIndex"],[this.unfilteredChildren,"unfilteredIndex"],[this.orderedChildren,"orderedParentIndex"]];for(const s of n){const[n,i]=s;if(n){const a=n.indexOf(e);var r;if(s.push(a),a>-1)n.splice(a,1),null!=t&&null!==(r=t[i])&&void 0!==r&&r.skip||this.updateChildrenIndices(n,i)}}return n[0][2]}sortOrderedChildren(e=!0,t=!1){const n=[];return this.isLeaf||(this.orderedChildren.sort(((e,r)=>{if(t){const t=(e.meta.modified.orderedParentIndex??e.orderedParentIndex)-(r.meta.modified.orderedParentIndex??r.orderedParentIndex);return 0!==t&&(n.push(e),n.push(r)),t}return e.orderedParentIndex-r.orderedParentIndex})),e&&this.orderedChildren.forEach((r=>{n.push(...r.sortOrderedChildren(e,t))})),this.updateChildrenIndices(this.orderedChildren,"orderedParentIndex",!0)),new Set(n)}sortVisibleChildren(e=!0,t){const n=this;n.isLeaf||(n.children.sort(t),e&&n.orderedChildren.forEach((n=>n.sortVisibleChildren(e,t))),n.updateChildrenIndices(n.children,"parentIndex",!0))}sortUnfilteredChildren(e=!0,t){const n=this;!n.isLeaf&&n.unfilteredChildren&&(n.unfilteredChildren.sort(t),e&&n.orderedChildren.forEach((n=>n.sortUnfilteredChildren(e,t))),n.updateChildrenIndices(n.unfilteredChildren,"unfilteredIndex",!0))}unjoinStore(e,t=!1){var n;const r=this;r.unfilteredChildren&&(r.children=r.unfilteredChildren.slice(),r.unfilteredChildren=null),null===(n=super.unjoinStore)||void 0===n||n.call(this,e,t)}};const ds={id:1,stores:1,parentIndex:1,parent:1,previousSibling:1,nextSibling:1,unfilteredIndex:1},us={get(e,t){return"proxyMeta"===t?this.proxyMeta:"constructor"===t?e.constructor:"setData"===t?this.setDataOverride:"set"===t?this.setOverride:ds[t]?this.proxyMeta.data[t]:Reflect.get(e,t,this.proxyRecord)},set(e,t,n){return ds[t]?this.proxyMeta.data[t]=n:e[t]=n,!0},setDataOverride(e,t){"parentIndex"===e?this.proxyMeta.data.parentIndex=t:this.proxyMeta.originalRecord.setData(e,t)},setOverride(e,t,...n){"parentIndex"===e?this.proxyMeta.data.parentIndex=t:this.proxyMeta.originalRecord.set(e,t,...n)}};var hs=e=>class extends(e||ue){static $name="ModelLink";static isModel=!0;link(){if(this.isLinked)return this.$original.link();const e=this,t={...us,proxyMeta:{originalRecord:e,data:{id:`${e.id}_link_${T.generateUUID()}`,stores:[]}}},n=new Proxy(e,t);return t.proxyRecord=n,(e.meta.linkedRecords||(e.meta.linkedRecords=[])).push(n),n}get isLinked(){var e;return Boolean(null===(e=this.proxyMeta)||void 0===e?void 0:e.originalRecord)}get hasLinks(){return Boolean(!this.proxyMeta&&this.$links.length)}removeLink(e,t=null,n=!1){if(e.hasLinks)for(const r of e.$links.slice())t?ge.include(t,r):r.remove(n);else e.isLinked&&ge.remove(e.$original.$links,e)}beforeRemove(e){this.removeLink(this,e)}removeChild(e,t,n,r){if(null==r||!r.isInserting){e=ge.asArray(e);for(const t of e)this.removeLink(t,null,n)}return super.removeChild(e,t,n,r)}get $originalId(){return this.$original.id}get $links(){return this.meta.linkedRecords??[]}};const{defineProperty:gs}=Reflect,ms=Symbol("owner"),ps=/[\s,]+/;var fs=e=>class extends(e||ue){static get $name(){return"Factoryable"}static get declarable(){return["factoryable","alias","type"]}static register(e,t,n=globalThis.__BRYNTUM_EXAMPLE){const{factoryable:r}=this.initClass(),{caseless:s,registry:i}=r,a=T.split(e,ps);for(let e,o,l=0;l<a.length;++l){if(o=a[l],e=s?o.toLowerCase():o,!n&&e in i)throw new Error(`Type "${o}" already registered with ${r.class.name} factory`);i[o]=i[e]=t.initClass()}}static isA(e,t){return this.isType(e,t,!0)}static isType(e,t,n){const{factoryable:r}=this,{caseless:s,registry:i}=r,a=i[s?t.toLowerCase():t];return!!a&&(n?e instanceof a:e.constructor===a)}static setupAlias(e){e.register(e.alias,e)}static setupFactoryable(e,t){const n=t.super.class;let{factoryable:r}=e;r={caseless:!0,defaultType:null,extends:n.factoryable?[n]:null,typeKey:"type",...r},r.class=e,r.registry=Object.create(null),r.extends&&!Array.isArray(r.extends)&&(r.extends=[r.extends]),gs(e,"factoryable",{get:()=>r})}static setupType(e,t){const{type:n}=e;e.register(n,e,t.replaceType),gs(e.prototype,"type",{value:n})}static create(e,t){return this.reconfigure(null,e,t)}static reconfigure(e,t,n){const r=this,{factoryable:s}=r,{typeKey:i}=s;let a,o,l,c,d,u,h,g,m,p=n;if(n&&!Ut.isClass(n)&&(p=null,h=typeof n,"function"===h?u=n:"string"===h?p=n:Ut.isObject(n)?(a=n.cleanup,o=n.defaults,c=n.owner,u=n.setup,p=n.type,g=n.transform):c=n),g&&(t="string"==typeof g?c[g](t):g(t)),m=t,"string"==typeof m)t={};else if(t){if(!0===t&&(t={}),!Ut.isObject(t)){var f;if(c&&t!==e&&(null==e?void 0:e[ms])===c)"string"==typeof a?c[a](e):null===(f=a)||void 0===f||f(e),e.destroy();return t}m=t[i]}if(m=m&&r.resolveType(m),e){if(t&&(!m||e.constructor===m))return i in t&&delete(t=Ut.assign({},t))[i],e.setConfig(t),e;var v;if(c&&e[ms]===c)"string"==typeof a?c[a](e):null===(v=a)||void 0===v||v(e),e.destroy()}if(t){if(o){if(!(l=m)){if(!(l=o[i]||p||s.defaultType))throw new Error(`No default mergeType defined for ${s.class.name} factory`);l=r.resolveType(l)}l&&(t=l.mergeConfigs(o,t))}if(u){if(d="string"==typeof u?c[u](t,m,o):u(t,m,o),null===d)return d;t=d||t}if(!m){if(!(m=t[i]||p||s.defaultType))throw new Error(`No default type defined for ${s.class.name} factory`);m=r.resolveType(m)}o&&!l&&(t=m.mergeConfigs(o,t)),i in t&&delete(t=Ut.assign({},t))[i],t=new m(t),c&&(t[ms]=c)}return t||null}static resolveType(e,t){if("string"!=typeof e)return e;const{factoryable:n}=this,r=n.extends;let s,i=n.registry[n.caseless?e.toLowerCase():e];for(s=0;!i&&r&&s<r.length;++s)i=r[s].resolveType(e,!0);if(!i&&!t)throw new Error(`Invalid type name "${e}" passed to ${n.class.name} factory`);return i}};const{getOwnPropertyDescriptor:vs}=Reflect;class ys extends(ue.mixin(fs)){static get $name(){return"DataField"}static get type(){return"auto"}static get factoryable(){return{defaultType:"auto"}}static get prototypeProperties(){return{compare:null,compareItems:null,dataSource:null,alwaysWrite:!1,nullable:!0,nullText:null,nullValue:void 0,persist:!0,readOnly:!1,internal:!1,useProp:null}}construct(e){const t=this;e&&(t.name=e.name,Object.assign(t,e)),t.compare&&(t.compareItems=(e,n)=>t.compare(null==e?void 0:e[t.name],null==n?void 0:n[t.name]))}defineAccessor(e,t){const{name:n,dataSource:r}=this;!t&&n in e&&e.$meta.hierarchy.some((e=>{var t;return!1===(null===(t=vs(e.prototype,n))||void 0===t?void 0:t.enumerable)}))||Reflect.defineProperty(e,n,{configurable:!0,enumerable:!0,get:this.complexMapping?function(){return this.complexGet(n,r)}:function(){return this.batching&&n in this.meta.batchChanges?this.meta.batchChanges[n]:r in this.data?this.data[r]:this.data[n]},set(e){const t=this.$meta.fields.map[n];t&&t.readOnly||this.set(n,e)}})}isEqual(e,t){return Ut.isEqual(e,t)}print(e){return null==e?this.nullText:this.printValue(e)}printValue(e){return String(e)}}ys._$name="DataField";class bs extends ys{static $name="ArrayDataField";static type="array";isEqual(e,t){return e===t}getAt(e,t){return e.get(this.name)[t]}}bs.initClass(),bs._$name="ArrayDataField";class Cs extends ys{static $name="BooleanDataField";static type="boolean";static alias="bool";static get prototypeProperties(){return{nullValue:!1}}isEqual(e,t){return null==e&&null==t||super.isEqual(e,t)}convert(e){var t;return null==e?this.nullable?e:this.nullValue:"false"!==(null===(t=e.toLowerCase)||void 0===t?void 0:t.call(e))&&Boolean(e)}}Cs.initClass(),Cs._$name="BooleanDataField";class Ss extends ys{static get $name(){return"DateDataField"}static get type(){return"date"}static get prototypeProperties(){return{format:null}}convert(e){return null==e?this.nullable||(e=this.nullValue):"now"===e?e=new Date:e instanceof Date||(e=Bt.parse(e,this.format||Bt.defaultParseFormat))&&!isNaN(e)||(e=void 0),e}serialize(e){return e instanceof Date&&(e=Bt.format(e,this.format||Bt.defaultFormat)),e}printValue(e){return Bt.format(e,this.format||Bt.defaultFormat)}}Ss.initClass(),Ss._$name="DateDataField";class ws extends ys{static get $name(){return"StringDataField"}static get type(){return"string"}static get prototypeProperties(){return{nullValue:""}}convert(e){return null==e?this.nullable?e:this.nullValue:String(e)}}ws.initClass(),ws._$name="StringDataField";class Ds extends ws{static get $name(){return"DurationUnitDataField"}static get type(){return"durationunit"}isEqual(e,t){return 0===Bt.compareUnits(e,t)}}Ds.initClass(),Ds._$name="DurationUnitDataField";class Ts extends ys{static $name="IntegerDataField";static type="integer";static alias="int";static get prototypeProperties(){return{nullValue:0,rounding:"round"}}convert(e){return null==e?this.nullable?e:this.nullValue:Math[this.rounding](Number(e))}}Ts.initClass(),Ts._$name="IntegerDataField";class Es extends ys{static get $name(){return"ModelDataField"}static get type(){return"model"}static configurable={modelClass:null};static get prototypeProperties(){return{complexMapping:!0}}isEqual(e,t){return e&&t&&t instanceof e.constructor&&t.id==e.id}}Es.initClass(),Es._$name="ModelDataField";class xs extends ys{static $name="NumberDataField";static type="number";static alias="float";static get prototypeProperties(){return{nullValue:0,precision:null}}isEqual(e,t){return isNaN(Number(e))&&isNaN(Number(t))||super.isEqual(e,t)}convert(e){if(null==e)return this.nullable?e:this.nullValue;if(e=Number(e),isNaN(e))return;let t=this.precision;return t?(t=10**t,e=Math.round(e*t)/t):0===t&&(e=Math.round(e)),e}}xs.initClass(),xs._$name="NumberDataField";class ks extends ys{static get $name(){return"ObjectDataField"}static get type(){return"object"}static get prototypeProperties(){return{complexMapping:!0}}}ks.initClass(),ks._$name="ObjectDataField";class Is extends ys{static $name="StoreDataField";static type="store";init(e,t){var n;const r=this,s=`${r.name}Store`,i={skipStack:!0,syncDataOnLoad:!0};if(r.store&&Ut.assign(i,r.store),r.modelClass&&(i.modelClass=r.modelClass),null===(n=t[`init${T.capitalize(s)}`])||void 0===n||n.call(t,i),!i.storeClass&&!r.storeClass)throw new Error(`Field '${r.name}' with type 'store' must have a storeClass configured`);const a=t.meta[s]=new(i.storeClass||r.storeClass)(i);r.complexMapping?Ut.setPath(e,r.dataSource,a):e[r.dataSource]=a,a.verifyNoGeneratedIds=!1,a.usesId=!a.count||!a.every((e=>e.hasGeneratedId)),a.$currentValue=r.getValue(a),a.ion({change:({action:e})=>{const n=r.getValue(a);if(!a.$isSettingStoreFieldData){const s=a.$preserveCurrentDataset;a.$preserveCurrentDataset=r.subStore&&("update"===e||"remove"===e||"add"===e),r.$isUpdatingRecord=!0,t.set(r.name,n),r.$isUpdatingRecord=!1,a.$preserveCurrentDataset=s}a.$currentValue=n}})}set(e,t,n){var r;const s=this,i=`${s.name}Store`,{[i]:a}=n.meta;if(!a)return n.meta.initableValues.set(s,e),!1;a.$isSettingStoreFieldData||(a.$isSettingStoreFieldData=!0,e=(null===(r=n[`process${T.capitalize(i)}Data`])||void 0===r?void 0:r.call(n,e,n))??e,a.$preserveCurrentDataset||(a.data=e),a.$isSettingStoreFieldData=!1,a.usesId=!a.count||!a.every((e=>e.hasGeneratedId)))}serialize(e,t){const n=t.meta[`${this.name}Store`];return this.$isUpdatingRecord?this.getValue(n):n.$currentValue}getValue(e){return e.allRecords.map((t=>{const n=t.persistableData;return e.usesId||delete n.id,n}))}isEqual(e,t){if(null==e&&null==t)return!0;if(null==e&&null!=t||null!=e&&null==t)return!1;if(e.isStore&&t.isStore)return Ut.isDeeplyEqual(e.$currentValue,t.$currentValue);if(e.isStore&&t.isStore||!e.isStore&&!t.isStore)return Ut.isEqual(e,t,!0);{const r=(e.isStore?e:t).modelClass,s=r.$meta.fields.defs,i=e.isStore?e.$currentValue:t.$currentValue,a=e.isStore?t:e;if(i.length!==a.length)return!1;for(let e=0;e<s.length;e++){const t=s[e];if(t.persist)for(let e=0;e<i.length;e++){const s=i[e][t.dataSource],o=a[e][t.dataSource];if(void 0!==s&&void 0===o){if(t.dataSource===r.idField&&("string"==typeof(n=s)&&n.startsWith("_generated")))continue;if(void 0!==t.defaultValue&&Ut.isEqual(t.defaultValue,s,!0))continue}if(!Ut.isEqual(s,o,!0))return!1}}return!0}var n}getOldValue(e){const t=e.meta[`${this.name}Store`];return t?Ut.clone(t.$currentValue):null}getAt(e,t){const n=e.meta[`${this.name}Store`];return null==n?void 0:n.getAt(t)}}Is.initClass(),Is._$name="StoreDataField";const Rs=new RegExp(/^(.*?)\.(.*)/),Ms=/(.*)\[(.*)]\.?(.*)/,{defineProperty:Os}=Reflect,{hasOwn:As}=Ut,Fs=void 0,Ps={children:1,data:1,meta:1},Ls=["name","title","text","label","description"],$s={boolean:1,number:1,date:1,object:1},_s={parentId:1,$PhantomId:2,id:3};class Ns extends(ue.mixin(as,cs,hs)){static get $name(){return"Model"}static get declarable(){return["fields"]}static get fields(){return[{name:"parentIndex",type:"number",persist:!1,internal:!0},{name:"orderedParentIndex",type:"number",persist:!1,internal:!0},{name:"readOnly",type:"boolean"},{name:"expanded",internal:!0},{name:"groupParent",persist:!1,internal:!0}]}static relations=null;static set idField(e){this._assignedIdField=!0,this._idField=e}static get idField(){return this._idField}static set childrenField(e){this._childrenField=e}static get childrenField(){if(!this._childrenField){const e=this.fieldMap.children;this._childrenField=(null==e?void 0:e.dataSource)||"children"}return this._childrenField}get indexPath(){const e=[];let t=this,n=t.childLevel;for(t=this;t&&!t.isRoot;t=t.parent)e[n--]=t.parentIndex+1;return e}construct(e={},t=null,n=null,r=!1,s=!1,i=!1){var a;const o=this,l=ge.asArray(t)??[],{constructor:c,fieldMap:d}=o;let u=null;if(t=l[0],o.meta={modified:{},...c.metaConfig,...n},c.applyConfigs){u={},o.useRawData&&o.useRawData.enabled||(e={...e});const t=o.getDefaultConfiguration();if(c.autoExposeFields)for(const n in t)n in e&&(void 0!==e[n]&&(u[n]=e[n]),delete e[n]);else for(const n in e)n in c.fieldMap||(void 0===e[n]?u[n]=t[n]:u[n]=e[n],delete e[n])}if(super.construct(u),r||c.exposeProperties(e,i),!As(c,"idFieldProcessed")){let e=o.meta.idField;e||(c._assignedIdField?e=c.idField:t&&(e=t.idField)),e&&e!==d.id.dataSource&&c.addField({name:"id",dataSource:e,internal:!0}),c._idField=d.id.dataSource,c.idFieldProcessed=!0}o._internalId=Ns._internalIdCounter++,o.stores=[],o.unjoinedStores=[],o.originalData||(o.originalData=e),o.data=c.processData(e,!1,t,o,s),(null===(a=o.meta.initableValues)||void 0===a?void 0:a.size)&&o.assignInitables(),null==o.id&&o.setData("id",o.generateId(t)),o.data[c.childrenField]&&o.processChildren(l),o.generation=0}set isCreating(e){const t=this;Boolean(t.meta.isCreating)!==e&&(t.meta.isCreating=e,t.stores.forEach((n=>{n.onIsCreatingToggle(t,e)})))}get isCreating(){return Boolean(this.meta.isCreating)}equals(e){if(e instanceof this.constructor){for(let t=this.$meta.fields.defs,n=0,{length:r}=t;n<r;n++){const r=t[n],{name:s}=r;if("id"!==s&&!r.isEqual(this.getValue(s),e.getValue(s)))return!1}return!0}return!1}get subclass(){return new this.constructor(Object.setPrototypeOf({id:Fs},this.data),this.stores[0],null,!0)}static processData(e,t=!1,n,r,s){const{fieldMap:i,fieldDataSourceMap:a,defaultValues:o}=this,{useRawData:l={enabled:!1}}=n||{},c=s||l.enabled?e:Ut.clone(e);let d;if(!(t=t||l.disableDefaultValue||s))for(d in o){const e=a[d];let t=o[d];Array.isArray(t)&&(t=t.slice()),null!=e&&e.complexMapping?Ut.getPath(c,d)===Fs&&Ut.setPath(c,d,t):c[d]===Fs&&(c[d]=t)}if(!l.disableTypeConversion&&!s)for(d in i){const n=i[d],{name:s,dataSource:a}=n,o=a!==s,u=n.complexMapping,h=o&&(u?Ut.pathExists(e,a):a in e),g=s in e&&(!o||!h),m=!l.disableTypeConversion&&n.convert;if((g||m)&&(!t||g||h)){const t=g?c[s]:u?Ut.getPath(c,a):c[a],i=m?n.convert(t,e,r):t;u?Ut.setPath(c,a,i):c[a]=i,o&&delete c[s]}}return this.$meta.fields.initable.length&&this.initInitables(r,c),c}static setupClass(e){super.setupClass(e),e.fields||this.setupFields(this,e)}static setupFields(e,t){const n=As(e,"fields")&&e.fields,r=t.super.fields,s=t.fields={defs:(null==r?void 0:r.defs.slice())??[],exposedData:!1,defaults:r?{...r.defaults}:{},exposed:Object.create((null==r?void 0:r.exposed)??null),ordinals:Object.create((null==r?void 0:r.ordinals)??null),map:Object.create((null==r?void 0:r.map)??null),sources:Object.create((null==r?void 0:r.sources)??null)};As(e,"defaults")&&Object.assign(s.defaults,e.defaults),As(e,"idField")&&(e.addField({name:"id",dataSource:e.idField,internal:!0}),s.exposed[e.idField]=!0),null!=n&&n.length&&n.map(e.addField,e),s.initable=s.defs.filter((e=>e.init)),e.exposeRelations()}static get defaultValues(){return this.$meta.fields.defaults}static get allFields(){return this.$meta.fields.defs}get allFields(){return this.$meta.fields.defs}static get fieldMap(){return this.$meta.fields.map}get fieldMap(){return this.$meta.fields.map}static get fieldDataSourceMap(){return this.$meta.fields.sources}static exposeProperties(e,t=!0){const n=this,r=n.$meta.fields,s=t?"exposed":"map";if(e&&n.autoExposeFields&&!r.exposedData){let t,i,a;for(t in e)r[s][t]||t===n.childrenField||(a=Ut.typeOf(e[t]),i={name:t,dataSource:t,fromData:!0},$s[a]&&(i.type=a),n.addField(i));r.exposedData=!0}n.exposeRelations()}static addField(e){if(null==e)return;"string"==typeof e&&(e={name:e});const t=this.initClass(),n=t.$meta.fields,{ordinals:r}=n,s=n.exposed,{name:i}=e,a=n.map[i],o=e.dataSource||(e.dataSource=i);let l,c;if(!a||e.type&&e.type!==a.type)l=ys.create(e),l.definedBy=a?a.definedBy:t,l.ordinal=a?a.ordinal:r[i]=n.defs.length;else for(c in l=Object.create(a),e)"type"!==c&&(l[c]=e[c]);return l.owner=t,n.defs[l.ordinal]=l,n.map[i]=l,n.sources[o]||(n.sources[o]=l),o.includes(".")&&(l.complexMapping=!0),l.complexMapping?s[o.split(".")[0]]=!0:s[o]=!0,"defaultValue"in l&&(n.defaults[o]=l.defaultValue),Ps[i]||l.defineAccessor(t.prototype),t._nonPersistableFields=null,t._alwaysWriteFields=null,l}static removeField(e){const t=this.initClass(),n=t.$meta.fields,r=n.map[e],{ordinals:s}=n,i=s[e];if(r){n.defs.splice(i,1),delete s[e],delete n.defaults[e],delete n.exposed[e],delete n.map[e],delete n.sources[r.dataSource];for(const e in s)s[e]>i&&--s[e];delete t.prototype[e]}}static exposeRelations(){const e=this;if(!As(e,"exposedRelations")&&e.relations){e.exposedRelations=[];for(const t in e.relations){const n=e.relations[t];n.relationName=t,e.exposedRelations.push(n),Reflect.ownKeys(e.prototype).includes(t)||Os(e.prototype,t,{enumerable:!0,get:function(){return this.getForeign(t)},set:function(e){this.setForeign(t,e,n)}})}}}static initInitables(e,t){const n=e.meta.initableValues=new Map;for(const r of this.$meta.fields.initable){const s=Ut.getPath(t,r.dataSource);void 0!==s&&n.set(r,s),!r.lazy&&r.init(t,e)}}assignInitables(){const{initableValues:e}=this.meta;for(const[t,n]of e)!1!==t.set(n,this.data,this)&&e.delete(t)}static get autoExposeFields(){return!0}static fieldSorter(e,t){return(_s[e]||100)-(_s[t]||100)}get fields(){return this.$meta.fields.defs}getFieldDefinition(e){return this.constructor.getFieldDefinition(e)}getFieldDefinitionFromDataSource(e){return this.$meta.fields.sources[e]}get fieldNames(){return Object.keys(this.data)}static getFieldDefinition(e){const t=this.fieldMap[e];if(!t)if(e.includes("[")){const[,t,,r]=e.match(Ms),s=t.includes(".")?this.getFieldDefinition(t):this.fieldMap[t];var n;if(null!=s&&s.isStoreDataField)return null===(n=s.modelClass)||void 0===n?void 0:n.getFieldDefinition(r)}else if(e.includes(".")){const[t,n]=e.split(".",2),s=this.fieldMap[t];var r;if(s.isModelDataField&&s.modelClass)return null===(r=s.modelClass)||void 0===r?void 0:r.getFieldDefinition(n)}return t}static getFieldDataSource(e){var t;return(null===(t=this.getFieldDefinition(e))||void 0===t?void 0:t.dataSource)||e}getDataSource(e){const t=this.constructor.getFieldDefinition(e);return(null==t?void 0:t.dataSource)||(null==t?void 0:t.name)}static processField(e,t,n){const r=this.fieldMap[e];return null!=r&&r.convert?r.convert(t,this.data,n):t}initRelations(){const e=this;e.constructor.exposedRelations&&e.stores.forEach((t=>{var n;t.modelRelations||t.initRelations();const r=[];null===(n=t.modelRelations)||void 0===n||n.forEach((t=>{r.push({related:e.initRelation(t),config:t})})),t.updateRecordRelationCache(e,r)}))}initRelation(e){const t=this,n=t.get(e.foreignKey),r=n!==Fs&&"string"!=typeof e.foreignStore&&e.foreignStore.getById(n);return(t.meta.relationCache||(t.meta.relationCache={}))[e.relationName]=r||(null!=n?{id:n,placeHolder:!0}:null),r}removeRelation(e){const{relationName:t,foreignKey:n,nullFieldOnRemove:r}=e;this.meta.relationCache[t]&&(delete this.meta.relationCache[t],r&&this.setData(n,null))}getForeign(e){var t;return null===(t=this.meta.relationCache)||void 0===t?void 0:t[e]}setForeign(e,t,n){const r=Ns.asId(t);return this.set(n.foreignKey,r)}getRelationConfig(e){var t,n;return null===(t=this.firstStore)||void 0===t||null===(n=t.modelRelations)||void 0===n?void 0:n.find((t=>t.foreignKey===e))}flatGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:t in this.data?this.data[t]:this.data[e]}complexGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:Ut.getPath(this.data,t)}get(e){if(!e)return;const t=this,n=t.fieldMap[e];if(!n){if(e.includes("[")){const[,n,r,s]=e.match(Ms),i=t.fieldMap[n];if(null!=i&&i.getAt){t._thisIsAUsedExpression(t[n]);const e=i.getAt(t,r);return e&&s?e.isModel?e.getValue(s):e[s]:e}return null}if(e.includes("."))return Ut.hasPath(t.data,e)?t.complexGet(e,e):Ut.getPath(t,e)}return null!=n&&n.complexMapping?t.complexGet(e,n.dataSource):t.flatGet(e,(null==n?void 0:n.dataSource)||e)}getValue(e){if(e)return e in this?this[e]:this.get(e)}setValue(e,t){e in this?this[e]=t:this.set(e,t)}setData(e,t){const{data:n,fieldMap:r}=this;if("string"==typeof e){const s=r[e],i=(null==s?void 0:s.dataSource)??e;null!=s&&s.set?s.set(t,this.data,this):null!=s&&s.complexMapping?Ut.setPath(n,i,t):n[i]=t}else{const s=Object.keys(e);for(let i=0;i<s.length;i++){const a=s[i],o=r[a],l=(null==o?void 0:o.dataSource)??a;null!=o&&o.set?o.set(t,this.data,this):l&&(null!=o&&o.complexMapping?Ut.setPath(n,l,e[a]):n[l]=e[a])}}}getData(e){const t=this.fieldMap[e],n=(null==t?void 0:t.dataSource)??e;if(n)return null!=t&&t.complexMapping?Ut.getPath(this.data,n):this.data[n]}syncId(e){const t=this.id;if(t!==e){this.setData("id",e);const n={id:{value:e,oldValue:t}};this.afterChange(n,n)}}set(e,t,n=!1,r=!1,s=!1,i=!1,a=!0){const o=this;if(o.isBatchUpdating)return o.inBatchSet(e,t,n||o.$silenceBatch),null;{var l;const c=o.inSet(e,t,n,r,s,i,a);return null===(l=o.afterSet)||void 0===l||l.call(o,e,t,n,r,c),c}}fieldToKeys(e,t){return"string"!=typeof e?Ut.assign({},e):{[e]:t}}inBatchSet(e,t,n){const r=this,{meta:s,constructor:i,fieldMap:a}=r,o={};let l,c=!1;if("string"!=typeof e?Object.keys(r.fieldToKeys(e,t)).forEach((n=>{l=a[n]||Ut,t=i.processField(n,e[n],r),l.isEqual(s.batchChanges[n],t)||(o[n]={value:t,oldValue:r.get(n)},s.batchChanges[n]=t,c=!0)})):(l=a[e]||Ut,l.isEqual(s.batchChanges[e],t)||(o[e]={value:t,oldValue:r.get(e)},s.batchChanges[e]=t,c=!0)),c&&(r.generation++,!n)){const e={action:"update",record:r,records:[r],changes:o};r.stores.forEach((t=>{t.trigger("batchedUpdate",{...e})})),r.forEachLinked(((t,n)=>t.trigger("batchedUpdate",{...e,record:n,records:[n]})))}}inSet(e,t,n,r,s=!1,i=!1,a=!0){const o=this,{data:l,meta:c,fieldMap:d,constructor:u}=o,{prototype:h,childrenField:g,relations:m}=u,p={},f=o.fieldToKeys(e,t),v=Object.keys(f).sort(u.fieldSorter);let y=!1;if(!n&&a&&!o.triggerBeforeUpdate(f))return null;o.inSetting=!0;for(let e=0;e<v.length;e++){const t=v[e];if(t===g)continue;if(t.includes("[")){const[,e,n,r]=t.match(Ms),s=o.fieldMap[e];if(null!=s&&s.getAt){const e=s.getAt(o,n);e.isModel?e.set(r,f[t]):Ut.setPath(e,r,f[t]);continue}}const n=t.includes(".");if(m&&n){const[,e,n]=t.match(Rs);if(m[e]){o[e].set(n,f[t]);continue}}const a=d[t],C=a||Ut,S=null==a?void 0:a.readOnly,w=(null==a?void 0:a.dataSource)??t,D=!s&&!a&&t in h||(null==a?void 0:a.useProp),T=D?o[w]:null!=a&&a.complexMapping||n?Ut.getPath(l,w):l[w],E=u.processField(t,f[t],o),x=f[t]={value:E},k=o.getRelationConfig(t),I=(e,t)=>C.isEqual(e,t)||null==e&&null==t;var b;if(!(S||I(T,E)||i&&void 0===E))o.generation++,x.oldValue=(null==a||null===(b=a.getOldValue)||void 0===b?void 0:b.call(a,o))??T,y=!0,t in c.modified&&I(c.modified[t],E)?(Reflect.deleteProperty(c.modified,t),o.isReverting&&(o.data[w]=E)):o.ignoreBag||(t in c.modified||o.storeFieldChange(t,T),x.oldValue===Fs&&Reflect.deleteProperty(x,"oldValue")),p[t]=x,o.applyValue(D,w,E,s,a),k&&!r&&(o.initRelation(k),o.stores.forEach((e=>e.cacheRelatedRecord(o,E,k.relationName,x.oldValue))))}return y&&o.afterChange(f,p,n,r,s),o.inSetting=!1,y?p:null}applyValue(e,t,n,r,s){var i,a,o;const l=this;var c;if(((null===(i=s)||void 0===i?void 0:i.dataSource)||t)===l.constructor.idField&&(l.$isPhantom=!1),((null===(a=s)||void 0===a?void 0:a.dataSource)||t)===l.constructor.parentIdField)(null===(c=l.parent)||void 0===c||!c.isRoot||null!=n&&l.firstStore.getById(n))&&(l.firstStore.getById(n)||l.firstStore.rootNode).insertChild(l,null,!1,{orderedParentIndex:{skip:!0}});else if(e){var d;l[(null===(d=s)||void 0===d?void 0:d.name)||t]=n}else if(null!==(o=s)&&void 0!==o&&o.set)s.set(n,l.data,l);else{var u;let e=null===(u=s)||void 0===u?void 0:u.complexMapping;if(!s&&t.includes(".")){var h,g;const n=t.split(".")[0];e=(null===(h=s=l.constructor.fieldMap[n])||void 0===h?void 0:h.complexMapping)||"object"===(null===(g=s)||void 0===g?void 0:g.type)}e?Ut.setPath(l.data,t,n):l.data[t]=n}}afterChange(e,t,n,r,s){for(const i of this.stores)i.onModelChange(this,e,t,n,r,s);this.forEachLinked(((i,a)=>i.onModelChange(a,e,t,n,r,s)))}forEachLinked(e){for(const t of this.$links)for(const n of t.stores)e(n,t)}get isPersistable(){return!this.isBatchUpdating&&!this.isCreating}get isModified(){return Boolean(this.meta.modified&&Object.keys(this.meta.modified).length>0)}get hasPersistableChanges(){return this.isPersistable&&!Ut.isEmpty(this.rawModificationData)}isFieldModified(e){return this.isModified&&e in this.meta.modified}getFieldPersistentValue(e){const t="string"==typeof e?this.getFieldDefinition(e):e,n=(null==t?void 0:t.name)||e;let r;return t&&!t.persist||(r=this.getValue(n),null!=t&&t.serialize&&(r=t.serialize(r,this))),r}get modifications(){const e=this.rawModifications;return e&&Object.keys(e).length&&(e[this.constructor.idField]=this.id),e}get rawModifications(){const e=this,t={};if(!e.isModified)return null;let n=!1;return Object.keys(e.meta.modified).forEach((r=>{const s=e.getFieldPersistentValue(r);s!==Fs&&(t[r]=s,n=!0)})),n?t:null}get modificationData(){const e=this.rawModificationData;return e&&Object.keys(e).length&&Ut.setPath(e,this.constructor.idField,this.id),e}get rawModificationData(){const e=this,{fieldMap:t}=e.constructor,n={};if(!e.isModified)return null;let r=!1;return Object.keys(e.meta.modified).forEach((s=>{var i,a;let o=t[s],l=null===(i=o)||void 0===i?void 0:i.dataSource;if(s.includes(".")){const e=s.match(Rs)[1];o=t[e],l=s}if(null!==(a=o)&&void 0!==a&&a.persist){const t=e.getFieldPersistentValue(s);t!==Fs&&(Ut.setPath(n,l,t),r=!0)}})),r?n:null}get modificationDataToWrite(){const e=this.constructor.alwaysWriteFields,t=this.modificationData;return e.forEach((e=>{t[this.getFieldDefinition(e).dataSource]=this.getFieldPersistentValue(e)})),t}get persistableData(){const e=this,t={};return e.fields.forEach((n=>{const r=e.getFieldPersistentValue(n);r!==Fs&&(null!=n&&n.complexMapping?Ut.setPath(t,n.dataSource,r):t[n.dataSource]=r)})),t}get dataByFieldName(){const{data:e}=this;return this.fields.reduce(((t,n)=>(Ut.hasPath(e,n.dataSource)&&(t[n.name]=e[n.dataSource]),t)),{})}get isCommitting(){return Boolean(this.meta.committing)}clearChanges(e=!0,t=!0,n=null){const r=this,{meta:s}=r;if(n)for(const e in n)delete s.modified[e];else s.modified={};const i=Ut.isEmpty(s.modified);s.committing=!1,t&&r.stores.forEach((t=>{if(i&&t.modified.remove(r),t.added.remove(r),e){const e=t.collectDescendants(r).all;t.added.remove(e),i&&t.modified.remove(e)}}))}storeFieldChange(e,t){this.meta.modified[e]=t}revertChanges(e=!1){this.isReverting=!0,this.set(this.meta.modified,Fs,e),this.isReverting=!1}setByDataSource(e){const{fieldDataSourceMap:t}=this.constructor,n=Ut.pathifyKeys(e,t),r={};for(const e in n){const s=t[e];r[(null==s?void 0:s.name)??e]=n[e]}return this.set(r)}applyChangeset(e,t="$PhantomId",n=!0){const r=this,s=r.constructor,{idField:i,fieldDataSourceMap:a}=s,o=Ut.pathifyKeys(e,a),l=Ut.pathifyKeys(r.modificationData),c={},d=t in e&&!(i in e);!d&&t in o&&delete o[t];for(const e in o){const t=a[e],r=(null==t?void 0:t.name)??e;(n||((null==t?void 0:t.name)===i?d:o[e]===l[e]))&&(c[r]=o[e])}const u=r.set(c);return r.clearChanges(!1,!0,n?null:c),u?Object.entries(u).reduce(((e,[t,n])=>(e[t]=n.value,e)),{}):{}}get internalId(){return this._internalId}get isPhantom(){return""===this.id||null==this.id||this.hasGeneratedId||Boolean(this.$isPhantom)}get isModel(){return!0}get hasGeneratedId(){return"string"==typeof this.id&&this.id.startsWith("_generated")}static generateId(e=this.$$name){return`_generated${e}_${T.generateUUID()}`}generateId(){return this.constructor.generateId()}static asId(e){return null!=e&&e.isModel?e.id:Ut.isObject(e)?e[this.fieldMap.id.dataSource]:e}get json(){return T.safeJsonStringify(this)}toJSON(){const{children:e,unfilteredChildren:t}=this,n=this.persistableData;return(t||e)&&(n[this.constructor.childrenField]=(t||e).map((e=>e.toJSON()))),n}toString(){const e=this,t=Ls.find((t=>t in e.constructor.fieldMap)),n=t?{[e.constructor.idField]:e.id,[t]:e[t]}:e.data;return T.safeJsonStringify(n)}get isBatchUpdating(){return Boolean(this.batching)}hasBatchedChange(e){var t,n;return null===(t=this.meta)||void 0===t||null===(n=t.batchChanges)||void 0===n?void 0:n[e]}beginBatch(e=!1){const t=this;t.batching||(t.batching=0,t.meta.batchChanges={}),e&&(t.$silenceBatch=(t.$silenceBatch||0)+1),t.batching++}endBatch(e=!1,t=!1,n=!0){const r=this,{parentIdField:s}=r.constructor;if(r.batching&&(r.batching--,r.$silenceBatch&&r.$silenceBatch--,!(r.batching>0||Ut.isEmpty(r.meta.batchChanges)))){let{batchChanges:i}=r.meta;r.meta.batchChanges=null,i[s]&&(i={...i},r.parentId=i[s],delete i[s]),r.set(i,Fs,e,!1,t,void 0,n)}}cancelBatch(){if(this.batching){const e=this,{batchChanges:t}=e.meta,n={};if(e.batching=null,e.meta.batchChanges=null,e.generation++,!e.$silenceBatch){Object.entries(t).forEach((([t,r])=>{n[t]={oldValue:r,value:e[t]}}));const r={action:"update",record:e,records:[e],changes:n};e.stores.forEach((e=>{e.trigger("batchedUpdate",{...r})})),e.forEachLinked(((e,t)=>{e.trigger("batchedUpdate",{...r,record:t,records:[t]})}))}e.$silenceBatch&&e.$silenceBatch--}}triggerBeforeUpdate(e){var t;return!(null!==(t=this.stores)&&void 0!==t&&t.some((t=>!1===t.trigger("beforeUpdate",{record:this,changes:e}))))}copy(e=null,t){const n=this,r=Ut.clone(n.data),s=n.constructor.idField,i=Ut.isObject(t)?t.deep:t;let a;if(e&&"object"==typeof e?(a=e[s],Object.assign(r,e)):a=e,i&&n.children?r.children=n.children.map((e=>e.copy(void 0,t))):(delete r.children,delete r.expanded),n.$meta.fields.initable.length>0){const e=n.toJSON();for(const t of n.$meta.fields.initable)r[t.name]=e[t.name]}!1!==e&&(r[s]=a||n.generateId(n.firstStore));const o=new n.constructor(r,null,null,!1,!0);return o.originalInternalId=n.internalId,o}copyData(e,t,n){const r={};e.allFields.forEach((({name:n})=>{n!==e.constructor.idField&&(r[n]=t?e.get(n):e.getValue(n))})),this.set(r,null,n)}remove(e=!1){const t=this,{parent:n,stores:r}=t;if(n)n.removeChild(t);else if(r.length&&!t.isSpecialRow){r.slice().forEach((n=>n.remove(t,e,!1,!0)))}}beforeRemove(e,t){return super.beforeRemove(e,t)}get isValid(){return!0}get firstStore(){return this.stores.length>0&&this.stores[0]}joinStore(e){const t=this,{stores:n}=t;if(!n.includes(e)){var r;const{unjoinedStores:s}=t;super.joinStore(e),e.register(t),n.push(e),s.includes(e)&&s.splice(s.indexOf(e),1),t.isLoaded&&t.children.forEach((t=>t.joinStore(e))),t.initRelations(),!e.tree||t.isRoot||null!==(r=e.stm)&&void 0!==r&&r.isRestoring||(t.instanceMeta(e.id).collapsed=!t.expanded)}}unjoinStore(e,t=!1){const n=this,{stores:r,unjoinedStores:s}=n;var i,a,o;r.includes(e)&&(e.isDestroying||(e.unregister(n),s.push(e)),null===(i=n.unfilteredChildren||n.children)||void 0===i||null===(a=i.forEach)||void 0===a||a.call(i,(n=>n.unjoinStore(e,t))),r.splice(r.indexOf(e),1),null===(o=super.unjoinStore)||void 0===o||o.call(this,e,t),e.uncacheRelatedRecord(n))}isPartOfStore(e){return e?e.includes(this):this.stores.length>0}get isRemoved(){return!this.isPartOfStore()}instanceMeta(e){var t;const{meta:n}=this,r=e.id||e;return(null===(t=n.map)||void 0===t?void 0:t[r])||this.setInstanceMeta(r,{})}setInstanceMeta(e,t){const{meta:n}=this,r=e.id||e;return n.map||(n.map={}),n.map[r]=t}get isGroupHeader(){return"groupRowFor"in this.meta}get isGroupFooter(){return"groupFooterFor"in this.meta}get isSpecialRow(){var e;return Boolean(null===(e=this.meta)||void 0===e?void 0:e.specialRow)}get $original(){return this.isLinked?this.proxyMeta.originalRecord:this}static get nonPersistableFields(){const e=this;return e._nonPersistableFields||(e._nonPersistableFields={},e.allFields.forEach((t=>{t.persist&&!t.calculated||(e._nonPersistableFields[t.name]=1)}))),e._nonPersistableFields}static get alwaysWriteFields(){const e=this;return e._alwaysWriteFields||(e._alwaysWriteFields=[],e.allFields.forEach((t=>{t.alwaysWrite&&e._alwaysWriteFields.push(t.name)}))),e._alwaysWriteFields}get domId(){return"string"==typeof this.id?this.id.replace(/[ .]/g,"-"):this.id}static toJavaScriptValue(e){const{names:t}=this.$meta;return`class ${t[t.length-2]} extends ${t[t.length-3]} { static fields = ${T.toJavaScriptValue(this.fields,e)}; }`}getCurrentConfig(e){const{data:t,children:n}=this,{defaultValues:r,applyConfigs:s}=this.constructor,i=s?super.getCurrentConfig(e):{};if(i){for(const n of this.fields)if(n.persist){const s=Ut.getPath(t,n.dataSource);n.isEqual(s,r[n.name])||Ut.setPath(i,n.dataSource,ue.processConfigValue(s,e))}if(n)if(Array.isArray(n)){i.children=[];for(const t of n)i.children.push(t.getCurrentConfig(e))}else i.children=n;this.hasGeneratedId&&delete i.id,delete i.parentId,delete i.parentIndex}return i}}Ns._idField="id",Ns._internalIdCounter=1,Ns._assignedIdField=!1,Ns.exposeProperties(),Ns._$name="Model";class js{constructor(e,t){"number"==typeof e||null===e?(this._magnitude=e,this._unit=t):("string"==typeof e&&Object.assign(this,Bt.parseDuration(e)),"object"==typeof e&&Object.assign(this,e))}get magnitude(){return this._magnitude}set magnitude(e){this._magnitude="number"==typeof e&&e}get unit(){return this._unit}set unit(e){this._unit=Bt.parseTimeUnit(e)}get isValid(){return null!=this._magnitude&&Boolean(Bt.normalizeUnit(this._unit))}get milliseconds(){return this.isValid?Math.round(Bt.asMilliseconds(this._magnitude,this._unit)):0}isEqual(e){return Boolean(e)&&null!=this._magnitude&&null!=e._magnitude&&this.milliseconds===e.milliseconds}toString(e){const t=this,n=e?"getShortNameOfUnit":"getLocalizedNameOfUnit";return t.isValid?`${t._magnitude} ${Bt[n](t._unit,1!==t._magnitude)}`:""}toJSON(){return this.toString()}valueOf(){return this.milliseconds}diff(e){return new js({unit:this.unit,magnitude:Bt.as(this.unit,this.milliseconds-e.milliseconds)})}}js._$name="Duration";const Vs=(e,t)=>null==e?void 0:e[t],Bs=/^is(this|next|last)(week|month|year)$/i,zs=["isToday","isTomorrow","isYesterday","isThisWeek","isNextWeek","isLastWeek","isThisMonth","isNextMonth","isLastMonth","isThisYear","isNextYear","isLastYear","isYearToDate"];class Ws extends(ue.mixin(rs)){static $name="CollectionFilter";static get defaultConfig(){return{value:null,operator:null,filterBy:null,convert:null,caseSensitive:!0,id:null,type:null,internal:null,disabled:!1}}static get configurable(){return{property:null}}construct(e){"function"==typeof e&&(e={filterBy:e}),e.type?"date"!==e.type||null==e.value||Array.isArray(e.value)?"duration"!==e.type||null==e.value||Array.isArray(e.value)||(e.value=new js(e.value)):e.value=new Date(e.value):Bt.isDate(e.value)||Array.isArray(e.value)&&e.value.every(Bt.isDate)?e.type="date":e.value instanceof js&&(e.type="duration"),super.construct(e)}get id(){return this._id||(this.internal?this._id=Ws.generateId(`b-internal-${this.property}-filter-`):this._id=this.property||Ws.generateId("b-filter-")),this._id}set id(e){this._id=e}onChange(e){var t;const n=this;n.isConfiguring||null===(t=n.owner)||void 0===t||!t.onFilterChanged||n.owner.isConfiguring||n.owner.onFilterChanged(n,e)}get filterBy(){return this._filterBy||this.defaultFilterBy}set filterBy(e){this._filterBy=e}defaultFilterBy(e){const t=this;let n;return n=e.isModel?e.getValue(t.property):t._propertyItems.length>1?t._propertyItems.reduce(Vs,e):e[t.property],t[t.operator](t.convert(n))}updateProperty(e){this._propertyItems=e.split("."),this.onChange("property")}set value(e){const t=this;t._value=e,Array.isArray(e)&&({date:1,duration:1}[t.type]||e.length>0&&"string"==typeof e[0])?t._filterValue=e.map((e=>t.convert(e))):!t.caseSensitive&&Array.isArray(e)&&e.length>0&&"string"==typeof e[0]?t._filterValue=e.map((e=>null==e?void 0:e.toLowerCase())):t.caseSensitive||"string"!=typeof e?t._filterValue=t.convert(e):t._filterValue=e.toLowerCase(),t.onChange("value")}get value(){return this._value}get filterValue(){return this._filterValue}set operator(e){this._operator=e,this.onChange("operator")}get operator(){const e=this;return e._operator?e._operator:Array.isArray(e.filterValue)?"isIncludedIn":"string"==typeof e.filterValue?"*":"="}convert(e){var t;"sameTime"===this.operator||"string"==typeof this.filterValue&&e instanceof Date||("sameDay"===this.operator&&(e=Bt.clearTime(e)),e=(null===(t=e)||void 0===t?void 0:t.valueOf())??e);return e=this.caseSensitive||"string"!=typeof e?e:e.toLowerCase()}filter(e){return this.filterBy(e)}startsWith(e){return String(e).startsWith(this.filterValue)}endsWith(e){return String(e).endsWith(this.filterValue)}isIncludedIn(e){return 0===this.filterValue.length||this.filterValue.includes(e)}isNotIncludedIn(e){return!this.isIncludedIn(e)}includes(e){return 0===this.filterValue.length||String(e).includes(this.filterValue)}doesNotInclude(e){return!this.includes(e)}sameTime(e){return Bt.isSameTime(e,this.filterValue)}sameDay(e){return e===this.filterValue}"="(e){return Ut.isEqual(e,this.filterValue)}"!="(e){return!Ut.isEqual(e,this.filterValue)}">"(e){return Ut.isMoreThan(e,this.filterValue)}">="(e){return Ut.isMoreThan(e,this.filterValue)||Ut.isEqual(e,this.filterValue)}"<"(e){return Ut.isLessThan(e,this.filterValue)}"<="(e){return Ut.isLessThan(e,this.filterValue)||Ut.isEqual(e,this.filterValue)}"*"(e){return Ut.isPartial(e,this.filterValue)}between(e){const[t,n]=this._filterValue;return(Ut.isMoreThan(e,t)||Ut.isEqual(e,t))&&(Ut.isLessThan(e,n)||Ut.isEqual(e,n))}notBetween(e){return!this.between(e)}empty(e){return null==e||0===String(e).length}notEmpty(e){return!this.empty(e)}isToday(e){return this.between(e)}isTomorrow(e){return this.between(e)}isYesterday(e){return this.between(e)}isThisWeek(e){return this.between(e)}isNextWeek(e){return this.between(e)}isLastWeek(e){return this.between(e)}isThisMonth(e){return this.between(e)}isNextMonth(e){return this.between(e)}isLastMonth(e){return this.between(e)}isThisYear(e){return this.between(e)}isNextYear(e){return this.between(e)}isLastYear(e){return this.between(e)}isYearToDate(e){return this.between(e)}isTrue(e){return!0===e}isFalse(e){return!1===e}setRelativeDateValues(){this._filterValue=Ws.getRelativeDateRange(this._operator).map((e=>e.valueOf()))}static getRelativeDateRange(e,t=new Date){let n,r,s,i,a,o,l;switch(e){case"isYearToDate":return[Bt.floor(t,"1 year"),t];case"isToday":return n=Bt.floor(t,"1 day"),[n,Bt.add(n,1,"day")];case"isYesterday":return n=Bt.floor(t,"1 day"),[Bt.add(n,-1,"day"),n];case"isTomorrow":return r=Bt.getStartOfNextDay(t),[r,Bt.add(r,1,"day")];case"isThisWeek":case"isNextWeek":case"isLastWeek":case"isThisMonth":case"isNextMonth":case"isLastMonth":case"isThisYear":case"isNextYear":case"isLastYear":if(s=e.toLowerCase().match(Bs),!s)throw new Error(`Unrecognized relative date expression: ${e}`);return[,o,l]=s,i=`1 ${l}`,a=Bt.floor(t,i),"next"===o?a=Bt.add(a,1,l):"last"===o&&(a=Bt.add(a,-1,l)),[a,Bt.add(a,1,l)]}}static generateFiltersFunction(e){if(!e||!e.length&&!e.count)return Ce.returnTrue;for(const t of e)"date"===t.type&&zs.includes(t._operator)&&t.setRelativeDateValues();return function(t){let n=!0;for(const r of e)if(r.disabled||(n=r.filter(t)),!n)break;return n}}}Ws._$name="CollectionFilter";const Hs=Ut.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null));class Us{static generateId(e="generatedId"){return e+(Hs[e]=(Hs[e]||0)+1)}}Us._$name="IdHelper";class Ys extends ue{static get defaultConfig(){return{property:null,direction:"ASC",sortFn:null,convert:null,id:null,useLocaleSort:null}}construct(e){"function"==typeof e&&(e={sortFn:e}),super.construct(e)}get id(){return this._id||(this._id=this.property||Us.generateId("b-sorter"))}set id(e){this._id=e}set sortFn(e){this._sortFn=e}get sortFn(){return this._sortFn?this._sortFn:this.defaultSortFn}defaultSortFn(e,t){const{convert:n,property:r,useLocaleSort:s}=this,i="desc"===this.direction.toLowerCase()?-1:1;if(e=e[r],t=t[r],n&&(e=n(e),t=n(t)),s&&null!=e&&null!=t&&"string"==typeof e){if(!0===s)return String(e).localeCompare(t);if("string"==typeof s)return String(e).localeCompare(t,s);if("object"==typeof s)return String(e).localeCompare(t,s.locale,s)}return(e>t?1:e<t?-1:0)*i}static generateSortFunction(e,t){const n=e.isCollection?e.values:e,r=n.length;return(e,s)=>{let i,a;for(a=0;a<r;++a)if(i=n[a].sortFn(e,s),i)return i;return t?t(e,s):0}}}Ys._$name="CollectionSorter";const qs=()=>0,Ks=(e,t)=>t-e,Gs=Symbol("filteredIndicesProperty"),Xs=Object.freeze([]),Zs=Object.freeze({action:"sort",added:Xs,removed:Xs,replaced:Xs}),Js=Object.freeze({action:"filter",added:Xs,removed:Xs,replaced:Xs}),Qs={string:1,number:1};function ei(e,t,n,r){if(!1!==t.unique)t.set(n,e),r&&t.count++;else{let r=t.get(n);r||(r=new Set,t.set(n,r)),r.add(e)}}function ti(e,t,n,r,s=!1){for(let i=0;i<e.length;i++){const a=e[i];for(let e=0;e<r;e++){const r=n[e],i=a[r],o=t[r];ei(a,o,i,!s&&o.onDuplicate)}}}class ni extends(ue.mixin(Ne)){_sortFunction=null;_addedValues=null;static get configurable(){return{idProperty:"id",extraKeys:null,autoFilter:!0,autoSort:!0,sorters:{$config:["lazy"],value:[]}}}get isCollection(){return!0}construct(e){this.generation=0,this._values=[],super.construct(e)}doDestroy(){var e;super.doDestroy();const t=this;t._values.length=0,t.isFiltered&&(t._filteredValues.length=0,t.filters.destroy()),null===(e=t._sorters)||void 0===e||e.destroy()}clear(){const e=this,t=e._values.slice();e.totalCount&&(e._values.length=0,e._filteredValues&&(e._filteredValues.length=0),e._indicesInvalid=!0,e.generation++,e.trigger("change",{action:"clear",removed:t}))}equals(e,t){if(e.isCollection&&(e=e.values),e.length===this.count){let{values:n}=this;return t&&(e=e.map(t),n=n.map(t)),ge.delta(e,n).inBoth.length===this.count}return!1}replaceValues({values:e,filteredValues:t,silent:n=!1,isNewDataset:r=!1}){const s=this;let i,a;if(s.isFiltered&&!r){Boolean(t)?e&&(i=s._values,s._values=e.slice()):(t=e.slice(),e=null),a=s._filteredValues,s._filteredValues=t.slice()}else i=s._values,s._values=e.slice(),t=null,s.isFiltered&&r&&s.autoFilter?(s._filterFunction=null,s._filteredValues=s._values.filter(s.filterFunction)):s._filteredValues&&(s._filteredValues.length=0);s._indicesInvalid=!0,s._addedValues=void 0,s.generation++,n||s.trigger("change",{action:"replaceValues",replacedValues:i,replacedFilteredValues:a,values:e,filteredValues:t})}set values(e){this.invalidateIndices(),this.splice(0,this._values.length,e)}get values(){return this.isFiltered?this._filteredValues:this._values}get filteredValues(){return this._filteredValues}[Symbol.iterator](){return this.values[Symbol.iterator]()}forEach(e,t=!1){(this.isFiltered&&!t?this._filteredValues:this._values).forEach(e)}map(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).map(e)}reduce(e,t=!1,n=[]){return(this.isFiltered&&!t?this._filteredValues:this._values).reduce(e,n)}find(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).find(e)}get first(){return this.values[0]}get last(){return this.values[this.count-1]}get allValues(){return this._values}get addedValues(){return this._addedValues}match(e,t=!0){const n=this,{_values:r}=n,s=[];return n.forEach((i=>{const a=e.get(i.id,!0);if(a){const e=n.indexOf(i,!0),t=r[e];r[e]=a,n.removeFromIndices(t),n.addToIndices(a)}else t&&s.push(i)})),s.length&&n.remove(s),n.isFiltered&&(n._filteredValues=n._values.filter(n.filterFunction)),s}add(...e){1===e.length?this.splice(this._values.length,null,...e):this.splice(this._values.length,null,e)}remove(...e){1===e.length?this.splice(0,...e):this.splice(0,e)}move(e,t){for(e=ge.asArray(e);e.length&&e[0]===t;)e.shift();if(!e.length)return;const n=this,{_values:r}=n,s=n.indexOf(e[0],!0);if(1===e.length&&r[s+1]===t)return;n.suspendEvents(),n.remove(e),n.resumeEvents();const i=t?n.indexOf(t,!0):r.length;if(-1===i)throw new Error("Collection move beforeItem parameter must be present in Collection");return r.splice(i,0,...e),n._indicesInvalid=1,n.trigger("change",{action:"move",items:e,from:s,to:i}),i}splice(e=0,t,...n){var r;const s=this,i=s.idProperty,a=s._values,o={},l=[],c=[],d=s.totalCount;let u,h;if(1===(null===(r=n)||void 0===r?void 0:r.length)&&Array.isArray(n[0])&&(n=n[0]),!1!==s.trigger("beforeSplice",{index:e,toRemove:t,toAdd:n})){if(n)if(d&&n.length){const e=s.indices[i];u=[];for(let t=0;t<n.length;t++){const r=n[t],s=r[i],l=e.get(s),d=l?a.indexOf(l):-1;o[s]=!0,-1!==d?a[d]!==r&&(c.push([a[d],r]),a[d]=r):u.push(r)}}else u=n;if(t){if("number"==typeof t){t=Math.min(t,a.length-e);for(let n=e;t;--t){o[a[n][i]]?(e++,n++):(l.push(a[n]),a.splice(n,1),h=!0)}}else{let e,n=0===u.length;const r=(t=ge.asArray(t)).reduce(((t,r)=>{const i="number"==typeof r,a=i?r:s.indexOf(r,!0);return n&&(null!=e&&a!==e+1||i)&&(n=!1),a>=0&&a<d&&t.push(a),e=a,t}),[]).sort(Ks);if(n)r.length&&(l.push.apply(l,t),a.splice(r[r.length-1],r.length),h=!0);else for(let e=0;e<r.length;e++){const t=r[e];if(-1!==t){o[a[t][i]]||(l.unshift(a[t]),a.splice(t,1),h=!0)}}}l.length&&!s._indicesInvalid&&l.forEach(s.removeFromIndices,s)}if(u.length){a.splice(Math.min(e,a.length),0,...u),h=!0,s._indicesInvalid||u.forEach(s.addToIndices,s),s._addedValues||(s._addedValues=new Set);for(const e of u)s._addedValues.add(e)}if(l.length&&s._addedValues)for(const e of l)s._addedValues.delete(e);c.length&&!s._indicesInvalid&&c.forEach((e=>{s.removeFromIndices(e[0]),s.addToIndices(e[1])})),h||c.length?(s.isSorted?s.onSortersChanged():s.isFiltered&&(s.autoFilter?s.onFiltersChanged({action:"splice",oldCount:1}):s._filteredValues.splice(Math.min(e,s._filteredValues.length),0,...u)),s.generation++,s.trigger("change",{action:"splice",removed:l,added:u,replaced:c,oldCount:d})):s.trigger("noChange",{index:e,toRemove:t,toAdd:n})}}changeId(e,t){const n=this,{idProperty:r}=n,s=Qs[typeof e]?e:e[r],i=n.get(s);if(i){const a=n.get(t);if(a&&i!==a)throw new Error(`Attempt to set item ${s} to already existing member's id ${t}`);n.removeIndexEntry(e,r,s),n.addIndexEntry(e,r,t),i[r]=t}}get(e,t=!1){return this.getBy(this.idProperty,e,t)}getAt(e,t=!1){return this.isFiltered&&!t?this._filteredValues[e]:this._values[e]}getBy(e,t,n=!1){return this.findItem(e,t,this.isFiltered&&n)}get count(){return this.values.length}get totalCount(){return this._values.length}updateIdProperty(e){this.addIndex({property:e,unique:!0})}changeSorters(e){return new ni({values:ge.asArray(e),internalListeners:{change:"onSortersChanged",thisObj:this}})}addSorter(e){const t=e instanceof Ys?e:new Ys(e);return this.sorters.add(t),t}get isSorted(){var e;return Boolean(null===(e=this._sorters)||void 0===e?void 0:e.count)}onSortersChanged(){const e=this;e._sortFunction=null,e._addedValues=null,e._values.sort(e.sortFunction),e.trigger("change",Zs)}get sortFunction(){return this._sortFunction||(this.isSorted?this._sortFunction=Ys.generateSortFunction(this.sorters.values):this._sortFunction=qs),this._sortFunction}get filters(){return this._filters||(this._filters=new ni({internalListeners:{change:"onFiltersChanged",thisObj:this}})),this._filters}addFilter(e){const t=e instanceof Ws?e:new Ws(e);return this.filters.add(t),t}removeFilter(e){const{filters:t}=this;e.isCollectionFilter||(e=t.get(e)),t.remove(e)}clearFilters(){this.filters.clear()}get isFiltered(){return Boolean(this._filters&&this._filters.count)}onFiltersChanged({action:e,removed:t,oldCount:n}){const r=this,s=n||"clear"===e&&t.length?r._filteredValues:r._values;r._filterFunction=null,r._filteredValues=r._values.filter(r.filterFunction),r._indicesInvalid=!0;const{toAdd:i,toRemove:a}=ge.delta(r._filteredValues,s,!0);r.trigger("change",{...Js,added:i,removed:a})}get filterFunction(){return this._filterFunction||(this.isFiltered?this._filterFunction=Ws.generateFiltersFunction(this.filters.values):this._filterFunction=Ce.returnTrue),this._filterFunction}changeExtraKeys(e){return ge.asArray(e).map((e=>"string"==typeof e?{property:e,unique:!0}:e))}updateExtraKeys(e){for(let t=0;t<e.length;t++)this.addIndex(e[t])}addIndex(e){const t=this;e&&((t._indices||(t._indices={}))[e.property]=new Map,Object.assign(t._indices[e.property],e),t.invalidateIndices(),e.dependentOn&&(t.hasCompositeIndex=!0))}findIndex(e,t,n=!1){const r=this.findItem(e,t,n);if(!r)return-1;return(this.isFiltered&&!n?this._filteredValues:this._values).indexOf(r)}findItem(e,t,n=!1){const r=this,{isFiltered:s}=r,i=s&&!n?r.indices[Gs][e]:r.indices[e];if(i){const e=i.get(t)??("string"==typeof t&&t.length&&!isNaN(t)&&i.get(Number(t))||null);if(null!=e)return e}else{const i=s&&!n?r._filteredValues:r._values,a=i.length;for(let n=0;n<a;n++){const r=i[n];if(r[e]==t)return r}}return null}removeIndex(e){delete this._indices[e],this.hasCompositeIndex=Object.values(this.indices).some((e=>e.dependentOn))}indexOf(e,t=!1){return this.findIndex(this.idProperty,Qs[typeof e]?e:e[this.idProperty],t)}includes(e,t=!1){return Array.isArray(e)?e.some((e=>this.includes(e))):Boolean(this.findItem(this.idProperty,Qs[typeof e]?e:e[this.idProperty],t))}get indices(){return this._indicesInvalid&&this.rebuildIndices(),this._indices}invalidateIndices(){this._indicesInvalid=!0}rebuildIndices(){const e=this,t=e.isFiltered,n=e._indices||(e._indices={}),r=Object.keys(n),s=r.length,i=e._values;let a,o=!1;t&&(a=n[Gs]={});for(let e=0;e<s;e++){const s=n[r[e]];if(s.clear(),s.onDuplicate&&(s.count=0,o=!0),t){let t=a[r[e]];t?t.clear():(t=a[r[e]]=new Map,t.unique=s.unique)}}if(ti(i,n,r,s),o)for(let e=0;e<s;e++){const t=n[r[e]];if(t.onDuplicate&&t.count>t.size){const n=new Set;for(let s=0;s<i.length;s++){const a=i[s],o=a[r[e]];n.has(o)&&t.onDuplicate(a,o,t),n.add(o)}}}t&&ti(e._filteredValues,a,r,s,!0),e._indicesInvalid=!1}getIndices(e){const t=[this.indices[e]];return this.isFiltered&&t.push(this.indices[Gs][e]),t}addToIndices(e){Object.keys(this.indices).forEach((t=>{this.addIndexEntry(e,t,e[t])}))}removeFromIndices(e){Object.keys(this.indices).forEach((t=>{this.removeIndexEntry(e,t,e[t])}))}removeIndexEntry(e,t,n){this.getIndices(t).forEach((t=>function(e,t,n){!1!==t.unique?t.delete(n):t.has(n)&&(t.get(n).delete(e),t.get(n).size||t.delete(n))}(e,t,n)))}addIndexEntry(e,t,n){this.getIndices(t).forEach((t=>ei(e,t,n)))}onItemMutation(e,t){const n=this;!n._indicesInvalid&&Object.keys(n.indices).length>1&&Object.keys(t).forEach((r=>{if(n.indices[r]){const{value:s,oldValue:i}=t[r];n.removeIndexEntry(e,r,i),n.addIndexEntry(e,r,s)}if(n.hasCompositeIndex){const i=Object.values(n.indices).find((e=>{var t;return null===(t=e.dependentOn)||void 0===t?void 0:t[r]}));if(i){const r={};for(const n in i.dependentOn){var s;r[n]=(null===(s=t[n])||void 0===s?void 0:s.oldValue)||e[n]}const a=e.buildIndexKey(r);n.removeIndexEntry(e,i.property,a),n.addIndexEntry(e,i.property,e[i.property])}}}))}}ni._$name="Collection";const ri=new WeakMap,si=e=>{if(e&&"object"==typeof e){let t=ri.get(e);void 0===t&&(t=Symbol("bscik"),ri.set(e,t)),e=t}return e};class ii{constructor(e){const t=this;t.generation=0,t.items=new Set,t.idMap={},t.idProperty="id",e&&(e.idProperty&&(t.idProperty=e.idProperty),e.values&&(t.values=e.values))}get(e){return this.idMap[si(e)]}get count(){return this.items.size}add(...e){1===e.length&&Array.isArray(e[0])&&(e=e[0]);const t=this,{items:n,idMap:r,idProperty:s}=t,i=e.length;for(let a=0;a<i;a++){const i=e[a],o=Qs[typeof i]?i:si(i[s]),l=r[o];null==l?(r[o]=i,n.add(i),t.generation++):l!==i&&(r[o]=i,n.delete(l),n.add(i))}}at(e){let t,n;for(t of(e<0&&(e+=this.count),this.items))if(!e--){n=t;break}return n}remove(e){e=ge.asArray(e);const{items:t,idMap:n,idProperty:r}=this,s=e.length;for(let i=0;i<s;i++){const s=e[i],a=Qs[typeof s]?s:si(s[r]),o=n[a];null!=o&&(t.delete(o),delete n[a],this.generation++)}}clear(){this.items.clear(),this.idMap={},this.generation++}countOf(e){let t,n=0;for(t of this.items)e(t)&&++n;return n}changeId(e,t){const n=this,{idMap:r,idProperty:s}=n,i=Qs[typeof e]?e:si(e[s]),a=n.get(i);if(a){const e=n.get(t);if(e&&a!==e)throw new Error(`Attempt to set item ${i} to already existing member's id ${t}`);a[s]=t,delete r[i],r[t]=a}}filter(e,t){const{items:n}=this,r=[];let s=0;return n.forEach((i=>{e.call(t,i,s++,n)&&r.push(i)})),r}includes(e){const t=Qs[typeof e]?e:si(e[this.idProperty]);return Boolean(this.idMap[t])}map(e,t){const{items:n}=this,r=new Array(n.size);let s=0;return n.forEach((i=>{r[s]=e.call(t,i,s++,n)})),r}forEach(e,t){return this.items.forEach(e,t)}find(e,t=0){let n,r;for(n of(t<0&&(t+=this.countOf(e)),this.items))if(e(n)&&!t--){r=n;break}return r}[Symbol.iterator](){return this.items[Symbol.iterator]()}indexOf(e,t){let n,r=-1;for(n of this.items)if((!t||t(n))&&(++r,n===e))return r;return-1}get values(){return[...this.items]}set values(e){e=ge.asArray(e),this.clear(),this.add.apply(this,e),this.generation++}sort(e){this.values=this.values.sort(e)}some(e,t){return this.values.some(e,t)}}ii._$name="Bag";class ai extends ii{add(...e){return 1===e.length&&Array.isArray(e[0])&&(e=e[0]),super.add(...e.filter((e=>e.isPersistable)))}}ai._$name="StoreBag";var oi=e=>class extends(e||ue){static get $name(){return"StoreCRUD"}static get defaultConfig(){return{autoCommit:!1}}static get properties(){return{isRemoving:!1,suspendCount:0}}remove(e,t=!1){const n=this,{storage:r}=n;if(0===(e=ge.asArray(e).reduce(((e,t)=>((t=n.getById(t))&&e.push(t),e)),[])).length)return e;if(!n.tree&&!t&&!1===n.trigger("beforeRemove",{records:e}))return[];if(n.isRemoving=!0,n.isGrouped){const t=r.count,s=[],i=new Set;for(const t of e){const e=t.groupParent.get(n.id);e.meta.collapsed&&s.push(t),ge.remove(e.groupChildren,t),ge.remove(e.unfilteredGroupChildren,t),e.meta.childCount--,i.add(e)}for(const e of i)e.groupChildren.length>0&&n.onModelChange(e,{},{});s.length&&r.trigger("change",{action:"splice",removed:s,added:[],replaced:[],oldCount:t})}else if(n.tree){const s=[],i=e.length>1,a=e[0],o=i?void 0:r.indexOf(a),l=e.reduce(((e,t)=>{const{parent:n}=t;return n&&(e[n.id]||(e[n.id]=[n,[]]),e[n.id][1].push(t)),e}),{}),c=Array.from(Object.values(l));if(!t&&!1===n.trigger("beforeRemove",{records:e,isMove:!1,parent:i?void 0:a.parent}))return n.isRemoving=!1,[];n.suspendAutoCommit(),c.sort(((e,t)=>t[0].childLevel-e[0].childLevel));for(const[e,t]of c)s.push(...e.removeChild(t,!1,!0));return t||(n.trigger("remove",{parent:i?void 0:a.parent,index:o,isChild:!0,allRecords:s,isMove:!1,records:e}),n.trigger("change",{action:"remove",records:e})),n.resumeAutoCommit(),n.isRemoving=!1,e}if(0===e.length)return n.isRemoving=!1,e;for(const t of e)t.beforeRemove(e);return t&&n.suspendEvents(),r.remove(e),t&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),n.isRemoving=!1,e}clear(e=!1){var t,n;const r=this,{storage:s}=r;if(r.storage.totalCount||null!==(t=r.rootNode)&&void 0!==t&&null!==(n=t.unfilteredChildren)&&void 0!==n&&n.length){if(!e&&!1===r.trigger("beforeRemove",{records:s.allValues,removingAll:!0}))return null;if(r.rootNode)r.isChained||r.rootNode.clearChildren(e);else if(e){const e=r.registeredRecords;for(let t,n=e.length-1;n>=0;n--)t=e[n],t&&!t.isDestroyed&&t.unjoinStore(r)}e&&(r.removed.clear(),s.suspendEvents()),s.clear(),e&&s.resumeEvents(),r.added.clear(),r.modified.clear()}}removeAll(e=!1){const t=this,n=t.storage;let r;if(t.isRemoving=!0,e){n.suspendEvents();const e=t.registeredRecords;for(let n,r=e.length-1;r>=0;r--)n=e[r],!n||n.isDestroyed||n.isRoot||n.unjoinStore(t)}return r=t.tree?!1!==t.rootNode.clear():null!==t.clear(),e&&n.resumeEvents(),t.isRemoving=!1,r}add(e,t=!1,n={}){var r;const s=this,{storage:i}=s;if(null===(r=e=ge.asArray(e))||void 0===r||!r.length)return;if(s.tree=s.tree||Boolean(s.autoTree&&e[0].children),s.tree){const r=new Map,i=s.modelClass.getFieldDataSource("parentIndex"),{parentIdField:a}=s.modelClass,o=[];return e.forEach((e=>{const t=e[a];r.has(t)||r.set(t,{append:[],insert:[]});const n=r.get(t);!e.isModel&&i in e?n.insert.push(e):n.append.push(e)})),r.forEach((({append:e,insert:r},a)=>{const l=null==a?s.rootNode:s.getById(a);if(!l)throw new Error(`Parent node with id ${a} not found, cannot add children.`);if(e.length&&o.push(...l.appendChild(e,t,n)),r.length)for(const e of r)o.push(l.insertChild(e,e[i],t,n))})),s.isFiltered&&s.reapplyFilterOnAdd&&s.filter({silent:!0}),s.reapplySortersOnAdd&&!s.isSyncingDataOnLoad&&s.sort(),o}if(!t&&!1===s.trigger("beforeAdd",{records:e}))return null;if(s.tree=s.tree||Boolean(s.autoTree&&e[0].children),s.tree)return s.rootNode.appendChild(e);const a=s.processRecords(e);return t&&s.suspendEvents(),s.addingClean=n.clean,i.add(a),s.addingClean=!1,t&&s.resumeEvents(),s.autoCommit&&s.doAutoCommit(),a}processRecords(e,t){return e.map((e=>{const n=this.processRecord(e.isModel?e:this.createRecord(e));return null==t||t.call(this,n),n}))}insert(e,t,n=!1){const r=this,s=r.storage,i=r.getAt(e),a=s.values,o=[];if(t=ge.asArray(t),r.tree){var l;const s=r.rootNode;return s.insertChild(t,null===(l=s.children)||void 0===l?void 0:l[e],n)}if(!n&&!1===r.trigger("beforeAdd",{records:t}))return null;let c,d,u;if(a[d=e]===t[0]||a[d=e-1]===t[0])for(c=!0,u=0;c&&u<t.length;u++)t[u]!==a[d+u]&&(c=!1);if(c)return null;const h=r.processRecords(t,(t=>{const n=s.indexOf(t);t.children&&t.children.length&&r.autoTree&&(r.tree=!0),n>-1&&(n<e&&i&&e--,o.push(n)),t.meta.previousIndex=n}));return r.suspendEvents(),r.storage.remove(o),r.resumeEvents(),n&&r.suspendEvents(),s.splice(e,0,...h),n&&r.resumeEvents(),r.autoCommit&&r.doAutoCommit(),h}move(e,t){this.isTree?t.parent.insertChild(e,t):this.storage.move(e,t)}setMultiple(e,t,n){const r=this,s=[],i=[];r.forEach((r=>{e(r)&&(i.push(r.set(t,n,!0)),s.push(r))})),r.trigger("updateMultiple",{records:s,all:r.records.length===s.length}),r.trigger("change",{action:"updatemultiple",records:s,all:r.records.length===s.length}),r.reapplyFilterOnUpdate&&r.isFiltered&&r.filter()}setAll(e,t){const n=this,r=[];n.forEach((n=>{r.push(n.set(e,t,!0))})),n.trigger("updateMultiple",{records:n.records,all:!0}),n.trigger("change",{action:"updatemultiple",records:n.records,all:!0}),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}acceptChanges(){const e=this;e.added.forEach((e=>e.clearChanges(!0,!1))),e.modified.forEach((e=>e.clearChanges(!0,!1))),e.added.clear(),e.modified.clear(),e.removed.clear()}commit(e=!1){const{changes:t}=this;return!(!e&&!1===this.trigger("beforeCommit",{changes:t}))&&(this.acceptChanges(),e||this.trigger("commit",{changes:t}),t)}revertChanges(){const e=this,{changes:t}=e;if(t){const n={action:"clearchanges",changes:t};e.add(e.removed.values,!0),e.remove(e.added.values,!0),e.modified.forEach((e=>e.revertChanges(!0))),e.added.clear(),e.modified.clear(),e.removed.clear(),e.trigger("change",n),e.trigger("refresh",n)}}get changes(){const e=this,t=e.modified.values.filter((e=>e.rawModifications));return e.added.count||t.length||e.removed.count?{added:e.added.values.slice(),modified:t,removed:e.removed.values.slice()}:null}get autoCommit(){return this._autoCommit}set autoCommit(e){this._autoCommit=e,e&&this.changes&&this.commit()}suspendAutoCommit(){this.suspendCount++}resumeAutoCommit(e=!0){this.suspendCount--,this.autoCommit&&e&&this.doAutoCommit()}doAutoCommit(){this.suspendCount<=0&&this.commit()}},li=e=>class extends(e||ue){static get $name(){return"StoreChanges"}static get configurable(){return{applyChangesetFilterSortTarget:"changes"}}applyChangesFromStore(e){const t=this,{changes:n}=e;n&&(n.added&&t.add(n.added),n.removed&&t.remove(n.removed.map((e=>e.id))),n.modified&&n.modified.forEach((e=>{const n=t.getById(e.id);null==n||n.set(e.modifications)})))}applyChangeset(e,t=null,n="$PhantomId",r=!0,s=!1){const i=this,{added:a,updated:o,modified:l,removed:c}=(null==t?void 0:t(e,i))??e,d=o??l??[],u=i.modelClass.getFieldDataSource("id"),h=i.modelClass.getFieldDataSource("parentId"),g=s?new Map:null,m=[],p=[];let f=!1,v=[];if(i.trigger("startApplyChangeset"),i._groupVisibleRecordIds=[],i.isGrouped&&i.forEach((e=>{i._groupVisibleRecordIds.push(e.id)})),(null==a?void 0:a.length)>0){const e=[],t=[];for(const r of a)i.getById(r[n])||i.getById(Ut.getPath(r,u))?e.push(r):t.push(r);d.unshift.apply(d,e);const r=i.reapplySortersOnAdd;i.reapplySortersOnAdd=!1;const s=i.add(t,!1,{orderedParentIndex:{skip:!0}})??[];if(m.push(...s),i.reapplySortersOnAdd=r,i.tree)for(const e of s){const{parent:t}=e;if(t.isRoot){f=!0,v=[t];break}!t.isRoot&&v.every((e=>!e.contains(t)))&&v.push(t)}for(const e of s)null==g||g.set(e.id,e.data),e.clearChanges()}if((null==d?void 0:d.length)>0)for(const e of d){const t=e[n],s=Ut.getPath(e,u),a=Ut.getPath(e,h),o=i.getById(t)??i.getById(s);if(o){var y;const t=null!=a&&(null===(y=i.getById(a))||void 0===y?void 0:y.isLeaf),l=o.applyChangeset(e,n,r);t&&i.toggleCollapse(o.parent,!1),i.tree&&!f&&v.every((e=>!e.contains(o)))&&(o.parent.isRoot?(f=!0,v=[o.parent]):v.push(o.parent)),null==g||g.set(s,l),p.push(o)}}if((null==c?void 0:c.length)>0&&i.applyRemovals(c),"changes"===i.applyChangesetFilterSortTarget){const e=i.filterChangeset(m,p);v.push(...e)}if(i.afterChangesetApplied(v),i.tree&&i.isSorted&&i.reapplySortersOnAdd&&(null!=a&&a.length||null!=d&&d.length)){const e=new Set;v.forEach((t=>{e.has(t)||(e.add(t),t.sortVisibleChildren(!1,i.sorterFn),t.sortUnfilteredChildren(!1,i.sorterFn))})),i.storage.replaceValues({values:i.collectDescendants(i.rootNode).visible,silent:!0}),i.afterPerformSort(!1)}return i._groupVisibleRecordIds=null,i.trigger("endApplyChangeset"),g}afterChangesetApplied(e){const t=new Set;e.forEach((e=>{t.has(e)||e.traverse((e=>{t.has(e)||(t.add(e),e.sortOrderedChildren(!1,!1),e.children&&e.updateChildrenIndices(e.children,"parentIndex",!0),e.unfilteredChildren&&e.updateChildrenIndices(e.unfilteredChildren,"unfilteredIndex",!0))}))}))}applyRemovals(e){const t=this,{removed:n}=t,r=t.modelClass.idField,s=[];for(const t of e){const e=Ut.getPath(t,r);if(n.includes(e)){const t=n.get(e);t.clearChanges(!1,!0,null),t.$isPhantom=!0,n.remove(e)}else s.push(e)}t.remove(s);for(const e of s)n.remove(e)}filterChangeset(e,t){const n=this,{isFiltered:r,tree:s,isGrouped:i,filtersFunction:a}=n,o=n.isSorted?n.createSorterFn(n.sorters):void 0,{allValues:l,addedValues:c,isSorted:d}=n.storage,u=null!=o||d?o??n.storage.sortFunction:null,h=new Set;if(!r)return[];let g,m=!1;if(i&&(g=n.groupers,n.clearGroupers(!0)),s){const r=new Set(t.filter(a));for(const t of e.filter(a))r.add(t);r.forEach((e=>e.bubble((e=>r.add(e))))),r.delete(n.rootNode);const s=ge.groupBy(Array.from(r).filter((e=>{var t,n;return!(null!==(t=e.parent)&&void 0!==t&&null!==(n=t.children)&&void 0!==n&&n.includes(e))})),"parentId");for(const e of Object.values(s)){const{parent:t}=e[0];t.unfilteredChildren&&(t.children.push(...e),h.add(t))}}else if(u&&!i){const{filteredValues:e}=n.storage,r=c?e.findLastIndex((e=>!c.has(e)))+1:e.length,s=e.slice(0,r),i=new Set(t.filter(a));for(const t of e)i.has(t)&&i.delete(t);for(const e of i)s.push(e);s.sort(u),e.splice(0,r,...s),m=!0}else{const e=t.filter((e=>a(e)&&!n.storage.includes(e)));e.length>0&&(n.includeInSubset(l,n.storage.filteredValues,e),m=!0)}const p=new Set(e.filter((e=>!a(e))));if(p.size>0){if(s)for(const e of p)ge.remove(e.parent.children,e),h.add(e.parent);else ge.remove(n.storage.filteredValues,p);m=!0}return g&&(n.group(g[0],null,!1,!0,!0),m=!0),s&&h.size>0?n.storage.replaceValues({values:n.collectDescendants(n.rootNode).visible,silent:!0}):m&&(n._idMap=null,n.trigger("refresh")),[...h]}includeInSubset(e,t,n){const r=new Set(n);let s=0,i=0,a=0===r.size;for(;i<e.length&&!a;){const n=t[s];let o=e[i];for(;n!==o;)r.has(o)&&(t.splice(s,0,o),s++,r.delete(o),a=0===r.size),o=e[++i];r.has(n)&&r.delete(n),s<t.length&&s++}return t}},ci=e=>class extends(e||ue){static get $name(){return"StoreFilter"}static get defaultConfig(){return{filters:null,reapplyFilterOnAdd:!1,reapplyFilterOnUpdate:!1}}set reapplyFilterOnAdd(e){this.storage.autoFilter=e}get reapplyFilterOnAdd(){return this.storage.autoFilter}set filters(e){const t=this,n=t.filters;if(n.clear(),t._filtersFunction=null,e){if("Object"===e.constructor.name)for(const t of Object.entries(e))"filterBy"===t[0]&&"function"==typeof t[1]?n.add(new Ws({filterBy:t[1]})):n.add(new Ws("Object"===t[1].constructor.name?Object.assign({property:t[0]},t[1]):{property:t[0],value:t[1]}));else Array.isArray(e)?n.add(...e.map((e=>e instanceof Ws?e:new Ws(e)))):e.isCollection?n.add(...e.values):n.add(new Ws({filterBy:e}));n.forEach((e=>e.owner=t))}}get filters(){return this._filters||(this._filters=new ni({extraKeys:["property"]}))}set filtersFunction(e){this._filtersFunction=e}get filtersFunction(){const e=this,{filters:t,isGrouped:n}=e;if(!e._filtersFunction)if(t.count){const r=Ws.generateFiltersFunction(t);e._filtersFunction=e=>n&&e.isSpecialRow?e.groupChildren.some(r):r(e)}else e._filtersFunction=Ce.returnTrue;return e._filtersFunction}get isFiltered(){return this.filters.values.some((e=>!e.disabled))}traverseFilter(e){const t=this,n=!e.isRoot&&t.filtersFunction(e),r=e.unfilteredChildren||e.children;return r&&r.length?(e.unfilteredChildren||(e.unfilteredChildren=e.children.slice()),e.children=e.unfilteredChildren.filter((e=>t.traverseFilter(e))),t.isSorted&&e.children.sort(t.sorterFn),e.updateChildrenIndices(e.unfilteredChildren,"unfilteredIndex",!0),e.updateChildrenIndices(e.children,"parentIndex",!0),n||Boolean(e.children.length)):n}traverseClearFilter(e){const t=this;e.unfilteredChildren&&(e.children=e.orderedChildren.slice(),e.unfilteredChildren=null),e.children&&(t.isSorted&&e.children.sort(t.sorterFn),e.children.forEach((e=>t.traverseClearFilter(e))),e.updateChildrenIndices(e.children,"parentIndex",!0))}get latestFilterField(){return this.filters.last?this.filters.last.property:null}addFilter(e,t=!1){const n=this;if((e=e instanceof Ws?e:new Ws(e)).owner=n,n.filters.add(e),!t){if(n.remoteFilter)return n.filter().then((()=>e));n.filter()}return e}filter(e){const t=this;let n,r=!1;if(e){let s=typeof e;if("object"===s&&("silent"in e||"replace"in e||e.filters)&&(r=e.silent,e.replace&&t.clearFilters(0===e.filters.length),n=e.internal,s=typeof(e=e.filters)),e){const r=t.isFiltered;if(t.isConfiguring=!0,Array.isArray(e))e.forEach((e=>t.addFilter(e,!0)),t);else if("function"===s){const r=new Ws(e);r.internal=n,t.addFilter(r,!0)}else"string"===s?t.addFilter({property:e,value:arguments[1]},!0):t.addFilter(e,!0);if(t.isConfiguring=!1,!t.isFiltered&&!r)return null}}t.filtersFunction=null;const s=t.performFilter(r);return t._idMap=null,s}performFilter(e){const t=this,{storage:n,filters:r,rootNode:s}=t,i=t.count;let a,o;if(t.trigger("beforeFilter",{filters:r}),t.tree){const e=n.values;t.isFiltered?t.traverseFilter(s):t.traverseClearFilter(s);const r=t.collectDescendants(s).visible;n.replaceValues({values:r,silent:!0});const i=ge.delta(r,e,!0);a=i.toAdd,o=i.toRemove}else n.ion({change({removed:e,added:t}){o=e,a=t},once:!0}),t.isFiltered?(t.isGrouped&&t.includeCollapsed(),n.addFilter({id:"primary-filter",filterBy:t.filtersFunction}),t.isGrouped&&t.excludeCollapsed()):n.filters.clear();t.afterPerformFilter(e||t.isRemoteDataLoading?null:{action:"filter",filters:r,oldCount:i,added:a,removed:o,records:t.storage.values})}afterPerformFilter(e){this.resetRelationCache(),e&&this.triggerFilterEvent(e)}triggerFilterEvent(e){this.trigger("filter",e),this.remoteFilter||(this.trigger("refresh",e),this.trigger("change",e))}filterBy(e){return this.filter(e)}removeFilter(e,t=!1){const n=this,r=e instanceof Ws?e:n.filters.get(e);if(r){if(n.filters.remove(r),n._filtersFunction=null,!t){if(n.remoteFilter)return n.filter().then((()=>r));n.filter()}return r}}clearFilters(e=!0){if(this.filters.remove(this.filters.values.filter((e=>!e.internal))),e)return this.filter()}convertFilterToString(e){const t=this.filters.getBy("property",e);return t&&!t.filterBy?String(t):""}doDestroy(){var e;null===(e=this._filters)||void 0===e||e.destroy(),super.doDestroy()}};const di={add:1,replace:1},ui=({_groupValue:e},{_groupValue:t})=>e<t?-1:e>t?1:0;var hi=e=>class extends(e||ue){static $name="StoreGroup";static configurable={groupers:null,useGroupFooters:!1,startGroupsCollapsed:null};static get properties(){return{collapsedGroups:new Set}}construct(e){super.construct(e),this.ion({change:"onDataChanged",thisObj:this})}get GroupRow(){return this._GroupRowClass||(this._GroupRowClass=class extends this.modelClass{static isSpecialRow=!0;static fields=[{name:"_groupValue"}];get isCollapsed(){return this.meta.collapsed}})}updateGroupers(e){this.setGroupers(e)}setGroupers(e,t=null){const n=this,{storage:r}=n;let s;return null!=e&&e.length?n._groupers=e:n.groupers&&(delete n._groupers,n.includeCollapsed(),r.replaceValues({values:n.removeHeadersAndFooters(r._values),filteredValues:r.isFiltered?n.removeHeadersAndFooters(r._filteredValues):null,silent:!0}),s=n.group(null,null,null,!1,null==t?void 0:t.silent)),n._idMap=null,s}get unfilteredGroupRecords(){const e=this;if(e.isGrouped){var t;const{generation:n}=e.storage;(null===(t=e._unfilteredGroupRecords)||void 0===t?void 0:t.generation)!==n&&(e._unfilteredGroupRecords=e.storage.allValues.filter((e=>e.isSpecialRow)),e._unfilteredGroupRecords.generation=n)}return e._unfilteredGroupRecords||[]}getGroupHeaderForRecord(e,t=!1){if(this.isGrouped)return e?e.meta.groupRowFor?e:e.groupParent.get(this.id):this.groupRecords.last}includeCollapsed(){for(const e of this.collapsedGroups)this.expand(this.getById(e),!1)}excludeCollapsed(){for(const e of this.collapsedGroups)this.collapse(this.getById(e))}onDataChange({source:e,action:t,removed:n}){var r;const s=this,{groupers:i}=s;i&&(i.length?("splice"===t&&null!=n&&n.length||"move"===t)&&e.replaceValues({...s.prepareGroupRecords(),silent:!0}):e.replaceValues({values:s.removeHeadersAndFooters(e._values),filteredValues:e.isFiltered?s.removeHeadersAndFooters(e._filteredValues):null,silent:!0})),null===(r=super.onDataChange)||void 0===r||r.call(this,...arguments)}move(e,t){const n=this;if(n.isGrouped&&!n.tree){var r,s;let i=t;if(null!==(r=t)&&void 0!==r&&r.isSpecialRow&&(i=n.getPrev(t,!1,!1),!i))return;const a=n.getGroupHeaderForRecord(i),o=n.groupers[0].field,l=a.meta.groupRowFor,{reapplyFilterOnUpdate:c}=n;if(n.reapplyFilterOnUpdate=!1,n.beginBatch(),e.forEach((e=>e.setValue(o,l))),n.endBatch(),n.reapplyFilterOnUpdate=c,n.isFiltered&&null!==(s=t)&&void 0!==s&&s.isSpecialRow){const{unfilteredGroupRecords:e}=n,r=e.indexOf(a);t=e[r+1]}}super.move(e,t)}collapse(e){return!(!e||e.meta.collapsed)&&(this.excludeGroupRecords(e),e.meta.collapsed=!0,this.collapsedGroups.add(e.id),this.trigger("toggleGroup",{groupRecord:e,collapse:!0}),!0)}expand(e,t=!0){return!(null==e||!e.meta.collapsed)&&(this.includeGroupRecords(e),e.meta.collapsed=!1,t&&this.collapsedGroups.delete(e.id),t&&this.trigger("toggleGroup",{groupRecord:e,collapse:!1}),!0)}removeHeadersAndFooters(e){return e.filter((e=>{var t;return e.unfilteredGroupChildren&&(e.groupChildren.length=e.unfilteredGroupChildren.length=e.meta.childCount=0),!(e.isSpecialRow||e.isLinked&&null!==(t=e.groupParent)&&void 0!==t&&t.get(this.id))||(this.unregister(e),!1)}))}prepareGroupRecords(){var e;const t=this,{GroupRow:n,isFiltered:r,reapplyFilterOnUpdate:s,groupRecords:i}=t,a=t.groupers[0],o=!1!==a.ascending?1:-1,{field:l,fn:c=ui}=a,d="function"==typeof l,u=l===t.modelClass.idField,h=new ni,g=t._groupVisibleRecordIds||[],m=e=>{const n=!r||t.filtersFunction(e);return s?n:n||g.includes(e.id)},p=Boolean(t.startGroupsCollapsed&&!(null!=i&&i.count));null==i||i.forEach((e=>{e.isCollapsed&&t.includeGroupRecords(e)}));const f=t.removeHeadersAndFooters(t.storage._values);if(t.sorters.length&&f.sort(t.sorterFn),r&&(t.filtersFunction=null),f.forEach((e=>{const r=e,s=d?l(e):e[l],a=ge.asArray(null==s?"__novalue__":s),o=Array.isArray(a)&&!a.length,c=o?1:a.length;for(let s=0;s<c;s++){const c=o?[]:a[s],d=`group-header-${"number"==typeof c?c:T.createId(c)}`;let g=h.get(d);if(g||(g=(null==i?void 0:i.get(d))||new n({[t.modelClass.idField]:d,[u?"":l]:c,_groupValue:c},t,{collapsed:p,specialRow:!0,groupRowFor:c,groupField:l,emptyArray:o}),h.add(g),g.meta.childCount=0,g.groupChildren=[],g.unfilteredGroupChildren=[],g.stores=[t]),t.register(g),s>0){const n=r.groupLinks||(r.groupLinks=[]);(e=n[c]||(n[c]=r.link())).stores=[t],t.register(e)}e.groupParent||e.setData("groupParent",new Map),e.groupParent.set(t.id,g),m(e)&&(g.groupChildren.push(e),g.meta.childCount++),g.unfilteredGroupChildren.push(e)}})),h._values.sort(((e,t)=>c(e,t)*o)),t.useGroupFooters)for(let e=0,r=h.count;e<r;e++){const s=h.values[e],i=s.meta.groupRowFor,a=`group-footer-${"number"==typeof i?i:T.createId(i)}`,o=t.getById(a)||new n({[t.modelClass.idField]:a,[u?"":l]:i,_groupValue:i},t,{specialRow:!0,groupFooterFor:i,groupRecord:s});o.stores=[t],t.register(o),o.groupChildren=s.groupChildren,h.splice(++e,0,o),r++,s.groupChildren.push(o),s.unfilteredGroupChildren.push(o),s.meta.childCount++}t._idMap=null;const v={values:h.reduce(((e,t)=>(t.isGroupFooter||(e.push(t),t.meta.collapsed||e.push(...t.unfilteredGroupChildren)),e)),!1,[])};return r&&(v.filteredValues=v.values.filter(m)),null===(e=t.groupRecords)||void 0===e||e.forEach((e=>{h.includes(e)||e.destroy()})),t.groupRecords=h,v}get isGrouped(){var e;return Boolean(null===(e=this.groupers)||void 0===e?void 0:e.length)}group(e,t,n=!1,r=!0,s=!1){const i=this;let a,o;if(e&&"object"==typeof e&&(t=e.ascending,o=e.fn,e=e.field),n)i.groupers.push(a={field:e,ascending:t,complexMapping:e.includes(".")});else if(e){var l,c;if(null==t)t=(null===(l=i.groupInfo)||void 0===l?void 0:l.field)!==e||(null===(c=i.groupInfo)||void 0===c?void 0:c.fn)!==o||!i.groupInfo.ascending;i.groupInfo=a={field:e,ascending:t,fn:o,complexMapping:e.includes(".")},i.groupers=[i.groupInfo]}if(a){const{prototype:t}=i.modelClass;a.complexMapping&&!Object.prototype.hasOwnProperty.call(t,e)&&Object.defineProperty(t,e,{get(){return Ut.getPath(this,e)}})}if(!1!==r){if(i.remoteSort&&!i.isRemoteDataLoading)return i.sort(null,null,!1,!0).then((()=>i.onAfterGrouping(s)));i.sort(null,null,!1,!0)}i.onAfterGrouping(s)}onAfterGrouping(e){if(e)return;const t=this,n=t.groupers||[];t.trigger("group",{isGrouped:t.isGrouped,groupers:n,records:t.storage.values}),t.trigger("refresh",{action:"group",isGrouped:t.isGrouped,groupers:n,records:t.storage.values})}addGrouper(e,t=!0){return this.group(e,t,!0)}removeGrouper(e){const t=this,{groupers:n}=t;if(!n)return;const r=n.findIndex((t=>t.field===e));return r>-1?(n.splice(r,1),n.length?t.group():t.clearGroupers()):void 0}clearGroupers(e=!1){return this.setGroupers(null,{silent:e})}isRecordInGroup(e,t){var n;if(!this.isGrouped)return null;const r=null===(n=this.groupers[0])||void 0===n?void 0:n.field;return e.getValue(r)===t&&!e.isSpecialRow}isInCollapsedGroup(e){const t=e.groupParent.get(this.id);return null==t?void 0:t.meta.collapsed}getGroupRecords(e){return this.isGrouped?this.storage.values.filter((t=>this.isRecordInGroup(t,e))):null}getGroupTitles(){return this.isGrouped?this.getDistinctValues(this.groupers[0].field):null}onDataChanged({changes:e,action:t}){this.isGrouped&&(!e&&di[t]||e&&this.groupers.some((t=>t.field in e)))&&this.sort()}internalIncludeExcludeGroupRecords(e,t){const n=this,r=n.indexOf(e),s=n.allIndexOf(e),{id:i,storage:a}=n,{_filteredValues:o,_values:l}=a,{meta:c,groupChildren:d,unfilteredGroupChildren:u}=e;-1===s||c.collapsed&&!t||!c.collapsed&&t||(u.forEach((e=>e.instanceMeta(i).hiddenByCollapse=!t)),t?(o&&o.splice(r+1,0,...d.filter((e=>!n.isAvailable(e)))),a._values.splice(s+1,0,...u.filter((e=>!n.isAvailable(e))))):(o&&o.splice(r+1,d.length),l.splice(s+1,u.length)),a._indicesInvalid=!0,n._idMap=null)}excludeGroupRecords(e){this.internalIncludeExcludeGroupRecords(e,!1)}includeGroupRecords(e){this.internalIncludeExcludeGroupRecords(e,!0)}collectGroupRecords(e,t=!0){return(e?this.storage.allValues:this.storage.values).reduce(((e,n)=>(n.isSpecialRow&&(t&&!n.isGroupFooter&&e.push(n),n.isGroupHeader&&e.push.apply(e,n.groupChildren)),e)),[])}},gi=e=>class extends(e||ue){static get configurable(){return{objectify:null}}initProxy(){if(!globalThis.Proxy)throw new Error("Proxy not supported");return new Proxy(this,{get(e,t){if(t in e)return e[t];if("$store"===t)return e;let n=e.getById(t);return n||isNaN(parseInt(t))||(n=e.getAt(parseInt(t))),n},set:(e,t,n)=>(t in e||e.isDestroying||"_triggered"===t?e[t]=n:e.add({[e.modelClass.idField]:t,...n}),!0),deleteProperty:(e,t)=>e.isDestroying?(delete e[t],!0):Boolean(e.remove(t).length),has(e,t){if(t in e)return!0;if(t.startsWith("{")&&t.endsWith("}")){const e=T.safeJsonParse(t);t=null==e?void 0:e.id}return e.includes(t)}})}},mi=e=>class extends(e||ue){static $name="StoreRelation";initRelations(e){const t=this,n=t.modelClass.exposedRelations;e&&t.modelRelations&&t.modelRelations.forEach((e=>{var t;return null===(t=e.storeDetacher)||void 0===t?void 0:t.call(e)})),t.modelRelations&&0!==t.modelRelations.length&&!e||!n||(t.modelRelations=[],null==n||n.forEach((n=>{const r={...n},{foreignStore:s,relationName:i,relatedCollectionName:a}=r,o="string"==typeof s?t[s]:s;if(r.dependentStore=t,t.modelRelations.push(r),o){r.foreignStoreProperty=r.foreignStore,r.foreignStore=o;const n=o.dependentStoreConfigs;if(n.has(t)){const s=n.get(t);if(e){const e=s.find((e=>e.relationName===i));e&&ge.remove(s,e)}s.push(r)}else n.set(t,[r]);a&&o.initRelationCollection(r,t),o.count>0&&o.updateDependentStores("dataset",o.records)}})))}initRelationCollection(e,t){const n=this,r=e.relatedCollectionName;(n.collectionStores||(n.collectionStores={}))[r]={store:t,config:e},n[r+"Store"]||(n[r+"Store"]=t),n.count>0&&n.initModelRelationCollection(r,n.allRecords)}initModelRelationCollection(e,t){const n=this;t.forEach((t=>{t.traverse((t=>{const r=e in t?`$related${T.capitalize(e)}`:e;Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:function(){return n.getCollection(this,e)},set:function(t){return n.setCollection(this,e,t)}})}))}))}resetRelationCache(){this.relationCache={},this.forEach((e=>e.initRelations()))}updateRecordRelationCache(e,t){null==t||t.forEach((t=>{const{config:n}=t,r=t.related?t.related.id:e.getValue(n.foreignKey);void 0!==r&&this.cacheRelatedRecord(e,r,n.relationName,r)}))}getRelationCollection(e,t){var n;const r=Ns.asId(t);return(null===(n=this.relationCache[e])||void 0===n?void 0:n[r])||[]}getCollection(e,t){var n;const{config:r,store:s}=this.collectionStores[t];return(null===(n=s.relationCache[r.relationName])||void 0===n?void 0:n[e.id])||[]}setCollection(e,t,n){const{config:r,store:s}=this.collectionStores[t],i=((s.relationCache[r.relationName]||(s.relationCache[r.relationName]={}))[e.id]||[]).slice(),a=[],o=[];s.suspendEvents(),i.forEach((e=>{n.includes(e)||(e[r.foreignKey]=null,s.remove(e),o.push(e))})),n.forEach((t=>{t.isModel instanceof Ns?t.stores.includes(s)||(s.add(t),a.push(t)):([t]=s.add(t),a.push(t)),t[r.foreignKey]=e.id})),s.resumeEvents(),o.length&&(s.trigger("remove",{records:o}),s.trigger("change",{action:"remove",records:o})),a.length&&(s.trigger("add",{records:a}),s.trigger("change",{action:"add",records:a}))}cacheRelatedRecord(e,t,n,r=null){const s=this,i=s.relationCache[n]||(s.relationCache[n]={});null!==r&&s.uncacheRelatedRecord(e,n,r),null!=t&&ge.include(i[t]||(i[t]=[]),e)}uncacheRelatedRecord(e,t=null,n=null){const r=this;function s(t,n){const s=r.relationCache[t],i=null==s?void 0:s[n];if(i){const t=i.indexOf(e);t>=0&&i.splice(t,1),0===i.length&&delete s[n]}}null!=n?s(t,n):e.meta.relationCache&&Object.entries(e.meta.relationCache).forEach((([e,t])=>s(e,null==t?void 0:t.id)))}updateDependentStores(e,t){this.dependentStoreConfigs.forEach((n=>{n.forEach((n=>{const{dependentStore:r,relatedCollectionName:s,relationName:i,foreignKey:a}=n,o=r.relationCache[i];return"dataset"===e?(s&&this.initModelRelationCollection(s,t),void r.forEach((e=>{const t=e.initRelation(n);t&&r.cacheRelatedRecord(e,t.id,i,t.id)}))):"removeall"===e?(r.forEach((e=>e.removeRelation(n))),void delete r.relationCache[i]):("replace"===e&&(t=t.map((e=>e[1]))),"add"!==e&&"replace"!==e||s&&this.initModelRelationCollection(s,t),void("add"!==e&&"replace"!==e&&"remove"!==e||t.forEach((t=>{const s=null==o?void 0:o[t.id];switch(e){case"remove":s&&s.forEach((e=>e.removeRelation(n)));break;case"add":case"replace":r.forEach((e=>{e.getValue(a)==t.id&&(e.initRelation(n),r.cacheRelatedRecord(e,t.id,i))}))}}))))}))}))}updateDependentRecordIds(e,t){var n;null===(n=this.dependentStoreConfigs)||void 0===n||n.forEach((n=>{n.forEach((n=>{var r;const{dependentStore:s,relationName:i,foreignKey:a}=n,o=s.relationCache[i],l=null==o||null===(r=o[e])||void 0===r?void 0:r.slice();null==l||l.forEach((n=>{s.cacheRelatedRecord(n,t,i,e),n.set(a,t,!1,!0)}))}))}))}},pi=e=>class extends(e||ue){static get $name(){return"StoreSum"}sum(e,t=this.storage.values){return t?t.reduce(((t,n)=>{if(n.isSpecialRow)return t;const r=Number(n.getValue(e));return isNaN(r)?t:t+r}),0):0}min(e,t=this.storage.values){return null!=t&&t.length?t.reduce(((t,n)=>{const r=n.getValue(e);return"number"===typeof(null==r?void 0:r.valueOf())&&r<t&&(t=r),t}),t[0].getValue(e)):0}max(e,t=this.storage.values){return null!=t&&t.length?t.reduce(((t,n)=>{const r=n.getValue(e);return"number"===typeof(null==r?void 0:r.valueOf())&&r>t&&(t=r),t}),t[0].getValue(e)):0}average(e,t=this.storage.values){if(null==t||!t.length)return 0;let n=0;const r=t.reduce(((t,r)=>{if(r.isSpecialRow)return t;const s=parseFloat(r.getValue(e));return isNaN(s)?t:(n++,t+s)}),0);return n>0?r/n:0}groupSum(e,t){return this.sum(t,this.getGroupRecords(e))}};const fi=(e,t)=>String(e).toLowerCase().includes(t),vi={string:fi,number:fi,boolean:fi,date:(e,t)=>e instanceof Date&&t instanceof Date?e-t==0:String(e.getMonth()+1).includes(t)||String(e.getDate()).includes(t)||String(e.getFullYear()).includes(t),object:(e,t)=>e===t,undefined:(e,t)=>e===t};var yi=e=>class extends(e||ue){static get $name(){return"StoreSearch"}search(e,t=null,n,r){const s=this.isTree&&!r?this.rootNode.allChildren:this.getAllDataRecords(r),i=s.length,a=[];if(null==e)return[];let o,l,c,d,u,h;for("string"==typeof e&&(e=e.toLowerCase()),o=0;o<i;o++){c=s[o],l=0;for(const r of t||c.fieldNames){var g;d=c.getValue(r),u=d instanceof Date?"date":typeof d;const t=null==n?void 0:n[l];t&&(d=t(d),u="string"),h=vi[u],d&&null!==(g=h)&&void 0!==g&&g(d,e)&&a.push({index:o,data:c,field:r,id:c.id}),l++}}return a}findByField(e,t,n=!1,r=!1){const s=this.getAllDataRecords(r),i=s.length,a=new Set,o=[];let l,c,d;for(null!=t&&(t=String(t).toLowerCase()),l=0;l<i;l++)if(c=s[l],d=c.getValue(e),!n||!a.has(d)){const e=d instanceof Date?"date":typeof d;(null==t&&d===t||""===t&&""===d||t&&(0,vi[e])(d,t))&&(o.push({id:c.id,index:l,data:c}),n&&a.add(d))}return o}find(e,t=!1){return this.getAllDataRecords(t).find(e)}findRecord(e,t,n=!1){const r=n=>Ut.isEqual(n[e],t);return this.isTree?this.query(r,n)[0]:this.getAllDataRecords(n).find(r)}query(e,t=!1){if(this.isTree){const n=[];return this.traverse((t=>{e(t)&&n.push(t)}),void 0,void 0,t),n}return this.getAllDataRecords(t).filter(e)}some(e,t=!1){return this.getAllDataRecords(t).some(e)}},bi=e=>class extends(e||ue){static get $name(){return"StoreSort"}static get defaultConfig(){return{useLocaleSort:null}}static get configurable(){return{sorters:[],reapplySortersOnAdd:!1}}get isSorted(){return Boolean(this.sorters.length)||this.isGrouped}changeSorters(e){return e.map((e=>this.normalizeSorterConfig(e,!0)))}updateReapplySortersOnAdd(e){this.storage.autoSort=e}sort(e,t,n=!1,r=!1){const s=this,i=s.allRecords,a=s.sorters?s.sorters.slice():[];let o,l=null;if(e)if(Array.isArray(e))s.sorters=e.map((e=>s.normalizeSorterConfig(e,"string"==typeof e||t)));else{const r=s.normalizeSorterConfig(e,t);n?(o=s.getCurrentSorterByField(r.field),o?(l=o.ascending,o.ascending=r.ascending):s.sorters.push(r)):s.sorters=[r]}return r||!1!==s.trigger("beforeSort",{sorters:s.sorters,records:i,currentSorters:a})?s.performSort(r):(s.sorters=a,null!==l&&(o.ascending=l),null)}normalizeSorterConfig(e,t){const n=this,r={ascending:t};if("object"==typeof e?(Ut.assign(r,e),e.fn&&(delete r.fn,r.sortFn=e.fn),r.ascending=e.ascending??t):"function"==typeof e?r.sortFn=e:r.field=e,null==r.ascending){const e=n.getCurrentSorterByField(r.field);r.ascending=!e||!e.ascending}if(null==r.sortFn){var s,i;const e=null===(s=n.modelClass)||void 0===s||null===(i=s.$meta.fields.map[r.field])||void 0===i?void 0:i.compareItems;e&&(r.sortFn=e)}return r}getCurrentSorterByField(e){return"string"==typeof e&&this.sorters.find((t=>t.field===e))||null}addSorter(e,t=!0){return this.sort(e,t,!0)}removeSorter(e){const t=this.sorters.findIndex((t=>t.field===e||t.sortFn===e));if(t>-1)return this.sorters.splice(t,1),this.sort()}clearSorters(e=!1){if(this.sorters.length)return this.sorters.length=0,this.sort(void 0,void 0,void 0,e)}createSorterFn(e){const t=this.useLocaleSort;return(n,r)=>{for(let s=0;s<e.length;s++){const i=e[s],{field:a,ascending:o=!0,useLocaleSort:l=t}=i,c=i.fn||i.sortFn,d=o?1:-1;if(c){const e=c.call(i,n,r);if(0===e)continue;if(null!==e)return e*d}const u=n.isModel?n.getValue(a):n[a],h=r.isModel?r.getValue(a):r[a];if(u!==h){if(null==u)return-d;if(null==h)return d;if(l&&"string"==typeof u){if(!0===l)return String(u).localeCompare(h)*d;if("string"==typeof l)return String(u).localeCompare(h,l)*d;if("object"==typeof l)return String(u).localeCompare(h,l.locale,l)*d}if(u>h)return d;if(u<h)return-d}}return 0}}get sorterFn(){return this.createSorterFn(this.remoteSort?[{field:"_remoteSortIndex"}]:this.sorters)}performSort(e){const t=this,{rootNode:n,storage:r,sorterFn:s}=t;t.tree?(!t.isChained&&n.traverse((e=>{e.isLoaded&&e.isParent&&(e.children.sort(s),e.updateChildrenIndices(e.children,"parentIndex",!0))})),r.replaceValues({values:t.collectDescendants(n).visible,silent:!0})):t.isGrouped?r.replaceValues({...t.prepareGroupRecords(),silent:!0}):r.replaceValues({values:r.values.sort(s),silent:!0}),t.afterPerformSort(e||t.isRemoteDataLoading)}afterPerformSort(e){if(e)return;const t=this;t._idMap=null;const n={action:"sort",sorters:t.sorters,records:t.allRecords};t.trigger("sort",n),t.trigger("refresh",n)}};const Ci=()=>!0;var Si=e=>class extends(e||ue){static get $name(){return"StoreChained"}static get defaultConfig(){return{chainedFilterFn:null,chainedFields:null,masterStore:null,doRelayToMaster:["add","remove","insert"],dontRelayToMaster:[],excludeCollapsedRecords:!0,chainSuspended:0}}static get properties(){return{chainedStores:null}}construct(e){super.construct(e);const t=this,{masterStore:n}=t,r=t.syncOrder?"sort":"";n&&(t.methodNamesToRelay.forEach((e=>t[e]=(...n)=>t.relayToMaster(e,n))),t.removeAll=(...e)=>{n.remove(t.getRange(),...e)},n.ion({changePreCommit:t.onMasterDataChangedPreCommit,change:t.onMasterDataChanged,[r]:t.onMasterDataChanged,prio:1,thisObj:t}),n.chainedStores||(n.chainedStores=[]),n.chainedStores.push(t),t.fillFromMaster())}get $master(){return this.masterStore||this}get isChained(){return Boolean(this.masterStore)}set chainedFilterFn(e){this._chainedFilterFn=this.thisObj?e.bind(this.thisObj):e}get chainedFilterFn(){return this._chainedFilterFn||Ci}get methodNamesToRelay(){const e=Array.isArray(this.doRelayToMaster),t=Array.isArray(this.dontRelayToMaster);return e&&this.doRelayToMaster.filter((e=>!t||!this.dontRelayToMaster.includes(e)))||[]}updateChainedStores(){this.chainedStores&&this.chainedStores.forEach((e=>e.fillFromMaster()))}fillFromMaster(){const e=this,{masterStore:t,isTree:n}=e;let r=[];if(!e.isChained)throw new Error("fillFromMaster only allowed on chained store");if(!e.isChainSuspended){if(t.isGrouped&&t.isFiltered?t.forEach((e=>r.push(e)),t,{includeFilteredOutRecords:!0,includeCollapsedGroupRecords:!0}):r=t.allRecords.filter((t=>!t.isSpecialRow&&e.chainedFilterFn(t))),n&&(e.idRegister={},e.internalIdRegister={},r.forEach((t=>{t.stores.includes(e)?e.register(t):t.joinStore(e)})),e.excludeCollapsedRecords)){const t=e.getChildren(e.rootNode);r=e.doIncludeExclude(t,!0)}e.isFillingFromMaster=!0,e.data=r,e.isFillingFromMaster=!1}}commitToMaster(){const e=this,t=e.masterStore;if(!e.isChained)throw new Error("commitToMaster only allowed on chained store");return t.beginBatch(),t.remove(e.removed.values),t.add(e.added.values),t.endBatch(),e.commit()}relayToMaster(e,t){return this.masterStore[e](...t)}onMasterDataChangedPreCommit(e){this.onMasterDataChanged(e),this.$masterEventhandled=!0}onMasterDataChanged({action:e,changes:t,$handled:n,isMove:r}){var s;this.$masterEventhandled?this.$masterEventhandled=!1:r&&"remove"===e||("update"!==e||null!==(s=this.chainedFields)&&void 0!==s&&s.some((e=>e in t)))&&this.fillFromMaster()}makeChained(e=Ci,t,n){if(this.isChained){const t=e;e=e=>t(e)&&this.chainedFilterFn(e)}return new((null==n?void 0:n.storeClass)||this.constructor)({storeId:void 0,id:`${this.id}-chained-${T.generateUUID()}`,...n||{},tree:!1,autoTree:!1,masterStore:this.$master,modelClass:this.modelClass,syncDataOnLoad:!1,chainedFilterFn:e,chainedFields:t})}chain(){return this.makeChained(...arguments)}doDestroy(){var e;null===(e=this.chainedStores)||void 0===e||e.forEach((e=>e.destroy())),super.doDestroy()}suspendChain(){this.chainSuspended++}resumeChain(e=!1){this.chainSuspended&&!--this.chainSuspended&&e&&this.fillFromMaster()}get isChainSuspended(){return this.chainSuspended>0}},wi=e=>class extends(e||ue){static get $name(){return"StoreState"}getState(){const{sorters:e,groupers:t,filters:n}=this,r={};return null!=e&&e.length&&(r.sorters=e.map((e=>{const t=Ut.cleanupProperties(Ut.clone(e));return delete t.fn,delete t.sortFn,t}))),null!=t&&t.length&&(r.groupers=t.map((e=>{const t=Ut.cleanupProperties(Ut.clone(e));return delete t.fn,t}))),null!=n&&n.values.length&&(r.filters=n.values.map((e=>{const t=Ut.cleanupProperties(Ut.clone(e.config));return t.value=e.value,t.caseSensitive&&delete t.caseSensitive,t}))),r}applyState(e){const t=this,{sorters:n=[],groupers:r=[],filters:s=[]}=e,{sortParamName:i,filterParamName:a}=t;t.sorters=n.filter((e=>e.field||e.sortFn&&!i)),t.groupers=r.slice(),t.sort(),t.filters=s.filter((e=>e.property||e.filterBy&&!a)),t.filter()}};const Di=e=>String(e).padStart(6,"0");class Ti{constructor(e){this.value=e,this._padded=null}set value(e){this._value=String(e??"")}get value(){return this._value}static from(e){return null==e||e instanceof Ti?e:new Ti(e)}static pad(e){return e instanceof Ti?e.valueOf():Ti.split(e).map(Di).join(".")}static split(e){let t,n;if(e||0===e)switch(typeof e){case"object":e=String(e);case"string":for(n=e.split("."),t=n.length;t-- >0;)n[t]=parseInt(n[t],10);break;case"number":n=[e]}return n||[]}static compare(e,t){return e===t?0:e&&t?(e=Ti.pad(e))<(t=Ti.pad(t))?-1:t<e?1:0:e?1:t?-1:0}append(e){const t=this.value;return Ti.from(t?`${t}.${e}`:e)}isEqual(e){return!Ti.compare(this,e)}match(e){let t=!1;if(e){const n=this.value,r="*"===e[0],s=e.endsWith("*"),i=e.length;t=r===s?n.indexOf(r?e.substr(1,i-2):e)>-1:r?n.endsWith(e.substr(1)):n.startsWith(e.substr(0,i-1))}return t}toString(){return this.value}toJSON(){return this.toString()}valueOf(){return this._padded??(this._padded=Ti.pad(this.value))}}Ti._$name="Wbs";const Ei=Object.freeze([]),xi=Symbol("StopBranch");var ki=e=>class extends(e||ue){static $name="StoreTree";static StopBranch=xi;get StopBranch(){return xi}static configurable={transformFlatData:null,fireRemoveEventForMoveAction:P.checkVersion("core","6.0","<")};get isTree(){return this.tree||this.masterStore&&this.masterStore.tree}get leaves(){const e=this,t=[];return e.isTree?(e.traverse((e=>{e.isLeaf&&t.push(e)})),t):(e.allRecords.forEach((e=>{e.isLeaf&&t.push(e),e.traverse((e=>{e.isLeaf&&t.push(e)}),!0)})),t)}async loadChildren(e){}onNodeAddChild(e,t,n,r,s=!1){const i=this,a=e===i.rootNode&&e.isLoading,{storage:o}=i,{previousSibling:l}=t[0];let c;const{visible:d,all:u}=i.collectDescendants(t,void 0,void 0,{inCollapsedBranch:!(e.isExpanded(i)&&e.ancestorsExpanded(i)),applyFilter:i.isFiltered&&i.reapplyFilterOnAdd});if(!a&&u.length)for(const e of u)i.modified.includes(e)||r[e.id]||(i.removed.includes(e)?i.removed.remove(e):e.isLinked||i.added.add(e));var h;if(a&&i.rootVisible&&(d.unshift(e),u.unshift(e)),d.length?(c=0!==n&&l?o.indexOf(l)+l.getDescendantCount(!0,i):o.indexOf(e),o.suspendEvents(),i.storage.splice(++c,0,d),o.resumeEvents(),i._idMap=null):i._allRecords=null,i.updateDependentStores("add",t),a&&d.length){if(i.sorters.length&&i.sort(null,null,!1,!0),null===(h=i.afterLoadData)||void 0===h||h.call(i),!s){const e={action:"dataset",data:i._data,records:d};i.trigger("refresh",e),i.trigger("change",e)}}else if(!s){const n={action:"add",parent:e,isChild:!0,isMove:r,records:t,allRecords:u,index:c};if(i.trigger("add",n),i.trigger("change",n),Object.values(r).some((e=>e))){const n={newParent:e,records:t.filter((e=>r[e.id])),oldParents:t.map((e=>i.getById(e.meta.oldParentId)))};i.trigger("move",n)}}}onNodeRemoveChild(e,t,n,r={isMove:!1,silent:!1,unfiltered:!1}){const s=this,{storage:i}=s,a=[],o=[],{isMove:l,silent:c,unfiltered:d}=r,u=d&&s.isFiltered,h=u&&e.unfilteredChildren?e.unfilteredChildren:t;if(s.collectDescendants(h,a,o,{inCollapsedBranch:!(e.isExpanded(s)&&e.ancestorsExpanded(s)),unfiltered:u}),!l){for(const e of t)e.unjoinStore(s);for(const e of o)e.stores.includes(s)&&e.unjoinStore(s),s.added.includes(e)?s.added.remove(e):e.isLinked||s.removed.add(e);s.modified.remove(o)}if(a.length?(n=i.indexOf(a[0]))>-1&&(i.suspendEvents(),i.splice(n,a.length),i.resumeEvents(),s._idMap=null):(n=-1,s._allRecords=null),!c&&(s.fireRemoveEventForMoveAction||!l)){const r={action:"remove",parent:e,isChild:!0,isMove:l,records:t,allRecords:o,index:n};s.trigger("remove",r),s.trigger("change",r)}return o}collectDescendants(e,t=[],n=[],r={}){const s=this,{inCollapsedBranch:i=!1,unfiltered:a=!1,applyFilter:o=!1}=r,l=Array.isArray(e)?e:s.getChildren(e,a)??[];if(o)return{visible:l.flatMap((e=>this.collectVisibleNodeDescendantsFiltered(e))),all:l.flatMap((e=>e.allChildren))};for(let e,r=0,o=l.length;r<o;r++)e=l[r],i||t.push(e),n.push(e),s.collectDescendants(e,t,n,{inCollapsedBranch:i||!e.isExpanded(s),unfiltered:a});return{visible:t,all:n}}collectVisibleNodeDescendantsFiltered(e){const t=e.unfilteredChildren||e.children;if(!t||0===t.length||!e.isLeaf&&!e.isExpanded(this))return this.filtersFunction(e)?[e]:[];const n=t.flatMap((e=>this.collectVisibleNodeDescendantsFiltered(e)));return n.length||this.filtersFunction(e)?[e,...n]:[]}getChildren(e,t=!1){const n=this,r=(t||n.isChained)&&e.unfilteredChildren||e.children;return null!=r&&r.length?n.isChained?r.filter(n.chainedFilterFn).sort(n.sorterFn):r:Ei}internalToggleTreeSubRecords(e,t){const n=this,{storage:r}=n,s=r.indexOf(e),i=n.doIncludeExclude(n.getChildren(e),t);if(n.isFiltered&&t&&e.unfilteredChildren&&n.updateChildrenHiddenState(e),i.length&&!1!==s){if(r.suspendEvents(),t){r.splice(s+1,0,...i);const e={action:"add",isExpand:!0,records:i,index:s+1};n.trigger("add",e),n.trigger("change",e)}else{r.splice(s+1,i.length);const e={action:"remove",isCollapse:!0,records:i,index:s+1};n.trigger("remove",e),n.trigger("change",e)}r.resumeEvents(),n._idMap=null}}updateChildrenHiddenState(e){var t;null===(t=e.unfilteredChildren)||void 0===t||t.forEach((e=>{e.instanceMeta(this.id).hidden=!1,e.isLeaf||this.updateChildrenHiddenState(e)}))}doIncludeExclude(e,t,n=[]){const r=this,s=(null==e?void 0:e.length)||0;for(let i=0;i<s;i++){const s=e[i];if(!r.isChained||r.chainedFilterFn(s)){const e=s.instanceMeta(r.id);!t&&e.hidden||n.push(s),e.hidden=!t,s.isExpanded(r)&&r.doIncludeExclude(r.getChildren(s),t,n)}}return n}async toggleCollapse(e,t){const n=this,r=n.getById(e),s=r.instanceMeta(n);if(void 0===t&&(t=!s.collapsed),!s.isLoadingChildren&&!r.isLeaf&&r.isExpanded(n)===t){if(n.trigger("beforeToggleNode",{record:r,collapse:t}),s.collapsed=t,s.collapsed)return n.onNodeCollapse(r),!0;{n.onNodeExpand(r);let e=!0;if(!r.isLoaded){s.isLoadingChildren=!0;try{await n.loadChildren(r)}catch(t){s.collapsed=!0,e=!1,n.trigger("loadChildrenException",{record:r,exception:t})}finally{s.isLoadingChildren=!1}}return e}}}onNodeCollapse(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!1)}onNodeExpand(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!0)}transformToTree(e){const{parentIdField:t,idField:n,childrenField:r}=this.modelClass,s=new Map,i=new Set,a=[];for(const t of e){const e=t[n];null!=e&&s.set(e,t)}const o=e=>{const t=Object.assign({},e);return t[r]=[],s.set(t[n],t),i.add(e[n]),t};for(let l of e){const e=l[n];l=i.has(e)?s.get(e):o(l);const c=l[t];if(null!=c){let e=s.get(c);e&&(e[r]||(e=o(e)),e[r].push(l))}else l[r]?a.push(l):null!=l[n]?a.push(o(l)):a.push(l)}return s.forEach((e=>{var t,n;null===(t=(n=e[r]).sort)||void 0===t||t.call(n,((e,t)=>e.parentIndex-t.parentIndex))})),a}treeify(e,t,n=!1){const{length:r}=e,s=[],i=[],a={};let o,l;for(o=0;o<r;o++){let t=e[o];t=t.field||t,e[o].call||(e[o]=e=>e[t],e[o].fieldName=t),s[o]=new Map}this.rootNode.traverse((t=>{if(l=[],t.isLeaf){for(o=0;o<r;o++){var n,a;const r=(null===(n=l[(null===(a=l)||void 0===a?void 0:a.length)-1])||void 0===n?void 0:n.path)||"",i=s[o],c=ge.asArray(e[o](t))||[],d=[];if(c[0]===xi)break;for(let n=0,{length:s}=c;n<s;n++){const s=c[n],a=`${r+(null!=s&&s.isModel?s.id:s)}/`,l=T.makeValidDomId(`generated_${a}`,"_"),u=e[o].fieldName,h=i.get(l)||i.set(l,{id:l,key:s,path:a,expanded:!0,readOnly:!0,children:[],generatedParent:!0,field:u,firstGroupChild:t}).get(l);d.push(h)}l.forEach((e=>{d.forEach((t=>{e.children.includes(t)||e.children.push(t)}))})),l=d}l.length?l.forEach(((e,n)=>e.children.push(n?t.link():t))):i.push(t)}}),!0),(t||n)&&s.forEach((e=>e.forEach(((e,r,s)=>{null==t||t(e),n&&(e=this.createRecord(e),s.set(r,e))})))),a.children=[...s[0].values(),...i];const c=t=>{t.children&&(t.children.sort(((t,n)=>{if(t.isLeaf===n.isLeaf){if(t.isLeaf){let s;for(let i=0;!s&&i<r;i++){const r=e[i](t),a=e[i](n);if(r===xi||a===xi)return t.isLeaf<n.isLeaf?-1:t.isLeaf>n.isLeaf?1:0;s=r<a?-1:a>r?1:0}return s}return"string"==typeof t.key&&"string"==typeof n.key?t.key.localeCompare(n.key,void 0,{numeric:!0}):t.key<n.key?-1:t.key>n.key?1:0}return t.isLeaf<n.isLeaf?-1:t.isLeaf>n.isLeaf?1:0})),t.children.forEach(c))};return c(a),a}treeifyFlatData(e){const{childrenField:t,parentIdField:n}=this.modelClass;let r=!1,s=!0;for(const i of e){if(i.isModel||Array.isArray(i[t])){s=!1;break}null!=i[n]&&(r=!0)}return s&&r&&(e=this.transformToTree(e)),e}async indent(e){const t=this;if((e=(e=Array.isArray(e)?e:[e]).filter((t=>{let n=Boolean(t.previousSibling);for(;n&&!t.isRoot;)n=!e.includes(t.parent),t=t.parent;return n}))).length&&!1!==t.trigger("beforeIndent",{records:e})){e.sort(((e,t)=>Ti.compare(e.wbsCode,t.wbsCode))),t.beginBatch();for(const n of e){const e=n.previousSibling;e.appendChild(n),t.toggleCollapse(e,!1)}t.endBatch(),t.trigger("indent",{records:e}),t.trigger("change",{action:"indent",records:e})}}async outdent(e){const t=this;if((e=(e=Array.isArray(e)?e:[e]).filter((t=>{const{parent:n}=t;let r=n&&!n.isRoot;for(;r&&!t.isRoot;)r=!e.includes(n),t=t.parent;return r}))).length&&!1!==t.trigger("beforeOutdent",{records:e})){e.sort(((e,t)=>Ti.compare(e.wbsCode,t.wbsCode))),t.beginBatch();for(const n of e){const{parent:e}=n,r=e.children.slice(e.children.indexOf(n)+1);e.parent.insertChild(n,e.nextSibling),n.appendChild(r),t.toggleCollapse(n,!1)}t.endBatch(),t.trigger("outdent",{records:e}),t.trigger("change",{action:"outdent",records:e})}}};class Ii{static preWalk(e,t,n){const r=[e];let s,i;for(;r.length;)s=r.pop(),n(s),i=t(s),i&&r.push.apply(r,i.slice().reverse())}static preWalkWithParent(e,t,n){const r=[{node:e,parent:null}];for(;r.length;){const{parent:e,node:s}=r.pop();n(e,s);const i=t(s);Array.isArray(i)&&r.push(...i.slice().reverse().map((e=>({node:e,parent:s}))))}}static preWalkUnordered(e,t,n){const r=[e];let s,i;for(;r.length;)s=r.pop(),n(s),i=t(s),i&&r.push.apply(r,i)}static postWalk(e,t,n){const r=new Map,s=[e];let i,a;for(;s.length;)i=s[s.length-1],r.has(i)?(n(i),s.pop()):(a=t(i),a&&s.push(...a.slice().reverse()),r.set(i,i))}static prePostWalk(e,t,n,r){const s=new Map,i=[e];let a,o;for(;i.length;)a=i[i.length-1],s.has(a)?(r(a),i.pop()):(n(a),o=t(a),o&&i.push(...o.slice().reverse()),s.set(a,a))}}Ii._$name="WalkHelper";var Ri=e=>class extends(e||ue){static get $name(){return"StoreSync"}static get configurable(){return{syncDataOnLoad:null,shouldSyncDataset:null,shouldSyncRecord:null}}syncDataset(e){var t;const n=this,{storage:r}=n,s=null===(t=n.shouldSyncDataset)||void 0===t?void 0:t.call(n,{data:e});if(!1===s)return;n.trigger("startApplyChangeset"),n.isSyncingDataOnLoad=!0;const{toAdd:i,toRemove:a,toMove:o,updated:l,ids:c}=n.tree?n.syncTreeDataset(e,s):n.syncFlatDataset(e,s);let{threshold:d}=n.syncDataOnLoad,u=!1;if(d&&("string"==typeof d&&(d=parseInt(d,10)/100*n.count),u=i.length+a.length+o.length+l.length>d),n.tree){if(i.length){n.add(i,u).forEach((e=>e.clearParentId()))}if(o.length)for(const{parent:e,node:t,index:r}of o){n.getById(e.id).insertChild(t,r)}n.remove(a,u)}else u&&n.suspendEvents(),n.remove(a),n.add(i),u&&n.resumeEvents();d&&!u&&l.forEach((({record:e,toSet:t,wasSet:r})=>n.onModelChange(e,t,r))),n.acceptChanges();const h={added:i,removed:a,updated:l,thresholdSurpassed:u};if(n.isFiltered&&!n.remoteFilter&&n.filter({silent:n.isRemoteDataLoading}),n.isGrouped)n.group(null,null,!1,!0,n.isRemoteDataLoading);else if(n.isSorted)n.remoteSort?r.replaceValues({values:r.values.sort(n.createSorterFn(n.sorters)),silent:!0}):n.sort();else if(n.tree){let e=!1,t=0;Ii.preWalk(n.rootNode,(t=>Array.isArray(t.children)&&!e?t.children:null),(n=>{n.id!==c[t++]&&(e=!0)})),e&&(n.sort(((e,t)=>c.indexOf(e.id)-c.indexOf(t.id)),void 0,void 0,!0),n.clearSorters(!0),!u&&n.afterPerformSort())}else r.values.some(((e,t)=>e.id!==c[t]))&&(r.replaceValues({values:r.values.sort(((e,t)=>c.indexOf(e.id)-c.indexOf(t.id))),silent:!0}),!u&&n.afterPerformSort());u&&n.trigger("refresh",{action:"batch",data:e,records:r.values,syncInfo:h}),n.isSyncingDataOnLoad=!1,n.trigger("endApplyChangeset"),n.trigger("loadSync",h)}syncFlatDataset(e,t){if(!e)return{toRemove:this.records};const n=this,{idField:r,allFields:s}=n.modelClass,i=[],a=[],o=[],l={},c=[],d=Array.isArray(t),{threshold:u,keepMissingValues:h}=n.syncDataOnLoad;let g=0;if(e.forEach((e=>{const i=(e=e.isModel?e.data:e)[r],m=n.getById(i);var p;if(!d||t.includes(i))if(m){if(!1!==(null===(p=n.shouldSyncRecord)||void 0===p?void 0:p.call(n,{record:m,data:e}))){var f,v;if(null===(f=n.beforeSyncRecord)||void 0===f||f.call(n,{record:m,data:e}),!1===h)for(const t of s)!(t.dataSource in e)&&t.dataSource in m.data&&(e[t.dataSource]=t.defaultValue);const t=m.set(e,null,Boolean(u));t&&o.push({record:m,wasSet:t,toSet:e}),null===(v=n.afterSyncRecord)||void 0===v||v.call(n,{record:m,data:e})}}else a.push(n.processRecord(n.createRecord(e)));m&&g++,l[i]=1,c.push(i)})),g<n.allRecords.filter((e=>!e.isSpecialRow)).length)if(t)for(const e of t)l[e]||i.push(n.getById(e));else n.forEach((e=>{l[e.id]||i.push(e)}),n,{includeFilteredOutRecords:!0,includeCollapsedGroupRecords:!0});return{toAdd:a,toRemove:i,toMove:[],updated:o,ids:c}}syncTreeDataset(e){if(!e)return{toRemove:this.records};const t=this,{idField:n,parentIdField:r,childrenField:s,allFields:i}=t.modelClass,{keepMissingValues:a,threshold:o}=t.syncDataOnLoad,l=[],c=[],d=[],u=[],h=new Set,g=[];return t.transformFlatData&&(e=t.treeifyFlatData(e)),Ii.preWalkWithParent({isRoot:!0,id:t.rootNode.id,children:e},(e=>e.children),((e,l)=>{if(e){const{id:p,node:f}=t.resolveSyncNode(l);var m;if(f){if(!1!==(null===(m=t.shouldSyncRecord)||void 0===m?void 0:m.call(t,{record:f,data:l}))){let r;const c=f.children;if(!0!==c&&!0===l[s]&&(f.clearChildren(),f.data[s]=f.children=!0,delete l[s],t.toggleCollapse(f,!0),r=!0),f.parent.id!==e[n]&&d.push({node:f,parent:e,index:e[s].indexOf(l)}),!1===a)for(const e of i)"parentId"!==e.name&&!(e.dataSource in l)&&e.dataSource in f.data&&(l[e.dataSource]=e.defaultValue);"boolean"==typeof l.expanded&&this.toggleCollapse(f,!l.expanded);const h=f.set(l,null,Boolean(o));h?u.push({record:f,wasSet:h,toSet:l}):r&&f.signalNodeChanged({[s]:{value:!0,oldValue:c}})}}else l[r]=e[n],c.push({...l,...Array.isArray(l[s])?{children:[]}:void 0});h.add(f),g.push(p)}})),h.length!==e.length&&t.traverse((e=>{h.has(e)||l.push(e)})),{toAdd:c,toRemove:l,toMove:d,updated:u,ids:g}}resolveSyncNode(e){const t=e[this.modelClass.idField];return{id:t,node:this.getById(t)}}};const Mi=Symbol("STM_PROP");var Oi=e=>class extends(e||ue){static get $name(){return"StoreStm"}static get defaultConfig(){return{stm:null,ignoreRemoteChangesInSTM:!1}}get stm(){return this[Mi]}set stm(e){const t=this;var n;t.stm!==e&&(null!==(n=t.stm)&&void 0!==n&&n.hasStore(t)&&t.stm.removeStore(t),t[Mi]=e,t.stm&&!t.stm.hasStore(t)&&t.stm.addStore(t))}add(e,t=!1,n={}){let r;const{stm:s}=this;var i;!this.tree&&null!=s&&s.enabled?(r=super.add(e,t),null!==(i=r)&&void 0!==i&&i.length&&s.onStoreModelAdd(this,r,t)):r=super.add(e,t,n);return r}insert(e,t,n=!1){let r;const{stm:s}=this;if(!this.tree&&null!=s&&s.enabled){var i;const a=(Array.isArray(t)?t:[t]).reduce(((e,t)=>{const n=t instanceof Ns?this.indexOf(t):void 0;return void 0!==n&&-1!==n&&e.set(t,n),e}),new Map);r=super.insert(e,t),null!==(i=r)&&void 0!==i&&i.length&&(e=this.indexOf(r[0]),s.onStoreModelInsert(this,e,r,a,n))}else r=super.insert(e,t,n);return r}remove(e,t=!1,n){let r;const{stm:s}=this;if(!this.tree&&null!=s&&s.enabled){var i;const a=(Array.isArray(e)?e:[e]).map((e=>this.getById(e))).filter((e=>!!e)).reduce(((e,t)=>{const n=this.indexOf(t);return void 0!==n&&-1!==n&&e.set(t,n),e}),new Map);r=super.remove(e,t,n),null!==(i=r)&&void 0!==i&&i.length&&s.onStoreModelRemove(this,r,a,t)}else r=super.remove(e,t,n);return r}removeAll(e){const{stm:t}=this;let n;if(null!=t&&t.enabled){const{tree:r,rootNode:s,allRecords:i}=this,a=i.length,o=r?s.children.slice():i.slice();n=super.removeAll(e),a&&0===this.count&&t.onStoreRemoveAll(this,o,e)}else n=super.removeAll(e);return n}beforeApplyChangeset(){const{stm:e,crudManager:t}=this;let n=!1,r=null;return null!=t&&t.applyingChangeset||null==e||!e.enabled||(n=!0,e.isRecording&&(r=e.stash()),this.ignoreRemoteChangesInSTM?e.disable():e.startTransaction()),{shouldResume:n,transactionId:r}}applyChangeset(e,t,n,r,s){const{shouldResume:i,transactionId:a}=this.beforeApplyChangeset(),o=super.applyChangeset(e,t,n,r,s);return this.afterApplyChangeset(i,a),o}afterApplyChangeset(e,t){if(e){const{stm:e}=this;this.ignoreRemoteChangesInSTM?e.enable():e.stopTransaction(),e.applyStash(t)}}};const Ai={splice:1,clear:1},Fi={includeFilteredOutRecords:!1,includeCollapsedGroupRecords:!1},Pi=(e,t)=>("boolean"==typeof(t=t||!1)&&(t={includeFilteredOutRecords:t,includeCollapsedGroupRecords:!1}),t||Fi);class Li extends(ue.mixin(Ur,rs,Ne,jr,es,ci,li,oi,mi,pi,yi,bi,hi,Si,wi,ki,Oi,Ri,gi)){static get $name(){return"Store"}static get properties(){return{relationCache:{},dependentStoreConfigs:new Map,addingClean:!1}}static get configurable(){return{id:!0,modelClass:Ns,verifyNoGeneratedIds:!0}}static get defaultConfig(){return{fields:null,autoTree:!0,data:null,tree:!1,callOnFunctions:!0,storage:null,useRawData:!1,allowNoId:!0,preventSubClassingModel:null,storeClass:null}}static get identifiable(){return{registerGeneratedId:!1}}constructor(...e){if(super(...e),this.objectify)return this.initProxy()}construct(e={}){Object.assign(this,{added:new ai,removed:new ai,modified:new ai,idRegister:{},internalIdRegister:{},oldIdMap:{}}),e.storeId&&(e=Ut.assign({id:e.storeId},e)),super.construct(e),this.initRelations()}static from(e,t={},n=null){return e&&!e.isStore&&("string"==typeof e?e=Li.getStore(e):(Array.isArray(e)?(n&&(e=e.map((e=>e.isModel?e:n(e)))),e=Ut.assign({},t,{data:e})):e=Ut.assign({},t,e),e=new Li(e))),e}doDestroy(){var e,t,n;const r=this,s=r.registeredRecords;null===(e=r.stm)||void 0===e||null===(t=e.removeStore)||void 0===t||t.call(e,r);for(let e,t=s.length-1;t>=0;t--){var i;e=s[t],null!==(i=e)&&void 0!==i&&i.isDestroyed||e.unjoinStore(r)}var a;(null===(n=r._storage)||void 0===n||n.destroy(),r.isChained)||(null===(a=r.rootNode)||void 0===a||a.destroy());super.doDestroy()}beginBatch(){this.suspendEvents()}endBatch(){if(this.resumeEvents()){const{values:e}=this.storage;this.trigger("refresh",{action:"batch",data:e,records:e})}}set storage(e){const t=this;null!=e&&e.isCollection?t._storage=e:t._storage=new ni(e),t._storage.autoFilter=t.reapplyFilterOnAdd,t._storage.autoSort=t.reapplySortersOnAdd;for(const e of t._storage)e.joinStore(t);t._storage.ion({change:"onDataChange",thisObj:t})}get storage(){return this._storage||(this.storage={}),this._storage}get allRecords(){var e;const t=this;if((null===(e=t._allRecords)||void 0===e?void 0:e.generation)!==t.storage.generation){if(t.isTree){const e=t.collectDescendants(t.rootNode,void 0,void 0,{unfiltered:!0}).all;t.rootVisible&&e.unshift(t.rootNode),t._allRecords=e}else t._allRecords=t.isGrouped?t.collectGroupRecords():t.storage.allValues;t._allRecords.generation=t.storage.generation}return t._allRecords}getAllDataRecords(e){const t=this;return t.tree?e?t.allRecords:t.rootNode.allChildren:t.isGrouped?t.collectGroupRecords(e,!1):e?t.storage.allValues:t.storage.values}onIsCreatingToggle(e,t){const n=this,r=e.isPersistable&&!t;n.added[r?"add":"remove"](e),r&&(n.trigger("addConfirmed",{record:e}),n.autoCommit&&n.doAutoCommit())}joinRecordsToStore(e){const{allCount:t}=this;for(let n=0;n<e.length;n++){const r=e[n];r.setData("parentIndex",t+n-e.length),r.joinStore(this)}}onDataChange({source:e,action:t,added:n,removed:r,replaced:s,oldCount:i,items:a,from:o,to:l}){const c=this,d=Ai[t],u=d&&(null==n?void 0:n.length),h=d&&(null==r?void 0:r.length);let g,m;if(c._idMap=null,u&&c.joinRecordsToStore(n),null==s||s.forEach((([e,t])=>{e.unjoinStore(c,!0),t.joinStore(c)})),super.onDataChange(...arguments),!c.isTree){if(u){for(const e of n)c.removed.includes(e)?c.removed.remove(e):c.addingClean||e.isLinked||c.added.add(e);g=!c.remoteFilter&&c.isFiltered&&c.reapplyFilterOnAdd,g&&c.filter({silent:!0}),m=!c.remoteSort&&c.isSorted&&c.reapplySortersOnAdd,m&&c.sort(null,null,!1,!0)}if(h){for(const e of r)e.cancelBatch(),e.unjoinStore(c),c.added.includes(e)?c.added.remove(e):e._undoingInsertion||e.isCreating||e.isLinked||c.removed.add(e);c.modified.remove(r),g=!c.remoteFilter&&c.isFiltered,g&&c.filter({silent:!0})}}switch(t){case"clear":c.relationCache={},c.updateDependentStores("removeall"),c.trigger("removeAll"),c.trigger("change",{action:"removeall"});break;case"splice":if(u){c.updateDependentStores("add",n);const t=n.reduce(((e,t)=>{const{previousIndex:n}=t.meta;return n>-1&&n<e&&(e=n),e}),n[0].meta.previousIndex),r={records:n,index:e.indexOf(n[0],!e.autoFilter)};t>-1&&(r.oldIndex=t),c.trigger("add",r),c.trigger("change",Object.assign({action:"add"},r)),g&&c.triggerFilterEvent({action:"filter",filters:c.filters,oldCount:i,records:c.storage.allValues}),m&&c.trigger("sort",{action:"sort",sorters:c.sorters,records:c.storage.allValues})}r.length&&(c.updateDependentStores("remove",r),c.trigger("remove",{records:r}),c.trigger("change",{action:"remove",records:r})),s.length&&(c.updateDependentStores("replace",s),c.trigger("replace",{records:s,all:c.records.length===s.length}),c.trigger("change",{action:"replace",replaced:s,all:c.records.length===s.length}));break;case"filter":(c.isGrouped||c.isSorted)&&c.performSort(!0);break;case"move":{const e=Math.min(o,l),n=Math.min(c.storage.allValues.length-1,Math.max(o,l));for(let t=c.storage.allValues,r=e;r<=n;r++)t[r].setData("parentIndex",r);c.trigger("move",{record:a[0],records:a,from:o,to:l}),c.isFiltered&&c.performFilter(),c.trigger("change",{action:t,record:a[0],records:a,from:o,to:l});break}}}onDataReplaced(e,t){var n;const r=this,{storage:s}=r,i=s.allValues,a=Boolean(r.sorters.length>0);for(let e=0;e<i.length;e++)i[e].joinStore(r);if(!r.remoteFilter&&r.isFiltered&&r.filter({silent:!0}),r.remoteSort?r.isGrouped&&s.replaceValues({...r.prepareGroupRecords(),silent:!0}):(r.isGrouped&&r.group(null,null,!1,!a,!0),a&&r.sort(null,null,!1,!0)),!r.useRawData.disableDuplicateIdCheck){const{idMap:e}=r;if(Object.keys(e).length<s.values.length){const t=[];throw s.values.forEach((n=>e[n.id]?delete e[n.id]:t.push(n))),new Error(`Id collision on ${t.map((e=>e.id))}`)}}const o={action:e,data:t,records:s.values};r.updateDependentStores(e,o.records),null===(n=r.afterLoadData)||void 0===n||n.call(r),r.isRemoteDataLoading||r.trigger("refresh",o),r.trigger("change",o)}onModelChange(e,t,n,r,s){const i=this,a={record:e,records:[e],changes:n,batch:null!=e.batching,fromRelationUpdate:s},o=!e.ignoreBag&&!e.isLinked&&i.updateModifiedBagForRecord(e);if(i.storage.onItemMutation(e,n),"id"in n){const{oldValue:n,value:r}=t.id;i.updateDependentRecordIds(n,r),i.onRecordIdChange({record:e,oldValue:n,value:r})}if(!r){if("id"in n){const{oldValue:n,value:r}=t.id;i.trigger("idChange",{store:i,record:e,oldValue:n,value:r})}i.onUpdateRecord(e,n),i.trigger("update",a),i.trigger("change",Object.assign({action:"update"},a))}i.autoCommit&&o&&i.doAutoCommit()}updateModifiedBagForRecord(e){const t=this;let n=!1;return e.isModified?t.modified.includes(e)||t.added.includes(e)||!e.isPartOfStore(t)||e.isRoot||(e.isPhantom?t.added.add(e):t.modified.add(e),n=!0):t.modified.remove(e),n}get idMap(){const e=this,t=!e._idMap,n=e._idMap||(e._idMap={});if(t){const t=e.storage.values;for(let e,r=0,s=0;r<t.length;r++)e=t[r],n[e.id]={index:r,visibleIndex:s,record:e},e.isSpecialRow||s++;if(e.isFiltered)for(let t=0,r=e.storage._values.length;t<r;t++){const r=e.storage._values[t];r.id in n?n[r.id].unfilteredIndex=t:n[r.id]={index:-1,unfilteredIndex:t,record:r}}}return n}changeModelClass(e){const{fields:t}=this;this.originalModelClass=e;let n=e;if(null!=t&&t.length){class r extends e{static get fields(){return t}}n=r}else if(!this.preventSubClassingModel){class t extends e{}n=t}return n.initClass(),n}set storeId(e){this.id=e}get storeId(){return this.id}changeId(e,t){return super.changeId(!0!==e&&e,t)}updateId(e,t){const n=Li.getById(e);n&&Li.unregisterInstance(n),super.updateId(e,t)}generateAutoId(){return Li.generateId("store-")}get tree(){return this._tree}set tree(e){this._tree=e,e&&!this.rootNode&&(this.rootNode=this.buildRootNode(),this.rootNode.isAutoRoot=!0)}buildRootNode(){return{}}static getStore(e,t){if(e instanceof Li)return e;if(this.getById(e))return this.getById(e);if(Array.isArray(e)){let n;const r=e.map((e=>(e instanceof Ns?n=e.constructor:"string"==typeof e&&(e={text:e}),e)));if(!n){class e extends Ns{}n=e}e={autoCreated:!0,data:r,modelClass:n,allowNoId:!0},t||(t=Li)}return t?new t(e):void 0}static get stores(){return Li.registeredInstances}get rootNode(){return this.masterStore?this.masterStore.rootNode:this._rootNode}set rootNode(e){var t;const n=this,r=n._rootNode;e!==r&&(r&&(n.clear(!0),n.removed.clear()),e instanceof Ns?(e.instanceMeta(n).collapsed=!1,n._rootNode=e):n._rootNode=e=new n.modelClass(Object.assign({expanded:!0,[n.modelClass.idField]:`${n.id}-rootNode`},e),n,null,!0),n._tree=!0,e.isRoot=!0,e.joinStore(n),(null!==(t=e.children)&&void 0!==t&&t.length||n.rootVisible)&&(e.isLoading=!0,n.onNodeAddChild(e,e.children||[],0),e.isLoading=!1),n.trigger("rootChange",{oldRoot:r,rootNode:e}))}set data(e){this.setStoreData(e)}setStoreData(e){var t,n;const r=this,{idField:s,childrenField:i}=r.modelClass;if(r.transformFlatData&&(null===(t=e)||void 0===t?void 0:t.length)>0&&!Object.isExtensible(e[0])&&(r.useRawData=r.useRawData||{disableDuplicateIdCheck:!1,disableDefaultValue:!1,disableTypeConversion:!1},e=Ut.clone(e)),r.getConfig("plugins"),r.processConfiguredListeners(),e&&!Array.isArray(e)&&(e=Ut.transformNamedObjectToArray(e,s)),r.tree=!r.isChained&&(r.tree||Boolean(r.autoTree&&(null===(n=e)||void 0===n?void 0:n.some((e=>e[i]))))),e&&(r.remoteSort||r.remoteFilter))for(let t=0;t<e.length;t++)e[t]._remoteSortIndex=t;if(r.syncDataOnLoad&&r._data)r.syncDataset(e);else{if(r._data=e,r.tree){r.transformFlatData&&(e=r.treeifyFlatData(e));const t=r.rootNode;if(t.isLoading=!0,r.clear(!0),t.appendChild(e),r.updateDependentStores("dataset",[t]),t.isLoading=!1,0===e.length){const e={action:"dataset",data:[],records:[]};r.trigger("refresh",e),r.trigger("change",e)}else r.isFiltered&&r.filter()}else r.loadData(e);r.added.clear(),r.removed.clear(),r.modified.clear()}}loadData(e,t="dataset"){const n=this,{storage:r,allowNoId:s}=n,i=n.modelClass.fieldMap.id.dataSource,a=n.find((e=>e.isCreating));a&&r.values.splice(n.records.indexOf(a),1);let o=n.verifyNoGeneratedIds;if(n.removeHeadersAndFooters(n.storage.values),n._idMap=null,n.oldIdMap={},e){if(!(e[0]instanceof Ns)){n.modelClass.exposeProperties(e[0]);const t=e.length,a=new Array(t);for(let r=0;r<t;r++){var l,c,d;const t=e[r];if(!s&&null==t[i])throw new Error(`Id required but not found on row ${r}`);o&&null!==(l=t[i])&&void 0!==l&&null!==(c=(d=l).startsWith)&&void 0!==c&&c.call(d,"_generated")&&(console.warn(`Generated id found in data: ${t[i]}. Generated ids are temporary and should be replaced with real ids by the backend`),o=!1),a[r]=n.processRecord(n.createRecord(t,!0),!0),a[r].setData("parentIndex",r)}n.clear(!0),r.replaceValues({values:a,isNewDataset:!0,silent:!0})}else n.clear(!0),r.replaceValues({values:e.slice(),isNewDataset:!0,silent:!0});a&&!r.values.includes(a)&&r.values.push(a),n._data=e,n.onDataReplaced(t,e)}else n.clear(!0),n._data=null;n.isSyncingDataOnLoad=!1}get data(){return this._data}getRange(e,t,n=!0){return(n?this.storage.allValues:this.storage.values).slice(e,t)}createRecord(e,t=!1,n=!1){return new this.modelClass(e,this,null,t,!1,n)}processRecord(e,t=!1){return e}refreshData(){this.filter(),this.sort()}onRecordIdChange({record:e,oldValue:t,value:n}){const r=this,s=r._idMap,{idRegister:i,oldIdMap:a}=r;if(r.storage._indicesInvalid=!0,a[t]=e,s&&!s[n]){const e=s[t];delete s[t],s[n]=e}r.added.changeId(t,n),r.removed.changeId(t,n),r.modified.changeId(t,n),delete i[t],i[n]=e,e.index=r.storage.indexOf(e)}onUpdateRecord(e,t){const n=this,{internalId:r}=t,{internalIdRegister:s}=n;r&&(this.storage._indicesInvalid=!0,delete s[r.oldValue],s[r.value]=e),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}get useRawData(){return this._useRawData}set useRawData(e){this._useRawData=!0===e?{enabled:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0,disableDefaultValue:!1}:e?Object.assign(e,{enabled:!0}):{enabled:!1}}getCount(e=!0){return e?this.count:this.originalCount}get originalCount(){var e;return this.storage.totalCount-((null===(e=this.groupRecords)||void 0===e?void 0:e.count)||0)}get count(){return this.storage.count}get allCount(){return this.isTree?this.rootNode.descendantCount:this.storage.totalCount}get records(){return this.storage.values}get first(){return this.storage.values[0]}get last(){return this.storage.values[this.storage.values.length-1]}getAt(e,t=!1){return this.storage.getAt(e,t)}register(e){const t=this;if(!t.useRawData.disableDuplicateIdCheck){const n=t.isTree&&t.idRegister[e.id];if(n&&n!==e)throw new Error(`Id collision on ${e.id}`)}t.idRegister[e.id]=e,t.internalIdRegister[e.internalId]=e}unregister(e){delete this.idRegister[e.id],delete this.internalIdRegister[e.internalId]}get registeredRecords(){return Object.values(this.idRegister)}getById(e){if(null!=e&&e.isModel){const t=e;return t.hasLinks&&!this.storage.allValues.includes(t)?t.$links.find((e=>this.storage.allValues.includes(e))):t}return this.idRegister[e]}isAvailable(e){const t=this.getById(e);return t&&this.storage.includes(t)||!1}getByInternalId(e){return this.internalIdRegister[e]}includes(e){return this.isTree?null!=this.idRegister[Ns.asId(e)]:this.indexOf(e)>-1}indexOf(e,t=!1,n=!1){if(null!=e&&e.isModel&&!e.stores.includes(this.$store||this)){const n=e.$links.find((e=>this.storage.allValues.includes(e)));return n?this.indexOf(n,t):-1}if(this.isTree)return(n?this.rootNode.allChildren:this.storage.values).indexOf(this.getById(e));const r=Ns.asId(e);if(null==r)return-1;const s=this.idMap[r];return s?s[t?"visibleIndex":"index"]:-1}allIndexOf(e){return this.isTree?this.allRecords.indexOf(this.getById(e)):this.storage.indexOf(e,!0)}getDistinctValues(e,t=!1){const n=[],r={};let s;return this.forEach((t=>{if(!t.isSpecialRow&&!t.isRoot){s=t.getValue(e);const i=s instanceof Date?s.getTime():s;r[i]||(n.push(s),r[i]=1)}}),this,{includeCollapsedGroupRecords:!0,includeFilteredOutRecords:t}),n}getValueCount(e,t){let n=0;return this.forEach((r=>{Ut.isEqual(r.getValue(e),t)&&n++})),n}set json(e){"string"==typeof e&&(e=T.safeJsonParse(e)),this.data=e}get json(){return T.safeJsonStringify(this)}get formattedJSON(){return T.safeJsonStringify(this,null,4)}toJSON(){return(this.isTree?this.rootNode.unfilteredChildren||this.rootNode.children||[]:this.allRecords).map((e=>e.toJSON()))}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.project}getInlineData(e){const t=[];var n;this.tree?null===(n=this.rootNode.children)||void 0===n||n.forEach((n=>t.push(n.getCurrentConfig(e)))):this.forEach((n=>t.push(n.getCurrentConfig(e))));return t}getCurrentConfig(e){const t=super.getCurrentConfig(e),{state:n}=this;var r;t&&(t.data&&(t.data=this.getInlineData(e)),delete t.project,delete t.stm,delete t.asyncEvents,(null===(r=t.modelClass)||void 0===r?void 0:r.$meta.hierarchy[t.modelClass.$meta.hierarchy.length-2])===this.constructor.defaultConfig.modelClass&&delete t.modelClass,this.tree||delete t.tree,n&&Object.assign(t,n));return t}forEach(e,t=this,n){const r=this,s=(n,r)=>{if(!n.isRoot&&!n.isSpecialRow)return e.call(t,n,r)};if(n=Pi(0,n),r.isTree)r.isChained&&(n={...n,sorterFn:r.sorterFn}),r.rootNode.traverseWhile(s,!1,n);else{const e=n.includeFilteredOutRecords?r.storage.allValues:r.storage.values;if(r.isGrouped&&n.includeCollapsedGroupRecords)for(let t=0;t<e.length;t++){const r=e[t],i=n.includeFilteredOutRecords?r.unfilteredGroupChildren:r.groupChildren;if(i&&!0===r.meta.collapsed)for(let e=0;e<i.length;e++){if(!1===s(i[e],e))return}else if(!1===s(r,t))return}else for(let t=0;t<e.length;t++)if(!1===s(e[t],t))return}}map(e,t=this){return this.storage.values.map(e,t)}flatMap(e,t=this){return this.storage.values.flatMap(e,t)}every(e,t=this,n){return this.storage[n?"allValues":"values"].every(e,t)}reduce(e,t=[],n=this){return n!==this&&(e=e.bind(n)),this.storage.values.reduce(e,t,n)}[Symbol.iterator](){return this.storage.values[Symbol.iterator]()}traverse(e,t=this.rootNode,n=t===this.rootNode,r){const s=this;if(r=Pi(0,r),s.isTree){if("boolean"==typeof t&&(n=t,t=s.rootNode),s.isChained){const t=e;e=e=>{s.chainedFilterFn(e)&&t(e)}}t.traverse(e,n,r)}else s.forEach((t=>t.traverse(e,!1,r)),s,r)}traverseWhile(e,t=this.rootNode,n=t===this.rootNode,r){const s=this;if(r=Pi(0,r),s.isTree){if("boolean"==typeof t&&(n=t,t=s.rootNode),s.isChained){const t=e;e=e=>{s.chainedFilterFn(e)&&t(e)}}t.traverseWhile(e,n,r)}else for(const t of s.storage)if(!1===t.traverse(e,!1,r))break}getNext(e,t=!1,n=!1){const r=this,s=r.storage.values;let i=r.indexOf(e);if(i>=s.length-1){if(!t)return null;i=-1}const a=s[i+1];return n&&a&&a.isSpecialRow?r.getNext(s[i+1],t,!0):a}getPrev(e,t=!1,n=!1){const r=this,s=r.storage.values;let i=r.indexOf(e);if(0===i){if(!t)return null;i=s.length}const a=s[i-1];return n&&a&&a.isSpecialRow&&i>0?r.getPrev(s[i-1],t,!0):a}getAdjacent(e,t=!0,n=!1,r=!1){return t?this.getNext(e,n,r):this.getPrev(e,n,r)}getNextLeaf(e,t=!1){const n=this.leaves,r=this.getById(e);let s=n.indexOf(r);if(s>=n.length-1){if(!t)return null;s=-1}return n[s+1]}getPrevLeaf(e,t=!1){const n=this.leaves,r=this.getById(e);let s=n.indexOf(r);if(0===s){if(!t)return null;s=n.length}return n[s-1]}getAdjacentLeaf(e,t=!0,n=!1){return t?this.getNextLeaf(e,n):this.getPrevLeaf(e,n)}}Li.initClass(),Li._$name="Store";const $i=(e,t)=>(Array.isArray(t[1])?t[1].forEach((n=>e.push(encodeURIComponent(t[0])+"="+encodeURIComponent(n)))):e.push(encodeURIComponent(t[0])+"="+encodeURIComponent(t[1])),e),_i=Promise.resolve(),Ni=e=>String(e).padStart(2,"0");class ji extends Li{static $name="AjaxStore";static get defaultConfig(){return{headers:null,fetchOptions:null,sendAsFormData:null,writeAllFields:null,parentIdParamName:"id",responseSuccessProperty:"success",responseDataProperty:"data",responseTotalProperty:"total",filterParamName:null,restfulFilter:!1,sortParamName:null,pageParamName:null,pageStartParamName:null,pageSizeParamName:"pageSize",useRestfulMethods:null,httpMethods:{create:"POST",read:"GET",update:"PUT",delete:"DELETE"}}}static configurable={params:null,pageSize:50};updatePageSize(e){const t=this;if(!this.isConfiguring){const n=t.currentPage=t.currentPage?Math.min(t.currentPage,Math.floor((t.allCount+e-1)/e)):1;e&&t.loadPage(n)}}afterConstruct(e){super.afterConstruct(e),this.autoLoad&&this.load().catch((()=>{}))}get isLoading(){return this._isLoading?2:!!this.loadTriggerPromise&&1}get isCommitting(){return Boolean(this.commitPromise)}set pageParamName(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageStartParamName)throw new Error("Configs pageStartParamName and pageParamName are mutually exclusive");this._pageParamName=e}get pageParamName(){return this._pageParamName}set pageStartParamName(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageParamName)throw new Error("Configs pageParamName and pageStartParamName are mutually exclusive");this._pageStartParamName=e}get pageStartParamName(){return this._pageStartParamName}get isPaged(){return this.pageParamName||this.pageStartParamName}get allCount(){return"remoteTotal"in this?this.remoteTotal:super.allCount}get lastPage(){if(this.isPaged)return Math.floor((this.allCount+this.pageSize-1)/this.pageSize)}buildQueryString(e,...t){const n=e.includes("?"),r=Object.entries(Object.assign({},...t)).reduce($i,[]).join("&");return r?(n?"&":"?")+r:""}async performSort(e){const t=this;if(t.remoteSort&&!t.isRemoteDataLoading){t.isRemoteDataLoading=!0;const n=await t.internalLoad({},"",(n=>{t.data=n.data,t.afterPerformSort(e)}));return t.isRemoteDataLoading=!1,n}super.performSort(e)}async performFilter(e){const t=this;if(t.remoteFilter){var n;null===(n=t.loadingPromise)||void 0===n||n.abort(),t.isRemoteDataLoading=!0;const r=t.count,{filters:s}=t;t.currentPage=1;const i=await t.internalLoad({},"",(n=>{t.data=n.data,n=e?null:{action:"filter",filters:s,oldCount:r,records:t.storage.values},t.afterPerformFilter(n),t.trigger("refresh",n)}));return t.isRemoteDataLoading=!1,i}super.performFilter(e)}encodeFilterParams(e){const t=[];for(const{property:n,operator:r,value:s,caseSensitive:i}of e)t.push({field:n,operator:r,value:s,caseSensitive:i});return JSON.stringify(t,(function(e,t){return""===e?t:this[e]instanceof Date?`${(n=this[e]).getFullYear()}-${Ni(n.getMonth()+1)}-${Ni(n.getDate())}T${Ni(n.getHours())}:${Ni(n.getMinutes())}:${Ni(n.getSeconds())}.${n.getMilliseconds()}`:t;var n}))}encodeSorterParams(e){return JSON.stringify(e.filter((e=>!e.sortFn)).map((e=>e)))}buildReadUrl(){const{readUrl:e}=this;if(this.restfulFilter&&this.filters.count){return(e.endsWith("/")?e:e+"/")+this.filters.first.value}return e}internalLoad(e,t,n,r=0){e=Ut.assign({},this.params,e);const s=this,i=s.buildReadUrl(),a={action:"read"+t,params:e,url:i};if(!i)throw new Error("No load url specified");if(!1===s.trigger("beforeLoad"+t,a))throw!1;return s.loadArgs=[i,a,e,t,n],!1===r?new Promise(((e,t)=>s.sendLoadRequest(e,t))):s.loadTriggerPromise||(s.loadTriggerPromise=new Promise(((e,t)=>{s.setTimeout({delay:r,fn:"sendLoadRequest",args:[e,t],cancelOutstanding:!0})})))}async sendLoadRequest(e,t){const n=this,[r,s,i,a,o]=n.loadArgs;if(n.loadTriggerPromise=null,r){if(n._isLoading=!0,n.trigger(`load${a}Start`,s),n.trigger("beforeRequest",s),n.filterParamName&&n.isFiltered&&(i[n.filterParamName]=n.encodeFilterParams(n.filters.values)),n.remoteSort&&n.isSorted&&(i[n.sortParamName]=n.encodeSorterParams(n.groupers?n.groupers.concat(n.sorters):n.sorters)),n.isPaged){if(!(n.pageParamName in i)&&!(n.pageStartParamName in i)){const e=Math.min(n.currentPage||1,n.allCount?n.lastPage:1/0);n.pageParamName?i[n.pageParamName]=e:i[n.pageStartParamName]=(e-1)*n.pageSize}i[n.pageSizeParamName]=n.pageSize}const r={headers:n.headers,parseJson:!0};n.useRestfulMethods&&(r.method=n.httpMethods.read,s.body&&(r.body=JSON.stringify(s.body)));try{const l=n.loadingPromise=Be.get(s.url+n.buildQueryString(s.url,i),Ut.assign(r,n.fetchOptions)),c=await l,d=c.parsedJson,u=Array.isArray(d),h=u||d&&!1!==Ut.getPath(d,n.responseSuccessProperty),g=u?null:Ut.getPath(d,n.responseTotalProperty);if(n.isDestroyed)return;if(n.loadingPromise=null,n._isLoading=!1,s.response=c,s.json=d,h){if(null!=g&&(n.remoteTotal=parseInt(g,10)),n.isPaged){if(!(n.remoteTotal>=0))throw new Error("A paged store must receive its responseTotalProperty in each data packet");{const e=n.pageParamName?i[n.pageParamName]:i[n.pageStartParamName]/n.pageSize+1;n.currentPage=Math.min(e,n.lastPage)}}s.data=u?d:Ut.getPath(d,n.responseDataProperty),await o(s),!n.isDestroyed&&n.trigger("load"+a,s),e(s)}else Object.assign(s,{exception:!0,exceptionType:"server",error:null==d?void 0:d.error}),!n.isDestroyed&&n.trigger("exception",s),t(s);!n.isDestroyed&&n.trigger("afterRequest",s)}catch(e){n._isLoading=!1,s.exception=!0,e instanceof Response?(s.exceptionType=e.ok?"server":"network",s.response=e,s.error=e.error):(s.exceptionType="server",s.error=e),!n.isDestroyed&&n.trigger("exception",s),t(s),!n.isDestroyed&&n.trigger("afterRequest",s)}}}async load(e){const t=this;return t.isPaged?t.loadPage(t.currentPage||1,e):t.internalLoad(e,"",(e=>{t.data=e.data}))}async loadChildren(e){return this.readUrl?this.internalLoad({[this.parentIdParamName]:e.id},"Children",(t=>{t.parentRecord=e,e.children.length&&e.clearChildren(!0),e.data[e.constructor.childrenField]=t.data,e.processChildren(e.stores)}),!1):this.immediatePromise}async loadPage(e,t){this.allCount&&(e=Math.min(e,this.lastPage));const n=this,r=n.pageParamName?{[n.pageParamName]:e}:{[n.pageStartParamName]:(e-1)*n.pageSize};return r[n.pageSizeParamName]=n.pageSize,n.internalLoad(Ut.assign(r,t),"Page",(e=>{n.loadData(e.data,"pageLoad")}))}async nextPage(e){const t=this;return t.isPaged&&t.currentPage!==t.lastPage?t.loadPage(t.currentPage+1,e):_i}async previousPage(e){return this.isPaged&&1!==this.currentPage?this.loadPage(this.currentPage-1,e):_i}async commit(){const e=this,{changes:t}=e,n=[];if(e.commitPromise)return!1;if(!t)return e.modified.count&&(e.modified.forEach((e=>e.clearChanges(!0,!1))),e.modified.clear()),_i;if(!1!==e.trigger("beforeCommit",{changes:t})){[...t.added,...t.modified,...t.removed].forEach((e=>e.meta.committing=!0)),e.trigger("commitStart",{changes:t});const r={action:"commit",exception:!1,changes:t};let s=e.commitRemoved(r);return s&&n.push(s),s=e.commitAdded(r),s&&n.push(s),s=e.commitModified(r),s&&n.push(s),n.length?(s=1===n.length?n[0]:Promise.all(n),e.commitPromise=new Promise(((n,i)=>{s.then((()=>{e.commitPromise=null,r.exception?(e.trigger("exception",r),i(r)):(e.trigger("commit",{changes:t}),n(r))})).catch((()=>{e.commitPromise=null,i(r)}))}))):(e.modified.forEach((e=>e.clearChanges(!0,!1))),e.modified.clear(),e.added.forEach((e=>e.clearChanges(!0,!1))),e.added.clear(),e.removed.clear(),e.trigger("commit",{changes:t}),_i)}}doAutoCommit(){this.suspendCount<=0&&this.commit().catch((e=>{const{response:t}=e;if(!t||!(t.ok&&t.parsedJson||[500,404].includes(t.status)))throw e}))}commitAdded(e){const t=this,n=t.added,r={action:"create",params:t.params};return n.count&&t.createUrl?new Promise((s=>{const i=n.values.map((e=>e.persistableData));e.create=r,r.body={data:i},t.trigger("beforeRequest",r);let a=r.body;if(t.sendAsFormData){const e=new FormData;e.append("data",JSON.stringify(i)),a=e}const o={headers:t.headers,parseJson:!0},l=t.createUrl+t.buildQueryString(t.createUrl,t.params);t.useRestfulMethods&&(o.method=t.httpMethods.create),Be.post(l,a,Ut.assign(o,t.fetchOptions)).then((i=>{const a=i.parsedJson,o=Array.isArray(a),l=o||a&&!1!==a.success;e.response=i,r.json=a,r.response=i,l?(t.processReturnedData(n.values,o?a:Ut.getPath(a,t.responseDataProperty)),n.clear(),t.trigger("commitAdded"),t.trigger("refresh",r),s(e)):(n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,e.exceptionType=r.exceptionType="server",t.trigger("exception",r),s(e)),t.trigger("afterRequest",r)})).catch((i=>{n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,i instanceof Response?(e.response=i,r.exceptionType=i.ok?"server":"network",r.response=i,r.error=i.error):(r.exceptionType="server",r.error=i),t.trigger("exception",r),s(e),t.trigger("afterRequest",r)}))})):null}commitModified(e){const t=this,{modified:n}=t.changes,r={action:"update",params:t.params},s=n.length&&t.updateUrl?new Promise((s=>{const i=n.map((e=>t.writeAllFields?e.persistableData:e.modificationDataToWrite)).filter((e=>!Ut.isEmpty(e)));if(0===i.length)return t.modified.clear(),n.forEach((e=>e.meta.committing=!1)),void s();e.update=r,r.body={data:i},t.trigger("beforeRequest",r);let a=r.body;if(t.sendAsFormData){const e=new FormData;e.append("data",JSON.stringify(i)),a=e}const o={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(o.method=t.httpMethods.update),Be.post(t.updateUrl+t.buildQueryString(t.updateUrl,t.params),a,Ut.assign(o,t.fetchOptions)).then((i=>{const a=i.parsedJson,o=Array.isArray(a),l=o||a&&!1!==a.success;e.response=i,r.json=a,r.response=i,l?(t.processReturnedData(n,o?a:Ut.getPath(a,t.responseDataProperty),!0),t.modified.clear(),t.trigger("commitModified"),t.trigger("refresh",r),s(e)):(n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),s(e)),t.trigger("afterRequest",r)})).catch((i=>{n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,i instanceof Response?(e.response=i,r.exceptionType=i.ok?"server":"network",r.response=i,r.error=i.error):(r.exceptionType="server",r.error=i),t.trigger("exception",r),s(e),t.trigger("afterRequest",r)}))})):null;return!n.length&&t.modified.count&&t.modified.clear(),s}processReturnedData(e,t,n=!1){const r=this,s=r.modelClass,i=s.fieldMap.id.dataSource;t.forEach(((t,a)=>{const o=e[a];o.clearChanges(!0,!1),o.syncId(t[i]),Object.assign(e[a].data,s.processData(t,n,r,o))}))}commitRemoved(e){const t=this,n=t.removed,r={action:"delete",params:t.params};return n.count&&t.deleteUrl?new Promise((s=>{e.delete=r,r.body={ids:n.map((e=>e.id))},t.trigger("beforeRequest",r);let i=r.body;if(t.sendAsFormData){const e=new FormData;e.append("id",JSON.stringify(i.ids)),i=e}const a={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(a.method=t.httpMethods.delete),Be.post(t.deleteUrl+t.buildQueryString(t.deleteUrl,t.params),i,Ut.assign(a,t.fetchOptions)).then((i=>{const a=i.parsedJson,o=Array.isArray(a)||a&&!1!==a.success;e.response=i,r.json=a,r.response=i,o?(n.forEach((e=>e.meta.committing=!1)),n.clear(),t.trigger("commitRemoved"),t.trigger("refresh",r),s(e)):(n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),s(e)),t.trigger("afterRequest",r)})).catch((i=>{n.forEach((e=>e.meta.committing=!1)),e.exception=r.exception=!0,i instanceof Response?(e.response=i,r.exceptionType=i.ok?"server":"network",r.response=i,r.error=i.error):(r.exceptionType="server",r.error=i),t.trigger("exception",r),s(e),t.trigger("afterRequest",r)}))})):null}get remoteFilter(){return Boolean(this.filterParamName||this.restfulFilter)}get remoteSort(){return Boolean(this.sortParamName)}}ji._$name="AjaxStore";class Vi{static get(e,t){const n=e._domData||(e._domData={});return null!=t?n[t]:n}static remove(e,t){const{_domData:n}=e,r=null==n?void 0:n[t];return null==n||delete n[t],r}static set(e,t,n){3===arguments.length?(e._domData||(e._domData={}))[t]=n:e._domData=t}static assign(e,t){Object.assign(e._domData||(e._domData={}),t)}}Vi._$name="DomDataStore";const Bi=()=>{throw new Error("Abstract method call!")},zi=()=>{throw new Error("Method cannot be called at this state!")};class Wi extends ue{canUndo(e){Bi()}canRedo(e){Bi()}onUndo(e){Bi()}onRedo(e){Bi()}onStartTransaction(e){Bi()}onStopTransaction(e){Bi()}onStopTransactionDelayed(e){Bi()}onRejectTransaction(e){Bi()}onEnable(e){Bi()}onDisable(e){Bi()}onAutoRecordOn(e){Bi()}onAutoRecordOff(e){Bi()}onResetQueue(e){Bi()}onModelUpdate(e){Bi()}onStoreModelAdd(e){Bi()}onStoreModelInsert(e){Bi()}onStoreModelRemove(e){Bi()}onStoreModelRemoveAll(e){Bi()}onModelInsertChild(e){Bi()}onModelRemoveChild(e){Bi()}}Wi._$name="StateBase";const Hi=Symbol("STATE_PROP"),Ui=Symbol("STORES_PROP"),Yi=Symbol("QUEUE_PROP"),qi=Symbol("POS_PROP"),Ki=Symbol("TRANSACTION_PROP"),Gi=Symbol("TRANSACTION_TIMER_PROP"),Xi=Symbol("AUTO_RECORD_PROP"),Zi=Symbol("IS_APPLYING_STASH");Object.freeze([Hi,Ui,Yi,qi,Ki,Gi,Xi,Zi]);const Ji=new Map;var Qi=(e,t)=>{Ji.set(e,t)},ea=e=>("string"==typeof e&&(e=Ji.get(e)),e);const ta=(e,t)=>{const{undo:n,redo:r}=t;let s;return s=n&&!r?{[Yi]:e[Yi].slice(e.position),[qi]:0}:r&&!n?{[Yi]:e[Yi].slice(0,e.position)}:{[Yi]:[],[qi]:0},[s,()=>{e.notifyStoresAboutQueueReset(t)}]};const na=new class extends Wi{canUndo(){return!1}canRedo(){return!1}onUndo(){zi()}onRedo(){zi()}onEnable(e){return e.autoRecord?"autoreadystate":"readystate"}onDisable(){zi()}onAutoRecordOn(){return{[Xi]:!0}}onAutoRecordOff(){return{[Xi]:!1}}onStartTransaction(){zi()}onStopTransaction(){zi()}onStopTransactionDelayed(){zi()}onRejectTransaction(){zi()}onResetQueue(e,t){return ta(e,t)}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}};Qi("disabledstate",na);const ra=Symbol("ACTION_QUEUE_PROP");class sa extends ue{get defaultConfig(){return{title:null}}construct(...e){this[ra]=[],super.construct(...e)}get queue(){return this[ra].slice(0)}get length(){return this[ra].length}addAction(e){this[ra].push(e)}undo(){const e=this[ra];for(let t=e.length-1;t>=0;--t)e[t].undo()}redo(){const e=this[ra];for(let t=0,n=e.length;t<n;++t)e[t].redo()}}sa._$name="Transaction";class ia extends Wi{canUndo(e){return 0<e.position&&e.position<=e.length}canRedo(e){return 0<=e.position&&e.position<e.length}onUndo(e,t){let n=e.position;const r=e[Yi],s=Math.max(0,n-t);return[{[Hi]:"restoringstate",[qi]:s},()=>{e.notifyStoresAboutStateRestoringStart();const t=[];for(;n!==s;){const e=r[--n];e.undo(),t.push(e)}return[e.autoRecord?"autoreadystate":"readystate",()=>{e.notifyStoresAboutStateRestoringStop({cause:"undo",transactions:t})}]}]}onRedo(e,t){let n=e.position;const r=e[Yi],s=Math.min(r.length,n+t);return[{[Hi]:"restoringstate",[qi]:s},()=>{e.notifyStoresAboutStateRestoringStart();const t=[];do{const e=r[n++];e.redo(),t.push(e)}while(n!==s);return[e.autoRecord?"autoreadystate":"readystate",()=>{e.notifyStoresAboutStateRestoringStop({cause:"redo",transactions:t})}]}]}onEnable(){zi()}onDisable(){return"disabledstate"}onAutoRecordOn(){return{[Hi]:"autoreadystate",[Xi]:!0}}onAutoRecordOff(){zi()}onStartTransaction(e,t){const n=new sa({title:t});return[{[Hi]:"recordingstate",[Ki]:n},()=>{e.notifyStoresAboutStateRecordingStart(n)}]}onStopTransaction(){zi()}onStopTransactionDelayed(){zi()}onRejectTransaction(){zi()}onResetQueue(e,t){return ta(e,t)}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}}const aa=new ia;Qi("readystate",aa);class oa extends Wi{canUndo(){return!1}canRedo(){return!1}onEnable(){}onDisable(e){const t=e[Ki];return e.notifyStoresAboutStateRecordingStop(t,{disabled:!0}),{[Hi]:"disabledstate",[Ki]:null}}onAutoRecordOn(e){return[{[Hi]:"autorecordingstate",[Xi]:!0},()=>{e.stopTransactionDelayed()}]}onAutoRecordOff(){zi()}onStartTransaction(){zi()}onStopTransaction(e,t){const n=e[Ki],r=e[Yi];let s=e[qi];return n.length&&(n.title||t||!e.getTransactionTitle?t&&(n.title=t):n.title=e.getTransactionTitle(n),r[s]=n,r.length=++s),[{[Hi]:"readystate",[qi]:s,[Ki]:null},()=>{e.notifyStoresAboutStateRecordingStop(n,{stop:!0})}]}onRejectTransaction(e){const t=e[Ki];return[{[Hi]:"restoringstate",[Ki]:null},()=>(t.length&&t.undo(),["readystate",()=>{e.notifyStoresAboutStateRecordingStop(t,{rejected:!0})}])]}onStopTransactionDelayed(){zi()}onResetQueue(e,t){return ta(e,t)}onModelUpdate(e,t,n,r,s){e[Ki].addAction(e.makeModelUpdateAction(t,n,r,s))}onModelInsertChild(e,t,n,r,s,i){e[Ki].addAction(e.makeModelInsertChildAction(t,n,r,s,i))}onModelRemoveChild(e,t,n,r){e[Ki].addAction(e.makeModelRemoveChildAction(t,n,r))}onStoreModelAdd(e,t,n,r){e[Ki].addAction(e.makeStoreModelAddAction(t,n,r))}onStoreModelInsert(e,t,n,r,s,i){e[Ki].addAction(e.makeStoreModelInsertAction(t,n,r,s,i))}onStoreModelRemove(e,t,n,r,s){e[Ki].addAction(e.makeStoreModelRemoveAction(t,n,r,s))}onStoreRemoveAll(e,t,n,r){e[Ki].addAction(e.makeStoreRemoveAllAction(t,n,r))}}const la=new oa;Qi("recordingstate",la);const ca=new class extends Wi{static get $name(){return"RestoringStateClass"}canUndo(){return!1}canRedo(){return!1}onUndo(){zi()}onRedo(){zi()}onEnable(){zi()}onDisable(){zi()}onAutoRecordOn(){return{[Xi]:!0}}onAutoRecordOff(){return{[Xi]:!1}}onStartTransaction(){zi()}onStopTransaction(){zi()}onStopTransactionDelayed(){zi()}onRejectTransaction(){zi()}onQueueReset(){zi()}onModelUpdate(){}onModelInsertChild(){}onModelRemoveChild(){}onStoreModelAdd(){}onStoreModelInsert(){}onStoreModelRemove(){}onStoreRemoveAll(){}};Qi("restoringstate",ca);const da=new class extends ia{onAutoRecordOn(){zi()}onAutoRecordOff(){return{[Hi]:"readystate",[Xi]:!1}}onStartTransaction(e,t){const n=new sa({title:t});return[{[Hi]:"autorecordingstate",[Ki]:n},()=>{e.notifyStoresAboutStateRecordingStart(n),e.stopTransactionDelayed()}]}onModelUpdate(e,t,n,r){e.startTransaction(),e.onModelUpdate(t,n,r)}onModelInsertChild(e,t,n,r,s){e.startTransaction(),e.onModelInsertChild(t,n,r,s)}onModelRemoveChild(e,t,n,r){e.startTransaction(),e.onModelRemoveChild(t,n,r)}onStoreModelAdd(e,t,n,r){e.startTransaction(),e.onStoreModelAdd(t,n,r)}onStoreModelInsert(e,t,n,r,s,i){e.startTransaction(),e.onStoreModelInsert(t,n,r,s,i)}onStoreModelRemove(e,t,n,r,s){e.startTransaction(),e.onStoreModelRemove(t,n,r,s)}onStoreRemoveAll(e,t,n,r){e.startTransaction(),e.onStoreRemoveAll(t,n,r)}};Qi("autoreadystate",da);class ua extends(oa.mixin(Ur)){onDisable(e){const t=e[Ki],n=e[Gi];return n&&this.clearTimeout(n),e.notifyStoresAboutStateRecordingStop(t,{disabled:!0}),{[Hi]:"disabledstate",[Ki]:null,[Gi]:null}}onAutoRecordOn(e){zi()}onAutoRecordOff(e){const t=e[Gi];return t&&this.clearTimeout(t),{[Hi]:"recordingstate",[Xi]:!1,[Gi]:null}}onStopTransaction(e,t){const n=e[Ki],r=e[Gi],s=e[Yi];let i=e[qi];return r&&this.clearTimeout(r),n.length&&(n.title||t||!e.getTransactionTitle?t&&(n.title=t):n.title=e.getTransactionTitle(n),s[i]=n,s.length=++i),[{[Hi]:"autoreadystate",[qi]:i,[Ki]:null,[Gi]:null},()=>{e.notifyStoresAboutStateRecordingStop(n,{stop:!0})}]}onStopTransactionDelayed(e){let t=e[Gi];return t&&this.clearTimeout(t),t=this.setTimeout((()=>{e.stopTransaction()}),e.autoRecordTransactionStopTimeout),{[Hi]:ha,[Gi]:t}}onResetQueue(e,t){return ta(e,t)}onRejectTransaction(e){const t=e[Ki],n=e[Gi];return n&&this.clearTimeout(n),[{[Hi]:"restoringstate",[Ki]:null,[Gi]:null},()=>(t.length&&t.undo(),["autoreadystate",()=>{e.notifyStoresAboutStateRecordingStop(t,{rejected:!0})}])]}onModelUpdate(e,...t){super.onModelUpdate(e,...t),e.stopTransactionDelayed()}onModelInsertChild(e,...t){super.onModelInsertChild(e,...t),e.stopTransactionDelayed()}onModelRemoveChild(e,...t){super.onModelRemoveChild(e,...t),e.stopTransactionDelayed()}onStoreModelAdd(e,...t){super.onStoreModelAdd(e,...t),e.stopTransactionDelayed()}onStoreModelInsert(e,...t){super.onStoreModelInsert(e,...t),e.stopTransactionDelayed()}onStoreModelRemove(e,...t){super.onStoreModelRemove(e,...t),e.stopTransactionDelayed()}onStoreRemoveAll(e,...t){super.onStoreRemoveAll(e,...t),e.stopTransactionDelayed()}}const ha=new ua;Qi("autorecordingstate",ha);const ga=()=>{throw new Error("Abstract method call!")};class ma extends ue{get type(){return this.constructor.name}undo(){ga()}redo(){ga()}}ma._$name="ActionBase";const pa=Symbol("MODEL_PROP"),fa=Symbol("NEW_DATA_PROP"),va=Symbol("OLD_DATA_PROP");class ya extends ma{static get defaultConfig(){return{model:void 0,newData:void 0,oldData:void 0,isInitialUserAction:!1}}get type(){return"UpdateAction"}get model(){return this[pa]}set model(e){this[pa]=e}get newData(){return this[fa]}set newData(e){this[fa]={...e}}get oldData(){return this[va]}set oldData(e){this[va]={...e}}undo(){const{model:e,oldData:t}=this;e.$&&Object.assign(e,t),e.set(t,null,null,null,Boolean(e.$))}redo(){const{model:e,newData:t}=this;e.$&&Object.assign(e,t),e.set(t,null,null,null,Boolean(e.$))}}ya._$name="UpdateAction";const ba=Symbol("PARENT_MODEL_PROP"),Ca=Symbol("CHILD_MODELS_PROP"),Sa=Symbol("INSERT_INDEX_PROP"),wa=Symbol("CONTEXT_PROP");class Da extends ma{static get defaultConfig(){return{parentModel:void 0,childModels:void 0,insertIndex:void 0,context:void 0}}get type(){return"InsertChildAction"}get parentModel(){return this[ba]}set parentModel(e){this[ba]=e}get childModels(){return this[Ca]}set childModels(e){this[Ca]=e.slice(0)}get insertIndex(){return this[Sa]}set insertIndex(e){this[Sa]=e}get context(){return this[wa]}set context(e){this[wa]=e}undo(){const{parentModel:e,context:t,childModels:n}=this,r=new Map,s=new Set;for(const i of n){const n=t.get(i);if(n){let t=r.get(n.parent);t||(t={moveRight:[],moveLeft:[],moveFromAnotherParent:[]},r.set(n.parent,t)),n.parent===e?n.index>i.parentIndex?t.moveRight.push({parent:n.parent,model:i,index:n.index+1}):t.moveLeft.push({parent:n.parent,model:i,index:n.index}):t.moveFromAnotherParent.push({parent:n.parent,model:i,index:n.index})}else s.add(i)}for(const e of r.values()){const{moveRight:t,moveLeft:n}=e;n.sort(((e,t)=>e.index-t.index)),t.sort(((e,t)=>t.index-e.index))}s.forEach((e=>e.parent.removeChild(e)));for(const e of r.values()){const{moveRight:t,moveLeft:n,moveFromAnotherParent:r}=e;n.forEach((e=>{e.parent.insertChild(e.model,e.index)})),t.forEach((e=>{e.parent.insertChild(e.model,e.index)})),r.forEach((e=>{e.parent.insertChild(e.model,e.index)}))}}redo(){var e,t;const{parentModel:n,insertIndex:r,childModels:s}=this,i=null===(e=n.children)||void 0===e?void 0:e[r];n.insertChild(s,i,!1,{orderedBeforeNode:null==i||null===(t=i.previousSibling)||void 0===t?void 0:t.nextOrderedSibling})}}Da._$name="InsertChildAction";const Ta=Symbol("PARENT_MODEL_PROP"),Ea=Symbol("CHILD_MODELS_PROP"),xa=Symbol("CONTEXT_PROP");class ka extends ma{static get defaultConfig(){return{parentModel:void 0,childModels:void 0,context:void 0}}get type(){return"RemoveChildAction"}get parentModel(){return this[Ta]}set parentModel(e){this[Ta]=e}get childModels(){return this[Ea]}set childModels(e){this[Ea]=e.slice(0)}get context(){return this[xa]}set context(e){this[xa]=e}undo(){const{parentModel:e,context:t,childModels:n}=this;n.sort(((e,n)=>t.get(e)-t.get(n))),n.forEach((n=>{const r=t.get(n);e.insertChild(n,r.parentIndex,void 0,{orderedParentIndex:r.orderedParentIndex})}))}redo(){this.parentModel.removeChild(this.childModels)}}ka._$name="RemoveChildAction";const Ia=Symbol("STORE_PROP"),Ra=Symbol("MODEL_LIST_PROP");class Ma extends ma{static get defaultConfig(){return{store:void 0,modelList:void 0,silent:!1}}get type(){return"AddAction"}get store(){return this[Ia]}set store(e){this[Ia]=e}get modelList(){return this[Ra]}set modelList(e){this[Ra]=e.slice(0)}undo(){this.store.remove(this.modelList,this.silent)}redo(){this.store.add(this.modelList,this.silent)}}Ma._$name="AddAction";const Oa=Symbol("STORE_PROP"),Aa=Symbol("MODEL_LIST_PROP"),Fa=Symbol("INSERT_INDEX_PROP"),Pa=Symbol("CONTEXT_PROP");class La extends ma{static get defaultConfig(){return{store:void 0,modelList:void 0,insertIndex:void 0,context:void 0,silent:!1}}get type(){return"InsertAction"}get store(){return this[Oa]}set store(e){this[Oa]=e}get modelList(){return this[Aa]}set modelList(e){this[Aa]=e.slice(0)}get insertIndex(){return this[Fa]}set insertIndex(e){this[Fa]=e}get context(){return this[Pa]}set context(e){this[Pa]=e}undo(){const{store:e,modelList:t,context:n,silent:r}=this;t.sort(((e,t)=>{const r=n.get(e),s=n.get(t);return void 0!==r&&void 0!==s?r-s:0})),t.forEach((t=>{const s=n.get(t);t._undoingInsertion=!0,void 0!==s?e.insert(s,t,r):e.remove(t,r),t._undoingInsertion=!1}))}redo(){const e=this;e.store.insert(e.insertIndex,e.modelList,e.silent)}}La._$name="InsertAction";const $a=Symbol("STORE_PROP"),_a=Symbol("MODEL_LIST_PROP"),Na=Symbol("CONTEXT_PROP");class ja extends ma{static get defaultConfig(){return{store:void 0,modelList:void 0,context:void 0,silent:!1}}get type(){return"RemoveAction"}get store(){return this[$a]}set store(e){this[$a]=e}get modelList(){return this[_a]}set modelList(e){this[_a]=e.slice(0)}get context(){return this[Na]}set context(e){this[Na]=e}undo(){const{store:e,context:t,modelList:n,silent:r}=this;n.sort(((e,n)=>t.get(e)-t.get(n))),n.forEach((n=>{const s=t.get(n);e.insert(s,n,r)}))}redo(){this.store.remove(this.modelList,this.silent)}}ja._$name="RemoveAction";const Va=Symbol("STORE_PROP"),Ba=Symbol("ALL_RECORDS_PROP");class za extends ma{static get defaultConfig(){return{store:void 0,allRecords:void 0,silent:!1}}get type(){return"RemoveAllAction"}get store(){return this[Va]}set store(e){this[Va]=e}get allRecords(){return this[Ba]}set allRecords(e){this[Ba]=e.slice(0)}undo(){const{store:e,allRecords:t,silent:n}=this;e.add(t,n)}redo(){this.store.removeAll(this.silent)}}za._$name="RemoveAllAction";const Wa=(e,t,n,r)=>new ya({model:e,newData:t,oldData:n,isInitialUserAction:r}),Ha=(e,t,n,r)=>new Da({parentModel:e,childModels:n,insertIndex:t,context:r}),Ua=(e,t,n)=>new ka({parentModel:e,childModels:t,context:n}),Ya=(e,t,n)=>new Ma({store:e,modelList:t,silent:n}),qa=(e,t,n,r,s)=>new La({store:e,insertIndex:t,modelList:n,context:r,silent:s}),Ka=(e,t,n,r)=>new ja({store:e,modelList:t,context:n,silent:r}),Ga=(e,t,n)=>new za({store:e,allRecords:t,silent:n}),Xa=(e,t,...n)=>{const r=e.state,s=t.call(e[Hi],e,...n);if("string"==typeof s)e[Hi]=ea(s);else if(s instanceof Wi)e[Hi]=s;else if(Array.isArray(s)){const[t,r]=s;"string"==typeof t?e[Hi]=ea(t):t instanceof Wi?e[Hi]=t:t&&"object"==typeof t&&((e=Object.assign(e,t))[Hi]=ea(e[Hi])),"function"==typeof r&&Xa(e,r,...n)}else s&&"object"==typeof s&&((e=Object.assign(e,s))[Hi]=ea(e[Hi]));r!==aa&&r!==da&&s!==aa&&s!==da&&e.trigger("ready")};class Za extends(Ne(ue)){static get defaultConfig(){return{disabled:!0,autoRecord:!1,autoRecordTransactionStopTimeout:100,makeModelUpdateAction:Wa,makeModelInsertChildAction:Ha,makeModelRemoveChildAction:Ua,makeStoreModelAddAction:Ya,makeStoreModelInsertAction:qa,makeStoreModelRemoveAction:Ka,makeStoreRemoveAllAction:Ga,getTransactionTitle:null}}construct(...e){Object.assign(this,{[Hi]:aa,[Ui]:[],[Yi]:[],[qi]:0,[Ki]:null,[Gi]:null,[Xi]:!1,[Zi]:!1,stashedTransactions:{}}),super.construct(...e)}get state(){return this[Hi]}get position(){return this[qi]}get length(){return this[Yi].length}get stores(){return Array.from(this[Ui])}hasStore(e){return this[Ui].includes(e)}addStore(e){this.hasStore(e)||(this[Ui].push(e),e.stm=this,e.forEach((e=>e.stm=this)),e.isTree&&(e.rootNode.stm=this))}removeStore(e){this.hasStore(e)&&(this[Ui]=this[Ui].filter((t=>t!==e)),e.stm=null,e.forEach((e=>e.stm=null)))}forEachStore(e){this[Ui].forEach((t=>e(t,t.id)))}get disabled(){return this.state===na}set disabled(e){const t=this;t.disabled!==e&&(Xa(t,e?t.state.onDisable:t.state.onEnable,t),t.trigger("stmDisabled",{disabled:e}),t.trigger("disabled",{disabled:e}))}get enabled(){return!this.disabled}enable(){this.disabled=!1}disable(){this.disabled=!0}get isReady(){return this.state===aa||this.state===da}waitForReadiness(){return this.await("ready",!1)}get isRecording(){return this.state===la||this.state===ha}get isApplyingStash(){return this[Zi]}get autoRecord(){return this[Xi]}set autoRecord(e){const t=this;t.autoRecord!=e&&Xa(t,e?t.state.onAutoRecordOn:t.state.onAutoRecordOff,t)}startTransaction(e=null){Xa(this,this.state.onStartTransaction,e)}stopTransaction(e=null){Xa(this,this.state.onStopTransaction,e)}stopTransactionDelayed(){Xa(this,this.state.onStopTransactionDelayed)}rejectTransaction(){Xa(this,this.state.onRejectTransaction)}get transaction(){return this[Ki]}get queue(){return this[Yi].map((e=>e.title))}get rawQueue(){return this[Yi]}get isRestoring(){return this.state===ca||this.isApplyingStash}get canUndo(){return this.state.canUndo(this)}get canRedo(){return this.state.canRedo(this)}async undo(e=1){this.isReady||await this.waitForReadiness(),Xa(this,this.state.onUndo,e)}async undoAll(){this.isReady||await this.waitForReadiness(),this.undo(this.length)}async redo(e=1){this.isReady||await this.waitForReadiness(),Xa(this,this.state.onRedo,e)}async redoAll(){this.isReady||await this.waitForReadiness(),this.redo(this.length)}resetQueue(e={undo:!0,redo:!0}){Xa(this,this.state.onResetQueue,e)}resetUndoQueue(){this.resetQueue({undo:!0})}resetRedoQueue(){this.resetQueue({redo:!0})}notifyStoresAboutStateRecordingStart(e){this.forEachStore((t=>{var n;return null===(n=t.onStmRecordingStart)||void 0===n?void 0:n.call(t,this,e)})),this.trigger("recordingStart",{stm:this,transaction:e})}notifyStoresAboutStateRecordingStop(e,t){this.forEachStore((n=>{var r;return null===(r=n.onStmRecordingStop)||void 0===r?void 0:r.call(n,this,e,t)})),this.trigger("recordingStop",{stm:this,transaction:e,reason:t})}notifyStoresAboutStateRestoringStart(){this.forEachStore((e=>{var t;return null===(t=e.onStmRestoringStart)||void 0===t?void 0:t.call(e,this)})),this.trigger("restoringStart",{stm:this})}notifyStoresAboutStateRestoringStop({cause:e,transactions:t}){this.forEachStore((e=>{var t;return null===(t=e.onStmRestoringStop)||void 0===t?void 0:t.call(e,this)})),this.trigger("restoringStop",{stm:this,cause:e,transactions:t})}notifyStoresAboutQueueReset(e){this.forEachStore((t=>{var n;return null===(n=t.onStmQueueReset)||void 0===n?void 0:n.call(t,this,e)})),this.trigger("queueReset",{stm:this,options:e})}onModelUpdate(e,t,n,r){Xa(this,this.state.onModelUpdate,e,t,n,r)}onModelInsertChild(e,t,n,r){Xa(this,this.state.onModelInsertChild,e,t,n,r)}onModelRemoveChild(e,t,n){Xa(this,this.state.onModelRemoveChild,e,t,n)}onStoreModelAdd(e,t,n){Xa(this,this.state.onStoreModelAdd,e,t,n)}onStoreModelInsert(e,t,n,r,s){Xa(this,this.state.onStoreModelInsert,e,t,n,r,s)}onStoreModelRemove(e,t,n,r){Xa(this,this.state.onStoreModelRemove,e,t,n,r)}onStoreRemoveAll(e,t,n){Xa(this,this.state.onStoreRemoveAll,e,t,n)}onUndoKeyPress(e){const t=this;t.enabled&&(e.shiftKey?t.canRedo&&(e.preventDefault(),t.redo()):t.canUndo&&(e.preventDefault(),t.undo()))}stash(){const e=this;if(this.transaction){const t=Us.generateId("_stashedTransactionGeneratedId_");return e.stashedTransactions[t]=e.transaction,e.rejectTransaction(),t}}applyStash(e){const t=this,n=t.stashedTransactions[e];t[Zi]=!0,n&&(t.startTransaction(n.title),n.redo(),delete t.stashedTransactions[e]),t[Zi]=!1}}Za._$name="StateTrackingManager";class Ja{static insertRule(e,t=document.head){const n=this.getStyleSheet(t),r=n.cssRules.length;if(n.insertRule(e,0),n.cssRules.length>r)return n.cssRules[0]}static findRule(e){let t;const n="function"==typeof e;return Array.prototype.find.call(document.head.querySelectorAll("link[rel=stylesheet],style[type*=css]"),(r=>{if(t=Array.prototype.find.call(r.sheet.rules||r.sheet.cssRules,(t=>n?e(t):t.selectorText===e)),t)return!0})),t}static getStyleSheet(e=document.head){return e.$bryntumStylesheet||(e.$bryntumStylesheet=yr.createElement({tag:"style",id:"bryntum-private-styles",type:"text/css",parent:e}).sheet),e.$bryntumStylesheet}static getCSSVersion(){return getComputedStyle(document.documentElement).getPropertyValue("--bryntum-version").replace(/[" ]/gm,"")}}Ja._$name="CSSHelper";const Qa=Array.prototype.slice,eo=Object.freeze([]),to=Object.freeze({}),no=/[&<]/,{getPrototypeOf:ro}=Object,{toString:so}=Object.prototype,{isEqual:io,isObject:ao}=Ut,oo={parent:1,elementData:1,ns:1,syncOptions:1},lo=()=>({ignore:oo,refsFound:new Set}),co={class:1,className:1,classname:1},uo={bigint:1,boolean:1,function:1,number:1,string:1,symbol:1},ho={tag:1,html:1,text:1,children:1,tooltip:1,parent:1,nextSibling:1,ns:1,reference:1,elementData:1,retainElement:1,compareHtml:1,syncOptions:1,listeners:1,isReleased:1,null:1,"":1,keepChildren:1,retainChildren:1};class go{static checkEquality(e,t,n,r){if(e===t)return!0;if(null==e)return null==t;if(!e||!t)return!1;const s=typeof e;if(s!==typeof t||uo[s])return!1;let i,a,o,l,c,d,u,h=n.equalityCache||(n.equalityCache=new Map),g=Boolean(r);if(h=h.get(e)||h.set(e,new Map).get(e),i=h.get(t),void 0===i){if(i=!0,ro(e)!==ro(t)||e instanceof Node)i=!1;else if(Array.isArray(e)){if(a=e.length,a!==t.length)i=!1;else for(;a-- >0;)if(!go.checkEquality(e[a],t[a],n,g)){i=!1;break}}else{var m;for(c in d=e.syncOptions,l=null===(m=d)||void 0===m?void 0:m.ignoreRefs,l&&(g=!0,r="children"!==l),o=n.ignore||to,t)if(!(o[c]||c in e||r&&"reference"===c)){i=!1;break}if(i)if("[object Date]"===so.call(t))i=e.getTime()===t.getTime();else if(yr.isReactElement(e)||yr.isReactElement(t))i=!1;else for(c in e)if(!(o[c]||r&&"reference"===c)){if(!(c in t)){i=!1;break}if(u=e[c],!go.checkEquality(u,t[c],n,g)){i=!1;break}}}var p;if(!r&&ao(e)&&e.reference)null===(p=n.refsFound)||void 0===p||p.add(e.reference);h.set(t,i)}return i}static sync(e){const t=e,{refOwner:n}=e,r=null==n?void 0:n.byRef,s=lo();let i,a,o,l,c=e.affected;if("string"==typeof c&&(c=[c]),e={...e,checkEqualityOptions:s},n){if(n.byRef={},c)for(a in r)c.includes(a)||(n.byRef[a]=r[a]);e.refsWas=r}if(t.changed=go.performSync(e,e.targetElement),n)for(c||(c=Object.keys(r)),i=0;i<c.length;++i){var d,u;if(a=c[i],o=r[a],s.refsFound.has(a)||o.retainElement)n.byRef[a]=o;else l=o.lastDomConfig,null===(d=(u=o).blur)||void 0===d||d.call(u),o.remove(),n.detachRef(a,o,l)}return e.targetElement}static performSync(e,t){const{domConfig:n,callback:r}=e,{lastDomConfig:s}=t;return(e.configEquality||go.checkEquality)(n,s,e.checkEqualityOptions,e.ignoreRefs)?(null==r||r({action:"none",domConfig:n,targetElement:t}),!1):(n?(n.onlyChildren||(go.syncAttributes(n,t,e),go.syncContent(n,t)),n.keepChildren||go.syncChildren(e,t)):(t.innerHTML=null,t.syncIdMap=null),t.lastDomConfig=null!=n&&n.onlyChildren&&s?{...s,children:n.children}:n,!0)}static syncDataset(e,t){const{lastDomConfig:n}=t,r=e===n,s=Object.keys(e.dataset),i=n&&n.dataset&&Object.keys(n.dataset),a=ge.delta(s,i);let o,l,c,d;for(l=0;l<a.onlyInA.length;l++)o=a.onlyInA[l],d=e.dataset[o],null!=d&&t.setAttribute(`data-${T.hyphenate(o)}`,d);for(l=0;l<a.inBoth.length;l++)o=a.inBoth[l],d=e.dataset[o],(r||d!=n.dataset[o])&&(c=`data-${T.hyphenate(o)}`,null==d?t.removeAttribute(c):t.setAttribute(c,d));for(l=0;l<a.onlyInB.length;l++)t.removeAttribute(`data-${T.hyphenate(a.onlyInB[l])}`)}static addCls(e,t){const{lastDomConfig:n}=t;(e=Sn.normalize(e,"array")).forEach((e=>{t.classList.add(e),((e,t)=>{const n="className"in t?"className":"class",r=t[n];if(r)if("string"==typeof r){const s=r.split(" ");s.includes(e)||(s.push(e),t[n]=s.join(" "))}else Array.isArray(r)?r.includes(e)||r.push(e):r.isDomClassList?r.add(e):Ut.isObject(r)&&(r[e]=1)})(e,n)}))}static removeCls(e,t){const{lastDomConfig:n}=t;(e=Sn.normalize(e,"array")).forEach((e=>{t.classList.remove(e),((e,t)=>{const n="className"in t?"className":"class",r=t[n];if(r)if("string"==typeof r){const s=r.split(" ");s.includes(e)&&(s.splice(s.indexOf(e),1),t[n]=s.join(" "))}else Array.isArray(r)?r.includes(e)&&r.splice(r.indexOf(e),1):r.isDomClassList?r.remove(e):Ut.isObject(r)&&delete r[e]})(e,n)}))}static syncClassList(e,t,n){let r,s,i,a,o,l,c=e.className||e.class,d=!1;if(n){for(s=Sn.normalize(t,"array"),c=Sn.normalize(c,"object"),l=Sn.normalize(n.className||n.class,"object"),o=[],i=0,a=s.length;i<a;++i)r=s[i],c[r]||!(r in l)?(l[r]=1,o.push(r)):d=!0;for(r in c)l[r]||(o.push(r),d=!0);if(!d)return;c=o.join(" ")}else c=Sn.normalize(c);t.setAttribute("class",c)}static getSyncAttributes(e){const t={},n=[];return e&&Object.keys(e).forEach((r=>{if(!ho[r]){const s=r.toLowerCase();t[s]=e[r],n.push(s)}})),{attributes:t,names:n}}static syncAttributes(e,t,n){const{lastDomConfig:r}=t,s=e===r,i=go.getSyncAttributes(e),{attributes:a,names:o}=i,{attributes:l,names:c}=s?i:go.getSyncAttributes(r),{onlyInA:d,onlyInB:u,inBoth:h}=s?{onlyInA:eo,onlyInB:eo,inBoth:o}:ge.delta(o,c);let g,m;for(m=0;m<d.length;m++){g=d[m];const n=a[g];"style"===g&&null!=n?yr.applyStyle(t,n,!0):"dataset"===g?go.syncDataset(e,t):co[g]?go.syncClassList(e,t):null!=n&&t.setAttribute(g,n)}for(m=0;m<u.length;m++)t.removeAttribute(u[m]);for(m=0;m<h.length;m++){g=h[m];const r=a[g],i=l[g];null==r?t.removeAttribute(g):"style"===g?n.strict?s?go.syncStyles(t,r):io(r,i,!0)||go.syncStyles(t,r,i):!s&&io(r,i,!0)||yr.applyStyle(t,r,!0):"dataset"===g?go.syncDataset(e,t):co[g]?go.syncClassList(e,t,n.strict&&t.lastDomConfig):(s||r!==i)&&t.setAttribute(g,r)}}static syncStyles(e,t,n){let r,s,i;if(n){if(r={},t=yr.parseStyle(t),n=yr.parseStyle(n),t)for(s in t)i=t[s],n[s]!==i&&(r[s]=i);for(s in n)s in t||(r[s]="")}else r=t;yr.applyStyle(e,r)}static syncContent(e,t){const{html:n,text:r}=e,s=r??n;if(t.didSetTextContent=!1,e.elementData&&(t.elementData=e.elementData),s instanceof DocumentFragment)1===t.childNodes.length&&0===yr.getChildElementCount(t)&&1===s.childNodes.length&&0===yr.getChildElementCount(s)?yr.setInnerText(t,s.firstChild.data):(t.innerHTML="",t.appendChild(s));else if(null!=n&&no.test(n))t.innerHTML=String(n);else if(null!=s){var i;const{lastDomConfig:e}=t;null!=e&&null!==(i=e.children)&&void 0!==i&&i.length||null!=e&&e.html&&no.test(t.lastDomConfig.html)?t.innerHTML=s:(yr.setInnerText(t,String(s)),t.didSetTextContent=!0)}}static insertTextNode(e,t,n,r,s=null){const i=document.createTextNode(e);t.insertBefore(i,s),r&&(i.$refOwnerId=r.id),null==n||n({action:"newNode",domConfig:e,targetElement:i})}static insertElement(e,t,n,r,s,i,a){var o;const l=a.ns?document.createElementNS(a.ns,e.tag||"svg"):document.createElement(e.tag||"div");t.insertBefore(l,n),go.performSync(a,l),null!=i&&(s[i]=l),e.role||e.tabIndex||e["aria-hidden"]||yr.isFocusable(l,!0)||l.htmlFor||l.setAttribute("role","presentation"),r&&(l.$refOwnerId=r.id,i&&(l.$reference=i,r.attachRef(i,l,e))),null===(o=a.callback)||void 0===o||o.call(a,{action:"newElement",domConfig:e,targetElement:l,syncId:i})}static syncChildren(e,t){let n,r,s,{domConfig:i,syncIdField:a,callback:o,releaseThreshold:l,configEquality:c,ns:d,refOwner:u,refsWas:h,strict:g,checkEqualityOptions:m,ignoreRefs:p}=e,f=null;const v=i.syncOptions||{};if(i.html??i.text)return;p=Boolean(v.ignoreRefs??p),p&&(u=h=null),"strict"in v&&(g=v.strict);const y=u?u.byRef:{},b=Qa.call(i.children||[]),C=Qa.call(t.childNodes),S=h||t.syncIdMap||{},w=t.releasedIdMap||{},D=e=>{for(;C.length&&C[0].parentNode!==t;)C.shift();return(e?C.shift():C[0])||null};a=v.syncIdField||a,g=v.strict||g,o=v.callback||o,c=v.configEquality||c,l="releaseThreshold"in v?v.releaseThreshold:l,a&&(t.syncIdMap=y);const T={checkEqualityOptions:m||lo(),ignoreRefs:p,refOwner:u,refsWas:h,strict:g,syncIdField:a,releaseThreshold:l,callback:o,configEquality:c};for(;b.length;){const l=b.shift();if(s=null,!l)continue;if(yr.isReactElement(l)){o({jsx:l,targetElement:t,domConfig:i});continue}if(Array.isArray(l)){this.syncChildren({...e,domConfig:{...e.domConfig,children:l}},t);continue}if(l instanceof Node){r=D(),l!==r&&t.insertBefore(l,r),n=C.indexOf(l),n>-1&&C.splice(n,1);continue}const c="string"==typeof l;if(T.domConfig=l,T.ns=l.ns||d,!c){if(u?s=l.reference:a&&l.dataset&&(s=l.dataset[a]),null!=s&&!l.unmatched){const e=S[s]||w[s];if(e){const{lastDomConfig:n}=e;if(e.retainElement);else if(go.performSync(T,e)){var E;null===(E=o)||void 0===E||E({action:"reuseOwnElement",domConfig:l,targetElement:e,lastDomConfig:n,syncId:s})}l.retainElement&&(e.retainElement=!0),y[s]=e,ge.remove(C,e),delete w[s],e.isReleased=!1,r=D(),(e.parentNode!==t||g&&e.nextSibling!==r)&&t.insertBefore(e,r)}else g?go.insertElement(l,t,D(),u,y,s,T):(b.push(l),l.unmatched=!0);continue}l.unmatched&&delete l.unmatched}let h,m=null,p=null;for(;!p&&(h=D(!0));){if(u){if(h.$refOwnerId!==u.id)continue;if(h.$reference){if(!g)continue;m=h;break}p=h}else h.retainElement||(p=h);p||(f||(f=[])).push(h)}if(m||!p)c?go.insertTextNode(l,t,o,u,m):go.insertElement(l,t,m,u,y,s,T);else if(c||p.nodeType!==Node.ELEMENT_NODE||(l.tag||"div").toLowerCase()!==p.tagName.toLowerCase())if(c&&p.nodeType===Node.TEXT_NODE)p.data=l;else{var x,k;c?go.insertTextNode(l,t,o,u,p):go.insertElement(l,t,p,u,y,s,T),null===(x=(k=p).blur)||void 0===x||x.call(k),p.remove()}else{var I,R;const{lastDomConfig:e}=p,t=go.performSync(T,p);if(a&&null!=(null==e||null===(I=e.dataset)||void 0===I?void 0:I[a])){const t=e.dataset[a];delete w[t],delete S[t]}null!=s&&(y[s]=p),p.isReleased=!1,t&&(null===(R=o)||void 0===R||R({action:"reuseElement",domConfig:l,targetElement:p,lastDomConfig:e,syncId:s}))}}if(!(t.didSetTextContent&&1===C.length&&C[0].nodeType===Node.TEXT_NODE||i.retainChildren)){for(;r=D(!0);)u&&(r.$refOwnerId!==u.id||r.$reference)||(f||(f=[])).push(r);f&&go.syncChildrenCleanup(t,f,y,o,u,l,a)}}static syncChildrenCleanup(e,t,n,r,s,i,a){let o,l=0;for(const d of t){const{lastDomConfig:t}=d;var c;if(d.nodeType!==Element.TEXT_NODE)if(d.retainElement)a&&t&&(n[d.dataset[a]]=d);else if(!s&&a&&(null==i||l<i))d.isReleased||(d.className="b-released",d.isReleased=!0,null!=t&&t.dataset&&(e.releasedIdMap||(e.releasedIdMap={}),e.releasedIdMap[t.dataset[a]]=d),null==r||r({action:"releaseElement",domConfig:t,lastDomConfig:t,targetElement:d}),t&&(t.isReleased=!0,t.className&&(t.className="b-released"),t.class&&(t.class="b-released"),t.style&&(t.style=null))),l++;else null===(c=d.blur)||void 0===c||c.call(d),d.remove(),s&&(o=d.$reference,o&&s.detachRef(o,d,t)),e.releasedIdMap&&a&&null!=t&&t.dataset&&delete e.releasedIdMap[t.dataset[a]],null==r||r({action:"removeElement",domConfig:d.lastDomConfig,lastDomConfig:d.lastDomConfig,targetElement:d});else d.remove()}}static removeChild(e,t){if(e.contains(t)){const n=e.syncIdMap;if(n){const e=Object.values(n).indexOf(t);e>-1&&delete n[Object.keys(n)[e]]}e.removeChild(t)}}static addChild(e,t,n){e.appendChild(t),e.syncIdMap||(e.syncIdMap={}),e.syncIdMap[n]=t}static getChild(e,t){const n=String(t).split(".");for(const t of n){var r,s;if(!(e=null===(r=e)||void 0===r||null===(s=r.syncIdMap)||void 0===s?void 0:s[t]))return null}return e}}go._$name="DomSync";class mo{static init(){const e=["fullscreenEnabled","requestFullscreen","exitFullscreen","fullscreenElement"],t=t=>e.map((e=>{let n=t+T.capitalize(e);return"moz"===t&&(n=n.replace("screen","Screen"),"mozCancelFullScreen"in document&&"exitFullscreen"===e&&(n="mozCancelFullScreen")),n}));this.functions="fullscreenEnabled"in document&&e||"webkitFullscreenEnabled"in document&&t("webkit")||"mozFullScreenEnabled"in document&&t("moz")||"msFullscreenEnabled"in document&&t("ms")||[];const n=["fullscreenchange","fullscreenerror"],r=e=>n.map((t=>e+T.capitalize(t)));this.events="fullscreenEnabled"in document&&n||"webkitFullscreenEnabled"in document&&r("webkit")||"mozFullscreenEnabled"in document&&r("moz")||"msFullscreenEnabled"in document&&["MSFullscreenChange","MSFullscreenError"]||[],this.onFullscreenChange(this.onInternalFullscreenChange.bind(this))}static get enabled(){return Boolean(this.functions[0]&&document[this.functions[0]])}static async request(e){return this.functions[1]&&(null==e?void 0:e[this.functions[1]]())}static async exit(){return this.functions[2]&&document[this.functions[2]]()}static get isFullscreen(){return!!this.element}static get element(){return this.functions[3]&&document[this.functions[3]]}static onFullscreenChange(e){this.events[0]&&document.addEventListener(this.events[0],e)}static unFullscreenChange(e){this.events[0]&&document.removeEventListener(this.events[0],e)}static onInternalFullscreenChange(){const e=this,{element:t}=e;if(t){if(!t.closest(".b-floatroot")){const n=yr.getRootElement(t),{floatRoot:r}=n;r&&(e._floatRoot=r,e._oldParent=r.parentElement,t.appendChild(r))}}else e._floatRoot&&e._oldParent.appendChild(e._floatRoot),e._oldParent=null,e._floatRoot=null}}mo.init(),mo._$name="Fullscreen";let po=null;const fo=[],vo=e=>{var t;return e.nodeType===e.ELEMENT_NODE&&"absolute"===(null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e).getPropertyValue("position"))};class yo{static addResizeListener(e,t){const n=this;if(e!==document&&e!==globalThis||(e=document.body),e.nodeType===e.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e.classList.contains("b-resize-monitored")||(e.classList.add("b-resize-monitored"),e._bResizemonitor={handlers:[]}),e===document.body)n.hasWindowResizeListener||(globalThis.addEventListener("resize",n.onWindowResize),n.hasWindowResizeListener=!0);else if(globalThis.ResizeObserver)n.resizeObserver||(n.resizeObserver=new ResizeObserver(n.onElementResize)),n.resizeObserver.observe(e);else{e.classList.add("b-no-resizeobserver");const[r,s,i]=yr.createElement({parent:e,className:"b-resize-monitors",children:[{className:"b-resize-monitor-expand"},{className:"b-resize-monitor-shrink"}]},{returnAll:!0});s.scrollLeft=s.scrollTop=i.scrollLeft=i.scrollTop=1e6,s.addEventListener("scroll",n.onSizeMonitorScroll,!0),i.addEventListener("scroll",n.onSizeMonitorScroll,!0),(t.targetMutationMonitor=new MutationObserver((e=>{const t=[],n=[];for(const r of e)"childList"===r.type&&(t.push.apply(t,r.addedNodes),n.push.apply(n,r.removedNodes));const r=[...t.filter((e=>!n.includes(e))),...n.filter((e=>!t.includes(e)))];0!==r.length&&(r.length>0&&r.every(vo)||s.dispatchEvent(new CustomEvent("scroll",{bubbles:!1})))}))).observe(e,{childList:!0,subtree:!0}),t.monitorElement=r}e._bResizemonitor.handlers.push(t)}static removeResizeListener(e,t){if(e){e!==document&&e!==globalThis||(e=document.body);const n=e._bResizemonitor;let r=0;n&&n.handlers&&(ge.remove(n.handlers,t),r=n.handlers.length),r||(e.classList.remove("b-resize-monitored"),this.resizeObserver?this.resizeObserver.unobserve(e):(t.monitorElement&&(t.monitorElement.remove(),t.monitorElement=null),t.targetMutationMonitor&&t.targetMutationMonitor.disconnect()))}}static onElementResize(e){for(const t of e){const e=t.target,n=e._bResizemonitor,r=t.contentRect||e.getBoundingClientRect();if(or(e)&&(!n.rectangle||r.width!==n.rectangle.width||r.height!==n.rectangle.height)){const t=n.rectangle;n.rectangle=r;for(const s of n.handlers)s(e,t,r)}}}static onSizeMonitorScroll(e){var t;if(e.target.isConnected||null!==(t=document.body)&&void 0!==t&&t.contains(e.target)){e.stopImmediatePropagation();const t=e.target.parentNode,n=t.parentNode,r=n._bResizemonitor,s=n.getBoundingClientRect();r.rectangle&&s.width===r.rectangle.width&&s.height===r.rectangle.height||(fo.push([n,r.rectangle,s]),r.rectangle=s,po||(po=requestAnimationFrame(yo.fireResizeEvents))),t.firstChild.scrollLeft=t.firstChild.scrollTop=t.childNodes[1].scrollTop=t.childNodes[1].scrollLeft=1e6}}static onWindowResize(e){const t=document.body,n=t._bResizemonitor,r=n.rectangle;n.rectangle=document.documentElement.getBoundingClientRect();for(const e of n.handlers)e(t,r,n.rectangle)}static fireResizeEvents(){for(const e of fo)for(const t of e[0]._bResizemonitor.handlers)e[0].offsetParent&&t.apply(this,e);po=null,fo.length=0}static removeGlobalListeners(){globalThis.removeEventListener("resize",this.onWindowResize)}}yo._$name="ResizeMonitor";const bo={auto:"auto",true:"auto",false:"hidden","hidden-scroll":"auto",clip:r.supportsOverflowClip?"clip":"hidden"},Co="b-widget-scroller",So={block:"nearest"},wo=Promise.resolve(),Do=e=>new Promise((t=>Mn.on({element:e===document.documentElement?globalThis:e,scroll:t,once:!0}))),To={x:1},Eo={auto:1,scroll:1},xo={true:1,auto:1},ko={overflowX:"auto",overflowY:"auto"};class Io extends(Ur(Ne(ue))){static get configurable(){return{widget:null,element:{$config:{nullify:!0},value:null},contentElement:{$config:{nullify:!0},value:null},overflowX:null,overflowY:null,translate:null,x:0,y:0,rtlSource:null,propagateSync:null}}static get delayable(){return{onScrollEnd:{type:"buffer",delay:100}}}get isRTL(){var e;return Boolean(null===(e=this.rtlSource)||void 0===e?void 0:e.rtl)}syncOverflowState(){const e=this,{element:t}=e,{hasOverflowX:n,hasOverflowY:r}=e,s=e.hasOverflowX=t.scrollWidth>t.clientWidth,i=e.hasOverflowY=t.scrollHeight>t.clientHeight;if(n!==s||r!==i){const n=new Sn(t.classList,{"b-horizontal-overflow":s,"b-vertical-overflow":i});yr.syncClassList(t,n),e.isConfiguring||e.trigger("overflowChange",{x:s,y:i})}}hasOverflow(e="y"){const t=this,n=t[`overflow${e.toUpperCase()}`],r=t["overflow"+("y"===e?"x":"y")];if(!yr.scrollBarWidth||!xo[n]||"hidden-scroll"===r){const n="y"===e?"Height":"Width";return t[`scroll${n}`]>t[`client${n}`]}return t[`hasOverflow${e.toUpperCase()}`]}hasScrollbar(e="y"){const{element:t}=this;if(t&&yr.scrollBarWidth){const n="y"===e,r=n?"Width":"Height",s=t[`client${r}`],i=parseInt(yr.getStyleValue(t,`border${n?"Left":"Top"}Width`))+parseInt(yr.getStyleValue(t,`border${n?"Right":"Bottom"}Width`)),a=t[`offset${r}`]-i-s;return Math.abs(a-yr.scrollBarWidth)<2}}addPartner(e,t=To){const n=this;"string"==typeof t&&(t={[t]:1}),n.partners||(n.partners={}),n.partners[e.id]={scroller:e,axes:t},t.x&&(e.x=n.x),t.y&&(e.y=n.y),e.isPartneredWith(n)||e.addPartner(n,t)}eachPartner(e){const{partners:t}=this;t&&Object.values(t).forEach(e)}removePartner(e){e&&this.isPartneredWith(e)&&(delete this.partners[e.id],e.removePartner(this))}isPartneredWith(e){var t;return Boolean(null===(t=this.partners)||void 0===t?void 0:t[e.id])}clearPartners(){this.partners&&Object.values(this.partners).forEach((e=>e.scroller.removePartner(this)))}async scrollIntoView(e,t=So){const n=this,{isRectangle:r}=e,s=r?e:vn.from(e),{xDelta:i,yDelta:a}=n.getDeltaTo(e,t),o=n.scrollBy(i,a,t);return(t.highlight||t.focus)&&o.then((()=>{var o;e=r?s.translate(-i,-a):(null===(o=t.elementAfterScroll)||void 0===o?void 0:o.call(t))??e,t.highlight&&(isNaN(t.highlight)?(n.widget||n).callback(t.highlight,null,[e]):yr.highlight(e,n)),t.focus&&yr.focusWithoutScrolling(e)})),o}static async scrollIntoView(e,t=So,n=!1){const r=vn.from(e),s="object"==typeof t?t.animate:t,i=Io._globalScroller||(Io._globalScroller=new Io),a=[];i.rtlSource={rtl:n};let o,l=0,c=0;for(let n=e.parentNode;n.nodeType===Node.ELEMENT_NODE;n=n.parentNode){if(n===document.body&&n!==document.scrollingElement)continue;const e=n===document.scrollingElement?ko:n.ownerDocument.defaultView.getComputedStyle(n);if(!1!==t.y&&Eo[e.overflowY]&&n.scrollHeight>n.clientHeight||!1!==t.x&&Eo[e.overflowX]&&n.scrollWidth>n.clientWidth){i.element=n,i.positionDirty=!0;const{xDelta:e,yDelta:s}=i.getDeltaTo(r,t);(e||s)&&(a.push({element:n,x:n.scrollLeft,y:n.scrollTop,xDelta:e,yDelta:s}),r.translate(-e,-s),l+=e,c+=s)}}if(a.length){const e=Math.abs(l),t=Math.abs(c);let r=s&&("number"==typeof s?s:"number"==typeof s.duration?s.duration:300);if(r&&(e>10||t>10))Math.max(e,t)<50&&(r=Math.min(r,500)),o=i.scrollAnimation=Ce.animate(r,(e=>{const t=1===e;for(const{element:r,x:s,y:o,xDelta:l,yDelta:c}of a)i.element=r,l&&(i.x=Math[n?"min":"max"](s+(t?l:Math.round(l*e)),0)),c&&(i.y=Math.max(o+(t?c:Math.round(c*e)),0))}),null,s.easing),o.then((()=>{i.scrollAnimation=null}));else{for(const{element:e,xDelta:t,yDelta:n}of a)e.scrollTop+=n,e.scrollLeft+=t;o=Do(a[a.length-1].element)}}else o=wo;return(t.highlight||t.focus)&&o.then((()=>{t.highlight&&(isNaN(t.highlight)?i.callback(t.highlight,null,[e]):yr.highlight(e,i)),t.focus&&e.focus()})),o}scrollBy(e=0,t=0,n=So){const r=this,s="object"==typeof n?n.animate:n,i=Math.abs(e),a=Math.abs(t);r.scrollAnimation&&(r.scrollAnimation.cancel(),r.scrollAnimation=null),(e||t)&&(r.silent=n.silent);let o=s&&("number"==typeof s?s:"number"==typeof s.duration?s.duration:300);if(o&&(i>10||a>10)){const{x:l,y:c}=r;let d=l,u=c;return Math.max(i,a)<50&&(o=Math.min(o,500)),r.scrollAnimation=Ce.animate(o,(s=>{const i=1===s;if(e){var a;if(Math.abs(r.x-d)>1&&!n.force)return null===(a=r.scrollAnimation)||void 0===a?void 0:a.cancel();r.x=Math.max(l+(i?e:Math.round(e*s)),0)}if(t){var o;if(Math.abs(r.y-u)>1&&!n.force)return null===(o=r.scrollAnimation)||void 0===o?void 0:o.cancel();r.y=Math.max(c+(i?t:Math.round(t*s)),0)}d=r.x,u=r.y}),r,s.easing),r.element.classList.add("b-scrolling"),r.scrollAnimation.then((()=>{r.isDestroyed||(r.element.classList.remove("b-scrolling"),r.scrollAnimation=null)})),r.scrollAnimation}if(e||t){const n=r.x,s=r.y;if(Math.round(i)>=1&&(r.x+=e),Math.round(a)>=1&&(r.y+=t),r.x!==n||r.y!==s)return Do(r.element)}return wo}async scrollTo(e,t,n){const{x:r,y:s}=this,i=null==e?0:e-r,a=null==t?0:t-s;return this.scrollingToCenter=null==n?void 0:n.scrollingToCenter,this.scrollBy(i,a,n)}doDestroy(){var e;const t=this;var n;t._element&&(t._element.removeEventListener("scroll",t.scrollHandler),null===(n=t.wheelListenerRemover)||void 0===n||n.call(t));null===(e=t.scrollAnimation)||void 0===e||e.cancel(),Object.values(t.partners||{}).forEach((({scroller:e})=>e.removePartner(t))),super.doDestroy()}onElMutation(e){const t=this,[n,r]=yr.getTranslateXY(t.element);if(t._x!==-n||t.y!==-r){const e=new CustomEvent("scroll",{bubbles:!0});Object.defineProperty(e,"target",{get:()=>t.element}),t.onScroll(e)}}onElResize(){const e=this,{widget:t}=e;null!=t&&t.isAnimating?-1===t.findListener("animationend","onElResize",e)&&t.ion({animationEnd:"onElResize",thisObj:e,once:!0}):e.syncOverflowState()}onScroll(e){const t=this,{_x:n,_y:r,element:s}=t;let i=0;"clip"===t.overflowX&&s.scrollLeft!==n&&(s.scrollLeft=n,++i),"clip"===t.overflowY&&s.scrollTop!==r&&(s.scrollTop=r,++i),2!==i&&(t.widget&&t.widget.isDestroyed||(t.positionDirty=!0,s.classList.contains("b-scrolling")||s.classList.add("b-scrolling"),e.widget=t.widget,e.scrollingToCenter=t.scrollingToCenter,t.silent||t.trigger("scroll",e),t.syncPartners(),t.controllingPartner=null,t.onScrollEnd(e)))}syncPartners(e,t=this.propagateSync){const n=this;n.partners&&Object.values(n.partners).forEach((({axes:r,scroller:s})=>{(s!==n.controllingPartner||e)&&s.sync(n,r)&&t&&s.syncPartners(e,t)}))}onScrollEnd(e){const t=this;t.silent&&(t.silent=!1),t.trigger("scrollEnd",e),t.scrollingToCenter=!1,t.controllingPartner=null,t.element.classList.remove("b-scrolling")}getDeltaTo(e,t){const n=this;if(!n.viewport)return{xDelta:0,yDelta:0};const{x:r,y:s,scrollWidth:i,scrollHeight:a,isRTL:o}=n,l=e instanceof vn?e:vn.from(e),c=t.block||"nearest",d=n.viewport,u=(e=>{let t,n,r,s;return e?"number"==typeof e?t=n=r=s=e:(t=e.top??0,n=e.bottom??0,r=e.start??0,s=e.end??0):t=n=r=s=0,{top:t,bottom:n,start:r,end:s}})(t.edgeOffset),h=d.width>=l.width+(u.start+u.end)?u:{start:0,end:0},g=d.height>=l.height+(u.top+u.bottom)?u:{top:0,bottom:0},m=new vn(o?d.right- -r-i:d.x-r,d.y-s,i,a),p=l.clone().adjust(-h.start,-g.top,h.end,g.bottom).constrainTo(m),f=p.clone(),v=n.isRTL?-1:1;let y=0,b=0;if("start"===c)f.moveTo(d.x+(n.isRTL?d.width-f.width:0),d.y),y=p.x-f.x,b=p.y-f.y;else if("end"===c)f.moveTo(d.x+(n.isRTL?0:d.width-f.width),d.bottom-f.height),y=p.x-f.x,b=p.y-f.y;else if("center"===c){const e=d.center;f.moveTo(e.x-f.width/2,e.y-f.height/2),y=y||p.x-f.x,b=b||p.y-f.y}else f.width>d.width?y=f.x-d.x:f.right>d.right?y=f.right-d.right:f.x<d.x&&(y=f.x-d.x),f.height>d.height?b=f.y-d.y:f.bottom>d.bottom?b=f.bottom-d.bottom:f.y<d.y&&(b=f.y-d.y);return y=v*Math.round(y),b=Math.round(b),!1!==t.constrainToScrollable&&(y=Math.max(Math.min(y,n.maxX-r),-r),b=Math.max(Math.min(b,n.maxY-s),-s)),{xDelta:!1===t.x?0:y,yDelta:!1===t.y?0:b}}get viewport(){return vn.client(this.element)}updateWidget(e){this.rtlSource=this.owner=e}updateElement(e,t){const n=this;if(n===Io._globalScroller)return n._element=e,void(n.positionDirty=!0);const r=n.scrollHandler||(n.scrollHandler=n.onScroll.bind(n)),s=n.resizeHandler||(n.resizeHandler=n.onElResize.bind(n));if(t){var i;if(n.translate)null===(i=n.mutationObserver)||void 0===i||i.disconnect();else t.removeEventListener("scroll",r),t.classList.remove(Co),t.style.overflowX=t.style.overflowY="";yo.removeResizeListener(t,s)}if(e){if(n.translate){if(n.mutationObserver||(n.mutationObserver=new MutationObserver(n.mutationHandler||(n.mutationHandler=n.onElMutation.bind(n)))),n._x=n._y=0,document.contains(e)){const[t,r]=yr.getTranslateXY(e);n._x=-t,n._y=-r}n.mutationObserver.observe(e,{attributes:!0})}else e.addEventListener("scroll",r),e.classList.add(Co);yo.addResizeListener(e,s),n.widget||(n.rtlSource={get rtl(){return"rtl"===yr.getStyleValue(e,"direction")}}),n.isRTL&&e.classList.add("b-rtl"),n.positionDirty&&(n.updateOverflowX(n.overflowX),n.updateOverflowY(n.overflowY)),n.syncOverflowState(),n.isConfiguring&&(n._x&&n.updateX(n._x),n._y&&n.updateY(n._y))}n.positionDirty=!0}get x(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[n,r]=yr.getTranslateXY(t);e._x=-n,e._y=-r}else e._x=Math.abs(t.scrollLeft),e._y=t.scrollTop;e.positionDirty=!1}return e._x}get scrollLeft(){return this.x*(this.isRTL?-1:1)}changeX(e){if(e=Math.max(e,0),!this.isConfiguring||e)return e;this._x=e}updateContentElement(e){e&&(e="string"==typeof e?this.element.querySelector(e):e,yo.addResizeListener(e,this.resizeHandler))}updateX(e){var t;const n=this,{element:r}=n;!r||null!==(t=n.widget)&&void 0!==t&&t.isConfiguring||(e=Math.round(e),n.trigger("scrollStart",{x:e}),n.translate?yr.setTranslateX(r,-e):r.scrollLeft=n.isRTL?-e:e),n.positionDirty=!0}sync(e,t){const n=this,{x:r,y:s}=t;let i=!1;return null!=r&&n.x!==e.x&&(n.controllingPartner=e,n.x=e.x,i=!0),null!=s&&n.y!==e.y&&(n.controllingPartner=e,n.y=e.y,i=!0),i}get y(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[n,r]=yr.getTranslateXY(t);e._x=-n,e._y=-r}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._y}changeY(e){if(!this.isConfiguring||e)return e;this._y=e}updateY(e){const{element:t,widget:n}=this;!t||null!=n&&n.isConfiguring||(this.trigger("scrollStart",{y:e}),this.translate?yr.setTranslateY(t,-e):t.scrollTop=e),this.positionDirty=!0}get maxX(){return this.scrollWidth-this.clientWidth}get maxY(){return this.scrollHeight-this.clientHeight}get lastScrollLeft(){return(this.scrollWidth-this.clientWidth)*(this.isRTL?-1:1)}updateOverflowX(e,t){const n=this,{element:r,translate:s}=n,{style:i,classList:a}=r;if("hidden-scroll"===t&&a.remove("b-hide-scroll"),"hidden-scroll"===e&&!s){Eo[i.overflowY]?(e="hidden",n.enableWheel()):a.add("b-hide-scroll")}s||(i.overflowX=bo[e]||e),n.isConfiguring||(n.positionDirty=!0,n.syncOverflowState())}updateOverflowY(e,t){const n=this,{element:r,translate:s}=n,{style:i,classList:a}=r;if("hidden-scroll"===t&&a.remove("b-hide-scroll"),"hidden-scroll"===e&&!s){Eo[i.overflowX]?(e="hidden",n.enableWheel()):a.add("b-hide-scroll")}s||(i.overflowY=bo[e]||e),n.isConfiguring||(n.positionDirty=!0,n.syncOverflowState())}enableWheel(){this.wheelListenerRemover||(this.wheelListenerRemover=Mn.on({element:this.element,wheel:"onWheel",thisObj:this}))}onWheel(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)&&"hidden-scroll"===this.overflowX?this.x+=e.deltaX:"hidden-scroll"===this.overflowY&&(this.y+=e.deltaY)}get scrollWidth(){var e;return(null===(e=this.element)||void 0===e?void 0:e.scrollWidth)??0}set scrollWidth(e){const t=this,{element:n,isRTL:r}=t;let s=t.widthStretcher;s&&null==e?(s.remove(),t.widthStretcher=null):e&&(e=Math.abs(e),s||(s=t.widthStretcher=yr.createElement({className:"b-scroller-stretcher b-horizontal-stretcher",retainElement:!0})),s.style.transform=`translateX(${(e-1)*(r?-1:1)}px)`,n&&!n.contains(s)&&n.insertBefore(s,n.firstElementChild)),!1!==t.propagate&&t.eachPartner((({scroller:t})=>{t.propagate=!1,t.scrollWidth=e,delete t.propagate})),t.positionDirty=!0,t.syncOverflowState()}get scrollHeight(){var e;return(null===(e=this.element)||void 0===e?void 0:e.scrollHeight)??0}set scrollHeight(e){const t=this,n=t.stretcher||(t.stretcher=yr.createElement({className:"b-scroller-stretcher"}));n.style.transform=`translateY(${e-1}px)`,t.element&&t.element.lastChild!==n&&t.element.appendChild(n),t.positionDirty=!0,t.syncOverflowState()}get clientWidth(){var e;return(null===(e=this.element)||void 0===e?void 0:e.clientWidth)||0}get clientHeight(){var e;return(null===(e=this.element)||void 0===e?void 0:e.clientHeight)||0}get id(){return this._id||(this.widget?this._id=`${this.widget.id}-scroller`:this._id=Us.generateId("scroller-")),this._id}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(),delete e.widget,delete e.element}}Io._$name="Scroller";class Ro{constructor(e){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t})),e&&e(this)}}Ro._$name="Promissory";const{defineProperty:Mo}=Reflect;class Oo extends(ue.mixin(Je,Ne,Ur,rs)){static get configurable(){return{element:null}}static get delayable(){return{refreshDom:"raf"}}static get identifiable(){return{}}static get renderConfigs(){const e=this,t=e.$meta;let n,r,s=t.renderConfigs;if(void 0===s){for(r in s=null,n=t.configs,n)n[r].render&&(s||(s=new Set)).add(r);t.renderConfigs=e.prototype.$renderConfigs=s}return s}construct(...e){this.$iid=++Oo.$idSeed,this.byRef={},super.construct(...e),this.onDraw!==Oo.prototype.onDraw&&this.initDrawable()}startConfigure(e){this.element=this.renderContext.renderDom(),super.startConfigure(e)}get element(){return this.refreshDom.flush(),this._element}changeElement(e,t){const n=this;return t&&t.remove(),e&&(e.id=n.id,e=yr.createElement(e,{refOwner:n})),e}updateId(e,t){const n=this;if(t){const r=n.element;r.id=e,n.fixRefOwnerId(r,e,t)}}get classes(){return this.element.classList}fixRefOwnerId(e,t,n){if(e.$refOwnerId===n){e.$refOwnerId=t;const r=e.$reference;r&&(e.id=`${t}-${r}`);for(const r of e.childNodes)this.fixRefOwnerId(r,t,n)}}onConfigChange({name:e}){!this.isConfiguring&&this.$renderConfigs.has(e)&&this.refreshDom()}attachRef(e,t,n){const r=this,s="_"+e,{listeners:i}=n;s in r||Mo(r,e,{get:()=>(r.refreshDom.flush(),r[s]),set(e){r[s]=e}}),t.id=`${r.id}-${e}`,r.byRef[e]=t,r[e]=t,i&&(n.listeners={on:i,un:Mn.on(Object.assign({element:t,thisObj:r},i))})}detachRef(e,t,n){n.listeners&&(n.listeners.un(),n.listeners=null),this[e]=null,delete this.byRef[e]}renderDom(){return{}}get renderContext(){const e=this,t=e.$meta,n=e.constructor;let r=t.renderConfigs||n.renderConfigs,s=e;if(!r){s=Object.create(e),r=new Set;for(const n in t.configs)Mo(s,n,{get:()=>(r.add(n),e[n])});s.renderDom=()=>e.renderDom.call(s),e.$renderConfigs=r}return Mo(e,"renderContext",{value:s}),s}refreshDom(){go.sync({targetElement:this.element,domConfig:this.renderContext.renderDom(),refOwner:this,strict:!0})}onListen(e){"draw"===e&&this.initDrawable()}initDrawable(){const e=this;if(!e.intersector){let t=Object.values(e.byRef).find((e=>e.classList.contains("b-drawable")));t||(t=e.element,t.classList.add("b-drawable")),e.intersector=new IntersectionObserver((t=>{e.isDestroyed||t.forEach((t=>{t.isIntersecting&&e.onDraw({count:++e.drawCounter})}))})),e.intersector.observe(t)}}onDraw(e){this.trigger("draw",e)}}Oo.$idSeed=0,Object.assign(Oo.prototype,{drawCounter:0,hasGeneratedId:!1,intersector:null}),Oo._$name="Renderable";class Ao extends Oo{static $name="Mask";static type="mask";static configurable={autoClose:null,cover:null,icon:"b-icon b-icon-spinner",errorDefaults:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},maxProgress:null,mode:"dark",progress:null,owner:{$config:"nullify",value:null},target:null,text:null,type:null,showDelay:null,useTransition:!1};static delayable={deferredClose:0,delayedShow:0,syncCover:{type:"throttle",delay:100}};static counter=0;static masks=[];construct(e){if(e){let t,n=e.element;n&&(P.deprecate("Core","4.0.0",'Mask "element" config has been renamed to "target"'),e=t=Object.assign({},e),delete t.element,t.target=n),n=e.target,"string"==typeof n&&(e=t=t||Object.assign({},e),t.target=e.owner[n])}super.construct(e);const t=this,{type:n}=t;t.target||(t.target=document.body),t.maskName=`mask${"string"==typeof n?n.trim():""}-${Ao.counter++}`,t.show()}doDestroy(){const e=this,{element:t}=e;if("trial"===e.type)return!1;t&&(e.element=null,e.mode.endsWith("blur")&&yr.forEachChild(t,(t=>{t.classList.remove(`b-masked-${e.mode}`)})),e.target.classList.remove("b-masked"),e.target[e.maskName]=null,ge.remove(Ao.masks,e)),super.doDestroy()}get maskElement(){return this.element}set error(e){this.setConfig(this.errorDefaults),this.text=e}renderDom(){const e=this,{maxProgress:t}=e;return{class:{"b-mask":1,"b-delayed-show":e.showDelay,"b-widget":1,[`b-mask-${e.mode}`]:1,"b-progress":t,"b-prevent-transitions":!e.useTransition},children:[{reference:"maskContent",class:"b-mask-content b-drawable",children:[t?{reference:"progressElement",class:"b-mask-progress-bar",style:{width:`${Math.max(0,Math.min(100,Math.round(e.progress/t*100)))}%`}}:null,{reference:"maskText",class:"b-mask-text",html:(e.icon?`<i class="b-mask-icon ${e.icon}"></i>`:"")+e.text}]}]}}static mergeConfigs(...e){const t={};for(const n of e)"string"==typeof n?t.text=n:Ut.assign(t,n);return t}static mask(e,t=document.body){return Ao.new({target:t},"string"!=typeof e?{...e}:{text:e})}static unmask(e=document.body){const t=this.getElementMasks(e);return t.length>0?t[t.length-1].close():null}static unmaskAll(e=document.body){return this.getElementMasks(e).forEach((e=>e.close()))}static getElementMasks(e){return this.masks.filter((t=>t.target===e))}updateAutoClose(e){this.deferredClose.cancel(),e&&(this.deferredClose.delay=e,this.deferredClose())}updateCover(){this.syncCover()}syncCover(){var e,t;null===(e=this.owner)||void 0===e||null===(t=e.syncMaskCover)||void 0===t||t.call(e,this)}onOwnerResize(){this.syncCover()}updateOwner(e){this.detachListeners("cover"),null==e||e.ion({name:"cover",recompose:"onOwnerResize",resize:"onOwnerResize",thisObj:this})}updateShowDelay(e){const{delayedShow:t}=this;t.delay=e,e||t.flush()}deferredClose(){var e;const{owner:t}=this;this.close().then((()=>{var e;null==t||null===(e=t.onMaskAutoClose)||void 0===e||e.call(t,this)})),null==t||null===(e=t.onMaskAutoClosing)||void 0===e||e.call(t,this)}delayedShow(){this.classes.remove("b-delayed-show")}show(){const e=this,{element:t,target:n,hiding:r,maskName:s}=e;r&&(r.resolve(),e.hiding=null,e.clearTimeout("hide")),e.showDelay&&(t.classList.add("b-delayed-show"),e.delayedShow()),t.classList.add("b-visible"),t.classList.remove("b-hidden"),n.classList.add("b-masked"),n[s]||(n[s]=e,n.appendChild(t)),ge.include(Ao.masks,e),e.shown=!0,e.trigger("show"),e.mode.endsWith("blur")&&yr.forEachChild(n,(n=>{n!==t&&n.classList.add(`b-masked-${e.mode}`)}))}hide(){const e=this,{target:t,element:n}=e;let{hiding:r}=e;if(!r){if(!e.shown)return Promise.resolve();e.hiding=r=new Ro,e.shown=!1,n.classList.remove("b-visible"),n.classList.add("b-hidden"),t.classList.remove("b-masked"),e.mode.endsWith("blur")&&yr.forEachChild(t,(t=>{t!==n&&t.classList.remove(`b-masked-${e.mode}`)})),r.promise=r.promise.then((()=>{e.hiding===r&&(e.hiding=null)})),e.setTimeout((()=>r.resolve()),500,"hide")}return r.promise}async close(){await this.hide(),this.destroy()}}Ao._$name="Mask";var Fo=e=>class extends(e||ue){static $name="KeyMap";get widgetClass(){}get keyMapElement(){return this.element}get keyMapSubComponents(){return this.features}static configurable={keyMap:{value:null,$config:{merge:"objects",nullify:!0}}};matchKeyMapEntry(e,t=this.keyMap){if(t&&!e.handled&&void 0!==e.key)return Ut.keys(t).find((t=>{const n=t.split("+"),r=n.includes("Alt"),s=n.includes("Shift"),i=n.includes("Ctrl");let a=n[n.length-1].toLowerCase();return"space"===a&&(a=" "),a===e.key.toLowerCase()&&(!e.altKey&&!r||e.altKey&&r)&&(!e.ctrlKey&&!i||e.ctrlKey&&i)&&(!e.shiftKey&&!s||e.shiftKey&&s)}))}performKeyMapAction(e){const{keyMap:t}=this;let n=!1;if(t&&!e.handled&&void 0!==e.key){const s=this.matchKeyMapEntry(e);if(t[s]){const i=ge.asArray(t[s]);let a;e.fromKeyMap=!0;for(let t of i){if(a=!0,Ut.isObject(t)){if(!t.handler)continue;!1===t.preventDefault&&(a=!1),t=t.handler}if("string"==typeof t){var r;const{thisObj:i,handler:a}=this.resolveKeyMapAction(t);if(!1!==(null===(r=i.isActionAvailable)||void 0===r?void 0:r.call(i,{key:s,action:t,event:e,actionName:t.split(".").pop()}))&&!1!==a.call(i,e)){n=!0;break}}else if(!1!==t.call(this)){n=!0;break}}delete e.fromKeyMap,n&&(a&&e.preventDefault(),e.handled=!0)}}return n}resolveKeyMapAction(e){const{keyMapSubComponents:t}=this;if(e.startsWith("up.")||e.startsWith("this."))return this.resolveCallback(e);if(t&&e.includes(".")){const[n,r]=e.split(".");if(n&&r)return{thisObj:t[n],handler:t[n][r]}}return{thisObj:this,handler:this[e]}}updateKeyMap(e){var t;null===(t=this.keyMapDetacher)||void 0===t||t.call(this),Ut.isEmpty(e)||(this.keyMapDetacher=Mn.on({element:this.keyMapElement,keydown:"keyMapOnKeyDown",thisObj:this}))}keyMapOnKeyDown(e){this.performKeyMapAction(e)}mergeKeyMaps(e,t,n=null){const r={};e&&Ut.assign(r,e);for(const s in t){if(!t[s])continue;const i=ge.asArray(null==e?void 0:e[s]),a=[];if(null!=i&&i.length&&a.push(...i),null==i||!i.some((e=>{const t=e.handler?e.handler:e;return"string"==typeof t&&t.startsWith(n+".")}))){for(const e of ge.asArray(t[s]))Ut.isObject(e)&&e.handler?a.push(Ut.assignIf({handler:(n?n+".":"")+e.handler},e)):"function"==typeof e?a.push(e):a.push((n?n+".":"")+e);a.sort(((e,t)=>{const n=(e.weight||0)-(t.weight||0);return 0===n&&null!=i&&i.length?i.indexOf(e)-i.indexOf(t):n}))}r[s]=a}return r}},Po=e=>class extends(e||ue){static $name="RTL";get widgetClass(){}static configurable={rtl:null};get isRTL(){return this.rtl}updateRtl(e){const{element:t}=this;t&&(t.classList.toggle("b-rtl",!0===e),t.classList.toggle("b-ltr",!1===e))}startConfigure(e){var t;if(null===(t=super.startConfigure)||void 0===t||t.call(this,arguments),!e.floating&&null==e.rtl){var n;const t=this,r=e.rootElement||e.forElement||(null===(n=t.parent)||void 0===n?void 0:n.contentElement)||(t.floating?t.floatRoot:t.changeElementRef(t.getRenderContext(e)[0]||e.adopt||document.body)),s=e.owner||e.parent||t.constructor.fromElement(r);e.rtl=s?s[s.isConfiguring?"peekConfig":"getConfig"]("rtl"):1===(null==r?void 0:r.nodeType)&&"rtl"===getComputedStyle(r).getPropertyValue("direction"),e.rtl&&(t.configDone.rtl=!1)}}render(...e){var t,n;(super.render&&super.render(...e),(r.isChrome&&r.chromeVersion<87||r.isFirefox&&r.firefoxVersion<66||r.isSafari&&r.safariVersion<14.1)&&this.element.classList.add("b-legacy-inset"),"rtl"===getComputedStyle(this.element).direction||null!==(t=this.owner)&&void 0!==t&&t.rtl)&&(this.rtl=!0,null===(n=this.childItems)||void 0===n||n.forEach((e=>e.rtl=!0)))}};const Lo=Object.freeze({highlight:!1,onlyName:!1}),$o=[],_o="highlightExternalChange",No=/transparent|rgba\(0,\s*0,\s*0,\s*0\)/,jo=Symbol("renderConfigObserver"),Vo={INPUT:1,TEXTAREA:1},Bo=(e,t,n,r)=>{var s;let i=(null==n?void 0:n.listeners)||(null==n?void 0:n.internalListeners);if(i=(null===(s=i)||void 0===s?void 0:s.on)||i,i){const s=Mn.on(Ut.assign({element:t,thisObj:e},i));r?(e._refListeners||(e._refListeners=Object.create(null)))[r]=s:n.listeners={on:i,un:s}}},zo=(e,t)=>e&&t&&t[Ut.keys(e)[0]]?Y.merge(e,t):e,Wo=e=>{e.isVisible&&e.triggerPaint()},Ho=/^:not\((.+)\)$/,Uo=/absolute|fixed/i,Yo=e=>null!=e.scale,{hasOwn:qo}=Ut,{defineProperty:Ko}=Reflect,Go=e=>parseFloat(e)*(e.endsWith("ms")?1:1e3),Xo=["b-aligned-above","b-aligned-right","b-aligned-below","b-aligned-left"],Zo={configurable:!0,get:()=>!1},Jo=/(?:L\{([^}.]+)\})/,Qo=(e,t)=>"L{Tooltip."+t+"}",el=/^([trblc])(\d*)-([trblc])(\d*)$/i,tl=(e,t)=>(el.test(e)&&(e={align:e}),el.test(t)&&(t={align:t}),Y.merge(e,t)),nl=/^[\w.]+$/,rl={1:"maxHeight",2:"height",4:"maxWidth",8:"width"},sl=e=>!e.isRipple&&!e.closest((e=>e.isMessageDialog||e.isSharedTooltip));class il extends(ue.mixin(Je,Ne,Ur,rs,fs,Fo,Po)){static mergeCls(e,t){return t&&e?e=new Sn(t).assign("string"==typeof e?new Sn(e):e):e&&!e.isDomClassList&&(e=new Sn(e)),e}static get $name(){return"Widget"}static get type(){return"widget"}static get configurable(){return{element:!0,callOnFunctions:!0,id:"",html:null,content:null,cls:{$config:{merge:"classList"},value:null},ui:{$config:{merge:"classList"},value:null},collapsify:null,contentElementCls:{$config:{merge:"classList"},value:null},defaultCls:{$config:{merge:"classList"},value:null},dock:null,forwardTwinEvents:{$config:{merge:"classList"},value:null},parent:null,tab:null,elementAttributes:null,htmlCls:{$config:{merge:"classList"},value:{"b-html":1}},style:null,disabled:null,readOnly:{value:null,default:!1,$config:null},ignoreParentReadOnly:null,adopt:null,appendTo:null,insertBefore:null,insertFirst:null,dataset:null,tooltip:{$config:["lazy","nullify"],value:null},showTooltipWhenDisabled:!0,preventTooltipOnTouch:null,monitorResize:{$config:["lazy","nullify"],value:null},masked:{$config:"nullify",value:null},maskDefaults:{target:"element"},cache:{},floating:null,positioned:null,draggable:null,align:{$config:{merge:tl},value:"t-b"},centered:null,constrainTo:void 0,anchor:null,owner:null,scrollAction:null,hideAnimation:{$config:{merge:zo},value:null},showAnimation:{$config:{merge:zo},value:null},x:null,y:null,scrollable:{$config:["lazy","nullify"],value:null},scrollerClass:Io,defaultBindProperty:"html",defaultAction:null,overflowable:{value:null,default:!0,$config:null},width:null,height:null,maxHeight:null,maxWidth:null,minWidth:null,minHeight:null,scaleToFitWidth:null,allowGrowWidth:!0,margin:null,flex:null,weight:null,alignSelf:null,ripple:null,title:null,localizableProperties:["title","ariaLabel","ariaDescription"],requireSize:!1,ref:null,hidden:null,textAlign:null,ignoreScrollDuration:500,tag:"div",recomposeAsync:null,rootElement:null,htmlMutationObserver:{$config:["lazy","nullify"],value:{childList:!0,subtree:!0}},role:{$config:"lazy",value:"presentation"},ariaLabel:{$config:"lazy",value:null},ariaDescription:{$config:"lazy",value:null},ariaElement:"element",ariaHasPopup:null,realignTimeout:300,testConfig:{ignoreScrollDuration:100,realignTimeout:50},maximizeOnMobile:null}}static get prototypeProperties(){return{hasGeneratedId:!1,innerItem:!0}}static get declarable(){return["renderConfigs"]}static get delayable(){return{recompose:"raf",doHideOrRealign:"raf",onAlignConstraintChange:"raf"}}static get factoryable(){return{defaultType:"widget"}}static get identifiable(){return{}}static get all(){return super.all}static get recomposeAsync(){return il._recomposeAsync}static set recomposeAsync(e){if(il._recomposeAsync=e,null!=e){const{all:t}=il;for(let n=0;n<t.length;++n)t[n].isComposable&&(t[n].recomposeAsync=e)}}isType(e,t){return il.isType(this,e,t)}static setupRenderConfigs(e,t){const n=t.getInherited("renderConfigs"),{renderConfigs:r}=e;if(r){if(Array.isArray(r))for(const e of r)n[e]=!0;else Ut.assign(n,r);n[jo]=null}}construct(e={},...t){const n=this,{domSyncCallback:r}=n;if(!globalThis.bryntum.cssVersion){const e=globalThis.bryntum.cssVersion=Ja.getCSSVersion(),t=P.getVersion("core");e&&e!==t&&console.warn(`CSS version ${e} doesn't match bundle version ${t}!\nMake sure you have imported css from the appropriate product version.`)}n.configureAriaDescription=e.ariaDescription,n._isAnimatingCounter=0,n.alignmentChanges=0,n.byRef=Object.create(null),n.onTargetResize=n.onTargetResize.bind(n),n.onFullscreenChange=n.onFullscreenChange.bind(n),n.domSyncCallback=r.$nullFn?null:r.bind(n),n._isUserAction=!1,super.construct(e,...t);const{recomposeAsync:s}=il;null!=s&&null==n.recomposeAsync&&(n.recomposeAsync=s),n.finalizeInit()}startConfigure(e){super.startConfigure(e);const t=this,{adopt:n,element:r}=t;n&&(t.adoptElement(r,n,e.id),t.updateElement(t._element,r))}finalizeInit(){const e=this,t=e.insertBefore||e.appendTo||e.insertFirst||e.adopt;var n;t&&(e.owner||null!==(n=t.nodeType?t:document.getElementById(t))&&void 0!==n&&n.isConnected?e.render():(e.onFirstResizeAfterConnect=e.onFirstResizeAfterConnect.bind(e),yo.addResizeListener(t,e.onFirstResizeAfterConnect)))}onFirstResizeAfterConnect(e){yo.removeResizeListener(e,this.onFirstResizeAfterConnect),this.isDestroyed||this.rendered||this.render()}doDestroy(){var e;const t=this,{preExistingElements:n,element:r,adopt:s,_refListeners:i,_rootElement:a,eventRoot:o}=t;if(mo.element===r&&mo.exit(),i&&(Object.values(i,(e=>e())),t._refListeners=null),r){var l,c,d;const e=!t._tooltip&&a&&(null===(l=il.Tooltip)||void 0===l?void 0:l.getSharedTooltip(a,o,!0));if((null==e?void 0:e.owner)===t&&(e.owner=null,e.hide()),t.onExitFullscreen(),t.clearTimeout(t.scrollListenerTimeout),t.clearTimeout(t.resizeListenerTimeout),t.removeTransientListeners(),t.floating||t.positioned?t.hide(!1):t.revertFocus(),yo.removeResizeListener(r.parentElement,t.onParentElementResize),yo.removeResizeListener(r,t.onElementResize),s){for(let e=Array.from(r.childNodes),s=0,{length:i}=e;s<i;s++){const r=e[s];n.includes(r)||r===t.floatRoot||r.remove()}r.className=t.adoptedElementClassName,r.style.cssText=t.adoptedElementCssText}null===(c=t.dragEventDetacher)||void 0===c||c.call(t),null===(d=t.dragOverEventDetacher)||void 0===d||d.call(t),t.dragGhost.remove()}null===(e=t.connectedObserver)||void 0===e||e.disconnect(),super.doDestroy(),o&&!Object.values(il.identifiable.idMap).some(sl)&&xr.detachFocusListeners(o),s||r.remove()}get assignValueDefaults(){return Lo}get valueName(){return this.name||this.ref||this.id}getValueName(e){return(e=e&&"object"==typeof e?e.onlyName:e)?this.name:this.valueName}assignFieldValue(e,t,n){const r=this,s=r.defaultBindProperty;s in r&&(r[s]=n)}assignValue(e,t=Lo){const n=this,r=n[_o],s=n.getValueName(t);!s||e&&!(s in e)||(!1===t.highlight&&(n[_o]=!1),n.assignFieldValue(e,s,e?e[s]:null),n[_o]=r)}gatherValue(e){const t=this,n=t.defaultBindProperty;t.constructor!==il&&n in t&&(e[t.name||t.ref||t.id]=t[n])}gatherValues(e){this.eachWidget((t=>t.gatherValue(e)),!1)}get forwardTwinEvents(){const e=this._forwardTwinEvents;return e&&Ut.getTruthyKeys(e)}configureOverflowTwin(e){var t;const n=this;let r=Ut.clone(n.initialConfig);return delete r.id,r.hidden=!1,r.type=n.type,r._overflowTwinOrigin=n,r.disabled=n.disabled,"value"in n&&(r.value=n.value),null===(t=n.forwardTwinEvents)||void 0===t||t.forEach((e=>{delete r[`on${T.capitalize(e)}`]})),e&&(r="function"==typeof e?e(r)||r:Ut.assign(r,e)),r}createOverflowTwin(e){var t;const n=this,r=n.configureOverflowTwin(e),s=il.create(r);return null===(t=n.forwardTwinEvents)||void 0===t||t.forEach((e=>{s.ion({[e]:e=>{n.overflowTwin===e.source&&(delete(e=Ut.assign({},e)).source,n.trigger(e.eventName,e))}})})),s}ensureOverflowTwin(e,t){let{overflowTwin:n}=this;return n||(this.overflowTwin=n=this.createOverflowTwin(e),null==t||t(n)),n}get isComposable(){return!this.compose.$nullFn}adoptElement(e,t,n){const r=this,s="string"==typeof t?document.getElementById(t):t,i=il.fromElement(s);if(i&&i.adopt&&i!==r){("string"==typeof i.adopt?document.getElementById(i.adopt):i.adopt)===s&&i.destroy()}r.preExistingElements=Array.from(s.childNodes),r.adoptedElementClassName=s.className,r.adoptedElementCssText=s.style.cssText,s.id&&!n&&(r.id=e.id=s.id),yr.syncAttributes(e,s);for(let t=0,{length:n}=e.childNodes;t<n;t++)s.appendChild(e.childNodes[0]);delete r._contentRange,r._element=s;const a=e.lastDomConfig,o=null==a?void 0:a.listeners;var l;o&&r.isComposable&&(null===(l=o.un)||void 0===l||l.call(o),Bo(r,s,a));s.lastDomConfig=a||s.lastDomConfig,s.$refOwnerId=r.id,r.scaleToFitWidth||r.getConfig("monitorResize")}addRefAccessor(e,t){const{prototype:n}=this.constructor;Ko(n,t,{writable:!0,value:null}),Ko(n,e,{get(){return this.recompose.flush(),this[t]},set(e){this[t]=e}})}attachRef(e,t,n){const r=this,s="_"+e;t.dataset&&(t.dataset.ownerCmp=r.id),r.isComposable&&(s in r||r.addRefAccessor(e,s),Bo(r,t,n,e)),r.byRef[e]=t,r[e]=t}detachRef(e,t,n){const r=this,s=r._refListeners;null!=s&&s[e]&&(s[e](),delete s[e]),r[e]=null,delete r.byRef[e]}afterRecompose(){}compose(){return{class:Sn.normalize(this.widgetClassList,"object")}}doCompose(){const e=this,{$meta:t}=e,n=t.hierarchy,r=t.renderConfigs||t.getInherited("renderConfigs");let s,i,a,o,{composers:l}=t,c=null;if(e.recompose.suspend(),!l){for(t.composers=l=[],a=n.indexOf(il);a<n.length;++a)o=n[a].prototype,qo(o,"compose")&&l.push(o);qo(r,jo)||(r[jo]={get(e){r[e]=!0}})}for(e.configObserver=r[jo],a=0;a<l.length;++a)s=l[a].compose.call(e,c),c=c?yr.merge(c,s):s;return qo(e,"compose")&&(s=e.compose)&&(s=s.call(e,c),yr.merge(c,s)),e.configObserver=null,yr.normalizeChildren(c,((t,n)=>{n&&(i="_"+t,i in e||e.addRefAccessor(t,i))}))}get element(){return this.isComposable&&!this.isDestroying&&this.recompose.flush(),this._element}domSyncCallback(e){}changeElement(e){const t=this,n=t.isComposable;return n&&(e=t.doCompose()),"string"==typeof e?e=yr.createElementFromTemplate(e):Ut.isObject(e)?(e=yr.createElement(e,{refOwner:t,callback:t.domSyncCallback}),t.recompose.resume(),n&&Bo(t,e,e.lastDomConfig)):yr.isReactElement(t.peekConfig("html"))?e=document.createElement("div"):1!==e.nodeType&&(e=yr.createElementFromTemplate(t.template(t))),e.id=t.id,t.elementAttributes&&yr.setAttributes(e,t.elementAttributes),e}updateElement(e){const t=this,{className:n}=e,{contentElement:r,contentElementCls:s,isComposable:i}=t,a=r!==e,o=!i&&e.querySelectorAll("[data-reference]"),l=i?[]:t.widgetClassList;let c=(a||!i)&&t.uiClasses;if(n&&l.unshift(n),t._hidden&&l.push("b-hidden"),t._readOnly&&l.push("b-readonly"),Ce.noThrow(e,"remove"),c?(null!=s&&s.value&&(c=c.slice(),c.push(s.value)),c=c.join(" ")):c=null==s?void 0:s.value,c&&(a?r.className+=" "+c:l.push(c)),!t.parent){const{defaultCls:e}=t,{outerCls:n}=il;l.push(...e?n.filter((t=>!(t in e)||e[t])):n)}if(e.className=l.join(" "),o)for(let e,n=0;n<o.length;++n)e=o[n],t.attachRef(e.getAttribute("data-reference"),e),e.removeAttribute("data-reference");t.adopt||t.scaleToFitWidth||t.getConfig("monitorResize"),t.getConfig("role"),t.getConfig("ariaLabel"),t.getConfig("ariaDescription"),t._html&&t.getConfig("htmlMutationObserver"),t.trigger("elementCreated",{element:e})}updateAriaDescription(e){const{ariaElement:t}=this,n=`${this.id}-aria-desc-el`;if(e){const r=this._ariaDescEl||(this._ariaDescEl=yr.createElement({className:"b-aria-desc-element",id:n,parent:t}));r.innerText=e.match(Jo)?this.L(e,this):e,t.setAttribute("aria-describedBy",r.id)}else t.getAttribute("aria-describedby")===n&&t.removeAttribute("aria-describedBy")}updateAriaLabel(e){yr.setAttributes(this.ariaElement,{"aria-label":null!=e&&e.match(Jo)?this.L(e,this):e})}updateAriaHasPopup(e){yr.setAttributes(this.ariaElement,{"aria-haspopup":e})}updateRole(e){var t,n;e?null===(t=this.ariaElement)||void 0===t||t.setAttribute("role",e):null===(n=this.ariaElement)||void 0===n||n.removeAttribute("role")}get ariaElement(){this.getConfig("element");const{_ariaElement:e}=this;return e.nodeType===Node.ELEMENT_NODE?e:Ut.getPath(this,e)}isCollapsified({collapsed:e,alt:t}){const{collapsify:n}=this,r=null==n;return t?"overlay"===n||r&&e:!1===n||"hide"===n||r&&!e}async recompose(){const e=this,t={targetElement:e.element,domConfig:e.doCompose(),refOwner:e,callback:e.domSyncCallback,strict:!0};if(e.transitionRecompose){if(e.isTransitioningDom=!0,await yr.transition(Ut.assign({element:e.element,action(){go.sync(t)}},e.transitionRecompose)),e.isDestroyed)return;e.isTransitioningDom=!1,e.trigger("transitionedRecompose")}else go.sync(t);t.changed&&(e.afterRecompose(),e.trigger("recompose")),e.resumeRecompose()}resumeRecompose(){this.recompose.resume()}changeElementRef(e){if("string"==typeof e){const t=e;if(!(e=document.getElementById(t)))throw new Error(`No element found with id '${t}'`)}return e}changeAppendTo(e){return this.changeElementRef(e)}updateAppendTo(e){!this.isConfiguring&&e&&this.render()}changeInsertBefore(e){return this.changeElementRef(e)}updateInsertBefore(e){!this.isConfiguring&&e&&this.render()}changeInsertFirst(e){return this.changeElementRef(e)}updateInsertFirst(e){!this.isConfiguring&&e&&this.render()}getRenderContext(e=this,t){let n=t||e.appendTo,{insertFirst:r,insertBefore:s}=e;return r&&(n=r,s=n.firstChild),s&&(n||(n=s.parentElement)),[n,s||void 0]}render(e,t=!0){const n=this,{element:r}=n,[s,i]=n.getRenderContext(n,e);n.emptyCache(),n.syncElement&&n.currentElement?yr.sync(r,n.currentElement):(null==s||s.insertBefore(r,i),n.currentElement=r),il.fromElement(r.parentElement)&&r.classList.remove(...il.outerCls),super.render(s,t),n.rendered=!0,n.getConfig("role"),t&&(n.getConfig("contentRange"),n.triggerPaint()),n.setupFocusListeners()}template({tag:e,html:t,htmlCls:n,name:r}){var s;const i=this;"string"==typeof t&&nl.test(t)&&i.resolveCallback(t,i,!1)&&(t=i.callback(t,i,[i]));const a=null!==(s=t)&&void 0!==s&&s.call?t.call(i,i):t;return`<${e} class="${a?n:""}" ${r?`data-name="${r}"`:""}>${a||""}</${e}>`}updateRecomposeAsync(e){this.recompose.immediate=!e}onConfigChange({name:e}){var t;this._element&&!this.isDestroying&&null!==(t=this.$meta.renderConfigs)&&void 0!==t&&t[e]&&this.recompose()}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.parent}getConfigValue(e,t){return"style"===e?this._style:super.getConfigValue(e,t)}getCurrentConfig(e){const t=super.getCurrentConfig(e);return(null==e?void 0:e.depth)>0&&(t.type=this.type),t}get dataset(){return this.element.dataset}changeDataset(e){Ut.assign(this.dataset,e)}get dragGhost(){return this.constructor._dragGhost||(this.constructor._dragGhost=yr.createElement({html:"",style:"position:absolute;top:-10000em;left:-10000em"}))}updateParent(e){const{_element:t}=this;t&&t.classList[e?"remove":"add"](...il.outerCls)}get constrainTo(){var e;let t=this._constrainTo;if(t=void 0===t?globalThis:(null===(e=t)||void 0===e?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE?t.host||t.ownerDocument:t,this.positioned){const{offsetParent:e}=this.element;if(e&&"hidden"===yr.getStyleValue(e,"overflow"))t=vn.from(e).moveTo(0,0);else if(t&&!t.isRectangle){const n=t===document||t===globalThis;t=vn.from(t,e),n&&t.translate(globalThis.pageXOffset,globalThis.pageYOffset)}}return t}updateCentered(e){const{element:t,_anchorElement:n}=this;if(e&&!this.floating&&!this.positioned)throw new Error("`centered` is only relevant when a Widget is `floating` or `positioned`");e?(t.classList.add("b-centered"),t.style.transform=t.style.left=t.style.top="",null==n||n.classList.add("b-hide-display"),t.classList.remove("b-anchored")):t.classList.remove("b-centered")}get contentElement(){return this.element}get contentRange(){const e=this,{contentElement:t}=e,n=e._contentRange||(e._contentRange=new Range);return n.collapsed&&(n.setStart(t,e.contentRangeStartOffset||0),n.setEnd(t,e.contentRangeEndOffset||t.childNodes.length)),n}fixRefOwnerId(e,t,n){if(e.$refOwnerId===n){e.$refOwnerId=t;for(let{childNodes:r}=e,s=r.length;s-- >0;)this.fixRefOwnerId(r[s],t,n)}}get placement(){const{element:e}=this;let t,n,r;if(null!=e&&e.offsetParent&&!Uo.test(yr.getStyleValue(e,"position"))){const i=e.nextElementSibling,a=e.previousElementSibling,o=!i&&a;var s;if(n=yr.getStyleValue(e.parentElement,"flex-direction"),n)n=n.startsWith("row")?"h":"v";else t=null===(s=i||a)||void 0===s?void 0:s.getBoundingClientRect(),r=t&&e.getBoundingClientRect(),n=t&&Math.abs(t.top-r.top)<Math.abs(t.left-r.left)?"h":"v";n+="h"===n?o?"r":"l":o?"b":"t"}return n}updateId(e,t){if(super.updateId(e,t),t){const{byRef:n,element:r}=this;for(const t in n)n[t].dataset&&(n[t].dataset.ownerCmp=e);r.id=e,this.fixRefOwnerId(r,e,t)}}get style(){const{element:e}=this;return(null==e?void 0:e.ownerDocument.defaultView.getComputedStyle(e))||this._style}updateStyle(e){this.element&&yr.applyStyle(this.element,e)}updateTitle(e){this.titleElement&&(this.titleElement.innerHTML=e)}beforeAlignTo(e){}alignTo(e){var t,n;const s=this,{lastAlignSpec:i,element:a}=s,{offsetParent:o,style:l,classList:c}=a;if(i&&(i.monitorIntersection&&s.intersectionObserver.unobserve(i.target),isFinite(i.zone)&&a.classList.remove(Xo[i.zone])),!e)return s.removeTransientListeners(),void(s.anchor=s.lastAlignSpec=null);s.beforeAlignTo(e),(e.nodeType===Element.ELEMENT_NODE||e.isWidget||"Point"===e.$$name)&&(e={target:e}),s.releaseSizeConstraints();const{scrollable:d,constrainTo:u}=s,h=yr.measureSize(yr.getStyleValue(a,"minHeight"),a),g=yr.measureSize(yr.getStyleValue(a,"minWidth"),a),m=s.positioned&&"fixed"!==yr.getStyleValue(a,"position"),p=s.scale||1,f=e.target,v=e.domEvent||e.event||f,y=null!=f&&f.isRectangle?f:(null==f?void 0:f.element)||f,b=(null==y?void 0:y.nodeType)===Element.ELEMENT_NODE,C=(null==v||null===(t=v.target)||void 0===t?void 0:t.nodeType)===Element.ELEMENT_NODE,S=(e=e.realignTarget?e:Ut.assign({aligningToEvent:C,aligningToElement:b,constrainTo:u,align:"b-t",axisLock:s.axisLock,anchor:s.anchor},s.align,e)).minWidth||g,w=e.minHeight||h;if(s.lastAlignSpec=e,C)delete e.target,e.domEvent=v,e.anchoredTo=v.target,e.position=new yn(v.clientX+1,v.clientY+1);else if(b&&(e.target=y,or(y instanceof SVGElement?y.closest("svg"):y))){if((e=Object.setPrototypeOf({},e)).target=s.lastAlignSpec.targetRect=e.realignTarget||(e.allowTargetOut?vn.from(y,m?o:null,!m):yr.isInView(y,!1,s)),!e.target){const e=s.hide();return s.isDestroyed||(s.lastAlignSpec.targetOutOfView=!0),e}e.target.height=Math.max(e.target.height,1),e.target.width=Math.max(e.target.width,1),s.lastAlignSpec.anchoredTo=y}e.anchor&&(e.anchorSize=s.anchorSize,a.contains(s.anchorPathElement)||a.appendChild(s.anchorElement)),s.isAligning=!0,s.trigger("beforeAlign",e);const D=vn.from(a,m?o:null,!0),{width:T,height:E}=D;D.isAlignRectangle=!0,S&&(D.minWidth=S*p),w&&(D.minHeight=w*p),s.isAligning=!1,e.rtl=s.rtl,(e.align.includes("s")||e.align.includes("e"))&&(s.rtl?e.align=e.align.replace(/s/g,"r").replace(/e/g,"l"):e.align=e.align.replace(/s/g,"l").replace(/e/g,"r"));const x=s.lastAlignSpec.result=D.alignTo(e);let{align:k,anchor:I,x:R,y:M,width:O,height:A,overlap:F}=x;if(s.lastAlignSpec.zone=x.zone,A!=E){const e=A<E;s.alignmentChanges=s.alignmentChanges|(e?1:2),l[s.alignedHeightStyle=rl[3&s.alignmentChanges]]=A/p+"px",e&&!s._minHeight&&h&&(l.minHeight=Math.min(A,h)/p+"px"),d&&(d.overflowY=e)}if(O!=T){const e=O<T;s.alignmentChanges=s.alignmentChanges|(e?4:8),l[s.alignedWidthStyle=rl[12&s.alignmentChanges]]=O/p+"px",e&&!s._minWidth&&g&&(l.minWidth=Math.min(O,g)/p+"px"),d&&(d.overflowX=e)}if(k&&s.alignmentChanges){const t=vn.from(a,m?o:null,!0);e.align=k;const n=s.lastAlignSpec.result=t.alignTo(e);I=n.anchor,R=n.x,M=n.y,O=n.width,A=n.height}if(s.centered||s.setXY(R,M),!x.overlap&&isFinite(x.zone)&&c.add(Xo[x.zone]),null!==(n=I)&&void 0!==n&&n.edge){var P;const{edge:e}=I,{anchorElement:t}=s,{style:n}=t,r=vn.from(a),i=[];"top"===e||"bottom"===e?(i[0]=I.x,i[1]="top"===e?1:r.height-1):(i[0]="left"===e?1:r.width-1,i[1]=I.y),n.display="none";let o=yr.childFromPoint(a,...i);if((null!==(P=o)&&void 0!==P&&P.matches(":focus")||o===xr.currentOverElement)&&a.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_CONTAINED_BY&&(o=o.parentNode),o&&o!==document){let e=yr.getStyleValue(o,"background-color");for(;e.match(No)&&"absolute"!==yr.getStyleValue(o,"position")&&(o=o.parentNode,o!==document);)e=yr.getStyleValue(o,"background-color");e.match(No)?s.anchorPathElement.setAttribute("fill",s.defaultAnchorBackgroundColor):s.anchorPathElement.setAttribute("fill",e)}n.transform=n.display="",t.className=`b-anchor b-anchor-${e}`,I.x&&(I.x/=p),I.y&&(I.y/=p),yr.setTranslateXY(t,I.x,I.y),c.add("b-anchored")}else s._anchorElement&&(s.anchorElement.classList.add("b-hide-display"),c.remove("b-anchored"));if(!b){l.pointerEvents="none";const e=yr.elementFromPoint(R,M);s.owns(e)||(s.lastAlignSpec.anchoredTo=e),l.pointerEvents=""}if(("realign"===s.scrollAction&&b||"hide"===s.scrollAction)&&!s.documentScrollListener){if(s.clearTimeout(s.scrollListenerTimeout),e.monitorTargetMutation&&!s.targetObserver){(s.targetObserver||(s.targetObserver=new MutationObserver(s.onTargetParentMutation.bind(s)))).observe(yr.getRootElement(y),{childList:!0,attributes:!0,subtree:!0})}s.scrollListenerTimeout=s.setTimeout((()=>{var e,t;const n=null===(e=(t=b?y:s.lastAlignSpec.anchoredTo).getRootNode)||void 0===e?void 0:e.call(t);s.documentScrollListener=Mn.addListener(document,"scroll","doHideOrRealign",{capture:!0,thisObj:s}),null!=n&&n.mode&&(s.targetRootScrollListener=Mn.addListener(n,"scroll","doHideOrRealign",{capture:!0,thisObj:s}))}),"hide"===s.scrollAction?s.ignoreScrollDuration:0)}if(b&&(e.monitorResize&&!s.targetResizeListener&&(yo.addResizeListener(y,s.onTargetResize),s.targetResizeListener=!0),e.monitorIntersection&&!(F||y.contains(a)||y.ownerSVGElement)&&s.intersectionObserver.observe(y)),!r.isAndroid&&!s.constrainListeners){const e=null!=u&&u.isRectangle?globalThis:u;s.clearTimeout(s.resizeListenerTimeout),s.resizeListenerTimeout=s.setTimeout((()=>{s.constrainListeners=!0,yo.addResizeListener(e||globalThis,s.onAlignConstraintChange)}),s.ignoreScrollDuration)}}onTargetParentMutation(e){const{element:t,lastAlignSpec:n}=this;var r;null!=n&&n.aligningToElement&&(null!==(r=n.target)&&void 0!==r&&r.isConnected?e.some((({target:e})=>e.contains(n.target)&&!t.contains(e)))&&this.realign():this.hide())}get intersectionObserver(){return this._intersectionObserver||(this._intersectionObserver=new IntersectionObserver(this.onTargetIntersectionchange.bind(this),{root:r.isSafari?this.rootElement:this.rootElement.ownerDocument}))}onTargetIntersectionchange(e){if(!this.isDestroyed){const t=e[e.length-1];t.isIntersecting||this.onAlignTargetOutOfView(t.target)}}onTargetResize(){const{lastAlignSpec:e}=this;if(e){const{width:t,height:n}=e.targetRect,{width:r,height:s}=e.target.getBoundingClientRect();r===t&&s===n||this.onAlignConstraintChange(...arguments)}}onAlignTargetOutOfView(e){this.hide(),this.lastAlignSpec&&(this.lastAlignSpec.targetOutOfView=!0)}onAlignConstraintChange(e,t,{height:n}){const{style:r}=this.contentElement,{overflowY:s}=r;this.setTimeout(this.realign,50),t&&n>t.height&&(r.overflowY="hidden",this.requestAnimationFrame((()=>r.overflowY=s)))}realign(){const e=this,{lastAlignSpec:t}=e;if((e.floating||e.positioned)&&t&&e.isVisible){if(t.aligningToElement){const n=t.target.contains(this.element),r=yr.isInView(t.target,!1,e);if(!(t.allowTargetOut||or(t.target)&&r))return e.hide(),void(e.isDestroyed||(e.lastAlignSpec.targetOutOfView=!0));t.realignTarget=n?null:r}yr.addTemporaryClass(e.element,"b-realigning",e.realignTimeout,e),e.alignTo(t)}}rectangle(e,t,n){return this.rectangleOf("element",e,t,n)}rectangleOf(e,t,n,r){var s;return"string"!=typeof t?(r=n,n=t,t=""):"border"===t&&(t=""),"boolean"==typeof n&&(r=n,n=void 0),"element"!==e&&void 0===n&&(n=this.element),n=null!==(s=n)&&void 0!==s&&s.isWidget?n.element:n,vn[t||"from"](this[e],n,r)}releaseSizeConstraints(){const e=this,{scrollable:t,element:n,alignmentChanges:r}=e,{style:s}=n;12&r&&(yr.setLength(n,e.alignedWidthStyle,e[`_last${T.capitalize(e.alignedWidthStyle)}`]||""),s.minWidth=e._minWidth||"",t&&(t.overflowY=t.config.overflowY)),3&r&&(yr.setLength(n,e.alignedHeightStyle,e[`_last${T.capitalize(e.alignedHeightStyle)}`]||""),s.minHeight=e._minHeight||"",t&&(t.overflowX=t.config.overflowX)),e.alignmentChanges=0}toFront(){const{element:e}=this,t=this.floating?this.floatRoot:this.positioned?null==e?void 0:e.parentNode:null,n=document.createDocumentFragment();if(this.containsFocus){for(let r,s=e.nextSibling;s;s=r)r=s.nextSibling,t.contains(s)&&!this.owns(s)&&n.appendChild(s);t.insertBefore(n,e)}else t.appendChild(e)}updateRef(e){this.element.dataset.ref=e}get overflowElement(){return this.contentElement}get maxHeightElement(){return this.element}changeAlign(e){return"string"==typeof e?{align:e}:e}changeScrollable(e,t){return"boolean"==typeof e&&(e={overflowX:e,overflowY:e}),e?(e.element=this.overflowElement,e.widget=this,e.isScroller||(e=t?t.setConfig(e):new this.scrollerClass(e)),e.syncOverflowState()):null==t||t.destroy(),e}handleReactElement(e){const t=this.closest((e=>e.reactComponent));null!=t&&t.reactComponent&&t.reactComponent.processWidgetContent({reactElement:e,widget:this,reactComponent:t.reactComponent})}get html(){return this.initializingElement||!this.element?this.content||this._html:this.contentElement.innerHTML}updateHtml(e){const t=this,n=null==e,{element:r,contentElement:s,htmlCls:i}=t;if(r||!yr.isReactElement(e)){if(r){t.updatingHtml=!0;const a=s===r&&t._anchorElement;i&&i.values.forEach((e=>r.classList[n?"remove":"add"](e))),a&&r.removeChild(a),e&&"object"==typeof e?yr.isReactElement(e)?t.handleReactElement(e):go.sync({domConfig:{...e,onlyChildren:!0},targetElement:t.contentElement}):t.contentElement.innerHTML=n?"":e,t.getConfig("htmlMutationObserver"),a&&r.appendChild(a),t.isComposable?t.recompose():(t.floating||t.positioned)&&(t.isAligning||t.realign())}}else t.whenVisible((()=>t.handleReactElement(e)))}changeHtmlMutationObserver(e,t){const n=this,{contentElement:r}=n;if(null==t||t.disconnect(),e){const t=new MutationObserver((()=>{n.updatingHtml?n.updatingHtml=!1:n._html=r.innerHTML}));return t.observe(r,e),t}}updateContent(e){const t=this,n=null==e,{element:r,htmlCls:s}=t;if(r){const{contentRange:i}=t;s&&s.values.forEach((e=>r.classList[n?"remove":"add"](e))),r.isConnected?(i.deleteContents(),n||i.insertNode(yr.createElementFromTemplate(e,{fragment:!0}))):t.contentElement.innerHTML=e,t.contentRangeStartOffset=i.startOffset,t.contentRangeEndOffset=i.endOffset,!t.floating&&!t.positioned||t.isAligning||t.realign()}}onThemeChange(){var e;null!==(e=this.anchorElement)&&void 0!==e&&e.offsetParent&&(this._anchorSize=null,this.realign())}get anchorSize(){const e=this;let t=this._anchorSize;if(!t){const n=parseFloat(yr.getStyleValue(e.element,"border-top-width")),r=yr.getStyleValue(e.element,"border-top-color"),s=e.anchorElement,{className:i}=s,a=s.firstElementChild,o=e.anchorPathElement=a.lastElementChild,l=e._hidden;s.className="b-anchor b-anchor-top";let c=yr.getStyleValue(e.contentElement,"background-color");c.match(No)&&(c=yr.getStyleValue(e.element,"background-color")),e.defaultAnchorBackgroundColor=c,t=s.getBoundingClientRect();const[d,u]=t=e._anchorSize=[t.width,t.height];s.className=i,a.setAttribute("height",u+n),a.setAttribute("width",d),o.setAttribute("d",`M0,${u}L${d/2},0.5L${d},${u}`),n&&(o.setAttribute("stroke-width",n),o.setAttribute("stroke",r)),t[1]-=n,l&&e.element.classList.add("b-hidden"),e.themeChangeListener||(e.themeChangeListener=xr.ion({theme:"onThemeChange",thisObj:e})),e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}return t}get anchorElement(){const e=this;if(!e._anchorElement){const t=e.floating,n=`${e.id}-shadow-filter`;e._anchorElement=yr.createElement({parent:e.element,className:"b-anchor b-anchor-top",children:[{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",class:"b-pointer-el",children:[t?{tag:"defs",children:[{tag:"filter",id:n,children:[{tag:"feDropShadow",dx:0,dy:-1,stdDeviation:1,"flood-opacity":.2}]}]}:null,{tag:"path",[t?"filter":""]:`url(#${n})`}]}]})}return e._anchorElement}updateAnchor(e){this._anchorElement&&this._anchorElement.classList[e?"remove":"add"]("b-hide-display")}updateDraggable(e){const t=this,{element:n}=t;var r,s,i;e?(t.dragEventDetacher=Mn.addListener({element:n,dragstart:"onWidgetDragStart",dragend:"onWidgetDragEnd",thisObj:t}),t.dragDetacher=Mn.on({element:n,mousedown(e){const{target:t}=e,r=il.fromElement(t);(!e.target.closest(".b-field-inner")&&r===this||this.strips&&Object.values(this.strips).includes(r))&&n.setAttribute("draggable","true")},thisObj:t})):(null===(r=t.dragEventDetacher)||void 0===r||r.call(t),null===(s=t.dragOverEventDetacher)||void 0===s||s.call(t),null===(i=t.dragDetacher)||void 0===i||i.call(t))}onWidgetDragStart(e){var t;const n=this;if(!n.validateDragStartEvent(e))return;const{element:s,align:i,constrainTo:a}=n,o=n.positioned&&"fixed"!==yr.getStyleValue(s,"position"),l=o?s.parentElement:n.rootElement,c=vn.from(s,o?l:null),d=e.clientX,u=e.clientY,h=document.scrollingElement||document.body,[g,m]=o?yr.getOffsetXY(s,l):n.getXY(),p=null===(t=o?vn.content(l).moveTo(0,0):a&&(null!=a&&a.isRectangle?a:vn.from(a)))||void 0===t?void 0:t.deflate(i.constrainPadding||0),f={element:l,dragover:e=>{s.classList.remove("b-centered"),c.moveTo(g+e.clientX-d-(o?0:h.scrollLeft),m+e.clientY-u-(o?0:h.scrollTop)),p&&c.constrainTo(p),yr.setTranslateXY(s,c.x,c.y)}};r.isTouchDevice&&(f.touchmove=e=>e.preventDefault()),n.floatRoot.appendChild(n.dragGhost),n.setDragImage(e),e.dataTransfer.effectAllowed="none",n.dragOverEventDetacher=Mn.addListener(f),n.alignTo()}validateDragStartEvent(e){const{element:t}=this,n=yr.elementFromPoint(e.clientX,e.clientY),{handleSelector:r}=this.draggable;if(r){var s;const i=null===(s=Ho.exec(r))||void 0===s?void 0:s[1];if(i){if(n.closest(`#${t.id} ${i}`))return e.preventDefault(),!1}else if(!n.closest(`#${t.id} ${r}`))return e.preventDefault(),!1}return!0}setDragImage(e){e.dataTransfer.setDragImage&&(e.dataTransfer.setData("application/node type",""),e.dataTransfer.setDragImage(this.dragGhost,-9999,-9999))}setStyle(e,t){return yr.applyStyle(this.element,Ut.isObject(e)?e:{[e]:t}),this}onWidgetDragEnd(){this.dragGhost.remove(),this.dragOverEventDetacher(),this.element.removeAttribute("draggable")}changeFloating(e){return Boolean(e)}changePositioned(e){return Boolean(e)}updatePositioned(e){this.element.classList[e?"add":"remove"]("b-positioned")}getXY(){return[yr.getPageX(this.element),yr.getPageY(this.element)]}setXY(e,t){const n=this,{element:r}=n;if(n.floating||n.positioned){if(null!=e&&(n._x=e),null!=t&&(n._y=t),"fixed"===yr.getStyleValue(r,"position")){const n=r.getBoundingClientRect(),[s,i]=yr.getTranslateXY(r),a=e-n.x,o=t-n.y;yr.setTranslateXY(r,s+a,i+o)}else yr.setTranslateXY(r,n._x||0,n._y||0);n.isConstructing?n.centered=!1:r.classList.remove("b-centered")}}get x(){return this.getXY()[0]}changeX(e){this.setXY(e)}get y(){return this.getXY()[1]}changeY(e){this.setXY(null,e)}get width(){const e=this,t=e.element;return e.monitorResize?(null==e._width&&(e._width=t.offsetWidth),e._width):t.offsetWidth}changeWidth(e){const t=this;yr.setLength(t.element,"width",e),t._lastWidth=e,t._oldWidth=t._width,t._width=null,t._flex=null,t.element.style.flex=""}clearWidthCache(){this._width=null}get maxWidth(){return yr.measureSize(this.element.style.maxWidth,this.element)}updateMaxWidth(e){this._lastMaxWidth=e,yr.setLength(this.element,"maxWidth",e)}get minWidth(){return yr.measureSize(this.element.style.minWidth,this.element)}updateMinWidth(e){yr.setLength(this.element,"minWidth",e)}updateFlex(e){this.getConfig("width"),"number"!=typeof e&&isNaN(e)||(e=`${e} ${e}`),this.element.style.flex=e,this.element.style.width=""}updateAlignSelf(e){this.element.style.alignSelf=e}updateMargin(e){this.element.style.margin=this.parseTRBL(e).join(" ")}updateTextAlign(e,t){t&&this.element.classList.remove(`b-text-align-${t}`),this.element.classList.add(`b-text-align-${e}`)}updatePlaceholder(e){this.input&&(null==e?this.input.removeAttribute("placeholder"):this.input.placeholder=e)}get height(){const e=this,t=e.element;return e.monitorResize?(null==e._height&&(e._height=t.offsetHeight),e._height):t.offsetHeight}changeHeight(e){yr.setLength(this.element,"height",e),this._lastHeight=e,this._height=null}get maxHeight(){return yr.measureSize(this.maxHeightElement.style.maxHeight,this.element)}updateMaxHeight(e){this._lastMaxHeight=e,yr.setLength(this.maxHeightElement,"maxHeight",e)}get minHeight(){return yr.measureSize(this.element.style.minHeight,this.element)}updateMinHeight(e){yr.setLength(this.element,"minHeight",e)}updateDisabled(e=!1){const{element:t,focusElement:n,ariaElement:r}=this;this.trigger("beforeUpdateDisabled",{disabled:e}),e&&(this.revertFocus(),this._disabled!==e)||(t&&(t.classList[e?"add":"remove"]("b-disabled"),n&&(n.disabled=e),r&&r.setAttribute("aria-disabled",e)),this.onDisabled(e))}onDisabled(e){}disable(){this.disabled=!0}enable(){this.disabled=!1}requestFullscreen(){const e=this,t=mo.request(e.floating?e.floatRoot:e.element);return mo.onFullscreenChange(e.onFullscreenChange),e.element.classList.add("b-fullscreen"),t}exitFullscreen(){return mo.exit()}onFullscreenChange(){mo.isFullscreen||this.onExitFullscreen()}onExitFullscreen(){mo.unFullscreenChange(this.onFullscreenChange),this.element.classList.remove("b-fullscreen")}get tooltip(){const e=this;if(e._tooltip)return e._tooltip;{var t;const n=null===(t=il.Tooltip)||void 0===t?void 0:t.getSharedTooltip(e.rootElement,e.eventRoot);if(n&&n.activeTarget===e._element&&n.isVisible)return n}}changeTooltip(e,t){const n=this,{element:s}=n;if(e){if(!n.preventTooltipOnTouch||!r.isTouchDevice){var i;if(e.isTooltip||"Object"===e.constructor.name||(e={html:"string"==typeof e?e:n.placeholder,textContent:!0}),!n.configureAriaDescription)n.ariaDescription=null!==(i=e.html)&&void 0!==i&&i.match(Jo)?e.html.replace(Jo,Qo):e.html;if(!(null!=t&&t.isTooltip||e.newInstance))return s.dataset.btip=!0,void(n.tipConfig=e);e.type="tooltip",e.forElement||(e.forElement=s),"showOnHover"in e||e.forSelector||(e.showOnHover=!0),"autoClose"in e||(e.autoClose=!0),e=il.reconfigure(t,e,n),n.detachListeners("tooltipValueListener"),n.configureAriaDescription||e.ion({name:"tooltipValueListener",innerHtmlUpdate:"onTooltipValueChange",thisObj:n})}}else if(t){if(null!=e||!t.isTooltip)return void(t.html=null);t.destroy()}else delete s.dataset.btip;return e}onTooltipValueChange({value:e,source:t}){this.ariaDescription="string"==typeof e?e:t.contentElement.innerText}get tooltipText(){const e=this._tooltip;return e?e.isTooltip?e.contentElement.innerText:"string"==typeof e?e:e.html:this.tipConfig?this.tipConfig.html:void 0}get isVisible(){const e=this,{element:t}=e;let n;return Boolean(t&&!e._hidden&&!e.isDestroying&&t.isConnected&&(!e.requireSize||or(t))&&(!(n=e.containingWidget)||n.isVisible))}whenVisible(e,t=this,n,r=e.toString()){const s=this;var i;s.isVisible&&s.isPainted?(null===(i=s.toCallWhenVisible)||void 0===i||i.delete(r),s.callback(e,t,n)):(s.toCallWhenVisible||(s.toCallWhenVisible=new Map)).set(r,{callback:e,thisObj:t,args:n})}focus(){this.isFocusable&&yr.focusWithoutScrolling(this.focusElement)}get focusElement(){}get isFocusable(){const e=!this.isDestroying&&this.isVisible&&!this.disabled&&this.focusElement;return e&&(e===document.body||e.offsetParent)}async show({align:e,animate:t=!0}={}){const n=this,{element:r,floating:s}=n,{style:i}=r,a=t&&n.showAnimation;let o,l,c=!n.isVisible;return c&&(c=n.trigger("beforeShow"),Ut.isPromise(c)&&(c=await c)),!1===c||n.internalBeforeShow&&!1===n.internalBeforeShow()?Promise.resolve():new Promise((t=>{if(n.cancelHideShowAnimation(),n.updateCentered(n._centered),s){const e=n.floatRoot;e.contains(r)||(n.rendered?e.appendChild(n.element):n.render(e,!1)),i.transform.includes("scale")&&(n.scale=null,i.transform=i.transformOrigin="");const t=n.closest(Yo);if(t){const{scale:e}=t;n.scale=e,i.transform=`scale(${e})`,i.transformOrigin="0 0"}}if(n._hidden=!1,r.classList.remove("b-hidden"),s&&!ar(r)&&(n.hide(!1),t()),n.onConfigChange({name:"hidden",value:!1,was:!0,config:n.$meta.configs.hidden}),a){o=Object.keys(a)[0],l=a[o];const e=n.currentAnimation={showing:!0,styleProp:o,resolve:t};n.isAnimating=!0,i.transition="none",i[o]=l.from,yr.getStyleValue(r,o),n.currentAnimation.detacher=Mn.onTransitionEnd({element:r,property:o,duration:Go(l.duration)+20,handler:()=>n.afterHideShowAnimate(e),thisObj:n}),i.transition=`${o} ${l.duration} ease ${l.delay}`,i[o]=l.to}n.afterShow(e,a?null:t)}))}async showBy(e,t,n){const r=this,s=Array.isArray(e);if(s||"number"==typeof e){const r=s?e:[e,t];e=Object.assign({target:new yn(r[0]+1,r[1]+1),matchSize:!1,align:"t0-b0"},s?t:n)}if(r.requireSize=!0,!r.isVisible)return r.show({align:e});yr.addTemporaryClass(r.element,"b-realigning",300,r),r.alignTo(e)}async showByPoint(){return P.deprecate("Core","6.0.0","Widget.showByPoint() replaced by Widget.showBy() with the same signature"),this.showBy(...arguments)}afterShow(e,t){var n,r;const s=this;s.trigger("show"),s._configuredAnchorState=s.anchor,null===(n=s.owner)||void 0===n||null===(r=n.onChildShow)||void 0===r||r.call(n,s),s.triggerPaint(),(s.floating||s.positioned)&&(e?s.alignTo(e):s.centered?s.alignTo({target:s.constrainTo,align:"c-c"}):s.forElement&&s.alignTo(s.forElement)),null==t||t()}onChildHide(e){e.floating&&this.ariaElement.removeAttribute("aria-owns")}onChildShow(e){e.floating&&(this.ariaHasPopup=e.role,this.ariaElement.setAttribute("aria-owns",e.id))}triggerPaint(){const e=this,{element:t,toCallWhenVisible:n}=e,r=!e.isPainted;if(e.isVisible){if(r&&(e.getConfig("scrollable"),e.scaleToFitWidth&&!e.monitorResize&&(e.onParentElementResize=e.onParentElementResize.bind(e),yo.addResizeListener(t.parentElement,e.onParentElementResize),e.updateScale()),!e.hideBryntumDomMessage&&(e.isTaskBoardBase||e.isGridBase||e.isCalendar)&&t.insertBefore(new Comment("POWERED BY BRYNTUM (https://bryntum.com)"),t.firstChild),e.onConnectedCallback&&globalThis.ResizeObserver&&(e.connectedObserver=new ResizeObserver((()=>{e.isElementConnected&&!t.isConnected?(e.onConnectedCallback(!1),e.isElementConnected=!1):!e.isElementConnected&&t.isConnected&&(e.onConnectedCallback(!0,null==e.isElementConnected),e.isElementConnected=!0)})),e.connectedObserver.observe(t))),e.eachWidget(Wo,!1),r&&(e.getConfig("tooltip"),!il.Ripple&&il.RippleClass&&(il.Ripple=new il.RippleClass({rootElement:e.rootElement})),globalThis.DocsBrowser&&e.floating&&e.closest((e=>{var t;return null===(t=e.element)||void 0===t?void 0:t.closest(".fiddlePanelResult,.b-owned-by-fiddle")}))&&t.classList.add("b-owned-by-fiddle")),e.isPainted=!0,r&&e.triggerConfigs("paint"),e.onInternalPaint({firstPaint:r}),e.trigger("paint",{firstPaint:r}),null!=n&&n.size){for(const{callback:t,thisObj:r,args:s}of n.values())e.callback(t,r,s);n.clear()}r&&e.monitorResize&&!e.scaleToFitWidth&&yo.onElementResize([{target:t}])}}onInternalPaint(){}cancelHideShowAnimation(){const e=this,{currentAnimation:t,element:n}=e;t&&(e.isAnimating=!1,n.classList.contains("b-hiding")&&(n.classList.remove("b-hiding"),e._hidden=!1),t.detacher(),t.resolve(),n.style.transition=n.style[t.styleProp]="",e.currentAnimation=null,e.trigger((t.showing?"show":"hide")+"AnimationEnd"))}afterHideShowAnimate(e){const t=this;e===t.currentAnimation&&(t.element.classList.remove("b-hiding"),t.cancelHideShowAnimation(),t._hidden&&t.afterHideAnimation())}suspendVisibility(){this._visibilitySuspended=(this._visibilitySuspended||0)+1,Object.defineProperty(this,"isVisible",Zo)}resumeVisibility(e=!0){--this._visibilitySuspended||(delete this.isVisible,e&&this.triggerPaint())}hide(e=!0){return new Promise((t=>{const n=this,{element:r,lastAlignSpec:s}=n,{style:i}=r,a=e&&n.hideAnimation;if(n.clearTimeout(n.scrollListenerTimeout),n.clearTimeout(n.resizeListenerTimeout),!n._hidden&&!1!==n.trigger("beforeHide",{animate:e})){if(n._hidden=!0,s&&(s.targetOutOfView=null,s.monitorIntersection&&(n.intersectionObserver.takeRecords(),n.intersectionObserver.unobserve(s.target))),n.onConfigChange({name:"hidden",value:!0,was:!1,config:n.$meta.configs.hidden}),!r)return void t();if(r.contains(yr.getActiveElement(r))&&n.revertFocus(!0),n.isDestroyed)return void t();if(n.cancelHideShowAnimation(),a){const e=Object.keys(a)[0],s=a[e];if(Number(getComputedStyle(n.element)[e])!==s.to){const a=n.currentAnimation={hiding:!0,styleProp:e,resolve:t};r.classList.add("b-hiding"),n.isAnimating=!0,n.currentAnimation.detacher=Mn.onTransitionEnd({element:r,property:e,duration:Go(s.duration)+20,handler:()=>n.afterHideShowAnimate(a),thisObj:n}),i[e]=s.from,yr.getStyleValue(r,e),i.transition=`${e} ${s.duration} ease ${s.delay}`,i[e]=s.to}else r.classList.add("b-hidden")}else r.classList.add("b-hidden");n.afterHide(!a&&t,a)}}))}doHideOrRealign({target:e,isTrusted:t}){const n=this,{lastAlignSpec:r,element:s}=n,i=null==r?void 0:r.anchoredTo,a=null==r?void 0:r.target,o=null==r?void 0:r.position,l=yr.getActiveElement(n);if(!t||!or(s)||e&&(s.contains(e)||e.nodeType===Element.ELEMENT_NODE&&n.owns(e)||e.nodeType===Element.DOCUMENT_NODE&&s.contains(l)&&Vo[l]&&globalThis.innerHeight<document.body.offsetHeight))return;if(r.aligningToElement){const e=yr.isInView(a,!1,n);if(e&&e.equals(r.targetRect))return}const c="hide"===n.scrollAction&&n.getXY();if(n.realign(),!n.isDestroyed&&ar(s)&&"hide"===n.scrollAction){const[t,s]=n.getXY(),l=t!==c[0]||s!==c[1];(null!=r&&r.aligningToEvent||(l||"Point"===(null==a?void 0:a.$$name)||o)&&(!i||!or(i)||e&&yr.isDescendant(e,i)))&&n.hide()}}afterHide(e=null,t=this.hideAnimation){var n,r;const s=this;s._anchor=s._configuredAnchorState,s.removeTransientListeners(),t||s.afterHideAnimation(),s.trigger("hide"),null===(n=s.owner)||void 0===n||null===(r=n.onChildHide)||void 0===r||r.call(n,s),e&&e()}removeTransientListeners(){var e,t;const n=this,{targetObserver:r,lastAlignSpec:s}=n;if(n.clearTimeout(n.resizeListenerTimeout),n.clearTimeout(n.scrollListenerTimeout),r&&(r.disconnect(),delete n.targetObserver),n.documentScrollListener=null===(e=n.documentScrollListener)||void 0===e?void 0:e.call(n),n.targetRootScrollListener=null===(t=n.targetRootScrollListener)||void 0===t?void 0:t.call(n),n.targetResizeListener&&(yo.removeResizeListener(s.target,n.onTargetResize),n.targetResizeListener=!1),n.constrainListeners){var i;const e=null!==(i=s.constrainTo)&&void 0!==i&&i.isRectangle?globalThis:s.constrainTo;yo.removeResizeListener(e||globalThis,n.onAlignConstraintChange),n.constrainListeners=!1}}afterHideAnimation(){const e=this,{element:t}=e;e.floating&&e.floatRoot.contains(t)?t.remove():t.classList.add("b-hidden"),e.defaultAnchorBackgroundColor&&e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}changeHidden(e){const t=this;let n;return t.isConfiguring?(n=Boolean(e),t.element.classList[e?"add":"remove"]("b-hidden")):(t.trigger("beforeChangeHidden",{hidden:e}),e?t.hide():t.show()),n}get assignedId(){return this.hasGeneratedId?null:this.id}get owner(){return this.parent||this._owner||this.containingWidget}get containingWidget(){let e=this.parent;if(!e){var t,n;const r=(null===(t=this.forElement)||void 0===t?void 0:t.nodeType)===Element.ELEMENT_NODE?this.forElement:null===(n=this.element)||void 0===n?void 0:n.parentNode;e=(null==r?void 0:r.closest(".b-widget"))&&il.fromElement(r)}return e}get previousSibling(){return this.getSibling(-1)}get nextSibling(){return this.getSibling(1)}getSibling(e){const t=this,{parent:n}=t,r=n?n.childItems:Array.from(t.element.parentElement.querySelectorAll(".b-widget"));return n?r[r.indexOf(t)+e]:il.fromElement(r[r.indexOf(t.element)+e])}up(e,t,n){var r;const{owner:s}=this;return e?null==s||null===(r=s.closest)||void 0===r?void 0:r.call(s,e,t,n):s}closest(e,t,n){const r=typeof n,s="number"===r,i="string"===r;for(let r=this,a=1;r;r=r.owner,a++){if(il.widgetMatches(r,e,t))return r;if(s&&a>=n)return;if(i&&il.widgetMatches(r,n,t))return;if(r===n)return}}owns(e){if(e){if("eventPhase"in e&&(e=e.target),e.nodeType===Element.ELEMENT_NODE){if(this.element.contains(e))return!0;e=il.fromElement(e)}for(;e;){if(e===this)return!0;e=e.owner}}return!1}eachAncestor(e){let t=this.owner;for(;t;){if(!1===e(t))return!1;t=t.owner}return!0}changeMaximizeOnMobile(e){const t=this;if(t.floating&&r.isMobile){const{initialConfig:n}=t;e?(t.centered=t.modal=!1,t.maximized=!0):(t.centered=n.modal,t.modal=n.centered,t.maximized=n.maximized)}}changeMonitorResize(e,t){const n=!this.scaleToFitWidth&&Boolean(e);if(n!==Boolean(t))return n}updateMonitorResize(e){const t=this;qo(t,"onElementResize")||(t.onElementResize=t.onElementResize.bind(t)),yo[e?"addResizeListener":"removeResizeListener"](t.element,t.onElementResize)}changeReadOnly(e){if(e=Boolean(e),Boolean(this._readOnly)!==e)return e}updateReadOnly(e){var t;null===(t=this.element)||void 0===t||t.classList[e?"add":"remove"]("b-readonly"),this.isConfiguring||(this.eachWidget((t=>{t.ignoreParentReadOnly||("_originalReadOnly"in t||(t._originalReadOnly=t.config.readOnly||!1),t.readOnly=e||t._originalReadOnly)}),!1),this.trigger("readOnly",{readOnly:e}))}eachWidget(e,t=!0){const n=this.childItems,r=(null==n?void 0:n.length)||0,s={};for(let i=0;i<r;i++){const r=n[i];if(s.down=t,!1===e(r,s))return!1;if(s.down&&r.eachWidget&&!1===r.eachWidget(e,t))return!1}return!0}queryAll(e){const t=[];return this.eachWidget((n=>{e(n)&&t.push(n)})),t}query(e){let t=null;return this.eachWidget((n=>{if(e(n))return t=n,!1})),t}getWidgetByRef(e){var t,n;return e instanceof il?e:(null==this||null===(t=this.widgetMap)||void 0===t?void 0:t[e])||(null==this||null===(n=this.owner)||void 0===n?void 0:n.getWidgetByRef(e))}onFocusIn(e){const t=this,{element:n}=t;t.containsFocus=!0,t.focusInEvent=e,(t.floating||t.positioned)&&t.toFront(),n.classList.add("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),n.contains(e._target)&&t.onInternalKeyDown&&!t.keyDownListenerRemover&&(t.keyDownListenerRemover=Mn.on({element:n,keydown:"onInternalKeyDown",thisObj:t})),t.trigger("focusin",e)}onFocusOut(e){const t=this;t.keyDownListenerRemover&&(t.keyDownListenerRemover(),t.keyDownListenerRemover=null),t.isDestroyed||(e.relatedTarget||t.revertFocus(!t.isVisible),t.containsFocus=!1,t.element.classList.remove("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),t.trigger("focusout",e))}captureFocus(){const e=this,t=yr.getActiveElement(e),n=e.contains(t)&&e.captureFocusItem(t);return(r,s)=>{if(n&&!e.isDestroying){(yr.getActiveElement(e)!==t||s)&&n(r)}}}captureFocusItem(e){return(t=!0)=>{this.contains(e)&&(t?e.focus():yr.focusWithoutScrolling(e))}}contains(e,t){const{element:n}=this;if(e&&n)return e.isWidget&&(e=e.element),n.contains(e)&&(!t||n!==e)}revertFocus(e){var t,n;const r=this,s=yr.getActiveElement(r);let i=null===(t=r.focusInEvent)||void 0===t?void 0:t.relatedTarget;(e||r.containsFocus&&(null===(n=i)||void 0===n?void 0:n.nodeType)===Element.ELEMENT_NODE&&r.element.contains(s))&&(i&&yr.isFocusable(i)||(i=r.getFocusRevertTarget()),r._isRevertingFocus=!0,i&&yr.isFocusable(i)?(i._isRevertingFocus=!0,yr.focusWithoutScrolling(i),i._isRevertingFocus=!1):null==s||s.blur(),r._isRevertingFocus=!1)}getFocusRevertTarget(){const e=this,{owner:t,focusInEvent:n}=e,r=n&&n.backwards?1:-1;let s=n&&n.relatedTarget;const i=s&&il.fromElement(s);if(t&&!t.isDestroyed&&(!s||!yr.isFocusable(s)||i&&!i.isFocusable)){var a;if(s=null,t.eachWidget){const n=[];if(t.eachWidget((t=>{(t===e||t.isFocusable)&&n.push(t)}),!1),n.length>1){const t=n.indexOf(e);s=n[t+r]||n[t-r]}}!s&&t.isFocusable&&(s=t),s=s?s.focusElement:null===(a=t.getFocusRevertTarget)||void 0===a?void 0:a.call(t)}return s}getStaticWidgetClasses(e,t){const n=new Sn,r=this.$meta.hierarchy;let s,i,a,o,l;for(i=r.indexOf(e);i<r.length;++i){var c;s=r[i],l=Reflect.getOwnPropertyDescriptor(s.prototype,"widgetClass"),null!==(c=l)&&void 0!==c&&c.get?o=l.get.call(this):(a=qo(s,"$$name")||qo(s,"$name")||qo(s,"_$name")?s.$$name:s.name,(a.length<3||a.includes("$"))&&console.warn(`Class "${a}" extending "${s.$name}" should have "$name" static getter with no less than 3 chars.`),o=`b-${a.toLowerCase()}`),o&&n.add(t?o+t:o)}return n}get rootUiClass(){return il}get staticClassList(){const{$meta:e}=this;let t=e.staticClassList;return t||(e.staticClassList=t=this.getStaticWidgetClasses(il),r.isTouchDevice&&t.add("b-touch")),t}get uiClasses(){return this.getConfig("ui"),this._uiClasses}get uiClassList(){return this.getConfig("ui"),this._uiClassList}get widgetClassList(){const e=this,{cls:t,defaultCls:n,uiClasses:r}=e;let{staticClassList:s}=e;(n||t)&&(s=s.clone(),n&&s.assign(n),t&&s.assign(t));const i=s.values;return r&&i.push(...r),e.floating&&i.push("b-floating"),"hide"===e.collapsify&&i.push("b-collapsify-hide"),i}changeCls(e){return Sn.from(e)}updateCls(e,t){if(!this.isConfiguring&&!this.isComposable){const{element:n}=this;t&&Ut.getTruthyKeys(t).forEach((e=>n.classList.remove(e))),e.assignTo(n)}}changeContentElementCls(e){return Sn.from(e)}changeHtmlCls(e){return Sn.from(e)}changeDefaultCls(e){return Sn.from(e,!0)}changeUi(e){return Sn.from(e)}updateUi(e){var t;let n,r,s=null;if(e){const t=this.getStaticWidgetClasses(this.rootUiClass);for(r in e)if(e[r])for(n in t)t[n]&&((s||(s=new Sn))[`${n}-ui-${r}`]=1)}this._uiClasses=null===(t=s)||void 0===t?void 0:t.values,this._uiClassList=s}fromCache(e,t=!1,n=this.element){if(!n)return null;const r=this;return r.cache[e]||(r.cache[e]=t?yr.children(n,e):yr.down(n,e)),r.cache[e]}emptyCache(){this.cache={}}changeMasked(e,t){var n;if("trial"!==(null===(n=this.masked)||void 0===n?void 0:n.type)){if(!0!==e&&""!==e||(e=""),t&&!t.isDestroyed)"string"==typeof e?(t.text=e,e=t):e?(t.setConfig(e),e=t):t.destroy();else if(e){const t=il.resolveType("mask");(e=t.mergeConfigs(this.maskDefaults,e)).owner=this,e=t.mask(e)}return e||null}}onMaskAutoClose(e){e.isDestroyed&&e===this.masked&&(this.masked=null)}mask(e){return this.masked=e,this.masked}unmask(){this.masked=null}onInternalResize(e,t,n,r,s){this._width=e.offsetWidth,this._height=e.offsetHeight}onElementResize(e,t){const n=this,{element:r}=n,s=n._width??n._oldWidth,i=n._height,a=r.offsetWidth,o=r.offsetHeight;n.floating&&t&&n.onFloatingWidgetResize(...arguments),n.suspendResizeMonitor||s===a&&i===o||(n.onInternalResize(r,a,o,s,i),n.trigger("resize",{width:a,height:o,oldWidth:s,oldHeight:i}))}onFloatingWidgetResize(e,t,n){const r=this,{lastAlignSpec:s,constrainTo:i}=r;if(r.isVisible&&s&&s.target){const e=!t||n.height!==t.height,a=!t||n.width!==t.width,o=i&&!vn.from(i).contains(vn.from(r.element,null,!0));(e&&2!==s.zone||a&&1!==s.zone||o)&&r.requestAnimationFrame((()=>r.realign()))}}updateScale(){const e=this,t=e.element,n=t.parentElement;e.configuredWidth||(e.configuredWidth=e.width),t.style.display="none";const r=vn.client(n).width/e.configuredWidth,s=e.scale=e.allowGrowWidth?Math.min(r,1):r;t.style.transform=`scale(${s})`,t.style.transformOrigin="top left",t.style.display="",e.allowGrowWidth&&r>1&&(e.width=e.configuredWidth*r)}onParentElementResize(e){this.updateScale()}parseTRBL(e,t="px"){if("number"==typeof(e=e||0))return[`${e}${t}`,`${e}${t}`,`${e}${t}`,`${e}${t}`];const n=e.split(" "),r=n.length;return 1===r?n[1]=n[2]=n[3]=n[0]:2===r?(n[2]=n[0],n[3]=n[1]):3===r&&(n[3]=n[1]),[isFinite(n[0])?`${n[0]}${t}`:n[0],isFinite(n[1])?`${n[1]}${t}`:n[2],isFinite(n[2])?`${n[2]}${t}`:n[3],isFinite(n[3])?`${n[3]}${t}`:n[4]]}get documentRoot(){var e;return(null===(e=this.owner)||void 0===e?void 0:e.documentRoot)||this.element.getRootNode()}get eventRoot(){var e,t;return null!==(e=this.element)&&void 0!==e&&e.isConnected?yr.getRootElement(this.element):(null===(t=this.owner)||void 0===t?void 0:t.eventRoot)||this._rootElement}get rootElement(){const e=this;if(!e._rootElement){var t,n;let r=(null===(t=e.owner)||void 0===t?void 0:t.rootElement)||yr.getRootElement(e.forElement||(null!==(n=e.element)&&void 0!==n&&n.isConnected?e.element:e.getRenderContext()[0]||e.element));r||(r=document.body),e._rootElement=r}return e._rootElement}get floatRoot(){const{rootElement:e}=this;let{floatRoot:t}=e;if(t)e.contains(t)||e.appendChild(t);else{var n;const{outerCls:s}=il,i=null===(n=yr.getThemeInfo(null,e))||void 0===n?void 0:n.name;if(!yr.isValidFloatRootParent(e))throw new Error("Attaching float root to wrong root");i&&s.push(`b-theme-${i.toLowerCase()}`),t=e.floatRoot=yr.createElement({className:`b-float-root ${s.join(" ")}`,parent:e}),$o.push(t),r.isAndroid&&(t.style.height=`${screen.height}px`,Mn.on({element:globalThis,orientationchange:()=>t.style.height=`${screen.height}px`,thisObj:this})),xr.ion({theme:({theme:e,prev:n})=>{t.classList.add(`b-theme-${e.toLowerCase()}`),t.classList.remove(`b-theme-${n.toLowerCase()}`)}})}return t}get floatRootMaxZIndex(){let e=1;return Array.from(this.floatRoot.children).forEach((t=>{const n=parseInt(getComputedStyle(t).zIndex||0,10);n>e&&(e=n)})),e}static resetFloatRootScroll(){$o.forEach((e=>e.scrollTop=e.scrollLeft=0))}static get floatRoots(){return $o}static removeFloatRoot(e){$o.splice($o.indexOf(e),1)}static get outerCls(){const e=["b-outer"],{platform:t}=r;return t&&e.push(`b-${t}`),r.isTouchDevice&&e.push("b-touch-events"),r.isMobile&&e.push("b-mobile"),yr.scrollBarWidth?e.push("b-visible-scrollbar"):e.push("b-overlay-scrollbar"),r.isChrome?e.push("b-chrome"):r.isSafari?e.push("b-safari"):r.isFirefox&&e.push("b-firefox"),r.isPhone&&e.push("b-phone"),globalThis.ResizeObserver||e.push("b-no-resizeobserver"),e}get isAnimating(){return this._isAnimatingCounter>0}set isAnimating(e){const t=this,{_isAnimatingCounter:n}=t;t._isAnimatingCounter=Math.max(0,n+(e?1:-1)),0===n&&e?(t.element.classList.add("b-animating"),t.trigger("animationStart")):1!==n||e||(t.element.classList.remove("b-animating"),t.trigger("animationEnd"))}async waitForAnimations(){this.isAnimating&&await this.await("animationend",{checkLog:!1})}static query(e,t=!1){const{idMap:n}=il.identifiable;for(const r in n)if(il.widgetMatches(n[r],e,t))return n[r];return null}static queryAll(e,t=!1){const{idMap:n}=il.identifiable,r=[];for(const s in n)il.widgetMatches(n[s],e,t)&&r.push(n[s]);return r}static fromElement(e,t,n){const r=typeof t;e&&!e.nodeType&&(e=e.target),("number"===r||t&&t.nodeType===Element.ELEMENT_NODE)&&(n=t,t=null);let s,i,a,o=e,l=0;for("number"!=typeof n&&(s=n,n=Number.MAX_VALUE),"string"===r&&(t=t.toLowerCase());o&&o.nodeType===Element.ELEMENT_NODE&&l<n&&o!==s;){if(i=o.dataset&&o.dataset.ownerCmp||o.id,i){if(a=il.getById(i),a){if(!t)return a;if("function"===r){if(t(a))return a}else if(il.widgetMatches(a,t,!0))return a}l++}o=o.parentNode}return null}static fromSelector(e){const t=document.querySelector(e);return t?il.fromElement(t):null}triggerFieldChange(e,t=!0){var n;t&&this.trigger("change",e),null===(n=this.eachAncestor)||void 0===n||n.call(this,(t=>{var n,r;if(null===(n=t.onFieldChange)||void 0===n||n.call(t,e),null!==(r=t.isolateFieldChange)&&void 0!==r&&r.call(t,this))return!1}))}isolateFieldChange(e){return this.isolateFields}setupFocusListeners(){xr.setupFocusListenersOnce(this.eventRoot,Mn)}static widgetMatches(e,t,n){return"*"===t||("function"==typeof t?t(e):il.isType(e,t,n))}static attachTooltip(e,t){return"string"==typeof t&&(t={html:t}),il.create(Object.assign({forElement:e},t),"tooltip"),e}changeDock(e){return"start"===e?"left":"end"===e?"right":e}updateRtl(e){super.updateRtl(e),this.eachWidget((t=>{"rtl"in t.initialConfig||(t.rtl=e)}))}}const al=il.prototype;["compose","domSyncCallback"].forEach((e=>al[e].$nullFn=!0)),il.initClass(),il.register("mask",Ao),yr.Widget=il,xr.Widget=il,Ao.identifiable.idMap=il.identifiable.idMap,Object.assign(globalThis.bryntum||(globalThis.bryntum={}),{get:il.getById.bind(il),query:il.query,queryAll:il.queryAll,fromElement:il.fromElement,fromSelector:il.fromSelector}),il._$name="Widget";class ol extends(ue.mixin(Ne,fs)){static type="default";static configurable={owner:null,containerCls:"b-auto-container",itemCls:null};static factoryable={defaultType:"default"};get contentElement(){var e;return null===(e=this.owner)||void 0===e?void 0:e.contentElement}onChildAdd(e){}onChildRemove(e){}renderChildren(){const e=this,{owner:t,itemCls:n}=e,{contentElement:r,items:s}=t,i=t.itemCls,a=null==s?void 0:s.length;if(a){t.textContent=!1;for(let e=0;e<a;e++){const a=s[e],{element:o}=a,{classList:l}=o;o.dataset.itemIndex=e,l.contains("b-outer")&&l.remove(...il.outerCls),n&&l.add(n),i&&l.add(i),a.render(r,Boolean(t.isPainted))}}e.syncPendingConfigs(),e.syncChildCount()}removeChild(e){const t=this,{element:n}=e,{owner:r,itemCls:s}=t,{contentElement:i}=r,a=r.itemCls;i.contains(n)&&n.remove(),delete n.dataset.itemIndex,s&&n.classList.remove(s),a&&n.classList.remove(a),t.fixChildIndices(),t.syncChildCount()}appendChild(e){const{element:t}=e,{owner:n,itemCls:r}=this,{contentElement:s}=n,i=n.itemCls;t.dataset.itemIndex=n.indexOfChild(e),n.textContent=!1,r&&t.classList.add(r),i&&t.classList.add(i),e.render(s,Boolean(n.isPainted)),this.syncChildCount()}insertChild(e,t){const n=this,{element:r}=e,{owner:s,itemCls:i}=n,{contentElement:a}=s,o=yr.getChild(a,`[data-item-index="${t}"]`),l=s.itemCls;s.textContent=!1,i&&r.classList.add(i),l&&r.classList.add(l),a.insertBefore(r,o),e.render(null,Boolean(s.isPainted)),n.fixChildIndices(),n.syncChildCount()}fixChildIndices(){this.owner.items.forEach(((e,t)=>{e.element.dataset.itemIndex=t}))}syncChildCount(){var e;const{owner:t}=this,{length:n}=t.items;null===(e=t.contentElement)||void 0===e||e.classList[1===n?"add":"remove"]("b-single-child")}syncConfigLater(e){const t=this.pendingConfigs||(this.pendingConfigs=[]);t.includes(e)||t.push(e)}syncConfigStyle({name:e,style:t,classes:n,map:r}){const s=this,i=`b-box-${e}-`,{contentElement:a}=s,o=s[e];let l=(null==r?void 0:r[o])||o;if(a){if(n){const{classList:e}=a;n.forEach((t=>{t!==l&&e.remove(i+t)})),n.includes(l)&&(e.add(i+l),l="")}a.style[t]=l}else s.syncConfigLater(e)}syncPendingConfigs(){const e=this,{pendingConfigs:t}=e;let n;if(t)for(e.pendingConfigs=null;n=t.pop();)e[e.$meta.configs[n].updater](e[n])}}ol.initClass(),ol._$name="Layout";let ll=0;const cl=e=>e.ripple;class dl extends il{static $name="Ripple";static type="ripple";static get defaultConfig(){return{old_element:{children:[{className:"b-ripple-inner",reference:"rippleElement"}]},element:{children:[{tag:"svg",class:"b-ripple-inner",reference:"rippleElement",ns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 100 100",children:[{reference:"circleElement",tag:"circle",cx:"0",cy:"0",r:10}]}]},floating:!0,hideAnimation:!1,showAnimation:!1,scrollAction:"realign",color:"rgba(0,0,0,.3)",startRadius:10,radius:100}}afterConstruct(){super.afterConstruct(),Mn.on({element:this.rootElement,mousedown:"onRippleControllingEvent",thisObj:this,capture:!0,once:!0})}onRippleControllingEvent(e){var t;const n=this;n.show();const r=yr.getStyleValue(n.circleElement,"animationName");n.hide(),null===(t=n.listenerDetacher)||void 0===t||t.call(n),r&&"none"!==r&&(n.listenerDetacher=Mn.on({mousedown:{element:n.rootElement,capture:!0,handler:"onMousedown"},touchstart:{element:n.rootElement,capture:!0,handler:"onTouchStart"},animationend:{element:n.circleElement,handler:"onAnimationEnd"},thisObj:n}),"mousedown"===e.type&&(n.onMousedown(e),xr.ion({theme:"onRippleControllingEvent",thisObj:this})))}onTouchStart(e){ll=performance.now(),this.handleTriggerEvent(e)}onMousedown(e){performance.now()-ll>200&&this.handleTriggerEvent(e)}handleTriggerEvent(e){const t=il.fromElement(e.target,cl);if(t){const n=t.ripple,r=n.delegate?e.target.closest(n.delegate):t.focusElement||t.element;if(r){const s=Ut.assign({event:e,target:r,radius:this.radius},n);if("string"==typeof s.clip&&(s.clip=t[s.clip]||e.target.closest(s.clip),!s.clip))return;this.ripple(s)}}}ripple({event:e,point:t=Mn.getClientPoint(e),target:n=e.target,clip:r=n,radius:s=this.radius,color:i=this.color}){this.clip=r;const a=this,o=(r=vn.from(r,null,!0)).getDelta(t),l=a.rippleElement.style,c=a.circleElement,d=yr.getStyleValue(n,"border-radius");a.hide(),l.transform=`translateX(${o[0]}px) translateY(${o[1]}px)`,l.height=l.width=`${s}px`,a.element.style.borderRadius=d,c.setAttribute("r",s),c.setAttribute("fill",i),a.showBy({target:r,align:"c-c",matchSize:!0})}onAnimationEnd(e){"b-ripple-expand"===e.animationName&&this.hide()}}il.RippleClass=dl,dl._$name="Ripple";const ul=Object.freeze({}),{isArray:hl}=Array,gl=e=>e.weight,ml=({weight:e},{weight:t})=>"string"==typeof e||"string"==typeof t?String(e).localeCompare(String(t)):(e??Number.MAX_SAFE_INTEGER)-(t??Number.MAX_SAFE_INTEGER),pl=e=>e&&!e.hidden,fl=["display","flex-direction"],vl={default:1,box:1};class yl extends il{static $name="Container";static type="container";static get configurable(){return{items:null,lazyItems:{$config:["lazy"],value:null},defaults:null,defaultType:"widget",layoutStyle:null,itemCls:null,layout:{type:"default"},namedItems:null,overflowable:{value:null,default:!1,$config:null},textContent:!0,record:null,strictRecordMapping:null,autoUpdateRecord:null,autoUpdateFields:null,hideWhenEmpty:null,contentElMutationObserver:{$config:["lazy","nullify"],value:!0},isolateFields:!1,focusDescendant:!1,defaultBindProperty:null,defaultFocus:null}}static get prototypeProperties(){return{flexRowCls:"b-flex-row",flexColCls:"b-flex-column",initialItems:!0}}startConfigure(e){const t=e.items||e.lazyItems;(this.hasItems=Boolean(t&&(hl(t)?t:Object.keys(t)).length))||(this.initialItems=!1),super.startConfigure(e)}get firstItem(){return this.getAt(0)}get lastItem(){return this.getAt(-1)}getAt(e){return this.ensureItems().at(e)}remove(...e){let t=!0;1===e.length&&(hl(e[0])?e=e[0]:t=!1);const n=this,{_items:r}=n,s=[];for(let t=0;t<e.length;t++){const i=e[t];r.includes(i)&&(r.remove(i),n.layout.removeChild(i),s.push(i),n.onChildRemove(i))}return t?s:s[0]}removeAll(){return this.remove(this.items)}add(...e){const t=this,n=t.ensureItems(),r=[];let s,i,a,o=!0;for(1===e.length&&(hl(e[0])?e=e[0]:o=!1),i=0;i<e.length;i++){var l;s=e[i],s.isWidget?s.parent=t:s=t.createWidget(s),null!=(null===(l=s)||void 0===l?void 0:l.weight)?(a=ge.findInsertionIndex(s,n.values,ml),r.push(t.insert(s,a))):s&&(n.includes(s)||(n.add(s),t.onChildAdd(s),t.layout.appendChild(s),r.push(s)))}return o?r:r[0]}ensureItems(){const e=this;return e.getConfig("items"),e.getConfig("lazyItems"),e._items||(e.items=[]),e._items}insert(e,t){const n=this,r=n.ensureItems();e instanceof il?e.parent=n:e=n.createWidget(e),r.includes(t)&&(t=n.indexOfChild(t)),t=Math.min(t,r.count);const s=r.values;return s.splice(t,0,e),r.values=s,n.onChildAdd(e),n.layout.insertChild(e,t),e}indexOfChild(e){return this.items.indexOf(e)}changeLazyItems(e){this.items=e,this.layout.renderChildren()}changeItems(e,t){const n=this,r=[],s=new ii;return hl(e)?n.processItemsArray(e,r):e&&n.processItemsObject(e,n.namedItems,r),r.some(gl)&&r.sort(ml),s.add(r),t&&t.forEach((e=>{n.remove(e),s.includes(e)||e._createdBy!==n||e.destroy()})),s}afterConstruct(){const{rtl:e}=this,{classList:t}=this.contentElement;t.toggle("b-rtl",!0===e),t.toggle("b-ltr",!1===e)}updateRtl(e){super.updateRtl(e);const{contentElement:t}=this;t&&(t.classList.toggle("b-rtl",!0===e),t.classList.toggle("b-ltr",!1===e))}updateItems(e,t){let n=0;e.forEach((e=>{this.onChildAdd(e),t&&!t.temporary&&this.layout.insertChild(e,n),++n})),this.initialItems=!1}updateHideWhenEmpty(){this.syncChildCount(this.rendered)}get items(){const e=this;if(e.getConfig("lazyItems"),!e._items){if(e.initializingItems)return[];e._items=new ii,e._items.temporary=!0}return e._items.values}processItemsArray(e,t){const n=e.length;let r,s;for(r=0;r<n;r++)s=e[r],s instanceof il?(s.parent=this,s.element.classList.remove(...il.outerCls)):s=this.createWidget(s),s&&((s.ref||s.id)&&this.addDescendant(s),t.push(s))}processItemsObject(e,t,n){let r,s;for(s in e)r=e[s],r&&(t&&s in t&&(r="object"==typeof r?Ut.merge(Ut.clone(t[s]),r):t[s]),r&&(r instanceof il?r.parent=this:(r instanceof Object&&(r.ref=s),r=this.createWidget(r)),r&&(r.ref=s,this.addDescendant(r),n.push(r))))}onChildAdd(e){if(e.innerItem&&this.readOnly&&!e.ignoreParentReadOnly&&(e.readOnly=!0),this.onChildAddLayout(e),e.ref||e.id)for(let t=this;t;t=t.parent)t.addDescendant(e);this.syncChildCount(!0)}onChildAddLayout(e){e.innerItem&&this.layout.onChildAdd(e)}onChildHide(e){var t;super.onChildHide(e),null!==(t=this._items)&&void 0!==t&&t.includes(e)&&this.syncChildCount(!0)}onChildShow(e){var t;super.onChildShow(e),null!==(t=this._items)&&void 0!==t&&t.includes(e)&&this.syncChildCount(!0)}syncChildCount(e){if(!this.isConfiguring){const t=this,{items:n,hasItems:r}=t,s=n.filter(pl),{length:i}=s;if(t.visibleChildCount=i,t.hideWhenEmpty&&e){const e=Boolean(!i);Boolean(t._hidden)!==e&&(t.hidden=e)}n.forEach((e=>e.element.classList.remove("b-last-visible-child","b-first-visible-child"))),i&&(s[0].element.classList.add("b-first-visible-child"),s[i-1].element.classList.add("b-last-visible-child")),t.hasItems=Boolean(t.childItems.length),t.contentElement.classList[i?"remove":"add"]("b-no-visible-children"),t.isComposable?r!==t.hasItems&&t.recompose():t.updateTextContent(t._textContent)}}syncFlexDirection(){const{contentElement:e,flexColCls:t,flexRowCls:n}=this,r=new Sn(e.className),s=yr.getStyleValue(e,fl);r[n]=r[t]=0,"flex"===s.display&&(r["row"===s["flex-direction"]?n:t]=1),yr.syncClassList(e,r)}addDescendant(e){const t=e.ref||e.id,n=this._widgetMap||(this._widgetMap={});n[t]||(n[t]=e)}onChildRemove(e){const t=this,n=e.ref||e.id;if(n)for(let r=t;r;r=r.parent)r.widgetMap[n]===e&&delete r.widgetMap[n];t.layout.onChildRemove(e),t.syncChildCount(!0)}get widgetMap(){return this._widgetMap||(this._widgetMap={}),this.initializingItems||this.getConfig("items"),this._widgetMap}changeRecord(e){return this._record=null==e?ul:null,e}updateRecord(e){var t;const n=this;null===(t=n.recordUpdateDetacher)||void 0===t||t.call(n),n.trigger("beforeSetRecord",{record:e}),n.setValues(e,{onlyName:n.strictRecordMapping,highlight:Boolean(n.$highlight)}),n.autoUpdateFields&&null!=e&&e.firstStore&&(n.recordUpdateDetacher=e.firstStore.ion({update:n.onRecordUpdated,thisObj:n}))}setRecord(e,t){this.$highlight=t,this.record=e,this.$highlight=!1}onRecordUpdated({record:e}){e===this.record&&this.setValues(this.record,!0,!0)}onFieldChange({source:e,userAction:t}){if(this.autoUpdateRecord&&t){const{record:t,strictRecordMapping:n}=this,{name:r,ref:s,isValid:i=!0,value:a}=e,o=n?r:r||s;t&&o&&i&&(t.isModel?t.setValue(o,a):t[o]=a)}}getValues(e){const t={};return this.eachWidget(((n,r)=>{n.isolateFields?r.down=!1:!("name"in n)||e&&!e(n)||(t[n.name]=n.value)}),!0),t}get values(){const e={};return this.gatherValue(e),e}set values(e){this.assignValue(e)}get isSettingValues(){return Boolean(this.assigningValues)}get assigningValues(){var e;return this._assigningValues||(null===(e=this.parent)||void 0===e?void 0:e.assigningValues)}set assigningValues(e){this._assigningValues=e}assignValue(e,t){super.assignValue(e,t),this.isolateFields||this.setValues(e,t)}gatherValue(e){super.gatherValue(e),this.isolateFields||this.gatherValues(e)}setValues(e,t=this.assignValueDefaults){this.assigningValues=t,this.eachWidget((n=>n.assignValue(e,t)),!1),this.assigningValues=!1}get hasNoChildren(){const e=this,{items:t,lazyItems:n}=e.initialConfig,r=t&&(hl(t)?t:Ut.values(t)),s=n&&(hl(n)?n:Ut.values(n)),i=e.isConfiguring?s||r:e.items;return!(null!=i&&i.filter(pl).length)}afterRecompose(){super.afterRecompose(),this.realign()}updateTextContent(e){const t=this;if(!t.isComposable){const n=Boolean(e&&t.hasNoChildren),{classList:r}=t.contentElement;n!==r.contains("b-text-content")&&(r[n?"add":"remove"]("b-text-content"),t.rendered&&t.realign())}}updateLayoutStyle(e){yr.applyStyle(this.contentElement,e)}updateElement(e){if(super.updateElement(...arguments),e){const{classList:e}=this.contentElement,{containerCls:t}=this.layout;e.add("b-content-element"),t&&e.add(t)}}onInternalPaint(){var e;null===(e=super.onInternalPaint)||void 0===e||e.call(this,...arguments),this.getConfig("contentElMutationObserver")}changeContentElMutationObserver(e,t){if(t&&(t.takeRecords(),t.disconnect()),e){const t=this,{element:n,contentElement:r}=t;(e=new MutationObserver((e=>t.onContentElMutation(e)))).observe(r,{attributes:!0}),r!==n&&e.observe(n,{attributes:!0}),t.syncFlexDirection()}return e}onContentElMutation(e){vl[this.layout.type]&&this.isVisible&&e.some((e=>this.contentElement.contains(e.target)))&&this.syncFlexDirection()}changeLayout(e,t){return ol.reconfigure(t,e,{owner:this,defaults:{owner:this}})}get childItems(){return this.items}getWidgetById(e){return this.widgetMap[e]}processWidgetConfig(e){}setupWidgetConfig(e,t){const n=this;"string"==typeof e?e={html:e}:e.nodeType===Element.ELEMENT_NODE&&(e={element:e,id:e.id}),("string"==typeof t||!t&&(t=e.type))&&("checkbox"===t&&r.isMobile&&il.resolveType("slidetoggle",!0)&&(t=e.type="slidetoggle"),t=il.resolveType(t,!0));for(let r=(e=(t||il).mergeConfigs(n.defaults,e,{parent:n})).parent;r;r=r.parent)if(!1===r.processWidgetConfig(e))return null;return!1===n.trigger("beforeWidgetCreate",{widgetConfig:e})?null:e}createWidget(e){const t=il.create(this.setupWidgetConfig(e),this.defaultType);return t&&(t._createdBy=this),t}updateDefaults(e,t){if(!this.isConfiguring&&e){const n=Object.entries(e);this.eachWidget((e=>{n.forEach((([n,r])=>{t&&e[n]!==t[n]||(e[n]=r)}))}),!1)}}render(){this.getConfig("lazyItems"),this.layout.renderChildren(),this.syncChildCount(),super.render(...arguments)}get focusElement(){const e=this.query(this.defaultFocus||(e=>{var t;return e.isFocusable&&"close"!==e.ref&&!(null!==(t=e.ref)&&void 0!==t&&t.endsWith("collapse"))}));return e?e.focusElement:super.focusElement}doDestroy(){var e;null===(e=this._items)||void 0===e||e.forEach((e=>{var t;return null===(t=e.destroy)||void 0===t?void 0:t.call(e)})),this.layout.destroy(),super.doDestroy()}get isValid(){let e=!0;return this.eachWidget((t=>{t.isVisible&&"isValid"in t&&!t.isValid&&(e=!1)}),!0),e}}yl.initClass(),yl._$name="Container";const{assign:bl}=Ut,Cl=()=>performance.now(),Sl={start:!1},wl=/^[.\d]+([^\d].*)?$/,Dl=e=>{const t=e.$bryntum||(e.$bryntum={});return t.transitions||(t.transitions=Object.create(null))},Tl=(e,t)=>{var n;"string"==typeof e&&(t=null===(n=wl.exec(e))||void 0===n?void 0:n[1],e=parseFloat(e));return e&&e*("s"===t||!t&&e<10?1e3:1)},El=e=>{const t=Ut.values(Dl(e)).filter((e=>null==e.completed)).map((e=>e.toString()));e.style.transition=t.join(", ")},xl=e=>class extends e{static get prototypeProperties(){return{_delay:null,_duration:null,_retain:null,_timing:null,_unit:null,owner:null,reverting:null}}constructor(...e){super(...e),this.id=++kl}start(){this.startTime=Cl()}get delay(){var e;return Tl(this._delay??(null===(e=this.owner)||void 0===e?void 0:e.delay)??0,this.unit)}set delay(e){this._delay=e}get duration(){const{owner:e,unit:t}=this;return Tl(this._duration??(e?e.duration:Rl.defaultDuration),t)}set duration(e){this._duration=e}get elapsed(){return Cl()-this.startTime}get remaining(){return this.duration-this.elapsed}get retain(){var e;return this._retain??(null===(e=this.owner)||void 0===e?void 0:e.retain)}set retain(e){this._retain=e}get timing(){var e;return this._timing??(null===(e=this.owner)||void 0===e?void 0:e.timing)}set timing(e){this._timing=e}get unit(){var e;return this._unit??(null===(e=this.owner)||void 0===e?void 0:e.unit)}set unit(e){this._unit=e}};let kl=0;class Il extends(ue.mixin(xl)){static get $name(){return"AnimatorTransition"}static get prototypeProperties(){return{element:null,property:null,from:null,to:null,completed:null,promissory:null,reverting:null}}afterConstruct(){super.afterConstruct();const e=this,{element:t,transitions:n}=e;let{property:r}=e;[r,e.to]=yr.unitize(r,e.to),e.from=yr.unitize(r,e.from)[1],e.promissory=new Ro,e.property=r;const s=n[r];n[r]=e;let{from:i}=e;s&&(e.from=s.to,i=null,s.destroy()),null===i&&(i=e.getCurrentStyleValue(),s||(e.from=i)),t.style[r]=i,e.getCurrentStyleValue()}doDestroy(){const e=this;e.finish(!1),e.completed&&!e.retain&&e.clearStyle(),super.doDestroy()}get promise(){var e;return null===(e=this.promissory)||void 0===e?void 0:e.promise}get transitions(){return Dl(this.element)}clearStyle(){this.setStyle("")}finish(e){const t=this,{transitions:n,promissory:r,property:s}=t;r&&(t.completed=e,t.promissory=null,r.resolve(e),n[s]===t?(delete n[s],e||(El(t.element),t.clearStyle())):t.completed=!1)}getCurrentStyleValue(){return yr.getStyleValue(this.element,this.property)}revert(){const{duration:e,elapsed:t,element:n,from:r,property:s,_retain:i,_timing:a}=this;return new Il({element:n,property:s,retain:i,timing:a,duration:Math.round(Math.min(e,t)),reverting:this,to:r,unit:"ms"})}setStyle(e){this.element.style[this.property]=e}start(){const e=this,{delay:t,duration:n,element:r,property:s}=e;Mn.onTransitionEnd({element:r,property:s,duration:t+n+20,thisObj:e.owner,handler:()=>{var t;return null===(t=e.finish)||void 0===t?void 0:t.call(e,!0)}}),super.start(),e.setStyle(e.to)}toString(){const{delay:e,duration:t,property:n,timing:r}=this;return`${n} ${t}ms ${r||"ease-in-out"}${e?` ${e}ms`:""}`}}Il.initClass();class Rl extends(ue.mixin(xl)){static get $name(){return"Animator"}static get prototypeProperties(){return{element:null,finalize:null,prefinalize:null,completed:null,items:null}}static register(e,t){Ut.isObject(e)?Ut.entries(e).forEach((e=>Rl.register(...e))):(Rl.fx[e]=t,Rl[e]=t=>(yr.isElement(t)?t={element:t,[e]:{}}:delete(t={element:t.element,[e]:t})[e].element,Rl.run(t)))}static run(e){return new Rl(e).start()}constructor(e){var t;super(null);const n=this,r=[],s={};let i,a,o,l;if(Array.isArray(e))n.items=e;else for(o in e)(Rl.specialPropsRe.test(o)?n:s)[o]=e[o];Ut.keys(s).forEach((e=>{l=s[e],null!=l&&!1!==l&&l==l&&((a=Rl.fx[e])?(l=bl(n.defaults,a(l,n,e)),l.owner=n,i=new Rl(l)):(l=bl(n.defaults,"object"==typeof l?l:{to:l}),l.owner=n,l.property=e,i=new Il(l)),r.push(i))})),null===(t=n.items)||void 0===t||t.forEach((e=>{Ut.isInstantiated(e)?e.owner=n:((e=bl(n.defaults,e)).owner=n,e=new Rl(e)),r.push(e)})),n.items=r,n.promise=(1===r.length?r[0].promise:Promise.all(r.map((e=>e.promise)))).then((e=>{var t;return null===(t=n.finish)||void 0===t||t.call(n,e),n.completed||!1}))}doDestroy(){this.items.forEach((e=>e.destroy())),super.doDestroy()}get defaults(){return{element:this.element}}get retain(){const{_retain:e,finalize:t,owner:n}=this;return e??(!t&&(!n||n.retain))}set retain(e){super.retain=e}done(){return this.promise}finish(e){var t,n;const r=this,{items:s}=r;for(El(r.element),r.completed="boolean"==typeof e?e:!e.some((e=>!e)),null===(t=r.prefinalize)||void 0===t||t.call(r,r.completed,r);s.length;)s.pop().destroy();null===(n=r.finalize)||void 0===n||n.call(r,r.completed,r)}revert(e){const t=this,{reverting:n}=t,r=!e||(e.start??!0);let s=t.defaults;return n&&(n.finalize&&(s.finalize=n.finalize),n.prefinalize&&(s.prefinalize=n.prefinalize),s.retain=n._retain),s=bl(s,e,{items:t.items.map((e=>e.revert(Sl))),reverting:t}),s=new Rl(s),r&&s.start(),s}start(){const{element:e,items:t}=this;return super.start(),t.length&&(El(e),t.forEach((e=>e.start()))),this}}Rl.initClass().Transition=Il,Rl.specialPropsRe=new RegExp(`^(?:${Object.keys(Rl.prototypeProperties).concat(Object.keys(Rl.superclass.prototypeProperties)).map((e=>"_"===e[0]?e.substr(1):e)).join("|")})$`),Rl.defaultDuration=200,Rl.fx={},Rl.register({puff:e=>(!0===e?e={}:"object"!=typeof e?e={transform:`scale(${e})`}:e.scale&&((e=Ut.clone(e)).transform=`scale(${e.scale})`,delete e.scale),bl({opacity:0,transform:"scale(8)"},e))}),Rl._$name="Animator";class Ml extends(ue.mixin(Ur)){static get configurable(){return{element:null,delegate:null,delay:500,startRate:2,endRate:20,accelerateDuration:4e3,pressedCls:"b-pressed"}}doDestroy(){var e;null===(e=this.mousedownRemover)||void 0===e||e.call(this),this.cancel(),super.doDestroy()}cancel(){var e,t,n;const r=this;null===(e=r.activeElement)||void 0===e||e.classList.remove(r.pressedCls),r.activeElement=null,null===(t=r.acceleration)||void 0===t||t.cancel(),r.activeListenerRemover=null===(n=r.activeListenerRemover)||void 0===n?void 0:n.call(r),r.clearTimeout(r.autoRepeatTimer),r.clearTimeout(r.repeatTimer)}updateElement(e){var t;null===(t=this.mousedownRemover)||void 0===t||t.call(this),this.mousedownRemover=Mn.on({element:e,mousedown:"onMouseDown",thisObj:this})}onMouseDown(e){const t=this,n=t.delegate?e.target.closest(t.delegate):t.element;t.cancel(),n&&(t.activeElement=n,t.triggerEvent=e,n.classList.add(t.pressedCls),t.activeListenerRemover=Mn.on({mouseup:{element:document,capture:!0,handler:"onMouseUp"},mousemove:{element:n,handler:"onTargetMouseMove"},mouseleave:{element:n,handler:"onTargetMouseLeave"},mouseenter:{element:n,handler:"onTargetMouseEnter"},thisObj:t}),t.autoRepeatTimer=t.setTimeout("startAutoRepeat",t.delay))}onMouseUp(){this.cancel()}onTargetMouseLeave(){this.activeElement.classList.remove(this.pressedCls),this.clearTimeout(this.repeatTimer)}onTargetMouseEnter(e){const t=this;e.buttons?(t.activeElement.classList.add(t.pressedCls),t.triggerEvent=e,t.fireClick()):t.cancel()}onTargetMouseMove(e){this.triggerEvent=e}startAutoRepeat(){const e=this;e.interval=e.startInterval=1e3/e.startRate,e.accelerationDelta=e.startInterval-1e3/e.endRate,e.fireClick(),e.acceleration=Ce.animate(e.accelerateDuration,e.nextTick,e,"easeOutQuad")}nextTick(e){this.interval=this.startInterval-this.accelerationDelta*e}fireClick(){const e=this,t=new MouseEvent("click",e.triggerEvent);e.triggerEvent.target.dispatchEvent(t),e.repeatTimer=e.setTimeout(e.fireClick,e.interval)}}Ml._$name="ClickRepeater";const Ol=/^(?:undefined|null|LEFT|RIGHT)$/,Al={TOP:"BOTTOM",RIGHT:"LEFT",BOTTOM:"TOP",LEFT:"RIGHT"},Fl=e=>{const t=null==e?void 0:e.toUpperCase();return[t,"LEFT"===t||"RIGHT"===t]};var Pl=e=>class extends(e||ue){static $name="Rotatable";static get configurable(){return{rotate:null,invertRotate:null}}compose(){const{rotate:e}=this;return{class:{[`b-rotate-${(e||"").toLowerCase()}`]:e,"b-rotate-vertical":e}}}syncRotationToDock(e){if(Ol.test(String(this.rotate))){const[t,n]=Fl(e);this.rotate=n?this.invertRotate?Al[t]:t:null}}get widgetClass(){return null}};class Ll extends(il.mixin(Pl)){static $name="Tool";static type="tool";static configurable={align:{value:null,$config:{merge:"replace"}},href:null,repeat:null,defaultBindProperty:null};compose(){const{align:e,href:t}=this;return{tag:null!=t?"a":"button",class:{[`b-align-${e||"end"}`]:1,"b-icon":1},listeners:{click:"onInternalClick"}}}get focusElement(){return this.element}get panel(){var e,t;if(null!==(e=this.parent)&&void 0!==e&&e.isPanel&&null!==(t=this.element)&&void 0!==t&&t.parentNode.matches(".b-panel-header"))return this.parent}changeAlign(e){return e}onInternalClick(e){const t=this,{handler:n,panel:r}=t,s={domEvent:e,tool:t};t.disabled||(t.trigger("click",s),t.isDestroyed||(t.trigger("action",s),t.isDestroyed||!1===(null==r?void 0:r.trigger("toolClick",s))||n&&t.callback(n,r,[e,r,t])))}onInternalKeyDown(e){"Enter"===(e.key.trim()||e.code)&&(e.cancelBubble=!0,e.stopPropagation())}updateDisabled(e,t){var n;super.updateDisabled(e,t),e&&(null===(n=this.repeat)||void 0===n||n.cancel())}changeRepeat(e,t){return null==t||t.destroy(),e&&Ml.new({element:this.element},e)}}Ll.initClass(),Ll._$name="Tool";const $l=/right/i,_l=e=>(e.collapsed||e.collapsing)&&"top"===e.owner.expandedHeaderDock&&e.owner.collapsible.direction.match($l)?"start":"end";class Nl extends Ll{static $name="CollapseTool";static type="collapsetool";static get configurable(){return{autoAlign:!0,collapsed:null,collapsing:null,collapsify:!1,direction:"up",defaultBindProperty:null}}compose(){const{collapsed:e,direction:t}=this;return{class:{[`b-icon-collapse-${t}`]:1,"b-collapsed":e}}}changeAutoAlign(e){return!0===e?_l:e}syncAutoAlign(){const{autoAlign:e}=this;e&&(this.align=e(this))}updateAutoAlign(){this.syncAutoAlign()}updateCollapsed(){this.syncAutoAlign()}updateCollapsing(){this.syncAutoAlign()}updateDirection(){this.syncAutoAlign()}}Nl.initClass(),Nl._$name="CollapseTool";const jl=/^(?:UP|DOWN|LEFT|RIGHT)$/,Vl=/^(left|top)$/i,Bl={},zl=/^b-dock-(top|left|right|bottom)$/,Wl="b-panel-collapse-revealer",Hl=/^(?:left|right)$/i,Ul="b-collapse-unflex",{round:Yl}=Math,ql=["up","down","left","right"].reduce(((e,t)=>(e[t.toUpperCase()]=e[t]=t,e)),{}),Kl={top:["top","bottom"],right:["right","left"],bottom:["bottom","top"],left:["left","right"]},Gl={hl:"LEFT",hr:"RIGHT",vb:"DOWN",vt:"UP"},Xl={h:"w",w:"h"},Zl={up:"top",right:"right",down:"bottom",left:"left"},Jl={top:!1,right:!0,bottom:!1,left:!0},Ql={top:"UP",right:"RIGHT",bottom:"DOWN",left:"LEFT"},ec={top:e=>`translate(0, -${Yl(e.height||0)}px)`,bottom:e=>`translate(0, ${Yl(e.height||0)}px)`,right:e=>`translate(${Yl(e.width||0)}px, 0)`,left:e=>`translate(-${Yl(e.width||0)}px, 0)`};let tc=0;class nc extends(ue.mixin(fs)){static $name="PanelCollapser";static type="inline";static get configurable(){return{animation:{duration:200},collapsed:{value:null,$config:null,default:!1},direction:null,collapseTooltip:"L{Collapse}",expandTooltip:"L{Expand}",panel:{value:null,$config:"nullify"},supportAxis:null,tool:{type:"collapsetool",handler(e){var t;null===(t=this.collapsible)||void 0===t||t.onCollapseClick(e)}}}}static get factoryable(){return{defaultType:"inline"}}get collapsing(){return"collapsing"===this.collapsingExpanding}get collapsingExpanding(){var e;const t=null===(e=this.currentOperation)||void 0===e?void 0:e.collapsing;return null==t?null:t?"collapsing":"expanding"}get currentDock(){var e,t,n;return(null===(e=this.panel)||void 0===e||null===(t=e.header)||void 0===t||null===(n=t.dock)||void 0===n?void 0:n.toLowerCase())??"top"}get expanding(){return"expanding"===this.collapsingExpanding}get collapseTool(){var e,t;return null===(e=this.panel)||void 0===e||null===(t=e.tools)||void 0===t?void 0:t.collapse}get collapseDim(){return Hl.test(this.collapseDir)?"width":"height"}getCollapseDir(e){let{direction:t,panel:n}=this;if(!t||jl.test(t)){const e=null==n?void 0:n.placement;var r;if(e)t=Gl[e];else t=Ql[(null==n||null===(r=n.header)||void 0===r?void 0:r.dock)||"top"]}return e?ql[t]:t}get collapseDir(){return this.getCollapseDir(!0)}get collapseDock(){return this.collapseInfo[0]}get collapseInfo(){const{panel:e}=this,t=e.hasHeader&&e.expandedHeaderDock;let n=Zl[this.collapseDir],r=!1;return t&&((r=Jl[n]!==Jl[t])||(n=t)),[n,r]}get toolsConfig(){const{direction:e,tool:t}=this;return t&&{collapse:Ut.assign({direction:e.toLowerCase()},t)}}beforeCollapse(e){const{panel:t}=this,{element:n}=t;n.contains(yr.getActiveElement(n))&&t.revertFocus(!0)}changeTool(e){const t=this,{panel:n}=t;if(t.isConfiguring||t.isDestroying||!n||n.isDestroying)return e;n.tools={collapse:e}}collapse(e){var t,n;const r=this,{panel:s}=r,i={id:++tc,completed:!1,panel:s};let{currentOperation:a}=r;return e=e??!0,Ut.isObject(e)&&(i.collapsed=!0,Ut.assign(i,e),e=i.collapsed,delete i.collapsed),i.collapsing=e,i.previous=a??null,e!==r.collapsed?a?a.collapsing!==e&&(i.animation=a.animation.revert({finalize(){var e;null===(e=r.collapseFinalize)||void 0===e||e.call(r,i,!0)}}),i.collapsing=e,a=i):(i.animation=Ut.clone(("animation"in i?i:r).animation),!1!==r.beforeCollapse(i)&&(i.animation&&(i.animation.finalize=e=>{var t;return null===(t=r.collapseFinalize)||void 0===t?void 0:t.call(r,i,e)}),s.changingCollapse=!0,r[e?"collapseBegin":"expandBegin"](i),i.animation?a=i:(i.completed=!0,r[e?"collapseEnd":"expandEnd"](i)),s.changingCollapse=!1,i.animation||r.onComplete(e?"collapse":"expand"))):a&&a.collapsing!==e&&(r[e?"expandRevert":"collapseRevert"](i),i.animation=a.animation.revert({finalize(){var e;null===(e=r.collapseFinalize)||void 0===e||e.call(r,i,!1)}}),a=i),r.currentOperation=a,(null===(t=a)||void 0===t||null===(n=t.animation)||void 0===n?void 0:n.done())??Promise.resolve(e===r.collapsed)}collapseFinalize(e,t){const n=this,{currentOperation:r,panel:s}=n,i=s.collapsed?"expand":"collapse";r===e&&(n.currentOperation=null,e.completed=t,s.changingCollapse=!0,n[i+"End"](e),s.changingCollapse=!1,t&&n.onComplete(i))}applyHeaderDock(e,t=!0){const{currentDock:n,panel:r}=this,s=e?this.collapseDock:r.expandedHeaderDock;s!==n&&r.hasHeader&&(r.header={dock:s},t&&r.recompose.flush())}composeHeader(e){const{panel:t}=this,{class:n}=e,r=t.expandedHeaderDock||Object.keys(n).filter((e=>n[e]&&zl.test(e))).map((e=>zl.exec(e)[1][0]));return n[Wl]=1,n[`b-collapsible-${r[0]}${this.collapseDir[0]}`]=1,e}composeTitle(e){return e.class[Wl]=1,e}collapseBegin(e){var t;const n=this,{animation:r}=e,{collapseDim:s,collapseTool:i,panel:a}=n,{element:o,placement:l}=a,[c,d]=n.collapseInfo,u=null==i?void 0:i.element.classList,h=!l||"h"===l[0]&&"width"===s||"v"===l[0]&&"height"===s;n.configuredWidth=a._lastWidth,n.configuredHeight=a._lastHeight,n.transverseCollapse=d,n.applyHeaderDock(!0);const g=a.rectangle(),m=n.lockInnerSize().moveTo(0,0),p=m.clone(),f=Kl[c],v=null===(t=a.headerElement)||void 0===t?void 0:t.getBoundingClientRect(),y=Yl((null==v?void 0:v[s])||0);o.classList.toggle(Ul,h),r?(p[f[0]]=p[f[1]],o.classList.add("b-collapsing"),null==u||u.add("b-collapsed","b-collapsing"),i&&(i.collapsing=!0),u&&(u.remove("b-collapsed"),a.rectangle(),u.remove("b-collapsing"),u.add("b-collapsed")),r.element=o,r.retain=!0,r[s]={from:Yl(g[s]),to:y},r.items=[{element:n.innerElement,retain:!1,clip:{from:`rect(${m})`,to:`rect(${p})`}}],d&&r.items.push({element:a.headerElement,duration:r.duration,retain:!1,transform:{from:ec[c](v),to:"translate(0, 0)"}}),e.animation=Rl.run(r)):(o.style[s]=`${y}px`,i&&(u.add("b-collapsing","b-collapsed"),i.rectangle(),u.remove("b-collapsing")))}collapseEnd(e){const t=this,{collapseTool:n}=t;t.panel.element.classList.remove("b-collapsing"),n&&(n.collapsing=!1),e.completed?t.collapsed=!0:(t.applyHeaderDock(!1),t.restoreConfiguredSize(),t.lockInnerSize(!1))}collapseRevert(e){var t;null===(t=this.collapseTool)||void 0===t||t.element.classList.remove("b-collapsed")}expandBegin(e){const t=this,{animation:n}=e,{collapseDim:r,collapseTool:s,panel:i}=t,[a,o]=t.collapseInfo,{element:l}=i,c=l.classList,d=c.contains(Ul),u=i.rectangle();c.remove("b-collapsed","b-collapsing"),i.element.style[r]="",t.restoreConfiguredSize(),t.lockInnerSize(!1);const h=i.rectangle(),g=t.lockInnerSize().moveTo(0,0),m=g.clone(),p=Kl[t.collapseDock];null==s||s.element.classList.remove("b-collapsed"),n&&(m[p[0]]=m[p[1]],c.add("b-collapsed","b-expanding"),d&&c.add(Ul),n.element=l,n[r]={from:Yl(u[r]),to:Yl(h[r])},n.items=[{element:t.innerElement,retain:!1,clip:{from:`rect(${m})`,to:`rect(${g})`}}],o&&n.items.push({element:i.headerElement,duration:n.duration,retain:!1,transform:{from:"translate(0, 0)",to:ec[a](u)}}),e.animation=Rl.run(n))}expandEnd(e){const t=this;t.panel.element.classList.remove("b-expanding"),e.completed&&(t.collapsed=!1,t.applyHeaderDock(!1),t.restoreConfiguredSize(),t.lockInnerSize(!1))}expandRevert(e){var t;null===(t=this.collapseTool)||void 0===t||t.element.classList.add("b-collapsed")}get innerElement(){return this.panel.collapseWrapElement||this.panel.bodyWrapElement}get innerSizeElement(){return this.transverseCollapse?this.panel.element:this.innerElement}get supportAxis(){let{_supportAxis:e}=this;const t=!0===e;return(t||null==e)&&(e=this.collapseDim[0],(t||"absolute"===yr.getStyleValue(this.panel.element,"position"))&&(e+=Xl[e])),e||""}lockInnerSize(e=!0){const t=this,{innerElement:n,panel:r}=t,s=e?t.supportAxis:"",i=r.element,a=r.headerElement,o=e&&a&&vn.from(a,i),l=e&&vn.from(t.innerSizeElement,i),c=n.style;return a&&(a.style.minWidth=s.includes("w")?`${o.width}px`:"",a.style.minHeight=s.includes("h")?`${o.height}px`:""),c.width=e?`${l.width}px`:"",c.height=e?`${l.height}px`:"",n.classList[e?"add":"remove"]("b-panel-collapse-size-locker"),l}onCollapseClick(e){let t=!this.collapsing&&(!!this.expanding||!this.collapsed);e.altKey&&(t={animation:null,collapsed:t}),this.collapse(t)}onComplete(e){var t;null===(t=this.panel)||void 0===t||t.trigger(e)}onHeaderClick({event:e}){0===e.button&&this.panel.collapsed&&e.target.classList.contains(Wl)&&this.onRevealerClick()}onPanelConfigChange({name:e,value:t}){const n=this,{panel:r}=n;"collapsed"===e?r.isPainted&&(n.collapsed=t):"header"!==e||r.changingCollapse||n.syncDirection()}onPanelPaint(){this.syncDirection(),this.panel.collapsed&&!this.collapsed&&this.collapse({animation:null,collapsed:!0})}onRevealerClick(){this.panel._collapse({collapsed:!1})}restoreConfiguredSize(e){const{configuredHeight:t,configuredWidth:n,panel:r}=this;e=e??"wh",r.element.classList.remove(Ul),null!=n&&e.includes("w")&&(r.width=n),null!=t&&e.includes("h")&&(r.height=t)}splitHeaderItems({as:e,dock:t}=Bl){var n;return null===(n=this.panel)||void 0===n?void 0:n.splitHeaderItems({as:e,dock:t,alt:!0})}syncDirection(){const e=this,{direction:t}=e;t&&!jl.test(t)||(e.direction=e.getCollapseDir())}changeCollapsed(e){return Boolean(e)}updateCollapsed(e){const{collapseTool:t,panel:n}=this;n&&(n.collapsed=e,n.element.classList[e?"add":"remove"]("b-collapsed")),t&&(t.collapsed=e)}updateDirection(e){const{collapseTool:t,panel:n}=this;t&&(t.direction=ql[e]),null!=n&&n.rendered&&n.recompose()}updatePanel(e){var t;const n=this;n.syncDirection(),null===(t=n.panelChangeDetacher)||void 0===t||t.call(n),n.panelChangeDetacher=e&&Ce.after(e,"onConfigChange","onPanelConfigChange",n,{return:!1})}wrapCollapser(e,t){var n;const r=this,[s,i]=r.collapseInfo;if(!i)return[e,t];const{collapseDir:a,panel:o}=r,{expandedHeaderDock:l,header:c,uiClassList:d}=o,u=null===(n=o.tools)||void 0===n?void 0:n.recollapse,[h,g]=r.splitHeaderItems({as:"element",dock:s}),m=o.hasHeader?o.title||(null==c?void 0:c.title)||"":null,p=m&&{tag:"header",class:new Sn({...d,[`b-dock-${l}`]:1,"b-panel-header":1,"b-panel-collapser-header":1},null==c?void 0:c.cls),children:[...h,{reference:"collapserTitleElement",html:m,class:{...d,[`b-align-${(null==c?void 0:c.titleAlign)||"start"}`]:1,"b-header-title":1}},...g]};return u&&(u.direction=a),["collapseWrapElement",{class:{...d,[`b-panel-collapser-header-${l}`]:1,[`b-panel-collapser-${a}`]:1,[`b-${Jl[l]?"h":"v"}box`]:1,"b-panel-collapser":1,"b-box-center":1},children:Vl.test(l)?{collapserHeaderElement:p,[e]:t}:{[e]:t,collapserHeaderElement:p}}]}}nc.maps={clipByDock:Kl,dockByDirection:Zl,dockIsHorz:Jl},nc.initClass(),nc._$name="PanelCollapser";const rc=Symbol("pendingCreate");class sc extends ue{static get prototypeProperties(){return{cleanup:null,configName:null,created:null,factory:null,inferType:"name",owner:null,ownerName:null,proxyable:"undefined"!=typeof Proxy,setup:null,transform:null}}static get properties(){return{defaults:{},instances:{},object:Object.create({})}}get proxy(){const e=this;let t=null;return e.proxyable&&(t=new Proxy(e.instances,{get:(t,n)=>e.get(n),set:(t,n,r)=>(e.set(n,r),!0),deleteProperty:(t,n)=>(e.set(n,null),!0)})),Reflect.defineProperty(e,"proxy",{configurable:!0,value:t}),t}get target(){return this.proxy||this.object}define(e,t){const n=this,{transform:r}=n,s=r?r(t,e):t,i=Ut.isInstantiated(s);n.instances[e]=rc,i||n.setDefaults(e,s),n.defineProp(e,!0),i&&n.set(e,s)}defineProp(e,t){const n=this,{object:r}=n;n.proxy||Reflect.defineProperty(t?Object.getPrototypeOf(r):r,e,{configurable:!t,enumerable:!0,get:()=>n.get(e),set:t=>n.set(e,t)})}flush(){const e=this;try{var t;e.updating=!0;for(const t in e.defaults)e.get(t);e.afterConfigureOwner=null===(t=e.afterConfigureOwner)||void 0===t?void 0:t.call(e)}finally{e.updating=!1}}get(e){const{defaults:t,instances:n}=this;return n[e]===rc&&this.set(e,rc),n[e]||t[e]&&null}set(e,t){const n=this,{cleanup:r,configName:s,defaults:i,factory:a,instances:o,owner:l,setup:c,transform:d,updating:u}=n,h=l&&s&&!u,g=o[e]===rc?null:o[e],m=a.reconfigure(g,t===rc?{}:t||null,{cleanup:r&&(t=>r(t,e)),defaults:i[e]||n.setDefaults(e,{}),owner:n.owner,setup:c&&((t,n,r)=>c(t,e,n,r)),transform:d&&(t=>d(t,e))});if(m!==g){const t=h&&{...o};var p;if(o[e]=m,m)n.defineProp(e),null===(p=n.created)||void 0===p||p.call(n,m,e);else delete n.object[e],delete o[e];h&&l.onConfigChange({name:s,config:l.$meta.configs[s],value:n.target,was:t})}}setDefaults(e,t){const{defaults:n,factory:r,inferType:s,instances:i,owner:a,ownerName:o}=this,{typeKey:l}=r.factoryable;return t=!0===t?{}:Ut.assign({},t),("name"===s||!0===s&&!t[l])&&(t[l]=e),o&&(t[o]=a),t.beforeConfigure=t=>{i[e]=t},n[e]=t}update(e){const t=this,{owner:n}=t;let r,s;try{if(t.updating=!0,e)for(r in e)s=e[r],t.defaults[r]?t.set(r,s):s&&t.define(r,s);else for(r in t.instances)t.set(r,null)}finally{t.updating=!1}n&&(n.isConfiguring?t.afterConfigureOwner||(t.afterConfigureOwner=Ce.before(n,"afterConfigure","flush",t)):t.flush())}}sc.initClass(),sc._$name="DynamicObject";const ic=[],ac={},oc={align:1,weight:1};var lc=e=>class extends(e||il){static $name="Toolable";static get configurable(){return{tools:{value:null,$config:{nullify:!0}},toolDefaults:{"*":{type:"tool",align:"end"}}}}byWeightSortFn(e,t){return(e.weight||0)-(t.weight||0)}byWeightReverseSortFn(e,t){return(t.weight||0)-(e.weight||0)}gatherTools({align:e,alt:t,refs:n}=ac){const{collapsed:r,tools:s}=this,i={collapsed:r,alt:t};let a,o,l,c,d,u=[];for(o in s){var h,g,m;d=s[o],a=(null===(h=d)||void 0===h||null===(g=h.align)||void 0===g?void 0:g.align)??(null===(m=d)||void 0===m?void 0:m.align)??"end",a===e&&d.isCollapsified(i)&&u.push(d)}if(u.sort(this["end"===e?"byWeightReverseSortFn":"byWeightSortFn"]),n){const e="widget"===n,t={};for(l=0;l<u.length;++l)c=u[l],t[c.ref]=e?c:c.element;u=t}return u}getEndTools({alt:e,refs:t}=ac){return this.gatherTools({align:"end",alt:e,refs:t})}getStartTools({alt:e,refs:t}=ac){return this.gatherTools({align:"start",alt:e,refs:t})}get childItems(){return[...this.getStartTools(),...this._items||ic,...this.getEndTools()]}changeTools(e,t){const n=this,r=n.$tools||(n.$tools=new sc({configName:"tools",factory:il,inferType:!1,owner:n,created(e){var t,s;e.innerItem=!1,null===(t=e.syncRotationToDock)||void 0===t||t.call(e,null===(s=n.header)||void 0===s?void 0:s.dock),Ce.after(e,"onConfigChange",((e,{name:t})=>{oc[t]&&n.onConfigChange({name:"tools",value:r.target})})),n.onChildAdd(e)},setup:(e,t)=>((e=Ut.merge({},n.toolDefaults["*"],n.toolDefaults[t],e)).parent=n,e.ref=t,e)}));if(r.update(e),!t)return r.target}get widgetClass(){}};const cc=["b-hbox","b-vbox"],dc={name:"align",style:"alignItems"},uc={name:"contentAlign",style:"alignContent"},hc={name:"direction",style:"flexDirection"},gc={name:"justify",style:"justifyContent",classes:["stretch"]},mc={name:"wrap",style:"flexWrap",map:{false:"nowrap",true:"wrap",reverse:"wrap-reverse"}};class pc extends ol{static $name="Box";static type="box";static alias="hbox";static configurable={containerCls:"b-box-container",itemCls:"b-box-item",align:null,contentAlign:null,direction:null,horizontal:!0,justify:null,reverse:null,wrap:null};get vertical(){return!1===this.horizontal}set vertical(e){return this.horizontal=!e}updateAlign(){this.syncConfigStyle(dc)}updateContentAlign(){this.syncConfigStyle(uc)}updateDirection(){this.syncConfigStyle(hc)}updateHorizontal(){var e;const t=this,n=null===(e=t.contentElement)||void 0===e?void 0:e.classList,r=Number(t.vertical);n?(n.remove(cc[1-r]),n.add(cc[r])):t.syncConfigLater("horizontal"),t.syncDirection()}updateJustify(){this.syncConfigStyle(gc)}updateReverse(){this.syncDirection()}updateWrap(){this.syncConfigStyle(mc)}syncDirection(){const e=this,{reverse:t}=e;e.direction=t?`${e.vertical?"column":"row"}${t?"-reverse":""}`:null}}pc.initClass(),pc._$name="Box";class fc extends pc{static $name="VBox";static type="vbox";static configurable={horizontal:!1}}fc.initClass(),fc._$name="VBox";var vc=e=>class extends(e||ue){static $name="Badge";static get configurable(){return{badge:null}}compose(){const{badge:e}=this;return{dataset:{badge:e},class:{"b-badge":null!=e&&""!==e}}}};const yc=/(?:^|\s)b-icon-/,bc=/(?:^|\s)b-fa-/,Cc=Symbol("defaultToggleable"),Sc=["items","type","widgets","html","listeners"],wc=Symbol("defaultListener");class Dc extends(il.mixin(vc,Pl)){static $name="Button";static type="button";static get configurable(){return{icon:null,menuIcon:"b-icon-picker",pressedIcon:null,iconAlign:"start",behaviorType:"button",text:{value:null,$config:null,default:""},color:null,toggleable:Cc,pressed:!1,toggleGroup:null,supportsPressedClick:!1,ripple:{radius:75},forwardTwinEvents:["action","toggle"],localizableProperties:["text"],menu:{$config:["lazy","nullify"],value:null},menuDefaults:{type:"menu",autoShow:!1,autoClose:!0,floating:!0,scrollAction:"realign",align:"t0-b0"},href:null,target:null,defaultBindProperty:null}}updateElement(e,t){var n,r,s;const i=this,{constructor:a}=i,o=super.updateElement(e,t),l=i.peekConfig("menu"),c=!!l&&(l.isWidget?l.role:(null===(n=a.resolveType(l.type))||void 0===n||null===(r=n.configurable)||void 0===r?void 0:r.role)||(null===(s=a.configurable.menuDefaults)||void 0===s?void 0:s.type)||"menu");return i.ariaHasPopup=c,o}compose(){const{color:e,href:t,icon:n,iconAlign:r,pressed:s,pressedIcon:i,target:a,text:o,toggleable:l,toggleGroup:c,menuIcon:d,behaviorType:u}=this,h=this.hasConfig("menu"),g=s&&i?i:n;return{tag:t?"a":"button",href:t,target:a,type:u,class:{[`b-icon-align-${r}`]:n,[e]:Boolean(e),"b-pressed":s&&l,"b-text":Boolean(o),"b-has-menu":h},[l&&!h?"aria-pressed":""]:s,dataset:{group:c},listeners:{click:"onInternalClick",mousedown:"onInternalMousedown"},children:{iconElement:(n||i)&&{"aria-hidden":!0,tag:"i",class:{...Sn.normalize(g,"object"),"b-icon":yc.test(g),"b-fa":bc.test(g)}},label:o&&{tag:"label",for:this.id,text:o},menuIconElement:h&&d&&{tag:"i",class:{"b-icon":yc.test(d),"b-fa":bc.test(d),"b-button-menu-icon":1,[d]:1}}}}}configureOverflowTwin(e){const t=this,n=super.configureOverflowTwin(e);return n.text||(n.text=t.text||t.tooltipText),n}onHide(){var e;null===(e=this._menu)||void 0===e||e.hide()}get childItems(){return this._menu&&[this.menu]}onFocusOut(e){var t;super.onFocusOut(e),null===(t=this.menu)||void 0===t||t.hide()}get focusElement(){return this.element}changeText(e){return null==e?"":e}changeToggleable(e){return e===Cc?this.toggleGroup||this.config.menu:e}changeMenu(e,t){const n=this,{element:r}=n;return e?(e.isWidget?(e.forElement=r,e.owner=n,e.constrainTo=n.rootElement):("object"!=typeof e||Sc.some((t=>t in e))||(e={lazyItems:e}),e=il.reconfigure(t,e?Ut.merge({owner:n,constrainTo:n.rootElement,forElement:r},n.menuDefaults,e):null,n)),e.align.constrainPadding=10,n.detachListeners(wc),e.ion({name:wc,beforeShow:"onMenuBeforeShow",hide:"onMenuHide",show:"onMenuShow",thisObj:this})):null==t||t.destroy(),e}onMenuBeforeShow({source:e}){return this.trigger("beforeShowMenu",{menu:e})}onMenuShow(){this.ariaElement.setAttribute("aria-expanded",!0)}onMenuHide(){this.ariaElement.setAttribute("aria-expanded",!1),this.toggle(!1)}updateMenu(e){this.toggleable=Boolean(e)}updatePressed(e){const t=this;if(!t.toggleable||t.isConfiguring)return;const{menu:n}=t;e&&yr.forEachSelector(t.rootElement,`button[data-group=${t.toggleGroup}]`,(e=>{e!==t.element&&(il.getById(e.id).pressed=!1)})),n&&(n.initialConfig.minWidth||(n.minWidth=t.width),n.align.minHeight=n._minHeight??100,n.align.minWidth=n._minWidth??100,n[e?"show":"hide"]()),t.trigger("toggle",{pressed:e,userAction:t._isUserAction})}onInternalMousedown(e){var t;null!==(t=this._menu)&&void 0!==t&&t.containsFocus&&this.pressed&&e.preventDefault()}onInternalClick(e){const t=this,n={event:e};if(!t.disabled){if(t._isUserAction=!0,t.toggleable){if(t.toggleGroup&&t.pressed&&!t.supportsPressedClick)return;if(t.toggleGroup&&t.pressed||t.toggle(!t.pressed),t.isDestroyed)return}t.trigger("click",n),t.isDestroyed||t.trigger("action",n),t.href||(e.preventDefault(),e.stopPropagation()),t._isUserAction=!1}}toggle(e=!this.pressed){!1!==this.trigger("beforeToggle",{pressed:e,userAction:this._isUserAction})&&(this.pressed=e)}}Dc.initClass(),Dc._$name="Button";const Tc={refs:"element"},Ec=e=>e.element.style.margin="",xc=e=>e.isToolbar,kc=e=>e[0]+(e[1].minifiable?0:9e9),Ic={hidden:!1,width:""},Rc={...Ic,flex:""},Mc=[{box:"hbox",clientSizeProp:"clientWidth",edgeProp:"right",flexDir:"row",horizontal:!0,max:"maxX",overflow:"overflowX",pos:"x",scrollSize:"scrollWidth",sizeProp:"width"},{box:"vbox",clientSizeProp:"clientHeight",edgeProp:"bottom",flexDir:"column",horizontal:!1,max:"maxY",overflow:"overflowY",pos:"y",scrollSize:"scrollHeight",sizeProp:"height"}],Oc={delay:0,startRate:40,endRate:200,accelerateDuration:500},Ac={menu:1,pressed:1};class Fc extends(yl.mixin(lc)){static $name="Toolbar";static type="toolbar";static get delayable(){return{syncOverflowVisibility:{type:"raf",cancelOutstanding:!0}}}static get configurable(){return{defaultType:"button",dock:"top",layout:{type:"box"},overflow:{$config:["lazy","nullify"],value:{type:"menu"}},toolDefaults:{overflowMenuButton:{type:"button",hidden:!0,icon:"b-icon-menu",menuIcon:null,ariaLabel:"Show overflowing items",defaultCls:{"b-overflow-button":1}},overflowScrollEnd:{handler:"up.onEndScrollClick",hidden:!0,defaultCls:{"b-icon-angle-right":1,"b-overflow-button":1,"b-icon":1}},overflowScrollStart:{align:"start",handler:"up.onStartScrollClick",hidden:!0,defaultCls:{"b-icon-angle-left":1,"b-overflow-button":1,"b-icon":1}}},widgetCls:null,ignoreParentReadOnly:!0}}static get prototypeProperties(){return{flexRowCls:"b-hbox",flexColCls:"b-vbox"}}static getEvictionList(e){const t=e.filter((e=>"none"!==e.overflowable));return t.forEach(((e,n)=>t[n]=[n,e])),t.sort(((e,t)=>kc(t)-kc(e))),t}compose(){const e=this,{axisProps:t,dock:n}=e,r=e.getEndTools(Tc),s=e.getStartTools(Tc);return{class:{[`b-dock-${n}`]:1,[`b-${n}-toolbar`]:1,[`b-${t.box}`]:1},children:{...s,toolbarContent:{class:{"b-box-center":1,"b-toolbar-content":1}},...r}}}get axisProps(){return Mc[this.layout.horizontal?0:1]}get contentElement(){return this.toolbarContent}get overflowMenuButton(){var e;return null===(e=this.tools)||void 0===e?void 0:e.overflowMenuButton}get overflowType(){const{overflow:e}=this;return"string"==typeof e?e:null==e?void 0:e.type}onChildAdd(e){var t;super.onChildAdd(e),this.processAddedLeafItem(e),null===(t=e.syncRotationToDock)||void 0===t||t.call(e,this.dock)}onChildRemove(e){super.onChildRemove(e),this.syncOverflowVisibility()}processAddedLeafItem(e){Ce.after(e,"onConfigChange",this.onLeafItemConfigChange,e),e.isContainer&&e.eachWidget((e=>this.processAddedLeafItem(e)))}onInternalPaint({firstPaint:e}){var t;null===(t=super.onInternalPaint)||void 0===t||t.call(this,...arguments),e&&this.getConfig("overflow")}updateDock(e){const t=this,{layout:n}=t,{vertical:r}=n;if(n.vertical=Fl(e)[1],!t.initialItems){r!==n.vertical&&t.updateOverflow(t.overflow);for(const n of t.childItems){var s;null===(s=n.syncRotationToDock)||void 0===s||s.call(n,e)}}}updateOverflow(e,t){var n;const r=this,{axisProps:s,contentElement:i,overflowType:a}=r,{flexDir:o}=s,l=null===(n=r.overflowMenuButton)||void 0===n?void 0:n._menu,c={};var d;if(l&&(e?null==l||l.removeAll():l.eachWidget((e=>{e._overflowTwinOrigin.overflowTwin=null}))),"menu"===t?c.overflowMenuButton=null:"scroll"===t&&(c.overflowScrollStart=c.overflowScrollEnd=null),"menu"===a)null===(d=r.scrollable)||void 0===d||d.destroy(),i.style.overflow=i.style.overflowX=i.style.overflowY="",c.overflowMenuButton={cls:{[`b-${o}-menu`]:1}};else if("scroll"===a){const t="object"==typeof e&&(null==e?void 0:e.repeat)||Oc;r.scrollable={[s.overflow]:"hidden-scroll",element:i,internalListeners:{scroll:"onContentScroll",thisObj:r}},c.overflowScrollStart={repeat:t,invertRotate:!0,cls:{[`b-${o}-start-scroller`]:1}},c.overflowScrollEnd={repeat:t,invertRotate:!0,cls:{[`b-${o}-end-scroller`]:1}}}r.tools=c,a?(i.classList.add("b-overflow"),r.monitorResize=!0,r.syncOverflowVisibility()):(i.classList.remove("b-overflow"),r.monitorResize=!1)}onContentScroll(){this.syncScrollerState()}onStartScrollClick(){this.scrollable[this.axisProps.pos]-=2}onEndScrollClick(){this.scrollable[this.axisProps.pos]+=2}onInternalResize(){super.onInternalResize(...arguments),this.isPainted&&this.syncOverflowVisibility()}syncOverflowVisibility(){const e=this,{overflowType:t,contentElement:n,isVisible:r}=e,{clientSizeProp:s,edgeProp:i,sizeProp:a}=e.axisProps,{overflowMenuButton:o,overflowScrollStart:l,overflowScrollEnd:c}=e.tools,d=e.rtl&&e.layout.horizontal,u="menu"===t,h=()=>Math.ceil(n[s]+(!l||l.hidden?0:l.rectangle("outer")[a])+(!c||c.hidden?0:c.rectangle("outer")[a])),g=()=>{if(0===E.length)return 0;const e=E[E.length-1].rectangle(n);return Math.floor(d?n[s]-e.left:e[i])};let m,p,f,v,y,b,C,S,w,D,T,E;if(r&&t&&0!==e.items.length){if(e.inSyncOverflowVisibility=!0,null==o||o.hide(),e.eachWidget(((e,t)=>{C=e.minifiable,D=e.overflowable,D=C?D||C:D,e.floating?t.down=!1:(t.down=!D,e.innerItem&&(e._toolbarOverflow&&(e.hidden=e._toolbarOverflow=!1),e._toolbarMinified&&(e.minified=e._toolbarMinified=!1),e.isVisible&&(C&&(S||(S=[])).push(e),D&&(E||(E=[])).push(e))))})),E&&(m=h(),p=g()),E&&p>m)if(u){for(;p>m&&(y=null===(x=S)||void 0===x?void 0:x.pop());){var x;b=p,y._toolbarMinified=!0,y.minified=!0,p=g(),b-=p,(w||(w=[])).push([y,b])}if(p>m){for(f of(o.show(),m=h(),v=Fc.getEvictionList(E),v))p>m&&(y=f[1],y._toolbarOverflowWidth=y.width,y._toolbarOverflow=!0,y.hidden=!0,E.splice(E.indexOf(y),1),(T||(T=[])).push(f),p=g());if(T){for(T.sort(((e,t)=>e[0]-t[0])).forEach(((e,t)=>T[t]=e[1]));null!==(k=w)&&void 0!==k&&k.length;){var k;[y,b]=w.pop(),p+b<=m&&!y._toolbarOverflow&&(p+=b,y.minified=y._toolbarMinified=!1)}e.syncOverflowMenuButton(T)}else o.hide()}}else c.show(),l.show(),e.syncScrollerState();else u||(null==c||c.hide(),null==l||l.hide());e.inSyncOverflowVisibility=!1}}syncOverflowMenuButton(e){var t;const n=this,{axisProps:r,overflowMenuButton:s}=n,i={cls:"b-toolbar-overflow-menu",minWidth:280,items:[],align:{align:r.horizontal?"t100-b100":"r100-l100",axisLock:"flexible"}};if(n.addToMenu(i,e.filter((e=>n.overflowItemFilter(e)))),null!==(t=s._menu)&&void 0!==t&&t.isMenu){const e=s.menu,{toAdd:t,toRemove:n}=ge.delta(i.items,e.items,1);if(e.remove(n),e.items.length)for(let n=t.length-1;n>=0;n--)e.insert(t[n],0);else e.add(t)}else s.menu=i}syncScrollerState(){const{axisProps:e,scrollable:t}=this,{overflowScrollStart:n,overflowScrollEnd:r}=this.tools,s=t[e.pos],i=t[e.max];n.disabled=!s,r.disabled=Math.abs(Math.ceil(s))>=Math.abs(i)}overflowItemFilter(e){const{filter:t}=this.overflow;return Boolean(t?t.call(this,e):yr.getChildElementCount(e.element))}addToMenu(e,t){const n=this.horizontal?Rc:Ic;for(const r of t){const t=r.ensureOverflowTwin(n,Ec);e.items.push(t)}}onLeafItemConfigChange(e,{name:t,value:n}){const r=this,s=r.up(xc),i=s.hasConfig("overflow"),{overflowTwin:a}=r;!i||null!=s&&s.inSyncOverflowVisibility||"hidden"===t&&n===r._toolbarOverflow||(a&&!Ac[t]&&(a[t]=n),null!=s&&s.isPainted&&"overflowMenuButton"!==r.ref&&(r.isTextField&&"value"===t&&(r.containsFocus||null!=a&&a.containsFocus)||s.syncOverflowVisibility()))}createWidget(e){"->"===e?e={type:"widget",cls:"b-toolbar-fill"}:"|"===e?e={type:"widget",cls:"b-toolbar-separator"}:"string"==typeof e&&(e={type:"widget",cls:"b-toolbar-text",html:e});const t=super.createWidget(e);return this.widgetCls&&t.element.classList.add(this.widgetCls),t}}Fc.initClass(),Fc._$name="Toolbar";const Pc=e=>!e.classList.contains("b-focus-trap")&&yr.isFocusable(e)?yr.NodeFilter.FILTER_ACCEPT:yr.NodeFilter.FILTER_SKIP,Lc=[],$c={},_c=[Lc,Lc],Nc=(e,t,n)=>{const{vertical:r}=e;return delete e.vertical,{...e,class:{...t,[`b-${r?"v":"h"}box`]:1,"b-box-center":1,"b-panel-bar-wrap":!n}}},jc=(e,t,n=!1)=>{const r={vertical:n,children:e?[e]:[]};return t&&(r.tag=t),r},Vc=(e,t)=>{null!=e&&e.classList?null==e||e.classList.add(t):null!=e&&e.class&&("string"==typeof e.class&&(e.class={[e.class]:1}),e.class[t]=1)},Bc={dock:1,hidden:1,weight:1},zc={top:[!0,!0],bottom:[!0,!1],left:[!1,!0],right:[!1,!1]},Wc={header:1,"pre-header":1};class Hc extends(yl.mixin(es,lc)){static $name="Panel";static type="panel";static get configurable(){return{localizableProperties:["title"],collapsed:{value:null,$config:null,default:!1},collapsible:{value:null,$config:"nullify"},bodyCls:{$config:{merge:"classList"},value:null},bodyTag:null,bodyWrapTag:null,trapFocus:null,title:null,header:null,stateful:["collapsed"],stripDefaults:{"*":{type:"toolbar",dock:"top"},bbar:{dock:"bottom",weight:-1e3},tbar:{weight:-1e3}},strips:{value:null,$config:"nullify"},toolDefaults:{close:{weight:-1e3},collapse:{weight:-990}},footer:null,revealed:null,tbar:null,bbar:null,role:"region"}}updateElement(e,t){const n=super.updateElement(e,t);return this.titleElement&&yr.setAttributes(this.ariaElement,{"aria-describedby":this.titleElement.id}),n}compose(){const e=this,{collapsible:t,focusable:n,hasItems:r,revealed:s,tools:i}=e,a=e.composeHeader(),o=(null==a?void 0:a.class["b-dock-left"])||(null==a?void 0:a.class["b-dock-right"]);let l=e.composeBody(),c="bodyWrapElement";return t&&([c,l]=t.wrapCollapser(c,l)),{tabIndex:r&&!1!==n||n?0:null,class:{[`b-panel-collapsible-${null==t?void 0:t.type}`]:t,[`b-panel-collapse-${null==t?void 0:t.collapseDir}`]:t,[`b-${o?"h":"v"}box`]:1,"b-panel-collapsible":t,"b-panel-has-header":a,"b-panel-has-tools":i?1:0,"b-panel-overlay-revealed":s},children:{topFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1}},headerElement:a,[c]:l,bottomFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1,"b-end-focus-trap":1}}}}}composeBody(){var e,t;const n=this,{bodyCls:r,bodyConfig:s,bodyWrapTag:i,footer:a,uiClassList:o}=n,l=Ut.values(n.strips,((e,t)=>!zc[null==t?void 0:t.dock])).sort(n.byWeightSortFn),c={top:null,right:null,bottom:null,left:null};let d,u,h,g,m,p,f;for(a&&(h=a.dock||"bottom",l.unshift({dock:h,element:{tag:"footer",reference:"footerElement",html:"string"==typeof a?a:a.html,class:{...o,[`b-dock-${h}`]:1,[`${a.cls||""}`]:1}}})),r&&(s[m="className"]||(m="class"),s[m]=new Sn(s[m]).assign(r)),g=l.length;g-- >0;)d=l[g],[p,u]=zc[d.dock],f?f.vertical!==p&&(f=jc(Nc(f,o),"",p)):f=jc(s,i,p),f.children[u?"unshift":"push"](d.element),c[d.dock]=d;Vc(c.top,"b-innermost"),Vc(c.right,"b-innermost"),Vc(c.bottom,"b-innermost"),Vc(c.left,"b-innermost");const v=Nc(f||jc(s,i),o,!0);return v.class[`${null===(e=n.layout)||void 0===e?void 0:e.containerCls}-panel`]=Boolean(null===(t=n.layout)||void 0===t?void 0:t.containerCls),v.class["b-panel-body-wrap"]=1,v.class[`b-${n.$$name.toLowerCase()}-body-wrap`]=1,v}get hasHeader(){if(!1===this.header)return!1;const{header:e,title:t,tools:n,parent:r}=this,s=this.maximizable||Object.values(n||{}).some((e=>!e.hidden));return e||!(null!=r&&r.suppressChildHeaders)&&(t||s)}get rootUiClass(){return Hc}composeHeader(e){var t;const n=this;if(!n.hasHeader&&!e)return;const r=n.header||{},s=r.dock||"top",[i,a]=n.splitHeaderItems({as:"element",dock:s}),o=n.$meta.hierarchy,l=n.composeTitle(r),c=new Sn({[`b-dock-${s}`]:1,...n.uiClassList},r.cls);let d,u;for(d=o.indexOf(Hc);d<o.length;++d)u=o[d].$$name,"Grid"!==u&&(c[`b-${u.toLowerCase()}-header`]=1);const h={tag:"header",class:c,children:[...i,l,...a]};return(null===(t=n.collapsible)||void 0===t?void 0:t.composeHeader(h))||h}composeTitle(e){var t;const n="string"==typeof e?e:this.title||e.title,r={reference:"titleElement",id:`${this.id}-panel-title`,html:n??"",class:{[`b-align-${e.titleAlign||"start"}`]:1,"b-header-title":1,...this.uiClassList}};return Ut.isObject(n)&&(delete r.html,Ut.merge(r,n)),(null===(t=this.collapsible)||void 0===t?void 0:t.composeTitle(r))||r}updateTitle(){}afterRecompose(){var e;super.afterRecompose();const t=this,{headerElement:n}=t;null===(e=t._headerClickDetacher)||void 0===e||e.call(t),t._headerClickDetacher=n&&Mn.on({element:n,click:e=>{var n;return null===(n=t.trigger)||void 0===n?void 0:n.call(t,"headerClick",{event:e})}})}onHeaderClick(e){var t;null===(t=this.collapsible)||void 0===t||t.onHeaderClick(e)}onInternalPaint(){var e;super.onInternalPaint(...arguments),null===(e=this.collapsible)||void 0===e||e.onPanelPaint(this)}splitHeaderItems({as:e,dock:t,alt:n}=$c){const r=this,s="element"===e,{collapsed:i}=r,a=r.getEndTools({alt:n}),o=r.getStartTools({alt:n}),l=Ut.values(r.strips,((e,t)=>!Wc[null==t?void 0:t.dock]&&t.isCollapsified({collapsed:i,alt:n})));let c,d,u,h=_c;if(l.length+a.length+o.length){for(h=[d=[...o,...l.filter((e=>"pre-header"===e.dock)).sort(r.byWeightSortFn)],c=[...l.filter((e=>"header"===e.dock)).sort(r.byWeightReverseSortFn),...a]],u=0;u<d.length;++u){var g,m;t&&(null===(g=(m=d[u]).syncRotationToDock)||void 0===g||g.call(m,t)),s&&(d[u]=d[u].element)}for(u=0;u<c.length;++u){var p,f;t&&(null===(p=(f=c[u]).syncRotationToDock)||void 0===p||p.call(f,t)),s&&(c[u]=c[u].element)}}return h}set bodyConfig(e){this._bodyConfig=e}get bodyConfig(){const e=this,{bodyTag:t}=e,n=Ut.merge({reference:"bodyElement",className:{...e.getStaticWidgetClasses(Hc,"-content"),"b-box-center":1,"b-text-content":e.textContent&&e.hasNoChildren}},e._bodyConfig);return t&&(n.tag=t),!e.initializingElement&&e._element||(n.html=e.content||e._html),n}changeBodyCls(e){return Sn.from(e)}changeTbar(e){return this.getConfig("strips"),this.strips={tbar:e},this.strips.tbar}changeBbar(e){return this.getConfig("strips"),this.strips={bbar:e},this.strips.bbar}get childItems(){var e;const t=this,n=Ut.values(t.strips,((e,t)=>!zc[null==t?void 0:t.dock])).sort(t.byWeightSortFn),[r,s]=t.splitHeaderItems(),[i,a]=(null===(e=t.collapsible)||void 0===e?void 0:e.splitHeaderItems())||_c;return[...r,...i,...s,...a,...n.filter((e=>zc[e.dock][1])),...t._items||Lc,...n.filter((e=>!zc[e.dock][1])).reverse()]}changeStrips(e,t){const n=this,r=n.$strips||(n.$strips=new sc({configName:"strips",factory:il,inferType:!1,owner:n,created(e){var t;const{dock:s}=e;if(!Wc[s]&&!zc[s])throw new Error(`Invalid dock value "${s}"; must be: top, left, right, bottom, header, or pre-header`);Ce.after(e,"onConfigChange",((e,{name:t})=>{Bc[t]&&n.onConfigChange({name:"strips",value:r.target})})),e.innerItem=!1,n.onChildAdd(e),e.parent=n,null===(t=e.layout)||void 0===t||t.renderChildren(),e.hasItems&&(n.hasItems=!0)},setup:(e,t)=>((e=Ut.merge(Ut.clone(n.stripDefaults["*"]),n.stripDefaults[t],e)).parent=n,e.ref=t,e),transform:e=>(Array.isArray(e)&&(e={items:e}),e||null)}));if(r.update(e),!t)return r.target}get collapsing(){var e;return null===(e=this.collapsible)||void 0===e?void 0:e.collapsing}get collapsingExpanding(){var e;return null===(e=this.collapsible)||void 0===e?void 0:e.collapsingExpanding}get expanding(){var e;return null===(e=this.collapsible)||void 0===e?void 0:e.expanding}changeCollapsed(e){const t=this,{collapsible:n}=t;if(t.recompose.flush(),e=Boolean(e),!n||t.changingCollapse||!t.isPainted)return e;null==n||n.collapse({animation:null,collapsed:e})}changeCollapsible(e,t){const n=this;return n.getConfig("tools"),e&&(!0===e?e={}:"string"==typeof e&&(e={[zc[e]?"direction":"type"]:e})),nc.reconfigure(t,e,{owner:n,defaults:{panel:n},cleanup(){n.collapsed&&(t.collapse({animation:null,collapsed:!1}),n._collapsed=1)}})}updateCollapsible(e){const t=this,n=null==e?void 0:e.toolsConfig;t.tools={collapse:(null==n?void 0:n.collapse)||null,recollapse:(null==n?void 0:n.recollapse)||null},e&&t.isPainted&&t.collapsed&&(t._collapsed=1),1===t.collapsed&&(t.collapsed=!0)}_collapse(e,t){var n;return!0!==t&&void 0!==t&&(!1===t?e.collapsed=!e.collapsed:"number"==typeof t?e.animation={duration:t}:null===t?e.animation=t:!0===t||("animation"in t?Ut.merge(e,t):e.animation=t)),null===(n=this.collapsible)||void 0===n?void 0:n.collapse(e)}collapse(e){return this._collapse({collapsed:!0},e)}expand(e){return this._collapse({collapsed:!1},e)}toggleCollapsed(e){return this.collapsed?this.expand(e):this.collapse(e)}get expandedHeaderDock(){var e;return this._expandedHeaderDock??(null===(e=this.initialConfig.header)||void 0===e?void 0:e.dock)??"top"}set expandedHeaderDock(e){this._expandedHeaderDock=null==e?void 0:e.toLowerCase()}updateHeader(e){this.changingCollapse||(this.expandedHeaderDock=null==e?void 0:e.dock)}updateTrapFocus(e){var t;const n=this;n.element.classList[e?"add":"remove"]("b-focus-trapped"),n.focusTrapListener=null===(t=n.focusTrapListener)||void 0===t?void 0:t.call(n),e&&(n.focusTrapListener=Mn.on({element:n.element,focusin:"onFocusTrapped",delegate:".b-focus-trap",thisObj:n}),n.treeWalker||(n.treeWalker=this.setupTreeWalker(n.element,yr.NodeFilter.SHOW_ELEMENT,Pc)))}setupTreeWalker(e,t,n){return document.createTreeWalker(e,t,n)}onFocusTrapped(e){const t=this,n=t.treeWalker;if(e.target===t.bottomFocusTrap)n.currentNode=t.topFocusTrap,n.nextNode();else{if(e.target!==t.topFocusTrap)return;n.currentNode=t.bottomFocusTrap,n.previousNode()}t.requestAnimationFrame((()=>n.currentNode.focus()))}get focusElement(){return this.hasItems&&(super.focusElement||this.element)}get contentElement(){return this.element&&this.bodyElement}get widgetClassList(){const e=this,t=super.widgetClassList;var n;e.hasHeader&&t.push("b-panel-has-header",`b-header-dock-${(null===(n=e.header)||void 0===n?void 0:n.dock)||"top"}`);return e.tbar&&t.push("b-panel-has-top-toolbar"),e.bbar&&t.push("b-panel-has-bottom-toolbar"),t}}Hc.initClass(),Hc._$name="Panel";class Uc extends Hc{static $name="Popup";static type="popup";static get configurable(){return{autoShow:!0,autoClose:!0,showOnClick:!1,forElement:null,monitorResize:!0,floating:!0,hidden:!0,axisLock:!0,hideAnimation:{opacity:{from:1,to:0,duration:".3s",delay:"0s"}},showAnimation:{opacity:{from:0,to:1,duration:".4s",delay:"0s"}},stripDefaults:{bbar:{layout:{justify:"flex-end"}}},testConfig:{hideAnimation:null,showAnimation:null},closeAction:"hide",trapFocus:!0,focusOnToFront:!0,closable:null,maximizable:null,modal:null,maximized:null,tools:{close:{cls:"b-popup-close",handler:"close",weight:-1e3,ariaLabel:"L{Popup.close}",hidden:!0},maximize:{cls:"b-popup-expand",handler:"toggleMaximized",weight:-999,hidden:!0}},highlightReturnedFocus:!0,role:"dialog"}}finalizeInit(){const e=this,{forElement:t}=e;e.anchoredTo=t,e.initialAnchor=e.anchor,t&&e.showOnClick&&(e.initialConfig.autoShow||(e.autoShow=!1),Mn.on({element:t,click:"onElementUserAction",thisObj:e})),super.finalizeInit(),!e.autoShow||t&&!yr.isVisible(t)||(!0===e.autoShow?e.show():e.setTimeout((()=>e.show()),e.autoShow))}onInternalPaint({firstPaint:e}){var t;null===(t=super.onInternalPaint)||void 0===t||t.call(this,...arguments);const n=this;e&&n.headerElement&&Mn.on({element:n.headerElement,dblclick:n.onHeaderDblClick,thisObj:n})}doDestroy(){this.syncModalMask(),super.doDestroy()}compose(){const{hasNoChildren:e,textContent:t}=this;return{class:{"b-text-popup":Boolean(t&&e)}}}close(){const e=this;if(!e._hidden&&!1!==e.trigger("beforeClose")||e._hidden&&"destroy"===e.closeAction)return e.modal&&"destroy"===e.closeAction&&e.revertFocus(),e.unmask(),e.containsFocus&&e.highlightReturnedFocus&&e.setTimeout((()=>e.element.classList.add("b-using-keyboard")),0),e[e.closeAction]()}toggleMaximized(){this.maximized=!this.maximized}updateMaximized(e){yr.toggleClasses(this.element,["b-maximized"],e)}onInternalKeyDown(e){const t=this;"Escape"===e.key&&(e.stopImmediatePropagation(),t.floating||t.positioned?t.close(!0):t.collapsible&&(t.revealed?t.collapsible.toggleReveal():t.collapse()))}onDocumentMouseDown({event:e}){const t=this,{owner:n}=t,{target:r}=e;if("touchend"!==e.type&&null!=n&&n.isButton&&n._menu===t&&n.element.contains(r))return e.preventDefault(),!1;t.modal&&r===Uc.modalMask?(e.preventDefault(),t.modal.closeOnMaskTap?t.close():t.containsFocus||t.focus()):t.owns(r)||!t.autoClose||t.containsFocus||t.close()}get isTopModal(){return yr.isVisible(Uc.modalMask)&&this.element.previousElementSibling===Uc.modalMask}onFocusIn(e){const t=yr.getActiveElement(this);super.onFocusIn(e),yr.getActiveElement(this)===t&&e.target===this.element&&this.focus()}onFocusOut(e){globalThis.visualViewport&&globalThis.visualViewport.height<document.documentElement.clientHeight-1||this.modal||!this.autoClose||this.close(),super.onFocusOut(e)}onShow(){var e;const t=this;(t.autoClose||t.modal)&&t.addDocumentMouseDownListener(),t.focusOnToFront&&t.focus(),null===(e=super.onShow)||void 0===e||e.call(this),t.syncModalMask()}addDocumentMouseDownListener(){this.mouseDownRemover||(this.mouseDownRemover=xr.ion({globaltap:"onDocumentMouseDown",thisObj:this}))}updateModal(e){e&&(this.floating=!0)}syncModalMask(){const e=this,{modal:t,element:n}=e;if(n.setAttribute("aria-modal",Boolean(t)),t&&e.isVisible)"number"!=typeof e._x&&"number"!=typeof e._y&&(e.centered=!0,e.anchor=!1),e.modalMask.classList.remove("b-hide-display"),e.modalMask.classList.toggle("b-modal-transparent",Boolean(t.transparent)),n.classList.add("b-modal");else if(e.isPainted){n.classList.remove("b-modal");const t=e.floatRoot.querySelectorAll(".b-modal"),r=t.length?Uc.fromElement(t[t.length-1],"popup"):null;r?r.syncModalMask():Uc.modalMask.classList.add("b-hide-display")}}onHide(){var e,t;const n=this;null===(e=n.mouseDownRemover)||void 0===e||e.call(n),n.mouseDownRemover=null,null===(t=super.onHide)||void 0===t||t.call(this),n.syncModalMask()}onElementUserAction(){this.show()}onHeaderDblClick(){this.maximizable&&this.toggleMaximized()}updateClosable(e){this.tools.close.hidden=!e}updateMaximizable(e){this.tools.maximize.hidden=!e}get modalMask(){const{modalMask:e}=Uc;return e.nextElementSibling!==this.element&&this.floatRoot.insertBefore(e,this.element),e}static get modalMask(){return this._modalMask||(this._modalMask=yr.createElement({className:"b-modal-mask b-hide-display"}),Mn.on({element:this._modalMask,wheel:e=>e.preventDefault()})),this._modalMask}}Uc.initClass(),Uc._$name="Popup";const Yc=/^b-icon-/,qc=/^b-fa-/;class Kc extends il{static $name="MenuItem";static type="menuitem";static get configurable(){return{checked:null,separator:null,toggleGroup:null,menu:{value:null,$config:["lazy","nullify"]},icon:null,closeParent:null,href:null,target:null,localizableProperties:["text"],role:"menuitem",closeMenuDelay:200}}updateElement(e,t){const n=super.updateElement(e,t);return"boolean"==typeof this.checked&&(this.role="menuitemcheckbox"),this.ariaHasPopup=!!this.hasMenu&&"menu",n}compose(){var e;const t=this,{checked:n,href:r,hasMenu:s,separator:i,target:a,text:o,toggleGroup:l}=t,c="boolean"==typeof n,d=t.icon||(c?"b-fw-icon":""),u="b-icon-"+(l?"radio-":""),h="object"==typeof o;return{tag:r?"a":"div",tabIndex:-1,href:r,target:a,class:{"b-has-submenu":s,"b-checked":n,"b-separator":i||(null===(e=t.cls)||void 0===e?void 0:e["b-separator"])},dataset:{group:t.toggleGroup},[c?"aria-checked":""]:n,[s?"aria-expanded":""]:!1,children:{iconElement:d&&{"aria-hidden":!0,tag:"i",class:{"b-fa":qc.test(d),"b-icon":Yc.test(d),"b-menuitem-icon":1,[`${u}checked`]:!0===n,[`${u}unchecked`]:!1===n,...Sn.normalize(d,"object")}},textElement:{tag:"span",html:h?null:o,class:{"b-menu-text":1,"b-menu-custom-content":h},children:h?[o]:null},subMenuIcon:s&&{"aria-hidden":!0,tag:"i",class:{"b-fw-icon":1,"b-icon-sub-menu":1}}}}}doAction(e){const t=this,n=this.parent,r={menu:n,item:t,element:t.element,bubbles:!0,domEvent:e};if("boolean"==typeof t.checked){const e=!t.checked;t.toggleGroup&&!e||(t.checked=!t.checked)}else t.href&&e.key&&t.element.click();t.trigger("beforeItem",r),t.trigger("item",r),t.closeParent&&n&&(n.rootMenu.close(),e&&!t.href&&e.preventDefault())}get focusElement(){return this.element}get contentElement(){return this.textElement}get isFocusable(){const{focusElement:e}=this;return e&&this.isVisible&&(e===document.body||e.offsetParent)}get hasMenu(){return this.hasConfig("menu")}get childItems(){const{_menu:e}=this;return e?[e]:[]}get text(){return this.html}set text(e){this.html=e}onFocusIn(e){super.onFocusIn(e),!this.disabled&&this.menu&&this.delay("openMenu",200)}onFocusOut(e){this.clearTimeout("openMenu"),super.onFocusOut(e),this._menu&&(this.menu.closeTimer=this.menu.setTimeout((()=>this.closeMenu()),this.closeMenuDelay))}openMenu(e){const{menu:t}=this;!this.disabled&&t&&(t.focusOnToFront=e,t.show())}onChildShow(e){super.onChildShow(e),this.ariaElement.setAttribute("aria-expanded",!0)}closeMenu(){this._menu instanceof il&&this.menu.close()}onChildHide(e){super.onChildHide(e),this.ariaElement.setAttribute("aria-expanded",!1)}changeToggleGroup(e){return e&&"boolean"!=typeof this.checked&&(this.checked=!1),e}changeChecked(e,t){if(this.isConfiguring||"boolean"==typeof t)return Boolean(e)}updateChecked(e){const t=this;t.isConfiguring||(t.toggleGroup&&t.uncheckToggleGroupMembers(),t.element.setAttribute("aria-checked",e),t.trigger("toggle",{menu:t.owner,item:t,element:t.element,bubbles:!0,checked:e}))}getToggleGroupMembers(){const e=this,{checked:t,toggleGroup:n,element:r}=e,s=[];return t&&n&&yr.forEachSelector(e.rootElement,`[data-group=${n}]`,(e=>{if(e!==r){const t=il.fromElement(e);t&&s.push(t)}})),s}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach((e=>e.checked=!1))}get closeParent(){return("boolean"==typeof this.checked?this._closeParent:!1!==this._closeParent)&&!this.hasMenu}changeMenu(e,t){const n=this,{constrainTo:r,scrollAction:s}=n.owner;return!e||"object"!=typeof e||"items"in e||"widgets"in e||"html"in e||(e={lazyItems:e}),Xc.reconfigure(t,e,{owner:n,defaults:{type:"menu",align:"s0-e0",anchor:!0,autoClose:!0,autoShow:!1,cls:"b-sub-menu",forElement:n.element,owner:n,ariaLabel:n.text,constrainTo:r,scrollAction:s}})}}Kc.initClass(),Kc._$name="MenuItem";const Gc={ArrowUp:1,ArrowDown:1,ArrowRight:1,ArrowLeft:1,Enter:1,Escape:1};class Xc extends Uc{static $name="Menu";static type="menu";static get configurable(){return{layout:"vbox",focusable:!0,align:"t-b",scrollAction:"hide",focusOnHover:null,scrollable:!1,defaultType:"menuitem",tools:{close:!1},role:"menu",ariaElement:"bodyElement"}}construct(e){Array.isArray(e)&&(e={lazyItems:e}),super.construct(e),Mn.on({element:this.element,click:"onMouseClick",mouseover:"onMouseOver",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",thisObj:this})}afterShow(){const{items:e,element:t}=this;e.some((e=>Boolean(e._menu)))&&t.classList.add("b-menu-with-submenu");e.some((e=>e.icon))&&t.classList.add("b-menu-with-icon"),super.afterShow(...arguments)}createWidget(e){return"string"==typeof e&&(e={text:e}),super.createWidget(e)}get focusElement(){var e;const t=this,n=null===(e=t.parentMenu)||void 0===e?void 0:e.element.contains(yr.getActiveElement(t.parentMenu)),r=t.items[0];return!n&&!yr.usingKeyboard&&r instanceof Kc?t.element:super.focusElement}onDocumentMouseDown({event:e}){if(!this.parentMenu||!this.parentMenu.owns(e.target))return super.onDocumentMouseDown(...arguments)}hide(e){const t=this;var n,r;(super.hide(e),t.isVisible)||(null===(n=t.currentSubMenu)||void 0===n||null===(r=n.hide)||void 0===r||r.call(n,e),t.parentMenu&&(t.parentMenu.currentSubMenu=null))}show(){super.show(...arguments);const{parentMenu:e}=this;this.isVisible&&e&&(e.currentSubMenu=this)}onMouseClick(e){const t=e.target.closest(".b-menuitem");t&&this.triggerElement(t,e)}onMouseOver(e){if(!1!==this.focusOnHover){var t;const n=null===(t=e.relatedTarget)||void 0===t?void 0:t.closest(".b-widget"),r=e.target.closest(".b-widget"),s=il.fromElement(r);!yr.isTouchEvent&&r&&r!==n&&s.parent===this&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[s],cancelOutstanding:!0})}}handleMouseOver(e){e.focus()}onMouseEnter(){this.clearTimeout(this.closeTimer)}onMouseLeave(e){const t=this,{relatedTarget:n}=e,r=n&&t.owns(n);let s=n instanceof HTMLElement&&il.fromElement(n),i=!r;if(s){for(;s.ownerCmp;)s=s.ownerCmp;i&=!yr.getAncestor(s.element,[e.target])}!r&&i&&(t.currentSubMenu&&!t.currentSubMenu.closeTimer&&t.currentSubMenu.hide(),t.element.contains(yr.getActiveElement(t))&&yr.getActiveElement(t).matches(".b-menuitem")&&t.focusElement.focus())}onInternalKeyDown(e){const t=il.fromElement(e),n=t&&t!==this&&!(t instanceof Kc);if("Escape"===e.key)return void(n?this:this.rootMenu).close();if(super.onInternalKeyDown(e),n)return;Gc[e.key]&&e.preventDefault();const r=this.element,s=yr.getActiveElement(r);this.navigateFrom(s!==r&&r.contains(s)?s:null,e.key,e)}navigateFrom(e,t,n){const r=this,{treeWalker:s}=r,i=e&&r.getItem(e),a=r.rtl?"ArrowLeft":"ArrowRight",o=r.rtl?"ArrowRight":"ArrowLeft";let l;switch(t){case"ArrowUp":s.currentNode=e||(e=r.bottomFocusTrap),s.previousNode(),l=s.currentNode;break;case"ArrowDown":s.currentNode=e||(e=r.topFocusTrap),s.nextNode(),l=s.currentNode;break;case" ":e&&!e.classList.contains("b-disabled")&&(null!=i&&i.menu?r.openSubMenu(e,i):r.triggerElement(e,n));break;case a:if(e&&null!=i&&i.menu&&!e.classList.contains("b-disabled")){const t=r.openSubMenu(e,i);null==t||t.focus()}else s.currentNode=e||(e=r.topFocusTrap),s.nextNode(),l=s.currentNode;break;case o:r.isSubMenu?r.hide():e||(s.currentNode=e||(e=r.topFocusTrap),s.nextNode(),l=s.currentNode);break;case"Enter":e&&!e.classList.contains("b-disabled")&&r.triggerElement(e,n)}l&&(l===r.element?r.navigateFrom(r.bottomFocusTrap,"ArrowUp",n):l===e?r.navigateFrom(r.topFocusTrap,"ArrowDown",n):l.focus())}getItem(e){if(null!=e)return"number"==typeof e?this.items[e]:e.nodeType===Element.ELEMENT_NODE?il.fromElement(e,"menuitem",this.contentElement):this.items.find((t=>t.id==e))}triggerElement(e,t){const n=this.getItem(e);n&&!n.disabled&&n.doAction(t)}get isSubMenu(){var e;return this===(null===(e=this.owner)||void 0===e?void 0:e.menu)}openSubMenu(e,t){const n=this,r=t.menu;if(r){if(!r.isVisible){var s;const i={item:t,element:e};if(!1===n.trigger("beforeSubMenu",i))return;if(!1===(null===(s=t.onBeforeSubMenu)||void 0===s?void 0:s.call(t,i)))return;r.show()}return n.currentSubMenu=r}}set selectedElement(e){const t=this,n=t._selectedElement;if(n){const e=t.getItem(n),r=null==e?void 0:e.menu;null==r||r.hide(),n.classList.remove("b-active")}if(t._selectedElement=e,e){const n=yr.isFocusable(e);e.classList.add("b-active"),t.scrollable.scrollIntoView(e,{animate:!n,focus:n})}}get selectedElement(){return this._selectedElement}selectFirst(){const e=this.treeWalker;e.currentNode=this.topFocusTrap,e.nextNode(),this.requestAnimationFrame((()=>e.currentNode.focus()))}get parentMenu(){var e;const t=this.owner;return t&&(t.isMenu?t:null===(e=t.up)||void 0===e?void 0:e.call(t,"menu"))}get rootMenu(){let e=this;for(;e.parentMenu instanceof this.constructor;)e=e.parentMenu;return e}}let Zc;Xc.initClass(),Xc._$name="Menu";class Jc extends Nr{static get $name(){return"ContextMenuBase"}static get configurable(){return{type:null,menu:{$config:["lazy","nullify"],value:{type:"menu",autoShow:!1,closeAction:"hide",scrollAction:"hide",constrainTo:globalThis}},items:{},triggerEvent:!1,clickTriggerSelector:null,keyMap:{" ":{handler:"showContextMenuByKey",weight:100},"Ctrl+Space":"showContextMenuByKey"}}}static get pluginConfig(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick"]}}construct(...e){var t;if(super.construct(...e),null===(t=this.type)||void 0===t||!t.length)throw new Error("Config 'type' is required to be specified for context menu")}onElementContextMenu(e){this.onElementEvent(e)}onElementClick(e){this.onElementEvent(e)}onElementDblClick(e){this.onElementEvent(e)}onElementEvent(e){if(e.handled||this.triggerEvent!==e.type)"click"===e.type&&this.clickTriggerSelector&&e.target.matches(this.clickTriggerSelector)&&this.internalShowContextMenu(e,{align:"l-r",target:e.target});else{if(!0===e.ctrlKey&&!r.isMac)return void e.preventDefault();const t=e;if(Zc){const{target:n}=Zc;e=Mn.fixEvent(new MouseEvent(e.type,e)),Object.defineProperty(e,"target",{get:()=>n,configurable:!0}),e.preventDefault=function(){t.preventDefault(),t.handled=!0}}this.internalShowContextMenu(e)}}showContextMenuByKey(e){if(!yr.isEditable(e.target)){const t=this.getKeyboardContextMenuTarget(e.target);if(t)return Zc=e,yr.triggerMouseEvent(t,this.triggerEvent),e.handled=!0,e.preventDefault(),e.stopImmediatePropagation(),Zc=null,!0}return!1}getKeyboardContextMenuTarget(e){const t=yr.isInView(e);return e.children.length?yr.childFromPoint(e,t.width/2,t.height/2):e}internalShowContextMenu(e,t){const n=this;if(n.disabled)return;const s=n.getDataFromEvent(e);!e.handled&&!e.defaultPrevented&&s&&n.shouldShowMenu(s)&&("contextmenu"===e.type&&r.isSafari&&e.ctrlKey&&!e.metaKey&&Mn.on({element:e.target,capture:!0,once:!0,thisObj:this,click(e){e.preventDefault(),e.stopImmediatePropagation()}}),s.domEvent=e,n.showContextMenu(s,t))}getDataFromEvent(e){return{event:e,targetElement:this.getTargetElementFromEvent(e)}}getTargetElementFromEvent(e){return e.target}async showContextMenu(e,t){var n;const r=this,s=yr.isDOMEvent(e),i=s?r.getDataFromEvent(e):e,a=s?e:i.domEvent;if(null===(n=r._menu)||void 0===n||n.hide(),r.disabled)return;r.menuContext=i;const{type:o,client:l,processItems:c}=r,d=yr.isInView(i.targetElement).center;if(F.assign(i,{feature:r,point:null!=a&&a.clientX?[a.clientX+1,a.clientY+1]:[d.x,d.y],menu:r,items:{},selection:l.selectedRecords}),r.callChainablePopulateMenuMethod(i),F.merge(i.items,r.baseItems),r.preventDefaultEvent(i),(!c||!1!==await r.callback(c,l,[i]))&&r.hasActiveMenuItems(i)&&(r.populateItemsWithData(i),!1!==r.beforeContextMenuShow(i))){const{menu:e}=r;let n=l.trigger(`${o}MenuBeforeShow`,i);var u;if(Ut.isPromise(n)&&(a.handled=!0,n=await n),!1!==n)e.items=i.items,e.showBy(t||{target:i.domEvent}),null===(u=r.touchMoveDetacher)||void 0===u||u.call(r),r.touchMoveDetacher=Mn.on({element:l.element,touchmove:()=>e.hide(),thisObj:e,once:!0}),a&&(a.preventDefault(),a.handled=!0)}}get baseItems(){if(!this._baseItems){const e=this,{namedItems:t}=e,n=e._baseItems=F.assign({},e.items);for(const e in n){const r=n[e];r&&(t&&e in t?n[e]="object"==typeof r?F.merge(F.clone(t[e]),r):t[e]:!0===r&&delete n[e])}}return this._baseItems}hideContextMenu(e){var t;null===(t=this.menu)||void 0===t||t.hide(e)}callChainablePopulateMenuMethod(e){var t,n;null===(t=(n=this.client)[`populate${T.capitalize(this.type)}Menu`])||void 0===t||t.call(n,e)}hasActiveMenuItems(e){return Object.values(e.items).some((e=>e&&!e.hidden))}shouldShowMenu(){return!0}beforeContextMenuShow(e){}populateItemsWithData(e){}preventDefaultEvent(e){var t;null===(t=e.event)||void 0===t||t.preventDefault()}changeTriggerEvent(e){return e||this.client.contextMenuTriggerEvent}changeMenu(e,t){const n=this,{client:r,type:s}=n;if(e)return Xc.reconfigure(t,e?Xc.mergeConfigs({owner:r,rootElement:r.rootElement,onItem(e){r.trigger(`${s}MenuItem`,e)},onToggle(e){r.trigger(`${s}MenuToggleItem`,e)},onDestroy(){n.menu=null},onBeforeItem(e){Object.assign(e,n.menuContext)},onShow({source:e}){n.menuContext.menu=e,r.trigger(`${s}MenuShow`,n.menuContext)}},e):null,n);null!=t&&t.isWidget&&t.destroy()}}Jc._$name="ContextMenuBase";var Qc=e=>class extends(e||ue){static get $name(){return"DragHelperContainer"}initContainerDrag(){const e=this;if(e.mode||(e.mode="container"),"container"===e.mode&&!e.containers)throw new Error("Container drag mode must specify containers")}grabContainerDrag(e){const t=this;if(!t.ignoreSelector||!e.target.closest(t.ignoreSelector)){const n=yr.getAncestor(e.target,t.containers,t.outerElement);if(n){const r=n.getBoundingClientRect();t.context={element:n,valid:!0,action:"container",offsetX:e.pageX-r.left,offsetY:e.pageY-r.top,originalPosition:{parent:n.parentElement,prev:n.previousElementSibling,next:n.nextElementSibling}}}return!0}return!1}startContainerDrag(e){var t;const n=this,{context:r,floatRootOwner:s}=n,{element:i}=r,a=i.cloneNode(!0),o=null==s?void 0:s.element.closest(".b-outer");a.classList.add(n.dragProxyCls,n.draggingCls),((null==s?void 0:s.floatRoot)||yr.getRootElement(i)).appendChild(a),r.dragProxy=a,r.dragging=i,i.classList.add(n.dropPlaceholderCls),null!=o&&null!==(t=o.parentElement)&&void 0!==t&&t.matches(".b-float-root")&&(a.style.zIndex=s.floatRootMaxZIndex+1)}onContainerDragStarted(e){const{context:t}=this,{element:n,dragProxy:r}=t,s=n.getBoundingClientRect();if(this.autoSizeClonedTarget)r.style.width=s.width+"px",r.style.height=s.height+"px",yr.setTranslateXY(t.dragProxy,s.left,s.top);else{const n=r.getBoundingClientRect();Object.assign(t,{offsetX:n.width/2,offsetY:n.height/2}),yr.setTranslateXY(r,e.clientX,e.clientY)}}updateContainerDrag(e){var t;const n=this,{context:r}=n;if(!r.started||!r.targetElement)return;const s=yr.getAncestor(r.targetElement,n.containers,"b-gridbase"),i=null===(t=r.dragging)||void 0===t?void 0:t.contains(yr.getActiveElement(r.dragging));s&&yr.isDescendant(r.element,s)||(i&&xr.suspendFocusEvents(),s&&r.valid?n.moveNextTo(s,e):n.revertPosition(),i&&xr.resumeFocusEvents(),e.preventDefault())}finishContainerDrag(e){const t=this,{context:n}=t,{dragging:r,dragProxy:s,valid:i,draggedTo:a,insertBefore:o,originalPosition:l}=n;r&&(n.valid=Boolean(i&&(a||t.externalDropTargetSelector&&e.target.closest(t.externalDropTargetSelector))&&(r!==o||l.parent!==a)),n.finalize=(e=n.valid)=>{!e&&t.context&&t.revertPosition(),r.classList.remove(t.dropPlaceholderCls),s.remove(),t.reset()},n.async=!1,t.trigger("drop",{context:n,event:e}),n.async||n.finalize())}abortContainerDrag(e=!1,t=null,n=!1){const r=this,{context:s}=r;s.dragging&&(s.dragging.classList.remove(r.dropPlaceholderCls),s.dragProxy.remove(),r.revertPosition()),n||r.trigger(e?"drop":"abort",{context:s,event:t}),r.reset()}updateContainerProxy(e){const t=this,{context:n}=t,r=n.dragProxy;let s,i=e.pageX-n.offsetX,a=e.pageY-n.offsetY;if("number"==typeof t.minX&&(i=Math.max(t.minX,i)),"number"==typeof t.maxX&&(i=Math.min(t.maxX-r.offsetWidth,i)),"number"==typeof t.minY&&(a=Math.max(t.minY,a)),"number"==typeof t.maxY&&(a=Math.min(t.maxY-r.offsetHeight,a)),t.lockX?yr.setTranslateY(r,a):t.lockY?yr.setTranslateX(r,i):yr.setTranslateXY(r,i,a),"touchmove"===e.type){const t=e.changedTouches[0];s=yr.elementFromPoint(t.clientX,t.clientY)}else s=e.target;n.targetElement=s}moveNextTo(e,t){const{context:n}=this,r=n.dragging,s=e.parentElement;if(e!==r){const i=vn.from(e).center.x;this.isRTL&&t.pageX>i||!this.isRTL&&t.pageX<i?(s.insertBefore(r,e),n.insertBefore=e):e.nextElementSibling?e.nextElementSibling!==r?(n.insertBefore=e.nextElementSibling,s.insertBefore(r,e.nextElementSibling)):n.insertBefore||r.parentElement.lastElementChild===r||(n.insertBefore=e.nextElementSibling):(s.appendChild(r),n.insertBefore=null),n.draggedTo=s}}revertPosition(){const{context:e}=this,{dragging:t}=e,{parent:n,next:r}=e.originalPosition;if(r){r.previousSibling===t||!r&&t===n.lastChild||n.insertBefore(t,r)}else n.appendChild(t);e.draggedTo=null}};const ed={pageXOffset:0,pageYOffset:0};var td=e=>class extends(Ur(e||ue)){static get $name(){return"DragHelperTranslate"}static get configurable(){return{positioning:null,skipUpdatingElement:null}}initTranslateDrag(){const e=this;!e.isElementDraggable&&e.targetSelector&&(e.isElementDraggable=t=>t.closest(e.targetSelector))}grabTranslateDrag(e){const t=this.getTarget(e);return!!t&&(this.context={valid:!0,element:t,startPageX:e.pageX,startPageY:e.pageY,startClientX:e.clientX,startClientY:e.clientY},!0)}getTarget(e){return e.target.closest(this.targetSelector)}getX(e){return"absolute"===this.positioning?parseFloat(e.style.left,10):yr.getTranslateX(e)}getY(e){return"absolute"===this.positioning?parseFloat(e.style.top,10):yr.getTranslateY(e)}getXY(e){return"absolute"===this.positioning?[e.offsetLeft,e.offsetTop]:yr.getTranslateXY(e)}setXY(e,t,n){this.skipUpdatingElement||("absolute"===this.positioning?(e.style.left=t+"px",e.style.top=n+"px"):yr.setTranslateXY(e,t,n))}startTranslateDrag(e){const t=this,{context:n,outerElement:r,proxySelector:s}=t,i=t.dragWithin=t.dragWithin||t.cloneTarget&&document.body;let a=n.dragProxy||n.element;const o=a,l=a.parentElement;if(t.cloneTarget){const r=s?a.querySelector(s):a,{width:l,height:c,x:d,y:u}=vn.from(r,vn.outer(i));a=t.createProxy(a);let h=d,g=u;if(t.autoSizeClonedTarget&&(a.style.width=`${l}px`,a.style.height=`${c}px`),a.classList.add(t.dragProxyCls,t.draggingCls),a.classList.remove("b-hover","b-selected","b-focused"),i.appendChild(a),!t.autoSizeClonedTarget||s){const t=a.getBoundingClientRect(),{x:r,y:s}=i.getBoundingClientRect(),o=e.clientX-r,l=e.clientY-s+(i!==document.body?document.body.getBoundingClientRect().y:0);h=o-t.width/2,g=l-t.height/2,n.startPageX=e.pageX,n.startPageY=e.pageY}t.setXY(a,h,g),o.classList.add("b-drag-original"),t.hideOriginalElement&&o.classList.add("b-hidden")}a.classList.add(t.draggingCls),Object.assign(n,{element:a,grabbed:o,grabbedParent:l,grabbedNextSibling:a.nextElementSibling,elementStartX:t.getX(a),elementStartY:t.getY(a),elementX:yr.getOffsetX(a,i||r),elementY:yr.getOffsetY(a,i||r),scrollX:0,scrollY:0,scrollManagerElementContainsDragProxy:!t.cloneTarget||i===r}),i&&(n.parentElement=a.parentElement,i!==a.parentElement&&i.appendChild(a),t.updateTranslateProxy(e))}onTranslateDragStarted(){var e;const t=this,{context:n}=t;let{relatedElements:r}=n;if(t.unifiedProxy&&n.element.classList.add("b-drag-main","b-drag-unified-proxy"),(null===(e=r)||void 0===e?void 0:e.length)>0){n.relatedElStartPos=[],n.relatedElDragFromPos=[];const{proxySelector:e}=t;let[s,i]=[n.elementStartX,n.elementStartY];n.originalRelatedElements=r,r=n.relatedElements=r.map(((r,a)=>{const o=e?r.querySelector(e):r,{x:l,y:c,width:d,height:u}=vn.from(o,t.dragWithin),h=t.cloneTarget?t.createProxy(r):r;return h.classList.add(t.draggingCls),h.classList.remove("b-hover","b-selected","b-focused"),t.cloneTarget&&(t.setXY(h,l,c),t.dragWithin.appendChild(h),h.classList.add(t.dragProxyCls),t.autoSizeClonedTarget&&(h.style.width=`${d}px`,h.style.height=`${u}px`),t.hideOriginalElement&&r.classList.add("b-hidden"),r.classList.add("b-drag-original")),n.relatedElStartPos[a]=n.relatedElDragFromPos[a]=t.getXY(h),t.unifiedProxy&&(h.classList.add("b-drag-unified-animation","b-drag-unified-proxy"),s+=t.unifiedOffset,i+=t.unifiedOffset,t.setXY(h,s,i),n.relatedElDragFromPos[a]=[s,i],h.style.zIndex=100-a),h})),t.unifiedProxy&&r&&r.length>0&&Mn.onTransitionEnd({element:r[0],property:"transform",handler(){r.forEach((e=>e.classList.remove("b-drag-unified-animation")))},thisObj:t,once:!0})}}applyConstraints(e,t,n){const r=this,{constrain:s,dragWithin:i}=r,{pageXOffset:a,pageYOffset:o}=i===document.body?globalThis:ed;return i&&s&&(t<0&&(t=0),t+e.offsetWidth>i.scrollWidth&&(t=i.scrollWidth-e.offsetWidth),n<0&&(n=0),n+e.offsetHeight>i.scrollHeight&&(n=i.scrollHeight-e.offsetHeight)),"number"==typeof r.minX&&(t=Math.max(r.minX+a,t)),"number"==typeof r.maxX&&(t=Math.min(r.maxX+a,t)),"number"==typeof r.minY&&(n=Math.max(r.minY+o,n)),"number"==typeof r.maxY&&(n=Math.min(r.maxY+o,n)),{constrainedX:t,constrainedY:n}}updateTranslateProxy(e,t){const n=this,{lockX:r,lockY:s,context:i}=n,a=i.dragProxy||i.element,{relatedElements:o,relatedElDragFromPos:l}=i;i.scrollManagerElementContainsDragProxy&&t&&(i.scrollX=t.getRelativeLeftScroll(a),i.scrollY=t.getRelativeTopScroll(a)),i.pageX=e.pageX,i.pageY=e.pageY,i.clientX=e.clientX,i.clientY=e.clientY;let c=i.elementStartX+e.pageX-i.startPageX+i.scrollX,d=i.elementStartY+e.pageY-i.startPageY+i.scrollY;if(n.snapCoordinates){const e=n.snapCoordinates({element:a,newX:c,newY:d});c=e.x,d=e.y}const{constrainedX:u,constrainedY:h}=n.applyConstraints(a,c,d);if((i.started||u!==c||h!==d)&&n.setXY(a,r?void 0:u,s?void 0:h),o){const e=r?0:u-i.elementStartX,t=s?0:h-i.elementStartY;o.forEach(((r,s)=>{const[i,a]=l[s];n.setXY(r,i+e,a+t)}))}i.newX=u,i.newY=h}async finishTranslateDrag(e){const t=this,n=t.context,{target:r}=e,s=!t.lockX&&Math.round(n.newX)!==Math.round(n.elementStartX),i=!t.lockY&&Math.round(n.newY)!==Math.round(n.elementStartY),a=n.dragProxy||n.element,{relatedElements:o}=n;if(!t.ignoreSamePositionDrop||s||i)if(!1===n.valid)await t.abortTranslateDrag(!0,e);else{const s=!t.allowDropOutside&&vn.from(t.dragWithin||t.outerElement);s&&("number"!=typeof t.minX&&!0!==t.minX&&e.pageX<s.left||"number"!=typeof t.maxX&&!0!==t.maxX&&e.pageX>s.right||"number"!=typeof t.minY&&!0!==t.minY&&e.pageY<s.top||"number"!=typeof t.maxY&&!0!==t.maxY&&e.pageY>s.bottom)?await t.abortTranslateDrag(!0,e):(n.finalize=async(s=n.valid)=>{n.finalized?console.warn("DragHelper: Finalizing already finalized drag"):(n.finalized=!0,!s&&t.context&&await t.abortTranslateDrag(!0,null,!0),t.isDestroyed||(t.trigger("dropFinalized",{context:n,event:e,target:r}),t.reset()),t.cloneTarget||a.parentElement===n.grabbedParent||[a,...o||[]].forEach((e=>e.style.transform="")))},n.async=!1,await t.trigger("drop",{context:n,event:e,target:r}),n.async||await n.finalize())}else t.abortTranslateDrag(!1,e)}async abortTranslateDrag(e=!1,t=null,n=!1){var r,s;const i=this,{cloneTarget:a,context:o,proxySelector:l,dragWithin:c,draggingCls:d}=i,{relatedElements:u,relatedElStartPos:h,grabbed:g}=o,m=o.dragProxy||o.element;if(o.valid=!1,null===(r=i.scrollManager)||void 0===r||r.stopMonitoring(),o.aborted)return void console.warn("DragHelper: Aborting already aborted drag");let{elementStartX:p,elementStartY:f}=o;const v=p!==i.getX(m)||f!==i.getY(m);if(m&&o.started){if(!a&&c&&c!==o.grabbedParent&&o.grabbedParent.insertBefore(m,o.grabbedNextSibling),a&&l){const e=g.querySelector(l)||g,{x:t,y:n}=vn.from(e);p=t,f=n}m.classList.add("b-aborting"),i.setXY(m,p,f),null==u||u.forEach(((e,t)=>{e.classList.remove(d),e.classList.add("b-aborting"),i.setXY(e,h[t][0],h[t][1])})),n||i.trigger(e?"drop":"abort",{context:o,event:t}),m.isConnected&&!i.isDestroying&&v&&await Mn.waitForTransitionEnd({element:m,property:yr.getPropertyTransitionDuration(m,"transform")?"transform":"all",thisObj:i,once:!0,runOnDestroy:!0}),i.isDestroyed||i.trigger("abortFinalized",{context:o,event:t})}null!==(s=i.context)&&void 0!==s&&s.started&&i.reset()}cleanUp(){const{context:e,cloneTarget:t,draggingCls:n,dragProxyCls:r}=this,s=e.dragProxy||e.element,{relatedElements:i,originalRelatedElements:a,grabbed:o}=e,l=t&&(this.removeProxyAfterDrop||!e.valid),c=[n,"b-aborting",r,"b-drag-main","b-drag-unified-proxy"];s.classList.remove(...c),l&&s.remove(),null==i||i.forEach((e=>{l?e.remove():e.classList.remove(...c)})),o.classList.remove("b-drag-original","b-hidden"),null==a||a.forEach((e=>e.classList.remove("b-hidden","b-drag-original")))}};const nd="onMouseMove",rd="onMouseUp",sd="onDocumentClick",id="onTouchMove",ad="onTouchEnd",od="onKeyDown";class ld extends(ue.mixin(Ne,Qc,td)){static get defaultConfig(){return{dragProxyCls:"b-drag-proxy",invalidCls:"b-drag-invalid",draggingCls:"b-dragging",dropPlaceholderCls:"b-drop-placeholder",dragThreshold:5,outerElement:document.body,dragWithin:null,unifiedProxy:null,monitoringConfig:null,constrain:!0,minX:null,maxX:null,minY:null,maxY:null,mode:"translateXY",isElementDraggable:null,targetSelector:null,dropTargetSelector:null,dropTargetCls:null,proxySelector:null,cloneTarget:!1,autoSizeClonedTarget:!0,hideOriginalElement:!1,containers:null,ignoreSelector:null,startEvent:null,lockX:!1,lockY:!1,touchStartDelay:300,scrollManager:null,snapCoordinates:null,unifiedOffset:5,removeProxyAfterDrop:!0,clickSwallowDuration:50,ignoreSamePositionDrop:!0,allowDropOutside:null,floatRootOwner:null,mouseMoveListenerElement:document,externalDropTargetSelector:null,testConfig:{transitionDuration:10,clickSwallowDuration:50,touchStartDelay:100},rtlSource:null,createProxy:null}}construct(e){const t=this;super.construct(e),t.initListeners(),t.isContainerDrag?t.initContainerDrag():t.initTranslateDrag(),t.onScrollManagerScrollCallback=t.onScrollManagerScrollCallback.bind(t)}doDestroy(){this.reset(!0),super.doDestroy()}initListeners(){const e=this,{outerElement:t}=e,n={element:t,pointerdown:"onPointerDown",thisObj:e};e.mouseMoveListenerElement=e.getMouseMoveListenerTarget(t),Mn.on(n)}getMouseMoveListenerTarget(e){const t=e.getRootNode();let n=this.mouseMoveListenerElement;return t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&"closed"===t.mode&&(n=e.closest(".b-outer")||n),n}get isRTL(){var e;return Boolean(null===(e=this.rtlSource)||void 0===e?void 0:e.rtl)}onPointerDown(e){const t=this;if(0!==e.button||t.context)return;if(t.isElementDraggable&&!t.isElementDraggable(e.target,e))return;t.startEvent=e;if(t.isContainerDrag?t.grabContainerDrag(e):t.grabTranslateDrag(e)){t.blurDetacher=Mn.on({element:globalThis,blur:t.onWindowBlur,thisObj:t});const n={element:t.mouseMoveListenerElement,thisObj:t,capture:!0,keydown:od};if("touch"===e.pointerType?(t.touchStartTimer=t.setTimeout((()=>t.touchStartTimer=null),t.touchStartDelay,"touchStartDelay"),n.touchmove={handler:id,passive:!1},n.touchend=n.pointerup=ad):(n.pointermove=nd,n.pointerup=rd),t.dragListenersDetacher=Mn.on(n),t.dragWithin&&t.dragWithin!==t.outerElement&&t.outerElement.contains(t.dragWithin)){const e=vn.from(t.dragWithin,t.outerElement);t.minY=e.top,t.maxY=e.bottom,t.minX=e.left,t.maxX=e.right}}}async internalMove(e){var t;if(e.scrollInitiated)return;const n=this,{context:r}=n,s=Mn.getDistanceBetween(n.startEvent,e);if(n.touchStartTimer&&s>n.dragThreshold)n.abort(!0);else if(!n.touchStartTimer&&null!=r&&r.element&&(r.started||s>=n.dragThreshold)&&(null===(t=e.target)||void 0===t?void 0:t.nodeType)===Node.ELEMENT_NODE){if(!r.started){var i;if(!1===n.trigger("beforeDragStart",{context:r,event:e}))return n.abort();n.isContainerDrag?n.startContainerDrag(e):n.startTranslateDrag(e),r.started=!0,null===(i=n.scrollManager)||void 0===i||i.startMonitoring(Ut.merge({scrollables:[{element:n.dragWithin||n.outerElement}],callback:n.onScrollManagerScrollCallback},n.monitoringConfig)),r.outermostEl=yr.getOutermostElement(e.target),r.outermostEl.classList.add("b-draghelper-active"),n.dropTargetSelector&&n.dropTargetCls&&yr.getRootElement(n.outerElement).querySelectorAll(n.dropTargetSelector).forEach((e=>e.classList.add(n.dropTargetCls)));const t=n.trigger("dragStart",{context:r,event:e});Ut.isPromise(t)&&await t,r.moveUnblocked=!0,n.isContainerDrag?n.onContainerDragStarted(e):n.onTranslateDragStarted(e),n.trigger("afterDragStart",{context:r,event:e})}r.moveUnblocked?n._cachedMouseEvent?(n.update(e),n.update(n._cachedMouseEvent),delete n._cachedMouseEvent):n.update(e):n._cachedMouseEvent=e,"touchmove"===e.type&&(e.preventDefault(),e.stopImmediatePropagation())}}onScrollManagerScrollCallback(e){var t;const{lastMouseMoveEvent:n}=this;null!==(t=this.context)&&void 0!==t&&t.element&&n&&(n.isScroll=!0,this.update(n,e))}onTouchMove(e){this.internalMove(e)}onMouseMove(e){this.internalMove(e)}update(e,t){const n=this,{context:r}=n,s=document.scrollingElement||document.body;let i=n.getMouseMoveEventTarget(e);if("touchmove"===e.type){const t=e.changedTouches[0];i=yr.elementFromPoint(t.clientX+s.scrollLeft,t.clientY+s.scrollTop)}r.target=i;let a=n.allowDropOutside||!n.dragWithin||n.dragWithin.contains(e.target);var o;a&&n.dropTargetSelector&&(a=a&&Boolean(null===(o=i)||void 0===o?void 0:o.closest(n.dropTargetSelector)));n.isContainerDrag?n.updateContainerProxy(e,t):n.updateTranslateProxy(e,t),r.valid=a,n.trigger("drag",{context:r,event:e}),n.isContainerDrag&&n.updateContainerDrag(e,t),r.valid=r.valid&&a;for(const e of n.draggedElements)e.classList.toggle(n.invalidCls,!r.valid);e&&(n.lastMouseMoveEvent=e)}get draggedElements(){const{context:e}=this;return[e.dragProxy||e.element,...e.relatedElements??[]]}async abort(e=!1){var t,n;const r=this,{context:s}=r;null===(t=r.scrollManager)||void 0===t||null===(n=t.stopMonitoring)||void 0===n||n.call(t),r.removeListeners(),null!=s&&s.started&&!s.aborted?(s.element.getBoundingClientRect(),s.valid=!1,r.isContainerDrag?r.abortContainerDrag(void 0,void 0,e):r.abortTranslateDrag(void 0,void 0,e),s.aborted=!0):r.reset(!0)}removeListeners(){var e,t;null===(e=this.dragListenersDetacher)||void 0===e||e.call(this),null===(t=this.blurDetacher)||void 0===t||t.call(this)}reset(e){const t=this,{context:n}=t;if(null!=n&&n.started){for(const e of t.draggedElements)e.classList.remove(t.invalidCls);n.outermostEl.classList.remove("b-draghelper-active"),t.isContainerDrag?n.dragProxy.remove():t.cleanUp(),t.dropTargetSelector&&t.dropTargetCls&&yr.getRootElement(t.outerElement).querySelectorAll(t.dropTargetSelector).forEach((e=>e.classList.remove(t.dropTargetCls)))}t.removeListeners(),e||t.trigger("reset"),t.context=t.lastMouseMoveEvent=null}onTouchEnd(e){this.onMouseUp(e)}onDocumentClick(e){e.stopPropagation()}onMouseUp(e){const t=this,{context:n}=t;var r;(t.removeListeners(),n)&&(null===(r=t.scrollManager)||void 0===r||r.stopMonitoring(),n.started?n.moveUnblocked?(e.stopPropagation(),n.finalizing=!0,t.isContainerDrag?t.finishContainerDrag(e):t.finishTranslateDrag(e),Mn.on({element:document,thisObj:t,click:sd,capture:!0,expires:t.clickSwallowDuration,once:!0})):t.ion({drag(){t.onMouseUp(e)},once:!0}):t.reset(!0))}onKeyDown(e){var t;null!==(t=this.context)&&void 0!==t&&t.started&&"Escape"===e.key&&(e.stopImmediatePropagation(),this.abort())}onWindowBlur(){this.context&&!this.context.finalizing&&this.abort()}createProxy(e){this.proxySelector&&(e=e.querySelector(this.proxySelector)||e);const t=e.cloneNode(!0);return t.removeAttribute("id"),t}get isContainerDrag(){return"container"===this.mode}async animateProxyTo(e,t={align:"c-c"}){const{context:n,draggedElements:r}=this,{element:s}=n,i=e.isRectangle?e:vn.from(e);r.forEach((e=>{e.classList.add("b-drag-final-transition"),yr.alignTo(e,i,t)})),await Mn.waitForTransitionEnd({element:s,property:"all",thisObj:this,once:!0}),r.forEach((e=>e.classList.remove("b-drag-final-transition")))}get isDragging(){var e;return Boolean(null===(e=this.context)||void 0===e?void 0:e.started)}getMouseMoveEventTarget(e){return e.isScroll?yr.elementFromPoint(e.clientX,e.clientY):e.target}}ld._$name="DragHelper";const cd={down:"onMouseDown",move:"onMouseMove",up:"onMouseUp",docclick:"onDocumentClick",touchstart:{handler:"onTouchStart",passive:!1},touchmove:"onTouchMove",touchend:"onTouchEnd",keydown:"onKeyDown"};class dd extends(Ne(ue)){static get defaultConfig(){return{resizingCls:"b-resizing",dragThreshold:5,handleSize:10,dynamicHandleSize:null,reservedSpace:10,touchHandleSize:30,minWidth:1,maxWidth:0,minHeight:1,maxHeight:0,outerElement:document.body,scroller:null,allowResize:null,dragWithin:null,isElementResizable:null,targetSelector:null,leftHandle:!0,rightHandle:!0,topHandle:!0,bottomHandle:!0,handleSelector:null,handleContainerSelector:null,startEvent:null,grab:null,invalidCls:"b-resize-invalid",handleVisibilityThreshold:null,skipTranslate:!1,direction:"horizontal",clickSwallowDuration:50,rtlSource:null}}static configurable={skipUpdatingElement:null};construct(e){const t=this;super.construct(e),t.handleSelector||r.isHoverableDevice||(t.handleSize=t.touchHandleSize),t.handleVisibilityThreshold=t.handleVisibilityThreshold||2*t.handleSize,t.initListeners(),t.initResize()}doDestroy(){this.abort(!0),super.doDestroy()}updateSkipUpdatingElement(e){e&&(this.skipTranslate=!0)}initResize(){const e=this;if(!e.isElementResizable&&e.targetSelector&&(e.isElementResizable=t=>t.closest(e.targetSelector)),e.grab){const{edge:t,element:n,event:r}=e.grab;e.startEvent=r;const s=e.getCursorOffsetToElementEdge(r,n,t);e.context={element:n,edge:t,valid:!0,async:!1,elementStartX:yr.getTranslateX(n)||n.offsetLeft,elementStartY:yr.getTranslateY(n)||n.offsetTop,newX:yr.getTranslateX(n)||n.offsetLeft,newY:yr.getTranslateY(n)||n.offsetTop,elementWidth:n.offsetWidth,elementHeight:n.offsetHeight,cursorOffset:s,startX:r.clientX+s.x+e.scrollLeft,startY:r.clientY+s.y+e.scrollTop,finalize:()=>{var t;return null===(t=e.reset)||void 0===t?void 0:t.call(e)}},n.classList.add(e.resizingCls),e.internalStartResize(e.isTouch)}}initListeners(){const e=this,t={element:e.outerElement,mousedown:cd.down,touchstart:cd.touchstart,thisObj:e};!e.handleSelector&&r.isHoverableDevice&&(t.mousemove={handler:cd.move,delegate:e.targetSelector},t.mouseleave={handler:"onMouseLeaveTarget",delegate:e.targetSelector,capture:!0}),Mn.on(t)}get isRTL(){var e;return Boolean(null===(e=this.rtlSource)||void 0===e?void 0:e.rtl)}get scrollLeft(){return this.scroller?this.scroller.x:this.outerElement.scrollLeft}get scrollTop(){return this.scroller?this.scroller.y:this.outerElement.scrollTop}internalStartResize(e){var t;const n={element:document,keydown:cd.keydown,thisObj:this};e?(n.touchmove=cd.touchmove,n.touchend=n.pointerup=cd.touchend):(n.mousemove=cd.move,n.mouseup=cd.up),this.removeDragListeners=Mn.on(n),null===(t=this.onResizeHandlePointerDown)||void 0===t||t.call(this,this.startEvent)}removeDragListeners(){}reset(){var e;null===(e=this.removeDragListeners)||void 0===e||e.call(this),this.context=null,this.trigger("reset")}canResize(e,t){return!this.isElementResizable||this.isElementResizable(e,t)}onPointerDown(e,t){const n=this;n.startEvent=t,n.canResize(t.target,t)&&n.grabResizeHandle(e,t)&&(t.stopImmediatePropagation(),"touchstart"===t.type&&t.preventDefault(),n.internalStartResize(e))}onTouchStart(e){e.touches.length>1||this.onPointerDown(!0,e)}onMouseDown(e){0===e.button&&this.onPointerDown(!1,e)}internalMove(e,t){const n=this,{context:r,direction:s}=n;if(null!=r&&r.element&&(r.started||Mn.getDistanceBetween(n.startEvent,t)>=n.dragThreshold)){var i;if(!r.started)null===(i=n.scrollManager)||void 0===i||i.startMonitoring(Ut.merge({scrollables:[{element:n.dragWithin||n.outerElement,direction:s}],callback:e=>{var t;return(null===(t=n.context)||void 0===t?void 0:t.element)&&n.lastMouseMoveEvent&&n.update(n.lastMouseMoveEvent,e)}},n.monitoringConfig)),n.trigger("resizeStart",{context:r,event:t}),r.started=!0;n.update(t)}else e||n.handleSelector||n.checkResizeHandles(t)}onTouchMove(e){this.internalMove(!0,e)}onMouseMove(e){this.internalMove(!1,e)}onPointerUp(e,t){var n;const r=this,s=r.context;var i,a;(null===(n=r.removeDragListeners)||void 0===n||n.call(r),s)?(null===(i=r.scrollManager)||void 0===i||i.stopMonitoring(),s.started&&Mn.on({element:document,thisObj:r,click:cd.docclick,expires:r.clickSwallowDuration,capture:!0,once:!0}),r.finishResize(t)):null===(a=r.reset)||void 0===a||a.call(r)}onTouchEnd(e){this.onPointerUp(!0,e)}onMouseUp(e){this.onPointerUp(!1,e)}onDocumentClick(e){e.stopPropagation()}onKeyDown(e){"Escape"===e.key&&this.abort()}update(e){const t=this,n=t.context,{element:r}=n,s=vn.from(t.outerElement);n.currentX=Math.max(Math.min(e.clientX+n.cursorOffset.x,s.right),s.x)+t.scrollLeft,n.currentY=Math.max(Math.min(e.clientY+n.cursorOffset.y,s.bottom),s.y)+t.scrollTop,r.classList.add(t.resizingCls),e&&(t.updateResize(e)&&(t.trigger("resizing",{context:n,event:e}),r.classList.toggle(t.invalidCls,!1===n.valid)),t.lastMouseMoveEvent=e)}abort(e=!1){var t,n;const r=this;null===(t=r.scrollManager)||void 0===t||null===(n=t.stopMonitoring)||void 0===n||n.call(t),r.context?r.abortResize(null,e):r.isDestroyed||r.reset()}grabResizeHandle(e,t){const n=this;if(n.allowResize&&!n.allowResize(t.target,t))return!1;const r=n.handleSelector,s="touchstart"===t.type?t.changedTouches[0]:t,i=s.clientX,a=s.clientY;let o=n.targetSelector?t.target.closest(n.targetSelector):t.target;if(o){var l;let c;if(r){if(!t.target.matches(r))return!1;c="horizontal"===n.direction?t.pageX<yr.getPageX(o)+o.offsetWidth/2?n.isRTL?"right":"left":n.isRTL?"left":"right":t.pageY<yr.getPageY(o)+o.offsetHeight/2?"top":"bottom"}else if("horizontal"===n.direction?n.overLeftHandle(t,o)?c=n.isRTL?"right":"left":n.overRightHandle(t,o)&&(c=n.isRTL?"left":"right"):n.overTopHandle(t,o)?c="top":n.overBottomHandle(t,o)&&(c="bottom"),!c)return n.context=null,!1;"touchstart"===t.type&&t.preventDefault();const d=n.getCursorOffsetToElementEdge(s,o,c),u=null===(l=n.internalBeforeStart)||void 0===l?void 0:l.call(n,{element:o,edge:c});if(u&&(o=u.element,c=u.edge),!1!==n.trigger("beforeResizeStart",{element:o,event:t}))return n.context={element:o,edge:c,isTouch:e,valid:!0,async:!1,direction:n.direction,elementStartX:yr.getTranslateX(o)||o.offsetLeft,elementStartY:yr.getTranslateY(o)||o.offsetTop,newX:yr.getTranslateX(o)||o.offsetLeft,newY:yr.getTranslateY(o)||o.offsetTop,elementWidth:o.offsetWidth,elementHeight:o.offsetHeight,cursorOffset:d,startX:i+d.x+n.scrollLeft,startY:a+d.y+n.scrollTop,finalize:()=>{var e;return null===(e=n.reset)||void 0===e?void 0:e.call(n)}},o.classList.add(n.resizingCls),!0}return!1}getCursorOffsetToElementEdge(e,t,n){const r=vn.from(t);let s=0,i=0;switch(n){case"left":s=r.x-(this.isRTL?r.width:0)-e.clientX;break;case"right":s=r.x+(this.isRTL?0:r.width)-e.clientX;break;case"top":i=r.y-e.clientY;break;case"bottom":i=r.y+r.height-e.clientY}return{x:s,y:i}}checkResizeHandles(e){const t=this,n=t.targetSelector?e.target.closest(t.targetSelector):e.target;if(!n||t.allowResize&&!t.allowResize(e.target,e))t.currentElement&&t.unHighlightHandle();else if(t.currentElement=t.handleContainerSelector?e.target.closest(t.handleContainerSelector):e.target,t.currentElement){let r;r="horizontal"===t.direction?t.overLeftHandle(e,n)||t.overRightHandle(e,n):t.overTopHandle(e,n)||t.overBottomHandle(e,n),r?t.highlightHandle():t.unHighlightHandle()}}onMouseLeaveTarget(e){const t=this;t.currentElement=t.handleContainerSelector?e.target.closest(t.handleContainerSelector):e.target,t.currentElement&&t.unHighlightHandle()}updateResize(e){const t=this,{context:n,allowEdgeSwitch:r,skipTranslate:s,skipUpdatingElement:i}=t;let a;r&&("horizontal"===t.direction?n.edge=n.currentX>n.startX?"right":"left":n.edge=n.currentY>n.startY?"bottom":"top");const{element:o,elementStartX:l,elementStartY:c,elementWidth:d,elementHeight:u,edge:h}=n,{style:g}=o,m=n.currentX-n.startX,p=n.currentY-n.startY,f=yr.getExtremalSizePX(o,"minWidth")||t.minWidth,v=yr.getExtremalSizePX(o,"maxWidth")||t.maxWidth,y=yr.getExtremalSizePX(o,"minHeight")||t.minHeight,b=yr.getExtremalSizePX(o,"maxHeight")||t.maxHeight,C="right"===h&&!t.isRTL||"bottom"===h?1:-1,S=d+m*C,w=u+p*C;let D=Math.max(f,S),T=Math.max(y,w);if(v>0&&(D=Math.min(D,v)),b>0&&(T=Math.min(T,b)),g.flex&&(g.flex=""),"horizontal"===t.direction&&d!==D){if(i||(g.width=Math.abs(D)+"px"),n.newWidth=D,"left"===h||D<0){const e=Math.max(Math.min(l+d-t.minWidth,l+m),0);s||yr.setTranslateX(o,Math.round(e)),n.newX=e}else"right"===h&&r&&!s&&yr.setTranslateX(o,l);a=!0}else"vertical"===t.direction&&u!==w&&(i||(g.height=Math.abs(T)+"px"),n.newHeight=T,"top"===h||T<0?(n.newY=Math.max(Math.min(c+u-t.minHeight,c+p),0),s||yr.setTranslateY(o,n.newY)):"bottom"===h&&r&&!s&&yr.setTranslateY(o,c),a=!0);return a}finishResize(e){const t=this,n=t.context,r={context:n,event:e};if(n.element.classList.remove(t.resizingCls),n.started){let e=!1;e="horizontal"===t.direction?n.newWidth&&n.newWidth!==n.elementWidth:n.newHeight&&n.newHeight!==n.elementHeight,t.trigger(e?"resize":"cancel",r),n.async||n.finalize()}else{var s;null===(s=t.reset)||void 0===s||s.call(t)}}abortResize(e=null,t=!1){const n=this,r=n.context;r.element.classList.remove(n.resizingCls),"horizontal"===n.direction?(("left"===r.edge||r.allowEdgeSwitch&&!r.skipTranslate)&&yr.setTranslateX(r.element,r.elementStartX),r.element.style.width=r.elementWidth+"px"):(yr.setTranslateY(r.element,r.elementStartY),r.element.style.height=r.elementHeight+"px"),!t&&n.trigger("cancel",{context:r,event:e}),n.isDestroyed||n.reset()}highlightHandle(){const e=this,t=e.targetSelector?e.currentElement.closest(e.targetSelector):e.currentElement;e.currentElement.classList.add("b-resize-handle"),t.classList.add("b-over-resize-handle")}unHighlightHandle(){const e=this,t=e.targetSelector?e.currentElement.closest(e.targetSelector):e.currentElement;t&&t.classList.remove("b-over-resize-handle"),e.currentElement.classList.remove("b-resize-handle"),e.currentElement=null}overAnyHandle(e,t){return this.overStartHandle(e,t)||this.overEndHandle(e,t)}overStartHandle(e,t){return"horizontal"===this.direction?this.overLeftHandle(e,t):this.overTopHandle(e,t)}overEndHandle(e,t){return"horizontal"===this.direction?this.overRightHandle(e,t):this.overBottomHandle(e,t)}getDynamicHandleSize(e,t){const n=e?2:1,{handleSize:r}=this;return this.dynamicHandleSize&&r*n>t-this.reservedSpace?Math.max(Math.floor((t-this.reservedSpace)/n),0):r}overLeftHandle(e,t){const n=this,{offsetWidth:r}=t;if(n.leftHandle&&n.canResize(t,e)&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){const s=vn.from(t);return s.width=n.getDynamicHandleSize(n.rightHandle,r),s.width>0&&s.contains(Mn.getPagePoint(e))}return!1}overRightHandle(e,t){const n=this,{offsetWidth:r}=t;if(n.rightHandle&&n.canResize(t,e)&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){const s=vn.from(t);return s.x=s.right-n.getDynamicHandleSize(n.leftHandle,r),s.width>0&&s.contains(Mn.getPagePoint(e))}return!1}overTopHandle(e,t){const n=this,{offsetHeight:r}=t;if(n.topHandle&&n.canResize(t,e)&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){const s=vn.from(t);return s.height=n.getDynamicHandleSize(n.bottomHandle,r),s.height>0&&s.contains(Mn.getPagePoint(e))}return!1}overBottomHandle(e,t){const n=this,{offsetHeight:r}=t;if(n.bottomHandle&&n.canResize(t,e)&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){const s=vn.from(t);return s.y=s.bottom-n.getDynamicHandleSize(n.bottomHandle,r),s.height>0&&s.contains(Mn.getPagePoint(e))}return!1}}dd._$name="ResizeHelper";const ud=/>[ \t\r\n]+</g,hd=/\s\s+/g;class gd{static tpl(e,...t){let n=0,r=t.map(((t,r)=>{let s=e[r];return Array.isArray(t)?s+=t.reduce(((e,t)=>e+(("string"==typeof t?t.trim():t)+"\n")),""):(void 0===t&&(t=""),s+="string"==typeof t?t.trim():t),n++,s})).join("");return n<=e.length&&(r+=e[e.length-1]),r.replace(ud,"><").replace(hd," ").trim()}static docsTpl(e,...t){let n=0,r=t.map(((t,r)=>{let s=e[r];return Array.isArray(t)?s+=t.reduce(((e,t)=>e+(("string"==typeof t?t.trim():t)+"\n")),""):(void 0===t&&(t=""),s+="string"==typeof t?t.trim():t),n++,s})).join("");return n<=e.length&&(r+=e[e.length-1]),r.replace(ud,"><").trim()}static repeat(e){return function(...t){return gd.tpl(...t).repeat(e)}}static loop(e){}}gd._$name="TemplateHelper";class md extends Array{constructor(e,t){super(),this.timeZone=e,this.year=t}}class pd{constructor(e,t){this.asString=e,this.timeZone=t,this.asArray=yd(e)}get asLocalDate(){return this._asLocalDate||(this._asLocalDate=new Date(...this.asArray)),this._asLocalDate}get asTicksUtc(){return this._asTicksUtc||(this._asTicksUtc=new Date(Date.UTC(...this.asArray)).getTime()),this._asTicksUtc}}const fd=(e,t)=>{const n=e.toLocaleString("sv-SE",{timeZone:t});return new pd(n,t)},vd=(e,t)=>{const{asTicksUtc:n,asString:r}=fd(new Date(e),t);return{offset:(e-n)/6e4,tzTicksUtc:n,tzString:r}},yd=e=>{const t=e.split(/[\s-:]/).map((e=>1*e));return t[1]-=1,t},bd=-864e5,Cd=2592e6,Sd=(e,t)=>{const n=wd.get(e,t);if(n)return n;const r=new md(e,t),s=new Date(Date.UTC(t,0,1)).getTime();let i,a,o,l,c=s,d=Cd,u=0,h=[],g=null;for(;!l;)({offset:o,tzTicksUtc:i,tzString:a}=vd(c,e)),null==g?(g=o,r.push({offset:o})):d>0&&o!==g?d=d===Cd?bd:-6e4:d<0&&o===g&&(d===bd?d=36e5:(1===r.length?(r.push(h),g=h.offset):(r[0].startTicks=h.startTicks,r[0].startDateString=h.startDateString,l=!0),d=Cd)),h={offset:o,startDateString:a,startTicks:i},d===Cd&&(c=s,c+=u*Cd,u+=1),c+=d,u>11&&(l=!0);return wd.set(r),r},wd={_cache:{},get(e,t){var n;return null===(n=this._cache[e])||void 0===n?void 0:n[t]},set(e){const{timeZone:t}=e,{_cache:n}=this;n[t]||(n[t]={}),n[t][e.year]=e}};class Dd{static get $name(){return"TimeZoneHelper"}static toTimeZone(e,t){if("number"==typeof t)return this.toUtcOffset(e,t);const n=fd(e,t);return n.asArray[3]!==n.asLocalDate.getHours()&&console.warn("Incorrect time zone conversion due to local DST-switch detected"),n.asLocalDate}static fromTimeZone(e,t){if("number"==typeof t)return this.fromUtcOffset(e,t);const n=this.dateAsArray(e),r=Sd(t,e.getUTCFullYear());let s=r[0].offset;if(2===r.length){const e=Date.UTC(...n);e>=r[1].startTicks&&e<r[0].startTicks&&(s=r[1].offset)}return n[4]+=s,new Date(Date.UTC(...n))}static toUtcOffset(e,t){const n=e.getTimezoneOffset()+t;return new Date(e.getTime()+60*n*1e3)}static fromUtcOffset(e,t){const n=-e.getTimezoneOffset()-t;return new Date(e.getTime()+60*n*1e3)}static dateAsArray(e){return[e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()]}}Dd.findOffsetDates=Sd,Dd._$name="TimeZoneHelper";class Td extends il{static $name="Toast";static type="toast";static get configurable(){return{testConfig:{destroyTimeout:1,timeout:1e3},floating:!0,timeout:2500,autoDestroy:null,destroyTimeout:200,showProgress:!0,color:null,bottomMargin:20}}compose(){const{appendTo:e,color:t,html:n,showProgress:r,style:s,timeout:i}=this;return{parent:e||this.floatRoot,class:{...Sn.normalize(t,"object"),"b-toast-hide":1},html:n,style:s,children:{progressElement:r&&{style:`animation-duration:${i/1e3}s;`,class:{"b-toast-progress":1}}},listeners:{click:"hide"}}}doDestroy(){this.untoast(),super.doDestroy()}get nextBottom(){const{bottomMargin:e,element:t}=this;return parseInt(t.style.bottom,10)+t.offsetHeight+e}async show(){await super.show(...arguments);const e=this,{element:t}=e,{toasts:n}=Td;var r;n.includes(e)||(t.style.bottom=((null===(r=n[0])||void 0===r?void 0:r.nextBottom)??e.bottomMargin)+"px",n.unshift(e),t.getBoundingClientRect(),t.classList.remove("b-toast-hide"),e.timeout>0&&(e.hideTimeout=e.setTimeout("hide",e.timeout)))}async hide(){const e=this;e.untoast(),e.element.classList.add("b-toast-hide"),e.autoDestroy&&!e.destroyTimer&&(e.destroyTimer=e.setTimeout("destroy",e.destroyTimeout))}untoast(){const{toasts:e}=Td;e.includes(this)&&e.splice(e.indexOf(this),1)}static hideAll(){Td.toasts.slice().reverse().forEach((e=>e.hide()))}static show(e){const t=Td.new({autoDestroy:!0,rootElement:document.body},"string"==typeof e?{html:e}:e);return t.show(),t}}Td.toasts=[],Td.initClass(),Td._$name="Toast";class Ed{static getById(e){return il.getById(e)}static fromElement(e,t,n){return il.fromElement(e,t,n)}static createWidget(e={}){return e.isWidget?e:il.create(e)}static append(e,t){if(e=Array.isArray(e)&&e||[e],(t instanceof HTMLElement||"string"==typeof t)&&(t={appendTo:t}),t.insertFirst){const e="string"==typeof t.insertFirst?document.getElementById(t.insertFirst):t.insertFirst;e.firstChild?t.insertBefore=e.firstChild:t.appendTo=e}return e.map((e=>il.create(Ut.assign({},t||{},e))))}static openPopup(e,t){return il.create(Ut.assign({forElement:e},"string"==typeof t?{html:t}:t),"popup")}static showContextMenu(e,t){const n=this;return n.currentContextMenu&&n.currentContextMenu.destroy(),e instanceof HTMLElement?t.forElement=e:(t.forElement=document.body,Array.isArray(e)&&(e=new yn(...e)),e instanceof yn&&(t.align={position:e})),t.internalListeners={destroy:n.currentContextMenu=null},n.currentContextMenu=il.create(t,"menu")}static attachTooltip(e,t){return il.attachTooltip(e,t)}static hasTooltipAttached(e){return il.resolveType("tooltip").hasTooltipAttached(e)}static destroyTooltipAttached(e){return il.resolveType("tooltip").destroyTooltipAttached(e)}static mask(e,t="Loading"){if(e)return e instanceof HTMLElement&&(e={target:e,text:t}),Ao.mask(e,e.target)}static unmask(e,t=!0){e.mask&&(t?e.mask.close():e.mask.hide())}static toast(e){return Td.show(e)}}Ed._$name="WidgetHelper";class xd{static convertFromObject(e,t={}){F.assignIf(t,{rootName:"root",elementName:"element",includeHeader:!0,rootElementForArray:!0});const{rootName:n,elementName:r,includeHeader:s,rootElementForArray:i}=t;let{xmlns:a}=t;a=a?` xmlns="${a}"`:"";const o=e=>{const t=[];for(const n in e){const s=e[n];if(Array.isArray(s)){i&&t.push(`<${n}>`);for(const e of s)r.length?t.push(`<${r}>`):t.push(`<${n}>`),t.push(o(e)),r.length?t.push(`</${r}>`):t.push(`</${n}>`);i&&t.push(`</${n}>`)}else F.isObject(s)?t.push(`<${n}>${o(s)}</${n}>`):null==s?t.push(`<${n}/>`):t.push(`<${n}>${T.encodeHtml(s)}</${n}>`)}return t.join("")};return`${s?'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>':""}<${n}${a}>${o(e)}</${n}>`}}xd._$name="XMLHelper";class kd{constructor(){this.random100=[46,2,36,46,54,59,18,20,71,55,88,98,13,61,61,40,2,15,3,32,51,45,64,25,81,85,54,13,57,49,64,22,81,94,0,62,17,7,11,2,33,99,85,26,83,83,96,26,20,89,91,38,26,13,11,79,32,30,5,51,70,7,5,56,58,77,37,89,40,80,78,59,26,36,8,51,60,23,86,5,11,96,64,94,87,64,4,78,17,85,35,0,90,86,23,55,53,9,35,59,29,2,64,42,8,49,43,73,6,53,38,9,39,31,32,40,49,13,78,68,20,99,24,78,35,91,73,46,67,76,89,69,30,69,25,3,4,55,1,65,66,76,83,19,67,1,95,24,54,45,56,40,67,92,72,4,69,8,47,50,27,2,38,9,14,83,12,14,62,95,22,47,35,18,38,14,86,64,68,61,52,69,39,93,20,73,32,52,74,6,56,68,99,29,24,92,40,67,6,72,31,41,91,53,80,55,33,97,97,99,18,20,5,27,82,84,61,78,27,67,7,42,75,95,91,25,63,21,70,36,46,0,1,45,84,6,86,15,10,62,96,94,10,23,93,83,94,47,5,29,29,52,51,37,77,96,43,72,43,14,54,14,72,52,4,39,15,26,68,28,25,76,60,50,22,40,72,74,68,58,8,48,40,62,52,24,9,26,47,44,49,96,7,77,90,45,76,47,5,86,1,36,18,42,19,90,34,23,70,32,69,79,0,99,57,80,72,21,19,72,85,68,4,40,86,62,0,63,4,11,69,31,78,31,21,78,29,84,13,53,57,10,26,50,24,30,90,42,51,96,93,21,99,23,81,0,89,43,86,63,93,19,54,71,92,36,4,95,37,99,60,29,23,50,68,95,57,95,77,53,99,78,75,12,92,47,23,14,0,41,98,11,34,64,26,90,50,23,38,31,74,76,16,76,66,23,22,72,48,50,20,36,37,58,5,43,49,64,81,30,8,21,98,75,60,17,50,42,27,38,90,74,45,68,67,27,31,15,58,76,41,99,23,98,53,98,56,19,79,2,4,38,96,24,65,51,43,42,41,60,46,7,90,65,3,27,63,99,51,44,86,1,54,40,15,74,3,81,51,63,87,79,84,72,22,38,96,95,33,41,21,99,21,69,7,49,40,52,41,6,91,19,76,40,54,17,33,11,11,0,1,32,94,33,13,18,45,7,85,61,42,54,45,72,78,96,17,9,80,87,41,96,66,0,8,59,18,21,2,28,64,75,97,32,80,86,97,97,55,2,73,75,11,89,67,58,70,76,12,46,64,17,22,97,25,35,93,57,82,46,57,61,31,74,27,4,32,85,53,86,53,53,42,5,28,50,65,63,70,61,73,37,13,80,7,34,22,3,26,6,62,78,12,56,87,41,58,64,31,27,45,35,18,66,62,43,89,69,94,93,33,74,2,43,85,37,82,41,74,9,15,44,33,42,65,19,1,49,78,12,29,9,78,7,55,12,45,40,33,16,86,14,52,16,73,76,0,98,75,91,78,46,99,95,90,69,78,45,62,55,37,88,49,77,27,83,38,73,39,1,75,40,65,83,54,95,7,73,4,30,26,36,89,21,5,95,11,14,87,45,36,21,77,55,5,66,51,98,48,62,74,58,23,82,30,28,19,53,89,76,98,8,34,70,28,54,16,52,35,93,54,54,72,49,18,93,72,90,71,73,15,60,38,80,76,53,70,39,69,25,5,31,61,46,6,54,34,31,52,33,36,79,76,44,29,28,38,1,66,2,90,91,1,76,78,31,55,37,71,2,3,38,85,0,95,42,2,39,57,87,61,77,98,2,24,80,48,27,47,71,15,7,49,60,86,3,2,29,38,54,36,59,83,27,47,9,36,42,8,73,85,9,16,73,60,39,12,43,25,23,29,28,47,40,77,20,89,22,30,41,59,96,19,56,20,76,73,39,46,72,40,47,37,52,29,79,37,39,50,41,87,66,17,75,31,45,26,88,70,11,90,40,74,9,32,65,72,61,6,93,54,15,84,22,99,47,10,96,4,84,19,85,73,45,25,16,8,94,99,39,28,26,68,87,48,1,65,86,46,86,7,60,82,45,75,38,56,41,35,30,86,91,97,85,45,5,14,69,85,96,37,18,26,16,38,16,1,44,94,85,58,60,20,5,47,52,41,50,71,43,42,67,64,38,65,83,99,78,96,33,20,98,24,6,2,25,16,16,44,63,24,68,56,49,91,15,59,99,27,43,34,28,36,45,1,10,19,54,26,75,17,88,96,63,24,71,93,72,97,66,87,18,86],this.randomCache={},this.rndIndex=0}nextRandom(e){const{randomCache:t}=this;let n;return t[e]?n=t[e]:(n=this.random100.filter((t=>t<e)),t[e]=n),n[this.rndIndex++%n.length]}reset(){this.rndIndex=0}fromArray(e){return e[this.nextRandom(e.length)]}randomArray(e,t){const n=[],r=this.nextRandom(t+1),s={};for(let t=0,i=this.nextRandom(e.length);t<r;t++){for(;s[i];)i=this.nextRandom(e.length);s[i]=!0,n.push(e[i])}return n}}kd._$name="RandomGenerator";const Id=["Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.","Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.","Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.","Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.","Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.","Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui atione voluptatem sequi nesciunt.","Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem.","Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur?","Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?"];class Rd{static reset(){this.rnd.reset(),this.rndTime.reset(),this.rndRating.reset()}static rnd=new kd;static rndTime=new kd;static rndRating=new kd;static rndText=new kd;static get cities(){return["Stockholm","Barcelona","Paris","Dubai","New York","San Francisco","Washington","Moscow"]}static get firstNames(){return["Mike","Linda","Don","Karen","Doug","Jenny","Daniel","Melissa","John","Jane","Theo","Lisa","Adam","Mary","Barbara","James","David"]}static get surNames(){return["McGregor","Ewans","Scott","Smith","Johnson","Adams","Williams","Brown","Jones","Miller","Davis","More","Wilson","Taylor","Anderson","Thomas","Jackson"]}static get teams(){return["Lions","Eagles","Tigers","Horses","Dogs","Cats","Panthers","Rats","Ducks","Cougars","Hens","Roosters"]}static get foods(){return["Pancake","Burger","Fish n chips","Carbonara","Taco","Salad","Bolognese","Mac n cheese","Waffles"]}static get colors(){return["Blue","Green","Red","Yellow","Pink","Purple","Orange","Teal","Black"]}static get skills(){return["JavaScript","CSS","TypeScript","React","Vue","Angular","Java","PHP","Python","C#","C++","BASIC","COBOL","FORTRAN","PASCAL","SQL"]}static get tasks(){return["Meetings","Documentation","Email communication","Project management","Budgeting","Marketing and advertising","Customer service","Research and analysis","Data entry","IT support","Employee management","Sales and business development","Event planning","Graphic design","Writing and editing","Presentation","Travel arrangements and expense management","Training and development","Quality assurance","Customer support","Technical writing","Social media management","Translation","Legal research","Data analysis and visualization","Video editing and production","Network admin","Content creation","Market research","Public relations","Teaching and training","Recruiting","Product development"]}static*generate(e,t=!1,n=1){let r,s;"object"==typeof e&&(t=e.randomHeight,n=e.initialId??1,r=e.addSkills,s=e.rowCallback,e=e.count);const{rnd:i,rndTime:a,rndRating:o,rndText:l,firstNames:c,surNames:d,teams:u,foods:h,colors:g,cities:m,skills:p}=this;for(let v=0;v<e;v++){var f;const y=i.fromArray(c),b=i.fromArray(d),C=`${y} ${String.fromCharCode(65+v%25)} ${b}`,S=i.nextRandom(60)+1,w=new Date(2019,0,S),D=new Date(2019,0,S+i.nextRandom(30)+2),T={id:n>-1?v+n:void 0,title:"Row "+v,name:C,firstName:y,surName:b,city:i.fromArray(m),team:i.fromArray(m)+" "+i.fromArray(u),age:10+i.nextRandom(80),food:i.fromArray(h),color:i.fromArray(g),score:10*i.nextRandom(100),rank:i.nextRandom(100)+1,start:w,finish:D,time:Bt.getTime(a.nextRandom(24),5*a.nextRandom(12)),percent:i.nextRandom(100),done:i.nextRandom(100)<50,rating:o.nextRandom(5),active:S>30,relatedTo:Math.min(e-1,v+n+i.nextRandom(10)),notes:Id[l.nextRandom(7)+1]};r&&(T.skills=i.randomArray(p,"number"==typeof r?r:7));const E=null===(f=s)||void 0===f?void 0:f(T);E&&Object.assign(T,E),t&&(T.rowHeight=5*i.nextRandom(!0===t?20:t)+20),yield T}}static generateData(e,t=!1,n=1,r=!0){let s=e;"object"!=typeof e&&(s={count:e,randomHeight:t,initialId:n,reset:r}),!1!==s.reset&&this.reset(),Rd.overrideRowCount&&(s.count=Rd.overrideRowCount);const i=[],a=this.generate(s);for(let e=0;e<s.count;e++)i.push(a.next().value);return i}static generateEvents({viewStartDate:e,viewEndDate:t,nbrResources:n=50,nbrEvents:r=5,dependencies:s,tickUnit:i="days",minDuration:a=2,maxDuration:o=10,gap:l=1,eventCallback:c}){const d=this.generateData(n),u=[];let h,g;s=[];for(let t=0;t<=n;t++)for(let n=0;n<=r;n++){const r=Math.round(Math.random()*(o-1-a))+a,d=u.length+1;h=0===n?Bt.add(e,Math.round(3*Math.random())*l,i):Bt.add(g,l,i),g=Bt.add(h,r,i),u.push({id:d,name:this.tasks[(t+n)%(this.tasks.length-1)],startDate:h,duration:r,endDate:g,resourceId:t}),null==c||c(u[u.length-1]),s&&t>0&&s.push({id:s.length+1,from:d-1,to:d})}return{resources:d,events:u,dependencies:s}}static generateOneEventPerTickAndResource({startDate:e,endDate:t,nbrResources:n=50,tickUnit:r="days"}){const s=this.generateData(n),i=[],a=Bt.getDurationInUnit(e,t,r);for(let t=0;t<=n;t++)for(let n=0;n<a;n++)i.push({id:i.length+1,resourceId:t,name:this.tasks[(t+n)%(this.tasks.length-1)],startDate:Bt.add(e,n,r),duration:1,durationUnit:r});return{resources:s,events:i}}static generateRow(){return Rd.generateData(1,!1,-1,!1)[0]}}Rd._$name="DataGenerator";const Md=["action","target","to","deltaX","deltaY","x","y","text"];class Od extends(Ne(Ur())){static get defaultConfig(){return{repeat:!0,outerElement:document.body,callOnFunctions:!0}}construct(e){super.construct(e);const t=this;t.widget&&(t.outerElement=t.widget.element,t.widget.playingDemo=!0),Mn.playingDemo=!0,Object.assign(t,{prevTarget:null,currentStep:0,mouse:yr.createElement({parent:t.outerElement,tag:"div",className:"simulated-mouse"}),timeoutId:null,innerIntervalId:null,mouseOutElements:[]}),t.intervalId=t.setInterval(t.nextStep.bind(t),1e3),t.outerElement.classList.add("b-playing-demo"),t.outerElement.addEventListener("click",(e=>{e.isTrusted&&t.abort()}))}doDestroy(){this.abort()}abort(e=!1){const t=this;t.mouse.style.top="-100px",t.clearInterval(t.intervalId),t.timeoutId&&t.clearTimeout(t.timeoutId),t.innerIntervalId&&t.clearInterval(t.innerIntervalId),t.outerElement.classList.remove("b-playing-demo"),t.widget&&(t.widget.playingDemo=!1),Mn.playingDemo=!1,t.trigger(e?"done":"abort")}triggerEvent(e,t,n){if(!e)return null;let r;if(t.startsWith("mouse")){const e=this.mouse.getBoundingClientRect();r=new MouseEvent(t,Object.assign({view:globalThis,bubbles:!0,cancelable:!0,clientX:e.left,clientY:e.top},n||{}))}else r=document.createEvent("Event"),r.initEvent(t,!0,!1);return e.dispatchEvent(r),r}handleMouseMove(e,t){const n=this,r=n.mouse;r.classList.add("quick"),n.mouseDown&&r.classList.add("drag");const s=vn.from(r,n.outerElement),i=s.x,a=s.y;let o=0,l=0;if(e.to)if("string"==typeof e.to){const t=n.outerElement.querySelector(e.to);if(t){const e=vn.from(t,n.outerElement),r=e.x+e.width/2,s=e.y+e.height/2;o=(r-i)/10,l=(s-a)/10}}else e.to.x?o=(e.to.x-i)/10:(o=e.to[0]/10,l=e.to[1]/10);else e.deltaX?o=e.deltaX/10:e.x&&(o=(e.x-i)/10);e.deltaY&&(l=e.deltaY/10);let c=0;n.innerIntervalId=n.setInterval((()=>{if(n.shouldPause)return;9==c++&&(clearInterval(n.innerIntervalId),e.then&&e.then());const t=i+o*c,s=a+l*c;r.style.left=t+"px",r.style.top=s+"px";const d=r.getBoundingClientRect(),u=d.left,h=d.top,g=yr.elementFromPoint(u,h);g!==n.prevTarget&&(n.prevTarget&&(n.mouseOutElements.push(n.prevTarget),yr.isDescendant(n.mouseOutElements[0],g)||(n.mouseOutElements.forEach((e=>n.triggerEvent(e,"mouseout"))),n.mouseOutElements.length=0)),n.prevTarget=g,n.triggerEvent(g,"mouseover")),n.triggerEvent(g,e.action,{clientX:u,clientY:h})}),50)}getTarget(e){const t=this,n=e.target;return n?"function"==typeof n?n(e):document.querySelector(n):t.prevTarget||t.outerElement}normalizeStep(e){if(e.action)return"function"==typeof e.action?e.action(e):e;if("function"==typeof e)return e(),e;for(const t in e)Object.hasOwnProperty.call(e,t)&&!Md.includes(t)&&(e.action=t.toLowerCase(),e.to=e[t]);return e.target||"string"!=typeof e.to&&"function"!=typeof e.to||(e.target=e.to),e}get isScrolling(){const e=this,t=e.outerElement.getBoundingClientRect(),n=e.lastTop&&t.top!==e.lastTop;return e.lastTop=t.top,n}get isInView(){const e=this.outerElement.getBoundingClientRect();return e.top<globalThis.innerHeight&&e.bottom>0}get shouldPause(){return!this.isInView||this.isScrolling||document.hidden||!document.hasFocus()}nextStep(){const e=this;if(e.shouldPause)return;if(e.currentStep===e.steps.length){if(!e.repeat)return e.abort(!0);e.currentStep=0}0===e.currentStep&&e.trigger("initialize");const t=e.mouse,n=e.normalizeStep(e.steps[e.currentStep++]),r=e.getTarget(n),s=n.action;if(r&&s)if(t.className="simulated-mouse","mousemove"===s)e.handleMouseMove(n,r);else{if(r!==e.prevTarget){const n=vn.from(r,e.outerElement);t.style.left=n.x+n.width/2+"px",t.style.top=n.y+n.height/2+"px"}"mousedown"===s&&(e.mouseDown=!0),"mouseup"===s&&(e.mouseDown=!1),e.timeoutId=e.setTimeout((()=>{if(e.prevTarget=r,t.classList.add(s),"type"===s){const e=il.fromElement(r),t=n.text.split("|");e.value=t[1===t.length||e.value!=t[0]?0:1]}else e.triggerEvent(r,s)}),"type"===s?100:550)}}}Od._$name="DemoBot";const Ad=Object.hasOwn||((e,t)=>Object.prototype.hasOwnProperty.call(e,t));let Fd=null;class Pd{constructor(e){this.formatter=e}format(e){return this.formatter.defaultFormat(e)}parse(e,t){return this.formatter.defaultParse(e,t)}resolvedOptions(){return null}}class Ld{static standardOptions=Object.freeze([]);static get(e){if(null==e)return this.NULL;if(e instanceof this)return e;const t="string"==typeof e?e:JSON.stringify(e),n=this.cache;let r=n.get(t);return r||(Fd=t,r=new this(e),n.set(t,r)),r}static get cache(){return Ad(this,"_cache")&&this._cache||(this._cache=new Map)}static get NULL(){return Ad(this,"_null")?this._null:this._null=new this(null)}constructor(e){const t=this,{standardOptions:n}=t.constructor;if(t.cacheKey=Fd,Fd=null,t.initialize(),null===e)t.formatter=new Pd(t);else{t.configure(e);for(const[e,r]of Object.entries(t.resolvedOptions()))null!=r&&n.includes(e)&&(t[e]=r)}}get parser(){return e=this,t=new this.constructor.Parser(this),Object.defineProperty(e,"parser",{value:t}),t;var e,t}defaultFormat(e){return null==e?e:String(e)}defaultParse(e){return e}format(e){return null==e?e:this.formatter.format(e)}parse(e,t){return null==e?e:this.parser.parse(e,t)}parseStrict(e){return this.parse(e,!0)}resolvedOptions(){return this.formatter.resolvedOptions()}}Ld._$name="Formatter";class $d extends(ue.mixin(Ne,fs)){static get $name(){return"Navigator"}static get type(){return"navigator"}static get configurable(){return{ownerCmp:null,itemsTabbable:null,target:null,keyEventTarget:null,processEvent:null,itemSelector:null,activeItem:null,focusCls:"b-active",keys:null,allowCtrlKey:null,allowShiftKey:null,scrollDuration:50,disabled:null,datasetIdProperty:"id",testConfig:{scrollDuration:1}}}static get factoryable(){return{defaultType:"navigator"}}get activeItem(){const{_activeItem:e}=this;if(this.target.contains(e))return e;this._activeItem=null}updateOwnerCmp(e){this.itemSelector||(this.itemSelector=`.${this.ownerCmp.itemCls}`),yr.setAttributes(this.keyEventTarget,{"aria-activedescendant":`${this.owner.id}-active-descendant`})}set navigationEvent(e){const{owner:t}=this;this._navigationEvent=t.navigationEvent=e,e&&Promise.resolve(1).then((()=>this.navigationEvent=null))}get navigationEvent(){return this._navigationEvent}static getComposedKeyName(e){const t=(e.key||"").trim()||e.code;return`${e.ctrlKey?"CTRL+":""}${e.shiftKey?"SHIFT+":""}${e.altKey?"ALT+":""}${t}`}onKeyDown(e){const t=this,{ownerCmp:n,itemSelector:r,activeItem:s,itemsTabbable:i}=t,{target:a}=e,o=t.target.querySelector(r),l=(e.key||"").trim()||e.code,c=t.constructor.getComposedKeyName(e),d=a.matches(r)||a===t.keyEventTarget;if(!t.disabled&&t.processEvent&&(e=t.processEvent.call(n,e)),e&&!t.disabled&&o&&t.target.offsetParent&&d){if(!i){if(null==t.inlineFlow){const e=o.parentNode,n=yr.getStyleValue(o,"position"),r=yr.getStyleValue(o,"display"),s=yr.getStyleValue(o,"float");t.inlineFlow="absolute"===n||"inline"===r||"inline-block"===r||"left"===s||"right"===s||"flex"===yr.getStyleValue(e,"display")&&"row"===yr.getStyleValue(e,"flex-direction")}t.prevKey||(t.inlineFlow?(t.prevKey="ArrowLeft",t.nextKey="ArrowRight"):(t.prevKey="ArrowUp",t.nextKey="ArrowDown"))}if(t.navigationEvent=e,s)switch(l){case t.prevKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),e.handled=!0,t.navigatePrevious(e);break;case t.nextKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),e.handled=!0,t.navigateNext(e);break;default:{var u;const r=null===(u=t.keys)||void 0===u?void 0:u[c];if(r&&!t.disabled){if(!1===t.callback(r,t.thisObj||n,[e]))return}else n.onInternalKeyDown&&n.onInternalKeyDown(e);if(yr.getActiveElement(a)!==a&&e.preventDefault(),i)return}}else{if(i)return;l!==t.nextKey&&l!==t.prevKey||(t.activeItem=t.getDefaultNavigationItem(e))}t.activeItem!==s&&t.triggerNavigate(e)}}getDefaultNavigationItem(e){const{target:t,itemSelector:n,prevKey:r,nextKey:s}=this;return 4&t.compareDocumentPosition(e.target)&&e.key===r?t.querySelector(`${n}:last-of-type`):2&t.compareDocumentPosition(e.target)&&e.key===s?t.querySelector(`${n}`):void 0}navigatePrevious(e){const t=this,n=t.previous;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((()=>{t.activeItem=n,t.triggerNavigate(e)}))}navigateNext(e){const t=this,n=t.next;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((()=>{t.activeItem=n,t.triggerNavigate(e)}))}get owner(){return this.ownerCmp}get previous(){return this.getAdjacent(-1)}get next(){return this.getAdjacent(1)}getAdjacent(e=1,t=this.activeItem){const n=this.treeWalker;if(n.currentNode=t,n[e<0?"previousNode":"nextNode"](),n.currentNode!==this.activeItem)return n.currentNode}onTargetFocusIn(e){const t=this,{target:n,relatedTarget:r}=e,{owner:s,itemsTabbable:i,skipScrollIntoView:a,previousActiveItem:o}=t;if(!n.matches(".b-focus-trap"))if(n.matches(t.itemSelector))t.skipScrollIntoView=!0,t.activeItem=n,t.skipScrollIntoView=a,t.activeItem&&i&&t.triggerNavigate(e);else if(n===t.target){var l;if((r?n.compareDocumentPosition(r):0)&Node.DOCUMENT_POSITION_CONTAINED_BY)null===(l=s.previousSibling)||void 0===l||l.focus();else t.activeItem=o&&t.target.contains(o)?o:0}}onTargetFocusOut(e){const t=this,{relatedTarget:n}=e;null!=n&&n.matches(".b-focus-trap")||n&&t.target.contains(n)&&n.matches(t.itemSelector)||t.activeItem&&(t.activeItem=null,t.itemsTabbable&&t.triggerNavigate(e))}onTargetMouseDown(e){const t=this,n=e.target.closest(t.itemSelector);t.navigationEvent=e,t.itemsTabbable?n===t.activeItem&&t.triggerNavigate(e):!1===t.ownerCmp.itemsFocusable?t.onFocusGesture(e):n&&(e.preventDefault(),yr.focusWithoutScrolling(n))}onTargetClick(e){var t;const n=this,{skipScrollIntoView:r}=n;n.skipNextClick||null!==(t=n.navigationEvent)&&void 0!==t&&t.ignoreNavigation?n.skipNextClick=!1:n.disabled||(n.skipScrollIntoView=!0,n.processEvent&&(e=n.processEvent.call(n.ownerCmp,e)),e&&(n.activeItem=e.target.closest(n.itemSelector),n.triggerNavigate(e)),n.skipScrollIntoView=r)}onFocusGesture(e){(e.target===this.ownerCmp.contentElement||e.target.closest(this.itemSelector)&&!1===this.ownerCmp.itemsFocusable)&&e.preventDefault()}acceptNode(e){return e.offsetParent&&e.matches&&e.matches(this.itemSelector)?yr.NodeFilter.FILTER_ACCEPT:yr.NodeFilter.FILTER_SKIP}changeActiveItem(e){return null!=e&&this.ownerCmp.getItem&&(e=this.ownerCmp.getItem(e)),e}updateActiveItem(e,t){const n=this,{ownerCmp:r}=n,s=t&&n.target.contains(t),i=e&&yr.isFocusable(e)&&e!==yr.getActiveElement(e);if(s&&(n.previousActiveItem=t),t&&(t.classList.remove(n.focusCls),t.removeAttribute("id")),null!=e){var a;if(n.skipScrollIntoView)i&&yr.focusWithoutScrolling(e);else null===(a=r.scrollable)||void 0===a||a.scrollIntoView(e,{block:"nearest",focus:i,silent:n.scrollSilently});if(e===t&&s)return;e.classList.add(n.focusCls),e.id=`${n.owner.id}-active-descendant`,n._activeItem=e}else n._activeItem=null,t===yr.getActiveElement(t)&&r.revertFocus()}updateTarget(e,t){const n=this,r={element:e,thisObj:n,focusin:"onTargetFocusIn",focusout:"onTargetFocusOut",mousedown:{handler:"onTargetMouseDown",delegate:n.itemSelector}};n.itemsTabbable||n.itemsFocusable||(r.click="onTargetClick"),Object.prototype.hasOwnProperty.call(n,"acceptNode")||(n.acceptNode=n.acceptNode.bind(n),n.acceptNode.acceptNode=n.acceptNode),Mn.on(r),n.treeWalker=n.setupTreeWalker(e,yr.NodeFilter.SHOW_ELEMENT,n.acceptNode),n.keyEventTarget||(n.keyEventTarget=e),(n.targetMutationMonitor=new MutationObserver(n.onTargetChildListChange.bind(n))).observe(e,{childList:!0,subtree:!0})}setupTreeWalker(e,t,n){return document.createTreeWalker(e,t,n)}onTargetChildListChange(){const e=this,{activeItem:t,datasetIdProperty:n}=e;var r;t&&(e.target.contains(t)?t.classList.contains(e.focusCls)||t.classList.add(e.focusCls):e.activeItem=e.target.querySelector(`${e.itemSelector}.${e.focusCls}[data-${T.hyphenate(n)}="${t.dataset[n]}"]`)||(null===(r=e.target.querySelector(`${e.itemSelector}.${e.focusCls}`))||void 0===r?void 0:r[t.dataset.index])||null)}changeKeyEventTarget(e){this._keyEventTarget=e,Mn.on({element:e,keydown:"onKeyDown",thisObj:this})}triggerNavigate(e,t=this.activeItem){var n;const r={event:e,item:t,oldItem:this.previousActiveItem};this.trigger("navigate",r),null===(n=this.ownerCmp)||void 0===n||n.trigger("navigate",r)}}$d._$name="Navigator";const _d=T.escapeRegExp,Nd=/[\d+-]/g,jd=(e,t)=>new Intl.NumberFormat(e||void 0,t),Vd=/^(?:([$])\s*)?(?:(\d+)>)?\d+(,\d+)?(?:\.((\d*)(?:#*)|[*]))?(?:\s*([%])?)?$/;class Bd extends Ld{static get $name(){return"NumberFormat"}static standardOptions=["currency","currencyDisplay","locale","maximumFractionDigits","minimumFractionDigits","minimumIntegerDigits","maximumSignificantDigits","minimumSignificantDigits","style","useGrouping"];initialize(){this._as={},this.is={decimal:!1,currency:!1,percent:!1,null:!0,from:null}}get truncator(){const e=this.maximumFractionDigits,t=Math.min(20,e+1);return null==e?null:this.as({style:"decimal",maximumFractionDigits:t,minimumFractionDigits:t},"truncator")}configure(e){"string"!=typeof e?Object.assign(this,e):this.template=e;const t=this,n={},r=t.locale?Ue.locales[t.locale]:Ue.locale,s=null==r?void 0:r.NumberFormat,{template:i}=t,{standardOptions:a}=t.constructor;if(s)for(const e in s)null==t[e]&&"function"!=typeof s[e]&&(t[e]=s[e]);if(i){const e=Vd.exec(i),n=e[2],r=e[4];t.useGrouping=!!e[3],t.style=e[1]?"currency":e[6]?"percent":"decimal",n&&(t.integer=+n),"*"===r?t.fraction=[0,20]:null!=r&&(t.fraction=[e[5].length,r.length])}t._minMax("fraction",!0,!0),t._minMax("integer",!0,!1),t._minMax("significant",!1,!0);for(const e of a)null!=t[e]&&(n[e]=t[e]);t.is.from=t.from&&t.from.is,t.is[t.style]=!(t.is.null=!1),t.formatter=jd(t.locale,n)}as(e,t=null){const n=this.resolvedOptions()||{template:"9.*"},r=this._as;let s=t&&r[t];return s||("string"==typeof e?n.style=e:Object.assign(n,e),n.from=this,s=new Bd(n)),t&&(r[t]=s),s}defaultParse(e,t){return null==e?e:t?Number(e):parseFloat(e)}format(e){if("string"==typeof e){const t=Number(e);e=isNaN(t)?this.parse(e):t}return super.format(e)}round(e){return this.parse(this.format(e))}truncate(e){const t=this,n=t.maximumFractionDigits,{truncator:r}=t;let s,i=t.parse(e);return r&&(i=r.format(i),s=i.indexOf(r.parser.decimal),s>-1&&i.length-s-1>n&&(i=i.slice(0,s+n+1)),i=r.parse(i)),i}resolvedOptions(){const e=super.resolvedOptions();for(const t in e)void 0===e[t]&&(e[t]=this[t]);return e}_minMax(e,t,n){const r=this,s=r[e];if(null!=s){const i=T.capitalize(e),a=`maximum${i}Digits`,o=`minimum${i}Digits`;"number"==typeof s?(t&&(r[o]=s),n&&(r[a]=s)):(r[o]=s[0],r[a]=s[1])}}}Bd.Parser=class{constructor(e){const t=this,n=e.locale,r=jd(n,{maximumFractionDigits:3}),s=e.is.currency?t._decodeStyle(n,{style:"currency",currency:e.currency,currencyDisplay:e.currencyDisplay}):null,i=e.is.percent?t._decodeStyle(n,{style:"percent"}):null,a=r.format(1.2).replace(Nd,"")[0],o=r.format(1e9).replace(Nd,"")[0]||"";Object.assign(t,{currency:s,decimal:a,formatter:e,grouper:o,percent:i}),t.decimal=a,t.decimalRe=_d(a,"g"),t.grouper=o,t.stripRe=new RegExp(`(?:\\s+|${_d(o)})`+(s?`|(?:${_d(s.text)})`:"")+(i?`|(?:${_d(i.text)})`:""),"g")}decimalPlaces(e){const t=(e=e.replace(this.stripRe,"")).indexOf(this.decimal)+1;return t&&e.length-t}parse(e,t){return"string"==typeof e&&(e=e.replace(this.stripRe,"").replace(this.decimalRe,".").replace("","-"),e=t?Number(e):parseFloat(e),this.formatter.is.percent&&(e/=100)),e}_decodeStyle(e,t){const n=jd(e,t),r=jd(e,Object.assign(n.resolvedOptions(),{style:"decimal"})),s=n.format(0),i=r.format(0);return{suffix:s.startsWith(i),text:s.replace(i,"").trim()}}},Object.assign(Bd.prototype,{currency:null,currencyDisplay:"symbol",fraction:null,from:null,integer:null,locale:null,maximumFractionDigits:null,minimumFractionDigits:null,minimumIntegerDigits:null,maximumSignificantDigits:null,minimumSignificantDigits:null,significant:null,style:"decimal",template:null,useGrouping:!0}),Ld.number=(e,t)=>Bd.get(e).format(t),Bd._$name="NumberFormat";class zd extends(Ne(ue)){static webSocketImplementation="undefined"==typeof WebSocket?null:WebSocket;static configurable={address:"",userName:"User",autoConnect:!0};construct(e={}){const t=this;super.construct(e),t.onWsOpen=t.onWsOpen.bind(t),t.onWsClose=t.onWsClose.bind(t),t.onWsMessage=t.onWsMessage.bind(t),t.onWsError=t.onWsError.bind(t),t.autoConnect&&t.address&&t.open()}doDestroy(){const e=this;e.connector&&(e.detachSocketListeners(e.connector),e.connector.close(),e.connector=null),super.doDestroy()}get isConnecting(){var e;return(null===(e=this.connector)||void 0===e?void 0:e.readyState)===this.constructor.webSocketImplementation.CONNECTING}get isOpened(){var e;return(null===(e=this.connector)||void 0===e?void 0:e.readyState)===this.constructor.webSocketImplementation.OPEN}get isClosing(){var e;return(null===(e=this.connector)||void 0===e?void 0:e.readyState)===this.constructor.webSocketImplementation.CLOSING}get isClosed(){var e;return(null===(e=this.connector)||void 0===e?void 0:e.readyState)===this.constructor.webSocketImplementation.CLOSED}createWebSocketConnector(){const e=this.connector=new this.constructor.webSocketImplementation(this.address);this.attachSocketListeners(e)}destroyWebSocketConnector(){this.detachSocketListeners(this.connector),this.connector.close(),this.connector=null}attachSocketListeners(e){const t=this;e.addEventListener("open",t.onWsOpen),e.addEventListener("close",t.onWsClose),e.addEventListener("message",t.onWsMessage),e.addEventListener("error",t.onWsError)}detachSocketListeners(e){const t=this;e.removeEventListener("open",t.onWsOpen),e.removeEventListener("close",t.onWsClose),e.removeEventListener("message",t.onWsMessage),e.removeEventListener("error",t.onWsError)}async open(){const e=this;if(e._openPromise)return e._openPromise;if(!e.address)return void console.warn("Server me.address cannot be empty");if(e.isOpened)return!0;let t;return e.createWebSocketConnector(),e._openPromise=new Promise((n=>{t=e.ion({open(){n(!0)},error(){n(!1)}})})).then((n=>(t(),e._openPromise=null,n||e.destroyWebSocketConnector(),n))).catch((()=>{e._openPromise=null,e.destroyWebSocketConnector()})),e._openPromise}close(){this.connector&&(this.destroyWebSocketConnector(),this.trigger("close"))}send(e,t={}){var n;null===(n=this.connector)||void 0===n||n.send(JSON.stringify({command:e,...t}))}onWsOpen(e){this.trigger("open",{event:e})}onWsClose(e){this.trigger("close",{event:e})}onWsMessage(e){try{const t=JSON.parse(e.data);this.trigger("message",{data:t})}catch(e){this.trigger("error",{error:e})}}onWsError(e){this.trigger("error",{error:e})}}zd._$name="WebSocketManager";class Wd extends(ue.mixin(Ne)){hasNativeAccess=!0;_content=null;async writeText(e,t){const n=this,{_content:r}=n;if(t&&n.hasNativeAccess)try{await navigator.clipboard.writeText(e)}catch(e){n.hasNativeAccess=!1}r!==e&&(n._content=e,n.triggerContentChange(r,!1,!0))}async readText(e){const t=this,{_content:n}=t;if(e&&t.hasNativeAccess)try{const e=await navigator.clipboard.readText();return n!==e&&(t._content=e,t.triggerContentChange(n,!0)),e}catch(e){t.hasNativeAccess=!1}return n}triggerPaste(e){this.trigger("paste",{source:e,text:this._content})}triggerContentChange(e,t=!1,n=!1){this.trigger("contentChange",{fromRead:t,fromWrite:n,oldText:e,newText:this._content})}async clear(e){await this.writeText("",e)}}var Hd=e=>class extends(e||ue){static get $name(){return"Finalizable"}construct(...e){super.construct(...e),this.finalizer=null,this.finalizing=null,this.isFinalized=!1,this.isFinalizing=!1}doFinalize(){this.destroy()}finalize(){const e=this;let t=e.finalizing;return t||e.isFinalized||(e.isFinalizing=!0,e.finalizing=t=e._awaitFinalizer()),t}async _awaitFinalizer(){const e=this;try{await e.finalizer}finally{e.finalizing=null,e.isFinalized=!0,e.doFinalize()}}};const Ud=Symbol("dragAbort"),Yd=Symbol("dragInit"),qd=Symbol("dragDrag"),Kd=Symbol("dragDrop"),Gd={x:"horizontal",y:"vertical"};class Xd extends(ue.mixin(Hd,Ur,rs)){static $name="DragContext";static get configurable(){return{itemElement:null,scrollManager:null,monitoringConfig:null,source:null,target:null,targetElement:null,threshold:5,touchStartDelay:300}}static get identifiable(){return{}}construct(...e){super.construct(...e);const t=this,{event:n}=t;Object.assign(t,{altKey:null,cleaners:[],ctrlKey:null,data:new Map,element:n.target,endEvent:null,lastMoveEvent:null,metaKey:null,previousTarget:null,scrollerAction:null,shiftKey:null,state:Yd,startEvent:n,touchStartTimer:null,_valid:!0}),"touches"in n&&t.touchStartDelay&&(t.touchStartTimer=t.setTimeout((()=>t.touchStartTimer=null),t.touchStartDelay,"touchStartDelay")),Mn.on({element:globalThis,blur:"onWindowBlur",thisObj:t})}doDestroy(){const e=this,{source:t,target:n}=e;e.cleanup(),(null==n?void 0:n.dropping)===e&&(n.dropping=null),(null==t?void 0:t.dragging)===e&&(t.dragging=null),super.doDestroy()}onWindowBlur(){this.started&&this.abort()}get aborted(){return this.state===Ud}get completed(){return this.isDestroying||this.aborted||null!==this.endEvent}get pending(){return this.state===Yd}get started(){return this.state!==Yd&&!this.aborted}get valid(){return this.started&&null!=this.targetElement&&this._valid}set valid(e){this._valid=e}async get(e){if(this.aborted)throw new Error("Data is not available on aborted drag");if(!this.completed)throw new Error("Data is not available until drag completion");if(Array.isArray(e))return Promise.all(e.map((e=>this.get(e))));let t=this.data.get(e);return"function"==typeof t&&(t=await t(),this.data.set(e,t)),t}has(e){return this.data.has(e)}peek(e){if(this.aborted)throw new Error("Data is not available on aborted drag");if(Array.isArray(e))return e.map((e=>this.peek(e)));let t=this.data.get(e);return"function"==typeof t&&(t=!0),t}set(e,t){this.data.set(e,t)}changeTarget(e,t){if(e!==t){const n=this;n._target=e,n.previousTarget=t,t&&(t.dropping=null),e&&(e.dropping=n,e.dropping!==n&&(e=null,n.valid=!1)),n._target=t}return e}updateTarget(e,t){const n=this;t&&n.source.dragLeaveTarget(n,t),e&&(n.valid=!0,e.dragMove(n),n.source.dragEnterTarget(n))}updateTargetElement(e){let t,n,r,s,i;for(i=e;i;i=i.parentElement)if(n=Vi.get(i,"droppables"),n)for(s=0;s<n.length;++s)if(t=n[s],t.dropRootElement.contains(e)&&(r=t.droppableSelector,(!r||e.closest(`#${yr.getId(t.dropRootElement)} ${r}`))&&(this.target=t,this.target===t)))return}abort(){const e=this,{element:t,source:n}=e;null==t||t.getBoundingClientRect(),e.state!==Kd&&(e.state=Ud,e.cleanup()),null==n||n.endDrag(e)}begin(){const e=this,{source:t}=e,n=t.beforeDrag(e);return!1!==n&&(t.dragging=e),n}cleanup(){let e;for(;e=this.cleaners.pop();)e()}end(e){const t=this,{lastMoveEvent:n,target:r}=t,{dragSwallowClickTime:s}=t.source;t.event=t.domEvent=t.endEvent=e,t.syncFlags(),t.started&&((null==n?void 0:n.clientX)===e.clientX&&(null==n?void 0:n.clientY)===e.clientY&&(null==n?void 0:n.target)===e.target||t.track(),s&&Mn.on({element:document,capture:!0,expires:s,once:!0,click(e){e.stopPropagation()}}),t.state=Kd,r!==t.source&&(null==r||r.dragDrop(t)))}fakeKey(e,t){const n=this,{lastMoveEvent:r}=n;if(r&&n.element){let s;r.isKey=!0,"Alt"===e.key?n.altKey!==t&&(n.altKey=t,s=!0):"Control"===e.key&&n.ctrlKey!==t&&(n.ctrlKey=t,s=!0),s&&(n.event=n.domEvent=r,n.track())}}keyDown(e){this.completed||("Escape"===e.key?this.abort():this.isDragToggleKey(e.key)&&this.fakeKey(e,!0))}keyUp(e){!this.completed&&this.isDragToggleKey(e.key)&&this.fakeKey(e,!1)}getDistance(e){return Mn.getDistanceBetween(this.startEvent,e)}isDragToggleKey(e){return"Control"===e||"Alt"===e}move(e){const t=this,{target:n}=e,r=t.getDistance(e)>=t.threshold;if(t.syncFlags(),t.touchStartTimer)r&&t.abort();else if(n&&n.nodeType===Node.ELEMENT_NODE){if(r&&!t.started&&(t.event=t.domEvent=e,!1===t.start()))return void t.abort();t.started&&!t.completed&&(t.lastMoveEvent=t.event=t.domEvent=e,"touchmove"===e.type&&(e.preventDefault(),e.stopImmediatePropagation()),t.track())}}start(){const e=this,{scrollManager:t,monitoringConfig:n,source:s}=e,{draggingBodyCls:i,dragLock:a}=s,o=s.dragRootElement;if(e.state=qd,"touchstart"===e.startEvent.type&&r.isMobileSafari){for(let t=e.startEvent.target.parentElement;t;t=t.parentElement){const{style:n}=t,r=yr.getStyleValue(t,"overflow");"auto"!==r&&"scroll"!=r||(e.scrollingAncestors||(e.scrollingAncestors=[]),e.scrollingAncestors.push([t,n.overflow,n.overflowX,n.overflowY]),n.overflow="hidden")}e.requestAnimationFrame((()=>{e.scrollingAncestors.forEach((([{style:e},t,n,r])=>{e.overflow=t,e.overflowX=n,e.overflowY=r})),e.scrollingAncestors=null}))}if(t){const r=t.startMonitoring(F.merge({scrollables:[{element:o}],direction:Gd[a]||a||"both",callback(t){const{lastMoveEvent:n}=e;n&&e.element&&(n.isScroll=!0,e.event=e.domEvent=n,e.scrollerAction=t,e.track(),e.scrollerAction=null)}},n));e.cleaners.push(r)}const l=s.dragRootElement.closest(".b-outer")||document.body;if(l.classList.add(i),e.cleaners.push((()=>l.classList.remove(i))),!1===s.startDrag(e))return e.cleanup(),!1}syncFlags(){const e=this,{event:t}=e;e.altKey=t.altKey,e.ctrlKey=t.ctrlKey||t.metaKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey}track(){const e=this,{event:t,source:n,target:r}=e;let s,i=t.target;"touchmove"===t.type&&(s=t.changedTouches[0],i=yr.elementFromPoint(s.clientX,s.clientY)),e.targetElement=i,r===e.target&&(null==r||r.dragMove(e)),n.trackDrag(e)}}Xd.prototype.STATE=Xd.STATE=Object.freeze({ABORTED:Ud,INIT:Yd,DRAGGING:qd,DROPPED:Kd}),Xd._$name="DragContext";class Zd extends(ue.mixin(fs)){static get type(){return"default"}static get configurable(){return{dragging:null}}static get factoryable(){return{defaultType:Zd}}updateDragging(e,t){t&&this.close(t),e&&this.open(e)}close(e){}open(e){}dragStart(e){this.dragging=e}dragMove(e){}dragEnd(e){this.dragging=null}}Zd.initClass(),Zd._$name="DragProxy";var Jd=e=>class extends(e||ue){static get $name(){return"Draggable"}static get configurable(){return{dragging:{$config:"nullify",value:null},draggingClsSelector:null,dragDocumentListeners:{element:document,keydown:"onDragKeyDown",keyup:"onDragKeyUp",contextmenu:"onDragContextMenu",mousemove:"onDragPointerMove",mouseup:"onDragPointerUp",pointerup:"onDragPointerUp",touchend:"onDragPointerUp",touchmove:{handler:"onDragPointerMove",passive:!1}},dragItemSelector:null,dragItemOverCls:null,dragLock:null,dragMinDistance:1,dragProxy:{$config:["lazy","nullify"],value:null},dragRootElement:{$config:"nullify",value:null},dragSameTargetDrop:!1,dragSelector:null,ignoreSelector:null,dragSwallowClickTime:50,dragThreshold:5,dragTouchStartDelay:300,dropTargetSelector:null,overItem:null,testConfig:{dragSwallowClickTime:50}}}static get properties(){return{draggingCls:"b-draggable-active",draggingBodyCls:"b-draghelper-active",draggingItemCls:"b-dragging-item",draggingStartedCls:"b-draggable-started",draggableCls:"b-draggable"}}beforeDrag(e){const{dragRootElement:t,dragSelector:n,ignoreSelector:r}=this,s=n&&e.element.closest(n);return!n||Boolean(s&&s===t||t.contains(s)&&(!r||!e.element.matches(r)))}dragStart(e){}dragOver(e){}dragEnterTarget(e){}dragLeaveTarget(e,t){}dragDrop(e){}dragEnd(e){}get activeDrag(){const{dragging:e}=this;return null!=e&&e.started&&!e.completed?e:null}get dragEventer(){return this.trigger?this:null}get draggingClassElement(){const{draggingClsSelector:e,dragRootElement:t}=this;return e?null==t?void 0:t.closest(e):t}beginDrag(e){const{draggingCls:t,draggingClassElement:n}=this;t&&n&&(n.classList.add(t),e.cleaners.push((()=>n.classList.remove(t))))}async endDrag(e){const t=this,{dragEventer:n,dragProxy:r}=t;e.valid&&await t.dragDrop(e),t.isDestroyed||(e.pending?e.destroy():(t.dragEnd(e),null==r||r.dragEnd(e),null==n||n.trigger(e.valid?"drop":"dragCancel",{drag:e,event:e.event}),t.finalizeDrag(e)))}async finalizeDrag(e){var t;await(null===(t=e.finalize)||void 0===t?void 0:t.call(e))}moveDrag(e){if(!1!==this.dragOver(e)){const{dragEventer:t,dragProxy:n}=this;null==n||n.dragMove(e),null==t||t.trigger("drag",{drag:e,event:e.event})}}setupDragContext(e){const t=this,{dragItemSelector:n,id:r}=t,{target:s}=e;return{event:e,id:r?`${r}-drag-${t._nextDragId=(t._nextDragId||0)+1}`:null,itemElement:n?s.closest(n):s,touchStartDelay:t.dragTouchStartDelay,source:t,threshold:t.dragThreshold}}startDrag(e){const{draggingStartedCls:t,draggingClassElement:n,draggingItemCls:r,dragEventer:s,dragProxy:i}=this,{itemElement:a}=e;if(!1===(null==s?void 0:s.trigger("beforeDragStart",{drag:e,event:e.event})))return!1;t&&n&&(n.classList.add(t),e.cleaners.push((()=>n.classList.remove(t)))),r&&a&&(a.classList.add(r),e.cleaners.push((()=>a.classList.remove(r)))),null==i||i.dragStart(e);const o=this.dragStart(e);return!1!==o&&(null==s||s.trigger("dragStart",{drag:e,event:e.event})),o}trackDrag(e){var t;const{dropTargetSelector:n}=this;e.valid=!(n&&(null===(t=e.targetElement)||void 0===t||!t.closest(n))),this.moveDrag(e)}configureListeners(e){const t=Ut.assign({thisObj:this},this.dragDocumentListeners);return"touches"in e.startEvent?(delete t.mousemove,delete t.mouseup):(delete t.contextmenu,delete t.touchmove,delete t.touchend,delete t.pointerup),t}updateDragging(e,t){const n=this;if(e){const t=n.configureListeners(e);e.cleaners.push(Mn.on(t)),n.beginDrag(e)}else t&&t.destroy()}changeDragProxy(e,t){return Zd.reconfigure(t,e,{owner:this,defaults:{owner:this}})}updateDragRootElement(e,t){var n;const r=this,{draggableCls:s,dragItemSelector:i,onDragItemMouseMove:a}=r;if(null==t||t.classList.remove(s),null===(n=r._dragRootDetacher)||void 0===n||n.call(r),e){const t={thisObj:r,element:e,mousedown:"onDragMouseDown",touchstart:"onDragTouchStart",pointerdown:e=>{var t,n;return e.pointerId&&(null===(t=(n=e.target).releasePointerCapture)||void 0===t?void 0:t.call(n,e.pointerId))}};a&&(t.mousemove={delegate:i,handler:"onDragItemMouseMove"}),(r.dragItemOverCls||a||r.onDragItemMouseEnter||r.onDragItemMouseLeave)&&Object.assign(t,{mouseover:{delegate:i,handler:"onDragItemMouseOver"},mouseout:{delegate:i,handler:"onDragItemMouseOut"}}),e.classList.add(s),r._dragRootDetacher=Mn.on(t)}}onDragItemMouseOver(e){this.overItem=e}onDragItemMouseOut(e){this.dragging||(this.overItem=e)}changeOverItem(e){var t;return this.enterLeaveEvent=e,"mouseout"===e.type?(null===(t=e.relatedTarget)||void 0===t?void 0:t.closest(this.dragItemSelector))||null:e.target.closest(this.dragItemSelector)}updateOverItem(e,t){const n=this,{dragItemOverCls:r}=n;var s,i;t&&(r&&t.classList.remove(r),null===(s=n.onDragItemMouseLeave)||void 0===s||s.call(n,n.enterLeaveEvent,t));e&&(r&&e.classList.add(r),null===(i=n.onDragItemMouseEnter)||void 0===i||i.call(n,n.enterLeaveEvent,e))}onDragContextMenu(e){e.preventDefault()}onDragKeyDown(e){this.dragging.keyDown(e)}onDragKeyUp(e){this.dragging.keyUp(e)}onDragMouseDown(e){0===e.button&&this.onDragPointerDown(e)}onDragPointerDown(e){let{dragging:t}=this;t?t.isFinalizing||t.abort():(t=this.setupDragContext(e),t&&(t=new Xd(t),!1===t.begin()&&t.destroy()))}changeDragging(e,t){return null==t||t.destroy(),e}onDragPointerMove(e){const{dragging:t}=this;t&&!t.completed&&(null==t||t.move(e))}onDragPointerUp(e){const{dragging:t}=this;t&&!t.completed&&(t.end(e),this.endDrag(t))}onDragTouchStart(e){1===e.touches.length&&this.onDragPointerDown(e)}},Qd=e=>class extends(e||ue){static get $name(){return"Droppable"}static get configurable(){return{droppableSelector:null,dropping:null,dropRootElement:{$config:"nullify",value:null}}}get dropEventer(){return this.trigger?this:null}get droppableCls(){return"b-droppable"}dragEnter(e){var t;return null===(t=this.dropEventer)||void 0===t?void 0:t.trigger("dragEnter",{drag:e,event:e.event})}dragMove(e){var t;return null===(t=this.dropEventer)||void 0===t?void 0:t.trigger("dragMove",{drag:e,event:e.event})}dragDrop(e){var t;return null===(t=this.dropEventer)||void 0===t?void 0:t.trigger("drop",{drag:e,event:e.event})}dragLeave(e){var t;return null===(t=this.dropEventer)||void 0===t?void 0:t.trigger("dragLeave",{drag:e,event:e.event})}changeDropping(e,t){if(e!==t){const n=this;t&&(!t.aborted&&t.completed||n.dragLeave(t)),e&&(n._dropping=e,!1===n.dragEnter(e)&&(e=null),n._dropping=t)}return e}updateDropRootElement(e,t){const n=this,{droppableCls:r}=n;let s,i,a;t&&(s=Vi.get(t,"droppables"),a=!0,Array.isArray(s)&&(i=s.indexOf(n))>-1&&(s.length<2?Vi.remove(t,"droppables"):(s.splice(i,1),s.forEach((e=>{r===e.droppableCls&&(a=!1)})))),a&&t.classList.remove(r)),e&&(s=Vi.get(e,"droppables"),s?s.push(n):Vi.set(e,"droppables",[n]),e.classList.add(r))}},eu=e=>class extends(e||ue){static get $name(){return"Featureable"}static get configurable(){return{features:null}}static get declarable(){return["featureable"]}static setupFeatureable(e){const t={ownerName:"client",...e.featureable};t.factory.initClass(),Reflect.defineProperty(e,"featureable",{get:()=>t})}doDestroy(){const e=this.features;super.doDestroy();for(const n in e){var t;const r=e[n];null===(t=r.destroy)||void 0===t||t.call(r)}}hasFeature(e){var t;return Boolean(null===(t=this.features)||void 0===t?void 0:t[e])}changeFeatures(e,t){if(this.isDestroying)return;const n=this,{featureable:r}=n.constructor,s=n.$features||(n.$features=new sc({configName:"features",factory:r.factory,owner:n,ownerName:r.ownerName}));return s.update(e),t?void 0:s.target}get widgetClass(){}getCurrentConfig(e){const t=super.getCurrentConfig(e),{features:n}=t;if(n)for(const e in n)0===Object.keys(n[e]).length&&(n[e]=!0);return t}};const tu="b-hover-edge",nu="b-hover-top",ru="b-hover-right",su="b-hover-bottom",iu="b-hover-left",au={[tu]:1,[nu]:1,[ru]:1,[su]:1,[iu]:1},ou={t:[tu,nu],r:[tu,ru],b:[tu,su],l:[tu,iu],tr:[tu,nu,ru],bl:[tu,su,iu],tl:[tu,nu,iu],br:[tu,su,ru]};var lu=e=>class extends e{static $name="LoadMaskable";static get configurable(){return{loadMaskDefaults:{useTransition:!0,showDelay:1e3},loadMaskError:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},loadMask:{text:"L{GridBase.loadMask}"},syncMask:{text:"L{GridBase.syncMask}"},localizableProperties:["loadMask.text","syncMask.text"],testConfig:{loadMaskError:{icon:"b-icon b-icon-warning",autoClose:500,showDelay:0}}}}applyLoadMask(){const e=this,{loadMask:t}=e;return t&&(e.masked=Ao.mergeConfigs(e.loadMaskDefaults,t)),e.masked}applyMaskError(e){const{loadMaskError:t,masked:n}=this;return!1===t?n.hide():n&&(Ut.assign(n.errorDefaults,t),n.error=e),n}get widgetClass(){}};const cu={constructor:1,prototype:1,name:1,length:1,arguments:1,caller:1,callee:1,__proto__:1};class du{static apply(e){if(!e.target)throw new Error("Override must specify what it overrides, using static getter target");if(!e.target.class)throw new Error("Override must specify which class it overrides, using target.class");if(!this.shouldApplyOverride(e))return!1;const t=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(e.prototype);return t.splice(t.indexOf("target"),1),this.internalOverrideAll(e.target.class,t,e),this.internalOverrideAll(e.target.class.prototype,n,e.prototype),!0}static internalOverrideAll(e,t,n){Reflect.ownKeys(n).forEach((r=>{if(t.includes(r)&&!cu[r]){const t=Object.getOwnPropertyDescriptor(n,r);let s=e,i=null;for(;!i&&s;)i=Object.getOwnPropertyDescriptor(s,r),i||(s=Object.getPrototypeOf(s));i&&this.internalOverride(s,r,t,i)}}))}static internalOverride(e,t,n,r){(e._overridden=e._overridden||{})[t]=e[t],r.get?Object.defineProperty(e,t,{enumerable:!1,configurable:!0,get:n.get}):e[t]=n.value}static shouldApplyOverride(e){const t=e.target;if(!t.maxVersion&&!t.minVersion)return!0;if(!t.product)throw new Error("Override must specify product when using versioning");return(!t.maxVersion||!P[t.product].isNewerThan(t.maxVersion))&&(!t.minVersion||!P[t.product].isOlderThan(t.minVersion))}}du._$name="Override";const{defineProperty:uu}=Object,{hasOwn:hu}=Ut,gu=Symbol("fencible"),mu=[],pu=e=>Array.from(new Set(e)),fu=e=>e?pu(T.split(e)):mu,vu=(e,t,n)=>{!0===n&&(n=t),Ut.isObject(n)||(n={all:n});let r=fu(n.any);const s=fu(n.all),i=n.lock?fu(n.lock):pu(s.concat(r)),a=t+"Impl";r=r.length?r:null,!e[a]&&uu(e,a,{configurable:!0,value:e[t]}),uu(e,t,{configurable:!0,value:function(...e){const t=this,n=hu(t,gu)?t[gu]:t[gu]={},o=e=>!n[e];if(s.every(o)&&(!r||r.some(o)))try{return i.forEach((e=>n[e]=(n[e]||0)+1)),t[a](...e)}finally{i.forEach((e=>--n[e]))}}})};var yu=e=>class extends(e||ue){static $name="Fencible";static declarable=["fenced"];static setupFenced(e){let{fenced:t}=e;const n=t.static,r=[];n&&(t={...t},delete t.static,r.push([n,e])),r.push([t,e.prototype]);for(const[e,t]of r)for(const n in e)vu(t,n,e[n])}get widgetClass(){}};const bu=6e4,Cu=36e5,Su=864e5,wu=/(\d+)?:?(\d*)/;class Du{static format(e){const t=Math.floor(e/Cu),n=Math.floor(e/bu)%60;return`${t}:${n<10?"0":""}${n}`}static parse(e){const t=typeof e;if("string"===t){const t=wu.exec(e);e=Number(t[1]||0)*Cu+Number(t[2]||0)*bu}else"number"!==t?e=Bt.getTimeOfDay(e):e<=24&&(e*=Cu);return Math.min(Math.max(Math.floor(e),0),Su)}constructor(e){let t,n,r=0;null!=e&&e.isDayView?(r=e.dayStartShift,t=e.dayStartTime,n=e.dayEndTime):"number"==typeof e?r=t=n=e:e&&(r=e.startShift,t=e.timeStart,n=e.timeEnd),this.startShift=r=Du.parse(r||0),this.timeEnd=(null==n?(r+Su)%Su:Du.parse(n))||Su,this.timeStart=null==t?r:Du.parse(t)}get startHour(){return Math.floor(this.timeStart/Cu)}get endHour(){return Math.floor(this.timeEnd/Cu)}get startTimeOffsetMs(){const{startShift:e,timeStart:t}=this;return t<e?Su-e+t:t-e}get today(){return this.startOfDay(new Date)}ceil(e){const t=this.startOfDay(e);return t<e&&t.setDate(t.getDate()+1),t}contains(e){return!this.outside(e)}dateKey(e){return e=this.shiftDate(e,-1),Bt.makeKey(e)}dayOfDate(e){return this.shiftDate(Bt.clearTime(e))}dayOfWeek(e){return(e=this.shiftDate(e,-1)).getDay()}delta(e,t="ms"){const{timeStart:n}=this,r=Du.parse(e),s=(this.startShift&&r<n?r+Su:r)-n;return"ms"===t?s:Bt.as(t,s,"ms")}duration(e="ms"){const{timeStart:t,timeEnd:n}=this,r=t<n?n-t:Su-t+n;return"ms"===e?r:Bt.as(e,r,"ms")}equals(e){return this.startShift===(null==e?void 0:e.startShift)&&this.timeStart===e.timeStart&&this.timeEnd===e.timeEnd}intersects(e,t){const n=this,{timeStart:r,timeEnd:s}=n,[i,a]=n._dateRangeArgs(e,t),[o,l]=n.timeRange(i,a);return r<s?o<l?o<s&&r<=l:o<s||r<=l:!(o<l)||o<s||r<=l}isIntraDay(e,t){const[n,r]=this._dateRangeArgs(e,t),s=this.startOfDay(n),i=Su-Bt.diff(s,r,"ms");return!(i<0)&&(i>0||s<n)}isInterDay(e){return e.allDay||!this.isIntraDay(...arguments)}outside(e){const{startShift:t,timeStart:n,timeEnd:r}=this,s=Du.parse(e);return n<r?s<n?s<t?1:-1:s<r?0:s<t?-1:1:s<r||s>=n?0:s<t?1:-1}parseKey(e){return this.dayOfDate(Bt.parseKey(e))}shiftDate(e,t=1){const{startShift:n}=this,r=typeof e;return e="number"===r?new Date(e):"string"===r?Bt.parse(e):new Date(e.getTime()),t&&n&&e.setMilliseconds(t>0?n:-n),e}sortEvents(e,t){const n=this.startOfDay(e);return null==t?void 0:t.sort(((e,t)=>{e=e.eventRecord||e,t=t.eventRecord||t;let{startDate:r}=e,{startDate:s}=t;return r?s?(r=r<n?n:r,s=s<n?n:s,r-s||t.endDate-s-(e.endDate-r)):1:-1}))}startOfDay(e){return e=this.shiftDate(e,-1),e=Bt.clearTime(e),e=this.shiftDate(e)}timeRange(e,t){const[n,r]=this._dateRangeArgs(e,t);return[Bt.getTimeOfDay(n),Bt.getTimeOfDay(r)]}toString(){const{startShift:e,timeEnd:t,timeStart:n}=this,r=e?`@${Du.format(e)}`:"",s=Du.format(n);return n===t?e?r:s:`${s}-${Du.format(t)}${r}`}_dateRangeArgs(e,t){return e.isModel?[e.startDate,e.endingDate]:[e,t]}}Du.MIDNIGHT=new Du({startShift:0,timeStart:0,timeEnd:24}),Du.MILLIS_PER_MINUTE=bu,Du.MILLIS_PER_HOUR=Cu,Du.MILLIS_PER_DAY=Su,Du._$name="DayTime";class Tu extends(Ne(ue)){static $name="Month";static get configurable(){return{date:{$config:{equal:"date"},value:Bt.clearTime(new Date)},month:null,year:null,weekStartDay:null,hideNonWorkingDays:null,nonWorkingDays:null,sixWeeks:null}}configure(e){super.configure(e),this.updateDayNumbers(),e.date&&(this.date=e.date),this.generation=0}changeDate(e){if(!this.isConfiguring){if(e="string"==typeof e?Bt.parse(e,"YYYY-MM-DD"):new Date(e),isNaN(e))throw new Error("Month date ingestion must be passed a Date, or a valid YYYY-MM-DD date string");return e}}updateDate(e,t){const n=this,{dayColumnIndex:r,weekCount:s}=n,i=Bt.getFirstDateOfMonth(e),a=Bt.getLastDateOfMonth(i),o=r[i.getDay()],l=r[a.getDay()],c=!t||e.getFullYear()!==t.getFullYear(),d=!t||e.getMonth()!==t.getMonth(),u=n.eventListeners&&(t?e.getDate()!==t.getDate()|(n.getWeekId(e)!==n.getWeekId(t))<<1|d<<2|c<<3:15);if(n._year=e.getFullYear(),n._month=e.getMonth(),n.startDayOfMonth=1-o,n.endDayOfMonth=a.getDate()+(6-l),n.sixWeeks&&(n.endDayOfMonth+=7*(6-n.weekCount)),n.weekBase&&!c||n.calculateWeekBase(),(d||c)&&n.generation++,u){const r={newDate:e,oldDate:t,changes:{d:!0,w:Boolean(2&u),m:Boolean(12&u),y:Boolean(8&u),r:n.weekCount!==s}};n.trigger("dateChange",r),2&u&&n.trigger("weekChange",r),12&u&&n.trigger("monthChange",r),8&u&&n.trigger("yearChange",r)}}calculateWeekBase(){const e=this,{dayColumnIndex:t}=e,n=new Date(e.year,0,1),r=new Date(e.year,11,31),s=e.month?e.getOtherMonth(n):e;e.dayColumnIndex[n.getDay()]>3?e.weekBase=s.startDate:e.weekBase=new Date(e.year,0,s.startDayOfMonth-7);const i=Math.floor(Bt.diff(e.weekBase,r,"day")/7);e.has53weeks=53===i&&t[r.getDay()]>2}getWeekStart(e){if("number"==typeof e)return Bt.add(this.weekBase,7*Math.max(e,1),"day");const t=this,[n,r]=e;return n===t.year?t.getWeekStart(r):t.getOtherMonth(new Date(n,0,1)).getWeekStart(r)}getOtherMonth(e){const t=this,n=t===Eu?new Tu(null):Eu;return n.configure({weekBase:null,weekStartDay:t.weekStartDay,nonWorkingDays:t.nonWorkingDays,hideNonWorkingDays:t.hideNonWorkingDays,sixWeeks:t.sixWeeks,date:new Date(e.getFullYear(),0,1)}),n.date=e,n.updateDate(n.date,n.date),n}changeYear(e){const t=new Date(this.date);t.setFullYear(e),this.date=t}changeMonth(e){const t=new Date(this.date);t.setMonth(e),this.date=t}get weekStartDay(){return"number"==typeof this._weekStartDay?this._weekStartDay:Bt.weekStartDay}updateWeekStartDay(){const e=this;e.updateDayNumbers(),!e.isConfiguring&&e.date&&(e.weekBase=null,e.updateDate(e.date,e.date))}get nonWorkingDays(){return this._nonWorkingDays||Bt.nonWorkingDays}changeNonWorkingDays(e){return Ut.assign({},e)}updateNonWorkingDays(){this.updateDayNumbers()}updateHideNonWorkingDays(){this.updateDayNumbers()}updateSixWeeks(){this.isConfiguring||this.updateDate(this.date,this.date)}get dayCount(){return this.endDayOfMonth+1-this.startDayOfMonth}get weekCount(){return this.dayCount/7}get startDate(){const e=this;if(null!=e.year&&null!=e.month&&null!=e.startDayOfMonth)return new Date(e.year,e.month,e.startDayOfMonth)}get endDate(){const e=this;if(null!=e.year&&null!=e.month&&null!=e.startDayOfMonth)return new Date(e.year,e.month,e.endDayOfMonth)}eachDay(e){for(let t=this.startDayOfMonth;t<=this.endDayOfMonth;t++)e(new Date(this.year,this.month,t))}eachWeek(e){const t=this,{weekCount:n}=t;for(let r=t.startDayOfMonth,s=0;s<n;s++){const n=[],s=t.getWeekNumber(new Date(t.year,t.month,r));for(let e=0;e<7;e++,r++)n.push(new Date(t.year,t.month,r));e(s,n)}}getWeekNumber(e){const t=this;if((e=Bt.clearTime(e)).getFullYear()!==t.year)return t.getOtherMonth(new Date(e.getFullYear(),0,1)).getWeekNumber(e);let n=Math.floor(Bt.diff(t.weekBase,e,"day")/7),r=e.getFullYear();return n?(53!==n||t.has53weeks?n>53&&(n%=52):(n=1,r++),[r,n]):t.getOtherMonth(new Date(t.year-1,0,1)).getWeekNumber(new Date(t.year,0,0))}getWeekId(e){const t=this.getWeekNumber(e);return 100*t[0]+t[1]}getCellData(e,t,n=Du.MIDNIGHT){const r=this,s=e.getDay(),i=r.visibleDayColumnIndex[s],a=r.nonWorkingDays[s],o=r.hideNonWorkingDays&&a;return(e<r.startDate||e>r.endDate)&&(r.month=e.getMonth()),{day:s,dayTime:n,visibleColumnIndex:i,isNonWorking:a,week:r.getOtherMonth(e).getWeekNumber(e),key:Bt.format(e,"YYYY-MM-DD"),columnIndex:r.dayColumnIndex[s],date:new Date(e),dayEnd:n.duration("s"),tomorrow:n.dayOfDate(Bt.add(e,1,"day")),isOtherMonth:Math.sign(e.getMonth()+12*e.getFullYear()-(t.month+12*t.year)),visible:!o&&e>=t.startDate&&e<Bt.add(t.endDate,1,"day"),isRowStart:0===i,isRowEnd:i===r.visibleColumnCount-1}}updateDayNumbers(){const e=this,{weekStartDay:t,nonWorkingDays:n,hideNonWorkingDays:r}=e,s=e.dayColumnIndex=[],i=e.canonicalDayNumbers=[],a=e.visibleDayColumnIndex=[];let o=0;for(let e=0;e<7;e++){const l=(t+e)%7;i[e]=l,s[l]=e,r&&n[l]||(a[l]=o++)}e.visibleColumnCount=o,e.weekLength=r?7-Ut.keys(n).length:7}}const Eu=new Tu(null);Tu._$name="Month";let xu=0;const ku=new WeakMap,Iu=e=>{const t=new Map;return(...n)=>{const r=((...e)=>e.map((e=>{let t;return e&&"object"==typeof e||"function"==typeof e?(t=ku.get(e),void 0===t&&(t=++xu,ku.set(e,t))):t=String(e),t})).join("-"))(n);let s=t.get(r);return void 0===s&&(s=e(...n),t.set(r,s)),s}},Ru=e=>{const t=new Map,n=e=>e[0],r=e=>e[1],s=(e,t)=>n(e).push(t);return(i,a)=>{const o=(e=>{let n=t.get(e);return void 0===n&&(n=[[],[]],t.set(e,n)),n})(i);(e=>!r(e).length&&!n(e).length)(o)?(s(o,a),e(i,(e=>{((e,t)=>r(e).some((e=>Ut.isEqual(e,t))))(o,e)||(((e,t)=>{r(e).push(t)})(o,e),n(o).forEach((t=>t(e))))}))):(s(o,a),r(o).forEach((e=>a(e))))}},Mu=Symbol("success"),Ou=Symbol("failure"),Au=(e,t)=>[Mu,e,t],Fu=e=>[Ou,e],Pu=e=>e.length&&e[0]===Mu,Lu=e=>"function"!=typeof e||e.length?e:e(),$u=Iu((e=>Ru(((t,n)=>n(Au(e,t)))))),_u=Iu((e=>Ru(((t,n)=>{const r=Math.min(e.length,t.length),s=t.substr(0,r),i=t.substr(r);n(s===e?Au(s,i):Fu(i))})))),Nu=(e,t)=>(n,r)=>Lu(e)(n,(e=>{if(Pu(e)){const[,n,s]=e;t(n)(s,r)}else r(e)})),ju=Iu(((...e)=>{const t=Iu(((e,t)=>Ru(Nu(e,(e=>Nu(t,(t=>$u([].concat(e,t)))))))));return e.reduce(t,$u([]))})),Vu=Iu(((...e)=>Ru(((t,n)=>e.forEach((e=>Lu(e)(t,n))))))),Bu=Iu((e=>(t,n)=>{const r=new RegExp(`^${e}`).exec(t);if(r){const e=r[0],s=t.substr(e.length);n(Au(e,s))}else n(Fu(t))})),zu=Iu(((e,t)=>Nu(e,((...e)=>$u(t(...[].concat.apply([],e))))))),Wu=(e,t)=>{const n=[];return e(t,(e=>{if(Pu(e)){const[,,t]=e;""===t&&n.push(e)}})),n};var Hu={memo:Iu,memoCps:Ru,success:Au,failure:Fu,isSuccess:Pu,resolveParser:Lu,succeed:$u,string:_u,bind:Nu,seq:ju,alt:Vu,regexp:Bu,red:zu,runParser:Wu,defineParser:e=>(t,n)=>n?Lu(e)(t,n):Wu(Lu(e),t)};class Uu extends(Ur(ue)){static get configurable(){return{element:null,zoneWidth:50,scrollSpeed:5,direction:"both",startScrollDelay:500,stopScrollWhenPointerOut:!1,testConfig:{scrollSpeed:2,startScrollDelay:100},activeScroll:{$config:["lazy"],value:{}},monitoring:{$config:["lazy","nullify"],value:!0},owner:null}}changeMonitoring(e,t){return null==t||t.clear(),new Map}doDestroy(){this.stopMonitoring(),super.doDestroy()}get isScrolling(){return 0!==Object.keys(this.activeScroll).length}get rtl(){var e;return null===(e=this.owner)||void 0===e?void 0:e.rtl}startMonitoring(e={}){const t=this,{element:n,direction:r}=t,{scrollables:s=[],direction:i=r,callback:a}=e,o=[];return s.length||s.push({element:n}),s.forEach((e=>{const r=e.element;"string"==typeof r?yr.forEachSelector(n,r,(n=>{t.createMonitor(n,e.direction||i,e.callback||a),o.push(n)})):(t.createMonitor(r,e.direction||i,e.callback||a),o.push(r))})),function(){var e;null===(e=t.stopMonitoring)||void 0===e||e.call(t,o)}}createMonitor(e,t,n){const{monitoring:r}=this;r.has(e)||r.set(e,new Yu({scrollManager:this,element:e,direction:t,callback:n}))}stopMonitoring(e){const t=this,{monitoring:n}=t;if(e=ge.asArray(e),n){if(!e)return void n.forEach((e=>t.stopMonitoring(e.element)));e.forEach((e=>{const t=n.get(e);e.classList.remove("b-scrolling"),t&&(t.destroy(),n.delete(e))}))}}requestScroll(e,t){const{activeScroll:n}=this;return(!(e in n)||n[e]===t)&&(n[e]=t,!0)}releaseScroll(e){const{activeScroll:t={}}=this;Object.keys(t).forEach((n=>{t[n]===e&&delete t[n]}))}getRelativeScroll(e,t="left"){let n=0;return this.monitoring.forEach(((r,s)=>{yr.isDescendant(s,e)&&(n+="left"===t?r.scrollRelativeLeft:r.scrollRelativeTop)})),n}}class Yu extends ue{construct(e){const{element:t}=e,n=t.scrollLeft,r=t.scrollTop;Object.assign(e,{startScrollLeft:n,startScrollTop:r}),super.construct(e),Mn.on({element:t,scroll:"onElementScroll",pointermove:"onMouseMove",capture:!0,thisObj:this}),Mn.on({element:t,pointerleave:"onPointerLeave",thisObj:this})}doDestroy(){this.stopScroll(),super.doDestroy()}startScroll(){const e=this;e.pendingScrollFinalize&&(e.scrollManager.releaseScroll(e),e.pendingScrollFinalize=!1),e.scrolling=!0,e.performScroll()}stopScroll(e=null){const t=this,n=()=>{t.pendingScrollFinalize=!1,t.isDestroyed||(t.scrollManager.releaseScroll(t),t.scrolling=!1)};t.scrollRequested&&(t.scrollManager.cancelAnimationFrame(t.frameId),t.scrollRequested=!1),t.scrollManager.clearTimeout(t.scrollTimeout),t.scrollTimeout=null,e||!t.ongoingScrollTop&&!t.ongoingScrollLeft?(t.ongoingScrollTop=t.ongoingScrollLeft=null,n()):(t.pendingScrollFinalize=!0,Promise.all([t.ongoingScrollTop,t.ongoingScrollLeft].filter(Boolean)).then((()=>t.pendingScrollFinalize&&n())))}onPointerLeave(){this.scrollManager.stopScrollWhenPointerOut&&this.stopScroll()}onMouseMove(e){const t=this,{scrollManager:n}=t,r=t.element.getBoundingClientRect(),s=n.zoneWidth,i=n.scrollSpeed;if(t.scrollDeltaX=t.scrollDeltaY=0,"vertical"!==t.direction){const{scrollLeft:a,scrollWidth:o,clientWidth:l}=t.element;n.rtl?e.clientX<r.left+s&&o+a-l>=1?t.scrollDeltaX=-Math.round((s+(r.left-e.clientX))/i)-1:e.clientX>r.right-s&&a<0&&(t.scrollDeltaX=Math.round((s-(r.right-e.clientX))/i)+1):e.clientX>r.right-s&&o-a-l>=1?t.scrollDeltaX=Math.round((s-(r.right-e.clientX))/i)+1:e.clientX<r.left+s&&a>0&&(t.scrollDeltaX=-Math.round((s+(r.left-e.clientX))/i)-1)}if("horizontal"!==t.direction){const{scrollTop:n,scrollHeight:a,clientHeight:o}=t.element;e.clientY>r.bottom-s&&a-n-o>=1?t.scrollDeltaY=Math.round((s-(r.bottom-e.clientY))/i)+1:e.clientY<r.top+s&&n>0&&(t.scrollDeltaY=-Math.round((s+(r.top-e.clientY))/i)-1)}0===t.scrollDeltaX||n.requestScroll("horizontal",t)||(t.scrollDeltaX=0),0===t.scrollDeltaY||n.requestScroll("vertical",t)||(t.scrollDeltaY=0),0===t.scrollDeltaX&&0===t.scrollDeltaY?t.scrolling&&t.stopScroll():t.scrollTimeout||(t.scrollTimeout=n.setTimeout((()=>t.startScroll()),n.startScrollDelay))}performScroll(){const e=this,{element:t}=e;if(e.scrolling&&!e.scrollRequested){if(0!==e.scrollDeltaX){const n=t.scrollLeft,r=Math.min(n+e.scrollDeltaX,t.scrollWidth-t.clientWidth);t.scrollLeft=r,t.scrollLeft!==n?e.ongoingScrollLeft=new Promise((e=>t.addEventListener("scroll",e,{once:!0}))):(e.ongoingScrollLeft=null,e.scrollDeltaX=0)}if(0!==e.scrollDeltaY){const n=t.scrollTop,r=Math.min(n+e.scrollDeltaY,t.scrollHeight-t.clientHeight);t.scrollTop=r,t.scrollTop!==n?e.ongoingScrollTop=new Promise((e=>t.addEventListener("scroll",e,{once:!0}))):(e.ongoingScrollTop=null,e.scrollDeltaY=0)}0!==e.scrollDeltaX||0!==e.scrollDeltaY?(e.scrollRequested=!0,e.frameId=e.scrollManager.requestAnimationFrame((()=>{e.scrollRequested=!1,e.performScroll(e)}))):e.stopScroll()}}onElementScroll(){var e,t;null===(e=this.config)||void 0===e||null===(t=e.callback)||void 0===t||t.call(this.thisObj||this.scrollManager,this)}get scrollLeft(){return this.element.scrollLeft}get scrollTop(){return this.verticalElement?this.verticalElement.scrollTop:this.element.scrollTop}get scrollRelativeLeft(){return this.scrollLeft-this.startScrollLeft}get scrollRelativeTop(){return this.scrollTop-this.startScrollTop}getRelativeLeftScroll(e){return this.scrollManager.getRelativeScroll(e,"left")}getRelativeTopScroll(e){return this.scrollManager.getRelativeScroll(e,"top")}}Uu._$name="ScrollManager";const qu={left:!0,right:!0,top:!0,bottom:!0,transform:!0},Ku={true:1,false:1},Gu=Promise.resolve();class Xu extends Uc{static $name="Tooltip";static type="tooltip";static get configurable(){return{autoHide:!0,mouseOffsetX:15,mouseOffsetY:15,html:{$config:{equals:()=>!1}},getHtml:null,forElement:null,trackMouse:null,updateContentOnMouseMove:!1,forSelector:null,hideOnDelegateChange:null,anchorToTarget:!0,showOnHover:null,hoverDelay:500,autoShow:!1,dismissDelay:0,hideDelay:500,loadingMsg:"Loading...",allowOver:null,anchor:!0,align:{align:"b-t",minHeight:300},axisLock:!0,activeTarget:null,testConfig:{hideDelay:100,hoverDelay:100,showAnimation:null,hideAnimation:null}}}afterConfigure(){const e=this,{forSelector:t}=e;t&&(e.showOnHover=!1!==e.showOnHover,e.forElement||(e.anchorToTarget||(e.trackMouse=!0),e.forElement=e.rootElement.host||e.rootElement)),super.afterConfigure(),e.forElement&&e.showOnHover&&(e.pointerOverOutDetacher=Mn.on({element:e.forElement,pointerover:"internalOnPointerOver",pointerout:"internalOnPointerOut",thisObj:e}))}doDestroy(){var e;null===(e=this.pointerOverOutDetacher)||void 0===e||e.call(this),super.doDestroy()}set focusOnToFront(e){super.focusOnToFront=e}get focusOnToFront(){return super.focusOnToFront&&yr.usingKeyboard}get focusElement(){const e=super.focusElement;if(e!==this.element)return e}get anchorToTarget(){return this._anchorToTarget&&!this.trackMouse}get anchor(){return super.anchor&&!this.trackMouse}set anchor(e){super.anchor=e}onDocumentMouseDown({event:e}){const t=this,{triggeredByEvent:n}=t;n&&yr.isTouchEvent&&e.pageX===n.pageX&&e.pageY===n.pageY&&t.activeTarget.contains(e.target)&&performance.now()-n.timeStamp<500||(t.abortDelayedShow(),super.onDocumentMouseDown({event:e}))}internalOnPointerOver(e){const t=this,{target:n,relatedTarget:r}=e,{forElement:s,forSelector:i,activeTarget:a}=t;let o;if(!(t.disabled||t.owner&&!t.owner.showTooltipWhenDisabled&&t.owner.disabled||t.allowOver&&t.element.contains(n))){if(i){if(o=t.filterTarget(n),null!=a&&a.contains(n)&&a.contains(r)&&o===a)return;if(o&&(null==r?void 0:r.closest(i))===o)return}else{if(s.contains(r))return;o=s}o?t.handleForElementOver(e,o):a&&t.handleForElementOut()}}filterTarget(e){return e.closest(this.forSelector)}onTransitionEnd(e){const t=this,{currentOverElement:n}=Xu;if(qu[e.propertyName]){var r;if(t.allowOver&&t.element.contains(n))return;null!==(r=t.activeTarget)&&void 0!==r&&r.contains(n)&&!t.trackMouse&&t.realign()}}async handleForElementOver(e,t){const n=this,{activeTarget:r,hideOnDelegateChange:s,anchorToTarget:i}=n,a=t!==r,o=a&&s;if(!1===n.trigger("pointerOver",{event:e,target:t}))n.internalOnPointerOut(e);else{if(n.triggeredByEvent=e,n.hasTimeout("hide")&&(n.abortDelayedHide(),!a))return;if(!s&&n.element.classList.contains("b-hiding")&&n.cancelHideShowAnimation(),!n._hidden&&o&&n.hide(!1),n.activeTarget=t,n.isVisible){const e=n.updateContent();if(F.isPromise(e)&&!n.loadingMsg&&await e,!1===n.trigger("beforeShow"))return n.hide();n.alignTo({[i?"target":"position"]:i?t:"mouse",overlap:!(i&&n.anchor)}),n.trigger("show"),n.afterShowByTarget()}else n.delayShow(t)}}async delayShow(e){var t;const n=this;if(null!==(t=n.currentAnimation)&&void 0!==t&&t.showing&&n.cancelHideShowAnimation(),n.isVisible||n.hasTimeout("show"))n.isVisible&&n.showByTarget(e);else if(!n.hoverDelay||n.forSelector&&Date.now()-n.lastHidden<n.quickShowInterval){const t=n.updateContent();F.isPromise(t)&&!n.loadingMsg&&await t,n.showByTarget(e)}else n.addDocumentMouseDownListener(),n.listeningForMouseMove||n.anchorToTarget||(n.mouseMoveRemover=Mn.on({element:n.rootElement,mousemove:"onMouseMove",thisObj:n})),n.setTimeout((async()=>{if(n.activeTarget===e&&e.isConnected){const t=n.updateContent();F.isPromise(t)&&!n.loadingMsg&&await t,n.showByTarget(e)}}),n.triggeredByEvent&&"pointerover"!==n.triggeredByEvent.type?0:n.hoverDelay,"show")}changeAllowOver(e){return this.inAfterShow||(this.configuredAllowOver=e),e}updateAllowOver(e){const t=this,{element:n}=t;var r;(n.classList.toggle("b-allow-over",Boolean(e)),e)?t.allowOverlisteners=Mn.on({element:n,mouseenter:"onOwnElementMouseEnter",mouseleave:"internalOnPointerOut",thisObj:t}):null===(r=t.allowOverlisteners)||void 0===r||r.call(t)}updateContent(){const e=this;if(e.getHtml){const t=e.callback(e.getHtml,e,[{tip:e,element:e.element,activeTarget:e.activeTarget,event:e.triggeredByEvent}]);return e.html=t,t}}get hasContent(){return Boolean(yr.isReactElement(this._html)||""!==this._html&&"string"==typeof this.html&&this.html.length||this.items.length)}internalBeforeShow(){return(this.updateContentOnMouseMove||this.hasContent)&&!this.disabled}showAsyncMessage(e=this.optionalL(this.loadingMsg)){e&&(this.html=`\n                <div class="b-tooltip-loading">\n                    <i class="b-icon b-icon-spinner"></i>\n                    ${e}\n                </div>\n            `)}showByTarget(e){var t;const n=this,{anchorToTarget:r}=n;n.mouseMoveRemover=null===(t=n.mouseMoveRemover)||void 0===t?void 0:t.call(n),n.showBy({[r?"target":"position"]:r?e:"mouse",overlap:!(r&&n.anchor)})}afterShowByTarget(){const e=this,{dismissDelay:t}=e;e.abortDelayedShow(),t&&e.setTimeout("hide",t),e.element.parentNode&&e.toFront(),e.mouseMoveRemover||!e.trackMouse&&!e.updateContentOnMouseMove||(e.mouseMoveRemover=Mn.on({element:e.rootElement,pointermove:"onMouseMove",thisObj:e})),e.inAfterShow=!0,e.allowOver=e.allowOver||0!=e.configuredAllowOver&&e.childItems.some((e=>e.isVisible&&!e.disabled&&e.focusElement)),e.inAfterShow=!1}updateActiveTarget(e,t){e&&!this.isConfiguring&&this.trigger("overTarget",{newTarget:e,lastTarget:t})}internalOnPointerOut(e){var t;const n=this,r=e.relatedTarget;n.allowOver&&n.element.contains(r)||n.element.contains(e.target)&&null!==(t=n.activeTarget)&&void 0!==t&&t.contains(r)||n.activeTarget&&!n.activeTarget.contains(r)&&n.handleForElementOut()}handleForElementOut(){const e=this,{hideDelay:t}=e;if(!1===e.trigger("pointerOut"))return e.activeTarget=null,!0;e.abortDelayedShow(),e.isVisible&&!1!==t&&(e.abortDelayedHide(),t>0?e.setTimeout("hide",t):e.hide())}show(e){const t=this;!e&&t.forElement&&t.anchorToTarget&&!t.forSelector?t.showByTarget(t.forElement):super.show(...arguments),t.isVisible&&(t.afterShowByTarget(),!t.forElement||t.transitionEndDetacher||t._hidden||(t.transitionEndDetacher=Mn.on({element:t.forElement,transitionend:"onTransitionEnd",thisObj:t})))}get hideDelay(){return!!this.autoHide&&this._hideDelay}hide(){const e=this;if(e.abortDelayedShow(),e._hidden)return Gu;{var t,n;e.abortDelayedHide();const r=super.hide(...arguments);return e.lastHidden=Date.now(),e.activeTarget=null,null===(t=e.mouseMoveRemover)||void 0===t||t.call(e),e.mouseMoveRemover=null,null===(n=e.transitionEndDetacher)||void 0===n||n.call(e),e.transitionEndDetacher=null,r}}abortDelayedShow(){const e=this;var t,n,r;e.hasTimeout("show")&&(null===(t=e.mouseDownRemover)||void 0===t||t.call(e),e.mouseDownRemover=null,e.clearTimeout("show"),null===(n=e.mouseMoveRemover)||void 0===n||n.call(e),e.mouseMoveRemover=null,null===(r=e.transitionEndDetacher)||void 0===r||r.call(e),e.transitionEndDetacher=null)}abortDelayedHide(){this.clearTimeout("hide")}realign(){const e=this,t=e.lastAlignSpec;e.isConfiguring||e.isVisible||null==t||!t.targetOutOfView||(t.allowTargetOut||yr.isInView(t.target,!1,e))&&(e.show(),t.targetOutOfView=!1),super.realign()}alignTo(e){const t=this,n=(t.mouseOffsetX||1)*(t.rtl?-1:1),r=t.mouseOffsetY||1,s=Math.max(Math.min(n,5),0),i=Math.max(Math.min(r,5),0);if(!t.isVisible)return;let a;t.anchorToTarget||"mouse"!==e.position||(a=new yn(t.triggeredByEvent.pageX-globalThis.scrollX,t.triggeredByEvent.pageY-globalThis.scrollY),e.position=new yn(a.x+(n||1)-(n<0?t.width:0),a.y+(r||1)-(r<0?t.height:0))),!e||t.triggeredByEvent&&t.element.contains(t.triggeredByEvent.target)||e.nodeType===Node.ELEMENT_NODE&&(e={target:e}),super.alignTo(e),a&&t.lastAlignSpec.result.inflate(i,s).contains(a)&&(t.lastAlignSpec.position="mouse",t.mouseOffsetY=-r,t.mouseOffsetX=-n,t.realign(),t.mouseOffsetY=r,t.mouseOffsetX=n)}changeHtml(e){const t=this;return F.isPromise(e)?(t.showAsyncMessage(),e.target=t.activeTarget,void e.then((n=>{e.target===t.activeTarget&&(t.html=n)}))):("object"!=typeof e&&(e=null!=e?t.optionalL(String(e)):""),e)}updateHtml(e,t){const n=this;let r=""===e;r||(super.updateHtml(e,t),n.hasContent?(n.isVisible&&n.realign(),F.isPromise(e)||n.trigger("innerHtmlUpdate",{value:e})):r=!0),r&&n.hide()}onMouseMove(e){const t=this,{forElement:n,activeTarget:r}=t,s=t.hasTimeout("hide"),i=e.target;if(t.triggeredByEvent=e,!t._hidden){let a;const o=!(null==r?void 0:r.contains(i))&&t.forSelector&&r&&!s&&i.nodeType===Node.ELEMENT_NODE&&!i.matches(t.forSelector)&&!(t.allowOver&&t.element.contains(i)),l=null!=n&&n.document?n.document.documentElement:n,c=l&&(l.contains?l.contains(i):16&l.compareDocumentPosition(i));if(o&&(a=t.handleForElementOut()),a||!s||c){if(t.dismissDelay&&!s&&t.setTimeout("hide",t.dismissDelay),t.updateContentOnMouseMove&&t.getHtml&&(t.html=t.callback(t.getHtml,t,[{tip:t,element:t.element,forElement:r,event:e}]),!t.html))return void t.hide();t.trackMouse&&t.alignTo({position:"mouse",ignorePageScroll:!0})}}}onElementUserAction(e){this.internalOnPointerOver(e)}onOwnElementMouseEnter(e){this.abortDelayedHide()}static getSharedTooltip(e,t,n){var r,s;let i=null===(r=t.bryntum)||void 0===r||null===(s=r.tooltip)||void 0===s?void 0:s.get(Xu);if(!i&&!n){var a;null!==(a=t.bryntum)&&void 0!==a&&a.tooltip||Ut.setPath(t,"bryntum.tooltip",new Map);const n=t.bryntum.tooltip;n.set(Xu,!0),i=new Xu({forElement:t,rootElement:e,forSelector:"[data-btip]",resetCfg:{},isSharedTooltip:!0,cls:"b-tooltip-shared",internalListeners:{pointerOver({source:e,target:t}){for(const t in e.resetCfg)"listeners"===t?e.un(e.resetCfg[t].set):"html"!==t&&(e[t]=e.resetCfg[t].was);e.resetCfg={};const n=il.getById(t.id),r=(null==n?void 0:n.tipConfig)||e.gatherDataConfigs(t.dataset);if(n&&n.element!==t||!n&&t.matches(".b-widget")||null!=n&&n.disabled&&!n.showTooltipWhenDisabled)return!1;e.owner=n;for(const t in r)e.resetCfg[t]={set:r[t],was:e[t]},"listeners"===t?e.ion(r[t]):e[t]=r[t]},hide({source:e}){e.owner=null}},gatherDataConfigs(e){const t=this,n={};for(const r in e)if(r.startsWith("btip"))if(r.length>4){const s=T.uncapitalize(r.substr(4));if(s in t.getDefaultConfiguration()){const t=e[r];n[s]=Ku[t]?"true"===t:isNaN(t)?t:parseInt(t,10)}}else n.html=e[r];return n},filterTarget(e){const t=e.closest(this.forSelector);if(t)return t;if(Xu.showOverflow&&e.closest(".b-widget"))for(;(null===(n=e)||void 0===n?void 0:n.nodeType)===Element.ELEMENT_NODE;){var n;if("ellipsis"===yr.getStyleValue(e,"text-overflow")&&e.clientWidth<e.scrollWidth)return this.html=T.encodeHtml(e.textContent),e;e=e.parentNode}}}),Mn.on({element:t,mouseenter:e=>Xu.currentOverElement=e.target,keydown:e=>Xu.currentOverElement=e.target,capture:!0,thisObj:i}),n.set(Xu,i)}return i}static encodeConfig(e){const t={};if("string"==typeof e)t.btip=e;else for(const n in e)t[`btip${"html"===n?"":T.capitalize(n)}`]=e[n];return t}}Xu.initClass(),Object.defineProperty(il,"tooltip",{get:()=>Xu.getSharedTooltip(document.body,document.body)}),il.Tooltip=Xu,Xu._$name="Tooltip";class Zu extends Zd{static get type(){return"tip"}static get configurable(){return{align:"t10-b50",offset:20,tooltip:{$config:["lazy","nullify"],value:{type:"tooltip"}}}}open(){this.getConfig("tooltip")}close(){var e;null===(e=this.tooltip)||void 0===e||e.hide()}dragMove(e){const{offset:t,tooltip:n}=this,{event:r}=e;n&&(n.isVisible||n.show(),n.alignTo({align:this.align,target:new vn(r.clientX-t,r.clientY-t,2*t,2*t)}))}changeTooltip(e,t){return il.reconfigure(t,e,this)}}Zu.initClass(),Zu._$name="DragTipProxy";var Ju=e=>class extends(e||ue){static $name="Labelable";static get configurable(){return{label:null,labelPosition:"before",labelCls:null,labelWidth:{value:null,$config:{localeKey:"L{labelWidth}"}}}}get hasLabel(){return Boolean(this.label)}compose(){const{hasLabel:e,labelPosition:t}=this;return{class:{[`b-label-${t}`]:e,"b-has-label":e}}}changeLabel(e){return e||""}setupLabel(e){return Ut.assign({tag:"label",for:`${this.id}-input`,class:`b-label b-align-${e.align||"start"}`},e)}updateLabelWidth(e){this.labelElement&&(this.labelElement.style.flex=`0 0 ${yr.setLength(e)}`,this.inputWrap.style.flexBasis=null==e?"":"auto")}get widgetClass(){}};class Qu extends yl{static $name="FieldContainer";static type="fieldcontainer";static get configurable(){return{animation:{duration:300},collapsed:null,collapser:{value:null,$config:"nullify"},syncableConfigs:null,syncConfigTriggers:{$config:{merge:"classList"},value:null},testConfig:{animation:{duration:10}}}}static get delayable(){return{syncChildConfigs:"raf"}}get inline(){return this.owner.inline??1===this.ensureItems().count}changeCollapsed(e){if(this.togglingCollapse)return this.togglingCollapse=!1,e;this.toggleCollapse(Boolean(e))}updateCollapsed(e){var t;this.collapser=null===(t=this.collapser)||void 0===t?void 0:t.destroy(),this.setCollapsedCls(e)}updateCollapser(e,t){t&&null==t.completed&&(t.reverting&&e||t.destroy()),this.setOwnerCls("b-collapsing",e)}get collapsing(){const{collapser:e}=this;return null!=e&&e.collapsed}get collapsingExpanding(){return null!=this.collapser}get expanding(){const{collapser:e}=this;return null!=e&&!e.collapsed}collapse(e){this.toggleCollapse(!0,e)}expand(e){this.toggleCollapse(!1,e)}setCollapsedCls(e){this.setOwnerCls("b-collapsed",e)}setOwnerCls(e,t){var n,r;null===(n=this.owner)||void 0===n||null===(r=n.element)||void 0===r||r.classList[t?"add":"remove"](e)}syncChildConfigs(){const e=this,{owner:t,syncableConfigs:n}=e;if(n){let r,s;for(r in n)s=n[r](t),e.eachWidget((e=>{e[r]=s}),!1)}t.afterSyncChildConfigs(e)}syncContainer(){const{inline:e,layout:t}=this;this.autoLayout&&(t.horizontal=e,t.justify=e?"center":"stretch")}toggleCollapse(e,t){const n=this,{animation:r,collapser:s,inline:i}=n,{containerWrapElement:a}=n.owner,o=t=>{t&&(n.element.style.height="",n.togglingCollapse=!0,n.collapsed=e,n.collapser=null)};if(null==e&&(e=!n.collapsed),!1!==t&&null!==t&&(a&&n.isVisible?(!0===t?t={}:"number"==typeof t&&(t={duration:t}),t=r||t?Ut.merge({},r,t):null):t=null),t){if(s&&e!==s.collapsed)n.collapser=s.revert({finalize:o}),n.collapser.collapsed=e;else if(!s&&e!==n.collapsed){!e&&n.setCollapsedCls(!1);const{element:r}=n,{height:s}=r.getBoundingClientRect(),l=i?1:s;!e&&n.setCollapsedCls(!0),r.style.height=`${s}px`,n.collapser=Rl.run(Ut.merge({finalize:o,element:a,[i?"opacity":"height"]:{from:e?l:0,to:e?0:l}},t)),n.collapser.collapsed=e}}else n.togglingCollapse=!0,n.collapsed=e}}Qu.initClass(),Qu._$name="FieldContainer";const eh=(e,t)=>(e.weight||0)-(t.weight||0),th=(e,t)=>(t.weight||0)-(e.weight||0),nh=[],rh={align:!0,weight:!0};class sh extends(il.mixin(vc,Ju)){static $name="Field";static type="field";static get configurable(){return{defaultBindProperty:"value",placeholder:null,value:"",name:null,labels:null,required:null,clearable:null,revertOnEscape:null,hint:null,hintHtml:null,inputWidth:null,keyStrokeChangeDelay:0,readOnly:null,editable:!0,defaultAction:"change",triggers:null,highlightExternalChange:!0,localizableProperties:["label","title","placeholder","labelWidth"],autoSelect:!1,autoComplete:"off",spellCheck:null,validateOnInput:!0,inputAttributes:null,inputType:"text",inputAlign:null,attributes:{value:["placeholder","autoComplete","spellCheck","minLength","maxLength","pattern","tabIndex","min","max"],$config:{merge:"distinct"}},nullValue:{$config:null,value:null,default:null},updatedClsDuration:500,inputReadOnly:!1,ariaElement:"input",container:{$config:"nullify",value:null},containerDefaults:{type:"fieldcontainer",syncableConfigs:{disabled:e=>e.disabled},syncConfigTriggers:{disabled:1}},containValues:null,inline:null,testConfig:{updatedClsDuration:10},keyMap:{}}}static get delayable(){return{highlightChanged:"raf"}}doDestroy(){var e,t,n;const r=this,{triggers:s}=r,i=r.isPainted&&sh.getSharedErrorTooltip(r.rootElement,!0);if(null===(e=r.inputListenerRemover)||void 0===e||e.call(r),null===(t=r.keyListenerRemover)||void 0===t||t.call(r),null===(n=r.container)||void 0===n||n.destroy(),super.doDestroy(),s)for(const e of Object.values(s))e.destroy();(null==i?void 0:i.field)===r&&i.hide()}get childItems(){const{container:e,triggers:t}=this,n=t?Object.values(t):[];return e?[...n,...e.childItems]:n}get invalidValueError(){return"L{invalidValue}"}get errorTip(){return this.constructor.getSharedErrorTooltip(this.rootElement)}static getSharedErrorTooltip(e,t){var n;let r=null===(n=e.bryntum)||void 0===n?void 0:n.errorTooltip;return r||t||(e.bryntum=e.bryntum||{},r=new Xu({cls:"b-field-error-tip",forSelector:".b-field.b-invalid .b-field-inner",align:{align:"l-r",monitorTargetMutation:!0},scrollAction:"realign",trapFocus:!1,rootElement:e,onBeforeShow(){const e=this,t=il.fromElement(e.activeTarget);if(t){const n=t.getErrors();if(n)return e.html=n.join("<br>"),e.field=t,!0}return!1}}),e.bryntum.errorTooltip=r),r}static get errorTip(){return this.getSharedErrorTooltip(document.body)}construct(e){super.construct(e);const t=this;t.keyStrokeChangeDelay&&(t.changeOnKeyStroke=t.buffer(t.internalOnChange,t.keyStrokeChangeDelay))}changeKeyMap(e){const t=this;let n={};e&&(t._fieldKeyMap?Ut.assign(n,t._fieldKeyMap):(t._fieldKeyMap=e,Ut.assign(n,e)));for(const e in t.triggers){var r;null!==(r=t.triggers[e])&&void 0!==r&&r.keyMap&&(n=t.mergeKeyMaps(n,t.triggers[e].keyMap,e))}return n}get keyMapSubComponents(){return this.triggers}onFocusIn(e){const t=this;t.valueOnFocus=Ut.clone(t.value),t.validOnFocus=!(t.errors&&Object.keys(t.errors).length),super.onFocusIn(e),t.focusing=!0,t.syncInvalid(),t.focusing=!1}onFocusOut(e){super.onFocusOut(e),this.syncRequired(),this.onEditComplete()}onEditComplete(){}get rootUiClass(){return sh}compose(){this.getConfig("clearable");const e=this,{container:t,innerElements:n,label:r,labels:s,labelCls:i,readOnly:a,triggers:o}=e,l=Ut.values(o,((e,t)=>!t)),c=l.filter((e=>"start"===e.align)).sort(eh),d=l.filter((e=>"start"!==e.align)).sort(th),u=e.setupLabel.bind(e),h=[...c.map((e=>e.element)),...n,...d.map((e=>e.element))];return{class:{"b-has-start-trigger":c.length,"b-no-input":!n.length,"b-readonly":a,"b-field-container":Boolean(t),"b-field-container-inline":null==t?void 0:t.inline},children:[...(s||nh).filter((e=>e&&"end"!==e.align)).map(u),r?u({reference:"labelElement",class:`b-label b-align-start ${i||""}`,html:r}):null,h.length?{class:"b-field-inner",reference:"inputWrap",children:h}:null,...(s||nh).filter((e=>"end"===(null==e?void 0:e.align))).map(u),...t?[{reference:"containerWrapElement",children:[t.element],class:{"b-field-container-wrap":1}}]:nh]}}updateElement(e,t){var n;const r=this,s=r.initialConfig.value,{input:i}=r;super.updateElement(e,t),null!=s&&(r.value=s),r.syncEmpty(),r.updateInputReadOnly(r.inputReadOnly),r.syncInvalid();const a=i||r.focusElement;null===(n=r.keyListenerRemover)||void 0===n||n.call(r),r.keyListenerRemover=a&&Mn.on({element:a,thisObj:r,keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}get innerElements(){return[this.inputElement]}get inputElement(){const{attributes:e,inputAttributes:t,id:n,inputCls:r,inputType:s,name:i}=this,a=Ut.assign({reference:"input",tag:"input",type:s,name:i||n,id:`${n}-input`,retainElement:!0},t);r&&(a.class=r);for(let t,n,r=e.length;r-- >0;)t=e[r],n=this[t],null!=n&&(a[t]=n);return a}get caretPos(){return this.textSelection[0]}set caretPos(e){this.textSelection=e}get focusElement(){return this.input}get textSelection(){const e=this.input;let t;try{t=[e.selectionStart,e.selectionEnd,e.selectionDirection]}catch(r){var n;t=(null===(n=e.value)||void 0===n?void 0:n.length)||0,t=[t,t]}return t}set textSelection(e){"number"==typeof e?this.select(e,e):this.select(...e)}get hasTextSelection(){const[e,t]=this.textSelection;return e&&t-e>0}getAfterValue(e){const[t,n]=this.textSelection,r=this.input.value;return`${r.substr(0,t)}${e}${r.substr(n||t)}`}select(e,t){const n=this.focusElement;if(n.value.length){if(0===arguments.length)return void this.selectAll();if(!this.supportsTextSelection)return;n.setSelectionRange(e,t)}}moveCaretToEnd(){const e=this.input;if(e.createTextRange){const t=e.createTextRange();t.collapse(!1),t.select()}else this.supportsTextSelection&&this.select(e.value.length,e.value.length)}selectAll(){this.focusElement.select()}syncEmpty(){var e;const{isEmptyInput:t,isEmpty:n,element:r}=this,s=null===(e=this.triggers)||void 0===e?void 0:e.clear,i=t&&n;r&&(s&&s[i?"hide":"show"](),r.classList.toggle("b-empty",i))}updateHint(){this.syncHint()}updateHintHtml(){this.syncHint()}syncHint(){const e=this,{input:t,hint:n,hintHtml:r}=e,s=null==t?void 0:t.parentElement;if(t){let i=r||n;const a=e.hintElement||i&&(e.hintElement=yr.createElement({parent:s,className:"b-field-hint",nextSibling:t.nextSibling,children:[{className:"b-field-hint-content"}]}));a&&("function"==typeof i&&(i=i({source:e,value:e.value})),a.firstChild[r?"innerHTML":"textContent"]=i||""),e.element.classList[i?"remove":"add"]("b-field-no-hint")}}syncInvalid(){const e=this,{isPainted:t}=e;if(e.updatingInvalid=!0,t){const{isValid:t,element:n,inputWrap:r}=e;if(n.classList[t?"remove":"add"]("b-invalid"),t){const t=e.constructor.getSharedErrorTooltip(e.rootElement,!0);null!=t&&t.isVisible&&t.field===e&&t.hide()}else{const t=e.errorTip;t&&(e.containsFocus||e.isVisible&&r.contains(Xu.currentOverElement))&&(t.activeTarget===r&&t.isVisible?t.onBeforeShow():(t.activeTarget=r,t.showBy(r)))}}e.updatingInvalid=!1}updateEditable(){this.syncInputReadOnly()}syncInputReadOnly(){this.getConfig("readOnly"),this.inputReadOnly=this._readOnly||!1===this.editable}updateInputReadOnly(e){const t=this,{input:n,inputListenerRemover:r}=t;n&&(n.readOnly=e?"readOnly":null,e?t.inputListenerRemover=null==r?void 0:r():r||(t.inputListenerRemover=Mn.on({element:n,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput"})))}changeReadOnly(e){return Boolean(e)}updateReadOnly(e){this.syncInputReadOnly()}updateClearable(e){const t=this;t.getConfig("triggers"),t.triggers={clear:e&&Ut.assign({cls:"b-icon-remove",weight:1e3,key:"Shift+backspace",handler(){t._isUserAction=!0,t.clear(...arguments),t._isUserAction=!1}},e)||null}}changeTriggers(e,t){const n=this,r=n.$triggers||(n.$triggers=new sc({configName:"triggers",factory:sh.Trigger,inferType:!1,owner:n,created(e){Ce.after(e,"onConfigChange",((e,{name:t})=>{rh[t]&&n.onConfigChange({name:"triggers",value:r.target})}))},setup(e,t){e.reference=e.ref=t,e.parent=n}}));if(!1===n.stepTriggers&&(e.back||e.forward)&&(delete(e=Ut.assign({},e)).back,delete e.forward),r.update(e),n.element&&(n.keyMap=n.keyMap),!t)return r.target}updateInputWidth(e){this.input.style.width=yr.setLength(e),this.element.classList.add("b-has-width")}updateInputAlign(e){this.input.style.textAlign=e}get isValid(){const e=this;if(!e.disabled){if(e.syncRequired(),e.errors&&Object.keys(e.errors).length)return!1;const t=e.validity;if(t)return t.valid}return!0}get isEmpty(){return null==this.value||""===this.value}get isEmptyInput(){return!this.input||null==this.input.value||""===this.input.value}get validity(){const e=this.input;return null==e?void 0:e.validity}async setValue(e){this.value=e}changeValue(e,t){return null==e&&(e=this.nullValue),this.hasChanged(t,e)?e:(""===e&&this.syncRequired(),t)}updateValue(e,t){const n=this;n.isConfiguring||(n.syncRequired(),n.inputting||n.triggerChange()),n.inputting||(n._lastValue=e),n.syncInputFieldValue(),n.overflowTwin&&!n._overflowTwinSync&&(n._overflowTwinSync=!0,n.overflowTwin.value=e,n._overflowTwinSync=!1)}hasChanged(e,t){return t!==e}syncInputFieldValue(e=!1){const t=this,{input:n,parent:r,inputValueAttr:s,inputValue:i}=t;if(n&&!t.inputting&&n[s]!==i&&(n[s]=i,!t.isConfiguring&&!t.containsFocus&&t.highlightExternalChange)){if(n.classList.remove("b-field-updated"),t.clearTimeout("removeUpdatedCls"),r){const{assigningValues:t}=r;!0!==t&&!1!==(null==t?void 0:t.highlight)||(e=!0)}e||t.highlightChanged()}t.syncEmpty(),t.syncInvalid()}highlightChanged(){this.input.classList.add("b-field-updated"),this.setTimeout("removeUpdatedCls",this.updatedClsDuration)}removeUpdatedCls(){this.input.classList.remove("b-field-updated")}get inputValue(){return null==this.value?"":this.value}get inputValueAttr(){return"value"}get supportsTextSelection(){const e=this.focusElement;return e&&("textarea"===e.tagName.toLowerCase()||e.type&&/text|search|password|tel|url/.test(e.type))}internalOnInputFocus(){this.autoSelect&&this.selectAll()}internalOnChange(e){const t=this;t.hasChanged(t._lastValue,t.value)&&t.isValid&&(t.triggerChange(e,!0),t._lastValue=t.value)}triggerChange(e,t=Boolean(this._isUserAction)){const n=this,{value:r,_lastValue:s,isValid:i}=n;n.syncHint(),n.triggerFieldChange({value:r,oldValue:s,event:e,userAction:t,valid:i}),"change"===n.defaultAction&&n.trigger("action",{value:r,oldValue:s,event:e,userAction:t,valid:i})}fetchInputValue(){this.value=this.input[this.inputValueAttr]}internalOnInput(e){var t;const n=this;n.validateOnInput||n.errorTip.hide(),n.inputting=!0,n.fetchInputValue(),n.inputting=!1,n.trigger("input",{value:n.value,event:e}),null===(t=n.changeOnKeyStroke)||void 0===t||t.call(n,e)}get needsInputSync(){return this.input[this.inputValueAttr]!==String(this.inputValue??"")}internalOnKeyEvent(e){const t=this,{value:n}=t;let r=!1;if("keydown"===e.type&&"Escape"===e.key&&!t.readOnly&&!t.disabled){const e=t.isValid,s="initialValue"in t?t.initialValue:t.valueOnFocus,i=t.hasChanged(s,n),{needsInputSync:a}=t;t.revertOnEscape&&(!e||i||a)&&(i&&(t.value=s),a&&t.syncInputFieldValue(!0),t.clearError(),r=(i||a)&&t.isValid||e!==t.validOnFocus)}t.isDestroyed||(r&&e.stopImmediatePropagation(),t.trigger(e.type,{event:e}))}clear(e){const t=this,{value:n}=t;(n!==t.nullValue||t.input.value.length>0)&&(t.value=t.nullValue,t.clearError(),t.syncInvalid(),t.trigger("clear",{event:e}))}onDisabled(){this.syncInvalid()}syncRequired(){var e;const t=this;t.isConfiguring||t.focusing||!t.required||!t.isEmpty||null!==(e=t.parent)&&void 0!==e&&e.isSettingValues?t.clearError("L{fieldRequired}",t.updatingInvalid):t.setError("L{fieldRequired}",t.updatingInvalid)}setError(e,t,n){const r=this;if((r.errors||(r.errors={}))[r.optionalL(e)]=1,t||r.syncInvalid(),n){const t=()=>{r.clearError(e),n()},n=r.ion({keydown:t,focusOut:t})}}clearError(e,t){const n=this;n.errors&&(e?delete this.errors[this.optionalL(e)]:n.errors={}),t||n.syncInvalid()}getErrors(){const e=this;if(!e.isValid){var t;const n=e.validity,r=Ut.keys(n).find((e=>"valid"!==e&&"customError"!==e&&n[e])),s=e.errors&&Object.keys(e.errors);let i;if(i=null!=s&&s.length?s:n.customError?[e.input.validationMessage]:r?[e.L(r,{min:e.min,max:e.max})]:[e.L(e.invalidValueError)],(null===(t=i)||void 0===t?void 0:t.length)>0)return i}}createOverflowTwin(e){const t=this,n=super.createOverflowTwin(e);return n.ion({change({value:e}){t._overflowTwinSync=!0,t.value=e,t._overflowTwinSync=!1}}),n}get containerCollapsed(){var e;return null===(e=this.container)||void 0===e?void 0:e.collapsed}set containerCollapsed(e){const{container:t}=this;t&&(t.collapsed=e)}afterSyncChildConfigs(e){}changeContainer(e,t){e&&(Array.isArray(e)||!("type"in e)&&!("items"in e))&&(e={items:e});const n=this,r=e&&Ut.merge({owner:n,layout:"box"},n.containerDefaults),s=il.reconfigure(t,e,{owner:n,defaults:r});if(!s||(s.autoLayout="box"===(null==r?void 0:r.layout),s!==t))return s;s.syncContainer()}onConfigChange(e){var t,n;super.onConfigChange(e),null!==(t=this.container)&&void 0!==t&&null!==(n=t.syncConfigTriggers)&&void 0!==n&&n[e.name]&&this.container.syncChildConfigs()}assignValue(e,t){const{container:n,containValues:r}=this,s=this.getValueName(t);n&&!1!==r?e&&"nested"===r?e&&s in e&&(e=Ut.clone(e[s]),super.assignValue({[s]:e&&!("value"in e)||e.value},t),e&&delete e.value,n.assignValue(e,t)):(super.assignValue(e,t),n.assignValue(e,t)):super.assignValue(e,t)}gatherValue(e){super.gatherValue(e),this.gatherValues(e)}gatherValues(e,t){const n=this,{container:r,containValues:s,valueName:i}=n,a=typeof s;t=t??i in e,r&&!1!==s&&("nested"===s?t&&(e[i]={value:e[i],...r.values}):(!0===s||null==s&&t||"string"===a&&n[s]||"function"===a&&s(n))&&r.gatherValues(e))}updateContainer(e,t){t&&this.detachListeners(t.id),e&&(e.rendered||e.render(),e.syncContainer(),e.syncChildConfigs())}}sh.Trigger=class extends il{static get $name(){return"FieldTrigger"}static get factoryable(){return{defaultType:sh.Trigger,extends:null}}static get type(){return"trigger"}static get configurable(){return{align:null,weight:null,role:void 0}}get field(){return this.parent}construct(){super.construct(...arguments),this.key&&(this.keyMap={[this.key]:"onClick"})}compose(){return{"aria-hidden":!0,class:{[`b-align-${this.align||"end"}`]:1,"b-icon":1},listeners:{click:"onClick",mousedown:"onMousedown"}}}changeAlign(e){return e}onClick(e){const t=this,{field:n}=t;n.disabled||n.readOnly||(e.key&&e.preventDefault(),!1!==n.trigger("trigger",{trigger:t})&&t.handler&&n.callback(t.handler,n,[e,t]))}onMousedown(e){const t=this.field;!("key"in e)&&yr.isTouchEvent&&t.editable&&(t.editable=!1,t.setTimeout((()=>t.editable=!0),500)),e.preventDefault(),yr.getActiveElement(t.input)!==t.input&&t.focus()}},sh.SpinTrigger=class extends sh.Trigger{static get $name(){return"SpinTrigger"}static get type(){return"spintrigger"}static get configurable(){return{repeat:{$config:["nullify"],value:!0}}}compose(){return{children:{upButton:{class:{"b-icon":1,"b-spin-up":1}},downButton:{class:{"b-icon":1,"b-spin-down":1}}}}}updateRepeat(e){var t;null===(t=this.clickRepeater)||void 0===t||t.destroy(),this.clickRepeater=e?Ml.new({element:this.element},e):null}onClick(e){const t=this,{field:n}=t;n.disabled||n.readOnly||(e.target===t.upButton?n.doSpinUp(e.shiftKey):e.target===t.downButton&&n.doSpinDown(e.shiftKey))}},sh.Trigger.initClass(),sh.SpinTrigger.initClass(),il.register(sh.Trigger,"trigger"),il.register(sh.SpinTrigger,"spintrigger"),sh._$name="Field";class ih extends sh{static $name="TextField";static type="textfield";static alias="text";static get configurable(){return{nullValue:""}}construct(e){"hidden"===(null==e?void 0:e.inputType)&&(e.hidden=!0),super.construct(...arguments)}}ih.initClass(),ih._$name="TextField";class ah extends ih{static $name="PickerField";static type="pickerfield";static get configurable(){return{editable:!0,pickerAlignElement:"inputWrap",value:null,triggers:{expand:{cls:"bars"}},autoClose:!0,autoExpand:null,picker:{value:{floating:!0},$config:["lazy","nullify"]},inputType:"text",monitorResize:!0,nullValue:null}}doDestroy(){var e;null===(e=this.globalTapListener)||void 0===e||e.call(this),super.doDestroy()}changeEditable(e){return r.isMobile&&!0!==this.initialConfig.editable&&(e=!1),e}updateAutoClose(e){!e&&P.deprecate("Core","6.0.0","PickerField.autoClose is no longer supported")}updateEditable(e){const t=this,{element:n,ariaElement:s,nonEditableClickTarget:i}=t,{expand:a}=t.triggers,o=globalThis.matchMedia("(max-width: 410px)").matches;var l;(super.updateEditable(...arguments),n.classList.toggle("b-not-editable",!e),!1===e)?(r.isMobile&&o&&(null==a||a.hide()),s.removeAttribute("aria-autocomplete"),null===(l=t.globalTapListener)||void 0===l||l.call(t),Mn.on({element:i,click:e=>{const n=i.getRootNode().elementFromPoint(e.clientX,e.clientY);e.target===i&&n===i&&t.onTriggerClick(e)},thisObj:t})):(null==a||a.show(),s.setAttribute("aria-autocomplete","list"),t.globalTapListener=xr.ion({globaltap:"showKeyboard",thisObj:t}))}get nonEditableClickTarget(){return this.input}updateElement(e,t){var n;const r=super.updateElement(e,t),s=this.peekConfig("picker"),i=!!s&&(s.isWidget?s.role:null===(n=this.constructor.resolveType(s.type))||void 0===n?void 0:n.$meta.config.role);return yr.setAttributes(this.ariaElement,{"aria-expanded":!1}),this.ariaHasPopup=i,r}changePicker(e,t){throw new Error("changePicker(oldPicker, newPicker) must be implemented in PickerField subclass implementations")}get childItems(){const e=super.childItems;return this._picker&&e.push(this.picker),e}onEditComplete(){super.onEditComplete(),this.autoClosePicker()}onElementResize(e){const t=this;t.pickerVisible&&t.picker.requestAnimationFrame(t.picker.realign,null,t.picker),super.onElementResize(e)}internalOnKeyEvent(e){const t=this;let n=!0;if("keydown"===e.type&&!t.disabled&&!e.shiftKey&&!e.ctrlKey)if(t.pickerVisible){const{picker:r}=t;"Escape"===e.key?(e.preventDefault(),e.stopImmediatePropagation(),t.hidePicker(),n=!1):r.onInternalKeyDown?r.onInternalKeyDown(e):"ArrowDown"===e.key&&r.focusable&&r.focus()}else"ArrowDown"===e.key&&(e.stopImmediatePropagation(),e.preventDefault(),t.onTriggerClick(e));n&&super.internalOnKeyEvent(e)}onFocusIn(e){const t=this;super.onFocusIn(e),t.autoExpand&&(t.minChars=0,t.onTriggerClick(e),t.ignoreTriggerClick=!0,t.setTimeout((()=>t.ignoreTriggerClick=!1),100))}onTriggerClick(e){this.disabled||this.togglePicker("key"in e)}showKeyboard({event:e}){const t=this.input;yr.isTouchEvent&&yr.getActiveElement(t)===t&&e.target===t&&(xr.suspendFocusEvents(),t.blur(),t.focus(),xr.resumeFocusEvents())}togglePicker(e){this.pickerVisible?this.hidePicker():this.showPicker(e)}showPicker(e){const t=this,{picker:n}=t;t.pickerHideShowListenersAdded||(n.ion({show:"onPickerShow",hide:"onPickerHide",thisObj:t}),t.pickerHideShowListenersAdded=!0),yr.setAttributes(t.ariaElement,{"aria-controls":n.id,"aria-expanded":!0}),n.autoClose=t.autoClose,n.show(),n.isVisible&&e&&t.focusPicker()}onPickerShow(){const e=this;e.pickerVisible=!0,e.element.classList.add("b-open"),e.trigger("togglePicker",{show:!0}),e.pickerTapOutRemover=xr.ion({globaltap:"onPickerTapOut",thisObj:e}),e.pickerKeyDownRemover=Mn.on({element:e.picker.element,keydown:"onPickerKeyDown",thisObj:e})}onPickerHide(){var e,t;const n=this;n.ariaElement.setAttribute("aria-expanded",!1),n.pickerVisible=!1,n.element.classList.remove("b-open"),n.trigger("togglePicker",{show:!1}),null===(e=n.pickerTapOutRemover)||void 0===e||e.call(n),null===(t=n.pickerKeyDownRemover)||void 0===t||t.call(n)}onPickerTapOut({event:e}){this.containsFocus||this.owns(e.target)||this.autoClosePicker()}onPickerKeyDown(e){if("Tab"===e.key&&!this.picker.trapFocus){const t=yr.getActiveElement(this.input),n=new KeyboardEvent("keydown",e);this.input.dispatchEvent(n),n.defaultPrevented&&e.preventDefault(),yr.getActiveElement(this.input)===t?this.input.focus():e.preventDefault(),this.isDestroyed||this.hidePicker()}}autoClosePicker(){this.autoClose&&this.hidePicker()}hidePicker(){this.pickerVisible&&this.picker.hide()}focusPicker(){}focus(){const e=this.input;yr.isTouchEvent&&this.editable&&(e.readOnly=!0,this.setTimeout((()=>e.readOnly=!1),500)),super.focus()}}ah._$name="PickerField";const oh=document.createRange();class lh extends il{static $name="List";static type="list";static get configurable(){return{itemCls:"b-list-item",selectedCls:"b-selected",selectIconCls:"b-icon-check",tag:"ul",items:null,displayField:"text",store:null,navigator:!0,scrollable:{overflowX:!1,overflowY:!0},itemsFocusable:!0,multiSelect:!1,toggleAllIfCtrlPressed:!1,collapsibleGroups:!1,selectAllItem:!1,itemTpl(e){let t=T.encodeHtml(e.getValue(this.displayField));return null!=t&&""!==t||(t="&nbsp;"),t},getItemStyle:null,getItemCls:null,groupHeaderTpl(e,t){let n=T.encodeHtml(t);return null!=n&&""!==n||(n="&nbsp;"),`${this.allowGroupSelect?this.itemIconTpl(e):""}${n}`},allowGroupSelect:!0,clearSelectionOnEmptySpaceClick:!1,selected:{$config:["nullify","lazy"],value:[]},activateOnMouseover:null,role:"listbox",keyMap:{"Ctrl+a":"selectAll"}}}construct(e,...t){var n;const r=this;Array.isArray(e)&&(e={items:e}),super.construct(e,...t);const{element:s}=r,{classList:i}=s;r.multiSelect&&i.add("b-multiselect"),null!==(n=r.store)&&void 0!==n&&n.count?r.refresh():i.add("b-empty"),Mn.on({element:s,delegate:r.itemSelector,mouseover:"onMouseOver",thisObj:r}),Mn.on({element:s,click:"onClick",thisObj:r})}doDestroy(){var e;this.detachListeners("store"),null===(e=this.navigator)||void 0===e||e.destroy(),super.doDestroy()}onFocusIn(e){var t;this.restoreActiveItem(null===(t=e._target)||void 0===t?void 0:t.closest(this.itemSelector)),super.onFocusIn(e)}contentTpl(){const e=this,t=e.store.records.map(((t,n)=>e.itemWrapperTpl(t,n)));return e.multiSelect&&!1!==e.selectAllItem&&t.unshift(e.selectAllItemTpl()),gd.tpl`${t}`}itemWrapperTpl(e,t){const{selected:n,getItemStyle:r,store:s}=this,i=r?`style="${this.callback(r,this,[e])}"`:"";if(s.isGrouped&&!e.isGroupHeader){if(e.groupParent.get(s.id).meta.collapsed)return""}return gd.tpl`<li ${i} class="${this.getItemClasses(e,t)}" role="option" aria-selected="${n.includes(e)}" data-index="${t}" data-id="${T.encodeHtml(e.id)}" ${this.itemsFocusable?'tabindex="-1"':""}>${this.itemContentTpl(e,t)}</li>`}itemContentTpl(e,t){if(e.isGroupHeader){let t=this.groupHeaderTpl(e,T.capitalize(e.meta.groupRowFor));if(this.collapsibleGroups){t+=`<button class="b-button b-tool b-icon b-icon-collapse-${e.meta.collapsed?"right":"down"} b-list-expander-icon" data-noselect></button>`}return t}return`${this.itemIconTpl(e,t)}${this.itemTpl(e,t)}`}itemIconTpl(e,t){return this.multiSelect?`<i class="b-selected-icon b-icon ${this.selectIconCls}"></i>`:""}selectAllItemTpl(){const e=this.allSelected?"b-selected":"";return`<li class="${this.itemCls} b-select-all-item ${e}" data-noselect data-select-all data-id="select-all">${this.itemIconTpl({})}<div>${this.L("selectAll")}</div></li>`}getItemClasses(e){var t;const n=this,{getItemCls:r}=n,s=null===(t=n._navigator)||void 0===t?void 0:t.activeItem,i=(null==s?void 0:s.dataset.id)==e.id,a="groupRowFor"in e.meta?"b-list-item-group-header":"",o=n.selected.includes(e)||e.isSpecialRow&&e.groupChildren.every((e=>n.selected.includes(e))),l=r?this.callback(r,this,[e]):"";return`${n.itemCls} ${e.cls||""} ${l} ${o?n.selectedCls:""} ${i?n.navigator.focusCls:""} ${a}`}onBeforeStoreLoad(){this.mask(this.L("L{loading}"))}onAfterStoreRequest(){this.unmask()}onStoreChange({source:e,action:t,records:n,record:r,changes:s}){const i=this,{selected:a}=i;switch(t){case"dataset":a.match(e.storage,!i._externallyOwnedSelection);break;case"remove":a.remove(n);break;case"clear":i.deselectAll();break;case"update":{const{id:e}=s;return e&&yr.setAttributes(i.contentElement.querySelector(T.encodeAttributeSelector("data-id",e.oldValue)),{"data-id":e.value}),void i.refreshItem(r)}}i.refresh()}onStoreRefresh(){this._selected?this.refresh():this.getConfig("selected")}refresh(){const e=this;if(e.isVisible&&e.store){var t;const n=null===(t=e.navigator)||void 0===t?void 0:t.activeItem;e.paintListener=null;const r=yr.createElementFromTemplate(e.contentTpl(),{fragment:!0});e.clearItems().insertNode(r),n&&e.restoreActiveItem(n),e.refreshCount=(e.refreshCount||0)+1,e.element.classList[e.store.count>0?"remove":"add"]("b-empty"),e.updateSelectAllState()}else e.paintListener||(e.paintListener=e.ion({paint:"refresh",thisObj:e,once:!0}))}clearItems(){const e=this,t=e.contentElement.querySelector(e.itemSelector),n=e.contentElement.lastChild;if(t){const n=e.contentElement.querySelectorAll(`${e.itemSelector}:not(.b-mask)`);oh.setStartBefore(t),oh.setEndAfter(n[n.length-1]),oh.deleteContents()}else n?(oh.setStartAfter(n),oh.setEndAfter(n)):(oh.setStart(e.contentElement,0),oh.setEnd(e.contentElement,0));return oh}refreshItem(...e){for(const t of e){const e=this.getItem(t);if(e){const n=this.store.indexOf(t),r=yr.createElementFromTemplate(this.itemWrapperTpl(t,n));yr.sync(r,e)}}}getItem(e){var t;if(null!=e)return"number"==typeof e?this.contentElement.querySelector(`[data-index="${e<0?this.store.count+e:e}"]`):(e.nodeType===Element.ELEMENT_NODE&&(e=e.dataset.id),null!=(null===(t=e)||void 0===t?void 0:t.id)&&(e=e.id),this.contentElement.querySelector(T.encodeAttributeSelector("data-id",e)))}getRecordFromElement(e){return e.target&&(e=e.target),e=e.closest(this.itemSelector),this.store.getAt(parseInt(e.dataset.index))}updateItems(e){var t;const n=this,r=Li.getStore(ge.asArray(e));null!==(t=n.store)&&void 0!==t&&t.autoCreated?n.store.data=(null==r?void 0:r.records)||[]:n.store=r}updateDisabled(e){super.updateDisabled(...arguments),this.navigator&&(this.navigator.disabled=e)}changeSelected(e,t){const n=this,r={change:"onInternalSelectionChange",thisObj:n};if(null==t||t.un(r),e)if(e.isCollection)n._externallyOwnedSelection=!0,e.ion(r);else if(n._externallyOwnedSelection=!1,e=ge.asArray(e).reduce(((e,t)=>((t=t.isModel?t:n.store.getById(t))&&e.push(t),e)),[]),t)t.splice(0,t.count,e),e=t,n.refresh();else{const t=e;(e=n._selected=new ni({internalListeners:r})).add(t)}else null==t||t.destroy();return e}updateSelected(e){e&&this.refresh()}get itemSelector(){return`.${this.itemCls}`}get selected(){return this._selected}updateMultiSelect(e,t){!e&&t&&this.selected.count>1&&this.deselect(this.selected.allValues.slice(1))}get store(){return this.getConfig("items"),this._store}changeStore(e){const t=this;if(e instanceof Li||(Array.isArray(e)&&(e={data:e}),e=new Li(e)),t.detachListeners("store"),e){const n={name:"store",change:"onStoreChange",refresh:"onStoreRefresh",thisObj:t};e.readUrl&&(n.beforeLoad="onBeforeStoreLoad",n.afterRequest="onAfterStoreRequest"),e.isGrouped&&(t.element.classList.add("b-grouped"),n.groupchange="onStoreRefresh"),e.ion(n)}return e}updateStore(e){null!=e&&e.records.length&&this.getConfig("selected"),this.refreshCount||this.refresh()}changeNavigator(e,t){const n=this,{element:r}=n;var s;r&&((null===(s=e=$d.reconfigure(t,e?$d.mergeConfigs({ownerCmp:n,disabled:n.disabled,target:r,keyEventTarget:r},e):null,n))||void 0===s?void 0:s.keyEventTarget)!==r||n.itemsTabbable||(r.tabIndex=0));return e}get minAlignHeight(){const e=this.element.lastElementChild,t=this.minHeight;if(null!=t)return e?Math.min(e.offsetTop+e.offsetHeight,t):0}alignTo(...e){super.minHeight=this.minAlignHeight,super.alignTo(...e)}hide(...e){return this.navigator&&(this.navigator.activeItem=null),super.hide(...e)}show(){const{refreshCount:e}=this,{previousActiveItem:t}=this.navigator;super.minHeight=this._minHeight;const n=super.show(...arguments);return this.refreshCount===e&&this.restoreActiveItem(t,!0),n}restoreActiveItem(e=this.navigator.previousActiveItem,t="nearest"){const n=this,{navigator:r,lastAlignSpec:s}=n;if(null!=e){if("string"!=typeof t){const e=s?s.zone:1;t=1&e?"nearest":e?"start":"end"}(e=n.getItem(e))&&!n.disabled&&(n.scrollable.scrollIntoView(e,{block:t}),r.activeItem=e)}}onMouseOver(e){const t=this,n=e.currentTarget;!yr.isTouchEvent&&n&&t.navigator&&t.activateOnMouseover&&t.setTimeout({fn:"handleMouseOver",delay:30,args:[n],cancelOutstanding:!0})}handleMouseOver(e){this.navigator.activeItem=e}onClick(e){const t=e.target.closest(this.itemSelector);t?this.onItemClick(t,e):this.clearSelectionOnEmptySpaceClick&&this.deselectAll()}onSpaceKey(e){("INPUT"!==e.target.nodeName.toUpperCase()||e.target.readOnly)&&this.onEnterKey(e)}onEnterKey(e){const t=this.navigator.activeItem;t&&!this.disabled&&(this.onItemClick(t,e),e.stopImmediatePropagation(),e.preventDefault())}onInternalKeyDown(e){const t=this;switch(e.key){case"ArrowLeft":t.collapseItem();break;case"ArrowRight":t.expandItem();break;case" ":t.onSpaceKey(e);break;case"Enter":t.onEnterKey(e)}}collapseItem(){const{activeItem:e}=this.navigator;e&&this.toggleCollapse(this.getRecordFromElement(e),!0)}expandItem(){const{activeItem:e}=this.navigator;e&&this.toggleCollapse(this.getRecordFromElement(e),!1)}onItemClick(e,t){const n=this,{allowGroupSelect:r}=n,s=parseInt(e.dataset.index),i=n.store.getAt(s),a=null==i?void 0:i.isSpecialRow,o=e.contains(t.target.closest("[data-noselect]"));if(!n.disabled&&!1!==n.trigger("beforeItem",{item:e,record:i,index:s,event:t,userAction:!0})){if(n._isUserAction=!0,e.contains(t.target.closest("[data-select-all]")))n.onSelectAllClick(e,t);else{if(t.target.matches(".b-list-expander-icon"))return void n.toggleCollapse(i);if(i&&!o&&(!a||r)){var l;const{selected:s}=n,o=null===(l=i.groupParent)||void 0===l?void 0:l.get(n.store.id);if(n.multiSelect){let l=s.includes(i),c=i;if(n.toggleAllIfCtrlPressed&&t.ctrlKey?c=n.store.records:r&&a&&(l=!i.groupChildren.some((e=>!s.includes(e))),e.classList.toggle("b-selected",!l),c=i.groupChildren),s[l?"remove":"add"](c),!a&&o&&r){n.getItem(o).classList.toggle("b-selected",o.groupChildren.every((e=>s.includes(e))))}}else s.splice(0,s.count,i)}}n.isDestroyed||(n.lastClicked=i,n.trigger("item",{item:e,record:i,index:s,event:t,userAction:!0}),n._isUserAction=!1)}}onInternalSelectionChange({action:e,removed:t,added:n,replaced:r}){const s=this,{selectedCls:i,unselectedCls:a}=s;let o,l;if("clear"===e)for(l of s.element.querySelectorAll(`.${i}`))l.classList.remove(i),l.setAttribute("aria-selected",!1),a&&l.classList.remove(a);else if("replaceValues"!==e){for(o of t)l=s.getItem(o),l&&(l.classList.remove(i),l.setAttribute("aria-selected",!1));for(o of n)l=s.getItem(o),l&&(l.classList.add(i),l.setAttribute("aria-selected",!0))}s.selectAllItem&&s.updateSelectAllState(),s.trigger("selectionChange",{selected:s.selected.values})}onSelectAllClick(e){e.classList.contains(this.selectedCls)?this.deselectAll():this.selectAll()}updateSelectAllState(){var e;null===(e=this.element.querySelector(".b-select-all-item"))||void 0===e||e.classList.toggle(this.selectedCls,this.allSelected)}get allSelected(){const{selected:e,store:t}=this;return e.count&&(t.isFiltered?t.records.every((t=>e.includes(t))):t.count===e.count)}selectAll(e){const t=this;!t.multiSelect&&e||(t.selected.add(t.store.records),e&&!t.navigator.activeItem&&(t.navigator.activeItem=t.getItem(-1)))}deselectAll(){this.selected.clear()}select(e){const{store:t}=this,{modelClass:n}=t;e=ge.asArray(e).reduce(((e,r)=>((r=t.getById(n.asId(r)))&&e.push(r),e)),[]),this.selected.add(e)}deselect(e){const{modelClass:t}=this.store;e=ge.asArray(e).reduce(((e,n)=>((n=this.selected.get(t.asId(n)))&&e.push(n),e)),[]),this.selected.remove(e)}toggleCollapse(e,t){e.isGroupHeader&&(t=void 0===t?!e.meta.collapsed:t,this.store[t?"collapse":"expand"](e),this.refresh(),this.trigger("toggleGroup",{groupRecord:e,collapse:t}))}updateCollapsibleGroups(e,t){if(t&&!e){const{store:e}=this;e.groupRecords.forEach((t=>e.expand(t)))}this.refresh()}}lh.initClass(),lh.prototype.navigatorClass=$d,lh._$name="List";class ch extends lh{static $name="ChipView";static type="chipview";static get configurable(){return{itemCls:"b-chip",multiSelect:!1,closable:!0,iconTpl:null,closeHandler:null}}itemContentTpl(e,t){const n=this;return gd.tpl`${n.iconTpl?this.iconTpl(e):""}
            ${n.itemTpl(e,t)}
            ${n.closable?'<div class="b-icon b-close-icon b-icon-clear" data-noselect></div>':""}`}onInternalKeyDown(e){const t=this;t.closable&&t.selected.count&&("Delete"===e.key||"Backspace"===e.key)?t.callback(t.closeHandler,t.owner,[t.selected.values,{isKeyEvent:!0}]):super.onInternalKeyDown(e)}updateClosable(e){this.element.classList[e?"add":"remove"]("b-chips-closable"),this.navigator&&(this.navigator.disabled=!e),this.isConfiguring||this.refresh()}onClick(e){const t=this,n=e.target.closest(`.${t.itemCls}`);if(t.closable&&e.target.classList.contains("b-close-icon")){const e=t.store.getAt(parseInt(n.dataset.index));t.closeHandler?t.callback(t.closeHandler,t.owner,[[e]]):t.store.remove(e)}else super.onClick(e)}}ch.initClass(),ch._$name="ChipView";const dh="L{Field.fieldRequired}",uh="L{Field.validateFilter}",hh=/[\w\s]/;class gh extends ah{static $name="Combo";static type="combo";static alias="combobox,dropdown";static delayable={filterOnInput:0};static get configurable(){return{primaryFilter:{},picker:{type:"list",floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,align:{align:"t0-b0",axisLock:!0},maxHeight:324,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},multiSelect:null,items:null,store:null,valueField:void 0,displayField:"text",pickerWidth:null,minChars:null,selected:null,listItemTpl:null,displayValueRenderer:null,listCls:null,triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},filterParamName:null,encodeFilterParams:e=>e.map((e=>e.value)),filterOnEnter:!1,hideTrigger:null,overlayAnchor:null,keyStrokeFilterDelay:null,defaultAction:"select",triggerAction:"all",filterOperator:"startsWith",caseSensitive:!1,hidePickerOnSelect:null,chipView:{$config:["lazy","nullify"],value:{type:"combochipview"}},chipStore:{$config:["lazy","nullify"],value:{}},filterSelected:null,emptyText:null,value:null,valueCollection:{$config:["nullify","lazy"],value:{}},validateFilter:!0,clearTextOnPickerHide:!0,destroyStore:!1,multiValueSeparator:",",createOnUnmatched:null,role:"combobox",inlinePicker:null,testConfig:{keyStrokeFilterDelay:0},localizeDisplayFields:!1,buildItems:null}}static get queryLast(){return"last"}construct(e){super.construct(...arguments),this.store||(this.items=[]),this.filterOnEnter&&(this.hideTrigger=!0)}startConfigure(e){this.usingRecordAsValue=null===e.valueField,super.startConfigure(...arguments)}afterConfigure(){super.afterConfigure();const e=this;Ut.hasOwn(e,"_value")||(e._value=e.valueField===e.displayField?"":null,e._lastValue=e._lastValue||e._value)}get childItems(){const{_chipView:e,_picker:t}=this,n=super.childItems;return e&&n.push(e),t&&n.push(t),n}get innerElements(){var e;const t=null===(e=this._chipView)||void 0===e?void 0:e.element,{input:n,inputElement:r}=this;return t&&go.sync({targetElement:n,domConfig:r}),[t||r]}updateInlinePicker(e){e&&(this.element.classList.add("b-inline-picker"),this.getConfig("picker"),this.triggers.expand=null,this.pickerVisible=!0)}hidePicker(){if(!this.inlinePicker)return super.hidePicker(...arguments)}changeChipStore(e){return!e||e instanceof Li||(e=new Li(Li.mergeConfigs({storage:this.valueCollection},e))),e}updateChipStore(e,t){null==t||t.destroy()}changeChipView(e,t){const n=this;if(n.element.classList[e?"add":"remove"]("b-uses-chipview"),e){const{input:r}=n;return n.chipStore||(n.chipStore={}),mh.reconfigure(t,e,{defaults:{parent:n,insertBefore:r,store:n.chipStore,closable:!n.readOnly,navigator:{type:"combochipnavigator",keyEventTarget:r}}})}null==t||t.destroy()}updateChipView(e){var t;const n=this;n._chipViewEventDetacher=null===(t=n._chipViewEventDetacher)||void 0===t?void 0:t.call(n),n.chipStore=null==e?void 0:e.store,e&&(e.element.appendChild(n.input),n._chipViewEventDetacher=Mn.on({element:e.element,mousedown:"onChipViewMousedown",thisObj:n}))}updateMultiSelect(e,t){const n=this,{input:r,element:s}=n,i=!n.isConfiguring;let{value:a}=n;if(s.classList[e?"add":"remove"]("b-multiselect"),e){const{chipView:e}=n,{parentNode:t}=r,s=null==e?void 0:e.element;s&&s!==t&&(t.insertBefore(s,r),s.appendChild(r),n.chipView.refresh()),r.value="",i&&(a=ge.asArray(a))}else{const e=n._chipView,{parentNode:t}=r,l=null==e?void 0:e.element;var o;if(l===t&&(l.parentNode.insertBefore(r,l),l.remove(),s.classList.remove("b-uses-chipview")),i&&"string"!=typeof a)a=null!==(o=a)&&void 0!==o&&o.length?a[0]:null}i&&(n.value=a)}onChipViewMousedown(e){e.preventDefault(),this.containsFocus||this.focus()}onChipClose(e,t={}){(t.isKeyEvent&&""===this.input.value||!t.isKeyEvent)&&(this._isUserAction=!0,this.valueCollection.remove(e),this._isUserAction=!1)}updateFilterParamName(e){!1!==this.hideTrigger&&(this.hideTrigger=Boolean(e))}updateHideTrigger(e){this.element.classList[e?"add":"remove"]("b-hide-trigger")}updateKeyStrokeFilterDelay(e){this.filterOnInput.delay=e}updateReadOnly(e){super.updateReadOnly(...arguments),this._chipView&&(this._chipView.closable=!e)}updateDisabled(e){super.updateDisabled(...arguments),this._chipView&&(this._chipView.closable=!e)}updateFilterOperator(e){this.primaryFilter&&(this.primaryFilter.operator=e)}get minChars(){const e=this._minChars;return null!=e?e:this.remoteFilter?4:1}get validateFilter(){return this._validateFilter&&!this.createOnUnmatched}get items(){return this.store.allRecords}updateBuildItems(e){e&&(this.items=e.call(this))}changeItems(e){var t;const n=this;if(null==e){if(n.store&&!n.store.isItemStore)return;e=[]}if(!n.buildItems||null!==(t=e)&&void 0!==t&&t.length||(e=n.buildItems()),e instanceof Li)return void(n.store=e);const r=n.displayField;let s,i,a=n.valueField;if(Array.isArray(e)?i=e.map((e=>{let t=e;return e instanceof Ns?(s=e.constructor,a||(n.valueField=a=s.idField)):"string"==typeof e||"number"==typeof e?(a||(n.valueField=a=n.displayField),t={[a]:e,[r]:e}):(a||(n.valueField=a="value"),Array.isArray(e)&&(t={[a]:e[0],[r]:e[1]})),e.selected&&(n.value=t),t})):(a||(n.valueField=a="value"),i=[],Object.entries(e).forEach((([e,t])=>{i.push({[a]:e,[r]:t})}))),n.store)n.store.data=i;else{const e=a===r?{name:"value",dataSource:r}:a;if(!s){class t extends Ns{static get idField(){return n.valueField}static set idField(e){super.idField=e}static get fields(){return[e,r]}}s=t}n.store=new Li({isItemStore:!0,data:i,idField:a,verifyNoGeneratedIds:!1,modelClass:s})}}get value(){const e=this,{valueCollection:t,valueField:n}=e;if(null==n)return e.multiSelect?t.values.slice():t.first;let r;return r=e.multiSelect?t.count?t.map((e=>e[n])):e._lastValue||[]:t.count?t.first[n]:e._lastValue,r}set value(e){super.value=e}get needsInputSync(){return!this.usesChipView&&!this.editable}changeValue(e,t){const n=this;if(e===t)return void n.syncInputFieldValue(!0);if(!n.multiSelect&&Array.isArray(e)&&e.length>1)throw new Error("Multiple values cannot be set to a non-multiSelect Combo");var r;(n.triggerConfig("items"),n.inputting)||(null===(r=n._chipView)||void 0===r||r.selected.clear());n.store||(n.items=[]);const{valueField:s,displayField:i,store:a,valueCollection:o,_picker:l}=n,{storage:c}=a,d=n.hidePickerOnSelect??!n.multiSelect,u=n._isUserAction||(null==l?void 0:l._isUserAction)||d&&n.pickerVisible||!1;if(!n.remoteFilter&&a.isAjaxStore&&!a.count)return a.ion({load:()=>n.value=e,once:!0,thisObj:n}),void(n._lastValue=e);let h;if(null!=e){const r=Array.isArray(e),l=r?e.slice():[e];if(n.remoteFilter){if(null!=e){if(Ut.isObject(e)||e.isModel)n.store.data=[e],n.valueCollection.splice(0,n.valueCollection.count,n.store.first);else{const t=n.isConfiguring;n.primaryFilter.setConfig({value:e,disabled:!1}),a.performFilter(!0).then((()=>{if(n.isDestroyed)return;const{isConfiguring:e}=n;n.isConfiguring=t,o.splice(0,o.count,a.allRecords),n.isConfiguring=e}))}return}}else a.isFiltered&&(n.primaryFilter.disabled=!0,a.filter());for(let e=0,t=l.length;e<t;e++){let n=l[e];if(n instanceof Ns)c.includes(n,!0)||a.add(n);else{const r=Ut.isObject(n);r&&(n=n[a.modelClass.fieldMap[s].dataSource]),h=c.getBy(i,n)||c.getBy(s,n)||o.getBy(i,n)||o.getBy(s,n),h instanceof Set&&(h=[...h][0]),h?(r&&h.set(l[e]),l[e]=h):(l.splice(e,1),t--,e--)}}const d=!l.length,g=o.generation;o.splice(0,o.count,l),d&&(n._value=r&&0===e.length?null:e,n._lastValue=n._value),(d||o.generation===g)&&n.syncInputFieldValue(),n.syncEmpty(),d&&!n.isConfiguring&&n.triggerFieldChange({value:e,oldValue:t,userAction:u,valid:n.isValid})}else if(o.count)o.clear();else{const t=n._value;n._value=null,n.syncInputFieldValue(),n.syncEmpty(),n.isConfiguring||n.triggerFieldChange({value:e,oldValue:t,userAction:u,valid:n.isValid})}n._lastValue=n._value}hasChanged(e,t){return this.multiSelect?!Ut.isEqual(e,t):super.hasChanged(...arguments)}onComboStoreChange({action:e}){"filter"!==e&&this.syncInputFieldValue(!0)}syncInputFieldValue(e){var t;this.usesChipView?null===(t=this.chipView)||void 0===t||t.refresh():super.syncInputFieldValue(e)}get usesChipView(){return Boolean(this.multiSelect&&this._chipView)}get isEmpty(){return 0===this.valueCollection.count}get inputValue(){const e=this;let t=e.selected?e.selected[e.displayField]:e.value;return e.displayValueRenderer&&(t=e.callback(e.displayValueRenderer,e,[e.selected,e])),null==t?"":t}get nonEditableClickTarget(){var e;return this.multiSelect&&(null===(e=this.chipView)||void 0===e?void 0:e.element)||super.nonEditableClickTarget}changeValueCollection(e,t){if(null==t||t.destroy(),e)return e.isCollection||(e=new ni({internalListeners:{noChange:"onValueCollectionNoChange",change:"onValueCollectionChange",prio:-1e3,thisObj:this}})),e}changePrimaryFilter(e){return e.isCollectionFilter?e.setConfig({disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive}):("function"==typeof e&&(e={filterBy:e}),e=new Ws({id:"primary",disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive,...e})),e}changeStore(e){const t=this,n=[],{valueCollection:r,keyStrokeFilterDelay:s,filterParamName:i}=t;if(Array.isArray(e))return void(t.items=e);let a;if(e){if(e.isStore){const r=e.filters.get("primary");t.remoteFilter&&(e.filterParamName=i),a=e.remoteFilter||e.restfulFilter,r?t.primaryFilter=r:n.push(t.primaryFilter)}else"string"==typeof e?e=Li.getStore(e):(e=new(e.readUrl?ji:Li)(e),t.destroyStore=!0),a=t.remoteFilter||e.restfulFilter,a&&i&&(e.filterParamName=i,t.encodeFilterParams&&(e.encodeFilterParams=t.encodeFilterParams)),n.push(t.primaryFilter);if(t.valueField||t.usingRecordAsValue||(t.valueField=e.modelClass.idField),t.filterSelected){const s=e=>!t.containsFocus||!r.includes(e);a?(e.storage.autoFilter=!0,e.storage.addFilter({id:`${t.id}-selected-filter`,filterBy:s})):(n.push(s),e.reapplyFilterOnAdd=!0)}r.addIndex({property:t.displayField,unique:!1}),r.addIndex({property:t.valueField,unique:!0}),n.forEach((t=>e.addFilter(t,!0))),t.keyStrokeFilterDelay=a?Math.max(300,s||0):s??10}return e}updateStore(e,t){const n=this,{_picker:r}=n;let s;n.destroyStore&&t&&t.destroy(),r&&(r.store=e),e.storage.addIndex({property:n.displayField,unique:!1}),e.storage.addIndex({property:n.valueField,unique:!0}),s={filter:"onStoreFilter"},n.displayValueRenderer&&((s||(s={})).change="onComboStoreChange"),n.detachListeners("store"),(null==e?void 0:e.storage)&&n.valueCollection.match(e.storage),n.syncInputFieldValue(),s&&(s.name="store",s.thisObj=n,e.ion(s))}get remoteFilter(){var e;return Boolean(this.filterParamName||(null===(e=this._store)||void 0===e?void 0:e.restfulFilter))}get record(){return this.selected}get records(){return this.valueCollection.values.slice()}get selected(){const{store:e}=this;return this.multiSelect?this.valueCollection.values.slice().sort(((t,n)=>e.indexOf(t)-e.indexOf(n)))[0]:this.valueCollection.first}onEditComplete(){const e=this,t=e.valueCollection.count;super.onEditComplete(),t&&(e.clearError(uh),e.syncInputFieldValue()),e.required&&!t&&e.setError(dh)}onTriggerClick(e){const t=this,n="key"in e;if(!(t.ignoreTriggerClick||t.remoteFilter&&t.filterOnEnter))if(t.pickerVisible)t.hidePicker();else if(!t.readOnly&&!t.disabled){var r;switch(null===(r=t.triggerAction)||void 0===r?void 0:r.toLowerCase()){case"all":t.doFilter(null,n);break;case"last":t.doFilter(t.lastQuery,n);break;default:t.doFilter(t.input.value,n)}}}internalOnInput(e){const t=this;t.syncEmpty(),t.syncInputWidth(),t.filterOnInput(e),t.trigger("input",{value:t.input.value,event:e})}filterOnInput(e){const t=this,{value:n}="input"===e.type?e.target:t.input,r=n.length;t.inputting=!0,t.inlinePicker||r>=t.minChars&&(!t.filterOnEnter||"Enter"===e.key)?t.doFilter(n):(t.validateFilter&&!t.remoteFilter&&t[r?"setError":"clearError"](uh),t.hidePicker()),t.inputting=!1}syncInputWidth(){const e=this;if(e.usesChipView){const t=e.input,n=e._inputPadding||(e._inputPadding=yr.getEdgeSize(t,"padding","lr")),r=t.value||"",s=yr.measureText(r+"W",t,!1,e.element)+n.width;t.style.flex=`1 1 ${Math.ceil(s)}px`}}doFilter(e,t){var n;const r=this,{store:s,picker:i}=r,a=null==e||""===e;r.lastQuery=e,r.primaryFilter.setConfig({value:e,disabled:a}),r.remoteFilter&&s.clear(!0);const o=()=>{const{navigator:e,isVisible:t}=i;s.count?!a&&e&&(e.activeItem=0):r.remoteFilter||a||(e&&(e.activeItem=null),r.validateFilter&&r.setError(uh)),t&&i.realign()};null===(n=r.filterPromise=s.filter())||void 0===n||n.then((()=>{r.filterPromise=null,o()})),r.inlinePicker||(null!=i&&i.isVisible?0===i.lastAlignSpec.zone&&i.realign():r.showPicker(t)),r.filterPromise||o()}onStoreFilter({source:e}){const t=this,n=t._picker,r=null==n?void 0:n.element.dataset,{count:s}=e;t.remoteFilter&&(s?n&&(n.navigator.activeItem=0):t.validateFilter&&t.setError(uh),t.filterSelected&&t.valueCollection.count&&(e.storage.onFiltersChanged({action:"splice",oldCount:1}),n&&n.refresh())),r&&(t.createOnUnmatched&&!s&&null!=t.primaryFilter.value?r.addNewValue=t.L("L{addNewValue}")(t.primaryFilter.value):null==r||delete r.addNewValue)}onValueCollectionChange({source:e}){const t=this,{multiSelect:n,_picker:r}=t,s=t.hidePickerOnSelect??!n,i=n?e.values.slice():e.first,a=e.values.slice(),o=t._isUserAction||(null==r?void 0:r._isUserAction)||s&&t.pickerVisible||!1,l=t._value;if(s&&t.hidePicker(),!e.count&&t.required?t.setError(dh):(t.clearError(dh),t.clearError(uh)),t.validateFilter&&i&&t.clearError(uh),t.filterSelected){var c,d;const e=null==r?void 0:r.navigator,n=Number(null==e||null===(c=e.activeItem)||void 0===c||null===(d=c.dataset)||void 0===d?void 0:d.index);t.remoteFilter?(t.store.storage.onFiltersChanged({action:"splice",oldCount:1}),t._picker&&t._picker.refresh()):t.store.filter(),isNaN(n)||(e.activeItem=Math.min(r.store.count,n))}t._value=null,t._lastValue=null;const u=t.cacheCurrentValue(t.value);var h;(t.syncInputFieldValue(),t.syncEmpty(),t.isConfiguring)||(t.triggerFieldChange({value:u,oldValue:l,userAction:o,valid:t.isValid}),null===(h=t.trigger)||void 0===h||h.call(t,"select",{record:i,records:a,userAction:o}),"select"===t.defaultAction&&t.trigger("action",{value:u,record:i,records:a,userAction:o}))}cacheCurrentValue(e){return this._value=e}onValueCollectionNoChange({toAdd:e}){!this.inlinePicker&&!this.multiSelect&&e.length&&this.pickerVisible&&(this.picker.hide(),this.syncInputFieldValue())}showPicker(){const e=this,{picker:t}=e;if(!e.readOnly&&!e.inlinePicker){var n;if(t.multiSelect=e.multiSelect,super.showPicker(...arguments),e.overlayAnchor&&!t.align.offset&&(t.align.offset=-t.anchorSize[1],t.realign()),t.restoreActiveItem)if(e.multiSelect)t.restoreActiveItem((null===(n=t.navigator)||void 0===n?void 0:n.previousActiveItem)||e.selected||0,!0);else t.restoreActiveItem(e.selected||0,!0);e.input.focus()}}changePicker(e,t){if(e){var n;const r=this,s=r.pickerWidth||(null===(n=e)||void 0===n?void 0:n.width),i=lh.mergeConfigs({owner:r,store:r.store,selected:r.valueCollection,multiSelect:r.multiSelect,cls:r.listCls,displayField:r.displayField,forElement:r[r.pickerAlignElement],align:{matchSize:null==s,anchor:r.overlayAnchor,target:r[r.pickerAlignElement],minHeight:r.inlinePicker?null:40*Math.min(3,r.store.count)},[r.listItemTpl?"itemTpl":void 0]:r.listItemTpl,width:s,navigator:{keyEventTarget:r.input}},e);r.inlinePicker&&Object.assign(i,{floating:!1,align:null,activateOnMouseover:!1,maxHeight:null,appendTo:r.element}),(e=lh.reconfigure(t,e?i:null,r)).element.classList.add("b-combo-picker"),e.element.dataset.emptyText=r.emptyText?r.L(r.emptyText):r.L("L{noResults}"),e.ion({navigate:"onPickerNavigate",thisObj:r}),Mn.on({element:e.element,pointerdown:e=>r.onPickerNavigate({event:e}),thisObj:r})}else null==t||t.destroy();return e}onPickerNavigate({event:e}){e.target.matches("[data-add-new-value]")&&this.addNewRecord(this.primaryFilter.value)}onPickerHide(){const e=this;super.onPickerHide(),e.multiSelect&&e.clearTextOnPickerHide&&(e.input.value="")}async internalOnKeyEvent(e){const t=this,n=t.input[t.inputValueAttr],r=n.length,{key:s}=e,{primaryFilter:i,store:a,_picker:o,multiSelect:l}=t;if("keydown"===e.type&&null!=o&&o.isVisible&&o.navigator){const{activeItem:r}=o.navigator;if(r&&l&&s===t.multiValueSeparator)return t.input.value="",i.setConfig({value:"",disabled:!0}),a.filter(),o.onItemClick(r,e),o.hide(),void e.preventDefault();if(!r&&t.createOnUnmatched&&(l&&s===t.multiValueSeparator||"Enter"===s))return e.preventDefault(),void await t.addNewRecord(n)}var c;!t.editable&&t.pickerVisible&&("Backspace"===s&&null!==(c=i.value)&&void 0!==c&&c.length?(i.value=i.value.substring(0,i.value.length-1),t.store.filter(),o.restoreActiveItem(0)):"keypress"==e.type&&s.match(hh)&&((!t.lastFilterKepressTime||e.timeStamp-t.lastFilterKepressTime>2e3)&&(i.value=""),i.setConfig({value:(i.value||"")+s,disabled:!1}),t.store.filter(),o.restoreActiveItem(0)),t.lastFilterKepressTime=e.timeStamp);super.internalOnKeyEvent(...arguments),"keydown"===e.type&&"Enter"===s&&t.filterOnEnter&&r>=t.minChars&&(e.stopPropagation(),t.filterOnInput.now(e))}async addNewRecord(e){const t=this,{store:n,_picker:r,valueCollection:s,multiSelect:i,primaryFilter:a}=t,o=n.remoteFilter&&n.autoCommit;t.filterPromise&&await t.filterPromise,o||(a.setConfig({value:"",disabled:!0}),n.filter());const[l]=n.add(t.callback(t.createOnUnmatched,t,[e,t]));if(n.isCommitting){let e;try{await n.commitPromise}catch(t){var c,d;e=null===(c=t.response)||void 0===c||null===(d=c.parsedJson)||void 0===d?void 0:d.error}l.isPhantom&&(t.clearError(),t.setError(e||"L{Combo.recordNotCommitted}",!1,!0),n.remove(l),n.removed.remove(l))}o&&(a.setConfig({value:"",disabled:!0}),n.filter()),t.input.value="",n.includes(l)&&s.splice(i?s.count:0,i?0:s.count,l),null==r||r.hide()}changeCreateOnUnmatched(e){return!0===e&&(e=this.defaultRecordCreater),e}defaultRecordCreater(e){return this.store.createRecord({[this.displayField]:e})}updateLocalization(){super.updateLocalization();const e=this,{displayField:t}=e;let{localizedDisplayFieldsMap:n}=e;if(!0===e.localizeDisplayFields){n||(e.localizedDisplayFieldsMap=n=new Map),!e.store&&e.buildItems&&(e.items=e.buildItems());for(const s of e.items)if(s.id){var r;let i=n.get(s.id);!i&&null!==(r=s[t])&&void 0!==r&&r.startsWith("L{")&&(i=s[t],n.set(s.id,i)),i&&(s[t]=e.L(i))}e.syncInputFieldValue()}}}class mh extends ch{static get $name(){return"ComboChipView"}static get type(){return"combochipview"}static get defaultConfig(){return{closeHandler:"up.onChipClose",itemsFocusable:!1,multiSelect:!0,itemTpl(e){return T.encodeHtml(e.getValue(this.owner.displayField))},scrollable:{overflowY:"auto"}}}}gh.initClass(),mh.initClass(),class extends $d{static get $name(){return"ComboChipNavigator"}static get type(){return"combochipnavigator"}static get configurable(){return{allowShiftKey:!0}}onTargetClick(e){const t=this,n=e.target.closest(t.itemSelector);n&&!e.target.classList.contains("b-close-icon")&&(e.shiftKey||n.contains(e.target.closest("[data-noselect]"))||t.ownerCmp.selected.clear(),t.inClickHandler=!0,t.activeItem=n,t.inClickHandler=!1)}onKeyDown(e){"Enter"===e.key||e.target.selectionStart||e.target.selectionEnd||super.onKeyDown(e)}updateActiveItem(e,t){const n=this.ownerCmp;super.updateActiveItem(e,t),e&&!this.inClickHandler&&n.selected.add(n.getRecordFromElement(e))}navigatePrevious(e){const t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.previous?super.navigatePrevious(e):this.activeItem=null}navigateNext(e){const t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.next?super.navigateNext(e):this.activeItem=null}}.initClass(),gh._$name="Combo";class ph extends yl{static $name="UndoRedoBase";static type="undoredobase";static get configurable(){return{project:null,stm:null,text:null,color:null,showZeroActionBadge:null,cls:"b-undo-controls b-toolbar",layoutStyle:{alignItems:"stretch",flexFlow:"row nowrap",overflow:"visible"},items:{undoBtn:{type:"button",icon:"b-icon-undo",tooltip:"L{UndoRedo.UndoLastAction}",onAction:"up.onUndo"},transactionsCombo:{type:"combo",valueField:"idx",editable:!1,store:{},emptyText:"L{UndoRedo.NoActions}",onAction:"up.onTransactionSelected",displayValueRenderer:"up.transactionsDisplayValueRenderer"},redoBtn:{type:"button",icon:"b-icon-redo",tooltip:"L{UndoRedo.RedoLastAction}",onAction:"up.onRedo"}},overflowable:!0}}afterConstruct(){this.updateUndoRedoControls()}updateStm(e){this.detachListeners("undoredo"),null==e||e.ion({name:"undoredo",recordingstop:"updateUndoRedoControls",restoringstop:"updateUndoRedoControls",queueReset:"updateUndoRedoControls",disabled:"updateUndoRedoControls",thisObj:this})}changeItems(e){const{undoBtn:t,redoBtn:n}=e;return this.color&&(t&&(t.color=this.color),n&&(n.color=this.color)),this.text&&(t&&(t.text="L{UndoRedo.Undo}"),n&&(n.text="L{UndoRedo.Redo}")),super.changeItems(e)}updateProject(e){this.stm=e.stm}fillUndoRedoCombo(){const{transactionsCombo:e}=this.widgetMap;e&&(e.items=[[0,"Original data"],...this.stm.queue.map(((e,t)=>[t+1,e||`Transaction ${t+1}`]))])}updateUndoRedoControls(){const{stm:e,showZeroActionBadge:t}=this,{undoBtn:n,redoBtn:r,transactionsCombo:s}=this.widgetMap;n.badge=e.position||(t?"0":""),r.badge=e.length-e.position||(t?"0":""),n.disabled=!e.canUndo,r.disabled=!e.canRedo,this.fillUndoRedoCombo(),s&&(s.disabled=s.store.count<=1)}transactionsDisplayValueRenderer(e,t){var n;const r=(null===(n=this.stm)||void 0===n?void 0:n.position)||0;return`${r} undo actions / ${t.store.count-r-1} redo actions`}onUndo(){this.stm.canUndo&&this.stm.undo()}onRedo(){this.stm.canRedo&&this.stm.redo()}onTransactionSelected(e){const{stm:t}=this,n=t.position-e.value;n>0?t.canUndo&&t.undo(n):n<0&&t.canRedo&&t.redo(-n)}}ph.initClass(),ph._$name="UndoRedoBase";class fh extends gh{static $name="BooleanCombo";static type="booleancombo";static get configurable(){return{positiveValue:!0,positiveText:null,negativeValue:!1,negativeText:null,store:{value:[],$config:"lazy"},value:!1}}changeStore(e,t){const n=this;return super.changeStore(new Li({data:[{id:n.positiveValue,text:n.positiveText||n.L("L{Object.Yes}")},{id:n.negativeValue,text:n.negativeText||n.L("L{Object.No}")}]}),t)}}fh.initClass(),fh._$name="BooleanCombo";class vh extends(yl.mixin(Pl)){static $name="ButtonGroup";static type="buttongroup";static configurable={defaultType:"button",cls:null,items:null,color:null,toggleGroup:null,valueSeparator:",",columns:null,hideWhenEmpty:!0,defaultBindProperty:"value"};onChildAdd(e){super.onChildAdd(e),e.ion({click:"resetValueCache",toggle:"onItemToggle",thisObj:this,prio:1e4})}onChildRemove(e){e.un({toggle:"resetValueCache",click:"resetValueCache",thisObj:this}),super.onChildRemove(e)}onItemToggle(e){const t=this;t.resetValueCache(),t.isSettingValue||t.toggleGroup&&!e.pressed||t.triggerFieldChange({value:t.value,userAction:!0,event:e})}resetValueCache(){this._value=null}createWidget(e){const t=this;return t.constructor.resolveType(e.type||"button").isButton&&(t.color&&!e.color&&(e.color=t.color),t.toggleGroup&&!e.toggleGroup&&("boolean"==typeof t.toggleGroup&&(t.toggleGroup=vh.generateId("toggleGroup")),e.toggleGroup=t.toggleGroup)),t.columns&&(e.width=100/t.columns+"%"),e=super.createWidget(e),t.relayEvents(e,["click","action","toggle"]),e}updateRotate(e){this.eachWidget((t=>{!1!==t.rotate&&(t.rotate=e)}))}get value(){if(!this._value){const e=[];this.items.forEach((t=>{t.pressed&&void 0!==t.value&&e.push(t.value)})),this._value=e.join(this.valueSeparator)}return this._value}set value(e){const t=this,n=t.value;Array.isArray(e)||(e=null==e?[]:"string"==typeof e?e.split(t.valueSeparator):[e]),t._value=e.join(t.valueSeparator),t.isSettingValue=!0,t.items.forEach((t=>{void 0!==t.value&&(t.pressed=e.includes(t.value))})),t.isSettingValue=!1,t.isConfiguring||n===t.value||t.triggerFieldChange({value:t.value,userAction:!1})}updateDisabled(e){this.items.forEach((t=>t.disabled=e||!t.ignoreParentReadOnly&&this.readOnly))}updateReadOnly(e){super.updateReadOnly(e),this.updateDisabled(this.disabled)}get widgetClassList(){const e=super.widgetClassList;return this.columns&&e.push("b-columned"),e}}vh.initClass(),vh._$name="ButtonGroup";class yh extends Hc{static $name="CalendarPanel";static type="calendarpanel";static get configurable(){return{layout:"vbox",textContent:!1,date:{$config:{equal:"date"},value:null},month:{},year:null,weekStartDay:null,sixWeeks:!0,showWeekNumber:null,showWeekColumn:null,disabledDates:null,headerRenderer:null,weekRenderer:null,cellRenderer:null,disableWeekends:null,hideNonWorkingDays:null,hideNonWorkingDaysCls:"b-hide-nonworking-days",nonWorkingDays:null,tip:null,dayCellCls:"b-calendar-cell",dayHeaderCls:"b-calendar-day-header",disabledCls:"b-disabled-date",otherMonthCls:"b-other-month",weekendCls:"b-weekend",todayCls:"b-today",nonWorkingDayCls:"b-nonworking-day",dayNameFormat:"ddd",minRowHeight:{$config:["lazy"],value:null},minColumnWidth:{$config:["lazy"],value:null},disableOtherMonthCells:null,disableOtherMonthCellsCls:"b-disable-othermonth-cells",hideOtherMonthCells:null,hideOtherMonthCellsCls:"b-hide-othermonth-cells",animateTimeShift:!0}}construct(e){super.construct(e),this.refreshCount||this.refresh()}onInternalPaint({firstPaint:e}){var t;null===(t=super.onInternalPaint)||void 0===t||t.call(this,...arguments),e&&(this.refreshCount||this.refresh(),this.getConfig("minColumnWidth"),this.getConfig("minRowHeight"))}get overflowElement(){return this.weeksElement}doDestroy(){var e;null===(e=this.tip)||void 0===e||e.destroy(),super.doDestroy()}updateMinRowHeight(e){this.element.style.setProperty("--min-row-height",yr.setLength(e)),this.scrollable={overflowY:!!e&&"auto"}}updateMinColumnWidth(e){const t=this;t.element.style.setProperty("--min-column-width",yr.setLength(e)),t.scrollable={overflowX:!!e&&"auto"},t.overflowElement.classList[e?"add":"remove"]("b-min-columnwidth")}getDateFromDomEvent(e){const t=(e.nodeType===Element.ELEMENT_NODE?e:e.target).closest(`#${this.id} [data-date]`);if(t)return Bt.parseKey(t.dataset.date)}changeTip(e,t){const n=this;return Xu.reconfigure(t,e,{owner:n,defaults:{type:"tooltip",owner:n,id:`${n.id}-cell-tip`,forElement:n.bodyElement,forSelector:`.${n.dayCellCls}`}})}updateTip(e){this.detachListeners("tip"),null==e||e.ion({pointerOver:"onTipOverCell",name:"tip",thisObj:this})}updateElement(e,t){const n=this;super.updateElement(e,t),n.updateHideNonWorkingDays(n.hideNonWorkingDays),n.weekdayCells=Array.from(e.querySelectorAll(".b-calendar-day-header")),n.weekElements=Array.from(e.querySelectorAll(".b-calendar-week")),n.weekDayElements=Array.from(e.querySelectorAll(".b-calendar-days")),n.cellElements=[];for(let e=0,{length:t}=n.weekDayElements;e<t;e++)n.cellElements.push(n.weekDayElements[e].previousSibling,...n.weekDayElements[e].children)}changeDate(e){if(e="string"==typeof e?Bt.parse(e):new Date(e),isNaN(e))throw new Error("CalendarPanel date ingestion must be passed a Date, or a YYYY-MM-DD date string");return Bt.clearTime(e)}updateDate(e){this.month.date=e}updateDayNameFormat(){const e=new Date("2000-06-04T12:00:00");this.shortDayNames=[];for(let t=4;t<11;t++)e.setDate(t),this.shortDayNames.push(Bt.format(e,this.dayNameFormat))}get weekStartDay(){return"number"==typeof this._weekStartDay?this._weekStartDay:Bt.weekStartDay}updateWeekStartDay(e){const t=this;if(t._month){t.month.weekStartDay=e,t.dayNames=[];for(let e=0;e<7;e++)t.dayNames[e]=t.shortDayNames[t.canonicalDayNumbers[e]];t.refreshCount&&t.refresh()}}updateHideNonWorkingDays(e){var t;this.contentElement.classList.toggle(this.hideNonWorkingDaysCls,Boolean(e)),null===(t=this.scrollable)||void 0===t||t.syncOverflowState(),this._month&&(this.month.hideNonWorkingDays=e),this.isConfiguring||this.refresh()}updateHideOtherMonthCells(e){var t;this.element.classList.toggle(this.hideOtherMonthCellsCls,Boolean(e)),null===(t=this.scrollable)||void 0===t||t.syncOverflowState()}updateDisableOtherMonthCells(e){var t;this.element.classList.toggle(this.disableOtherMonthCellsCls,Boolean(e)),null===(t=this.scrollable)||void 0===t||t.syncOverflowState()}get nonWorkingDays(){return this._nonWorkingDays||this._localeNonWorkingDays||(this._localeNonWorkingDays=Bt.nonWorkingDays)}get weekends(){return this._localeWeekends||(this._localeWeekends=Bt.weekends)}changeNonWorkingDays(e){return Ut.assign({},e)}updateNonWorkingDays(e){var t;this._month&&(this.month.nonWorkingDays=e,this.refresh(),null===(t=this.scrollable)||void 0===t||t.syncOverflowState())}get visibleDayColumnIndex(){return this.month.visibleDayColumnIndex}get dayColumnIndex(){return this.month.dayColumnIndex}get canonicalDayNumbers(){return this.month.canonicalDayNumbers}get visibleColumnCount(){return this.month.visibleColumnCount}get weekLength(){return this.month.weekLength}get startDate(){return this.month.startDate}get duration(){return Bt.diff(this.month.startDate,this.month.endDate,"day")+1}get endDate(){const{endDate:e}=this.month;if(e)return Bt.add(e,1,"day")}changeMonth(e,t){const n=this;if(!(e instanceof Tu)){if("number"==typeof e){if(t)return void(t.month=e);const r=n.date||Bt.clearTime(new Date);r.setMonth(e),e={date:r}}e=Tu.new({weekStartDay:n.weekStartDay,nonWorkingDays:n.nonWorkingDays,hideNonWorkingDays:n.hideNonWorkingDays,sixWeeks:n.sixWeeks},e)}return e.ion({dateChange:"onMonthDateChange",thisObj:n}),e}onMonthDateChange({source:e,newDate:t,oldDate:n,changes:r}){const s=this;if(s.year=e.year,!s.isConfiguring){if(!s.getCell(t)||r.m||r.y){const{isVisible:e}=s;s.refresh(),s.animateTimeShift&&e&&yr.slideIn(s.contentElement,t>n?1:-1)}s.trigger("dateChange",{changes:r,value:t,oldValue:n})}}updateYear(e){this.month.year=e}updateShowWeekNumber(e){this.updateShowWeekColumn(e)}updateShowWeekColumn(e){const t=this;t.element.classList[e?"add":"remove"]("b-show-week-column"),t.floating&&(t.isAligning||t.realign())}updateSixWeeks(e){this.month&&(this.month.sixWeeks=e,this.refresh())}refresh(){this.doRefresh()}doRefresh(){var e;this.getConfig("element");const t=this,n=null!=t.timeZone?t.timeZone:null===(e=t.project)||void 0===e?void 0:e.timeZone,r=null!=n?Dd.toTimeZone(new Date,n):new Date,{weekElements:s,weekDayElements:i,date:a,month:o,dayCellCls:l,dayHeaderCls:c,disabledCls:d,otherMonthCls:u,weekendCls:h,todayCls:g,nonWorkingDayCls:m,nonWorkingDays:p,canonicalDayNumbers:f,sixWeeks:v}=t;if(r.setHours(0,0,0,0),!a)return void(t.date=r);t.element.style.setProperty("--visible-week-count",o.weekCount),t.trigger("beforeRefresh"),t.getConfig("dayNameFormat");for(let e=0;e<7;e++){const n=t.weekdayCells[e],r=t.canonicalDayNumbers[e],s={[c]:1,[h]:Bt.weekends[r],[m]:p[r]};t.headerRenderer?(n.innerHTML="",t.callback(t.headerRenderer,t,[n,e,r])):yr.setInnerText(n,t.shortDayNames[r]),yr.syncClassList(n,s),n.dataset.columnIndex=e,n.dataset.cellDay=r}let y=0,b=0,C=6;for(let e=6;e>=0;e--)if(!p[f[e]]){C=e;break}s[4].classList.toggle("b-hide-display",o.weekCount<5&&!v),s[5].classList.toggle("b-hide-display",o.weekCount<6&&!v),o.eachWeek(((e,n)=>{const a=i[y],c=[a.previousSibling,...a.children];s[y].dataset.week=`${e[0]},${e[1]}`,t.weekRenderer?t.callback(t.weekRenderer,t,[c[0],e]):c[0].innerText=e[1];for(let i=0;i<7;i++){const a=n[i],f=a.getDay(),v=Bt.makeKey(a),S=p[f],w=c[i+1],D={[l]:1,[d]:t.isDisabledDate(a),[u]:a.getMonth()!==o.month,[h]:Bt.weekends[f],[g]:a.getTime()===r.getTime(),[m]:S,"b-last-working-day":i===C,"b-first-visible-cell":!(a-(t.firstVisibleDate||-1)),"b-last-visible-cell":!(a-(t.lastVisibleDate||-1)),[`b-day-of-week-${f}`]:1};yr.syncClassList(w,D),w.dataset.date=v,w.dataset.cellIndex=b,w.dataset.columnIndex=i,w.lastDomConfig&&(delete w.lastDomConfig.class,delete w.lastDomConfig.className),t.cellRenderer?t.callback(t.cellRenderer,t,[{cell:w,date:a,day:f,row:s[y],rowIndex:y,cellIndex:b,columnIndex:i,visibleColumnIndex:t.visibleDayColumnIndex[f],week:e,key:v}]):w.innerHTML=a.getDate(),b++}y++})),t.visibleWeekCount=y,t.floating&&(t.isAligning||t.realign()),t.refreshCount=(t.refreshCount||0)+1,t.trigger("refresh")}isDisabledDate(e){const t=e.getDay(),{disabledDates:n,nonWorkingDays:r}=this;return!(!this.disableWeekends||!r[t])||(n?Array.isArray(n)?(e=Bt.clearTime(e,!0),n.some((t=>!(Bt.clearTime(t,!0)-e)))):this.callback(this.disabledDates,this,[e]):void 0)}get bodyConfig(){const e=super.bodyConfig,t=[];e.children=[{tag:"div",className:"b-calendar-row b-calendar-weekdays",reference:"weekdaysHeader",children:[{class:"b-week-number-cell"},...ge.fill(7,{class:this.dayHeaderCls}),yr.scrollBarPadElement]},{className:"b-weeks-container notranslate",reference:"weeksElement",children:t}];for(let e=0;e<6;e++){const n={className:"b-calendar-row b-calendar-week",dataset:{rowIndex:e},children:[{className:"b-week-number-cell"},{className:"b-calendar-days",children:[{},{},{},{},{},{},{}],syncOptions:{ignoreRefs:!0,strict:!1}}]};t.push(n)}return e}get firstVisibleDate(){if(this.hideOtherMonthCells){const{year:e,month:t}=this.month;return new Date(e,t,1)}for(const e=this,t=e.month.startDate;;t.setDate(t.getDate()+1))if(!e.hideNonWorkingDays||!e.nonWorkingDays[t.getDay()])return t}get lastVisibleDate(){const e=Bt.add(this.endDate,-1,"d");if(this.hideOtherMonthCells)return e;for(const t=this,n=e;;n.setDate(n.getDate()-1))if(!t.hideNonWorkingDays||!t.nonWorkingDays[n.getDay()])return n}getCell(e,t){"string"!=typeof e&&(e=Bt.makeKey(e));const n=this.weeksElement.querySelector(`[data-date="${e}"]`);if(n&&(!t||!n.classList.contains(this.otherMonthCls)))return n}onTipOverCell({source:e,target:t}){e.date=Bt.parseKey(t.dataset.date)}updateLocalization(){this._localeNonWorkingDays=this._localeWeekends=null,this.updateDayNameFormat(),this.updateWeekStartDay(this.weekStartDay),super.updateLocalization()}}yh.initClass(),yh._$name="CalendarPanel";const bh=e=>!e.value;class Ch extends sh{static $name="Checkbox";static type="checkbox";static alias="check";static get configurable(){return{inputType:"checkbox",autoCollapse:null,containerDefaults:{syncableConfigs:{disabled:e=>e.disabled||!e.value},syncConfigTriggers:{autoCollapse:1,value:1}},text:"",checkedValue:!0,uncheckedValue:!1,color:null,value:"",toggleGroup:null,localizableProperties:["label","text"]}}construct(e){"checked"in e&&((e=Ut.assign({},e)).value=e.checked,delete e.checked),super.construct(e),this.syncHasText()}get textLabelCls(){return"b-checkbox-label"}get innerElements(){return[this.inputElement,{tag:"label",class:this.textLabelCls,for:`${this.id}-input`,reference:"textLabel",html:this.text||""}]}get inputElement(){const e=super.inputElement;return this.toggleGroup&&(e.dataset={group:this.toggleGroup}),e.listeners={click:"internalOnClick",change:"internalOnChange",input:"internalOnInput"},e}get checked(){return this.value}set checked(e){this.value=e}syncHasText(){this.element.classList[this.text?"add":"remove"]("b-text")}updateText(e){this.textLabel&&(this.syncHasText(),this.textLabel.innerHTML=e)}afterSyncChildConfigs(e){super.afterSyncChildConfigs(e);let{autoCollapse:t}=this;t&&(t=!0===t?bh:t,e.collapsed=t(this))}assignFieldValue(e,t,n){this.value=n===this.checkedValue||n!==this.uncheckedValue&&null}fetchInputValue(){this.readOnly||(this.value=this.input.checked)}gatherValue(e){var t;const n=this,r=n.value?n.checkedValue:n.uncheckedValue,s=void 0!==r,{valueName:i}=n;s&&(e[i]=r),n.gatherValues(e,s),!0===r&&(null===(t=e[i])||void 0===t?void 0:t.value)===r&&delete e[i].value}changeValue(e){return"false"!==e&&Boolean(e)}updateValue(e){var t;const n=this,r=n.input.checked!==e;n.input.checked=e,null===(t=n.container)||void 0===t||t.syncChildConfigs(),!r||n.inputting||n.isConfiguring||(n.uncheckToggleGroupMembers(),n.triggerChange(!1,null))}get inputValueAttr(){return"checked"}updateColor(e,t){const n=this.element.classList;t&&n.remove(t),e&&n.add(e)}getToggleGroupMembers(){const e=this,{checked:t,toggleGroup:n,input:r,type:s}=e,i=[];return t&&n&&yr.forEachSelector(e.rootElement,`input[type=${s}][data-group=${n}]`,(e=>{if(e!==r){const t=il.fromElement(e);t&&i.push(t)}})),i}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach((e=>e.checked=!1))}check(){this.checked=!0}uncheck(){this.checked=!1}toggle(){this.checked=!this.checked}internalOnClick(e){return this.readOnly?(e.preventDefault(),!1):this.trigger("click",{event:e})}internalOnChange(e){const t=this;t.readOnly&&t.value!==t.input.checked?t.input.checked=t.value:(t.value=t.input.checked,t.inputting||(t.inputting=!0,t.triggerChange(!0,e),t.inputting=!1))}updateInputReadOnly(e){}triggerChange(e,t){const n=this,{checked:r}=n.input,s={checked:r,value:r,oldValue:!r,userAction:e,valid:!0,event:t};if(!(!r&&e&&n.toggleGroup&&n.getToggleGroupMembers().filter((e=>e.isVisible&&!e.disabled)).length||!1===n.trigger("beforeChange",s)))return n.triggerFieldChange(s,!1),e&&n.uncheckToggleGroupMembers(),n.trigger("action",s),n.trigger("change",s),!0;n.input.checked=n._value=!r}}Ch.initClass(),Ch._$name="Checkbox";class Sh extends lh{static $name="ColorPicker";static type="colorpicker";static configurable={itemsFocusable:!1,navigator:{focusCls:"b-color-active"},itemWrapperTpl(e,t){const{selected:n}=this,{color:r,text:s}=e,i=this.getColorClassName(r);return gd.tpl`
                    <li
                        class="${this.getItemClasses(e,t)} ${i}"
                        role="option"
                        aria-selected="${n.includes(e)}"
                        data-index="${t}"
                        data-id="${T.encodeHtml(r)}"
                        data-btip="${s}"
                        ${this.itemsFocusable?'tabindex="-1"':""}
                        style="${i?"":"background-color: "+r}"
                    ></li>`},colorClasses:null,colorClassPrefix:null,colors:["#45171D","#F03861","#FF847C","#FECEA8","#A5F2E7","#AA83F3","#8983F3","#A10054","#073059","#2866AB","#5FBDC5","#D8D95C","#FFDEDE","#F7F3CE","#C5ECBE","#3E3E3E","#405559","#68868C","#EDEDED","#D3D6DB","#3A4750","#303841","#BE3144"],addNoColorItem:!0,columns:6,colorSelected:null};configure(e){super.configure(e),this.setItems(),this.ion({item:"onColorSelect"})}setItems(){const e=this,{colors:t,colorClasses:n}=e;let r=n||t;e.addNoColorItem&&(r=[...r],r.push(null)),e.items=r.map((t=>t&&"string"!=typeof t?t:{color:t,text:(n?T.capitalize(t):t)||e.L("L{noColor}")}))}afterConfigure(){super.afterConfigure(...arguments),(this.addNoColorItem||this.value)&&this.select(this.value??null)}updateColors(){this.isConfiguring||this.setItems()}updateAddNoColorItem(){this.isConfiguring||this.setItems()}onColorSelect({record:e}){var t;this.refresh();const n={color:e.color,record:e,bubbles:!0};null===(t=this.colorSelected)||void 0===t||t.call(this,n),this.trigger("colorSelected",n)}select(e){e&&"string"!=typeof e||(e=this.store.findRecord("color",e??null)),e&&super.select(e)}updateColumns(e){this.style=`grid-template-columns:repeat(${e}, 1fr);`}getColorClassName(e){var t,n;return null!==(t=this.colorClasses)&&void 0!==t&&t.includes(e)||null!==(n=this.colorClasses)&&void 0!==n&&n.find((t=>t&&t.color===e))?this.colorClassPrefix+e:e?"":"b-no-color"}}Sh.initClass(),Sh._$name="ColorPicker";class wh extends gh{static $name="ColorField";static type="colorfield";static configurable={displayField:"text",valueField:"color",editable:!1,picker:{type:"colorpicker",align:{align:"t100-b100",matchSize:!1}},showBoxForNoColor:!0,colors:null,addNoColorItem:!0};configure(e){const t=e.picker??{};e.colors&&(t.colors=e.colors),"addNoColorItem"in e&&(t.addNoColorItem=e.addNoColorItem),e.picker=t,super.configure(e)}updatePicker(e){e&&(this.items=e.store.records)}updateColors(e){this.isConfiguring||(this.picker.colors=e)}updateAddNoColorItem(e){this.isConfiguring||(this.picker.addNoColorItem=e)}set value(e){this.store||(this.items=[],this.store=this.picker.store),e||(e=this.store.findRecord("color",null)),super.value=e}showPicker(){this.picker.refresh(),super.showPicker(...arguments)}get value(){return super.value}syncInputFieldValue(...e){var t;const n=this,{value:r}=n;let s=null===(t=n.picker)||void 0===t?void 0:t.getColorClassName(r);s||(n.colorBox.style.color=r),s="b-colorbox "+s,n.colorBox.className=s,n.showBoxForNoColor||n.element.classList.toggle("b-colorless",!r),super.syncInputFieldValue(...e)}get innerElements(){return[{reference:"colorBox",className:"b-colorbox"},...super.innerElements]}}wh.initClass(),wh._$name="ColorField";class Dh extends Hc{static $name="YearPicker";static type="yearpicker";static configurable={textContent:!1,tbar:{overflow:null,items:{previous:{type:"tool",cls:"b-icon b-icon-previous",onAction:"up.previous",weight:100},title:{type:"button",cls:"b-yearpicker-title",weight:200,onAction:"up.handleTitleClick"},next:{type:"tool",cls:"b-icon b-icon-next",onAction:"up.next",weight:300}}},itemCls:"b-year-container",yearButtonCount:12,year:null,minYear:null,maxYear:null,startYear:null};construct(e){super.construct({year:(new Date).getFullYear(),...e}),Mn.on({element:this.contentElement,click:"onYearClick",delegate:".b-yearpicker-year",thisObj:this})}get focusElement(){return this.getYearButton(this.year)||this.getYearButton(this.startYear)}getYearButton(e){return this.contentElement.querySelector(`.b-yearpicker-year[data-year="${e}"]`)}get value(){return this.year}set value(e){this.year=e}onYearClick({target:e}){const t=Math.min(Math.max(parseInt(e.innerText),this.minYear||1),this.maxYear||9999);this.year===t?this.trigger("select",{oldValue:t,value:t}):this.year=t}handleTitleClick(e){this.trigger("titleClick",e)}previous(){this.startYear=this.startYear-this.yearButtonCount}next(){this.startYear=this.endYear+1}ingestYear(e){if(!isNaN(e))return Ut.isDate(e)?e.getFullYear():e}changeYear(e){if(e=this.ingestYear(e))return Math.min(Math.max(e,this.minYear||1),this.maxYear||9999)}updateYear(e,t){const n=this;!n.startYear||e>n.endYear?n.startYear=e:e<n.startYear&&(n.startYear=e-(n.yearButtonCount-1)),n.isConfiguring||n.trigger("select",{oldValue:t,value:e})}get endYear(){return this.startYear+this.yearButtonCount-1}changeStartYear(e){if(e=this.ingestYear(e))return e=this.minYear?Math.max(e,this.minYear):e,this.maxYear?Math.min(e,this.maxYear-(this.yearButtonCount-1)):e}async updateStartYear(e,t){this.isVisible&&yr.slideIn(this.contentElement,Math.sign(e-t))}composeBody(){this.getConfig("year");const{startYear:e}=this,t=super.composeBody(),n=t.children[this.tbar?1:0].children=[];this.widgetMap.title.text=`${`000${e}`.slice(-4)} - ${`000${this.endYear}`.slice(-4)}`;for(let t=0,r=e;t<this.yearButtonCount;t++,r++)n.push({tag:"button",dataset:{year:r},class:{"b-yearpicker-year":1,"b-selected":r===this.year},text:`000${r}`.slice(-4)});return t}}Dh.initClass(),Dh._$name="YearPicker";class Th extends ih{static $name="DisplayField";static type="displayfield";static alias="display";static get configurable(){return{readOnly:!0,editable:!1,cls:"b-display-field",template:null,ariaElement:"displayElement"}}get focusElement(){}changeReadOnly(){return!0}changeEditable(){return!1}get inputElement(){return{tag:"span",id:`${this.id}-input`,reference:"displayElement",html:this.template?this.template(this.value):T.encodeHtml(this.value)}}}Th.initClass(),Th._$name="DisplayField";const Eh=()=>Bt.getMonthNames().map(((e,t)=>[t,e])),xh=(e,t)=>e.valueOf()-t.valueOf(),kh=Object.freeze([]);(class extends gh{static get $name(){return"ReadOnlyCombo"}static get type(){return"readonlycombo"}static get configurable(){return{editable:!1,inputAttributes:{tag:"div",tabIndex:-1},inputValueAttr:"innerHTML",highlightExternalChange:!1,monitorResize:!1,triggers:{expand:!1},picker:{align:{align:"t-b",axisLock:!0,matchSize:!1},cls:"b-readonly-combo-list",scrollable:{overflowX:!1}}}}}).initClass();class Ih extends yh{static $name="DatePicker";static type="datepicker";static get delayable(){return{refresh:"raf"}}static get configurable(){return{activeDate:{value:new Date,$config:{equal:"date"}},focusable:!0,textContent:!1,tbar:{overflow:null,items:{prevYear:{cls:"b-icon b-icon-first",onAction:"up.gotoPrevYear",tooltip:"L{DatePicker.gotoPrevYear}"},prevMonth:{cls:"b-icon b-icon-previous",onAction:"up.gotoPrevMonth",tooltip:"L{DatePicker.gotoPrevMonth}"},fields:{type:"container",cls:"b-datepicker-title",items:{monthField:{type:"readonlycombo",cls:"b-datepicker-monthfield",items:Eh(),internalListeners:{select:"up.onMonthPicked"}},yearButton:{type:"button",cls:"b-datepicker-yearbutton",internalListeners:{click:"up.onYearPickerRequested"}}}},nextMonth:{cls:"b-icon b-icon-next",onAction:"up.gotoNextMonth",tooltip:"L{DatePicker.gotoNextMonth}"},nextYear:{cls:"b-icon b-icon-last",onAction:"up.gotoNextYear",tooltip:"L{DatePicker.gotoNextYear}"}}},yearPicker:{value:{type:"YearPicker",yearButtonCount:16,trapFocus:!0,positioned:!0,hidden:!0,internalListeners:{titleClick:"up.onYearPickerTitleClick",select:"up.onYearPicked"}},$config:"lazy"},date:null,minDate:{value:null,$config:{equal:"date"}},maxDate:{value:null,$config:{equal:"date"}},focusDisabledDates:null,multiSelect:!1,selection:{$config:{equal:(e,t)=>e&&e.equals(t)},value:null},editMonth:!0,dayNameFormat:"dd",trapFocus:!0,role:"grid",focusDescendant:!0,alwaysRefreshOnMonthChange:null}}static get prototypeProperties(){return{outOfRangeCls:"b-out-of-range",activeCls:"b-active-date",selectedCls:"b-selected-date"}}construct(e){const t=this;super.construct(e),t.externalCellRenderer=t.cellRenderer,t.cellRenderer=t.internalCellRenderer,t.element.setAttribute("aria-activedescendant",`${t.id}-active-day`),t.weeksElement.setAttribute("role","grid"),t.weekElements.forEach((e=>e.setAttribute("role","row"))),t.element.setAttribute("ariaLabelledBy",t.widgetMap.fields.id),Mn.on({element:t.weeksElement,click:{handler:"onCellClick",delegate:`.${t.dayCellCls}:not(.${t.disabledCls}):not(.${t.outOfRangeCls})`},mousedown:{handler:"onCellMousedown",delegate:`.${t.dayCellCls}`},thisObj:t}),t.widgetMap.monthField.readOnly=t.widgetMap.yearButton.disabled=!t.editMonth,t.refresh.flush()}afterHide(){var e;null===(e=this._yearPicker)||void 0===e||e.hide(),super.afterHide(...arguments)}doDestroy(){var e,t;null===(e=this.yearButton)||void 0===e||e.destroy(),null===(t=this.monthField)||void 0===t||t.destroy(),super.doDestroy()}get focusElement(){return this.weeksElement.querySelector(`.${this.dayCellCls}[tabIndex="0"]`)}doRefresh(){const e=this,{date:t}=e,n=e.focusElement,r=Bt.betweenLesser(e.activeDate,e.month.startDate,e.month.endDate)?e.activeDate:e._activeDate=t;e.getConfig("tbar"),super.doRefresh(...arguments),e.widgetMap.monthField.value=t.getMonth(),e.widgetMap.yearButton.text=t.getFullYear();const s=Bt.parseKey(null==n?void 0:n.dataset.date);r-s&&e.syncActiveDate(r,s)}internalCellRenderer({cell:e,date:t}){const n=this,{activeCls:r,selectedCls:s,externalCellRenderer:i}=n,a=n.isSelectedDate(t),o={[r]:r&&n.isActiveDate(t),[s]:a,[n.outOfRangeCls]:n.minDate&&t<n.minDate||n.maxDate&&t>n.maxDate};if(a&&n.multiSelect){const e=!n.isSelectedDate(Bt.add(t,-1,"d")),r=!n.isSelectedDate(Bt.add(t,1,"d"));o["b-range-start"]=e,o["b-range-end"]=r,o["b-in-range"]=!e&&!r}yr.updateClassList(e,o),e.innerHTML=`<div class="b-datepicker-cell-inner">${t.getDate()}</div>`,e.setAttribute("role","gridcell"),e.setAttribute("aria-label",Bt.format(t,"MMMM D, YYYY")),n.isActiveDate(t)?e.id=`${n.id}-active-day`:e.removeAttribute("id"),i&&(arguments[0].cell=e.firstChild,n.callback(i,this,arguments))}onCellMousedown(e){const t=e.target.closest("[data-date]");t.focus(),yr.getActiveElement(t)===t&&e.preventDefault(),this.activeDate=Bt.parseKey(t.dataset.date)}onCellClick(e){const t=e.target.closest("[data-date]");this.onUIDateSelect(Bt.parseKey(t.dataset.date),e)}onUIDateSelect(e,t){const n=this,{lastClickedDate:r,multiSelect:s}=n;n.lastClickedDate=e,n.isDisabledDate(e)||(n.activatingEvent=t,s?n.handleMultiSelect(r,e,t):(n.selection=e,n.floating&&n.hide()),n.activatingEvent=null)}handleMultiSelect(e,t,n){const r=this,{multiSelect:s}=r,i=r._selection||(r._selection=new Rh),a=i.dates,o="range"===s,{size:l,generation:c}=i,d=l&&{[Bt.makeKey(Bt.add(a[0],-1,"d"))]:1,[Bt.makeKey(a[0])]:1,[Bt.makeKey(a[a.length-1])]:1,[Bt.makeKey(Bt.add(a[a.length-1],1,"d"))]:1},u=i.has(t)?"delete":"add",h=o&&(null==d?void 0:d[Bt.makeKey(t)]);if(n.ctrlKey)!0!==s&&l&&!h||(i[u](t),o&&!i.has(r.rangeStartDate)&&r.rangeStartDate.setDate(r.rangeStartDate.getDate()+(t<a[1]?1:-1)));else if(n.shiftKey&&l){const[n,s]=[new Date(o?r.rangeStartDate||(r.rangeStartDate=a[0]):e),t].sort(xh);o&&i.clear();for(const e=n;e<=s;e.setDate(e.getDate()+1))i.add(e)}else i.has(t)&&1===i.size||(i.clear(),i.add(t));const g=i.size;1===g?r.rangeStartDate=t:g||(r.rangeStartDate=null),i.generation!==c&&r.updateSelection(i)}changeSelection(e){const t=this;let n,r;if(e)if(e.forEach||(e=[e]),e.forEach(((n,r)=>e[r]=t.changeDate(n))),r=e[0],e.sort(xh),"range"===t.multiSelect&&2===e.length){n=new Rh;for(const t=new Date(e[0]);t<=e[1];t.setDate(t.getDate()+1))n.add(t)}else r=e[0],n=new Rh(e);else n=new Rh;return r&&(t.activeDate=t.rangeStartDate=Bt.clearTime(r)),n}updateMultiSelect(e){this.element.classList.toggle("b-multiselect",Boolean(e)),e||(this.selection=[...this.selection][0])}updateSelection(e){const t=this,{dates:n}=e,r="range"===t.multiSelect?[n[0],n[n.length-1]]:n;n.length&&(t.date=n[0]),t.isConfiguring||(t.refresh.now(),t.trigger("selectionChange",{selection:r,userAction:Boolean(t.activatingEvent)}))}get selection(){const{_selection:e}=this,t=e?e.dates:kh;return"range"===this.multiSelect&&t.length?[t[0],t[t.length-1]]:t}onInternalKeyDown(e){const t=this,n=e.key.trim()||e.code,r=t.activeDate;let s=new Date(r);if("Escape"===n&&t.floating)return t.hide();if(r&&t.weeksElement.contains(e.target)){do{switch(n){case"ArrowLeft":e.preventDefault(),e.ctrlKey?s=t.gotoPrevMonth():s.setDate(s.getDate()-1);break;case"ArrowUp":e.preventDefault(),s.setDate(s.getDate()-7);break;case"ArrowRight":e.preventDefault(),e.ctrlKey?s=t.gotoNextMonth():s.setDate(s.getDate()+1);break;case"ArrowDown":e.preventDefault(),s.setDate(s.getDate()+7);break;case"Enter":return t.onUIDateSelect(r,e)}}while(t.isDisabledDate(s)&&!t.focusDisabledDates);if(t.minDate&&s<t.minDate)return;if(t.maxDate&&s>t.maxDate)return;t.activeDate=s}}changeMinDate(e){return e&&yh.prototype.changeDate.apply(this,arguments)}updateMinDate(e){this._yearpicker&&(this._yearpicker.minYear=null==e?void 0:e.getFullYear()),this.refresh()}changeMaxDate(e){return e&&yh.prototype.changeDate.apply(this,arguments)}updateMaxDate(e){this._yearpicker&&(this._yearpicker.maxYear=null==e?void 0:e.getFullYear()),this.refresh()}changeDate(e){return Bt.clamp(super.changeDate(e),this.minDate,this.maxDate)}updateDate(e,t){const n=this,{month:r}=n;if(n.isConfiguring&&!n.initializingActiveDate&&(n.selection=e),!r.date||e.getMonth()===r.month||!n.getCell(e)||n.alwaysRefreshOnMonthChange||n.isNavigating)super.updateDate(e);else{const s=r.getOtherMonth(e),i=n.eventListeners&&(t?e.getDate()!==t.getDate()|(s.getWeekId(e)!==r.getWeekId(t))<<1|(e.getMonth()!==(null==t?void 0:t.getMonth()))<<2|(e.getFullYear()!==(null==t?void 0:t.getFullYear()))<<3:15);n.trigger("dateChange",{changes:{d:!0,w:Boolean(2&i),m:Boolean(12&i),y:Boolean(8&i),r:s.weekCount!==r.weekCount},value:e,oldValue:t})}}changeActiveDate(e,t){if(!1!==this.trigger("beforeActiveDateChange",{activeDate:e,oldActiveDate:t})){if(e=e?this.changeDate(e):this.date||(this.date=Bt.clearTime(new Date)),isNaN(e))throw new Error("DatePicker date ingestion must be passed a Date, or a YYYY-MM-DD date string");return Bt.clamp(e,this.minDate,this.maxDate)}}updateActiveDate(e,t){const n=this,{isConfiguring:r}=n;!r&&n.getCell(e)||(n.initializingActiveDate=r,n.date=e,n.initializingActiveDate=!1),r||n.refresh.isPending||n.syncActiveDate(e,t)}syncActiveDate(e,t){const n=this,{activeCls:r}=n,s=n.getCell(e),i=t&&n.getCell(t),a=yr.getActiveElement(n.element);s.setAttribute("tabIndex",0),r&&s.classList.add(r),s.id=`${n.id}-active-day`,n.weeksElement.contains(a)&&s.focus(),i&&i!==s&&(i.removeAttribute("tabIndex"),r&&i.classList.remove(r),i.removeAttribute("id"))}set value(e){const t=this,{selection:n,duration:r}=t;if(e){if(e=t.changeDate(e,t.value),"range"===t.multiSelect&&2===(null==n?void 0:n.length))return Bt.betweenLesserEqual(e,...n)||(e<n[0]?t.selection=[e,Bt.add(e,r-1,"d")]:t.selection=[Bt.add(e,-(r-1),"d"),e]),void(t.date=t.activeDate=e);void 0!==e&&(t.selection=e)}else t.date=new Date,t.selection=null}get value(){return this.selection[this.selection.length-1]}get duration(){return"range"===this.multiSelect?Bt.diff(...this.selection,"d")+1:1}gotoPrevYear(){return this.goto(-1,"year")}gotoPrevMonth(){return this.goto(-1,"month")}gotoNextMonth(){return this.goto(1,"month")}gotoNextYear(){return this.goto(1,"year")}goto(e,t){const n=this,{activeDate:r}=n,s=r&&n.getCell(r);let i;i="month"===t&&s&&(null==r?void 0:r.getMonth())===n.month.month+e?r:Bt.add(s?r:n.date,e,t);const a=new Date(i);a.setDate(1);const o=Bt.add(Bt.add(a,1,"month"),-1,"day");if(n.minDate&&e<0&&o<n.minDate||n.maxDate&&e>0&&a>n.maxDate)return;n.isNavigating=!0;const l=n.date=i;return s&&(n.activeDate=i),n.isNavigating=!1,l}isActiveDate(e){return!(e-this.activeDate)}isSelectedDate(e){var t;return null===(t=this._selection)||void 0===t?void 0:t.has(e)}onMonthPicked({record:e,userAction:t}){var n;t&&(this.activeDate=Bt.add(this.activeDate,e.value-this.activeDate.getMonth(),"month"),null===(n=this.focusElement)||void 0===n||n.focus())}onYearPickerRequested(){const{yearPicker:e}=this;e.isVisible?e.hide():(e.year=e.startYear=this.activeDate.getFullYear(),e.show(),e.focus())}onYearPickerTitleClick(){this.yearPicker.hide()}onYearPicked({value:e,source:t}){const n=new Date(this.activeDate);n.setFullYear(e),this.activeDate=n,this.focusElement&&yr.focusWithoutScrolling(this.focusElement),t.hide()}changeYearPicker(e,t){var n,r;return Dh.reconfigure(t,e?Dh.mergeConfigs({owner:this,appendTo:this.element,minYear:null===(n=this.minDate)||void 0===n?void 0:n.getFullYear(),maxYear:null===(r=this.maxDate)||void 0===r?void 0:r.getFullYear()},e):null,this)}get childItems(){const{_yearPicker:e}=this,t=super.childItems;return e&&t.push(e),t}updateLocalization(){const{monthField:e}=this.widgetMap,t=Eh();this.isConfiguring||t.every(((t,n)=>t[1]===e.store.getAt(n).text))||(t[e.value??this.date.getMonth()].selected=!0,e.items=t),super.updateLocalization()}}class Rh extends Set{add(e){return e=Bt.makeKey(e),this.has(e)||(this.generation=(this.generation||0)+1),super.add(e)}delete(e){return e=Bt.makeKey(e),this.has(e)&&this.generation++,super.delete(e)}has(e){return super.has(Bt.makeKey(e))}clear(){return this.size&&this.generation++,super.clear()}equals(e){return Array.isArray(e)&&(e=new Rh(e)),e.size===this.size&&[...this].every((t=>e.has(t)))}get dates(){return[...this].sort().map((e=>Bt.parseKey(e)))}}Ih.initClass(),Ih._$name="DatePicker";class Mh extends ah{static $name="DateField";static type="datefield";static alias="date";static get configurable(){return{format:"L",strictParsing:!1,fallbackFormat:"YYYY-MM-DD",timeFormat:"HH:mm:ss:SSS",keepTime:!1,pickerFormat:null,validateDateOnly:null,triggers:{expand:{cls:"b-icon-calendar",handler:"onTriggerClick",weight:200},back:{cls:"b-icon b-icon-angle-left b-step-trigger",key:"Shift+ArrowDown",handler:"onBackClick",align:"start",weight:100},forward:{cls:"b-icon b-icon-angle-right b-step-trigger",key:"Shift+ArrowUp",handler:"onForwardClick",align:"end",weight:100}},calendarContainerCls:"",min:null,max:null,step:!1,stepTriggers:null,weekStartDay:null,picker:{type:"datepicker",role:"dialog",floating:!0,scrollAction:"realign",align:{align:"t0-b0",axisLock:!0}},value:null}}changePicker(e,t){const n=this,r={owner:n,forElement:n[n.pickerAlignElement],minDate:n.min,maxDate:n.max,weekStartDay:n._weekStartDay,align:{anchor:n.overlayAnchor,target:n[n.pickerAlignElement]},onSelectionChange:({selection:e,source:t})=>{t.isVisible&&(n._isUserAction=n._isPickerInput=!0,n.value=n.value?Bt.copyTimeValues(new Date(e[0]),n.value):new Date(e[0]),n._isPickerInput=n._isUserAction=!1,t.hide())}};n.calendarContainerCls&&(r.cls=n.calendarContainerCls),n.value?r.value=n.value:r.activeDate=new Date;const s=Ih.reconfigure(t,e,{owner:n,defaults:r});return null==s||s.refresh.flush(),s}get backShiftDate(){return Bt.add(this.value,-1*this._step.magnitude,this._step.unit)}onBackClick(){const e=this,{min:t}=e;if(!e.readOnly&&e.value){const n=e.backShiftDate;(!t||t.getTime()<=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}get forwardShiftDate(){return Bt.add(this.value,this._step.magnitude,this._step.unit)}onForwardClick(){const e=this,{max:t}=e;if(!e.readOnly&&e.value){const n=e.forwardShiftDate;(!t||t.getTime()>=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}showPicker(e){if(this.readOnly)return;const t=this,{_picker:n}=t;if(n){const e={minDate:t.min,maxDate:t.max};t.value?e.value=t.value:n.activeDate||(e.activeDate=new Date),n.setConfig(e)}super.showPicker(e)}focusPicker(){this.picker.focus()}get isValid(){const e=this;e.clearError("L{Field.minimumValueViolation}",!0),e.clearError("L{Field.maximumValueViolation}",!0);let t=e.value;if(t){const{min:n,max:r,validateDateOnly:s}=e;if(s&&(t=Bt.clearTime(t,!1)),n&&t<n)return e.setError("L{Field.minimumValueViolation}",!0),!1;if(r&&t>r)return e.setError("L{Field.maximumValueViolation}",!0),!1}return super.isValid}transformDateValue(e,t=!0){const n=this;return null!=e&&(Bt.isDate(e)||(e="string"==typeof e?Bt.parse(e,n.format,n.strictParsing)||Bt.parse(e,n.fallbackFormat,n.strictParsing):new Date(e)),Bt.isValidDate(e))?t&&(!n.min||e-n.min>-Bt.MS_PER_DAY)&&(!n.max||e<=n.max)?n.transformTimeValue(e):e:null}transformTimeValue(e){const t=this,{keepTime:n}=t;if(e=Bt.clone(e),n)if("entered"!==n&&!0!==n){const r=Bt.parse(n,t.timeFormat);Bt.isValidDate(r)?Bt.copyTimeValues(e,r):Bt.isValidDate(t.value)&&Bt.copyTimeValues(e,t.value)}else!0===n&&(t._isPickerInput||t.inputting)&&Bt.isValidDate(t.value)&&Bt.copyTimeValues(e,t.value);else Bt.clearTime(e,!1);return e}changeMin(e){return this.transformDateValue(e,!1)}updateMin(e){const{input:t,_picker:n}=this;t&&(null==e?t.removeAttribute("min"):t.min=e),n&&(n.minDate=e),this.syncInvalid()}changeMax(e){return this.transformDateValue(e,!1)}updateMax(e){const{input:t,_picker:n}=this;t&&(null==e?t.removeAttribute("max"):t.max=e),n&&(n.maxDate=e),this.syncInvalid()}get weekStartDay(){return"number"==typeof this._weekStartDay?this._weekStartDay:Bt.weekStartDay}updateWeekStartDay(e){this._picker&&(this._picker.weekStartDay=e)}changeValue(e,t){const n=this,r=n.transformDateValue(e);if(!e||r){if(n.clearError("L{invalidDate}"),n.hasChanged(t,r))return super.changeValue(r,t);n.inputting||n.syncInputFieldValue()}else n.setError("L{invalidDate}")}updateValue(e,t){const n=this._picker;n&&!this.inputting&&(n.value=n.activeDate=e),super.updateValue(e,t)}changeStep(e,t){const n=typeof e;return e?("number"===n?e={magnitude:Math.abs(e),unit:t?t.unit:"day"}:"string"===n&&(e=Bt.parseDuration(e)),e&&e.unit&&e.magnitude?(e.magnitude<0&&(e={magnitude:-e.magnitude,unit:e.unit}),e):void 0):null}updateStep(e){this.element.classList[e?"remove":"add"]("b-no-steppers"),this.syncInvalid()}hasChanged(e,t){return null!=e&&e.getTime&&null!=t&&t.getTime&&"entered"!==this.keepTime&&!0!==this.keepTime?!Bt.isEqual(Bt.clearTime(e),Bt.clearTime(t)):super.hasChanged(e&&e.getTime(),t&&t.getTime())}get inputValue(){const e=this.value;return e?Bt.format(e,this.format):""}updateFormat(){this.isConfiguring||this.syncInputFieldValue(!0)}updateLocalization(){super.updateLocalization(),this.syncInputFieldValue(!0)}internalOnKeyEvent(e){super.internalOnKeyEvent(e),"Enter"===e.key&&this.isValid&&this.picker.hide()}}Mh.initClass(),Mh._$name="DateField";const Oh=e=>e.ctrlKey&&e.preventDefault();class Ah extends sh{static $name="NumberField";static type="numberfield";static alias="number";static get configurable(){return{wrapAround:null,min:null,max:null,step:1,largeStep:0,value:null,format:"",decimalPrecision:null,leadingZeroes:null,triggers:{spin:{type:"spintrigger"}},changeOnSpin:!0,inputType:null}}construct(e){super.construct(e);const t=this;t.input.addEventListener("dblclick",(()=>{t.select()})),"number"==typeof t.changeOnSpin&&(t.bufferedSpinChange=t.buffer(t.triggerChange,t.changeOnSpin))}acceptValue(e,t){let n=!isNaN(e);if(n&&!this.hasTextSelection){n=!1;const e=this.input.value,r=parseFloat(e);e!==t&&(n=!this.acceptValue(r,e))}return n}okMax(e){return isNaN(this.max)||e<=this.max}okMin(e){return isNaN(this.min)||e>=this.min}internalOnKeyEvent(e){if("keydown"===e.type){const t=this,n=e.key;let r;if("ArrowUp"===n)t.doSpinUp(e.shiftKey),r=!0;else if("ArrowDown"===n)t.doSpinDown(e.shiftKey),r=!0;else if(!e.altKey&&!e.ctrlKey&&n&&1===n.length){const e=t.getAfterValue(n),s=t.formatter.parseStrict(e);r=!(s===t.value||"-"===e&&(isNaN(t.min)||t.min<0))&&!t.acceptValue(s,e)}"Enter"===n&&t._changedBySilentSpin&&(t.triggerChange(e,!0),t._changedBySilentSpin=!1),r&&e.preventDefault()}super.internalOnKeyEvent(e)}doSpinUp(e=!1){const t=this;if(t.readOnly)return;let n=(t.value||0)+(e?t.largeStep:t.step);t.okMin(n)||(n=t.min),t.okMax(n)?t.applySpinChange(n):t.wrapAround&&(n=t.min,t.applySpinChange(n))}doSpinDown(e=!1){const t=this;if(t.readOnly)return;let n=(t.value||0)-(e?t.largeStep:t.step);t.okMax(n)||(n=t.max),t.okMin(n)?t.applySpinChange(n):t.wrapAround&&(n=t.max,t.applySpinChange(n))}applySpinChange(e){const t=this;t._isUserAction=!0,!0!==t.changeOnSpin&&(t._changedBySilentSpin=!0,t.silenceChange=!0,t.bufferedSpinChange&&t.bufferedSpinChange(null,!0)),t.value=e,t._isUserAction=!1,t.silenceChange=!1}triggerChange(){this.silenceChange||super.triggerChange(...arguments)}onFocusOut(e){var t,n,r;super.onFocusOut(...arguments);const s=this,{input:i}=s,a=i.value,o=s.formatter.truncate(a),l=isNaN(o)?a:s.formatValue(o);null===(t=s.triggers)||void 0===t||null===(n=t.spin)||void 0===n||null===(r=n.clickRepeater)||void 0===r||r.cancel(),s.lastTouchmove=null,a!==l&&(i.value=l),s._changedBySilentSpin&&(s.triggerChange(e,!0),s._changedBySilentSpin=!1)}internalOnInput(e){const t=this,{formatter:n,input:r}=t,{parser:s,maximumFractionDigits:i}=n,a=r.value,o=s.decimalPlaces(a);if(n.truncator&&o>i){let e,l=a;const c=n.truncate(a);if(!isNaN(c)&&(l=t.formatValue(c),e=s.decimalPlaces(l),e<i&&(l+="0".repeat(i-e),e=i),e<o)){const e=a.length-t.caretPos;r.value=l,t.caretPos=l.length-e+1}}super.internalOnInput(e)}formatValue(e){return this.formatter.format(e)}changeFormat(e){const t=this;if(""===e){const{leadingZeroes:n,decimalPrecision:r}=t;e=n?`${n}>9`:null,null!=r?e=`${e||""}9.${"#".repeat(r)}`:e&&(e+=".*")}return e}get formatter(){const e=this,t=e.format;let n=e._formatter;return n&&e._lastFormat===t||(n=Bd.get(e._lastFormat=t),e._formatter=n),n}updateStep(e){const t=this;var n;(t.element.classList.toggle("b-hide-spinner",!e),t._step=e,e&&r.isMobile)?t.touchMoveListener||(t.touchMoveListener=Mn.on({element:t.input,touchmove:"onInputSwipe",thisObj:t,throttled:{buffer:150,alt:Oh}})):null===(n=t.touchMoveListener)||void 0===n||n.call(t)}onInputSwipe(e){const{lastTouchmove:t}=this;if(t){const n=e.screenX-t.screenX,r=t.screenY-e.screenY;this["doSpin"+((Math.abs(n)>Math.abs(r)?n:r)>0?"Up":"Down")]()}e.preventDefault(),this.lastTouchmove=e}changeLargeStep(e){return e||10*this.step}get validity(){const e=this.value,t={};return null!=e&&(t.rangeUnderflow=!this.okMin(e),t.rangeOverflow=!this.okMax(e)),t.valid=!t.rangeUnderflow&&!t.rangeOverflow,t}changeValue(e,t){const n=this;if(e||0===e){let t;"number"!=typeof e&&(e="string"==typeof e?n.formatter.parse(e):Number(e),t=isNaN(e),t&&(e="")),!t&&n.format&&(e=n.formatter.round(e))}else e=void 0;return super.changeValue(e,t)}get inputValue(){let e=this.value;return null!=e&&this.format&&(e=this.formatValue(e)),e}}Ah.initClass(),Ah._$name="NumberField";class Fh extends Hc{static $name="TimePicker";static type="timepicker";static configurable={floating:!0,layout:"hbox",items:{hour:{label:"L{TimePicker.hour}",type:"number",min:0,max:23,highlightExternalChange:!1,format:"2>9",wrapAround:!0},minute:{label:"L{TimePicker.minute}",type:"number",min:0,max:59,highlightExternalChange:!1,format:"2>9",wrapAround:!0},second:{hidden:!0,label:"L{TimePicker.second}",type:"number",min:0,max:59,highlightExternalChange:!1,format:"2>9",wrapAround:!0},amPm:{type:"buttongroup",items:{amButton:{type:"button",text:"AM",toggleGroup:"am-pm",cls:"b-blue",onClick:"up.onAmPmButtonClick"},pmButton:{type:"button",text:"PM",toggleGroup:"am-pm",cls:"b-blue",onClick:"up.onAmPmButtonClick"}}}},autoShow:!1,trapFocus:!0,seconds:null,value:{$config:{equal:"date"},value:null},format:null,max:null,min:null,initialValue:null};construct(e){super.construct(e),this.refresh()}updateSeconds(e){this.widgetMap.second[e?"show":"hide"]()}onFieldChange(){this.isConfiguring||this.isRefreshing||(this.value=this.pickerToTime())}onAmPmButtonClick({source:e}){this._pm="pmButton"===e.ref,this._value&&(this.value=this.pickerToTime())}onInternalKeyDown(e){var t;const n=this;switch(e.key){case"Escape":return n.triggerTimeChange(n._initialValue),n.hide(),void e.preventDefault();case"Enter":return n.value=n.pickerToTime(),n.hide(),void e.preventDefault()}null===(t=super.onInternalKeyDown)||void 0===t||t.call(this,e)}pickerToTime(){const e=this,t=e._pm,{hour:n,minute:r,second:s}=e.widgetMap;n.format=e._is24Hour?"2>9":null;let i=n.value,a=new Date(e.value);return e._is24Hour||(t&&i<12&&(i+=12),t||12!==i||(i=0)),a.setHours(i),a.setMinutes(r.value),e.seconds&&a.setSeconds(s.value),e._min&&(a=Bt.max(e._min,a)),e._max&&(a=Bt.min(e._max,a)),a}triggerTimeChange(e){this.trigger("timeChange",{time:e})}updateInitialValue(e){this.value=e}changeValue(e){return e&&(e="string"==typeof e?Bt.parse(e,this.format):e),this.isVisible||(this._initialValue=e),e??Bt.getTime(0)}updateValue(e){this.isVisible&&this.triggerTimeChange(e),this.refresh()}updateFormat(e){this._is24Hour=Bt.is24HourFormat(e),this.refresh()}changeMin(e){return"string"==typeof e?Bt.parse(e,this.format):e}changeMax(e){return"string"==typeof e?Bt.parse(e,this.format):e}refresh(){const e=this;if(!e.isConfiguring&&e.value){e.isRefreshing=!0;const{hour:t,minute:n,second:r,amButton:s,pmButton:i}=e.widgetMap,a=e.value,o=e._is24Hour,l=a.getHours(),c=e._pm=l>=12;e.element.classList[o?"add":"remove"]("b-24h"),t.min=o?0:1,t.max=o?23:12,t.value=o?l:l%12||12,n.value=a.getMinutes(),r.value=a.getSeconds(),s.pressed=!c,i.pressed=c,s.hidden=i.hidden=o,e.isRefreshing=!1}}}Fh.initClass(),Fh._$name="TimePicker";class Ph extends ah{static $name="TimeField";static type="timefield";static alias="time";static get configurable(){return{picker:{type:"timepicker",align:{align:"t0-b0",axisLock:!0}},format:"LT",triggers:{expand:{align:"end",handler:"onTriggerClick",compose:()=>({children:[{class:{"b-icon-clock-live":1}}]})},back:{align:"start",cls:"b-icon b-icon-angle-left b-step-trigger",key:"Shift+ArrowDown",handler:"onBackClick"},forward:{align:"end",cls:"b-icon b-icon-angle-right b-step-trigger",key:"Shift+ArrowUp",handler:"onForwardClick"}},min:null,max:null,step:"5m",stepTriggers:null,value:null,keepDate:!1}}changePicker(e,t){const n=this;return Fh.reconfigure(t,e,{owner:n,defaults:{value:n.value,forElement:n[n.pickerAlignElement],owner:n,align:{anchor:n.overlayAnchor,target:n[n.pickerAlignElement]},onTimeChange({time:e}){n._isUserAction=!0,n.value=e,n._isUserAction=!1}}})}onBackClick(){const e=this,{min:t}=e;if(!e.readOnly&&e.value){const n=Bt.add(e.value,-1*e.step.magnitude,e.step.unit);(!t||t.getTime()<=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}onForwardClick(){const e=this,{max:t}=e;if(!e.readOnly&&e.value){const n=Bt.add(e.value,e.step.magnitude,e.step.unit);(!t||t.getTime()>=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}get isValid(){const e=this;e.clearError("L{Field.minimumValueViolation}",!0),e.clearError("L{Field.maximumValueViolation}",!0);let t=e.value;if(t){if(t=t.getTime(),e._min&&e._min.getTime()>t)return e.setError("L{Field.minimumValueViolation}",!0),!1;if(e._max&&e._max.getTime()<t)return e.setError("L{Field.maximumValueViolation}",!0),!1}return super.isValid}hasChanged(e,t){return null!=e&&e.getTime&&null!=t&&t.getTime?e.getHours()!==t.getHours()||e.getMinutes()!==t.getMinutes()||e.getSeconds()!==t.getSeconds()||e.getMilliseconds()!==t.getMilliseconds():super.hasChanged(e,t)}showPicker(){const e=this,{picker:t,value:n}=e;e.readOnly||(t.value=n,t.format=e.format,t.maxTime=e.max,t.minTime=e.min,n||(e.value=t.value),super.showPicker(!0))}onPickerShow(){var e;super.onPickerShow(),this.pickerKeyDownRemover=null===(e=this.pickerKeyDownRemover)||void 0===e?void 0:e.call(this)}focusPicker(){this.picker.focus()}transformTimeValue(e){return null!=e&&("string"==typeof e?(e=Bt.parse(e,this.format),this.keepDate&&(e=Bt.copyTimeValues(new Date(this.value),e))):e=new Date(e),Bt.isValidDate(e))?this.keepDate?e:Bt.getTime(e):null}changeMin(e){return this.transformTimeValue(e)}updateMin(e){const{input:t}=this;t&&(null==e?t.removeAttribute("min"):t.min=e),this.syncInvalid()}changeMax(e){return this.transformTimeValue(e)}updateMax(e){const{input:t}=this;t&&(null==e?t.removeAttribute("max"):t.max=e),this.syncInvalid()}changeValue(e,t){const n=this,r=n.transformTimeValue(e);if(e&&!r||n.isRequired&&""===e)n.setError("L{invalidTime}");else{if(n.clearError("L{invalidTime}"),n.hasChanged(t,r))return super.changeValue(r,t);n.inputting||n.syncInputFieldValue(!0)}}updateValue(e,t){const{expand:n}=this.triggers;n&&e&&(n.element.firstElementChild.style.animationDelay=-(60*e.getHours()+e.getMinutes())/10+"s"),super.updateValue(e,t)}changeStep(e,t){var n,r;const s=typeof e;return e?("number"===s?e={magnitude:Math.abs(e),unit:t?t.unit:"hour"}:"string"===s&&(e=Bt.parseDuration(e)),null!==(n=e)&&void 0!==n&&n.unit&&null!==(r=e)&&void 0!==r&&r.magnitude?(e.magnitude<0&&(e={magnitude:-e.magnitude,unit:e.unit}),e):void 0):null}updateStep(e){this.element.classList[e?"remove":"add"]("b-no-steppers"),this.syncInvalid()}updateFormat(){this.syncInputFieldValue(!0)}get inputValue(){return Bt.format(this.value,this.format)}updateLocalization(){super.updateLocalization(),this.syncInputFieldValue(!0)}}Ph.initClass(),Ph._$name="TimeField";const Lh=new Date(2e3,0,1);class $h extends sh{static $name="DateTimeField";static type="datetimefield";static alias="datetime";static configurable={timeField:{},dateField:{keepTime:!0,step:"1 d"},weekStartDay:null,inputTemplate:()=>"",ariaElement:"element"};doDestroy(){this.dateField.destroy(),this.timeField.destroy(),super.doDestroy()}get focusElement(){return this.dateField.input}get innerElements(){return[this.dateField.element,this.timeField.element]}internalOnKeyEvent(){}updateRevertOnEscape(e){this.timeField.revertOnEscape=e,this.dateField.revertOnEscape=e}changeTimeField(e){const t=this,n=Ph.new({revertOnEscape:t.revertOnEscape,syncInvalid(...e){const n=t.updatingInvalid;Ph.prototype.syncInvalid.apply(this,e),t.timeField&&!n&&t.syncInvalid()}},e);return Mn.on({element:n.element,keydown:"onTimeFieldKeyDown",thisObj:t}),t.readOnly&&(n.readOnly=!0),n}updateTimeField(e){const t=this;e.ion({change({userAction:e,value:n}){if(e&&!t.$settingValue){const e=t.dateField.value;t._isUserAction=!0,t.value=e?Bt.copyTimeValues(new Date(e),n||Lh):null,t._isUserAction=!1}},thisObj:t})}changeDateField(e){const t=this,n=(null==e?void 0:e.type)||"datefield",r=il.resolveType(e.type||"datefield"),s=il.create(Ut.assign({type:n,revertOnEscape:t.revertOnEscape,syncInvalid(...e){const n=t.updatingInvalid;r.prototype.syncInvalid.apply(this,e),t.dateField&&!n&&t.syncInvalid()}},e));return Mn.on({element:s.element,keydown:"onDateFieldKeyDown",thisObj:t}),t.readOnly&&(s.readOnly=!0),s.ion({keydown:({event:e})=>{var t;"Tab"===e.key&&!e.shiftKey&&null!==(t=this.timeField)&&void 0!==t&&t.isVisible&&(e.stopPropagation(),e.cancelBubble=!0)}}),s}get childItems(){return[this.dateField,this.timeField]}updateDateField(e){const t=this;e.ion({change({userAction:e,value:n}){e&&!t.$isInternalChange&&(t._isUserAction=!0,t.timeField.value=n,t.value=n,t._isUserAction=!1)},thisObj:t})}updateWeekStartDay(e){this.dateField&&(this.dateField.weekStartDay=e)}changeWeekStartDay(e){var t;return"number"==typeof e?e:(null===(t=this.dateField)||void 0===t?void 0:t.weekStartDay)??Bt.weekStartDay}syncInputFieldValue(e=this.isConfiguring){super.syncInputFieldValue(!0);const t=this,{dateField:n,timeField:r}=t,s=n.highlightExternalChange,i=r.highlightExternalChange;e||t.highlightExternalChange||(e=!0),t.$isInternalChange=!0,n.highlightExternalChange=!1,n.highlightExternalChange=s,e&&(r.highlightExternalChange=n.highlightExternalChange=!1),r.value=n.value=t.inputValue,n.highlightExternalChange=s,r.highlightExternalChange=i,t.$isInternalChange=!1,t.syncInvalid()}onTimeFieldKeyDown(e){const t=this;if("Enter"===e.key||"Tab"===e.key){const e=t.dateField.value;t._isUserAction=!0,t.value=e?Bt.copyTimeValues(new Date(e),t.timeField.value||Lh):null,t._isUserAction=!1}}onDateFieldKeyDown(e){const t=this;"Tab"!==e.key||e.shiftKey?"Enter"===e.key&&(t.value=t.dateField.value):(e.stopPropagation(),e.preventDefault(),t.timeField.focus())}updateRequired(e,t){this.timeField.required=this.dateField.required=e}updateReadOnly(e,t){super.updateReadOnly(e,t),this.isConfiguring||(this.timeField.readOnly=this.dateField.readOnly=e)}onDisabled(e){this.timeField.disabled=this.dateField.disabled=e}focus(){this.dateField.focus()}hasChanged(e,t){return!Bt.isEqual(e,t)}get isValid(){return this.timeField.isValid&&this.dateField.isValid}setError(e,t){[this.dateField,this.timeField].forEach((n=>n.setError(e,t)))}getErrors(){const e=[...this.dateField.getErrors()||[],...this.timeField.getErrors()||[]];return e.length?e:null}clearError(e,t){[this.dateField,this.timeField].forEach((n=>n.clearError(e,t)))}updateInvalid(){this.updatingInvalid=!0,[this.dateField,this.timeField].forEach((e=>e.updateInvalid())),this.updatingInvalid=!1}}$h.initClass(),$h._$name="DateTimeField";class _h extends ih{static $name="DurationField";static type="durationfield";static alias="duration";static get defaultConfig(){return{value:null,step:1,unit:null,defaultUnit:"day",magnitude:null,useAbbreviation:!1,allowNegative:!1,decimalPrecision:null,triggers:{spin:{type:"spintrigger"}},nullValue:null}}static get configurable(){return{min:null,max:null,allowedUnits:null}}changeMin(e){return"string"==typeof e?new js(e):e}changeMax(e){return"string"==typeof e?new js(e):e}changeAllowedUnits(e){return"string"==typeof e&&(e=e.split(",")),e.length>0&&!e.includes(this.defaultUnit)&&(this.defaultUnit=e[0]),e}updateAllowedUnits(e){this.allowedUnitsRe=new RegExp(`(${e.join("|")})`,"i")}get inputValue(){return null==this.value?"":this.calcValue(!0).toString(this.useAbbreviation)}set unit(e){this._unit=e,this.value=this.calcValue()}get unit(){return this._unit}get unitWithDefault(){return this._unit||this.defaultUnit}set magnitude(e){this.clearError("L{invalidUnit}"),this._magnitude=e,super.value=this.calcValue()}get magnitude(){return this._magnitude}roundMagnitude(e){return e&&null!=this.decimalPrecision?Ut.round(e,this.decimalPrecision):e}get allowDecimals(){return 0!==this.decimalPrecision}get isValid(){const e=this,t=null==e.value||e.value&&null==e.value.magnitude;return super.isValid&&(t&&!e.required||!t&&(e.allowNegative||e.value.magnitude>=0))}internalOnChange(e){const t=this,n=t.value,r=t._lastValue;t.hasChanged(r,n)&&(t._lastValue=n,t.triggerFieldChange({value:n,event:e,userAction:!0,valid:t.isValid}))}onFocusOut(e){var t,n,r;return this.syncInputFieldValue(!0),null===(t=this.triggers)||void 0===t||null===(n=t.spin)||void 0===n||null===(r=n.clickRepeater)||void 0===r||r.cancel(),super.onFocusOut(e)}set value(e){const t=this;let n,r;if(t.getConfig("allowedUnits"),t.clearError("L{invalidUnit}"),"number"==typeof e||"string"==typeof e&&e.length>0&&!isNaN(e))n=Number(e),r=t.unitWithDefault;else if("string"==typeof e)if(/^\s*$/.test(e))n=null;else{const s=Bt.parseDuration(e,t.allowDecimals,t.unitWithDefault);s&&(!t.allowedUnitsRe||t.allowedUnitsRe.test(s.unit)?(r=s.unit,n=s.magnitude):t.setError("L{invalidUnit}"))}else e&&"unit"in e&&"magnitude"in e?(r=e.unit,n=e.magnitude):(r=null,n=null);t._magnitude===n&&t._unit==r||(t._magnitude=n,r&&(t._unit=r),super.value=t.calcValue())}okMax(e){return"number"==typeof e&&(e=new js({unit:this.unitWithDefault,magnitude:e})),null==this.max||e<=this.max}okMin(e){return"number"==typeof e&&(e=new js({unit:this.unitWithDefault,magnitude:e})),null==this.min||e>=this.min}get validity(){const e=this.value,t={};return null!=e&&(t.rangeUnderflow=!this.okMin(e),t.rangeOverflow=!this.okMax(e)),t.valid=!t.rangeUnderflow&&!t.rangeOverflow,t}get value(){return super.value}calcValue(e=!1){const t=this;return t._unit&&null!=t._magnitude||!t.clearable?new js(e?this.roundMagnitude(t._magnitude):this._magnitude,t.unitWithDefault):null}hasChanged(e,t){return t&&!e||!t&&e||t&&e&&!e.isEqual(t)}get milliseconds(){return this.value?this.value.milliseconds:0}onInternalKeyDown(e){"ArrowUp"===e.key?this.doSpinUp():"ArrowDown"===e.key&&this.doSpinDown()}doSpinUp(){const e=this;if(e.readOnly)return;let t=(e.magnitude||0)+e.step;e._isUserAction=!0,e.okMin(t)||(t=e.min),e.okMax(t)&&(e.value=t),e._isUserAction=!1}doSpinDown(){const e=this;if(e.readOnly)return;let t=(e.magnitude||0)-e.step;e.okMax(t)||(t=e.max),e.okMin(t)&&(e.allowNegative||(e.magnitude||0)>0)&&(e._isUserAction=!0,e.value=t,e._isUserAction=!1)}}_h.initClass(),_h._$name="DurationField";class Nh extends ol{static $name="Fit";static type="fit";static configurable={containerCls:"b-fit-container",itemCls:"b-fit-item"}}Nh.initClass(),Nh._$name="Fit";class jh extends yl{static $name="Editor";static type="editor";static configurable={positioned:!0,hidden:!0,layout:"fit",align:{align:"t0-t0",offset:[0,0]},hideTarget:!1,matchSize:!0,matchFont:!0,fitTargetContent:!1,inputField:"textfield",blurAction:"complete",completeKey:"Enter",cancelKey:"Escape",invalidAction:"block",completeOnChange:null,isolateFields:!0};afterConfigure(){const e=this;super.afterConfigure(),e.onTargetSizeChange=e.onTargetSizeChange.bind(e),Mn.on({element:e.element,keydown:"onKeyDown",contextmenu:"stopMouseEvents",mousedown:"stopMouseEvents",mouseover:"stopMouseEvents",mouseout:"stopMouseEvents",mouseup:"stopMouseEvents",click:"stopMouseEvents",dblclick:"stopMouseEvents",thisObj:e}),e.ion({beforeHide:"beforeEditorHide",hide:"afterEditorHide",thisObj:e}),Ue.ion({locale:"onLocaleChange",thisObj:e})}onLocaleChange(){const{inputField:e}=this;e&&!e.isDestroyed&&e.syncInputFieldValue&&e.syncInputFieldValue(!0)}render(e){const t=this.element.parentNode,[n]=this.getRenderContext(this,e);n.classList.add("b-editing"),super.render(...arguments),null!=t&&t.classList&&n!==t&&t.classList.remove("b-editing")}async startEdit(e){const t=this;if(e=Ut.assignIf(e,{align:t.align,hideTarget:t.hideTarget,matchSize:t.matchSize,matchFont:t.matchFont,fitTargetContent:t.fitTargetContent,focus:!0}),!1!==t.trigger("beforeStart",e)){var n,r,s;const{target:i,hideTarget:a,matchSize:o,matchFont:l,fitTargetContent:c,record:d,field:u=t.inputField.name,focus:h}=e,{inputField:g}=t,{input:m}=g,p=yr.getStyleValue(i,"font-size"),f=yr.getStyleValue(i,"font-family");let{value:v,align:y}=e;if(d&&u&&(t.record=d,t.dataField=u,void 0===v&&(v=d.getValue(u))),o&&(i instanceof HTMLElement&&t.updateSize(i,o),i instanceof HTMLElement&&yo.addResizeListener(i,t.onTargetSizeChange)),m&&(l?(m.style.fontSize=p,m.style.fontFamily=f):m.style.fontSize=m.style.fontFamily=""),t.assigningValues=!0,null===(n=g.clearError)||void 0===n||n.call(g),"setValue"in g?await g.setValue(v):g.value=v,t.assigningValues=!1,"string"==typeof y&&(y={align:y}),await t.showBy({target:i,allowTargetOut:!0,...y}),c){const e=m.scrollWidth-m.clientWidth;e>0&&(t.width+=e+yr.scrollBarWidth)}h&&(null===(r=g.focus)||void 0===r||r.call(g)),i.nodeType===Element.ELEMENT_NODE&&a&&i.classList.add("b-hide-visibility"),t.editing=!0;const b=g.value;return t.trigger("start",{value:b}),Array.isArray(b)&&g.editingRecords&&null!==(s=b[0])&&void 0!==s&&s.isModel?t.oldValue=b.map((e=>e.copy(e.id))):(t.oldValue=b,Array.isArray(t.oldValue)&&(t.oldValue=t.oldValue.slice())),g.initialValue=t.oldValue,!0}return!1}async refreshEdit(){if(this.isVisible){const{record:e,dataField:t,inputField:n}=this;if(e&&t){const r=e.getValue(t);Ut.isEqual(n.value,r)||await n.setValue(r)}}}finishEdit(){const{target:e,aligningToElement:t}=this.lastAlignSpec;t&&(e.classList.remove("b-editing"),e.classList.remove("b-hide-visibility")),this.editing=!1,this.trigger("finishEdit")}onKeyDown(e){var t;const n=this;switch(e.key){case n.completeKey:n.completeEdit(null,e),e.stopImmediatePropagation();break;case n.cancelKey:n.cancelEdit(e),e.stopImmediatePropagation()}null===(t=n.trigger)||void 0===t||t.call(n,"keydown",{event:e})}stopMouseEvents(e){this.allowMouseEvents||e.stopPropagation()}onFocusOut(e){super.onFocusOut(e);const t=this;if(!t.isFinishing&&t.editing)switch(t.blurAction){case"cancel":t.cancelEdit(e);break;case"complete":t.completeEdit(null,e)}}async completeEdit(e,t){const n=this,{inputField:r,oldValue:s,record:i}=n,a=r.invalidAction||(!1===r.allowInvalid?"block":n.invalidAction),{value:o}=r;if(n.isVisible){if(r.isValid||"allow"===a){if(Ut.isEqual(o,s))return!1!==n.cancelEdit(t);{const t={inputField:r,record:i,value:o,oldValue:s};if(!1!==n.trigger("beforeComplete",t)){var l;if(!e)e=t.finalize||(null===(l=t.editorContext)||void 0===l?void 0:l.finalize);if(e){let i=await e(t);if(!0===i)n.onEditComplete();else{if(r.setError){const e=i||r.invalidValueError,t=()=>{n(),r.clearError(e)},n=r.ion({change:t,input:t});r.setError(e)}var c;if("block"===a)null===(c=r.focus)||void 0===c||c.call(r);else"revert"===a&&(await r.setValue(s),i=!0);i=!1}return i}return n.onEditComplete(),!0}var d;null===(d=r.focus)||void 0===d||d.call(r)}}else{var u;if("block"===a)return null===(u=r.focus)||void 0===u||u.call(r),!1;if("revert"===a)return!1!==n.cancelEdit(t)}return!1}}cancelEdit(e){const t=this,{inputField:n,oldValue:r}=t,{value:s}=n;if(!t.editing||t.isFinishing||!1===t.trigger("beforeCancel",{value:s,oldValue:r,event:e}))return!1;var i;null===(i=n.clearError)||void 0===i||i.call(n),t.isFinishing=!0,t.hide(),t.trigger("cancel",{value:s,oldValue:r,event:e}),t.finishEdit(),t.isFinishing=!1}onEditComplete(){const e=this,{record:t,dataField:n,inputField:r,oldValue:s}=e,{value:i}=r;if(!e.isFinishing){if(e.isFinishing=!0,e.hide(),t){const e=`set${T.capitalize(n)}`;t[e]?t[e](i):t.setValue(n,i)}e.trigger("complete",{value:i,oldValue:s}),e.finishEdit(),e.isFinishing=!1}}doDestroy(){this.createdInputField&&this.inputField.destroy(),super.doDestroy()}set owner(e){this._owner=e}get owner(){return this._owner||il.fromElement(this.element.parentNode)}changeInputField(e,t){const n=this;return t&&t.destroy(),"string"==typeof e&&(e={type:e}),e instanceof il||(e=il.create(e),n.createdInputField=!0),n.completeOnChange&&e.ion({change:"onInputFieldChange",thisObj:n}),e.parent=n,e}updateInputField(e){this.removeAll(),this.add(e)}get inputField(){return this.items[0]}onInputFieldChange(){this.containsFocus&&this.completeEdit()}onTargetSizeChange(e,t,n){t&&n&&this.updateSize(e)}updateSize(e,t=this.lastMatchSize){const n=this,r=vn.inner(e);n.width=!1===t.width?"auto":r.width-n.align.offset[0],n.height=!1===t.height?"auto":r.height,n.lastMatchSize=t}beforeEditorHide(){if(this.editing&&!this.isFinishing)return this.cancelEdit(),!1}afterEditorHide(){this.positioned&&this.element.remove(),yo.removeResizeListener(this.lastAlignSpec.target,this.onTargetSizeChange)}}jh.initClass(),jh._$name="Editor";const Vh={number:!0,boolean:!0,string:!0,date:!0,duration:!0,time:!0,auto:!0},Bh={number:!0,boolean:!0,string:!0},zh="b-fieldfilterpicker",Wh={between:!0,notBetween:!0,isIncludedIn:!0,isNotIncludedIn:!0},Hh={textfield:!0,datefield:!0,numberfield:!0,durationfield:!0,combo:!0,timefield:!0},Uh={value:"empty",text:"L{isEmpty}",argCount:0},Yh={value:"notEmpty",text:"L{isNotEmpty}",argCount:0},qh={value:"=",text:"L{equals}"},Kh={value:"!=",text:"L{doesNotEqual}"},Gh={value:">",text:"L{isGreaterThan}"},Xh={value:"<",text:"L{isLessThan}"},Zh={value:">=",text:"L{isGreaterThanOrEqualTo}"},Jh={value:"<=",text:"L{isLessThanOrEqualTo}"},Qh={value:"between",text:"L{isBetween}",argCount:2},eg={value:"notBetween",text:"L{isNotBetween}",argCount:2},tg={value:"isIncludedIn",text:"L{isOneOf}",isArrayValued:!0},ng={value:"isNotIncludedIn",text:"L{isNotOneOf}",isArrayValued:!0};class rg extends yl{static $name="FieldFilterPicker";static type="fieldfilterpicker";static operators={empty:{value:"empty",text:"L{isEmpty}",argCount:0},notEmpty:{value:"notEmpty",text:"L{isNotEmpty}",argCount:0},"=":{value:"=",text:"L{equals}"},"!=":{value:"!=",text:"L{doesNotEqual}"},">":{value:">",text:"L{isGreaterThan}"},"<":{value:"<",text:"L{isLessThan}"},">=":{value:">=",text:"L{isGreaterThanOrEqualTo}"},"<=":{value:"<=",text:"L{isLessThanOrEqualTo}"},between:{value:"between",text:"L{isBetween}",argCount:2},notBetween:{value:"notBetween",text:"L{isNotBetween}",argCount:2},isIncludedIn:{value:"isIncludedIn",text:"L{isOneOf}"},isNotIncludedIn:{value:"isNotIncludedIn",text:"L{isNotOneOf}"}};static defaultOperators={string:[Uh,Yh,qh,Kh,{value:"includes",text:"L{contains}"},{value:"doesNotInclude",text:"L{doesNotContain}"},{value:"startsWith",text:"L{startsWith}"},{value:"endsWith",text:"L{endsWith}"},tg,ng],number:[Uh,Yh,qh,Kh,Gh,Xh,Zh,Jh,Qh,eg,tg,ng],date:[Uh,Yh,qh,Kh,{value:"<",text:"L{isBefore}"},{value:">",text:"L{isAfter}"},Qh,{value:"isToday",text:"L{isToday}",argCount:0},{value:"isTomorrow",text:"L{isTomorrow}",argCount:0},{value:"isYesterday",text:"L{isYesterday}",argCount:0},{value:"isThisWeek",text:"L{isThisWeek}",argCount:0},{value:"isNextWeek",text:"L{isNextWeek}",argCount:0},{value:"isLastWeek",text:"L{isLastWeek}",argCount:0},{value:"isThisMonth",text:"L{isThisMonth}",argCount:0},{value:"isNextMonth",text:"L{isNextMonth}",argCount:0},{value:"isLastMonth",text:"L{isLastMonth}",argCount:0},{value:"isThisYear",text:"L{isThisYear}",argCount:0},{value:"isNextYear",text:"L{isNextYear}",argCount:0},{value:"isLastYear",text:"L{isLastYear}",argCount:0},{value:"isYearToDate",text:"L{isYearToDate}",argCount:0},tg,ng],boolean:[{value:"isTrue",text:"L{isTrue}",argCount:0},{value:"isFalse",text:"L{isFalse}",argCount:0}],duration:[Uh,Yh,qh,Kh,Gh,Xh,Zh,Jh,Qh,eg,tg,ng],time:[Uh,Yh,qh,Kh,Gh,Xh,Zh,Jh,Qh,eg,tg,ng],relation:[Uh,Yh,qh,Kh,tg,ng],auto:[{value:"*",text:"L{contains}"}]};static get defaultValueFieldPlaceholders(){return{string:"L{enterAValue}",number:"L{enterANumber}",date:"L{selectADate}",relation:"L{selectValue}",list:"L{selectOneOrMoreValues}",duration:"L{enterAValue}",time:"L{selectATime}",auto:"L{enterAValue}"}}static configurable={fields:null,disabled:!1,readOnly:!1,layout:"vbox",propertyLocked:!1,operatorLocked:!1,filter:null,propertyFieldConfig:null,operatorFieldConfig:null,valueFieldCls:null,triggerChangeOnInput:!0,items:{inputs:{type:"container",layout:"hbox",cls:`${zh}-inputs`,items:{propertyPicker:{type:"combo",items:{},cls:`${zh}-property`,placeholder:"L{FieldFilterPicker.selectAProperty}",highlightExternalChange:!1},operatorPicker:{type:"combo",items:{},cls:`${zh}-operator`,placeholder:"L{FieldFilterPicker.selectAnOperator}",highlightExternalChange:!1},valueFields:{type:"container",cls:`${zh}-values`,items:{}}}},caseSensitive:{type:"checkbox",text:"L{FieldFilterPicker.caseSensitive}",cls:`${zh}-case-sensitive`}},operators:rg.defaultOperators,dateFormat:"L{FieldFilterPicker.dateFormat}",store:null,valueFieldPlaceholders:null,getValueFieldConfig:null};static buildOperatorArgCountLookup=e=>ge.keyBy(Object.entries(e),(([e])=>e),(([,e])=>ge.keyBy(e,(({value:e})=>e),(({argCount:e})=>void 0===e?1:e))));afterConstruct(){const e=this;if(!e._fields)throw new Error(`${rg.name} requires 'fields' to be configured.`);if(!e._filter)throw new Error(`${rg.name} requires 'filter' to be configured.`);super.afterConstruct();const{widgetMap:{propertyPicker:t,operatorPicker:n,caseSensitive:r}}=e;t.ion({select:"onPropertySelect",thisObj:e}),n.ion({select:"onOperatorSelect",thisObj:e}),r.ion({change:"onCaseSensitiveChange",thisObj:e}),e.propertyFieldConfig&&t.setConfig(e.propertyFieldConfig),e.operatorFieldConfig&&n.setConfig(e.operatorFieldConfig),t.cls=e.allPropertyPickerClasses,n.cls=e.allOperatorPickerClasses,e.populateUIFromFilter()}changeDateFormat(e){return this.L(e)}get allChildInputs(){const{propertyPicker:e,operatorPicker:t,caseSensitive:n}=this.widgetMap;return[e,t,...this.valueFields,n]}updateDisabled(e){this.allChildInputs.forEach((t=>t.disabled=e))}updateReadOnly(e){const{propertyPicker:t,operatorPicker:n}=this.widgetMap;this.allChildInputs.forEach((t=>t.readOnly=e)),t.readOnly=t.readOnly||e,n.readOnly=n.readOnly||e}updatePropertyLocked(e){this.widgetMap.propertyPicker.readOnly=e||this.readOnly,this.widgetMap.propertyPicker.cls=this.allPropertyPickerClasses}updateOperatorLocked(e){this.widgetMap.operatorPicker.readOnly=e||this.readOnly,this.widgetMap.operatorPicker.cls=this.allOperatorPickerClasses}changeOperators(e){const t=e??rg.defaultOperators;return Object.keys(t).reduce(((e,n)=>({...e,[n]:t[n].map((e=>({...e,text:this.L(e.text)})))})),{})}changeFields(e){let t=e;return Array.isArray(e)&&(P.deprecate("Core","6.0.0","FieldOption[] deprecated, use Object<String, FieldOption> keyed by field name instead"),t=ge.keyBy(t,"name")),t}get isMultiSelectValueField(){var e;return["isIncludedIn","isNotIncludedIn"].includes(null===(e=this._filter)||void 0===e?void 0:e.operator)}get allPropertyPickerClasses(){var e;return new Sn(`${zh}-property`,null===(e=this.propertyFieldConfig)||void 0===e?void 0:e.cls,{[`${zh}-combo-locked`]:this.propertyLocked})}get allOperatorPickerClasses(){var e;return new Sn(`${zh}-operator`,null===(e=this.operatorFieldConfig)||void 0===e?void 0:e.cls,{[`${zh}-combo-locked`]:this.operatorLocked})}getValueFieldConfigs(){const e=this,{valueFieldCls:t,fieldType:n,_filter:{operator:r},onValueChange:s,filterValues:i,isMultiSelectValueField:a,operatorArgCount:o,getValueFieldConfig:l,fieldIsRelation:c,triggerChangeOnInput:d}=e,u=Ut.merge({},rg.defaultValueFieldPlaceholders,e.valueFieldPlaceholders);if(!n||!r||0===o)return[];let h={type:"textfield",internalListeners:{change:s,input:d?s:null,thisObj:e},bubbleEvents:{keydown:!0},cls:t,dataset:{type:n},placeholder:e.L(u[a?"list":c?"relation":n]),highlightExternalChange:!1};return a||c?h={...h,type:"combo",multiSelect:a,createOnUnmatched:!0,items:e.getUniqueDataValues(i),value:i??[]}:["number","date","boolean","duration","time"].includes(n)&&(h.type=`${n}field`),l&&(h=e.callback(l,e,[e.filter,h])),a?[h]:ge.populate(o,(t=>[{type:"widget",tag:"div",cls:`${zh}-value-separator`,content:e.L("L{FieldFilterPicker.and}")},{...h,value:i[t]}])).flat().slice(1)}getUniqueDataValues(e=[]){var t;const n=this,{fieldType:r}=n;if(!n.store||null===(t=n._filter)||void 0===t||!t.property)return[];const{relatedDisplayField:s}=n.selectedField;let i,a;if(n.fieldIsRelation){const{foreignStore:e}=n.currentPropertyRelationConfig;s?(i=e.allRecords.reduce(((e,t)=>(null!=t.id&&e.push({text:t.getValue(s),value:t.id}),e)),[]),a=i.sort(((e,t)=>n.sortStrings(e.text,t.text)))):i=e.allRecords.map((e=>e.id))}else i=n.store.allRecords.map((e=>e.getValue(n._filter.property)));if(!a){i.push(...e);const t=ge.unique(i.reduce(((e,t)=>(null!=t&&""!==String(t).trim()&&("date"===r?e.push(t.valueOf()):"duration"===r?e.push(t.toString()):e.push(t)),e)),[]));a="string"===r?t.sort(n.sortStrings):"duration"===r?t.map((e=>new js(e))).filter((e=>e.isValid)).sort(n.sortDurations):t.sort(n.sortNumerics),"date"===r?a=a.map((e=>{const t=new Date(e);return{text:Bt.format(t,n.dateFormat),value:e}})):"duration"===r&&(a=a.map((e=>e.toString())))}return a}sortStrings(e,t){return(e??"").localeCompare(t??"")}sortNumerics(e,t){return e-t}sortDurations(e,t){return e.valueOf()-t.valueOf()}get fieldType(){var e;return null===(e=this.selectedField)||void 0===e?void 0:e.type}get selectedField(){var e,t;return null===(e=this.fields)||void 0===e?void 0:e[null===(t=this._filter)||void 0===t?void 0:t.property]}get propertyOptions(){return Object.entries(this.fields??{}).filter((([,e])=>{return Vh[e.type]||"duration"===(null==(t=e)||null===(n=t.column)||void 0===n?void 0:n.type);var t,n})).map((([e,{title:t}])=>({value:e,text:t??e}))).sort(((e,t)=>e.text.localeCompare(t.text)))}get operatorOptions(){return this.operators[this.fieldIsRelation?"relation":this.fieldType]}get fieldIsRelation(){return Boolean(this.currentPropertyRelationConfig)}get currentPropertyRelationConfig(){var e,t;return null===(e=this.store)||void 0===e||null===(t=e.modelRelations)||void 0===t?void 0:t.find((({foreignKey:e})=>{var t;return e===(null===(t=this._filter)||void 0===t?void 0:t.property)}))}updateOperators(){delete this._operatorArgCountLookup}get operatorArgCountLookup(){return this._operatorArgCountLookup||(this._operatorArgCountLookup=rg.buildOperatorArgCountLookup(this.operators))}updateFilter(){this._filter&&this.onFilterChange()}updateStore(e){var t;null===(t=this._store)||void 0===t||t.un(this),null==e||e.ion({refresh:"onStoreRefresh",thisObj:this}),this.inferFieldTypes()}onStoreRefresh({action:e}){this.isMultiSelectValueField&&["dataset","create","update","delete"].includes(e)&&(this.valueFields[0].items=this.getUniqueDataValues(this.filterValues))}refreshValueFields(){const e=this,{valueFields:t}=e.widgetMap,{fieldType:n,operatorArgCount:r,_filter:{property:s,operator:i}}=e,a=Wh[i];t.element.className=new Sn({[`${zh}-values`]:!0,[`${zh}-values-multiple`]:a,[`${zh}-values-${n}`]:void 0!==n,"b-hidden":null==s||null==i||0===r}),t.removeAll(),t.add(e.getValueFieldConfigs()),delete e._valueFields,e.refreshCaseSensitive()}refreshCaseSensitive(){var e,t;const n=this,{fieldType:r,operatorArgCount:s,isMultiSelectValueField:i}=n,a=null===(e=n._filter)||void 0===e?void 0:e.operator,{caseSensitive:o}=n.widgetMap;o.hidden="string"!==r||!a||i||0===s,o.checked=!1!==(null===(t=n._filter)||void 0===t?void 0:t.caseSensitive)}onPropertySelect(e){var t;const n=this,{_filter:r}=n;r.property=(null===(t=e.record)||void 0===t?void 0:t.data.value)||null,n.fieldType!==n._fieldType&&(r.operator=null,r.value=null),n._fieldType=r.type=n.fieldType,n.refreshOperatorPicker(),n.refreshValueFields(),n.triggerChange()}onCaseSensitiveChange({checked:e}){this._filter.caseSensitive=e,this.triggerChange()}onOperatorSelect(e){var t;const n=this,r=n.isMultiSelectValueField,s=this.operatorArgCount;n._filter.operator=(null===(t=e.record)||void 0===t?void 0:t.data.value)||null,n.operatorArgCount!==s&&(n._filter.value=null),n.isMultiSelectValueField&&!r&&(n._filter.value=[]),n.refreshValueFields(),n.triggerChange()}triggerChange(){const{filter:e,isValid:t}=this;this.trigger("change",{filter:e,isValid:t})}onValueChange(){const{isMultiSelectValueField:e,fieldType:t,_filter:n}=this,r=this.valueFields.map((e=>e.value));e&&"date"===t?n.value=r[0].map((e=>new Date(e))):e&&"duration"===t?n.value=r[0].map((e=>new js(e))):("date"===t&&"between"===n.operator&&Bt.isValidDate(r[1])&&r[1].setHours(23,59,59,999),n.value=1===r.length?r[0]:r),this.triggerChange()}refreshOperatorPicker(){const{operatorPicker:e}=this.widgetMap,{_filter:{operator:t,property:n},operatorOptions:r}=this;e.items=r,e.value=t,e.hidden=null===n}populateUIFromFilter(e=!1){const t=this,{filterValues:n,widgetMap:{propertyPicker:r,operatorPicker:s},_filter:{property:i,operator:a,disabled:o},propertyOptions:l,operatorOptions:c,isMultiSelectValueField:d}=t;r.items=l,s.items=c,s.hidden=null===i;let u=e;r.value!==i&&(r.value=i,t.refreshOperatorPicker(),u=!0),s.value!==a&&(null!==a&&s.items.find((({value:e})=>e===a))?s.value=a:s.clear(),u=!0),a||1!==s.items.length||(s.value=t._filter.operator=s.items[0].value),u&&t.refreshValueFields(),t.refreshCaseSensitive(),t.valueFields.forEach(((e,r)=>{d&&(e.value.length>0||n.length>0)?"date"===t.fieldType?e.value=n.map((e=>null==e?void 0:e.valueOf())):"duration"===t.fieldType?e.value=n.map((e=>null==e?void 0:e.toString())):e.value=n:r>=n.length?e.clear():e.value=n[r]})),t.allChildInputs.forEach((e=>e.disabled=t.disabled||o))}get valueFields(){return this._valueFields||(this._valueFields=this.widgetMap.valueFields.queryAll((e=>e.owner===this.widgetMap.valueFields&&Hh[e.type])))}get filterValues(){var e;return null==(null===(e=this._filter)||void 0===e?void 0:e.value)?[]:ge.asArray(this._filter.value)}onFilterChange(){const e=this,t=e.fieldType,n=t!==e._fieldType;e._fieldType=e._filter.type=t,e.populateUIFromFilter(n)}get operatorArgCount(){const{fieldType:e,filter:{operator:t},operatorArgCountLookup:n}=this;return e&&t?n[e][t]:1}get isValid(){const{filter:e,fieldType:t,filterValues:n,isMultiSelectValueField:r,operatorArgCount:s}=this,{operator:i}=e,a=s>0&&null==(null==e?void 0:e.value);return t&&i&&!a&&(r&&n.length>0||n.length===s)&&n.every((e=>null!=e&&("duration"!==t||e.isValid)))}focus(){var e;null===(e=this.valueFields.find((e=>e.isEmptyInput))??this.operatorPicker??this.propertyPicker)||void 0===e||e.focus()}inferFieldTypes(){if(this.store&&this.fields)for(const[e,t]of Object.entries(this.fields))"auto"===t.type&&(t.type=rg.inferFieldType(this.store,e))}static inferFieldType(e,t){var n;const r=null===(n=e.find((e=>null!=e.getValue(t)),!0))||void 0===n?void 0:n.getValue(t);if(void 0!==r){const e=typeof r;if("object"===e&&r instanceof Date)return"date";if(Bh[e])return e}return"auto"}}rg.initClass(),rg._$name="FieldFilterPicker";class sg extends il{static $name="Label";static type="label";static configurable={text:null,localizableProperties:["text"]};compose(){const{text:e,html:t}=this;return{tag:"label",text:e,html:t}}}sg.initClass(),sg._$name="Label";class ig extends yl{static $name="FieldFilterPickerGroup";static type="fieldfilterpickergroup";static addFilterButtonDefaultText="L{FieldFilterPickerGroup.addFilter}";static configurable={filters:[],fields:null,disabled:!1,readOnly:!1,layout:"vbox",store:null,limitToProperty:null,valueFieldCls:null,showAddFilterButton:!0,canDeleteFilter:null,getFieldFilterPickerConfig:null,canManageFilter:null,addFilterButtonText:null,triggerChangeOnInput:!0,items:{pickers:{type:"container",layout:"vbox",scrollable:!0,items:{}},addFilterButton:{type:"button",text:ig.addFilterButtonDefaultText,cls:`b-${ig.type}-add-button`,hidden:!0}},operators:null,dateFormat:"L{FieldFilterPicker.dateFormat}"};static childPickerType="fieldfilterpicker";afterConstruct(){const e=this;e.validateConfig();const{addFilterButton:t}=e.widgetMap;t.ion({click:"addFilter",thisObj:e}),t.text=e.L(t.text),e.store&&e.updateStore(e.store),super.afterConstruct()}changeDateFormat(e){return this.L(e)}validateConfig(){if(!this.fields&&!this.store)throw new Error("FieldFilterPickerGroup requires either a 'fields' or 'store' config property.")}updateFields(e){this.widgetMap.pickers.childItems.forEach((t=>t.fields=e))}updateFilters(e,t){const n=this;t&&t.filter((t=>!e.find((e=>e.id===t.id)))).forEach((e=>{var t;return null===(t=n.store)||void 0===t?void 0:t.removeFilter(e.id)})),e.forEach((e=>e.id=e.id||n.nextFilterId)),n.widgetMap.pickers.items=(null==e?void 0:e.map((e=>n.getPickerRowConfig(e))))||[]}changeFilters(e){const{canManageFilter:t}=this;return e&&t?e.filter((e=>this.callback(t,this,[e]))):e}updateStore(e){const t=this;t.detachListeners("store"),e&&(t.widgetMap.pickers.childItems.forEach((({widgetMap:{filterPicker:{filter:t,isValid:n}}})=>{e.removeFilter(t.id,!0),n&&e.addFilter(t,!0)})),e.filter(),t.appendFiltersFromStore(),e.ion({name:"store",filter:"onStoreFilter",thisObj:t})),t.widgetMap.pickers.childItems.forEach((t=>t.store=e))}updateShowAddFilterButton(e){this.widgetMap.addFilterButton.hidden=!e}updateAddFilterButtonText(e){this.widgetMap.addFilterButton.text=e??ig.addFilterButtonDefaultText}appendFiltersFromStore(){const e=this;e.store.filters.forEach((t=>{var n;const r=e.canManage(t),{property:s,operator:i,id:a}=t;r&&s&&i&&(null===(n=e.filters)||void 0===n||!n.find((e=>e.id===a)))&&e.appendFilter(t)}))}canManage(e){const t=this;return!t.canManageFilter||!0===t.callback(t.canManageFilter,t,[e])}getFilterPickerConfig(e){const t=this,{fields:n,store:r,disabled:s,readOnly:i,valueFieldCls:a,operators:o,limitToProperty:l,dateFormat:c,getFieldFilterPickerConfig:d,triggerChangeOnInput:u}=t;return{type:t.constructor.childPickerType,fields:n??t.getFieldsFromStore(r),filter:e,store:r,disabled:s,readOnly:i,propertyLocked:Boolean(l),valueFieldCls:a,operators:o,dateFormat:c,internalListeners:{change:"onFilterPickerChange",thisObj:t},flex:1,triggerChangeOnInput:u,...d?t.callback(d,t,[e]):void 0}}getFieldsFromStore(e){var t;return Object.fromEntries((null===(t=e.modelClass)||void 0===t?void 0:t.fields.map((({name:e,type:t})=>[e,{type:t}])))??[])}getPickerRowConfig(e){const t=this,{disabled:n,readOnly:r,canDeleteFilter:s}=t,i=!(s&&!1===t.callback(s,t,[e]));return{type:"container",layout:"box",cls:{[`b-${ig.type}-row`]:!0,[`b-${ig.type}-row-removable`]:i},dataset:{separatorText:t.L("L{FieldFilterPicker.and}")},items:{activeCheckbox:{type:"checkbox",disabled:n,readOnly:r,checked:!Boolean(e.disabled),internalListeners:{change:"onFilterActiveChange",thisObj:t},cls:`b-${ig.type}-filter-active`},filterPicker:t.getFilterPickerConfig(e),removeButton:{type:"button",ref:"removeButton",disabled:n,readOnly:r,hidden:!i,cls:`b-transparent b-${ig.type}-remove`,icon:"b-fa-trash",internalListeners:{click:"removeFilter",thisObj:t}}}}}get allInputs(){const e=[this.constructor.childPickerType,"button","checkbox"];return this.queryAll((t=>e.includes(t.type)))}updateDisabled(e){this.allInputs.forEach((t=>t.disabled=e))}updateReadOnly(e){this.allInputs.forEach((t=>t.readOnly=e))}onFilterActiveChange({source:e,checked:t}){const n=this,r=n.getFilterIndex(e),s=n.filters[r],i=n.getFilterPicker(r);s.disabled=!t,i.onFilterChange(),n.store&&i.isValid&&n.store.addFilter(s,!0),n.updateStoreFilter(),n.triggerChange()}onFilterPickerChange({source:e,filter:t,isValid:n}){const r=this,{store:s}=r,i=r.getFilterIndex(e);s&&(s.removeFilter(t.id,!0),n&&s.addFilter(t,!0),r.updateStoreFilter()),Object.assign(r.filters[i],t),r.triggerChange()}getFilterIndex(e){return this.widgetMap.pickers.childItems.indexOf(e.containingWidget)}getPickerRow(e){return this.widgetMap.pickers.childItems[e]}getFilterPicker(e){return this.getPickerRow(e).widgetMap.filterPicker}get nextFilterId(){return this._nextId=(this._nextId||0)+1,`${this.id}-filter-${this._nextId}`}removeFilter({source:e}){const t=this,n=t.getFilterIndex(e),r=t.filters[n],s=t.getPickerRow(n),i=t.query((e=>e.isFocusable&&"container"!==e.type&&!s.contains(e)));i&&i.focus(),t.removeFilterAt(n),t.store&&(t.store.removeFilter(r.id,!0),t.updateStoreFilter()),t.trigger("remove",{filter:r}),t.triggerChange()}addFilter({property:e=null,operator:t=null,value:n=null}={}){const r=this,{filters:s}=r,i={property:r.limitToProperty||e,operator:t,value:n,disabled:!1,id:r.nextFilterId,caseSensitive:!1};if(r.trigger("beforeAddFilter",{filter:i})){var a;if(r.appendFilter(i),r.getFilterPicker(s.length-1).isValid)null===(a=r.store)||void 0===a||a.addFilter(i,!0),r.store&&r.updateStoreFilter();r.trigger("add",{filter:i}),r.triggerChange()}}appendFilter(e){const t=this;t.limitToProperty&&e.property!==t.limitToProperty||(t.filters.push(e),t.widgetMap.pickers.add(t.getPickerRowConfig(e,t.filters.length-1)))}onStoreFilter(e){const t=this;if(t._isUpdatingStore)return;const{filters:n}=e,r=n.values.reduce(((e,t)=>({...e,[t.id]:t})),{});for(let e=t.filters.length-1;e>=0;e--){const n=t.filters[e],s=r[n.id],i=t.getPickerRow(e);if(i){const{filterPicker:r,activeCheckbox:a}=i.widgetMap;if(!s&&r.isValid)t.removeFilterAt(e);else if(void 0!==s){const{operator:e,value:t,property:i,disabled:o,caseSensitive:l}=s;n!==s&&Object.assign(n,{operator:e,value:t,property:i,disabled:o,caseSensitive:l}),r.filter=n,r.onFilterChange(),a.checked=!o}}}t.appendFiltersFromStore(),t.triggerChange()}removeFilterAt(e){const{widgetMap:{pickers:t},filters:n}=this;t.remove(t.childItems[e]),n.splice(e,1),this.triggerChange()}updateStoreFilter(){var e;this._isUpdatingStore=!0,null===(e=this.store)||void 0===e||e.filter(),this._isUpdatingStore=!1}get value(){return this.filters}triggerChange(){const{filters:e}=this,t=e.filter(((e,t)=>this.getPickerRow(t).widgetMap.filterPicker.isValid));this.trigger("change",{filters:e,validFilters:t})}activateAll(){this.setAllActiveStatus(!0)}deactivateAll(){this.setAllActiveStatus(!1)}setAllActiveStatus(e){const t=this,{_filters:n,store:r}=t;n.forEach(((n,s)=>{if(e===n.disabled){const{filterPicker:i,activeCheckbox:a}=t.getPickerRow(s).widgetMap;n.disabled=!e,i.onFilterChange(),a.checked=e,e&&r&&i.isValid&&r.addFilter(n,!0)}})),t.updateStoreFilter()}focus(){const{length:e}=this._filters;var t;e>0&&(null===(t=this.getPickerRow(e-1))||void 0===t||t.widgetMap.filterPicker.focus())}}ig.initClass(),ig._$name="FieldFilterPickerGroup";class ag extends(Hc.mixin(Ju)){static $name="FieldSet";static type="fieldset";static get configurable(){return{bodyTag:"fieldset",focusable:!1,inline:null,inlineInternal:null,layout:{type:"box",horizontal:!1}}}static get prototypeProperties(){return{flexRowCls:"b-hbox",flexColCls:"b-vbox"}}get bodyConfig(){const e=super.bodyConfig,{className:t}=e,{inlineInternal:n,hasLabel:r,title:s}=this;return delete e.html,t["b-inline"]=n,t["b-fieldset-has-label"]=r,s&&(e.children={legendElement:{tag:"legend",text:s,class:{"b-fieldset-legend":1}}}),e}compose(){const{inlineInternal:e,label:t,labelCls:n,labelWidth:r}=this;return{class:{"b-field":t,"b-vbox":!e},children:{"labelElement > headerElement":t?{tag:"label",html:t,class:{"b-label":1,"b-align-start":1,[n]:n},style:{width:yr.unitize("width",r)[1]}}:null}}}syncInlineInternal(){this.inlineInternal=this.inline??(null!=this.label&&"before"===this.labelPosition)}updateDisabled(e,t){super.updateDisabled(e,t),this.eachWidget((t=>{t.disabled=e}),!1)}updateInline(){this.syncInlineInternal()}updateInlineInternal(e){this.layout.horizontal=e}updateLabel(){this.syncInlineInternal()}updateLabelPosition(){this.syncInlineInternal()}}ag.initClass(),ag._$name="FieldSet";class og extends sh{static $name="FileField";static type="filefield";static get configurable(){return{multiple:null,accept:null,inputType:"file",attributes:["multiple","accept"]}}get files(){return this.input.files}pickFile(){this.input.click()}get multiple(){return this._multiple?"":null}clear(){this.input.value=null}triggerChange(e){this.triggerFieldChange({event:e,value:this.input.value,oldValue:this._lastValue,userAction:!0,valid:!0})}}og.initClass(),og._$name="FileField";class lg extends yl{static $name="FilePicker";static type="filepicker";static get defaultConfig(){return{defaultBindProperty:"value",buttonConfig:null,fileFieldConfig:null}}construct(e={}){const t=this;e.items=[Object.assign({type:"button",ref:"fileButton",text:"L{FilePicker.file}",localeClass:this},e.buttonConfig),Object.assign({type:"filefield",ref:"fileField",style:"display: none"},e.fileFieldConfig)].concat(e.items||[]),super.construct(e),t.button.ion({click:t.onButtonClick,thisObj:t}),t.fileField.ion({change:t.onFileFieldChange,thisObj:t}),t._thisIsAUsedExpression(t.fileTip)}get button(){return this.widgetMap.fileButton}get fileField(){return this.widgetMap.fileField}get files(){return this.fileField.files}get fileTip(){const e=this;return e._fileTip||(e._fileTip=new Xu({cls:"b-file-tip",forElement:e.button.element,showOnHover:!0,align:"b-t",scrollAction:"realign",internalListeners:{beforeshow(){const t=this,n=e.files;return!(!n||!n.length)&&(t.html=`${Array.from(n).map((e=>e.name)).join("<br>")}`,!0)}}}))}clear(){const e=this;e.fileField.clear(),e.button.badge="",e.trigger("clear")}onButtonClick({event:e}){this.fileField.pickFile(),e.preventDefault()}onFileFieldChange({valid:e}){const t=this;t.button.badge=t.files.length||"",t.triggerFieldChange({files:t.files,valid:e})}}lg.initClass(),lg._$name="FilePicker";class cg extends ih{static $name="FilterField";static type="filterfield";static get configurable(){return{field:null,store:null,filterFunction:null,clearable:!0,revertOnEscape:!0,ignoreParentReadOnly:!0,keyStrokeChangeDelay:100,onChange({value:e}){const{store:t,field:n,filterFunction:r}=this;if(t){const s=`${n||this.id}-Filter`;if(0===e.length)t.removeFilter(s);else{let i;r?i=t=>r(t,e):(e=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),i=t=>{var r;return null===(r=t.getValue(n))||void 0===r?void 0:r.match(new RegExp(e,"i"))}),t.filter({id:s,filterBy:i})}}}}}updateValue(e,t){super.updateValue(e,t),e&&this.isConfiguring&&this.onChange({value:e})}}cg.initClass(),cg._$name="FilterField";const dg=[{ref:"cancelButton",cls:"b-messagedialog-cancelbutton b-gray",text:"L{Object.Cancel}",onClick:"up.onCancelClick"},{ref:"okButton",cls:"b-messagedialog-okbutton b-raised b-blue",text:"L{Object.Ok}",onClick:"up.onOkClick"}];r.isWindows&&dg.reverse();class ug extends Uc{static $name="MessageDialog";static type="messagedialog";static get configurable(){return{centered:!0,modal:!0,hidden:!0,autoShow:!1,closeAction:"hide",title:"",lazyItems:{$config:["lazy"],value:[{cls:"b-messagedialog-message",ref:"message"},{type:"textfield",cls:"b-messagedialog-input",ref:"input"}]},showClass:null,bbar:{overflow:null,items:dg}}}construct(){this.okButton=this.yesButton=1,this.cancelButton=3,super.construct(...arguments)}destroy(){}async confirm(){return this.showDialog("confirm",...arguments)}async alert(){return this.showDialog("alert",...arguments)}async prompt({textField:e}){const t=this.widgetMap.input;return il.reconfigure(t,e),t.value="",this.showDialog("prompt",...arguments)}showDialog(e,{message:t="",title:n="",cancelButton:r,okButton:s,rootElement:i=document.body}){const a=this;return a.rootElement=i,a.getConfig("lazyItems"),a.title=a.optionalL(n),a.widgetMap.message.html=a.optionalL(t),a.showClass=`b-messagedialog-${e}`,s&&(s="string"==typeof s?{text:s}:s),r&&(r="string"==typeof r?{text:r}:r),s=Object.assign({},a.widgetMap.okButton.initialConfig,s),r=Object.assign({},a.widgetMap.cancelButton.initialConfig,r),s.text=a.optionalL(s.text),r.text=a.optionalL(r.text),il.reconfigure(a.widgetMap.okButton,s),il.reconfigure(a.widgetMap.cancelButton,r),a.show(),a.promise=new Promise((e=>{a.resolve=e}))}show(){const e=yr.getActiveElement(this.element);return this.owner=this.element.contains(e)?null:ug.fromElement(document.activeElement),super.show(...arguments)}updateShowClass(e,t){const{classList:n}=this.element;t&&n.remove(t),e&&n.add(e)}doResolve(e){const t=this,{resolve:n}=t;if(n){const r="b-messagedialog-prompt"===t.showClass;if(r&&e===t.okButton&&!t.widgetMap.input.isValid)return;t.resolve=t.reject=t.promise=null,n(r?{button:e,text:t.widgetMap.input.value}:e),t.hide()}}onInternalKeyDown(e){"Escape"===e.key?(e.stopImmediatePropagation(),this.onCancelClick()):"Enter"!==e.key||e.target.closest(".b-button")||(e.stopImmediatePropagation(),e.preventDefault(),this.onOkClick()),super.onInternalKeyDown(e)}onOkClick(){this.doResolve(hg.okButton)}onCancelClick(){this.doResolve(hg.cancelButton)}}ug.initClass();const hg=new Proxy({},{get(e,t){const n=e.instance||(e.instance=new ug({rootElement:document.body})),r=n[t];return"function"==typeof r?r.bind(n):r}});class gg extends Fc{static $name="PagingToolbar";static type="pagingtoolbar";static get defaultConfig(){return{store:null,defaults:{localeClass:this},items:{firstPageButton:{onClick:"up.onFirstPageClick",icon:"b-icon-first",weight:100,tooltip:"L{PagingToolbar.firstPage}"},previousPageButton:{onClick:"up.onPreviousPageClick",icon:"b-icon-previous",weight:110,tooltip:"L{PagingToolbar.prevPage}"},pageNumber:{type:"numberfield",label:"L{page}",min:1,max:1,triggers:null,onChange:"up.onPageNumberChange",highlightExternalChange:!1,weight:120},pageCount:{type:"widget",cls:"b-pagecount b-toolbar-text",weight:130},nextPageButton:{onClick:"up.onNextPageClick",icon:"b-icon-next",weight:140,tooltip:"L{PagingToolbar.nextPage}"},lastPageButton:{onClick:"up.onLastPageClick",icon:"b-icon-last",weight:150,tooltip:"L{PagingToolbar.lastPage}"},separator:{type:"widget",cls:"b-toolbar-separator",weight:151},reloadButton:{onClick:"up.onReloadClick",icon:"b-icon-reload",weight:160,tooltip:"L{PagingToolbar.reload}"},spacer:{type:"widget",cls:"b-toolbar-fill",weight:161},dataSummary:{type:"widget",cls:"b-toolbar-text",weight:170}}}}set parent(e){super.parent=e,this.store||(this.store=e.store)}get parent(){return super.parent}set store(e){const t=this;t.detachListeners("store"),t._store=e,e&&(e.ion({name:"store",beforerequest:"onStoreBeforeRequest",afterrequest:"onStoreChange",change:"onStoreChange",thisObj:t}),e.isLoading&&t.onStoreBeforeRequest())}get store(){return this._store}onStoreBeforeRequest(){this.eachWidget((e=>e.disable()))}updateLocalization(){this.updateSummary(),super.updateLocalization()}updateSummary(){const e=this,{pageCount:t,dataSummary:n}=e.widgetMap;let r=0,s=0,i=0,a=0,o=0;if(e.store){const{store:t}=e,{pageSize:n,currentPage:l}=t;r=t.count,s=t.lastPage,o=t.allCount,i=Math.max(0,(l-1)*n+1),a=Math.min(o,i+n-1)}t.html=e.L("L{pageCountTemplate}")({lastPage:s}),n.html=r?e.L("L{summaryTemplate}")({start:i,end:a,allCount:o}):e.L("L{noRecords}")}onStoreChange(){const e=this,{widgetMap:t,store:n}=e,{count:r,lastPage:s,currentPage:i}=n,{pageNumber:a,pageCount:o,firstPageButton:l,previousPageButton:c,nextPageButton:d,lastPageButton:u,dataSummary:h}=t;e.eachWidget((e=>e.enable())),a.value=i,a.max=s,h.disabled=a.disabled=o.disabled=!r,l.disabled=c.disabled=i<=1||!r,d.disabled=u.disabled=i>=s||!r,e.updateSummary()}onPageNumberChange({value:e}){this.store.currentPage!==e&&this.store.loadPage(e)}onFirstPageClick(){this.store.loadPage(1)}onPreviousPageClick(){this.store.previousPage()}onNextPageClick(){this.store.nextPage()}onLastPageClick(){this.store.loadPage(this.store.lastPage)}onReloadClick(){this.store.loadPage(this.store.currentPage)}}gg.initClass(),gg._$name="PagingToolbar";const{dockIsHorz:mg}=nc.maps,pg={top:0,down:0,left:1,bottom:2,up:2,right:3},fg={up:{from:"translate(0,0)",to:"translate(0,-100%)"},down:{from:"translate(0,0)",to:"translate(0,100%)"},left:{from:"translate(0,0)",to:"translate(-100%,0)"},right:{from:"translate(0,0)",to:"translate(100%,0)"}};class vg extends(nc.mixin(Ur)){static $name="PanelCollapserOverlay";static type="overlay";static get configurable(){return{autoCloseDelay:1e3,autoClose:!0,revealing:{value:null,$config:null,default:!1},recollapseTool:{type:"collapsetool",cls:"b-recollapse",collapsify:"overlay",handler(){var e;null===(e=this.collapsible)||void 0===e||e.toggleReveal()}}}}static get delayable(){return{doAutoClose:0}}doAutoClose(){this.toggleReveal(!1)}updateAutoCloseDelay(e){const{doAutoClose:t}=this;(t.suspended=null==e||e<0)||(t.delay=e,t.immediate=!e)}changeRecollapseTool(e){const t=this,{panel:n}=t;if(t.isConfiguring||t.isDestroying||!n||n.isDestroying)return e;n.tools={recollapse:e}}beforeCollapse(e){if(!1===super.beforeCollapse(e))return!1;this.panel.revealed&&(e.animation=null)}applyHeaderDock(e,t=!0){var n;null===(n=this.panel)||void 0===n||n.recompose(),super.applyHeaderDock(e,t)}collapseBegin(e){const t=this,{collapseDir:n,innerElement:r}=t,{animation:s}=e,{collapseTool:i,panel:a}=t;t.configuredWidth=a._lastWidth,t.configuredHeight=a._lastHeight,t.applyHeaderDock(!0),t.lockInnerSize(),null==i||i.element.classList.add("b-collapsed"),s&&(a.element.classList.add("b-collapsing"),s.element=r,s.transform=fg[n],e.animation=Rl.run(s))}onComplete(e){var t,n;super.onComplete(e);const r=this,{panel:s}=r,{element:i}=s;r.autoCloseLeaveDetacher=null===(t=r.autoCloseLeaveDetacher)||void 0===t?void 0:t.call(r),r.autoCloseClickDetacher=null===(n=r.autoCloseClickDetacher)||void 0===n?void 0:n.call(r),r.doAutoClose.cancel(),"reveal"===e&&r.autoClose&&(s.containsFocus&&(r.autoCloseLeaveDetacher=Mn.on({element:i,mouseenter:e=>{r.doAutoClose.cancel()},mouseleave:e=>{r.doAutoClose()}})),r.autoCloseClickDetacher=Mn.on({element:document.body,thisObj:s,mousedown:e=>{var t;s.owns(e)||null!==(t=r.revealer)&&void 0!==t&&t.contains(e.target)||null==r.autoCloseDelay||r.doAutoClose.now()}}))}expandBegin(e){const t=this,{animation:n}=e,{collapseDir:r,collapseTool:s,innerElement:i,panel:a}=t,{element:o}=a;o.classList.remove("b-collapsed","b-collapsing"),t.restoreConfiguredSize(),t.lockInnerSize(!1),t.lockInnerSize(),null==s||s.element.classList.remove("b-collapsed"),n&&(o.classList.add("b-collapsed","b-expanding"),n.element=i,n.transform={from:fg[r].to,to:fg[r].from},e.animation=Rl.run(n))}expandEnd(e){super.expandEnd(e);const{panel:t}=this;e.completed&&(t.revealed=!1),t.element.classList.remove("b-expanding")}expandRevert(e){super.expandRevert(e),this.panel.element.classList.add("b-expanding")}get innerElement(){return this.panel.overlayElement}get innerSizeElement(){return this.panel.element}get toolsConfig(){const{direction:e}=this,t=super.toolsConfig,n=this.recollapseTool;return n?{...t,recollapse:n&&Ut.assign({direction:e.toLowerCase()},n)}:t}lockInnerSize(e=!0){const t=this,{panel:n}=t,r=e&&n.rectangle(),s=e?[0,0,0,0]:"",i=super.lockInnerSize(e);return e&&(s[pg[t.collapseDir]]=`-${r[t.collapseDim]+10}px`),n.element.style.clipPath=e?`inset(${s.join(" ")})`:"",i}onOverlayTransitionDone(e){const t=this,{panel:n}=t;e.srcElement===n.overlayElement&&t.revealing&&(t.revealing=!1,t.onComplete(n.revealed?"reveal":"unreveal"))}onRevealerClick(){this.toggleReveal()}toggleReveal(e){const{panel:t}=this,{element:n}=t;t.collapsed&&(this.revealer=yr.getActiveElement(n),null==e&&(e=!t.revealed),t.revealed!==e&&!1!==t.trigger("beforeToggleReveal",{reveal:e})&&(!e&&n.contains(this.revealer)&&t.revertFocus(!0),this.revealing=!0,t.revealed=e))}updateRevealing(e){const t=this,{panel:n}=t,r=/left|right/i.test(t.collapseDir)?"height":"width";n&&(t.innerElement.style[r]="0px",t.innerElement.style[`min-${r}`]="100%",n.element.classList[e?"add":"remove"]("b-panel-overlay-revealing"))}wrapCollapser(e,t){var n;const r=this,{collapseDir:s,panel:i}=r,{expandedHeaderDock:a,header:o,uiClassList:l}=i,c=null===(n=i.tools)||void 0===n?void 0:n.recollapse,[d,u]=r.splitHeaderItems({as:"element",dock:r.collapseDock}),h=mg[a],g=i.hasHeader?i.title||(null==o?void 0:o.title)||"":null;return c&&(c.direction=s),["overlayElement",{class:{...l,[`b-panel-overlay-header-${a}`]:1,[`b-panel-overlay-${s}`]:1,[`b-${h?"h":"v"}box`]:1,"b-panel-overlay":1,"b-box-center":1},listeners:{transitionend:e=>r.onOverlayTransitionDone(e),transitioncancel:e=>r.onOverlayTransitionDone(e)},children:{overlayHeaderElement:g&&{tag:"header",class:new Sn({...l,[`b-dock-${a}`]:1,"b-panel-header":1,"b-panel-overlay-header":1},null==o?void 0:o.cls),children:[...d,{reference:"overlayTitleElement",html:g,class:{...l,[`b-align-${(null==o?void 0:o.titleAlign)||"start"}`]:1,"b-header-title":1}},...u]},[e]:t}}]}}vg.initClass(),vg._$name="PanelCollapserOverlay";class yg extends sh{static $name="PasswordField";static type="passwordfield";static alias="password";construct(e={}){e.inputType="password",super.construct(...arguments),this.element.classList.add("b-textfield")}}yg.initClass(),yg._$name="PasswordField";class bg extends Ch{static $name="Radio";static type="radio";static alias="radiobutton";static get configurable(){return{inputType:"radio",clearable:null,uncheckedValue:void 0}}get textLabelCls(){return super.textLabelCls+" b-radio-label"}internalOnClick(e){!1!==super.internalOnClick(e)&&this.checked&&this.clearable&&(this.checked=!1)}updateName(e){this.toggleGroup=e}updateClearable(){}}bg.initClass(),bg._$name="Radio";class Cg extends ag{static $name="RadioGroup";static type="radiogroup";static get configurable(){return{defaultType:"radio",clearable:null,name:null,options:{value:null,$config:{merge:"items"}},defaultBindProperty:"value"}}get existingOptions(){const{name:e}=this;return this.ensureItems().filter((t=>t.name===e))}get refPrefix(){return`${this.name||this.ref||this.id}_`}get selected(){return this.existingOptions.filter((e=>e.input.checked))[0]||null}get value(){const{selected:e}=this;return e?e.checkedValue:null}set value(e){this.existingOptions.forEach((t=>{t.isConfiguring=this.isConfiguring,t.checked=t.checkedValue===e,t.isConfiguring=!1}))}ensureItems(){return this.getConfig("options"),super.ensureItems()}changeOptions(e,t){if(!(e&&t&&Ut.isDeeplyEqual(t,e)))return e}convertOption(e,t,n){const r=this,{name:s}=r,i={name:s,type:"radio",value:e===r.value,ref:`${r.refPrefix}${e}`,checkedValue:e};return"string"==typeof t?i.text=t:Ut.assign(i,t),n?il.reconfigure(n,i):i}isOurRadio(e){return e.isRadio&&e.name===this.name}isolateFieldChange(e){return this.isOurRadio(e)}onChildAdd(e){super.onChildAdd(e),this.isOurRadio(e)&&e.ion({name:e.id,beforeChange:"onRadioItemBeforeChange",change:"onRadioItemChange",click:"onRadioClick",thisObj:this})}onChildRemove(e){this.isOurRadio(e)&&this.detachListeners(e.id),super.onChildRemove(e)}onRadioClick(e){const{source:t}=e;t.checked&&this.clearable&&null==t.clearable&&(t.checked=!1)}onRadioItemBeforeChange(e){if(e.checked){const t=this,{lastValue:n}=t;if(!t.reverting&&!1===t.trigger("beforeChange",t.wrapRadioEvent(e))&&null!=n&&n!==t.value)return t.reverting=!0,e.source.uncheckToggleGroupMembers(),t.value=n,t.lastValue=n,t.reverting=!1,!1}}onRadioItemChange(e){const t=this;e.checked&&!t.reverting&&(t.triggerFieldChange(t.wrapRadioEvent(e)),t.lastValue=t.value)}wrapRadioEvent(e){return{from:e,item:e.source,userAction:e.userAction,lastValue:this.lastValue,value:this.value}}updateOptions(){const e=this,{options:t,refPrefix:n}=e,r=e.existingOptions.reduce(((e,t)=>(e[t.ref.substring(n.length)]=t,e)),{});let s,i,a=0;if(t)for(s in t)i=e.convertOption(s,t[s],r[s]),delete r[s],e.insert(i,a++);const o=Object.values(r);null!=o&&o.length&&(e.remove(o),o.forEach((e=>e.destroy())))}}Cg.initClass(),Cg._$name="RadioGroup";const Sg={ArrowUp:1,ArrowDown:1,ArrowLeft:1,ArrowRight:1};class wg extends il{static $name="Slider";static type="slider";static get configurable(){return{text:null,showValue:!0,showTooltip:!1,min:0,max:100,step:1,value:50,unit:null,thumbSize:20,tooltip:{$config:["lazy","nullify"],value:{type:"tooltip",align:"b-t",anchor:!1,axisLock:!0}},localizableProperties:["text"],triggerChangeOnInput:null,defaultBindProperty:"value"}}compose(){const{id:e,min:t,max:n,showValue:r,step:s,text:i,value:a,unit:o="",disabled:l}=this,c=`${e}-input`,d=Boolean(i||r);return{class:{"b-has-label":d,"b-text":d,"b-disabled":l},children:{input:{tag:"input",type:"range",id:c,reference:"input",[l?"disabled":""]:l,min:t,max:n,step:s,value:a,listeners:{input:"onInternalInput",change:"onInternalChange",mouseover:"onInternalMouseOver",mouseout:"onInternalMouseOut"}},label:{tag:"label",for:c,html:r?i?`${i} (${a}${o})`:a+o:i}}}}get focusElement(){return this.input}get percentProgress(){return(this.value-this.min)/(this.max-this.min)*100}onInternalKeyDown(e){!this.readOnly&&Sg[e.key]&&e.stopImmediatePropagation()}onInternalChange(){this.updateUI(),this.triggerChange(!0),this.trigger("action",{value:this.value})}onInternalInput(){const e=this;e.readOnly?e.input.value=e.value:(e.value=parseInt(e.input.value,10),e.trigger("input",{value:e.value}),e.triggerChangeOnInput&&e.triggerChange(e))}onInternalMouseOver(){var e;const t=this,n=t.rtl?100-t.percentProgress:t.percentProgress;null===(e=t.tooltip)||void 0===e||e.showBy({target:vn.from(t.input).inflate(t.thumbSize/2,-t.thumbSize/2),align:`b-t${Math.round(n)}`})}onInternalMouseOut(){var e;null===(e=this.tooltip)||void 0===e||e.hide()}triggerChange(e){this.triggerFieldChange({value:this.value,valid:!0,userAction:e})}updateMax(e){const t=this;t.input&&t._value>e&&(t.value=e,t.trigger("input",{value:t.value}))}updateMin(e){const t=this;t.input&&t._value<e&&(t.value=e,t.trigger("input",{value:t.value}))}changeTooltip(e,t){return e&&(e.owner=this),this.showTooltip?Xu.reconfigure(t,e,{owner:this,defaults:{forElement:this.input,html:String(this.value)+(this.unit??"")}}):null}changeValue(e){const{min:t,step:n}=this;return(e=Math.min(Math.max(e,t),this.max))>t?t+Ut.roundTo(e-t,n):Ut.roundTo(e,n)}updateValue(e){const t=this,{input:n,_tooltip:r}=t;r&&(r.html=t.value+(t.unit??"")),n&&n.value!==String(e)&&(n.value=e,t.triggerChange(!1)),t.updateUI()}updateUI(){var e,t;const n=this;(null===(e=n._tooltip)||void 0===e?void 0:e.isVisible)&&(null===(t=n._tooltip)||void 0===t||t.alignTo({target:vn.from(n.input).inflate(n.thumbSize/2,-n.thumbSize/2),align:`b-t${Math.round(n.percentProgress)}`}))}}wg.initClass(),wg._$name="Slider";class Dg extends Ch{static $name="SlideToggle";static type="slidetoggle";static get properties(){return{toggledCls:"b-slidetoggle-checked"}}construct(e){e.checked&&(e.cls=Sn.from(e.cls)||{},e.cls[this.constructor.properties.toggledCls]=1),super.construct(e)}get innerElements(){const e=super.innerElements;return e.splice(1,0,this.toggleElement),this.text?e[e.length-1].class="b-slidetoggle-label":e.pop(),e}get toggleElement(){return{class:"b-slidetoggle-toggle",reference:"slideToggle",children:[{class:"b-slidetoggle-thumb",reference:"slideThumb"}]}}internalOnChange(){super.internalOnChange(),this.element.classList[this.value?"add":"remove"](this.toggledCls)}}Dg.initClass(),Dg._$name="SlideToggle";const Tg=["b-horizontal","b-vertical"],Eg=e=>"flex"===yr.getStyleValue(e.parentElement,"display")&&(parseInt(yr.getStyleValue(e,"flex-basis"),10)||parseInt(yr.getStyleValue(e,"flex-grow"),10)),xg={horizontal:!1,vertical:!0};class kg extends il{static $name="Splitter";static type="splitter";static get configurable(){return{orientation:"auto",vertical:null,containerElement:{$config:"nullify",value:null},nextNeighbor:{$config:"nullify",value:null},previousNeighbor:{$config:"nullify",value:null}}}static get delayable(){return{syncState:"raf"}}doDestroy(){var e;null===(e=this.mouseDetacher)||void 0===e||e.call(this),super.doDestroy()}compose(){return{class:{"b-splitter":1},listeners:{pointerdown:"onMouseDown",mouseenter:"syncState",...!r.supportsPointerEvents&&{mousedown:"onMouseDown",touchstart:"onMouseDown"}}}}get currentOrientation(){return this.vertical?"vertical":"horizontal"}getSibling(e=!0){let t,{element:n}=this;for(;!t&&(n=n[(e?"next":"previous")+"ElementSibling"]);)n.isConnected&&!yr.isVisible(n)||(t=n);return t}get nextWidget(){let e,{element:t}=this;for(;!e&&(t=t.nextElementSibling);)e=il.fromElement(t,this.element.parentElement);return e}get previousWidget(){let e,{element:t}=this;for(;!e&&(t=t.previousElementSibling);)e=il.fromElement(t,this.element.parentElement);return e}updateContainerElement(e){var t;const n=this;n.stateDetector=null===(t=n.stateDetector)||void 0===t?void 0:t.disconnect(),e&&(n.stateDetector=new MutationObserver((()=>n.syncState())),n.stateDetector.observe(e,{attributes:!0,childList:!0}))}updateNextNeighbor(e){this.watchNeighbor(e,"next")}updatePreviousNeighbor(e){this.watchNeighbor(e,"previous")}watchNeighbor(e,t){this.detachListeners(t),null==e||e.ion({name:t,thisObj:this,collapse:"syncState",expand:"syncState",hide:"syncState",show:"syncState"})}updateOrientation(){this.syncState.now()}updateVertical(e){var t;const n=null===(t=this.element)||void 0===t?void 0:t.classList;null==n||n.add(Tg[e?1:0]),null==n||n.remove(Tg[e?0:1])}syncState(){const e=this,{element:t,nextWidget:n,previousWidget:r}=e;let s=xg[e.orientation]??null;if(e.nextNeighbor=n,e.previousNeighbor=r,e.disabled=n&&(n.collapsible&&n.collapsed||n.hidden)||r&&(r.collapsible&&r.collapsed||r.hidden),null!==s&&n&&r)e.containerElement=null;else if(e.containerElement=t.parentElement,e.rendered&&t.offsetParent){const e=yr.getStyleValue(t.parentElement,"flex-direction");if(e)s=!e.startsWith("column");else{const e=t.previousElementSibling,n=t.nextElementSibling;if(!e||!n)return;const r=e.getBoundingClientRect(),i=n.getBoundingClientRect(),a=r.top<i.top?r:i,o=a===i?r:i;s=a.top===o.top}}e.vertical=s}onMouseDown(e){var t;e.preventDefault(),e.touches&&(e=e.touches[0]);const n=this,{element:s,nextNeighbor:i,previousNeighbor:a}=n,o=a?a.element:n.getSibling(!1),l=i?i.element:n.getSibling(),c=Eg(o),d=Eg(l),u=[];null===(t=n.mouseDetacher)||void 0===t||t.call(n);for(const e of s.parentElement.children)Eg(e)&&e!==s&&u.push({element:e,width:e.offsetWidth,height:e.offsetHeight});n.context={startX:e.pageX,startY:e.pageY,prevWidth:o.offsetWidth,prevHeight:o.offsetHeight,nextWidth:l.offsetWidth,nextHeight:l.offsetHeight,prevHasFlex:c,nextHasFlex:d,flexed:u,prev:o,next:l};const h={element:document,pointermove:"onMouseMove",pointerup:"onMouseUp",thisObj:n};r.supportsPointerEvents||(h.mousemove=h.touchmove="onMouseMove",h.mouseup=h.touchend="onMouseUp"),s.classList.add("b-moving"),n.mouseDetacher=Mn.on(h),n.trigger("splitterMouseDown",{event:e})}onMouseMove(e){const t=this,{context:n,nextWidget:r,previousWidget:s}=t,i=n.prev.style,a=n.next.style,o=(e.pageX-n.startX)*(t.rtl?-1:1),l=e.pageY-n.startY;if(e.preventDefault(),Object.assign(n,{deltaX:o,deltaY:l}),n.started||(n.started=!0,t.trigger("dragStart",{context:n,event:e}),n.flexed.forEach((e=>{e.element.style.flexGrow=t.vertical?e.width:e.height,e.element.style.flexBasis="0"}))),t.vertical){const e=n.prevWidth+o,t=n.nextWidth-o;n.prevHasFlex?i.flexGrow=e:s?s.width=e:i.width=`${e}px`,n.nextHasFlex?a.flexGrow=t:r?r.width=t:a.width=`${t}px`}else{const e=n.prevHeight+l,t=n.nextHeight-l;n.prevHasFlex?i.flexGrow=e:s?s.height=e:i.height=`${e}px`,n.nextHasFlex?a.flexGrow=t:r?r.height=t:a.height=`${t}px`}t.trigger("drag",{context:n,event:e})}onMouseUp(e){var t;const n=this;null===(t=n.mouseDetacher)||void 0===t||t.call(n),n.mouseDetacher=null,n.element.classList.remove("b-moving"),n.context.started&&n.trigger("drop",{context:n.context,event:e}),n.context=null}render(){super.render(...arguments),this.syncState.now(),null===this.vertical&&this.syncState()}}kg.initClass(),kg._$name="Splitter";class Ig extends Dc{static $name="Tab";static type="tab";static get configurable(){return{active:null,index:null,isFirst:null,isLast:null,item:{value:null,$config:"nullify"},itemCls:null,tabPanel:null,titleProperty:"text",titleSource:"title",role:"tab"}}compose(){const{active:e,cls:t,index:n,isFirst:r,isLast:s}=this;return{tabindex:0,"aria-selected":e,"aria-setsize":this.owner.visibleChildCount,"aria-posinset":n+1,class:{"b-tabpanel-tab":1,"b-active":e,"b-tab-first":r,"b-tab-last":s,...t},dataset:{index:n}}}updateIndex(e){this.isFirst=!e}updateItem(e,t){var n,r;const s=this;(null==t?void 0:t.tab)===s&&(t.tab=null),e&&(e.tab=s,s[s.titleProperty]=e[s.titleSource],s.itemCls=e.cls,s.ariaElement.setAttribute("aria-controls",e.id),e.role="tabpanel"),null===(n=s.itemChangeDetacher)||void 0===n||n.call(s),s.itemChangeDetacher=e&&Ce.after(e,"onConfigChange","onItemConfigChange",s,{return:!1}),null===(r=s.itemHideDetacher)||void 0===r||r.call(s),s.itemHideDetacher=null==e?void 0:e.ion({beforeChangeHidden:"onItemBeforeChangeHidden",beforeHide:"onItemBeforeHide",beforeUpdateDisabled:"onItemBeforeUpdateDisabled",thisObj:s,prio:1e3}),s.syncMinMax()}updateItemCls(e,t){const{element:n}=this,r=n&&Sn.from(null==n?void 0:n.classList,!0);n&&(r.remove(t).add(e),n.className=r.value)}updateRotate(e,t){!e!=!t&&this.syncMinMax()}syncMinMax(){const e=this,{rotate:t,tabPanel:n}=e;let{_minWidth:r,_minHeight:s,_maxWidth:i,_maxHeight:a}=e;if(n){const{tabMinWidth:o,tabMaxWidth:l}=n;null!=o&&(t?(r===o&&(r=null),s=o):(s===o&&(s=null),r=o)),null!=l&&(t?(i===l&&(i=null),a=l):(a===l&&(a=null),i=l)),e.minWidth=r,e.minHeight=s,e.maxWidth=i,e.maxHeight=a}}onItemBeforeChangeHidden({source:e,hidden:t}){if(!e.$isDeactivating&&!e.$isActivating){const{tabPanel:n}=this;this.hidden=t,t&&e===n.activeItem&&n.activateAvailableTab(e)}}onItemBeforeHide(){this.item.$isDeactivating||this.hide()}onItemBeforeUpdateDisabled({source:e,disabled:t}){const{tabPanel:n}=this;this.disabled=t,e===n.activeItem&&n.activateAvailableTab(e)}onItemConfigChange({name:e,value:t}){e===this.titleSource&&(this[this.titleProperty]=t)}}Ig.initClass(),Ig._$name="Tab";const Rg=e=>e.isTab;class Mg extends Fc{static $name="TabBar";static type="tabbar";static get configurable(){return{defaultType:"tab",overflow:"scroll",role:"tablist",ignoreParentReadOnly:!0}}get firstTab(){return this.tabAt(0)}get lastTab(){return this.tabAt(-1)}get tabCount(){return this._items.countOf(Rg)}get tabs(){return ge.from(this._items,Rg)}compose(){return{children:{toolbarContent:{class:{"b-tabpanel-tabs":1}}}}}indexOfTab(e){return this._items.indexOf(e,Rg)}onChildAdd(e){super.onChildAdd(e),null==e.index&&this.syncTabs()}onChildRemove(e){super.onChildRemove(e),this.syncTabs()}onFocusIn(){const{activeIndex:e}=this.owner;isNaN(e)||this.tabs[e].focus()}syncTabs(){const{tabs:e}=this;for(let t=0,n=e.length;t<n;++t)e[t].index=t,e[t].isFirst=!t,e[t].isLast=t===n-1}tabAt(e){return this._items.find(Rg,e)||null}}Mg.initClass(),Mg._$name="TabBar";const Og=["b-slide-out-left","b-slide-out-right","b-slide-in-left","b-slide-in-right"];class Ag extends ol{static $name="Card";static type="card";static configurable={containerCls:"b-card-container",itemCls:"b-card-item",hideChildHeaderCls:"b-hide-child-headers",animateCardChange:!0,activeItem:null,activeIndex:null};onChildAdd(e){super.onChildAdd(e);const t=this,{activeItem:n,owner:r}=t,s=null!=r.activeIndex?r.activeIndex:t.activeIndex||0,i=r.items.indexOf(e),a=null!=n?e===n:i===s;e.ion({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:t}),a?(t._activeIndex=i,t._activeItem=e,e.show()):(e.$isDeactivating=!0,e.hide(),e.$isDeactivating=!1)}onChildRemove(e){super.onChildRemove(e);const t=this;t._activeItem===e&&t.activateSiblingOf(e),t._activeIndex=t.owner.items.indexOf(t._activeItem),e.un({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:t})}onBeforeChildShow({source:e}){if(!this.owner.isConfiguring&&!e.$isActivating)return this.activeItem=e,!1}onBeforeChildHide({source:e}){if(!this.owner.isConfiguring&&!e.$isDeactivating)return this.activateSiblingOf(e),!1}activateSiblingOf(e){const{owner:t}=this,n=t.items.slice(),r=n.indexOf(e);n.splice(r,1),this.activeIndex=Math.min(r,n.length-1)}setActiveItem(e,t=this.activeIndex,n){const r=this,{owner:s}=r,{items:i}=s,a=e instanceof il,o=i[t],l=s.items[e=a?i.indexOf(e):parseInt(e,10)],c=!1!==(null==n?void 0:n.animation),d=!(null!=n&&n.silent),u={prevActiveIndex:t,prevActiveItem:o};if(l&&!l.$isActivating&&l!==o){var h;const i=o&&o.element,a=l&&l.element;if(r.animateDetacher){const e=r.animateDetacher.event;if(e.activeItem===l)return e.promise;r.animateDetacher(),e.prevActiveItem.element.classList.remove(...Og),e.activeItem.element.classList.remove(...Og),r.animateDetacher=null}if(u.activeIndex=e,u.activeItem=l,d&&!1===s.trigger("beforeActiveItemChange",u))return null;const g=r._activeIndex!==u.activeIndex;g&&(r._activeIndex=u.activeIndex),d&&(null===(h=s.onBeginActiveItemChange)||void 0===h||h.call(s,u)),g&&(r._activeIndex=u.prevActiveIndex),c&&i&&s.isVisible&&r.animateCardChange?u.promise=r.cardChangeAnimation=new Promise(((c,h)=>{const g=o.monitorResize;o.monitorResize=!1,r.contentElement.style.overflowX="hidden",o._hidden=!0,l.$isActivating=!0,l.show(),l.$isActivating=!1,i.classList.add(e>t?"b-slide-out-left":"b-slide-out-right"),a.classList.add(e<t?"b-slide-in-left":"b-slide-in-right"),s.isAnimating=!0,r.animateDetacher=Mn.onTransitionEnd({mode:"animation",element:a,thisObj:o,handler(){s.isAnimating=r.cardChangeAnimation=!1,r.animateDetacher?(r.animateDetacher=null,a.classList.remove(...Og),i&&(i.classList.remove(...Og),o.$isDeactivating=!0,o._hidden=!1,o.hide(),o.monitorResize=g,o.$isDeactivating=!1),r.contentElement.style.overflowX="",r.onActiveItemChange(u,c,!d)):r.setActiveItem(e,t,n)}}),r.animateDetacher.reject=h,r.animateDetacher.event=u})):(l.$isActivating=!0,l.show(),l.focus(),l.$isActivating=!1,o&&(o.$isDeactivating=!0,o.hide(),o.$isDeactivating=!1),r.onActiveItemChange(u,null,!d))}return u}onActiveItemChange(e,t,n){const r=this;r._activeItem=e.activeItem,r._activeIndex=e.activeIndex,!n&&r.owner.trigger("activeItemChange",e),r.owner.containsFocus&&e.activeItem.focus(),null==t||t(e)}renderChildren(){const{owner:e}=this;e.contentElement.classList.toggle(this.hideChildHeaderCls,e.suppressChildHeaders),super.renderChildren()}changeActiveIndex(e){const{owner:t}=this;return t.isConfiguring&&!t._items?e:Math.min(e,t.items.length-1)}updateActiveIndex(e,t){this.owner.isConfiguring||this.setActiveItem(e,t)}updateActiveItem(e){this.owner.isConfiguring||this.setActiveItem(e,this.activeIndex)}get isChangingCard(){return Boolean(this.animateDetacher)}}Ag.initClass(),Ag._$name="Card";const Fg=e=>e.maximized;class Pg extends Hc{static $name="TabPanel";static type="tabpanel";static alias="tabs";static get configurable(){return{activeTab:0,animateTabChange:!0,autoHeight:!1,defaultType:"container",focusable:!1,itemCls:"b-tabpanel-item",layout:{type:"card"},suppressChildHeaders:!0,tabBar:{type:"tabbar",weight:-2e3},tabMinWidth:null,tabMaxWidth:null}}get activeIndex(){return this.layout.activeIndex}get activeItem(){return this.layout.activeItem}get activeTabItemIndex(){var e;const{activeTab:t,items:n,tabBar:r}=this;return n.indexOf(null===(e=r.tabs[t])||void 0===e?void 0:e.item)}get bodyConfig(){return Ut.merge({className:{"b-tabpanel-body":1}},super.bodyConfig)}get focusElement(){var e;const t=this.items[this.activeTab||0];return(null==t?void 0:t.focusElement)||(null==t||null===(e=t.tab)||void 0===e?void 0:e.focusElement)}get tabPanelBody(){return this.bodyElement}finalizeInit(){super.finalizeInit();const e=this,{activeTab:t,layout:n}=e,{activeIndex:r}=n,{tabs:s}=e.tabBar,i=t>=0&&t<s.length&&e.items.indexOf(s[t].item);if(s.length>0&&(!1===i||i<0))throw new Error(`Invalid activeTab ${t} (${s.length} tabs)`);i!==r&&n.setActiveItem(i,r,{animation:!1,silent:!0}),n.animateCardChange=e.animateTabChange}onChildAdd(e){if(super.onChildAdd(e),!this.initialItems){const t=this,{tabBar:n}=t,r=t.makeTabConfig(e),s=r&&(null==n?void 0:n.firstTab),i=s&&n._items,a=s&&ge.from(t._items,(t=>t.tab||t===e)),o=s?a.indexOf(e)+i.indexOf(s):0;r&&n&&(s&&null==e.weight&&o<i.count-1?n.insert(r,o):n.add(r))}}onChildRemove(e){const{tab:t}=e,{items:n}=this;t&&(this.tabBar.remove(t),t.destroy()),e===this.activeItem&&(this._activeTab=null,n.length&&(this.activeTab=n[Math.min(this.activeIndex,n.length-1)])),super.onChildRemove(e)}isDisabledOrHiddenTab(e){const{tabs:t}=this.tabBar,n=null==t?void 0:t[e];return n&&(n.disabled||n.hidden)}findAvailableTab(e,t=1){const{tabs:n}=this.tabBar,r=n.length,s=Math.max(0,n.indexOf(e.tab));let i;s&&(t=-t);for(let e=1;e<=r&&(i=(s+(t<0?r:0)+e*t)%r,this.isDisabledOrHiddenTab(i));++e);return i}activateAvailableTab(e,t=1){this.activeTab=this.findAvailableTab(e,t)}changeActiveTab(e,t){const n=this,{tabBar:r,layout:s}=n,{tabCount:i}=r;if(e.isWidget||Ut.isObject(e)?(-1===n.items.indexOf(e)&&(e=n.add(e)),e=r.indexOfTab(e.tab)):e=parseInt(e,10),!n.initialItems&&i>0&&(e<-1||e>=i))throw new Error(`Invalid activeTab ${e} (${i} tabs)`);if(n.isDisabledOrHiddenTab(e)&&(e=n.findAvailableTab(e)),!s.animateCardChange||!s.cardChangeAnimation)return e;s.cardChangeAnimation.then((r=>{(null==r?void 0:r.activeIndex)!==e&&(n._activeTab=e,n.updateActiveTab(e,t))}))}async updateActiveTab(e,t){if(!this.initialItems){const{activeTabItemIndex:e,layout:r}=this;if(e>-1){const s=this.items[t],i=this.items[e];var n;if(r.activeItem!==i)r.animateCardChange&&await this.tabSelectionPromise,null!=s&&s.containsFocus&&s.tab.focus(),this.tabSelectionPromise=null===(n=r.setActiveItem(i))||void 0===n?void 0:n.promise}}}changeTabBar(e){return this.getConfig("strips"),this.strips={tabBar:e},this.strips.tabBar}makeTabConfig(e){const{tab:t}=e,n={item:e,type:"tab",tabPanel:this,disabled:Boolean(e.disabled),hidden:e.initialConfig.hidden,weight:e.weight||0,internalListeners:{click:"onTabClick",thisObj:this},localizableProperties:{text:!1}};return!1===t?null:Ut.isObject(t)?Ig.mergeConfigs(n,t):n}updateItems(e,t){const n=this,{activeTab:r,initialItems:s}=n;let i,a=0;super.updateItems(e,t),s&&(i=Array.from(e,(e=>n.makeTabConfig(e))).filter((e=>{if(e)return e.index=a++,!0})),a&&(i[0].isFirst=!0,i[a-1].isLast=!0,i[r].active=!0,n.tabBar.add(i),n.activeTab=r))}updateTabMinWidth(e){var t;null===(t=this.tabBar)||void 0===t||t.items.forEach((t=>{t.isTab&&(t.minWidth=e)}))}updateTabMaxWidth(e){var t;null===(t=this.tabBar)||void 0===t||t.items.forEach((t=>{t.isTab&&(t.maxWidth=e)}))}updateAutoHeight(e){this.detachListeners("themeAutoHeight"),e&&xr.ion({name:"themeAutoHeight",theme:"internalOnThemeChange",thisObj:this}),this.$measureHeight=e}applyAutoHeight(){const e=this,{layout:t,activeTab:n,element:r}=e,{animateCardChange:s}=t;if(t.animateCardChange=!1,e.height=null,!e.up(Fg)){const t=e.height=Math.max(...e.items.map((t=>(e.activeTab=t,r.clientHeight))))+1;e.flex=`1 1 ${t}px`}e.activeTab=n,t.animateCardChange=s,e.$measureHeight=!1}internalOnThemeChange(){this.isVisible?this.applyAutoHeight():this.$measureHeight=!0}onBeginActiveItemChange(e){const t=this.tabBar.tabs,{activeItem:n,prevActiveItem:r}=e;this.activeTab=t.indexOf(null==n?void 0:n.tab),null!=r&&r.tab&&(r.tab.active=!1),null!=n&&n.tab&&(n.tab.active=!0,n.tab.show())}onBeforeActiveItemChange(e){return this.trigger("beforeTabChange",e)}onActiveItemChange(e){this.trigger("tabChange",e)}onTabClick(e){this.activeTab=e.source.item}onInternalPaint(){super.onInternalPaint(...arguments),this.$measureHeight&&this.applyAutoHeight()}}Pg.initClass(),Pg._$name="TabPanel";class Lg extends sh{static $name="TextAreaField";static type="textareafield";static alias="textarea";static get configurable(){return{resize:"none",inputAttributes:{tag:"textarea"}}}updateResize(e){this.input.style.resize=e}}Lg.initClass(),Lg._$name="TextAreaField";class $g extends ah{static $name="TextAreaPickerField";static type="textareapickerfield";static get configurable(){return{picker:{type:"widget",tag:"textarea",cls:"b-textareapickerfield-picker",scrollAction:"realign",align:{align:"t-b",axisLock:!0},autoShow:!1},triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},resize:"none",inputType:null}}startConfigure(e){"boolean"==typeof e.inline&&P.deprecate("Core","6.0.0","TextAreaPickerField.inline config is no longer supported"),super.startConfigure(e)}get inputElement(){const e=super.inputElement;return e.readOnly="readonly",e.reference="displayElement",this.ariaElement="displayElement",e}get focusElement(){var e;return null!==(e=this._picker)&&void 0!==e&&e.isVisible?this.input:this.displayElement}get needsInputSync(){return this.displayElement[this.inputValueAttr]!==String(this.inputValue??"")}showPicker(){const e=this,{picker:t}=e;e.inline||(t.width=e.pickerWidth||e[e.pickerAlignElement].offsetWidth,super.showPicker(!0))}focusPicker(){this.input.focus()}onPickerKeyDown(e){const t=this,n=t.input;switch(e.key.trim()||e.code){case"Escape":return void t.picker.hide();case"Enter":e.ctrlKey&&(t.syncInputFieldValue(),t.picker.hide())}t.input=t.displayElement;const r=super.onPickerKeyDown(e);return t.input=n,r}syncInputFieldValue(e){this.displayElement&&(this.displayElement.value=this.inputValue),super.syncInputFieldValue(e)}changeValue(e){return null==e?"":e}changePicker(e,t){var n;const r=this,s=r.pickerWidth||(null===(n=e)||void 0===n?void 0:n.width);if(e=$g.reconfigure(t,e?F.merge({owner:r,forElement:r[r.pickerAlignElement],align:{matchSize:null==s,anchor:r.overlayAnchor,target:r[r.pickerAlignElement]},id:r.id+"-input",style:{resize:r.resize},html:r.value??""},e):null,r)){const t=r.input=e.element;r.inputListenerRemover=Mn.on({element:t,thisObj:r,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput",keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}return e}}$g.initClass(),$g._$name="TextAreaPickerField";const _g=[],Ng=e=>"*"!==e[0],jg=(e,t)=>{const n=e[t]||null;return delete e[t],n},Vg=e=>e.responsiveRoot,Bg={number:e=>({width:t})=>t<=e&&e},zg=e=>(delete e.once,{callback:jg(e,"callback"),configs:e,when:jg(e,"when")}),Wg=(e,...t)=>{const n=t.flatMap((e=>(null==e?void 0:e.once)||_g)),r=e.mergeConfigs(...t),s=zg(r);return s.once=n.length?zg(e.mergeConfigs(...n)):null,s};var Hg=e=>class extends((e||ue).mixin(Ur,yu)){static $name="Responsive";static configurable={responsive:{$config:{lazy:"paint"},value:null},responsiveDefaults:{small:{when:400},medium:{when:800},large:{when:()=>1/0},"*":{}},responsiveRoot:null,responsiveState:null,responsiveTarget:{value:null,$config:{lazy:"paint"}},responsiveWidget:{value:null,$config:{nullify:!0}},breakpoints:null};static delayable={responsiveUpdate:"raf"};static fenced={syncResponsiveWidget:!0};static prototypeProperties={responsiveStateChanges:0,responsiveUpdateCount:0};get isResponsivePending(){return 0===this.responsiveUpdateCount&&this.hasConfig("responsive")}get isResponsiveUpdating(){var e;return this._responsiveUpdating||(null===(e=this.responsiveWidget)||void 0===e?void 0:e._responsiveUpdating)}updateResponsive(e){const t=this,n=t.constructor,{responsiveDefaults:r}=t,s=Array.from(new Set(Ut.keys(e).concat(Ut.keys(r)))).filter(Ng);let i,a,o,l,c=null;if(e)for(a of(c={"*":Wg(n,r["*"],e["*"])},s)){var d;if(o=e[a],null!==o&&!1!==o)i=i||o&&"when"in o,c[a]=Wg(n,r["*"],r[a],e["*"],o),l=c[a].when,c[a].when=(null===(d=Bg[typeof l])||void 0===d?void 0:d.call(Bg,l))||l}t.$responsiveStates=c,t.$responsiveWhen=i,t.syncResponsiveWidget()}updateResponsiveState(e,t){var n;const r=this,{$responsiveStates:s}=r,i=1==++r.responsiveStateChanges,a=null===(n=r.element)||void 0===n?void 0:n.classList,o=s["*"],l=s[e]||o,c=i&&(l.once||o.once),d=i&&r.isStateful,u=r.responsiveWidget;let h=l.configs,g=null==c?void 0:c.configs;g&&(h=h?r.constructor.mergeConfigs(h,g):g),t&&(null==a||a.remove(`b-responsive-${t.toLowerCase()}`)),e&&(null==a||a.add(`b-responsive-${e.toLowerCase()}`)),d&&(g=r.loadStatefulData(),g&&(h=h?r.constructor.mergeConfigs(h,g):g),r.suspendStateful()),r._responsiveUpdating=!0;try{var m,p,f,v;null===(m=r.trigger)||void 0===m||m.call(r,"beforeResponsiveStateChange",{state:e,oldState:t,target:u}),h&&r.setConfig(h),null===(p=l.callback)||void 0===p||p.call(l,{source:r,state:e,oldState:t,target:u,initial:i}),null==c||null===(f=c.callback)||void 0===f||f.call(c,{source:r,state:e,oldState:t,target:u,initial:i}),null===(v=r.trigger)||void 0===v||v.call(r,"responsiveStateChange",{state:e,oldState:t,target:u})}finally{r._responsiveUpdating=!1,d&&r.resumeStateful()}}get responsiveTarget(){return this.responsiveWidget||this._responsiveTarget}updateResponsiveTarget(){this.syncResponsiveWidget()}updateResponsiveWidget(e){var t;const n=this,r=e&&n.responsiveUpdate;null===(t=n.$responsiveWrapper)||void 0===t||t.destroy(),n.$responsiveWrapper=e&&((e,t)=>{let n,r=Proxy.revocable(e,{get:(t,r)=>(n&&(n[r]=!0),e[r])}),s=Ce.after(e,"onConfigChange",((e,{name:r})=>{var s;null!==(s=n)&&void 0!==s&&s[r]&&t()})),i=e.ion({resize:()=>{t()}});return e.monitorResize=!0,{widget:e,get object(){var e;return null===(e=r)||void 0===e?void 0:e.proxy},destroy(){r&&(r.revoke(),s(),i(),r=s=i=null)},reset(){n=Object.create(null)}}})(e,r),null==r||r.now()}responsiveUpdate(){const e=this,{$responsiveStates:t,$responsiveWrapper:n}=e,s=null==n?void 0:n.widget;if(t&&n){let i,a,o=null,l=0,c=t;for(a in s&&s!==e&&!e.$responsiveWhen&&(s.getConfig("responsive"),c=s.$responsiveStates||c),n.reset(),t)"*"!==a&&(i=c[a].when(n.object,r),null!=i&&!1!==i&&(!o||i<l)&&(o=a,l=i));++e.responsiveUpdateCount,e.responsiveState=o}}syncResponsiveWidget(){const e=this;let t,n=null;if(!e.isDestroying&&e.responsive){var r;if(t=e.responsiveTarget,n=t){if("string"==typeof t&&(n="@"===t?e:"@"===t[0]?e[t.substring(1)]:e.up(t),!n))throw new Error(`No match for responsiveTarget="${t}"`)}else n=!e.responsiveRoot&&(null===(r=e.up)||void 0===r?void 0:r.call(e,Vg))||e;if(!n.isWidget)throw new Error(`${n.constructor.$$name} is not a widget and cannot be a responsiveTarget`)}return e.responsiveWidget=n,n}changeBreakpoints(e){return Ut.assertObject(e,"breakpoints"),null!=e&&e.width&&Object.keys(e.width).forEach((t=>{e.width[t].maxWidth=t})),null!=e&&e.height&&Object.keys(e.height).forEach((t=>{e.height[t].maxHeight=t})),e}updateBreakpoints(e){e&&(this.monitorResize=!0)}getBreakpoint(e,t){return e[Object.keys(e).map((e=>parseInt(e))).sort().find((e=>t<=e))??(e["*"]&&"*")]}activateBreakpoint(e,t){const n=this,r=n[`current${e}Breakpoint`];var s,i;t!==r&&(n[`current${e}Breakpoint`]=t,n.setConfig(t.configs),r&&n.element.classList.remove(`b-breakpoint-${r.name.toLowerCase()}`),n.element.classList.add(`b-breakpoint-${t.name.toLowerCase()}`),n.trigger(`responsive${e}Change`,{breakpoint:t,prevBreakpoint:r}),null===(s=t.callback)||void 0===s||s.call(t,{source:n,breakpoint:t,prevBreakpoint:r}),null===(i=n.recompose)||void 0===i||i.call(n))}applyResponsiveBreakpoints(e,t){const n=this,{width:r,height:s}=n.breakpoints??{};if(r){const t=n.getBreakpoint(r,e);n.activateBreakpoint("Width",t)}if(s){const e=n.getBreakpoint(s,t);n.activateBreakpoint("Height",e)}}onInternalResize(e,t,n,r,s){super.onInternalResize(e,t,n,r,s),this.applyResponsiveBreakpoints(t,n)}},Ug=e=>class extends(e||ue){static $name="Styleable";static configurable={cssVarPrefix:"",css:{}};changeCssVarPrefix(e){return Ut.assertString(e,"prefix"),e&&!e.endsWith("-")&&(e+="-"),e||""}changeCss(e){Ut.assertObject(e,"css");const t=this;if(!globalThis.Proxy)throw new Error("Proxy not supported");const n=new Proxy({},{get(e,n){var r;return null===(r=getComputedStyle(t.element||document.documentElement).getPropertyValue(`--${t.cssVarPrefix}${T.hyphenate(n)}`))||void 0===r?void 0:r.trim()},set:(e,n,r)=>((t.element||document.documentElement).style.setProperty(`--${t.cssVarPrefix}${T.hyphenate(n)}`,r),!0)});return e&&(t._element?Ut.assign(n,e):t.$initialCSS=e),n}updateElement(e,...t){super.updateElement(e,...t),this.$initialCSS&&Ut.assign(this.css,this.$initialCSS)}get widgetClass(){}};const Yg="http://www.w3.org/2000/svg",qg={bar:1,outline:2,text:3},Kg=(e,t)=>parseInt(e.order,10)-parseInt(t.order,10),Gg=(e,t)=>parseInt(e.dataset.order,10)-parseInt(t.dataset.order,10),Xg=e=>e.field,Zg=()=>!1,Jg=/\s+/;class Qg extends il{static type="histogram";static $name="Histogram";static get configurable(){return{data:null,values:null,series:null,topValue:null,element:{children:[{ns:Yg,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:Yg,tag:"g",reference:"scaledSvgGroup"},{ns:Yg,tag:"g",reference:"unscaledSvgGroup"}]}]},omitZeroHeightBars:!1,singleTextForAllBars:!0,monitorResize:!0,getRectClass:(e,t,n,r)=>"",getOutlineClass:(e,t)=>"",getBarTip(e,t,n,r){},getBarText:(e,t,n)=>"",getRectConfig:null,getBarTextRenderData:(e,t,n,r)=>e,getBarTextTip(e,t,n,r){}}}static properties={refreshSuspended:0};construct(e){const t=this;super.construct(e),t.scheduleRefresh=t.createOnFrame(t.refresh,[],t,!0),t.refresh()}set tip(e){var t;const n=this;null===(t=n.tip)||void 0===t||t.destroy(),n._tip=e?Xu.new({owner:n,forElement:n.svgElement,forSelector:"rect",internalListeners:{beforeShow:"up.onBeforeTipShow"}},e):null}onElementResize(){super.onElementResize(...arguments);const e=this.svgElement.getBoundingClientRect();this.scaledSvgGroup.setAttribute("transform",`scale(${e.width} ${e.height})`)}onBeforeTipShow({source:e}){const t=parseInt(e.activeTarget.dataset.index);e.html=e.contentTemplate({histogram:this,index:t})}updateSeries(e){const t=this,n=t._series={};let r=0,s=0;for(const t in e)if(!1!==e[t]){const i=n[t]=F.merge({},e[t]);i.field||(i.field=t),i.type||(i.type="bar"),"order"in i||(i.order=10*qg[i.type]+r),"index"in i||(i.index=r),"bar"===i.type&&(i.index=s++),i.id=t,r++}!t.topValue&&t._data&&(t.topValue=t.getDataTopValue(t._data)),t.refreshSuspended||t.scheduleRefresh()}getDataTopValue(e,t){const n=Object.values(t||this.series).map(Xg);let r,s=0;for(let t=0,{length:i}=e;t<i;t++){r=e[t];for(let e=0,{length:t}=n;e<t;e++)s=Math.max(s,r[n[e]])}return s}updateData(e){const t=this;t._data=e,!t.topValue&&t._data&&t._series&&(t.topValue=t.getDataTopValue(e)),t.refreshSuspended||t.scheduleRefresh()}updateTopValue(e){const t=this;t._topValue=e,!e&&t._data&&(t._topValue=t.getDataTopValue(t._data)),t.refreshSuspended||t.scheduleRefresh()}scheduleRefresh(){}suspendRefresh(){this.refreshSuspended++}resumeRefresh(){this.refreshSuspended&&this.refreshSuspended--}refresh(e){const t=this,{series:n,_tip:r,topValue:s,singleTextForAllBars:i}=t,a=(null==e?void 0:e.args)||[],o=[],l=[];if(n){for(const e of Object.values(n).sort(Kg)){const n=t[`draw${T.capitalize(e.type)}`](e,...a);Array.isArray(n)?o.push.apply(o,n):o.push(n),i||"bar"!==e.type||l.push(...t.drawText(e,...a))}o.sort(Gg),i?l.push(...t.drawText(null,...a)):l.sort(Gg),go.sync({domConfig:{width:"100%",height:"100%",preserveAspectRatio:"none",dataset:{topValue:s},children:[{ns:Yg,tag:"g",reference:"scaledSvgGroup",children:o},{ns:Yg,tag:"g",reference:"unscaledSvgGroup",children:l}]},configEquality:Zg,targetElement:t.svgElement}),r&&r.isVisible&&t.onBeforeTipShow({source:r})}}drawBar(e,...t){const n=this,{topValue:r,data:s,omitZeroHeightBars:i,barStyle:a}=n,{field:o,order:l,stretch:c}=e,{length:d}=s,u=1/d,h=[],g=T.createId(e.id),m=e.index,p=c?1:void 0;let f;for(let c=0,d=0,{length:v}=s;c<v;c++,d+=f){const v=s[c];let y=v.rectConfig={ns:Yg,tag:"rect",dataset:{}};const b=v[o],C=b?p||v.height||(b>r?r:b)/r:0,S=1-C,w=n.callback("getBarTip",n,[e,y,v,c,...t]);f=v.width||u,a?y.style=a:delete y.style,Object.assign(y.dataset,{index:c,order:l,series:g});const D={[`b-series-${g}`]:1,[`b-series-index-${m}`]:1},T=n.callback("getRectClass",n,[e,y,v,c,...t]);T&&T.split(Jg).forEach((e=>D[e]=1)),Object.assign(y,{x:d,y:S,width:f,height:C,class:D}),w?y.dataset.btip=w:delete y.dataset.btip,n.getRectConfig&&(y=n.getRectConfig(y,v,c,e,...t)),!y||!y.height&&i||h.push(y)}return h}changeGetRectConfig(e){return e?this.bindCallback(e):null}drawOutline(e,...t){const n=this,{topValue:r,data:s}=n,{field:i,order:a,id:o}=e,l=1/s.length,c=["M 0,1"],d={ns:Yg,tag:"path",dataset:{order:a,id:o}};let u,h="M",g="L";for(let e=0,t=0,{length:n}=s;e<n;e++){const n=1-s[e][i]/r;u=s[e].width||l,c.push(`${h} ${t},${n} ${g} ${t+=u},${n}`),h=g=""}return d.class=`b-series-${e.id} b-series-index-${e.index} `+n.callback("getOutlineClass",n,[e,s,...t]),d.d=c.join(" "),d}drawText(e,...t){const n=this,{data:r}=n,s=1/r.length,i=[];for(let a,o=0,l=0,{length:c}=r;o<c;o++,l+=a){a=r[o].width||s;const c=n.callback("getBarText",n,[r[o],o,e,...t]);if(c){const s=n.callback("getBarTextRenderData",n,[{ns:Yg,tag:"text",className:"b-bar-legend",html:c,left:l,width:a,x:100*(l+a/2)+"%",y:void 0!==r[o].y?r[o].y:"100%",dataset:{index:o,series:e}},r[o],o,e,...t]),d=n.callback("getBarTextTip",n,[s,r[o],o,e,...t]);d?s.dataset.btip=d:delete s.dataset.btip,i.push(s)}}return i}}Qg.initClass(),Qg._$name="Histogram";const em="http://www.w3.org/2000/svg";class tm extends il{static $name="Scale";static type="scale";static get configurable(){return{scalePoints:null,scaleMaxPadding:.1,horizontal:!1,align:{value:!1,$config:{merge:"replace"}},element:{children:[{ns:em,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:em,tag:"g",reference:"scaledSvgGroup",children:[{ns:em,tag:"path",reference:"pathElement"}]},{ns:em,tag:"g",reference:"unscaledSvgGroup"}]}]},monitorResize:!0}}construct(e){super.construct(e),this.scheduleRefresh=this.createOnFrame(this.refresh,[],this,!0),this.refresh()}changeAlign(e){return e||(e=this.horizontal?"bottom":"right"),e}updateAlign(e,t){this.element.classList.remove(`b-align-${t}`),this.element.classList.add(`b-align-${e}`)}updateHorizontal(e,t){this.element.classList.remove("b-scale-"+(t?"horizontal":"vertical")),this.element.classList.add("b-scale-"+(e?"horizontal":"vertical"))}onElementResize(){super.onElementResize(...arguments),this.scheduleRefresh()}scheduleRefresh(){}refresh(){var e;if(!this.scalePoints)return;const t=this,{horizontal:n,width:r,height:s,align:i,scalePoints:a,scaleMaxPadding:o}=t,l=null===(e=a[a.length-1])||void 0===e?void 0:e.value,c=[],d=[],u=1/(l+o*l);t.scaledSvgGroup.setAttribute("transform",`scale(${n?r:1} ${n?1:s})`);for(const e of a){const t=Boolean(e.text),a=u*e.value;if(t){const t={ns:em,tag:"text",className:"b-scale-tick-label",html:e.text,dataset:{tick:e.value}};n?(t.x=100*a+"%",t.y="top"===i?"1.6em":s-12):(t.x="left"===i?"12":""+(r-12),t.y=100*(1-a)+"%"),d.push(t)}n?"top"===i?c.push(`M${a},0 L${a},${t?10:5}`):c.push(`M${a},${s} L${a},${s-(t?10:5)}`):"left"===i?c.push(`M0,${1-a} L${t?10:5},${1-a}`):c.push(`M${r},${1-a} L${r-(t?10:5)},${1-a}`)}t.pathElement.setAttribute("d",c.join("")),go.syncChildren({domConfig:{children:d}},t.unscaledSvgGroup)}}tm.initClass(),tm._$name="Scale";class nm extends ue{static $name="AvatarRendering";static get configurable(){return{element:null,colorPrefix:"b-sch-",tooltip:null,size:null}}doDestroy(){var e;null===(e=this.tooltip)||void 0===e||e.destroy(),super.doDestroy()}updateElement(e){Mn.on({element:e,delegate:".b-resource-image",error:"onImageErrorEvent",thisObj:this,capture:!0})}changeTooltip(e){return Xu.new({forElement:this.element,forSelector:".b-resource-avatar",cls:"b-resource-avatar-tooltip"},e)}static get failedUrls(){return this._failedUrls||(this._failedUrls=new Set),this._failedUrls}getResourceAvatar(e){if(Array.isArray(e))return e.map((e=>this.getResourceAvatar(e)));const{initials:t,color:n,iconCls:r,imageUrl:s,defaultImageUrl:i,dataset:a={},resourceRecord:o,alt:l=T.encodeHtml(null==o?void 0:o.name)}=e,c=this.getImageConfig(t,n,s,i,a,l)||this.getIconConfig(r,a)||this.getResourceInitialsConfig(t,n,a),{size:d}=this;return Object.assign(c.style,{...d?{height:d,width:d}:void 0}),c}getImageConfig(e,t,n,r,s,i){if(n=nm.failedUrls.has(n)?r:n||r)return{tag:"img",draggable:"false",loading:"lazy",class:{"b-resource-avatar":1,"b-resource-image":1},style:{},alt:i,elementData:{defaultImageUrl:r,imageUrl:n,initials:e,color:t,dataset:s},src:n,dataset:s}}getIconConfig(e,t){if(e)return e&&{tag:"i",style:{},class:{"b-resource-avatar":1,"b-resource-icon":1,[e]:1},dataset:t}}getResourceInitialsConfig(e,t,n){const r=yr.isNamedColor(t)&&t,s=!r&&t,{size:i}=this;return{tag:"div",class:{"b-resource-avatar":1,"b-resource-initials":1,[`${this.colorPrefix}${r}`]:r},style:{backgroundColor:s||null,...i?{height:i,width:i}:void 0},children:[e],dataset:n}}onImageErrorEvent({target:e}){if(!e.matches(".b-resource-avatar"))return;const{defaultImageUrl:t,initials:n,color:r,imageUrl:s,dataset:i}=e.elementData;if(t&&!e.src.endsWith(t.replace(/^[./]*/gm,"")))e.src=t;else{const t=yr.createElement(this.getResourceInitialsConfig(n,r,i));t.elementData=e.elementData,e.parentElement.replaceChild(t,e)}nm.failedUrls.add(s)}}nm._$name="AvatarRendering",window&&!window.bryntum&&(window.bryntum={});const rm=(e,t)=>new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()+t,e.getMilliseconds()),sm=function(){var e={version:"1.2.0"};return Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var r=0;if(arguments.length>1&&((r=Number(arguments[1]))!=r?r=0:0!=r&&r!=1/0&&r!=-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=n)return-1;for(var s=r>=0?r:Math.max(n-Math.abs(r),0);s<n;s++)if(s in t&&t[s]===e)return s;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),e.array={},e.array.sort=function(e,t){e.sort((function(e,t){return+e-+t})),t&&0===e[0]&&e.push(e.shift())},e.array.next=function(e,t,n){for(var r,s=0!==n[0],i=0,a=t.length-1;a>-1;--a){if((r=t[a])===e)return r;if(!(r>e||0===r&&s&&n[1]>e))break;i=a}return t[i]},e.array.nextInvalid=function(e,t,n){for(var r=n[0],s=n[1],i=t.length,a=0===t[i-1]&&0!==r?s:0,o=e,l=t.indexOf(e),c=o;o===(t[l]||a);)if(++o>s&&(o=r),++l===i&&(l=0),o===c)return;return o},e.array.prev=function(e,t,n){for(var r,s=t.length,i=0!==n[0],a=s-1,o=0;o<s;o++){if((r=t[o])===e)return r;if(!(r<e||0===r&&i&&n[1]<e))break;a=o}return t[a]},e.array.prevInvalid=function(e,t,n){for(var r=n[0],s=n[1],i=t.length,a=0===t[i-1]&&0!==r?s:0,o=e,l=t.indexOf(e),c=o;o===(t[l]||a);)if(--o<r&&(o=s),-1===--l&&(l=i-1),o===c)return;return o},e.day=e.D={name:"day",range:86400,val:function(t){return t.D||(t.D=e.date.getDate.call(t))},isValid:function(t,n){return e.D.val(t)===(n||e.D.extent(t)[1])},extent:function(t){if(t.DExtent)return t.DExtent;var n=e.M.val(t),r=e.DAYS_IN_MONTH[n-1];return 2===n&&366===e.dy.extent(t)[1]&&(r+=1),t.DExtent=[1,r]},start:function(t){return t.DStart||(t.DStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)))},end:function(t){return t.DEnd||(t.DEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)))},next:function(t,n){n=n>e.D.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.D,e.M),s=e.D.extent(r)[1];return n=n>s?1:n||s,e.date.next(e.Y.val(r),e.M.val(r),n)},prev:function(t,n){var r=e.date.prevRollover(t,n,e.D,e.M),s=e.D.extent(r)[1];return e.date.prev(e.Y.val(r),e.M.val(r),n>s?s:n||s)}},e.dayOfWeekCount=e.dc={name:"day of week count",range:604800,val:function(t){return t.dc||(t.dc=Math.floor((e.D.val(t)-1)/7)+1)},isValid:function(t,n){return e.dc.val(t)===n||0===n&&e.D.val(t)>e.D.extent(t)[1]-7},extent:function(t){return t.dcExtent||(t.dcExtent=[1,Math.ceil(e.D.extent(t)[1]/7)])},start:function(t){return t.dcStart||(t.dcStart=e.date.next(e.Y.val(t),e.M.val(t),Math.max(1,7*(e.dc.val(t)-1)+1||1)))},end:function(t){return t.dcEnd||(t.dcEnd=e.date.prev(e.Y.val(t),e.M.val(t),Math.min(7*e.dc.val(t),e.D.extent(t)[1])))},next:function(t,n){n=n>e.dc.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.dc,e.M);n=n>e.dc.extent(r)[1]?1:n;var s=e.date.next(e.Y.val(r),e.M.val(r),0===n?e.D.extent(r)[1]-6:1+7*(n-1));return s.getTime()<=t.getTime()?(r=e.M.next(t,e.M.val(t)+1),e.date.next(e.Y.val(r),e.M.val(r),0===n?e.D.extent(r)[1]-6:1+7*(n-1))):s},prev:function(t,n){var r=e.date.prevRollover(t,n,e.dc,e.M),s=e.dc.extent(r)[1];return n=n>s?s:n||s,e.dc.end(e.date.prev(e.Y.val(r),e.M.val(r),1+7*(n-1)))}},e.dayOfWeek=e.dw=e.d={name:"day of week",range:86400,val:function(t){return t.dw||(t.dw=e.date.getDay.call(t)+1)},isValid:function(t,n){return e.dw.val(t)===(n||7)},extent:function(){return[1,7]},start:function(t){return e.D.start(t)},end:function(t){return e.D.end(t)},next:function(t,n){return n=n>7?1:n||7,e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n-e.dw.val(t))+(n<=e.dw.val(t)?7:0))},prev:function(t,n){return n=n>7?7:n||7,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(n-e.dw.val(t))+(n>=e.dw.val(t)?-7:0))}},e.dayOfYear=e.dy={name:"day of year",range:86400,val:function(t){return t.dy||(t.dy=Math.ceil(1+(e.D.start(t).getTime()-e.Y.start(t).getTime())/e.DAY))},isValid:function(t,n){return e.dy.val(t)===(n||e.dy.extent(t)[1])},extent:function(t){var n=e.Y.val(t);return t.dyExtent||(t.dyExtent=[1,n%4?365:366])},start:function(t){return e.D.start(t)},end:function(t){return e.D.end(t)},next:function(t,n){n=n>e.dy.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.dy,e.Y),s=e.dy.extent(r)[1];return n=n>s?1:n||s,e.date.next(e.Y.val(r),e.M.val(r),n)},prev:function(t,n){var r=e.date.prevRollover(t,n,e.dy,e.Y),s=e.dy.extent(r)[1];return n=n>s?s:n||s,e.date.prev(e.Y.val(r),e.M.val(r),n)}},e.hour=e.h={name:"hour",range:3600,val:function(t){return t.h||(t.h=e.date.getHour.call(t))},isValid:function(t,n){return e.h.val(t)===n},extent:function(){return[0,23]},start:function(t){return t.hStart||(t.hStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)))},end:function(t){return t.hEnd||(t.hEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)))},next:function(t,n){n=n>23?0:n;var r=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n<=e.h.val(t)?1:0),n);return!e.date.isUTC&&r.getTime()<=t.getTime()&&(r=e.date.next(e.Y.val(r),e.M.val(r),e.D.val(r),n+1)),r},prev:function(t,n){return n=n>23?23:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(n>=e.h.val(t)?-1:0),n)}},e.minute=e.m={name:"minute",range:60,val:function(t){return t.m||(t.m=e.date.getMin.call(t))},isValid:function(t,n){return e.m.val(t)===n},extent:function(e){return[0,59]},start:function(t){return t.mStart||(t.mStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)))},end:function(t){return t.mEnd||(t.mEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)))},next:function(t,n){var r=e.m.val(t),s=e.s.val(t),i=n>59?60-r:n<=r?60-r+n:n-r,a=new Date(t.getTime()+i*e.MIN-s*e.SEC);return!e.date.isUTC&&a.getTime()<=t.getTime()&&(a=new Date(t.getTime()+(i+120)*e.MIN-s*e.SEC)),a},prev:function(t,n){return n=n>59?59:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)+(n>=e.m.val(t)?-1:0),n)}},e.month=e.M={name:"month",range:2629740,val:function(t){return t.M||(t.M=e.date.getMonth.call(t)+1)},isValid:function(t,n){return e.M.val(t)===(n||12)},extent:function(){return[1,12]},start:function(t){return t.MStart||(t.MStart=e.date.next(e.Y.val(t),e.M.val(t)))},end:function(t){return t.MEnd||(t.MEnd=e.date.prev(e.Y.val(t),e.M.val(t)))},next:function(t,n){return n=n>12?1:n||12,e.date.next(e.Y.val(t)+(n>e.M.val(t)?0:1),n)},prev:function(t,n){return n=n>12?12:n||12,e.date.prev(e.Y.val(t)-(n>=e.M.val(t)?1:0),n)}},e.second=e.s={name:"second",range:1,val:function(t){return t.s||(t.s=e.date.getSec.call(t))},isValid:function(t,n){return e.s.val(t)===n},extent:function(){return[0,59]},start:function(e){return e},end:function(e){return e},next:function(t,n){var r=e.s.val(t),s=n>59?60-r:n<=r?60-r+n:n-r,i=new Date(t.getTime()+s*e.SEC);return!e.date.isUTC&&i.getTime()<=t.getTime()&&(i=new Date(t.getTime()+(s+7200)*e.SEC)),i},prev:function(t,n,r){return n=n>59?59:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)+(n>=e.s.val(t)?-1:0),n)}},e.time=e.t={name:"time",range:1,val:function(t){return t.t||(t.t=3600*e.h.val(t)+60*e.m.val(t)+e.s.val(t))},isValid:function(t,n){return e.t.val(t)===n},extent:function(){return[0,86399]},start:function(e){return e},end:function(e){return e},next:function(t,n){n=n>86399?0:n;var r=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n<=e.t.val(t)?1:0),0,0,n);return!e.date.isUTC&&r.getTime()<t.getTime()&&(r=e.date.next(e.Y.val(r),e.M.val(r),e.D.val(r),e.h.val(r),e.m.val(r),n+7200)),r},prev:function(t,n){return n=n>86399?86399:n,e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n>=e.t.val(t)?-1:0),0,0,n)}},e.weekOfMonth=e.wm={name:"week of month",range:604800,val:function(t){return t.wm||(t.wm=(e.D.val(t)+(e.dw.val(e.M.start(t))-1)+(7-e.dw.val(t)))/7)},isValid:function(t,n){return e.wm.val(t)===(n||e.wm.extent(t)[1])},extent:function(t){return t.wmExtent||(t.wmExtent=[1,(e.D.extent(t)[1]+(e.dw.val(e.M.start(t))-1)+(7-e.dw.val(e.M.end(t))))/7])},start:function(t){return t.wmStart||(t.wmStart=e.date.next(e.Y.val(t),e.M.val(t),Math.max(e.D.val(t)-e.dw.val(t)+1,1)))},end:function(t){return t.wmEnd||(t.wmEnd=e.date.prev(e.Y.val(t),e.M.val(t),Math.min(e.D.val(t)+(7-e.dw.val(t)),e.D.extent(t)[1])))},next:function(t,n){n=n>e.wm.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.wm,e.M),s=e.wm.extent(r)[1];return n=n>s?1:n||s,e.date.next(e.Y.val(r),e.M.val(r),Math.max(1,7*(n-1)-(e.dw.val(r)-2)))},prev:function(t,n){var r=e.date.prevRollover(t,n,e.wm,e.M),s=e.wm.extent(r)[1];return n=n>s?s:n||s,e.wm.end(e.date.next(e.Y.val(r),e.M.val(r),Math.max(1,7*(n-1)-(e.dw.val(r)-2))))}},e.weekOfYear=e.wy={name:"week of year (ISO)",range:604800,val:function(t){if(t.wy)return t.wy;var n=e.dw.next(e.wy.start(t),5),r=e.dw.next(e.Y.prev(n,e.Y.val(n)-1),5);return t.wy=1+Math.ceil((n.getTime()-r.getTime())/e.WEEK)},isValid:function(t,n){return e.wy.val(t)===(n||e.wy.extent(t)[1])},extent:function(t){if(t.wyExtent)return t.wyExtent;var n=e.dw.next(e.wy.start(t),5),r=e.dw.val(e.Y.start(n)),s=e.dw.val(e.Y.end(n));return t.wyExtent=[1,5===r||5===s?53:52]},start:function(t){return t.wyStart||(t.wyStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)-(e.dw.val(t)>1?e.dw.val(t)-2:6)))},end:function(t){return t.wyEnd||(t.wyEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(e.dw.val(t)>1?8-e.dw.val(t):0)))},next:function(t,n){n=n>e.wy.extent(t)[1]?1:n;var r=e.dw.next(e.wy.start(t),5),s=e.date.nextRollover(r,n,e.wy,e.Y);1!==e.wy.val(s)&&(s=e.dw.next(s,2));var i=e.wy.extent(s)[1],a=e.wy.start(s);return n=n>i?1:n||i,e.date.next(e.Y.val(a),e.M.val(a),e.D.val(a)+7*(n-1))},prev:function(t,n){var r=e.dw.next(e.wy.start(t),5),s=e.date.prevRollover(r,n,e.wy,e.Y);1!==e.wy.val(s)&&(s=e.dw.next(s,2));var i=e.wy.extent(s)[1],a=e.wy.end(s);return n=n>i?i:n||i,e.wy.end(e.date.next(e.Y.val(a),e.M.val(a),e.D.val(a)+7*(n-1)))}},e.year=e.Y={name:"year",range:31556900,val:function(t){return t.Y||(t.Y=e.date.getYear.call(t))},isValid:function(t,n){return e.Y.val(t)===n},extent:function(){return[1970,2099]},start:function(t){return t.YStart||(t.YStart=e.date.next(e.Y.val(t)))},end:function(t){return t.YEnd||(t.YEnd=e.date.prev(e.Y.val(t)))},next:function(t,n){return n>e.Y.val(t)&&n<=e.Y.extent()[1]?e.date.next(n):e.NEVER},prev:function(t,n){return n<e.Y.val(t)&&n>=e.Y.extent()[0]?e.date.prev(n):e.NEVER}},e.fullDate=e.fd={name:"full date",range:1,val:function(e){return e.fd||(e.fd=e.getTime())},isValid:function(t,n){return e.fd.val(t)===n},extent:function(){return[0,3250368e7]},start:function(e){return e},end:function(e){return e},next:function(t,n){return e.fd.val(t)<n?new Date(n):e.NEVER},prev:function(t,n){return e.fd.val(t)>n?new Date(n):e.NEVER}},e.modifier={},e.modifier.after=e.modifier.a=function(e,t){var n=t[0];return{name:"after "+e.name,range:(e.extent(new Date)[1]-n)*e.range,val:e.val,isValid:function(e,t){return this.val(e)>=n},extent:e.extent,start:e.start,end:e.end,next:function(t,r){return r!=n&&(r=e.extent(t)[0]),e.next(t,r)},prev:function(t,r){return r=r===n?e.extent(t)[1]:n-1,e.prev(t,r)}}},e.modifier.before=e.modifier.b=function(e,t){var n=t[t.length-1];return{name:"before "+e.name,range:e.range*(n-1),val:e.val,isValid:function(e,t){return this.val(e)<n},extent:e.extent,start:e.start,end:e.end,next:function(t,r){return r=r===n?e.extent(t)[0]:n,e.next(t,r)},prev:function(t,r){return r=r===n?n-1:e.extent(t)[1],e.prev(t,r)}}},e.compile=function(t){var n,r=[],s=0;for(var i in t){var a=i.split("_"),o=a[0],l=a[1],c=t[i],d=l?e.modifier[l](e[o],c):e[o];r.push({constraint:d,vals:c}),s++}return r.sort((function(e,t){var n=e.constraint.range,r=t.constraint.range;return r<n?-1:r>n?1:0})),n=r[s-1].constraint,{start:function(t,i){for(var a,o=i,l=e.array[t],c=1e3;c--&&!a&&o;){a=!0;for(var d=0;d<s;d++){var u=r[d].constraint,h=u.val(o),g=u.extent(o),m=l(h,r[d].vals,g);if(!u.isValid(o,m)){o=u[t](o,m),a=!1;break}}}return o!==e.NEVER&&(o="next"===t?n.start(o):n.end(o)),o},end:function(t,n){for(var i,a=e.array[t+"Invalid"],o=function(e){return"next"===e?function(e,t){return e.getTime()>t.getTime()}:function(e,t){return t.getTime()>e.getTime()}}(t),l=s-1;l>=0;l--){var c,d=r[l].constraint,u=d.val(n),h=d.extent(n),g=a(u,r[l].vals,h);void 0!==g&&(!(c=d[t](n,g))||i&&!o(i,c)||(i=c))}return i},tick:function(t,r){return new Date("next"===t?n.end(r).getTime()+e.SEC:n.start(r).getTime()-e.SEC)},tickSafe:function(e,t){return"next"===e?rm(n.end(t),1):rm(n.start(t),-1)},tickStart:function(e){return n.start(e)}}},e.schedule=function(t){if(!t)throw new Error("Missing schedule definition.");if(!t.schedules)throw new Error("Definition must include at least one schedule.");for(var n=[],r=t.schedules.length,s=[],i=t.exceptions?t.exceptions.length:0,a=0;a<r;a++)n.push(e.compile(t.schedules[a]));for(var o=0;o<i;o++)s.push(e.compile(t.exceptions[o]));function l(t,r,a,o,l){var b,C,S,w=v(t),D=r,T=1e6,E=[],x=[],k=[],I="next"===t,R=I?0:1,M=I?1:0;if(!(a=a?new Date(a):new Date)||!a.getTime())throw new Error("Invalid start date.");for(!function(e,t,n,r){for(var s=0,i=t.length;s<i;s++)n[s]=t[s].start(e,r)}(t,n,E,a),function(t,n,r,s){for(var i=0,a=n.length;i<a;i++){var o=n[i].start(t,s);r[i]=o?[o,n[i].end(t,o)]:e.NEVER}}(t,s,x,a);T--&&D&&(b=y(E,w))&&(!o||!w(b,o));)if(i&&(u(t,s,x,b),C=m(t,x,b)))d(t,n,E,C);else{if(l){var O=p(x,w);C=f(t,n,E,b,O);var A=I?[new Date(Math.max(a,b)),C?new Date(o?Math.min(C,o):C):void 0]:[C?new Date(o?Math.max(o,C.getTime()+e.SEC):C.getTime()+e.SEC):void 0,new Date(Math.min(a,b.getTime()+e.SEC))];if(S&&A[R].getTime()===S[M].getTime()?(S[M]=A[M],D++):(S=A,k.push(S)),!C)break;d(t,n,E,C)}else k.push(I?new Date(Math.max(a,b)):g(n,E,b,o)),h(t,n,E,b);D--}for(var F=0,P=k.length;F<P;F++){var L=k[F];k[F]="[object Array]"===Object.prototype.toString.call(L)?[c(L[0]),c(L[1])]:c(L)}return 0===k.length?e.NEVER:1===r?k[0]:k}function c(e){if(e instanceof Date&&!isNaN(e.valueOf()))return new Date(e)}function d(e,t,n,r){for(var s=v(e),i=0,a=t.length;i<a;i++)n[i]&&!s(n[i],r)&&(n[i]=t[i].start(e,r))}function u(t,n,r,s){for(var i=v(t),a=0,o=n.length;a<o;a++)if(r[a]&&!i(r[a][0],s)){var l=n[a].start(t,s);r[a]=l?[l,n[a].end(t,l)]:e.NEVER}}function h(t,n,r,s){for(var i=0,a=n.length;i<a;i++)if(r[i]&&r[i].getTime()===s.getTime()){const a=n[i].start(t,n[i].tick(t,s));a!==e.NEVER&&a.getTime()===r[i].getTime()?r[i]=n[i].start(t,n[i].tickSafe(t,s)):r[i]=a}}function g(e,t,n,r){for(var s,i=0,a=t.length;i<a;i++)if(t[i]&&t[i].getTime()===n.getTime()){var o=e[i].tickStart(n);if(r&&o<r)return r;(!s||o>s)&&(s=o)}return s}function m(e,t,n){for(var r,s=v(e),i=0,a=t.length;i<a;i++){var o=t[i];!o||s(o[0],n)||o[1]&&!s(o[1],n)||r&&!s(o[1],r)||(r=o[1])}return r}function p(e,t){for(var n,r=0,s=e.length;r<s;r++)!e[r]||n&&!t(n,e[r][0])||(n=e[r][0]);return n}function f(e,t,n,r,s){for(var i,a=v(e),o=0,l=t.length;o<l;o++){var c=n[o];if(c&&c.getTime()===r.getTime()){var d=t[o].end(e,c);if(s&&(!d||a(d,s)))return s;i&&!a(d,i)||(i=d)}}return i}function v(e){return"next"===e?function(e,t){return!t||e.getTime()>t.getTime()}:function(e,t){return!e||t.getTime()>e.getTime()}}function y(e,t){for(var n=e[0],r=1,s=e.length;r<s;r++)e[r]&&t(n,e[r])&&(n=e[r]);return n}return{isValid:function(t){return l("next",1,t,t)!==e.NEVER},next:function(e,t,n){return l("next",e||1,t,n)},prev:function(e,t,n){return l("prev",e||1,t,n)},nextRange:function(e,t,n){return l("next",e||1,t,n,!0)},prevRange:function(e,t,n){return l("prev",e||1,t,n,!0)}}},e.setTimeout=function(t,n){var r,s=e.schedule(n);return t&&function e(){var n=Date.now(),i=s.next(2,n);if(!i[0])return void(r=void 0);var a=i[0].getTime()-n;a<1e3&&(a=i[1]?i[1].getTime()-n:1e3);r=a<2147483647?setTimeout(t,a):setTimeout(e,2147483647)}(),{isDone:function(){return!r},clear:function(){clearTimeout(r)}}},e.setInterval=function(t,n){if(t){var r=e.setTimeout((function i(){s||(t(),r=e.setTimeout(i,n))}),n),s=r.isDone();return{isDone:function(){return r.isDone()},clear:function(){s=!0,r.clear()}}}},e.date={},e.date.timezone=function(t){e.date.build=t?function(e,t,n,r,s,i){return new Date(e,t,n,r,s,i)}:function(e,t,n,r,s,i){return new Date(Date.UTC(e,t,n,r,s,i))};var n=t?"get":"getUTC",r=Date.prototype;e.date.getYear=r[n+"FullYear"],e.date.getMonth=r[n+"Month"],e.date.getDate=r[n+"Date"],e.date.getDay=r[n+"Day"],e.date.getHour=r[n+"Hours"],e.date.getMin=r[n+"Minutes"],e.date.getSec=r[n+"Seconds"],e.date.isUTC=!t},e.date.UTC=function(){e.date.timezone(!1)},e.date.localTime=function(){e.date.timezone(!0)},e.date.UTC(),e.SEC=1e3,e.MIN=60*e.SEC,e.HOUR=60*e.MIN,e.DAY=24*e.HOUR,e.WEEK=7*e.DAY,e.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],e.NEVER=0,e.date.next=function(t,n,r,s,i,a){return e.date.build(t,void 0!==n?n-1:0,void 0!==r?r:1,s||0,i||0,a||0)},e.date.nextRollover=function(t,n,r,s){var i=r.val(t),a=r.extent(t)[1];return(n||a)<=i||n>a?new Date(s.end(t).getTime()+e.SEC):s.start(t)},e.date.prev=function(t,n,r,s,i,a){var o=arguments.length;return n=o<2?11:n-1,r=o<3?e.D.extent(e.date.next(t,n+1))[1]:r,s=o<4?23:s,i=o<5?59:i,a=o<6?59:a,e.date.build(t,n,r,s,i,a)},e.date.prevRollover=function(e,t,n,r){return t>=n.val(e)||!t?r.start(r.prev(e,r.val(e)-1)):r.start(e)},e.parse={},e.parse.cron=function(e,t){var n={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12,SUN:1,MON:2,TUE:3,WED:4,THU:5,FRI:6,SAT:7},r={"* * * * * *":"0/1 * * * * *","@YEARLY":"0 0 1 1 *","@ANNUALLY":"0 0 1 1 *","@MONTHLY":"0 0 1 * *","@WEEKLY":"0 0 * * 0","@DAILY":"0 0 * * *","@HOURLY":"0 * * * *"},s={s:[0,0,59],m:[1,0,59],h:[2,0,23],D:[3,1,31],M:[4,1,12],Y:[6,1970,2099],d:[5,1,7,1]};function i(e,t,r){return isNaN(e)?n[e]||null:Math.min(+e+(t||0),r||9999)}function a(e,t,n,r,s){var i=n;for(e[t]||(e[t]=[]);i<=r;)e[t].indexOf(i)<0&&e[t].push(i),i+=s||1;e[t].sort((function(e,t){return e-t}))}function o(e,t,n,r){(t.d&&!t.dc||t.dc&&t.dc.indexOf(r)<0)&&(e.push(function(e){var t,n={};for(t in e)"dc"!==t&&"d"!==t&&(n[t]=e[t].slice(0));return n}(t)),t=e[e.length-1]),a(t,"d",n,n),a(t,"dc",r,r)}function l(e,t,r,s,l,c){var d,u,h=t.schedules,g=h[h.length-1];"L"===e&&(e=s-1),null!==(d=i(e,c,l))?a(g,r,d,d):null!==(d=i(e.replace("W",""),c,l))?function(e,t,r){var s={},i={};1===r?(a(t,"D",1,3),a(t,"d",n.MON,n.FRI),a(s,"D",2,2),a(s,"d",n.TUE,n.FRI),a(i,"D",3,3),a(i,"d",n.TUE,n.FRI)):(a(t,"D",r-1,r+1),a(t,"d",n.MON,n.FRI),a(s,"D",r-1,r-1),a(s,"d",n.MON,n.THU),a(i,"D",r+1,r+1),a(i,"d",n.TUE,n.FRI)),e.exceptions.push(s),e.exceptions.push(i)}(t,g,d):null!==(d=i(e.replace("L",""),c,l))?o(h,g,d,s-1):2===(u=e.split("#")).length?o(h,g,d=i(u[0],c,l),i(u[1])):function(e,t,n,r,s,o){var l=e.split("/"),c=+l[1],d=l[0];if("*"!==d&&"0"!==d){var u=d.split("-");r=i(u[0],o,s),s=i(u[1],o,s)||s}a(t,n,r,s,c)}(e,g,r,s,l,c)}function c(e){return e.indexOf("#")>-1||e.indexOf("L")>0}function d(e,t){return c(e)&&!c(t)?1:e-t}var u=function(e){var t=e.toUpperCase();return r[t]||t}(e);return function(e){var t,n,r,i,a={schedules:[{}],exceptions:[]},o=e.replace(/(\s)+/g," ").split(" ");for(t in s)if((r=o[(n=s[t])[0]])&&"*"!==r&&"?"!==r){var c,u=(i=r.split(",").sort(d)).length;for(c=0;c<u;c++)l(i[c],a,t,n[1],n[2],n[3])}return a}(t?u:"0 "+u)},e.parse.recur=function(){var t,n,r,s,i,a,o,l,c,d=[],u=[],h=d;function g(e,d,u){if(e=i?e+"_"+i:e,t||(h.push({}),t=h[0]),t[e]||(t[e]=[]),n=t[e],s){for(r=[],l=d;l<=u;l+=s)r.push(l);c={n:e,x:s,c:n.length,m:u}}var g=(r=a?[d]:o?[u]:r).length;for(l=0;l<g;l+=1){var m=r[l];n.indexOf(m)<0&&n.push(m)}r=s=i=a=o=0}return{schedules:d,exceptions:u,on:function(){return r=arguments[0]instanceof Array?arguments[0]:arguments,this},every:function(e){return s=e||1,this},after:function(e){return i="a",r=[e],this},before:function(e){return i="b",r=[e],this},first:function(){return a=1,this},last:function(){return o=1,this},time:function(){for(var e=0,t=r.length;e<t;e++){var n=r[e].split(":");n.length<3&&n.push(0),r[e]=3600*+n[0]+60*+n[1]+ +n[2]}return g("t"),this},second:function(){return g("s",0,59),this},minute:function(){return g("m",0,59),this},hour:function(){return g("h",0,23),this},dayOfMonth:function(){return g("D",1,o?0:31),this},dayOfWeek:function(){return g("d",1,7),this},onWeekend:function(){return r=[1,7],this.dayOfWeek()},onWeekday:function(){return r=[2,3,4,5,6],this.dayOfWeek()},dayOfWeekCount:function(){return g("dc",1,o?0:5),this},dayOfYear:function(){return g("dy",1,o?0:366),this},weekOfMonth:function(){return g("wm",1,o?0:5),this},weekOfYear:function(){return g("wy",1,o?0:53),this},month:function(){return g("M",1,12),this},year:function(){return g("Y",1970,2450),this},fullDate:function(){for(var e=0,t=r.length;e<t;e++)r[e]=r[e].getTime();return g("fd"),this},customModifier:function(t,n){if(!e.modifier[t])throw new Error("Custom modifier "+t+" not recognized!");return i=t,r=arguments[1]instanceof Array?arguments[1]:[arguments[1]],this},customPeriod:function(t){var n=e[t];if(!n)throw new Error("Custom time period "+t+" not recognized!");return g(t,n.extent(new Date)[0],n.extent(new Date)[1]),this},startingOn:function(e){return this.between(e,c.m)},between:function(e,n){return t[c.n]=t[c.n].splice(0,c.c),s=c.x,g(c.n,e,n),this},and:function(){return t=h[h.push({})-1],this},except:function(){return h=u,t=null,this}}},e.parse.text=function(t){var n,r=e.parse.recur,s=0,i="",a={eof:/^$/,fullDate:/^(\d\d\d\d-\d\d-\d\dt\d\d:\d\d:\d\d)\b/,rank:/^((\d\d\d\d)|([2-5]?1(st)?|[2-5]?2(nd)?|[2-5]?3(rd)?|(0|[1-5]?[4-9]|[1-5]0|1[1-3])(th)?))\b/,time:/^((([0]?[1-9]|1[0-2]):[0-5]\d(\s)?(am|pm))|(([0]?\d|1\d|2[0-3]):[0-5]\d))\b/,dayName:/^((sun|mon|tue(s)?|wed(nes)?|thu(r(s)?)?|fri|sat(ur)?)(day)?)\b/,monthName:/^(jan(uary)?|feb(ruary)?|ma((r(ch)?)?|y)|apr(il)?|ju(ly|ne)|aug(ust)?|oct(ober)?|(sept|nov|dec)(ember)?)\b/,yearIndex:/^(\d\d\d\d)\b/,every:/^every\b/,after:/^after\b/,before:/^before\b/,second:/^(s|sec(ond)?(s)?)\b/,minute:/^(m|min(ute)?(s)?)\b/,hour:/^(h|hour(s)?)\b/,day:/^(day(s)?( of the month)?)\b/,dayInstance:/^day instance\b/,dayOfWeek:/^day(s)? of the week\b/,dayOfYear:/^day(s)? of the year\b/,weekOfYear:/^week(s)?( of the year)?\b/,weekOfMonth:/^week(s)? of the month\b/,weekday:/^weekday\b/,weekend:/^weekend\b/,month:/^month(s)?\b/,year:/^year(s)?\b/,between:/^between (the)?\b/,start:/^(start(ing)? (at|on( the)?)?)\b/,at:/^(at|@)\b/,and:/^(,|and\b)/,except:/^(except\b)/,also:/(also)\b/,first:/^(first)\b/,last:/^last\b/,in:/^in\b/,of:/^of\b/,onthe:/^on the\b/,on:/^on\b/,through:/(-|^(to|through)\b)/},o={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12,sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7,"1st":1,fir:1,"2nd":2,sec:2,"3rd":3,thi:3,"4th":4,for:4};function l(e,t,n,r){return{startPos:e,endPos:t,text:n,type:r}}function c(e){var t,n,r,a,o,c,d=e instanceof Array?e:[e],u=/\s+/;for(d.push(u),o=s;!t||t.type===u;){c=-1,n=i.substring(o),t=l(o,o,i.split(u)[0]);var h,g=d.length;for(h=0;h<g;h++)(r=(a=d[h]).exec(n))&&0===r.index&&r[0].length>c&&(t=l(o,o+(c=r[0].length),n.substring(0,c),a));t.type===u&&(o=t.endPos)}return t}function d(e){var t=c(e);return s=t.endPos,t}function u(e){for(var t=+y(e),n=f(a.through)?+y(e):t,r=[],s=t;s<=n;s++)r.push(s);return r}function h(e){for(var t=u(e);f(a.and);)t.push.apply(t,u(e));return e===a.dayName&&t.sort(((e,t)=>e-t)),t}function g(e){var t,n,r,s;f(a.weekend)?e.on(o.sun,o.sat).dayOfWeek():f(a.weekday)?e.on(o.mon,o.tue,o.wed,o.thu,o.fri).dayOfWeek():(t=y(a.rank),e.every(t),n=p(e),f(a.start)?(t=y(a.rank),e.startingOn(t),v(n.type)):f(a.between)&&(r=y(a.rank),f(a.and)&&(s=y(a.rank),e.between(r,s))))}function m(e){f(a.first)?e.first():f(a.last)?e.last():e.on(h(a.rank)),p(e)}function p(e){var t=v([a.second,a.minute,a.hour,a.dayOfYear,a.dayOfWeek,a.dayInstance,a.day,a.month,a.year,a.weekOfMonth,a.weekOfYear]);switch(t.type){case a.second:e.second();break;case a.minute:e.minute();break;case a.hour:e.hour();break;case a.dayOfYear:e.dayOfYear();break;case a.dayOfWeek:e.dayOfWeek();break;case a.dayInstance:e.dayOfWeekCount();break;case a.day:e.dayOfMonth();break;case a.weekOfMonth:e.weekOfMonth();break;case a.weekOfYear:e.weekOfYear();break;case a.month:e.month();break;case a.year:e.year();break;default:n=s}return t}function f(e){var t=c(e).type===e;return t&&d(e),t}function v(e){var t=d(e);return t.type?t.text=function(e,t){var n=e;switch(t){case a.time:var r=e.split(/(:|am|pm)/),s="pm"===r[3]&&r[0]<12?parseInt(r[0],10)+12:r[0],i=r[2].trim();n=(1===s.length?"0":"")+s+":"+i;break;case a.rank:n=parseInt(/^\d+/.exec(e)[0],10);break;case a.monthName:case a.dayName:n=o[e.substring(0,3)];break;case a.fullDate:n=new Date(e.toUpperCase())}return n}(t.text,e):n=s,t}function y(e){return v(e).text}return function(e){s=0,i=e,n=-1;for(var t=r();s<i.length&&n<0;){switch(v([a.every,a.after,a.before,a.onthe,a.on,a.of,a.in,a.at,a.and,a.except,a.also]).type){case a.every:g(t);break;case a.after:void 0!==c(a.time).type?(t.after(y(a.time)),t.time()):void 0!==c(a.fullDate).type?(t.after(y(a.fullDate)),t.fullDate()):(t.after(y(a.rank)),p(t));break;case a.before:void 0!==c(a.time).type?(t.before(y(a.time)),t.time()):void 0!==c(a.fullDate).type?(t.before(y(a.fullDate)),t.fullDate()):(t.before(y(a.rank)),p(t));break;case a.onthe:m(t);break;case a.on:t.on(h(a.dayName)).dayOfWeek();break;case a.of:t.on(h(a.monthName)).month();break;case a.in:t.on(h(a.yearIndex)).year();break;case a.at:for(t.on(y(a.time)).time();f(a.and);)t.on(y(a.time)).time();break;case a.and:break;case a.also:t.and();break;case a.except:t.except();break;default:n=s}}return{schedules:t.schedules,exceptions:t.exceptions,error:n}}(t.toLowerCase())},e}();function im(e){const t=[],n=[];let r;return[function*(){for(r||(r=e[Symbol.iterator]());t.length&&(yield*t,t.length=0),r;){const{value:t,done:s}=r.next();if(s){r=null,e=null;break}n.push(t),yield t}}(),function*(){for(r||(r=e[Symbol.iterator]());n.length&&(yield*n,n.length=0),r;){const{value:n,done:s}=r.next();if(s){r=null,e=null;break}t.push(n),yield n}}()]}sm.date.localTime();class am{constructor(e){if(this.iterable=void 0,!e)throw new Error("Require an iterable instance for chaining");this.iterable=e}derive(e){return this.iterable=void 0,new am(e)}copy(){const[e,t]=im(this.iterable);return this.iterable=t,new am(e)}split(){const[e,t]=im(this.iterable);return[new am(e),this.derive(t)]}inBatchesBySize(e){return this.derive(function*(e,t){if(t<0)throw new Error("Batch size needs to a natural number");t|=0;const n=[];for(const r of e)n.length===t&&(yield n,n.length=0),n.push(r);n.length>0&&(yield n)}(this.iterable,e))}filter(e){return this.derive(function*(e,t){let n=0;for(const r of e)t(r,n++)&&(yield r)}(this.iterable,e))}drop(e){return this.derive(function*(e,t){let n=0;for(const r of e)++n>t&&(yield r)}(this.iterable,e))}map(e){return this.derive(function*(e,t){let n=0;for(const r of e)yield t(r,n++)}(this.iterable,e))}reduce(e,t){return function(e,t,n){let r=0,s=n;for(const n of e)s=t(s,n,r++);return s}(this,e,t)}concat(){return this.derive(function*(e){for(const t of e)yield*t}(this.iterable))}uniqueOnly(){return this.derive(function*(e){const t=new Set;for(const n of e)t.has(n)||(t.add(n),yield n)}(this.iterable))}uniqueOnlyBy(e){return this.derive(function*(e,t){const n=new Set;for(const r of e){const e=t(r);n.has(e)||(n.add(e),yield r)}}(this.iterable,e))}every(e){return function(e,t){let n=0;for(const r of e)if(!t(r,n++))return!1;return!0}(this,e)}some(e){return function(e,t){let n=0;for(const r of e)if(t(r,n++))return!0;return!1}(this,e)}takeWhile(e){return this.derive(function*(e,t){let n=0;for(const r of e){if(!t(r,n++))return;yield r}}(this.iterable,e))}*[Symbol.iterator](){let e=this.iterable;if(!e)throw new Error("Chained iterator already exhausted or used to derive the new one");this.iterable=void 0,yield*e,e=void 0}toArray(){return Array.from(this)}sort(e){return Array.from(this).sort(e)}toSet(){return new Set(this)}toMap(){return new Map(this)}flush(){for(const e of this);}memoize(){return new lm(this)}}const om=e=>new am(e);class lm extends am{constructor(){super(...arguments),this.elements=[],this.$iterator=void 0}set iterable(e){this.$iterable=e}get iterable(){return this}derive(e){return new am(e)}*[Symbol.iterator](){const e=this.elements;if(this.$iterable){this.$iterator||(this.$iterator=this.$iterable[Symbol.iterator]());let t=this.$iterator,n=e.length;for(n>0&&(yield*e);;){if(e.length>n){for(let t=n;t<e.length;t++)yield e[t];n=e.length}if(!t)break;const{value:r,done:s}=t.next();s?(t=this.$iterator=null,this.$iterable=null):(e.push(r),n++,yield r)}}else yield*e}}const cm=e=>new lm(e),dm=Symbol("MixinIdentity"),um=Symbol("MixinStateProperty");class hm{constructor(){this.baseEl=void 0,this.sourceEl=void 0,this.$elementsByTopoLevel=void 0,this.$topoLevels=void 0,this.linearizedByTopoLevelsSource=cm(this.linearizedByTopoLevels())}static new(e){const t=new this;return e&&Object.assign(t,e),t}get topoLevels(){return void 0!==this.$topoLevels?this.$topoLevels:this.$topoLevels=this.buildTopoLevels()}buildTopoLevels(){return Array.from(this.elementsByTopoLevel.keys()).sort(((e,t)=>e-t))}get elementsByTopoLevel(){return void 0!==this.$elementsByTopoLevel?this.$elementsByTopoLevel:this.$elementsByTopoLevel=this.buildElementsByTopoLevel()}getOrCreateLevel(e,t){let n=e.get(t);return n||(n=[],e.set(t,n)),n}buildElementsByTopoLevel(){let e=0;const t=this.baseEl?om(this.baseEl.walkDepthState.elementsByTopoLevel.values()).concat().toSet():new Set,n=om(this.sourceEl.requirements).map((e=>e.walkDepthState.elementsByTopoLevel)).concat().reduce(((t,[n,r])=>(n>e&&(e=n),this.getOrCreateLevel(t,n).push(r),t)),new Map);return this.getOrCreateLevel(n,e+1).push([this.sourceEl]),om(n).map((([e,n])=>[e,om(n).concat().uniqueOnly().filter((e=>!t.has(e))).sort(((e,t)=>e.id-t.id))])).toMap()}*linearizedByTopoLevels(){yield*om(this.topoLevels).map((e=>this.elementsByTopoLevel.get(e))).concat()}}let gm=1;const mm=e=>class extends e{};class pm{}class fm{constructor(){this.id=gm++,this.requirements=[],this.baseClass=pm,this.identitySymbol=void 0,this.mixinLambda=mm,this.walkDepthState=void 0,this.$minimalClass=void 0,this.name=""}static new(e){const t=new this;e&&Object.assign(t,e),t.walkDepthState=hm.new({sourceEl:t,baseEl:vm(t.baseClass)});const n=t.mixinLambda,r=t.identitySymbol=Symbol(n.name),s=Object.assign((function(e){const t=n(e);return t.prototype[r]=!0,t}),{[dm]:r,[um]:t});return Object.defineProperty(s,Symbol.hasInstance,{value:ym}),t.mixinLambda=s,t}get minimalClass(){return void 0!==this.$minimalClass?this.$minimalClass:this.$minimalClass=this.buildMinimalClass()}getBaseClassMixinId(e){const t=this.constructor,n=t.baseClassesIds.get(e);if(void 0!==n)return n;const r=gm++;return t.baseClassesIds.set(e,r),r}buildMinimalClass(){const e=this.constructor;let t=this.baseClass;const n=this.walkDepthState.linearizedByTopoLevelsSource.reduce(((t,n)=>{const{cls:r,hash:s}=t,i=s+String.fromCharCode(n.id);let a=e.minimalClassesByLinearHash.get(i);return a||(a=n.mixinLambda(r),n.name=a.name,e.minimalClassesByLinearHash.set(i,a)),t.cls=a,t.hash=i,t}),{cls:t,hash:String.fromCharCode(this.getBaseClassMixinId(t))}).cls,r=Object.assign(n,{[dm]:this.identitySymbol,[um]:this,mix:this.mixinLambda,derive:e=>Cm([r,e],(e=>class extends e{})),$:this,toString:this.toString.bind(this)});return Object.defineProperty(r,Symbol.hasInstance,{value:ym}),r}toString(){return this.walkDepthState.linearizedByTopoLevelsSource.reduce(((e,t)=>`${t.name}(${e})`),this.baseClass.name)}}fm.minimalClassesByLinearHash=new Map,fm.baseClassesIds=new Map;const vm=e=>Object.getPrototypeOf(e.prototype).constructor[um],ym=function(e){return Boolean(e&&e[this[dm]])},bm=(e,t)=>Boolean(e&&e[t[dm]]),Cm=(e,t)=>{let n;if(e.length>0){const t=e[e.length-1];r=t,Object.getPrototypeOf(r.prototype).constructor.hasOwnProperty(um)||t===pm||(n=t)}var r;const s=[];e.forEach(((t,r)=>{const i=t[um];if(void 0!==i){const e=i.baseClass;if(e!==pm)if(n){if(n!==e){const t=e.prototype.isPrototypeOf(n.prototype),r=n.prototype.isPrototypeOf(e.prototype);if(!t&&!r)throw new Error("Base class mismatch");n=r?e:n}}else n=e;s.push(i)}else if(r!==e.length-1)throw new Error("Base class should be provided as the last element of the requirements array")}));return fm.new({requirements:s,mixinLambda:t,baseClass:n||pm}).minimalClass};var Sm,wm,Dm,Tm,Em,xm,km,Im,Rm;e.TimeUnit=void 0,(Sm=e.TimeUnit||(e.TimeUnit={})).Millisecond="millisecond",Sm.Second="second",Sm.Minute="minute",Sm.Hour="hour",Sm.Day="day",Sm.Week="week",Sm.Month="month",Sm.Quarter="quarter",Sm.Year="year",e.ProjectConstraintResolution=void 0,(wm=e.ProjectConstraintResolution||(e.ProjectConstraintResolution={})).Honor="honor",wm.Ignore="ignore",wm.Conflict="conflict",e.ConstraintType=void 0,(Dm=e.ConstraintType||(e.ConstraintType={})).MustStartOn="muststarton",Dm.MustFinishOn="mustfinishon",Dm.StartNoEarlierThan="startnoearlierthan",Dm.StartNoLaterThan="startnolaterthan",Dm.FinishNoEarlierThan="finishnoearlierthan",Dm.FinishNoLaterThan="finishnolaterthan",Dm.AsSoonAsPossible="assoonaspossible",Dm.AsLateAsPossible="aslateaspossible",e.SchedulingMode=void 0,(Tm=e.SchedulingMode||(e.SchedulingMode={})).Normal="Normal",Tm.FixedDuration="FixedDuration",Tm.FixedEffort="FixedEffort",Tm.FixedUnits="FixedUnits",e.DependencyValidationResult=void 0,(Em=e.DependencyValidationResult||(e.DependencyValidationResult={}))[Em.NoError=0]="NoError",Em[Em.CyclicDependency=1]="CyclicDependency",Em[Em.DuplicatingDependency=2]="DuplicatingDependency",e.DependencyType=void 0,(xm=e.DependencyType||(e.DependencyType={}))[xm.StartToStart=0]="StartToStart",xm[xm.StartToEnd=1]="StartToEnd",xm[xm.EndToStart=2]="EndToStart",xm[xm.EndToEnd=3]="EndToEnd",e.DependenciesCalendar=void 0,(km=e.DependenciesCalendar||(e.DependenciesCalendar={})).Project="Project",km.FromEvent="FromEvent",km.ToEvent="ToEvent",e.ProjectType=void 0,(Im=e.ProjectType||(e.ProjectType={}))[Im.SchedulerBasic=1]="SchedulerBasic",Im[Im.SchedulerPro=2]="SchedulerPro",Im[Im.Gantt=3]="Gantt",e.Direction=void 0,(Rm=e.Direction||(e.Direction={})).Forward="Forward",Rm.Backward="Backward",Rm.None="None";var Mm;e.ConstraintIntervalSide=void 0,(Mm=e.ConstraintIntervalSide||(e.ConstraintIntervalSide={})).Start="Start",Mm.End="End";const Om=new Date(-864e13),Am=new Date(864e13);var Fm,Pm;e.EdgeInclusion=void 0,(Fm=e.EdgeInclusion||(e.EdgeInclusion={}))[Fm.Left=0]="Left",Fm[Fm.Right=1]="Right",e.CalendarIteratorResult=void 0,(Pm=e.CalendarIteratorResult||(e.CalendarIteratorResult={}))[Pm.FullRangeIterated=0]="FullRangeIterated",Pm[Pm.StoppedByIterator=1]="StoppedByIterator",Pm[Pm.MaxCacheExtendCyclesReached=2]="MaxCacheExtendCyclesReached",Pm[Pm.MaxRangeReached=3]="MaxRangeReached";class Lm{constructor(t){this.cacheFilledStartDate=Am,this.cacheFilledEndDate=Om,this.intervalsCachingChunkDuration=30,this.intervalsCachingChunkUnit=e.TimeUnit.Day,this.maxCacheExtendCycles=1e3,this.maxRange=15768e7,t&&Object.assign(this,t)}includeWrappingRangeFrom(e,t,n){e.ensureCacheFilledForInterval(t,n),this.intervalCache.includeWrappingRange(e.intervalCache,t,n)}ensureCacheFilledForInterval(e,t){const n=this.cacheFilledStartDate.getTime(),r=this.cacheFilledEndDate.getTime();if(n!==Am.getTime()){const s=e.getTime(),i=t.getTime();if(n<=s&&i<=r)return;if(i<=n)t=new Date(n-1);else if(s>=r)e=new Date(r);else if(n<=s&&s<=r)e=new Date(r+1);else{if(!(n<=i&&i<=r))return this.ensureCacheFilledForInterval(e,new Date(n-1)),void this.ensureCacheFilledForInterval(new Date(r+1),t);t=new Date(n-1)}}(n===Am.getTime()||e.getTime()<r)&&(this.cacheFilledStartDate=e),(r===Om.getTime()||r<t.getTime())&&(this.cacheFilledEndDate=t),this.fillCache(e,t)}fillCache(e,t){throw new Error("Abstract method")}clear(){this.cacheFilledStartDate=Am,this.cacheFilledEndDate=Om,this.intervalCache.clear()}forEachAvailabilityInterval(t,n,r){r=r||this;const s=t.startDate,i=t.endDate,a=s&&s.getTime(),o=i&&i.getTime(),l=t.maxRange??this.maxRange,c=!1!==t.isForward;if(c?!s:!i)throw new Error("At least `startDate` or `endDate` is required, depending from the `isForward` option");const d=this.intervalCache;let u=c?s:i,h=c?s:i;const g=h.getTime();for(let t=1;t<this.maxCacheExtendCycles;t++){c?this.ensureCacheFilledForInterval(u,i||Bt.add(u,this.intervalsCachingChunkDuration,this.intervalsCachingChunkUnit)):this.ensureCacheFilledForInterval(s||Bt.add(u,-this.intervalsCachingChunkDuration,this.intervalsCachingChunkUnit),u);let t=d.getIntervalOf(h,c?e.EdgeInclusion.Left:e.EdgeInclusion.Right);for(;t;){const u=t.startDate,m=t.endDate;if(c&&o&&u.getTime()>=o||!c&&a&&m.getTime()<=a)return e.CalendarIteratorResult.FullRangeIterated;if(c&&u.getTime()-g>=l||!c&&g-m.getTime()>=l)return e.CalendarIteratorResult.MaxRangeReached;if(c&&u.getTime()>=this.cacheFilledEndDate.getTime()||!c&&m.getTime()<=this.cacheFilledStartDate.getTime())break;h=c?m:u;const p=a&&u.getTime()<a?s:u,f=o&&m.getTime()>o?i:m;if(!1===n.call(r,p,f,t.cacheInterval))return e.CalendarIteratorResult.StoppedByIterator;t=c?d.getNextInterval(t):d.getPrevInterval(t)}if(c&&h.getTime()===Am.getTime()||!c&&h.getTime()===Om.getTime())return e.CalendarIteratorResult.FullRangeIterated;u=c?this.cacheFilledEndDate:this.cacheFilledStartDate}return e.CalendarIteratorResult.MaxCacheExtendCyclesReached}}const $m=e=>Array.from(new Set(e));class _m{constructor(e){if(this.intervals=[],e&&Object.assign(this,e),!this.calendar)throw new Error("Required attribute `calendar` is missing")}includeInterval(e){if(-1==this.intervals.indexOf(e)){const t=this.intervals.slice();return t.push(e),new _m({intervals:t,calendar:this.calendar})}return this}combineWith(e){return new _m({intervals:this.intervals.concat(e.intervals),calendar:this.calendar})}getIsWorking(){if(null!=this.isWorking)return this.isWorking;const e=this.intervals=this.normalizeIntervals(this.intervals);return this.isWorking=e[0].isWorking}normalizeIntervals(e){const t=$m(e);return t.sort(((e,t)=>t.getPriorityField()-e.getPriorityField())),t}}class Nm{constructor(e){this.intervalGroups=[],e&&Object.assign(this,e)}combineWith(e){const t=this.intervalGroups.slice();return t.push([e.calendar,e]),new Nm({intervalGroups:t})}getIsWorkingForEvery(){if(null!=this.isWorkingForEvery)return this.isWorkingForEvery;for(let[e,t]of this.getGroups())if(!t[0].isWorking)return this.isWorkingForEvery=!1;return this.isWorkingForEvery=!0}getIsWorkingForSome(){if(null!=this.isWorkingForSome)return this.isWorkingForSome;for(let[e,t]of this.getGroups())if(t[0].isWorking)return this.isWorkingForSome=!0;return this.isWorkingForSome=!1}getCalendars(){return this.getGroups(),this.calendars}isCalendarWorking(e){return this.getCalendarsWorkStatus().get(e)}getCalendarsWorkStatus(){if(this.calendarsWorkStatus)return this.calendarsWorkStatus;const e=new Map;for(let[t,n]of this.getGroups())e.set(t,n[0].isWorking);return this.calendarsWorkStatus=e}getCalendarsWorking(){if(this.calendarsWorking)return this.calendarsWorking;const e=[];for(let[t,n]of this.getGroups())n[0].isWorking&&e.push(t);return this.calendarsWorking=e}getCalendarsNonWorking(){if(this.calendarsNonWorking)return this.calendarsNonWorking;const e=[];for(let[t,n]of this.getGroups())n[0].isWorking||e.push(t);return this.calendarsNonWorking=e}getGroups(){if(this.intervalsByCalendar)return this.intervalsByCalendar;const e=this.calendars=[],t=new Map;return this.intervalGroups.forEach((([n,r])=>{let s=t.get(n);s||(e.push(n),s=[],t.set(n,s)),s.push.apply(s,r.intervals)})),t.forEach(((e,n)=>{const r=$m(e);r.sort(((e,t)=>t.getPriorityField()-e.getPriorityField())),t.set(n,r)})),this.intervalsByCalendar=t}}const jm=(e,t,n=((e,t)=>e-t))=>{let r=0,s=t.length;for(;r<s;){const i=(r+s)/2|0,a=n(e,t[i]);if(0===a)return{found:!0,index:i};a<0?s=i:r=i+1}return{found:!1,index:s}};var Vm;e.IndexPosition=void 0,(Vm=e.IndexPosition||(e.IndexPosition={}))[Vm.Exact=0]="Exact",Vm[Vm.Next=1]="Next";class Bm{constructor(e){this.keys=[],this.values=[],this.comparator=e||((e,t)=>e-t)}set(e,t){const n=jm(e,this.keys,this.comparator);return n.found?this.values[n.index]=t:(this.keys.splice(n.index,0,e),this.values.splice(n.index,0,t)),n.index}insertAt(e,t,n){this.keys.splice(e,0,t),this.values.splice(e,0,n)}setValueAt(e,t){this.values[e]=t}get(e){const t=jm(e,this.keys,this.comparator);return t.found?this.values[t.index]:void 0}getEntryAt(e){return e<this.keys.length?{key:this.keys[e],value:this.values[e]}:void 0}getKeyAt(e){return this.keys[e]}getValueAt(e){return this.values[e]}delete(e){const t=jm(e,this.keys,this.comparator);t.found&&this.deleteAt(t.index)}size(){return this.keys.length}deleteAt(e){this.keys.splice(e,1),this.values.splice(e,1)}indexOfKey(t){const n=jm(t,this.keys,this.comparator);return{found:n.found?e.IndexPosition.Exact:e.IndexPosition.Next,index:n.index}}map(e){const t=this.keys,n=this.values,r=[];for(let s=0;s<t.length;s++)r.push(e(n[s],t[s],s));return r}getAllEntries(){return this.map(((e,t)=>({value:e,key:t})))}clear(){this.keys.length=0,this.values.length=0}}class zm{constructor(e){if(this.points=new Bm(((e,t)=>e.getTime()-t.getTime())),this.leftInfinityKey=Om,this.rightInfinityKey=Am,Object.assign(this,e),void 0===this.emptyInterval||!this.combineIntervalsFn)throw new Error("All of `emptyPoint`, `combineIntervalsFn` are required");this.points.set(this.leftInfinityKey,this.emptyInterval)}size(){return this.points.size()}indexOf(e){return this.points.indexOfKey(e)}getDateAt(e){return this.points.getKeyAt(e)}getPointAt(e){return this.points.getValueAt(e)}getIntervalOf(t,n=e.EdgeInclusion.Left){let r,{found:s,index:i}=this.indexOf(t);return r=n===e.EdgeInclusion.Left&&s===e.IndexPosition.Exact?i:i-1,this.getIntervalWithStartDateIndex(r)}getPrevInterval(e){return 0===e.startDateIndex?null:this.getIntervalWithStartDateIndex(e.startDateIndex-1)}getNextInterval(e){return e.startDateIndex>=this.size()-1?null:this.getIntervalWithStartDateIndex(e.startDateIndex+1)}getIntervalWithStartDateIndex(e){return{startDateIndex:e,startDate:this.getDateAt(e),endDate:e+1<this.size()?this.getDateAt(e+1):this.rightInfinityKey,cacheInterval:this.getPointAt(e)}}addInterval(t,n,r){const s=this.points,{found:i,index:a}=s.indexOfKey(t);let o,l;if(i==e.IndexPosition.Exact){const e=r(l=s.getValueAt(a));s.setValueAt(a,e),o=a+1}else{const e=r(l=s.getValueAt(a-1));s.insertAt(a,t,e),o=a+1}for(;o<s.size();){if(s.getKeyAt(o).getTime()>=n.getTime())break;const e=r(l=s.getValueAt(o));s.setValueAt(o,e),o++}if(o===s.size())s.insertAt(s.size(),n,this.emptyInterval);else{s.getKeyAt(o).getTime()===n.getTime()||s.insertAt(o,n,l)}}includeWrappingRange(e,t,n){let r=e.getIntervalOf(t);for(;r&&(this.addInterval(r.startDate,r.endDate,(e=>this.combineIntervalsFn(e,r.cacheInterval))),!(r.endDate.getTime()>n.getTime()));)r=e.getNextInterval(r)}getSummary(){return this.points.map(((e,t)=>({label:e,date:t})))}clear(){this.points.clear(),this.points.set(this.leftInfinityKey,this.emptyInterval)}}class Wm extends Lm{constructor(e){super(e),this.calendarCaches=$m(this.calendarCaches),this.intervalCache=new zm({emptyInterval:new Nm,combineIntervalsFn:(e,t)=>e.combineWith(t)})}fillCache(e,t){this.calendarCaches.forEach((n=>{n.fillCache(e,t),this.includeWrappingRangeFrom(n,e,t)}))}}const Hm=new Map;class Um extends Lm{constructor(e){if(super(e),this.staticIntervalsCached=!1,!this.unspecifiedTimeInterval)throw new Error("Required attribute `unspecifiedTimeInterval` is missing");this.intervalCache=new zm({emptyInterval:new _m({intervals:[this.unspecifiedTimeInterval],calendar:this.calendar}),combineIntervalsFn:(e,t)=>e.combineWith(t)})}fillCache(e,t){var n;this.staticIntervalsCached||(this.cacheStaticIntervals(),this.staticIntervalsCached=!0),this.parentCache&&this.includeWrappingRangeFrom(this.parentCache,e,t);const r=e.getTime(),s=t.getTime(),i=this.calendar.ignoreTimeZone?null:null===(n=this.calendar.project)||void 0===n?void 0:n.timeZone;if(r>s)throw new Error("Invalid cache fill interval");const a=sm.NEVER;this.forEachRecurrentInterval((n=>{const o=n.getStartDateSchedule(),l=n.getEndDateSchedule();let c,d=o.prev(1,e);if("EOD"===l){const e=o.next(1,t);c=e!==a?Bt.getStartOfNextDay(e,!0):a}else c=l.next(1,t);if(d!==a&&d.getTime()===r){const t=o.prev(2,e);t!==a&&2===t.length&&(d=t[1])}if(c!==a&&c.getTime()===s){const e=l.next(2,t);e!==a&&2===e.length&&(c=e[1])}const u=o.next(1/0,d!==a?d:e,c!==a?new Date(c.getTime()-1):t);if(u===a)return;const h="EOD"===l?u.map((e=>Bt.getStartOfNextDay(e,!0))):l.next(1/0,new Date(u[0].getTime()+1),c!==a?c:t);h!==a&&(h.length>u.length?h.length=u.length:h.length<u.length&&(u.length=h.length),u.forEach(((e,t)=>{let r=e,s=h[t];null!=i&&(r=Dd.toTimeZone(r,i),s=Dd.toTimeZone(s,i)),this.intervalCache.addInterval(r,s,(e=>e.includeInterval(n)))})))}))}clear(){this.staticIntervalsCached=!1,super.clear()}cacheStaticIntervals(){this.forEachStaticInterval((e=>{var t;const n=null===(t=this.calendar.project)||void 0===t?void 0:t.timeZone;let{startDate:r,endDate:s}=e;null!=n&&(r=Dd.toTimeZone(r,n),s=Dd.toTimeZone(s,n)),this.intervalCache.addInterval(r,s,(t=>t.includeInterval(e)))}))}forEachStaticInterval(e){this.intervalStore.forEach((t=>{t.isStatic()&&e(t)}))}forEachRecurrentInterval(e){this.intervalStore.forEach((t=>{t.isRecurrent()&&e(t)}))}}class Ym extends(Cm([],(e=>{e.prototype;return class extends e{async commitAsync(){return this.project.commitAsync()}set project(e){this.$project=e}get project(){return this.$project}calculateProject(){throw new Error("Implement me")}setProject(e){return this.project=e}getProject(){return this.project?this.project:this.setProject(this.calculateProject())}getAssignmentStore(){const e=this.getProject();return null==e?void 0:e.assignmentStore}getDependencyStore(){const e=this.getProject();return null==e?void 0:e.dependencyStore}getEventStore(){const e=this.getProject();return null==e?void 0:e.eventStore}getResourceStore(){const e=this.getProject();return null==e?void 0:e.resourceStore}getCalendarManagerStore(){const e=this.getProject();return null==e?void 0:e.calendarManagerStore}}}))){}class qm extends(Cm([Ym,Li],(e=>{const t=e.prototype;return class extends e{constructor(){super(...arguments),this.isLoadingData=!1,this.disableHasLoadedDataToCommitFlag=!1}static get $name(){return"AbstractPartOfProjectStoreMixin"}construct(e={}){return e.asyncEvents={add:!0,remove:!0,removeAll:!0,change:!0,refresh:!0,replace:!0,move:!0,update:!0},t.construct.call(this,e)}trigger(e,n){const r=this,{asyncEvents:s,project:i}=r,a=null==s?void 0:s[e];return a&&(!0===a||a[n.action])?(t.trigger.call(r,`${e}PreCommit`,{...n}),!i||i.isEngineReady()&&!i.isWritingData?t.trigger.call(r,e,n):!r.eventsSuspended&&i&&(i.dataReadyDetacher||(i.queuedDataReadyEvents=[],i.dataReadyDetacher=i.ion({dataReady(){this.queuedDataReadyEvents.forEach((([e,t,n,r])=>{e.trigger.call(t,n,r)})),i.queuedDataReadyEvents=null,i.dataReadyDetacher(),i.dataReadyDetacher=null},once:!0})),i.queuedDataReadyEvents.push([t,r,e,n])),!0):t.trigger.call(r,e,n)}calculateProject(){return this.project}setStoreData(e){var n;!this.project||this.syncDataOnLoad||this.disableHasLoadedDataToCommitFlag||(this.project.hasLoadedDataToCommit=!0),this.isLoadingData=!0,t.setStoreData.call(this,e),this.isLoadingData=!1,null===(n=this.project)||void 0===n||n.trigger("storeRefresh",{store:this})}async doAutoCommit(){this.suspendCount<=0&&this.project&&!this.project.isEngineReady()&&await this.project.commitAsync(),t.doAutoCommit.call(this)}async addAsync(e,t){const n=this.add(e,t);return await this.project.commitAsync(),n}async insertAsync(e,t,n){const r=this.insert(e,t,n);return await this.project.commitAsync(),r}async loadDataAsync(e){this.data=e,await this.project.commitAsync()}performFilter(){var e;return this.project&&(this.isLoadingData||null!==(e=this.rootNode)&&void 0!==e&&e.isLoading)&&this.project.commitAsync().then((()=>this.filter())),super.performFilter(...arguments)}}}))){}class Km extends(Cm([Ym,Ns],(e=>{const t=e.prototype;return class extends e{joinStore(e){let n=null;if(bm(e,qm)){const t=e.getProject();t&&!this.getProject()&&(this.setProject(t),n=t)}t.joinStore.call(this,e),n&&!n.isRepopulatingStores&&this.joinProject()}unjoinStore(e,n=!1){t.unjoinStore.call(this,e,n);const{project:r}=this,s=bm(e,qm)&&!e.isFillingFromMaster&&r===(e.isChained&&e.project?e.masterStore.project:e.project);r&&!r.isDestroying&&!r.isRepopulatingStores&&s&&(this.leaveProject(n),this.setProject(null)),s&&(this.graph=null)}joinProject(){}leaveProject(e=!1){}calculateProject(){const e=this.stores.find((e=>bm(e,qm)&&!!e.getProject()));return null==e?void 0:e.getProject()}async setAsync(e,t,n){var r;const s=this.set(e,t,n);return await(null===(r=this.project)||void 0===r?void 0:r.commitAsync()),s}async getAsync(e){var t;return await(null===(t=this.project)||void 0===t?void 0:t.commitAsync()),this.get(e)}get isStmRestoring(){const e=this.getProject();return(null==e?void 0:e.isRestoringData)||(null==e?void 0:e.stm.isRestoring)||!1}}}))){}class Gm extends(Cm([Km],(e=>{e.prototype;return class extends e{static get fields(){return["name",{name:"startDate",type:"date"},{name:"endDate",type:"date"},"recurrentStartDate","recurrentEndDate","cls","iconCls",{name:"isWorking",type:"boolean",defaultValue:!1},{name:"priority",type:"number"}]}getCalendar(){return this.stores[0].calendar}resetPriority(){this.priorityField=null,this.getCalendar().getDepth()}getPriorityField(){if(null!=this.priorityField)return this.priorityField;let e=1e4+100*this.getCalendar().getDepth(),t=this.priority;return null==t&&(t=this.isRecurrent()?20:30),this.priorityField=e+t}isRecurrent(){return Boolean(this.recurrentStartDate&&this.recurrentEndDate&&this.getStartDateSchedule()&&this.getEndDateSchedule())}isStatic(){return Boolean(this.startDate&&this.endDate)}parseDateSchedule(e){let t=e;if(e&&e!==Object(e)&&(t=sm.parse.text(e),t!==Object(t)||t.error>=0))try{t=JSON.parse(e)}catch(e){return null}return t}getStartDateSchedule(){if(this.startDateSchedule)return this.startDateSchedule;const e=this.parseDateSchedule(this.recurrentStartDate);return this.startDateSchedule=sm.schedule(e)}getEndDateSchedule(){if(this.endDateSchedule)return this.endDateSchedule;if("EOD"===this.recurrentEndDate)return"EOD";const e=this.parseDateSchedule(this.recurrentEndDate);return this.endDateSchedule=sm.schedule(e)}}}))){}class Xm extends(Cm([qm],(e=>{e.prototype;return class extends e{constructor(){super(...arguments),this.disableHasLoadedDataToCommitFlag=!0}static get defaultConfig(){return{modelClass:Gm}}}}))){}class Zm extends(Cm([Gm],(e=>{e.prototype;return class extends e{getCalendar(){return this.calendar}getPriorityField(){return null!=this.priorityField?this.priorityField:this.priorityField=this.getCalendar().getDepth()}}}))){}class Jm extends(Cm([Ym],(e=>{e.prototype;return class extends e{get eventStore(){var e;return null===(e=this.project)||void 0===e?void 0:e.eventStore}get resourceStore(){var e;return null===(e=this.project)||void 0===e?void 0:e.resourceStore}get assignmentStore(){var e;return null===(e=this.project)||void 0===e?void 0:e.assignmentStore}get dependencyStore(){var e;return null===(e=this.project)||void 0===e?void 0:e.dependencyStore}get calendarManagerStore(){var e;return null===(e=this.project)||void 0===e?void 0:e.calendarManagerStore}getEventById(e){var t;return null===(t=this.eventStore)||void 0===t?void 0:t.getById(e)}getDependencyById(e){var t;return null===(t=this.dependencyStore)||void 0===t?void 0:t.getById(e)}getResourceById(e){var t;return null===(t=this.resourceStore)||void 0===t?void 0:t.getById(e)}getAssignmentById(e){var t;return null===(t=this.assignmentStore)||void 0===t?void 0:t.getById(e)}getCalendarById(e){var t;return null===(t=this.calendarManagerStore)||void 0===t?void 0:t.getById(e)}}}))){}class Qm extends(Cm([Km],(t=>{const n=t.prototype;return class extends t{constructor(){super(...arguments),this.version=1}static get fields(){return[{name:"version",type:"number"},"name",{name:"unspecifiedTimeIsWorking",type:"boolean",defaultValue:!0},{name:"intervals",type:"store",subStore:!0},"cls","iconCls"]}get intervalStoreClass(){return Xm}get intervalStore(){return this.meta.intervalsStore}initIntervalsStore(e){e.storeClass=this.intervalStoreClass,e.modelClass=this.getDefaultConfiguration().calendarIntervalModelClass||this.intervalStoreClass.defaultConfig.modelClass,e.calendar=this}processIntervalsStoreData(e){this.bumpVersion()}isDefault(){const e=this.getProject();return!!e&&this===e.defaultCalendar}getDepth(){return this.childLevel+1}forEachAvailabilityInterval(e,t,n){var r;const s=e.maxRange??(null===(r=this.getProject())||void 0===r?void 0:r.maxCalendarRange);return s&&(e={...e,maxRange:s}),this.calendarCache.forEachAvailabilityInterval(e,t,n)}accumulateWorkingTime(e,t,n){var r;if(0===t)return{finalDate:new Date(e),remainingDurationInMs:0};if(isNaN(t))throw new Error("Invalid duration");let s=e;const i=(null===(r=this.getProject())||void 0===r?void 0:r.adjustDurationToDST)??this.adjustDurationToDST??!1;return this.forEachAvailabilityInterval(n?{startDate:e,isForward:!0}:{endDate:e,isForward:!1},((e,r,a)=>{let o=!0;if(a.getIsWorking()){let a=r.getTime()-e.getTime();if(t<=a){if(i){const s=n?e.getTimezoneOffset()-new Date(e.getTime()+t).getTimezoneOffset():new Date(r.getTime()-t).getTimezoneOffset()-r.getTimezoneOffset();t-=60*s*1e3}s=n?new Date(e.getTime()+t):new Date(r.getTime()-t),t=0,o=!1}else{if(i){a+=60*(e.getTimezoneOffset()-r.getTimezoneOffset())*1e3}s=n?r:e,t-=a}}return o})),{finalDate:new Date(s),remainingDurationInMs:t}}calculateDurationMs(e,t,n=!1){var r;let s=0;const i=e.getTime()<=t.getTime()||!n?1:-1;i<0&&([e,t]=[t,e]);const a=(null===(r=this.getProject())||void 0===r?void 0:r.adjustDurationToDST)??this.adjustDurationToDST??!1;return this.forEachAvailabilityInterval({startDate:e,endDate:t},((e,t,n)=>{if(n.getIsWorking()&&(s+=t.getTime()-e.getTime(),a)){const n=e.getTimezoneOffset()-t.getTimezoneOffset();s+=60*n*1e3}})),s*i}calculateEndDate(e,t){const n=t>=0,r=this.accumulateWorkingTime(e,Math.abs(t),n);return 0===r.remainingDurationInMs?r.finalDate:null}calculateStartDate(e,t){const n=t<=0,r=this.accumulateWorkingTime(e,Math.abs(t),n);return 0===r.remainingDurationInMs?r.finalDate:null}skipNonWorkingTime(t,n=!0){let r;const s=this.forEachAvailabilityInterval(n?{startDate:t,isForward:!0}:{endDate:t,isForward:!1},((e,t,s)=>{if(s.getIsWorking())return r=n?e:t,!1}));return s===e.CalendarIteratorResult.MaxRangeReached||s===e.CalendarIteratorResult.FullRangeIterated?"empty_calendar":r?new Date(r):new Date(t)}addInterval(e){return this.addIntervals([e])}addIntervals(e){return this.bumpVersion(),this.intervalStore.add(e)}removeInterval(e){return this.removeIntervals([e])}removeIntervals(e){return this.bumpVersion(),this.intervalStore.remove(e)}clearIntervals(e){return e||this.bumpVersion(),this.intervalStore.removeAll(e)}bumpVersion(){this.clearCache(),this.version++}get calendarCache(){if(void 0!==this.$calendarCache)return this.$calendarCache;const e=new Zm({isWorking:this.unspecifiedTimeIsWorking});return e.calendar=this,this.$calendarCache=new Um({calendar:this,unspecifiedTimeInterval:e,intervalStore:this.intervalStore,parentCache:this.parent&&!this.parent.isRoot?this.parent.calendarCache:null})}clearCache(){this.$calendarCache&&this.$calendarCache.clear(),this.$calendarCache=void 0}resetPriorityOfAllIntervals(){this.traverse((e=>{e.intervalStore.forEach((e=>e.resetPriority()))}))}insertChild(e,t,r){let s=n.insertChild.call(this,...arguments);return Array.isArray(s)||(s=[s]),s.forEach((e=>{e.bumpVersion(),e.resetPriorityOfAllIntervals()})),s}joinProject(){n.joinProject.call(this),this.intervalStore.setProject(this.getProject())}leaveProject(){n.leaveProject.call(this),this.intervalStore.setProject(null),this.clearCache()}doDestroy(){this.leaveProject(),this.intervalStore.destroy(),super.doDestroy()}isDayHoliday(t){const n=Bt.clearTime(t),r=Bt.getNext(t,e.TimeUnit.Day);let s=!1;return this.forEachAvailabilityInterval({startDate:n,endDate:r,isForward:!0},((e,t,n)=>(s=n.getIsWorking(),!s))),!s}getDailyHolidaysRanges(t,n){const r=[];for(t=Bt.clearTime(t);t<n;)this.isDayHoliday(t)&&r.push({startDate:t,endDate:Bt.getStartOfNextDay(t,!0,!0)}),t=Bt.getNext(t,e.TimeUnit.Day);return r}getWorkingTimeRanges(e,t,n){const r=[];return this.forEachAvailabilityInterval({startDate:e,endDate:t,isForward:!0,maxRange:n},((e,t,n)=>{if(n.getIsWorking()){const s=n.intervals[0];r.push({name:s.name,startDate:e,endDate:t})}})),r}getNonWorkingTimeRanges(e,t,n){const r=[];return this.forEachAvailabilityInterval({startDate:e,endDate:t,isForward:!0,maxRange:n},((e,t,n)=>{if(!n.getIsWorking()){const s=n.intervals[0];r.push({name:s.name,iconCls:s.iconCls,cls:s.cls,startDate:e,endDate:t})}})),r}isWorkingTime(t,n,r){if(r){let r;const s=this.forEachAvailabilityInterval({startDate:t,endDate:n,isForward:!0},((e,s,i)=>{if(i.getIsWorking()&&e<=t&&s>=n)return r=!0,!1}));return s!==e.CalendarIteratorResult.MaxRangeReached&&s!==e.CalendarIteratorResult.FullRangeIterated&&r}{const e=this.skipNonWorkingTime(t);return!(!e||"empty_calendar"===e)&&(n?e<n:e.getTime()===t.getTime())}}}}))){}class ep extends(Cm([Km],(e=>{const t=e.prototype;return class extends e{getAssignmentFor(e){for(const t of this.assigned??[])if(t.resource===e)return t;return null}isAssignedTo(e){return Boolean(this.getAssignmentFor(e))}async assign(e){const t=this.project.assignmentStore.modelClass;return this.addAssignment(new t({event:this,resource:e})),this.commitAsync()}async unassign(e){const t=this.getAssignmentFor(e);return this.removeAssignment(t),this.commitAsync()}leaveProject(){if(this.isInActiveTransaction&&this.assigned){const e=this.getEventStore();this.assigned.forEach((t=>e.assignmentsForRemoval.add(t)))}t.leaveProject.call(this,...arguments)}remove(){if(!this.parent)return t.remove.call(this);{const e=this.getEventStore();t.remove.call(this),e&&e.afterEventRemoval()}}addAssignment(e){return this.getProject().assignmentStore.add(e),e}removeAssignment(e){return this.getProject().assignmentStore.remove(e),e}}}))){}class tp extends(Cm([Km,Jm,Ns],(e=>{const t=e.prototype;return class extends e{constructor(){super(...arguments),this.$isCalculating=!1,this.$changed={},this.$beforeChange={}}get isInActiveTransaction(){return!0}joinProject(){this.invalidate()}leaveProject(e=!1){var n;t.leaveProject.call(this,e),null===(n=this.project)||void 0===n||n.bufferedCommitAsync()}invalidate(){var e;null===(e=this.project)||void 0===e||e.invalidate(this)}getCurrentOrProposed(e){return e in this.$changed&&!0!==this.$changed[e]?this.$changed[e]:this.get(e)??null}hasCurrentOrProposed(e){return e in this.$changed&&1!=this.$changed[e]||null!=this.get(e)}propose(e){var t;if(this.project||null!==(t=this.recurringTimeSpan)&&void 0!==t&&t.project){const t=Object.keys(e);for(let n=0;n<t.length;n++){const r=t[n];this.$changed[r]=e[r]}this.invalidate()}else this.set(e)}setChanged(e,t,n=!0,r=!1){const s=this;s.$changed[e]=t,r&&(e in s.$beforeChange||(s.$beforeChange[e]=s.get(e)),s.setData(e,t)),n&&s.invalidate()}calculateInvalidated(){}finalizeInvalidated(e=!1){const t=this;t.$isCalculating=!0,e?t.setData(t.$changed):(t.setData(t.$beforeChange),t.set(t.$changed)),t.$changed={},t.$beforeChange={},t.$isCalculating=!1}}}))){}const np=e=>e instanceof Set||e instanceof Array?om(e):om([e]),rp=e=>new Promise((t=>setTimeout(t,e)));class sp extends(Cm([qm],(e=>{const t=e.prototype;return class extends e{constructor(){super(...arguments),this.assignmentsForRemoval=new Set,this.allAssignmentsForRemoval=!1}remove(e,n){this.assignmentsForRemoval=np(e).toSet();const r=t.remove.call(this,e,n);return this.assignmentsForRemoval.clear(),r}removeAll(e){this.allAssignmentsForRemoval=!0;const n=t.removeAll.call(this,e);return this.allAssignmentsForRemoval=!1,n}}}))){}class ip extends(Cm([qm],(e=>{e.prototype;return class extends e{doDestroy(){var e;const t=[];null!==(e=this.rootNode)&&void 0!==e&&e.isDestroyed||this.traverse((e=>t.push(e))),super.doDestroy(),t.forEach((e=>e.destroy()))}}}))){}class ap extends(Cm([qm],(e=>{const t=e.prototype;return class extends e{constructor(){super(...arguments),this.dependenciesForRemoval=new Set,this.allDependenciesForRemoval=!1}remove(e,n){this.dependenciesForRemoval=np(e).toSet();const r=t.remove.call(this,e,n);return this.dependenciesForRemoval.clear(),r}removeAll(e){this.allDependenciesForRemoval=!0;const n=t.removeAll.call(this,e);return this.allDependenciesForRemoval=!1,n}}}))){}const op={splice:1,clear:1};class lp extends(Cm([qm],(e=>{const t=e.prototype;return class extends e{constructor(){super(...arguments),this.assignmentsForRemoval=new Set,this.dependenciesForRemoval=new Set}onDataChange(e){var t;const n=op[e.action];super.onDataChange(e),n&&null!==(t=e.removed)&&void 0!==t&&t.length&&this.afterEventRemoval()}remove(e,n){const r=t.remove.call(this,e,n);return this.afterEventRemoval(),r}removeAll(e){const n=t.removeAll.call(this,e);return this.afterEventRemoval(),n}onNodeRemoveChild(e,n,r,s){const i=t.onNodeRemoveChild.call(this,...arguments);return this.afterEventRemoval(),i}afterEventRemoval(){const{assignmentsForRemoval:e,dependenciesForRemoval:t}=this;if(!e)return;const n=this.getAssignmentStore();if(n&&!n.allAssignmentsForRemoval&&e.size){const t=[...e].filter((e=>!n.assignmentsForRemoval.has(e)));t.length>0&&n.remove(t)}e.clear();const r=this.getDependencyStore();if(r&&!r.allDependenciesForRemoval&&t.size){const e=[...t].filter((e=>!r.dependenciesForRemoval.has(e)));e.length>0&&r.remove(e)}t.clear()}processRecord(e,t=!1){var n;if(null===(n=this.project)||void 0===n||!n.isRepopulatingStores){const t=this.getById(e.id);if(t&&t!==e&&t.assigned)for(const n of t.assigned)n.event=e}return e}}}))){}const cp={splice:1,clear:1};class dp extends(Cm([qm],(e=>{const t=e.prototype;return class extends e{constructor(){super(...arguments),this.assignmentsForRemoval=new Set}onDataChange(e){var t;const n=cp[e.action];super.onDataChange(e),n&&null!==(t=e.removed)&&void 0!==t&&t.length&&this.afterResourceRemoval()}remove(e,n){const r=t.remove.call(this,e,n);return this.afterResourceRemoval(),r}removeAll(e){const n=t.removeAll.call(this,e);return this.afterResourceRemoval(),n}afterResourceRemoval(){const e=this.getAssignmentStore();if(e&&!e.allAssignmentsForRemoval){const t=[...this.assignmentsForRemoval].filter((t=>!e.assignmentsForRemoval.has(t)));t.length>0&&e.remove(t)}this.assignmentsForRemoval.clear()}processRecord(e,t=!1){const n=this.getById(e.id);if(n&&n!==e)for(const t of n.assigned||[])t.resource=e;return e}}}))){}class up extends(Cm([tp],(e=>{const t=e.prototype;return class extends e{constructor(){super(...arguments),this._startDate=null,this._endDate=null,this._duration=null}static get fields(){return[{name:"startDate",type:"date"},{name:"endDate",type:"date"},{name:"duration",type:"number"},{name:"durationUnit",type:"durationunit",defaultValue:"day"}]}get startDate(){return this._startDate??this.get("startDate")??null}get endDate(){return this._endDate??this.get("endDate")??null}get duration(){return this._duration??this.get("duration")??null}set startDate(e){this.proposeStartDate(e)}set endDate(e){this.proposeEndDate(e)}set duration(e){this.proposeDuration(e)}inSet(e,n,r,s,i){const a=this;return!a.project||a.project.isWritingData||"string"==typeof e||i||("startDate"in e&&!("startDate"in a.$changed)&&(a.$changed.startDate=!0,a.invalidate()),"endDate"in e&&!("endDate"in a.$changed)&&(a.$changed.endDate=!0,a.invalidate())),t.inSet.call(a,e,n,r,s,i)}getStartDate(){return this.startDate}proposeStartDate(e,t=!("endDate"in this.$changed)){var n;(this.inSetting||(null==e?void 0:e.getTime())!==(null===(n=this.startDate)||void 0===n?void 0:n.getTime()))&&(this._startDate=e,this.propose({startDate:e,keepDuration:t}))}async setStartDate(e,t=!0){var n;return this.proposeStartDate(e,t),null===(n=this.project)||void 0===n?void 0:n.commitAsync()}getEndDate(){return this.endDate}proposeEndDate(e,t=!1){var n;(this.inSetting||(null==e?void 0:e.getTime())!==(null===(n=this.endDate)||void 0===n?void 0:n.getTime()))&&(this._endDate=e,this.propose({endDate:e,keepDuration:t}))}async setEndDate(e,t=!1){var n;return this.proposeEndDate(e,t),null===(n=this.project)||void 0===n?void 0:n.commitAsync()}getDuration(){return this.duration}proposeDuration(e,t,n=!0){this._duration=e,this.propose({duration:e,keepStart:n}),t&&this.propose({durationUnit:t})}async setDuration(e,t,n=!0){var r;return this.proposeDuration(e,t,n),null===(r=this.project)||void 0===r?void 0:r.commitAsync()}getDurationUnit(){return this.durationUnit}joinProject(){const e=this,n=e.$changed,r=e.getCurrentOrProposed("startDate"),s=e.getCurrentOrProposed("endDate"),i=e.getCurrentOrProposed("duration");if(null!=r&&(n.startDate=e._startDate=r),null!=s&&(n.endDate=e._endDate=s),null!=i&&(n.duration=e._duration=i),e.eventStore&&!e.eventStore.isLoadingData){var a;const t=null===(a=e.assignmentStore)||void 0===a?void 0:a.storage.findItem("event",null);if(t){var o;const n=null===(o=e.assignmentStore)||void 0===o?void 0:o.storage.findItem("eventId",e.id);if(n)for(const t of n)t.setChanged("event",e);else for(const n of t)n.getCurrentOrProposed("event")===e.id&&n.setChanged("event",e)}}t.joinProject.call(e)}applyValue(e,n,r,s,i){var a;if((this.project||null!==(a=this.recurringTimeSpan)&&void 0!==a&&a.project)&&i){const{name:t}=i;"startDate"!==t&&"duration"!=t&&"endDate"!==t||(e=!0,this["_"+t]=r),s&&(e=!1)}t.applyValue.call(this,e,n,r,s,i)}afterChange(e,n,r,s,i){this.$isCalculating||i||this.setData({startDate:this.getCurrentOrProposed("startDate"),endDate:this.getCurrentOrProposed("endDate"),duration:this.getCurrentOrProposed("duration"),durationUnit:this.getCurrentOrProposed("durationUnit")}),t.afterChange.call(this,e,n,r,s,i)}calculateInvalidated(){var e;const t=this,n=t.$changed,r="startDate"in n,s="endDate"in n,i="duration"in n,{startDate:a,endDate:o,duration:l,keepDuration:c,keepStart:d}=n;let u=null;!r||s||i?r||!s||i?r||s||!i?r&&s&&!i?null===a&&null===o?n.duration=null:u="duration":r&&!s&&i?u="endDate":!r&&s&&i?u="startDate":r&&s&&i&&(u=null==l?"duration":null==a?"startDate":"endDate"):null===l?n.endDate=null:!t.hasCurrentOrProposed("startDate")||!d&&t.hasCurrentOrProposed("endDate")?t.hasCurrentOrProposed("endDate")&&(u="startDate"):(d&&n.duration<0&&(n.duration=0),u="endDate"):null===o?n.startDate=null:t.hasCurrentOrProposed("startDate")&&!c&&!0!==o&&o<t.getCurrentOrProposed("startDate")?(n.startDate=o,n.duration=0):!t.hasCurrentOrProposed("duration")||!c&&t.hasCurrentOrProposed("startDate")?t.hasCurrentOrProposed("startDate")&&(u="duration"):u="startDate":null===a?n.endDate=null:t.hasCurrentOrProposed("endDate")&&a>t.getCurrentOrProposed("endDate")&&!c?(n.endDate=a,n.duration=0):!t.hasCurrentOrProposed("duration")||!c&&t.hasCurrentOrProposed("endDate")?t.hasCurrentOrProposed("endDate")&&(u="duration"):u="endDate";const h=t.getCurrentOrProposed("startDate"),g=t.getCurrentOrProposed("endDate"),m=t.getCurrentOrProposed("duration"),p=t.getCurrentOrProposed("durationUnit"),f=(null===(e=t.getProject())||void 0===e?void 0:e.adjustDurationToDST)??!1;switch(u){case"startDate":const e=Bt.add(g,-m,p);if(f){const t=g.getTimezoneOffset()-e.getTimezoneOffset();e.setTime(e.getTime()-60*t*1e3)}n.startDate=e;break;case"endDate":const t=Bt.add(h,m,p);if(f){const e=h.getTimezoneOffset()-t.getTimezoneOffset();t.setTime(t.getTime()-60*e*1e3)}n.endDate=t;break;case"duration":let r=Bt.diff(h,g,"millisecond");if(f){r+=60*(h.getTimezoneOffset()-g.getTimezoneOffset())*1e3}n.duration=Bt.as(p,r,"millisecond")}"startDate"in n&&!0!==n.startDate&&(this._startDate=n.startDate),"endDate"in n&&!0!==n.endDate&&(this._endDate=n.endDate),"duration"in n&&!0!==n.duration&&(this._duration=n.duration),!0===n.startDate&&delete n.startDate,!0===n.endDate&&delete n.endDate,delete n.keepDuration,delete n.keepStart}}}))){}class hp extends(Cm([tp],(e=>{const t=e.prototype;return class extends e{get assigned(){var e;return null===(e=this.project)||void 0===e?void 0:e.assignmentStore.getResourcesAssignments(this)}joinProject(){var e;this.resourceStore&&!this.resourceStore.isLoadingData&&(null===(e=this.assignmentStore)||void 0===e||e.query((e=>e.get("resource")===this.id)).forEach((e=>e.setChanged("resource",this))));t.joinProject.call(this)}leaveProject(e=!1){var n;if(this.assigned&&!e&&(null===(n=this.resourceStore)||void 0===n||!n.isLoadingData)){const e=this.resourceStore;this.assigned.forEach((t=>e.assignmentsForRemoval.add(t)))}t.leaveProject.call(this)}applyValue(e,n,r,s,i){"id"===(null==i?void 0:i.name)&&this.assigned.forEach((e=>{e.set("resourceId",r)})),t.applyValue.call(this,e,n,r,s,i)}}}))){}function gp(e){return null!=e&&e.isModel?e.id:e}class mp extends(Cm([tp],(e=>{const t=e.prototype;return class extends e{static get fields(){return[{name:"resource",isEqual:(e,t)=>e===t,persist:!1},{name:"event",isEqual:(e,t)=>e===t,persist:!1}]}setChanged(e,n,r){const{assignmentStore:s,eventStore:i,resourceStore:a,project:o}=this;let l=!1;if("event"===e){const e=bm(n,up)?n:null==i?void 0:i.$master.getById(n);e&&(l=!0),n=e||n}if("resource"===e){const e=bm(n,hp)?n:null==a?void 0:a.$master.getById(n);e&&(l=!0),n=e||n}t.setChanged.call(this,e,n,r,!0),!s||!l||o.isPerformingCommit||s.isLoadingData||null!=a&&a.isLoadingData||s.skipInvalidateIndices||s.invalidateIndices()}joinProject(){t.joinProject.call(this),this.setChanged("event",this.get("event")),this.setChanged("resource",this.get("resource"))}calculateInvalidated(){let{event:e=this.event,resource:t=this.resource}=this.$changed;if(null!==e&&!bm(e,up)){var n;const t=null===(n=this.eventStore)||void 0===n?void 0:n.getById(e);t&&this.setChanged("event",t,!1)}if(null!==t&&!bm(t,hp)){var r;const e=null===(r=this.resourceStore)||void 0===r?void 0:r.getById(t);e&&this.setChanged("resource",e,!1)}}finalizeInvalidated(e){const n=this.$changed;"resource"in n&&(n.resourceId=gp(n.resource)),"event"in n&&(n.eventId=gp(n.event)),t.finalizeInvalidated.call(this,e)}set event(e){this.setChanged("event",e),this.setChanged("eventId",gp(e))}get event(){const e=this.get("event");return null!=(null==e?void 0:e.id)?e:null}set resource(e){this.setChanged("resource",e),this.setChanged("resourceId",gp(e))}get resource(){const e=this.get("resource");return null!=(null==e?void 0:e.id)?e:null}}}))){}class pp extends(Cm([qm,Jm,Li],(e=>{const t=e.prototype;return class extends e{setProject(e){const n=t.setProject.call(this,e);return e&&this.joinProject(e),n}joinProject(e){}onCommitAsync(){}}}))){}const fp=new Set;class vp extends(Cm([sp,pp],(e=>{e.prototype;return class extends e{constructor(){super(...arguments),this.skipInvalidateIndices=!1}static get defaultConfig(){return{modelClass:mp,storage:{extraKeys:[{property:"event",unique:!1},{property:"resource",unique:!1},{property:"eventId",unique:!1}]}}}set data(e){this.allAssignmentsForRemoval=!0,super.data=e,this.allAssignmentsForRemoval=!1}getEventsAssignments(e){return this.storage.findItem("event",e,!0)||fp}getResourcesAssignments(e){return this.storage.findItem("resource",e.$original,!0)||fp}updateIndices(){this.storage.rebuildIndices()}invalidateIndices(){this.storage.invalidateIndices()}afterLoadData(){this.eventStore&&this.linkAssignments(this.eventStore,"event"),this.resourceStore&&this.linkAssignments(this.resourceStore,"resource")}linkAssignments(e,t){e=e.masterStore||e;const n=this.count&&this.storage.findItem(t,null,!0);if(n){for(const r of n){const n=e.getById(r.getCurrentOrProposed(t));n&&r.setChanged(t,n)}this.invalidateIndices()}}unlinkAssignments(e){this.forEach((t=>{var n;return t.setChanged(e,(null===(n=t[e])||void 0===n?void 0:n.id)??(null==t?void 0:t.getData(e))??t[e+"Id"])})),this.invalidateIndices()}onCommitAsync(){this.updateIndices()}}}))){}class yp extends(Cm([Qm,tp],(e=>{e.prototype;return class extends e{}}))){}class bp extends(Cm([ip,pp],(e=>{e.prototype;return class extends e{static get defaultConfig(){return{tree:!0,modelClass:yp}}}}))){}class Cp extends(Cm([tp],(e=>{const t=e.prototype;return class extends e{static get fields(){return[{name:"fromEvent",isEqual:(e,t)=>e===t,persist:!1},{name:"toEvent",isEqual:(e,t)=>e===t,persist:!1}]}setChanged(e,n,r){var s;let i=!1;if("fromEvent"===e||"toEvent"===e){var a;const e=bm(n,up)?n:null===(a=this.eventStore)||void 0===a?void 0:a.getById(n);e&&(i=!0),n=e||n}var o;(t.setChanged.call(this,e,n,r,!0),!i||this.project.isPerformingCommit||null!==(s=this.dependencyStore)&&void 0!==s&&s.isLoadingData)||(null===(o=this.dependencyStore)||void 0===o||o.invalidateIndices())}joinProject(){t.joinProject.call(this),this.setChanged("fromEvent",this.get("fromEvent")),this.setChanged("toEvent",this.get("toEvent"))}calculateInvalidated(){let{fromEvent:e,toEvent:t}=this.$changed;if(null!==e&&!bm(e,up)){var n;const t=null===(n=this.eventStore)||void 0===n?void 0:n.getById(e);t&&(this.$changed.fromEvent=t)}if(null!==t&&!bm(t,up)){var r;const e=null===(r=this.eventStore)||void 0===r?void 0:r.getById(t);e&&(this.$changed.toEvent=e)}}set fromEvent(e){this.setChanged("fromEvent",e)}get fromEvent(){const e=this.get("fromEvent");return null!=(null==e?void 0:e.id)?e:null}set toEvent(e){this.setChanged("toEvent",e)}get toEvent(){const e=this.get("toEvent");return null!=(null==e?void 0:e.id)?e:null}}}))){}const Sp=new Set;class wp extends(Cm([ap,pp],(e=>{e.prototype;return class extends e{constructor(){super(...arguments),this.dependenciesForRemoval=new Set,this.allDependenciesForRemoval=!1}static get defaultConfig(){return{modelClass:Cp,storage:{extraKeys:[{property:"fromEvent",unique:!1},{property:"toEvent",unique:!1}]}}}getIncomingDepsForEvent(e){return this.storage.findItem("toEvent",e)||Sp}getOutgoingDepsForEvent(e){return this.storage.findItem("fromEvent",e)||Sp}set data(e){this.allDependenciesForRemoval=!0,super.data=e,this.allDependenciesForRemoval=!1}updateIndices(){this.storage.rebuildIndices()}invalidateIndices(){this.storage.invalidateIndices()}onCommitAsync(){this.updateIndices()}}}))){}class Dp extends(Cm([up,ep],(e=>{const t=e.prototype;return class extends e{get assigned(){var e;return(null===(e=this.project)||void 0===e?void 0:e.assignmentStore.getEventsAssignments(this))??this.$cachedAssignments}leaveProject(e=!1){this.$cachedAssignments=this.assigned,super.leaveProject(e)}applyValue(e,n,r,s,i){var a;"id"===n&&(null===(a=this.assigned)||void 0===a||a.forEach((e=>e.set("eventId",r))));t.applyValue.call(this,e,n,r,s,i)}copy(e=null,n=null){const r=t.copy.call(this,e,n);return(Ut.isObject(n)&&!n.skipFieldIdentifiers||!Ut.isObject(n))&&(r.$cachedAssignments=this.assigned),r}}}))){}class Tp extends(Cm([up],(e=>{const t=e.prototype;return class extends e{get outgoingDeps(){return this.project.dependencyStore.getOutgoingDepsForEvent(this)}get incomingDeps(){return this.project.dependencyStore.getIncomingDepsForEvent(this)}leaveProject(){const e=this.eventStore;this.outgoingDeps&&this.outgoingDeps.forEach((t=>e.dependenciesForRemoval.add(t))),this.incomingDeps&&this.incomingDeps.forEach((t=>e.dependenciesForRemoval.add(t))),t.leaveProject.call(this)}}}))){}class Ep extends(Cm([up,Dp,Tp],(e=>{e.prototype;return class extends e{}}))){}class xp extends(Cm([lp,pp],(e=>{e.prototype;return class extends e{static get defaultConfig(){return{modelClass:Ep}}joinProject(){var e;null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"event")}afterLoadData(){var e;this.afterEventRemoval(),null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"event")}}}))){}class kp extends(Cm([dp,pp],(e=>{const t=e.prototype;return class extends e{static get defaultConfig(){return{modelClass:hp}}joinProject(){var e;null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"resource")}afterLoadData(){var e;null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"resource")}clear(e){var n;t.clear.call(this,e),null===(n=this.assignmentStore)||void 0===n||n.unlinkAssignments("resource")}}}))){}class Ip extends(Cm([],Ne)){}class Rp extends(Cm([],Ur)){}class Mp extends(Cm([Ip,Rp,Ns],(e=>{const t=e.prototype;return class extends e{constructor(){super(...arguments),this.isRestoringData=!1}get isRepopulatingStores(){return!1}get isInitialCommit(){return!this.isInitialCommitPerformed||this.hasLoadedDataToCommit}construct(e={}){this.isInitialCommitPerformed=!1,this.isLoadingInlineData=!1,this.isWritingData=!1,this.hasLoadedDataToCommit=!1;const n=!("silenceInitialCommit"in e)||e.silenceInitialCommit,r="adjustDurationToDST"in e&&e.adjustDurationToDST;this.maxCalendarRange="maxCalendarRange"in e?e.maxCalendarRange:15768e7,delete e.maxCalendarRange,delete e.silenceInitialCommit,delete e.adjustDurationToDST,t.construct.call(this,e),this.silenceInitialCommit=n,this.adjustDurationToDST=r}repopulateStore(e){}repopulateReplica(){}deferUntilRepopulationIfNeeded(e,t,n){t(...n)}attachStore(e){}detachStore(e){}async commitAsync(){throw new Error("Abstract method called")}isEngineReady(){throw new Error("Abstract method called")}getStm(){throw new Error("Abstract method called")}}}))){}class Op extends(Cm([],Ur)){}class Ap extends(Cm([Mp,Jm,Op,Ns],(e=>{const t=e.prototype;class n extends e{static get configurable(){return{stm:{},eventStore:{},assignmentStore:{},resourceStore:{},dependencyStore:{},calendarManagerStore:{},eventModelClass:Ep,assignmentModelClass:mp,resourceModelClass:hp,dependencyModelClass:Cp,calendarModelClass:yp,eventStoreClass:xp,assignmentStoreClass:vp,resourceStoreClass:kp,dependencyStoreClass:wp,calendarManagerStoreClass:bp,assignmentsData:null,calendarsData:null,dependenciesData:null,eventsData:null,resourcesData:null}}construct(e={}){const n=this;if(n.$invalidated=new Set,n.isPerformingCommit=!1,n.silenceInitialCommit=!0,n.ongoing=Promise.resolve(),e.eventStore&&!e.assignmentStore){var r;const t=e.eventStore.masterStore||e.eventStore,s=t.assignmentStore||(null===(r=t.crudManager)||void 0===r?void 0:r.assignmentStore);null!=s&&s.isAssignmentStore&&(e.assignmentStore=s,n.isSharingAssignmentStore=!0)}t.construct.call(n,e),n.defaultCalendar=new n.calendarManagerStore.modelClass({unspecifiedTimeIsWorking:n.unspecifiedTimeIsWorking}),n.defaultCalendar.project=n;const{calendarsData:s,eventsData:i,dependenciesData:a,resourcesData:o,assignmentsData:l}=n;Boolean(s||i||a||o||l)?(n.loadInlineData({calendarsData:s,eventsData:i,dependenciesData:a,resourcesData:o,assignmentsData:l}),delete n.calendarsData,delete n.eventsData,delete n.dependenciesData,delete n.resourcesData,delete n.assignmentsData):n.bufferedCommitAsync()}doDestroy(){var e,n,r,s,i,a;const o=this;null===(e=o.eventStore)||void 0===e||e.destroy(),null===(n=o.dependencyStore)||void 0===n||n.destroy(),null===(r=o.assignmentStore)||void 0===r||r.destroy(),null===(s=o.resourceStore)||void 0===s||s.destroy(),null===(i=o.calendarManagerStore)||void 0===i||i.destroy(),o.defaultCalendar.destroy(),null===(a=o.stm)||void 0===a||a.destroy(),t.doDestroy.call(this)}async loadInlineData(e){const t=this;t.isLoadingInlineData=!0,e.calendarsData&&(t.calendarManagerStore.data=e.calendarsData),e.resourcesData&&(t.resourceStore.data=e.resourcesData),e.assignmentsData&&(t.assignmentStore.data=e.assignmentsData),e.eventsData&&(t.eventStore.data=e.eventsData),e.tasksData&&(t.eventStore.data=e.tasksData),e.dependenciesData&&(t.dependencyStore.data=e.dependenciesData),await t.commitLoad(),t.isLoadingInlineData=!1}async commitLoad(){await this.commitAsync(),this.isDestroyed||this.trigger("load")}joinStoreRecords(e){const t=e=>{e.setProject(this),e.joinProject()};e.rootNode?e.rootNode.traverse(t):e.forEach(t)}unJoinStoreRecords(e){const t=e=>{e.leaveProject(),e.setProject(this)};e.rootNode?e.rootNode.traverse((n=>{n!==e.rootNode&&t(n)})):e.forEach(t)}resolveStoreAndModelClass(e,t){const n=(null==t?void 0:t.storeClass)||this[`${e}StoreClass`];let r=null==t?void 0:t.modelClass;return r||(r=this.getDefaultConfiguration()[`${e}ModelClass`]!==n.getDefaultConfiguration().modelClass?n.getDefaultConfiguration().modelClass:this[`${e}ModelClass`]),{storeClass:n,modelClass:r}}setEventStore(e){this.eventStore=e}changeEventStore(e,t){const n=this,{stm:r}=n;if(n.detachStore(t),e instanceof Li)e.project=n,r.addStore(e),n.joinStoreRecords(e);else{const{storeClass:t,modelClass:s}=n.resolveStoreAndModelClass("event",e);e=new t(Ut.assign({modelClass:s,project:n,stm:r},e))}if(t&&r.hasStore(t)){r.removeStore(t),n.unJoinStoreRecords(t);const{assignmentsForRemoval:s}=t;s.forEach((t=>{const n=t.event;if(n){const r=e.getById(n.id);r&&(t.event=r,s.delete(t))}})),t.afterEventRemoval()}return e.setProject(n),e}updateEventStore(e,t){this.attachStore(e),this.trigger("eventStoreChange",{store:e})}setAssignmentStore(e){this.assignmentStore=e}changeAssignmentStore(e,t){const n=this,{stm:r}=n;if(n.detachStore(t),t&&r.hasStore(t)&&(r.removeStore(t),n.unJoinStoreRecords(t)),e instanceof Li)e.project=n,r.addStore(e),n.joinStoreRecords(e);else{const{storeClass:t,modelClass:s}=n.resolveStoreAndModelClass("assignment",e);e=new t(Ut.assign({modelClass:s,project:n,stm:r},e))}return e.setProject(n),e}updateAssignmentStore(e,t){this.attachStore(e),this.trigger("assignmentStoreChange",{store:e})}setResourceStore(e){this.resourceStore=e}changeResourceStore(e,t){const n=this,{stm:r}=n;if(n.detachStore(t),e instanceof Li)e.project=n,r.addStore(e),n.joinStoreRecords(e);else{const{storeClass:t,modelClass:s}=n.resolveStoreAndModelClass("resource",e);e=new t(Ut.assign({modelClass:s,project:n,stm:r},e))}if(t&&r.hasStore(t)){r.removeStore(t),n.unJoinStoreRecords(t);const{assignmentsForRemoval:s}=t;s.forEach((t=>{const n=t.resource;if(n){const r=e.getById(n.id);r&&(t.resource=r,s.delete(t))}})),t.afterResourceRemoval()}return e.setProject(n),e}updateResourceStore(e,t){this.attachStore(e),this.trigger("resourceStoreChange",{store:e})}setDependencyStore(e){this.dependencyStore=e}changeDependencyStore(e,t){const n=this;if(n.detachStore(t),e instanceof Li)e.project=n,n.stm.addStore(e),n.joinStoreRecords(e);else{const{storeClass:t,modelClass:r}=n.resolveStoreAndModelClass("dependency",e);e=new t(Ut.assign({modelClass:r,project:n,stm:n.stm},e))}return e}updateDependencyStore(e,t){this.attachStore(e),this.trigger("dependencyStoreChange",{store:e})}setCalendarManagerStore(e){this.calendarManagerStore=e}changeCalendarManagerStore(e,t){const n=this;if(n.detachStore(t),e instanceof Li)n.stm.addStore(e);else{var r,s;const t=(null===(r=e)||void 0===r?void 0:r.storeClass)||n.calendarManagerStoreClass,i=(null===(s=e)||void 0===s?void 0:s.modelClass)||t.getDefaultConfiguration().modelClass||n.calendarModelClass;e=new t(Ut.assign({modelClass:i,project:n,stm:n.stm},e))}return e.setProject(n),e}updateCalendarManagerStore(e,t){this.attachStore(e),this.trigger("calendarManagerStoreChange",{store:e})}get calendar(){return this.$calendar||this.defaultCalendar}set calendar(e){this.$calendar=e}get effectiveCalendar(){return this.calendar}async addEvent(e){return this.eventStore.add(e),this.commitAsync()}async addAssignment(e){return this.assignmentStore.add(e),this.commitAsync()}async addResource(e){return this.resourceStore.add(e),this.commitAsync()}async addDependency(e){return this.dependencyStore.add(e),this.commitAsync()}bufferedCommitAsync(){this.hasPendingAutoCommit||this.setTimeout({fn:"commitAsync",delay:10})}get hasPendingAutoCommit(){return this.hasTimeout("commitAsync")}unScheduleAutoCommit(){this.clearTimeout("commitAsync")}async commitAsync(){return this.isPerformingCommit?this.ongoing:this.ongoing=this.doCommitAsync()}async doCommitAsync(){const e=this;if(e.isPerformingCommit=!0,e.unScheduleAutoCommit(),await rp(0),!e.isDestroyed){for(const t of e.$invalidated)t.calculateInvalidated();const{isInitialCommit:t,silenceInitialCommit:n}=e,r=t&&n;e.assignmentStore.onCommitAsync(),e.dependencyStore.onCommitAsync(),e.isInitialCommitPerformed=!0,e.hasLoadedDataToCommit=!1,e.isPerformingCommit=!1;const s=[e.assignmentStore,e.dependencyStore,e.eventStore,e.resourceStore,e.calendarManagerStore];if(s.forEach((e=>{var t;return null===(t=e.suspendAutoCommit)||void 0===t?void 0:t.call(e)})),e.isWritingData=!0,e.trigger("refresh",{isInitialCommit:t,isCalculated:!0}),r)for(const t of e.$invalidated)t.finalizeInvalidated(!0);else{for(const t of e.$invalidated)t.beginBatch(!0),t.finalizeInvalidated();for(const t of e.$invalidated)t.endBatch(!1,!0)}return e.isWritingData=!1,e.$invalidated.clear(),e.trigger("dataReady"),s.forEach((e=>{var t;return null===(t=e.resumeAutoCommit)||void 0===t?void 0:t.call(e)})),e.trigger("commitFinalized"),!0}}async propagateAsync(){return this.commitAsync()}invalidate(e){this.$invalidated.add(e),this.bufferedCommitAsync()}async isValidDependency(){return!0}getStm(){return this.stm}set stm(e){(e=this.$stm=new Za(Ut.assign({disabled:!0},e))).ion({restoringStop:async()=>{e.disable(),await this.commitAsync(),this.isDestroyed||(e.enable(),this.trigger("stateRestoringDone"))}})}get stm(){return this.$stm}isEngineReady(){return!this.hasPendingAutoCommit&&!this.isPerformingCommit&&this.isInitialCommitPerformed}}return n.applyConfigs=!0,n}))){}class Fp extends(Nr.mixin(fs)){static factoryable={};static configurable={};onConfigChange(e){this.isConfiguring||this.isDestroying||this.client.recompose(),super.onConfigChange(e)}}Fp._$name="TaskBoardFeature";class Pp extends Fp{static $name="ColumnDrag";static type="columnDrag";static pluginConfig={after:["initialCompose","populateColumnHeaderMenu"]};initialCompose(){const e=this;e.draggable=Lp.new({dragRootElement:e.disabled?null:e.client.bodyWrapElement,dropRootElement:e.client.bodyWrapElement,owner:e,internalListeners:{beforeDragStart:"onBeforeDragStart",dragStart:"onDragStart",thisObj:e}},e.draggable)}doDestroy(){var e;null===(e=this.draggable)||void 0===e||e.destroy(),super.doDestroy()}doDisable(e){super.doDisable(e),this.draggable&&(this.draggable.dragRootElement=e?null:this.client.bodyWrapElement)}movePrev(e){const{columns:t}=this.client;t.move(e,t.getPrev(e))}moveNext(e){const{columns:t}=this.client,n=Math.min(t.indexOf(e)+2,t.count);t.move(e,t.getAt(n))}populateColumnHeaderMenu({items:e,columnRecord:t}){const{client:n}=this,{columns:r,rtl:s}=n;n.readOnly||this.disabled||(e.moveColumnLeft={text:"L{TaskBoard.moveColumnLeft}",icon:"b-fw-icon b-icon-left",disabled:t===r[s?"last":"first"],weight:200,onItem:()=>this["move"+(s?"Next":"Prev")](t)},e.moveColumnRight={text:"L{TaskBoard.moveColumnRight}",icon:"b-fw-icon b-icon-right",disabled:t===r[s?"first":"last"],weight:300,onItem:()=>this["move"+(s?"Prev":"Next")](t)})}onBeforeDragStart({drag:e,event:t}){return this.client.trigger("beforeColumnDrag",{drag:e,event:t,columnRecord:e.columnRecord})}onDragStart({drag:e,event:t}){return this.client.trigger("columnDragStart",{drag:e,event:t,columnRecord:e.columnRecord})}}Pp.initClass();class Lp extends(ue.mixin(Jd,Qd,Ne)){static get configurable(){return{dragSelector:".b-taskboard-column-header, .b-taskboard-column-header *",dragItemSelector:".b-taskboard-column-header",draggingItemCls:null,dragProxy:{type:"default",async open(e){const{owner:t}=this,{itemElement:n,startEvent:r,columnRecord:s}=e,i=t.owner.client,a=vn.from(n,t.dragRootElement),o=Mn.getClientPoint(r).getDelta(a),l=yr.createElement({className:"b-taskboard-column-drag-proxy",parent:t.dragRootElement,style:{top:a.y,left:Mn.getClientPoint(r).translate(o[0],0).x,width:n.getBoundingClientRect().width},retainElement:!0}),c=[n,...i.getColumnElements(s)];Object.assign(e,{proxy:l,elements:c,proxyOffset:o}),c.forEach(((e,t)=>{const n=e.cloneNode(!0),r=e.getBoundingClientRect();if(e.originalWidth=r.width,e.originalHeight=r.height,e.matches(".b-taskboard-column")){const r=e.closest(".b-taskboard-swimlane"),s=go.getChild(r,"header"),i=go.getChild(r,"body"),a=r.cloneNode(),o=null==s?void 0:s.cloneNode(!0),d=i.cloneNode();let u=r.getBoundingClientRect().height;if(t===c.length-1){const t=yr.getStyleValue(e.parentElement,"padding-bottom");u-=parseFloat(t)}a.style.flex=`0 0 ${u}px`,o&&a.appendChild(o),d.appendChild(n),a.appendChild(d),l.appendChild(a)}else l.appendChild(n);e.classList.add("b-drag-original")}))},dragMove({proxy:e,event:t,proxyOffset:n}){const r=Mn.getClientPoint(t).translate(n[0],0);e.style.left=`${r.x}px`}}}}setupDragContext(e){const t=super.setupDragContext(e),{client:n}=this.owner;return t.scrollManager=n.scrollManager,t.monitoringConfig={scrollables:[{element:n.bodyElement,direction:"horizontal"}]},t}startDrag(e){return e.columnRecord=this.owner.client.resolveColumnRecord(e.itemElement),super.startDrag(e)}dragStart(e){this.owner.client.suspendResponsiveness(),e.wasStarted=!0}dragEnter(e){if(!e.itemElement.matches(this.dragItemSelector))return!1;e.dropIndicators||(e.dropIndicators=e.elements.map(((e,t)=>yr.createElement({className:"b-taskboard-column-drop-indicator",elementData:{dropIndicator:!0,element:e},style:{width:e.originalWidth,height:e.originalHeight}}))),this.insertDropIndicators(e,e.columnRecord))}insertDropIndicators(e,t){const{client:n}=this.owner,r=n.columns.indexOf(t);e.dropIndicators.forEach(((e,t)=>{if(0===t){const t=go.getChild(n.bodyElement,"header"),s=[...t.children];ge.remove(s,e),t.insertBefore(e,s[r])}else{var s;const i=(null===(s=n.swimlanes)||void 0===s?void 0:s.getAt(t-1))??{domId:"default"},a=go.getChild(n.getSwimlaneElement(i),"body"),o=[...a.children];ge.remove(o,e),a.insertBefore(e,o[r])}}))}updateValidity(e,t){e.proxy.classList.toggle("b-invalid",!t),e.dropIndicators.forEach((e=>e.classList.toggle("b-invalid",!t))),e.invalid=!t}dragMove(e){var t;const{client:n}=this.owner,r=n.documentRoot,s=vn.from(e.proxy,void 0,!0),i=r.elementFromPoint(s.center.x,s.y),a=null==i?void 0:i.closest(".b-taskboard-column-header");if(e.invalid&&(e.valid=!1),(null==i||null===(t=i.elementData)||void 0===t||!t.dropIndicator)&&a){const t=vn.from(a);let r=n.resolveColumnRecord(a);s.center.x>t.center.x&&(r=n.columns.getNext(r)),this.insertDropIndicators(e,r);const i=e.beforeColumn!==r;if(e.beforeColumn=r,i){const t=n.trigger("columnDrag",{drag:e,columnRecord:e.columnRecord,beforeColumn:r});this.updateValidity(e,!1!==t)}}}async dragDrop(e){const{client:t}=this.owner,{columns:n}=t,{columnRecord:r,beforeColumn:s,elements:i,dropIndicators:a,proxy:o}=e;e.invalid||!1===await t.trigger("beforeColumnDrop",{drag:e,columnRecord:r,beforeColumn:s})?e.valid=!1:e.finalizer=new Promise((l=>{function c(){o.remove(),a.forEach((e=>e.remove())),i.forEach((e=>e.classList.remove("b-drag-original"))),t.suspendDomTransition(),void 0!==s&&n.move(r,s),t.resumeDomTransition(),t.trigger("columnDrop",{drag:e,columnRecord:r,beforeColumn:s}),t.trigger("columnDragEnd",{drag:e,columnRecord:r,beforeColumn:s}),t.resumeResponsiveness(),l()}o.classList.add("b-dropping"),yr.alignTo(o,vn.from(a[0],void 0,!0)),yr.getPropertyTransitionDuration(o,"transform")?Mn.onTransitionEnd({element:o,property:"transform",handler:c,thisObj:t}):c()}))}dragLeave(e){}doAbort(e){const{client:t}=this.owner,{dropIndicators:n,proxy:r,columnRecord:s,elements:i}=e;if(r){function a(){r.remove(),n.forEach((e=>e.remove())),i.forEach((e=>e.classList.remove("b-drag-original"))),t.trigger("columnDragAbortFinalized")}r.classList.add("b-dropping"),n.forEach(((t,n)=>{const r=e.elements[n];t.classList.remove("b-invalid"),r.parentElement.insertBefore(t,r)})),yr.alignTo(r,vn.from(n[0],void 0,!0)),yr.getPropertyTransitionDuration(r,"transform")?Mn.onTransitionEnd({element:r,property:"transform",handler:a,thisObj:t}):a()}t.trigger("columnDragAbort",{drag:e,columnRecord:s}),e.wasStarted&&t.trigger("columnDragEnd",{drag:e,columnRecord:s})}dragEnd(e){e.valid&&!e.aborted||this.doAbort(e)}}Pp._$name="ColumnDrag";class $p extends Jc{static $name="ColumnHeaderMenu";static type="columnHeaderMenu";static configurable={processItems:null,items:null,menu:{anchor:!0},type:"columnHeader",triggerEvent:!1};static get pluginConfig(){const e=super.pluginConfig;return e.chain.push("populateColumnHeaderMenu","populateColumnHeader","onColumnHeaderClick"),e}changeItems(e){return Ut.assertObject(e,"features.columnHeaderMenu.items"),e}changeProcessItems(e){return Ut.assertFunction(e,"features.columnHeaderMenu.processItems"),e}populateColumnHeader({columnHeaderConfig:e}){this.disabled||(e.children.padder.children.menu={tag:"button",class:{"b-column-header-button":1,"b-taskboard-column-header-menu-button":1,"b-fw-icon":1,"b-icon-menu-horizontal":1}})}getDataFromEvent(e){return Ut.assign(super.getDataFromEvent(e),e.taskBoardData)}populateColumnHeaderMenu({items:e,columnRecord:t}){const{client:n}=this;n.readOnly||(e.addTask={text:"L{TaskBoard.addTask}",icon:"b-fw-icon b-icon-add",weight:100,onItem(){n.addTask(t)}})}onColumnHeaderClick(e){const{event:t}=e;t.target.matches(".b-column-header-button")&&this.showContextMenu(t,{target:t.target,align:"t90-b90"})}doDisable(e){super.doDisable(e),!this.isConfiguring&&this.client.recompose()}get showMenu(){return!0}}Fp.register($p.type,$p),$p._$name="ColumnHeaderMenu";class _p extends Fp{static $name="ColumnToolbars";static type="columnToolbars";static configurable={topItems:null,bottomItems:{addTask:!0},namedItems:{addTask:{type:"button",icon:"b-icon-add",tooltip:"L{TaskBoard.addTask}",ariaLabel:"L{TaskBoard.addTask}",internalListeners:{click:"onAddClick"}}},processItems:null};columnMap=new Map;static pluginConfig={chain:["populateColumn","onRemoveColumnElement","onRemoveSwimlaneElement"]};doDestroy(){for(const[,e]of this.columnMap)e.destroy();super.doDestroy()}changeTopItems(e){return Ut.assertObject(e,"features.columnToolbars.topItems"),e}changeBottomItems(e){return Ut.assertObject(e,"features.columnToolbars.bottomItems"),e}changeProcessItems(e){return Ut.assertFunction(e,"features.columnToolbars.processItems"),e}getToolbar(e,t,n){const r=this,{columnMap:s,client:i,namedItems:a}=r,o=r[`${e}Items`],l=`${e}_._${t.domId}_._${(null==n?void 0:n.domId)??"default"}`;let c=s.get(l);if(!c){var d;const u={};if(Ut.getTruthyKeys(o).map((e=>{const s=a[e],i=o[e];u[e]=Ut.merge({internalListeners:{click:"onClick",change:"onChange",thisObj:r},columnRecord:t,swimlaneRecord:n},s,i)})),!1===(null===(d=r.processItems)||void 0===d?void 0:d.call(r,{items:u,location:e,columnRecord:t,swimlaneRecord:n})))return null;c=i.add({type:"toolbar",cls:`b-taskboard-column-${e[0]}bar`,overflow:null,monitorResize:!1,contentElMutationObserver:!1,items:u,dataset:{role:`${e}-toolbar`,domTransition:!0}}),s.set(l,c)}return c.element}populateColumn({columnConfig:e,columnRecord:t,swimlaneRecord:n}){const r=this;r.disabled||(Ut.getTruthyKeys(r.topItems).length&&yr.merge(e,{children:{"tbar > body":r.getToolbar("top",t,n)}}),Ut.getTruthyKeys(r.bottomItems).length&&(e.children.bbar=r.getToolbar("bottom",t,n)))}removeColumnToolbar(e,t,n){const{columnMap:r,client:s}=this,i=`${e}_._${t}_._${n}`,a=r.get(i);a&&(s.remove(a),s.setTimeout((()=>a.destroy()),0),r.delete(i))}removeColumnToolbars(e,t){this.removeColumnToolbar("top",e,t),this.removeColumnToolbar("bottom",e,t)}onRemoveColumnElement({columnId:e,swimlaneRecord:t}){this.removeColumnToolbars(e,t.id??"default")}onRemoveSwimlaneElement({swimlaneId:e}){for(const t of this.client.columns)this.removeColumnToolbars(t.id,e)}onAddClick({source:e}){this.client.addTask(e.columnRecord,e.swimlaneRecord)}onChange({source:e}){this.trigger("itemChange",{item:e,columnRecord:e.columnRecord,swimlaneRecord:e.swimlaneRecord})}onClick({source:e}){this.trigger("itemClick",{item:e,columnRecord:e.columnRecord,swimlaneRecord:e.swimlaneRecord})}}_p.initClass(),_p._$name="ColumnToolbars";class Np extends(ue.mixin(fs)){static factoryable={};static configurable={};static defaultEditor={type:"text"};static getEditorConfig({config:e,item:t}){const n=null!==e.editor&&(e.editor||t.defaultEditor);return"string"==typeof n?{type:n}:n}}Np._$name="TaskItem";const jp={editNext:1,cancel:1,editPrevious:1,complete:1};class Vp extends Fp{static $name="SimpleTaskEdit";static type="simpleTaskEdit";static configurable={addNewAtEnd:!0,editorConfig:{},keyMap:{Enter:"editNext",Escape:"cancel","Ctrl+Enter":"complete","Shift+Enter":"editPrevious"}};static pluginConfig={assign:["editTask"],before:["onActivateTask"]};changeAddNewAtEnd(e){return Ut.assertBoolean(e,"features.simpleTaskEdit.addNewAtEnd"),e}editTask(e,t){const n=this,r=n.client;t||(t=r.getTaskElement(e));const s=r.resolveTaskItem(t),i=s.element,a=Np.getEditorConfig(s);if(!a)return!1;if(n.disabled||e.readOnly||!1===r.trigger("beforeSimpleTaskEdit",{simpleTaskEdit:n,taskRecord:e,field:s.config.field}))return!0;t.focus();const o=n.editor=jh.new({owner:r,appendTo:i.parentNode,scrollAction:"realign",cls:"b-simple-task-editor",completeKey:null,cancelKey:null,inputField:{autoSelect:!0,name:s.config.field,...a},align:{align:"c-c",allowTargetOut:!1},internalListeners:{complete:"onEditorComplete",cancel:"onEditorCancel",finishEdit:"onEditorFinishEdit",thisObj:n}},n.editorConfig);n.currentElement=i,i.classList.add("b-editing");const l=yr.getStyleValue(i,"color");return o.element.style.color=l,o.inputField.element.style.color=l,o.element.retainElement=!0,r.getTaskElement(e).scrollIntoView({block:"nearest"}),i.scrollIntoView({block:"nearest"}),o.startEdit({target:s.element,record:e,field:s.config.field}),!0}async editPrevious(e){const t=this,{client:n,editor:r}=t,s=r.record,i=n.getTaskElement(s),a=Array.from(i.querySelectorAll(".b-taskboard-taskitem.b-editable")),o=a.indexOf(t.currentElement)-1;if(await t.complete(e))if(o>=0)t.editTask(s,a[o]);else{const e=n.getPreviousTask(s,!1);if(e){const r=n.getTaskElement(e),s=Array.from(r.querySelectorAll(".b-taskboard-taskitem.b-editable"));t.editTask(e,s[s.length-1])}}}async editNext(e){const t=this,{client:n,editor:r}=t,s=r.record,i=n.getTaskElement(s),a=Array.from(i.querySelectorAll(".b-taskboard-taskitem.b-editable")),o=a.indexOf(t.currentElement)+1;if(await t.complete(e))if(o<a.length)t.editTask(s,a[o]);else{const e=n.getNextTask(s,!1);e?t.editTask(e):t.addNewAtEnd&&n.addTask(n.getColumn(s),n.getSwimlane(s))}}complete(e){return this.editor.completeEdit(null,e)}cancel(e){this.editor.cancelEdit(e)}onActivateTask({taskRecord:e,event:t}){this.editTask(e,t.target)&&t.preventDefault()}onEditorComplete({source:e}){this.client.trigger("simpleTaskEditComplete",{simpleTaskEdit:this,taskRecord:e.record,field:e.dataField})}onEditorCancel({source:e}){this.client.trigger("simpleTaskEditCancel",{simpleTaskEdit:this,taskRecord:e.record,field:e.dataField})}onEditorFinishEdit(){const e=this,{editor:t}=e;null==t||t.setTimeout((()=>{e.editor===t&&(e.currentElement=null,e.editor=null),t.destroy()}),0)}isActionAvailable({actionName:e}){if(jp[e])return Boolean(this.editor)}}Vp.initClass(),Vp._$name="SimpleTaskEdit";class Bp extends Fp{static $name="SwimlaneDrag";static type="swimlaneDrag";static pluginConfig={after:["initialCompose"]};initialCompose(){const e=this;e.draggable=zp.new({dragRootElement:e.disabled?null:e.client.bodyWrapElement,dropRootElement:e.client.bodyWrapElement,owner:e},e.draggable)}doDisable(e){super.doDisable(e),this.draggable&&(this.draggable.dragRootElement=e?null:this.client.bodyWrapElement)}}Bp.initClass();class zp extends(ue.mixin(Jd,Qd)){static get configurable(){return{dragSelector:".b-taskboard-swimlane-header, .b-taskboard-swimlane-header *",dragItemSelector:".b-taskboard-swimlane-header",draggingItemCls:null,dragProxy:{type:"default",async open(e){const{owner:t}=this,{itemElement:n,startEvent:r}=e,s=t.owner.client,i=s.resolveSwimlaneRecord(n),a=s.getSwimlaneElement(i),o=yr.getStyleValue(a.syncIdMap.body,["padding-left","padding-right"]),l=vn.from(a,t.dragRootElement).deflate(0,parseFloat(o["padding-right"]),0,parseFloat(o["padding-left"])),c=Mn.getClientPoint(r).getDelta(l),d=yr.createElement({className:"b-taskboard-swimlane-drag-proxy",parent:t.dragRootElement,style:{top:Mn.getClientPoint(r).translate(0,c[1]).y,left:l.x,width:l.width},retainElement:!0});Object.assign(e,{proxy:d,swimlaneRecord:i,swimlaneElement:a,proxyOffset:c,bounds:l});const u=a.cloneNode(!0);d.appendChild(u)},dragMove({proxy:e,event:t,proxyOffset:n}){const r=Mn.getClientPoint(t).translate(0,n[1]);e.style.top=`${r.y}px`}}}}setupDragContext(e){const t=super.setupDragContext(e),{client:n}=this.owner;return t.scrollManager=n.scrollManager,t.monitoringConfig={scrollables:[{element:n.bodyElement,direction:"vertical"}]},t}dragStart(e){}dragEnter(e){if(!e.itemElement.matches(this.dragItemSelector))return!1;if(!e.dropIndicator){const{bounds:t}=e;e.dropIndicator=yr.createElement({className:"b-taskboard-swimlane-drop-indicator",elementData:{dropIndicator:!0},style:{width:t.width,height:t.height}}),this.insertDropIndicator(e.dropIndicator,e.swimlaneRecord),e.swimlaneElement.classList.add("b-drag-original")}}insertDropIndicator(e,t){const{client:n}=this.owner;n.bodyElement.insertBefore(e,t&&n.getSwimlaneElement(t))}async dragMove(e){var t;const{client:n}=this.owner,{documentRoot:r}=n,s=vn.from(n.element,void 0,!0),i=vn.from(e.proxy,void 0,!0),a=i.center.y>s.bottom?r.elementFromPoint(i.x,i.y):r.elementFromPoint(i.x,i.center.y),o=null==a?void 0:a.closest(".b-taskboard-swimlane");if((null==a||null===(t=a.elementData)||void 0===t||!t.dropIndicator)&&o){const t=vn.from(o,void 0,!0);let r=n.resolveSwimlaneRecord(o);i.center.y>t.center.y&&(r=n.swimlanes.getNext(r)),this.insertDropIndicator(e.dropIndicator,r),e.beforeSwimlane=r}}async dragDrop(e){const{client:t}=this.owner,{swimlanes:n}=t,{swimlaneRecord:r,beforeSwimlane:s,swimlaneElement:i,dropIndicator:a,proxy:o}=e;function l(){o.remove(),a.remove(),i.classList.remove("b-drag-original"),void 0!==s&&n.move(r,s),t.trigger("dropSwimlane",{beforeSwimlane:s,drag:e})}o.classList.add("b-dropping"),yr.alignTo(o,vn.from(a,void 0,!0)),yr.getPropertyTransitionDuration(o,"transform")?Mn.onTransitionEnd({element:o,property:"transform",handler:l,thisObj:t}):l()}dragLeave(e){}}Bp._$name="SwimlaneDrag";const Wp=".b-taskboard-card, .b-taskboard-card-drop-indicator",Hp=(e,t=!1)=>yr.children(e.parentElement,`.b-taskboard-card${t?":not(.b-drag-original)":""}, .b-first-drop-indicator`).indexOf(e);class Up extends Fp{static $name="TaskDrag";static type="taskDrag";static pluginConfig={after:["initialCompose"]};static configurable={reorderTaskRecords:!1,dragTouchStartDelay:null};initialCompose(){const e=this;e.draggable=Yp.new({dragRootElement:e.disabled?null:e.client.bodyWrapElement,dropRootElement:e.client.bodyWrapElement,owner:e,[null!=e.dragTouchStartDelay?"dragTouchStartDelay":void 0]:e.dragTouchStartDelay,internalListeners:{beforeDragStart:"onBeforeDragStart",dragStart:"onDragStart",thisObj:e}},e.draggable)}doDestroy(){var e;super.doDestroy(),null===(e=this.draggable)||void 0===e||e.destroy()}doDisable(e){super.doDisable(e),this.draggable&&(this.draggable.dragRootElement=e?null:this.client.bodyWrapElement)}onBeforeDragStart({drag:e,event:t}){return this.client.trigger("beforeTaskDrag",{drag:e,event:t,domEvent:t,taskRecords:e.taskRecords})}onDragStart({drag:e,event:t}){return this.client.trigger("taskDragStart",{drag:e,event:t,domEvent:t,taskRecords:e.taskRecords})}}Up.initClass();class Yp extends(ue.mixin(Jd,Qd,Ne)){static get configurable(){return{dragSelector:".b-taskboard-card:not(.b-readonly)",dragItemSelector:".b-taskboard-card:not(.b-readonly)",dropTargetSelector:".b-taskboardbase",draggingItemCls:null,dragProxy:{type:"default",async open(e){const{itemElement:t,startEvent:n}=e,r=this.owner.owner.client,s=t.closest(".b-taskboard-column"),i=r.resolveTaskRecord(t),a=e.proxy=yr.createElement({className:"b-taskboard-drag-proxy "+s.className,role:"presentation",retainElement:!0}),o=[];let l;l=r.selectedTasks.includes(i)?r.selectedTasks.filter((e=>!e.readOnly)).sort(((e,t)=>e.parentIndex-t.parentIndex)):[i];const c=l.map((e=>r.getTaskElement(e)));Object.assign(e,{taskElements:c,taskHeights:new Map,proxyOffset:Mn.getClientPoint(n).getDelta(vn.from(t,null,!0))}),c.forEach((n=>{var r;const{elementData:s}=n,i=n.cloneNode(!0),l=vn.from(n,t);i.style.width=l.width+"px",i.style.height=l.height+"px",e.taskHeights.set(n,l.height),i.style.left=l.x+"px",i.style.top=l.y+"px",i.taskElement=n,i.taskRecord=s.taskRecord,i.originalColor=(null===(r=s.swimlaneRecord)||void 0===r?void 0:r.color)||s.columnRecord.color,a.appendChild(i),o.push(i)})),c.forEach((e=>e.classList.add("b-drag-original"))),await je.animationFrame(),o.forEach(((e,t)=>{t>0?(e.style.top=30+20*t+"px",e.style.left=40+5*t+"px"):(e.style.top=0,e.style.left=0)}))},dragMove({proxy:e,event:t,proxyOffset:n}){const{dragRootElement:r}=this.owner,s=r.getBoundingClientRect(),i=Mn.getClientPoint(t).translate(n[0]-s.left+r.scrollLeft,n[1]-s.top+r.scrollTop);e.style.top=i.y+"px",e.style.left=i.x+"px"}}}}configureListeners(e){const t=super.configureListeners(e);return t.element=this.owner.client.rootElement,t}setupDragContext(e){const t=super.setupDragContext(e),{client:n}=this.owner;return t.scrollManager=n.scrollManager,t.monitoringConfig={scrollables:[{element:".b-taskboard-column-body",direction:"vertical"},{element:n.bodyElement,direction:"both"}]},t}startDrag(e){const{itemElement:t}=e,n=this.owner.client,r=n.resolveTaskRecord(t);return n.isSelected(r)?e.taskRecords=n.selectedTasks.slice().sort(((e,t)=>e.parentIndex-t.parentIndex)):e.taskRecords=[r],e.initiatedFrom=r,super.startDrag(e)}dragStart(e){const{client:t}=this.owner,n=e.itemElement;e.wasStarted=!0,e.position="after",e.targetTaskRecord=e.initiatedFrom;for(const n of e.taskRecords)n.instanceMeta(t).dragging=!0;t.bodyWrapElement.appendChild(e.proxy),e.dropIndicators=e.taskElements.map(((t,r)=>yr.createElement({className:{"b-taskboard-card-drop-indicator":1,"b-first-drop-indicator":0===r},style:{height:e.taskHeights.get(t)},elementData:{dropIndicator:!0,initialParent:t.parentElement,initialIndex:Hp(t),taskElement:t},retainElement:!0,nextSibling:n}))),t.element.classList.add("b-dragging-task")}dragEnter(e){if(!e.itemElement.matches(this.dragItemSelector))return!1}getFirstVisibleChild(e){for(const t of e.children)if(t.offsetParent)return t}getCardAt(e,t){return this.owner.client.getCardAt(e,t,Wp)}updateValidity(e,t){e.proxy.classList.toggle("b-invalid",!t),e.dropIndicators.forEach((e=>e.classList.toggle("b-invalid",!t))),e.invalid=!t}dragMove(e){const t=this,{client:n}=t.owner,{event:r,dropIndicators:s}=e,{clientX:i,clientY:a}=r,o=n.documentRoot.elementFromPoint(i,a),l=go.getChild(null==o?void 0:o.closest(".b-taskboard-column"),"body.inner");if(e.invalid&&(e.valid=!1),o&&l){var c;const g=n.resolveSwimlaneRecord(o),m=n.resolveColumnRecord(o),p=m.tasksPerRow||(null==g?void 0:g.tasksPerRow)||n.tasksPerRow;let f=o.closest(Wp),v=g!==e.targetSwimlane||m!==e.targetColumn;if(e.targetSwimlane=g,e.targetColumn=m,!f){const{cardGap:r}=n,s=vn.from(l),o=t.getFirstVisibleChild(l),c=(null==o?void 0:o.getBoundingClientRect().top)??null;if(1===p)if(null!==c&&a<c)f=o;else{const e=s.center.x,n=t.getCardAt(e,a-r),i=t.getCardAt(e,a+r);f=n||i}else{const o=n.getColumnWidth(e.targetColumn),l=(s.width-o)/2,d=o/p,u=Math.floor((i-s.left)/d),h=s.left+l+d*(u+.5);if(null!==c&&a<c)f=t.getCardAt(h,c);else{const e=s.center.x,n=t.getCardAt(e-r,a),i=t.getCardAt(e+r,a);f=n||i}}}if(null===(c=f)||void 0===c||!c.elementData.dropIndicator){var d,u;let t=!1;if(f){const r=vn.from(f),s=n.resolveTaskRecord(f);1===p&&a<r.center.y||p>1&&i<r.center.x?("before"!==e.position&&(v=!0),t=f,e.position="before"):("after"!==e.position&&(v=!0),t=f.nextElementSibling,e.position="after"),s!==e.targetTaskRecord&&(v=!0),e.targetTaskRecord=s}else"last"!==e.position&&(v=!0),e.position="last",e.targetTaskRecord=null;null!==(d=t)&&void 0!==d&&null!==(u=d.elementData)&&void 0!==u&&u.dropIndicator||(!1===t?s.forEach((e=>{null==l||l.appendChild(e)})):s.forEach((e=>{var n;((null===(n=t)||void 0===n?void 0:n.parentElement)||l).insertBefore(e,t)})),e.lastCardElement=f)}for(const t of e.proxy.children){if(!t.taskRecord.eventColor){var h;const n=(null===(h=e.targetSwimlane)||void 0===h?void 0:h.color)||e.targetColumn.color;t.originalColor&&t.classList.remove(`b-taskboard-color-${t.originalColor}`),n&&(t.originalColor=n,yr.isNamedColor(n)?t.classList.add(`b-taskboard-color-${n}`):t.style.color=n)}e.targetSwimlane&&(t.dataset.lane=e.targetSwimlane.id),t.dataset.column=e.targetColumn.id}if(v){const{taskRecords:s,targetTaskRecord:i,position:a}=e,o=n.trigger("taskDrag",{drag:e,taskRecords:s,targetSwimlane:g,targetColumn:m,targetTaskRecord:i,position:a,event:r,domEvent:r});t.updateValidity(e,!1!==o)}}}async dragDrop(e){const{client:t}=this.owner,{dropIndicators:n,taskRecords:r,targetSwimlane:s,targetColumn:i,targetTaskRecord:a,event:o}=e,l={drag:e,domEvent:o,event:o,taskRecords:r,targetSwimlane:s,targetColumn:i,targetTaskRecord:a},c=(e=>e.some(((e,t)=>e.parentElement!==e.elementData.initialParent||0===t&&Hp(e,!0)!==e.elementData.initialIndex)))(n);c&&i&&!e.invalid&&!1!==await t.trigger("beforeTaskDrop",l)?e.finalizer=new Promise((l=>{const{columnField:c,swimlaneField:d}=t,{taskStore:u}=t.project,{proxy:h}=e,g=i.tasks,m=s?null==g?void 0:g.filter((e=>e[d]===s.id)):g,p=!g;let f;if(!p)if(e.targetTaskRecord){if("before"===e.position)f=a;else if("after"===e.position){const e=m.indexOf(a);f=m[e+1]??null}}else m.length&&(f=null);function v(){if(h.remove(),n.forEach((e=>{const{taskElement:t}=e.elementData;e.parentElement.insertBefore(t,e),e.parentElement.syncIdMap[t.elementData.taskId]=t,t.classList.remove("b-drag-original"),e.remove()})),t.suspendDomTransition(),!p){let e;if(f){const t=m.slice(m.indexOf(f)),n=m[m.indexOf(f)-1];let r;for(n?(r=Math.max(1,Math.round((f.weight-n.weight)/2)),e=n.weight+r):e=Math.max(1,Math.round(f.weight/2));(null===(a=t[0])||void 0===a?void 0:a.weight)===e;){var a;r=t[1]?Math.max(1,Math.round((t[1].weight-e)/2)):50,e=t[0].weight=e+r,t.shift()}}else e=m.length?m[m.length-1].weight+100:100;r.forEach((n=>{const r={[c]:i.id,weight:e};s&&(r[d]=s.id),t.features.taskDrag.reorderTaskRecords&&void 0!==f&&u.move(n,f),n.set(r)})),t.features.taskDrag.reorderTaskRecords||t.taskSorterFn||t.project.taskStore.sort()}t.resumeDomTransition(),t.trigger("taskDrop",{drag:e,event:o,taskRecords:r,targetSwimlane:s,targetColumn:i,moveBefore:f,domEvent:o}),t.trigger("taskDragEnd",{drag:e,taskRecords:r,domEvent:o}),t.element.classList.remove("b-dragging-task");for(const e of r)e.instanceMeta(t).dragging=!1;l()}const y=Array.from(h.children);h.classList.add("b-pre-dropping"),y[0].offsetWidth,h.classList.add("b-dropping"),y.forEach(((e,t)=>{const r=n[t];yr.alignTo(e,vn.from(r,void 0,!0))})),yr.getPropertyTransitionDuration(y[0],"transform")?Mn.onTransitionEnd({element:y[0],property:"transform",handler:v,thisObj:t}):v()})):e.valid=!1}dragLeave(e){e.dropIndicators.forEach((e=>{const{taskElement:t}=e.elementData;t.parentElement.insertBefore(e,t)}))}doAbort(e){const{client:t}=this.owner,{dropIndicators:n,proxy:r,taskRecords:s}=e;if(r){const i=Array.from(r.children);function a(){r.remove(),n.forEach((e=>{e.elementData.taskElement.classList.remove("b-drag-original"),e.remove()})),t.element.classList.remove("b-dragging-task");for(const e of s)e.instanceMeta(t).dragging=!1;t.trigger("taskDragAbortFinalized")}r.classList.add("b-dropping"),n.forEach((e=>{const{taskElement:t}=e.elementData;e.classList.remove("b-invalid"),t.parentElement.insertBefore(e,t)})),i.forEach(((e,t)=>{yr.alignTo(e,vn.from(n[t],void 0,!0))})),yr.getPropertyTransitionDuration(i[0],"transform")?Mn.onTransitionEnd({element:i[0],property:"transform",handler:a,thisObj:t}):a()}t.trigger("taskDragAbort",{drag:e,taskRecords:s}),e.wasStarted&&t.trigger("taskDragEnd",{drag:e,taskRecords:s})}dragEnd(e){!e.started&&!e.wasStarted||e.valid&&!e.aborted||this.doAbort(e)}}Up._$name="TaskDrag";class qp extends Fp{static $name="TaskDragSelect";static type="taskDragSelect";static configurable={dragThreshold:5};state="idle";static pluginConfig={chain:["onColumnMouseDown","onMouseMove"]};changeDragThreshold(e){return Ut.assertNumber(e,"features.taskDragSelect.dragThreshold"),e}initializeDragSelect(e){const t=this,{client:n}=t;t.bounds=vn.from(n.bodyElement,!0),t.element=yr.createElement({tag:"div",className:"b-dragselect-rect"},{returnAll:!0})[0],n.floatRoot.appendChild(t.element),n.element.classList.add("b-dragselecting");const r=Array.from(n.element.querySelectorAll(".b-taskboard-card:not(.b-dragging-item)"));t.cardRectangles=r.flatMap((e=>{const t=n.resolveTaskRecord(e);return t?{rectangle:vn.from(e,!0),record:t}:[]})),e.ctrlKey||n.deselectAll(),n.navigateable=!1,t.state="selecting"}updateSelection(){const{cardRectangles:e,rectangle:t,client:n}=this;for(let r=0,s=e.length;r<s;r++){const s=e[r],i=t.intersect(s.rectangle,!0);i&&!s.selected?(s.selected=!0,n.selectTask(s.record,!0)):!i&&s.selected&&(s.selected=!1,n.deselectTask(s.record))}}onColumnMouseDown({event:e}){const t=this;t.disabled||0!==e.button||(t.state="considering",t.startX=e.clientX,t.startY=e.clientY,t.mouseUpDetacher=Mn.on({element:document,mouseup:"onMouseUp",thisObj:t}))}onMouseMove({event:e}){const t=this,{startX:n,startY:r}=t,{clientX:s,clientY:i}=e;if("considering"===t.state){const a=Math.abs(s-n),o=Math.abs(i-r);(a>t.dragThreshold||o>t.dragThreshold)&&t.initializeDragSelect(e)}if("selecting"===t.state){const{element:e,bounds:a}=t,o=Math.max(s,a.left),l=Math.max(i,a.top),c=Math.min(n,o),d=Math.min(r,l),u=Math.abs(n-o),h=Math.abs(r-l),g=new vn(c,d,u,h).constrainTo(a);yr.setTranslateXY(e,g.left,g.top),e.style.width=g.width+"px",e.style.height=g.height+"px",t.rectangle=g,t.updateSelection()}}onMouseUp(){var e;const t=this,{client:n,state:r}=t;var s;"selecting"===r&&(null===(s=t.element)||void 0===s||s.remove(),n.element.classList.remove("b-dragselecting"),n.setTimeout((()=>n.navigateable=!0),100));"selecting"!==r&&"considering"!==r||(t.state="idle",t.startX=t.startY=t.rectangle=t.bounds=null),null===(e=t.mouseUpDetacher)||void 0===e||e.call(t)}}qp.initClass(),qp._$name="TaskDragSelect";var Kp=e=>class extends(e||ue){static $name="TaskBoardLinked";static configurable={taskBoard:null};get taskBoard(){return this._taskBoard||this.up((e=>e.isTaskBoardBase))||il.query((e=>e.isTaskBoardBase))}changeTaskBoard(e){if(e&&!e.isTaskBoard)throw new Error("The taskBoard config only accepts an instance of TaskBoard or a subclass thereof");return e}};class Gp extends(gh.mixin(Kp)){static $name="ColorBoxCombo";static type="colorboxcombo";static configurable={displayField:"text",valueField:"id",editable:!1,showBoxForNoColor:!1,listItemTpl({text:e,color:t}){let n=T.encodeHtml(e);return t&&(n=yr.isNamedColor(t)?`<div class="b-colorbox b-taskboard-color-${t}"></div>`+n:`<div class="b-colorbox" style="color : ${t}"></div>`+n),n},picker:{cls:"b-colorbox-picker"}};afterConstruct(){this.showBoxForNoColor||this.value||this.element.classList.add("b-colorless")}syncInputFieldValue(...e){const t=this,{color:n}=t.record||{};let r="b-colorbox";n&&(yr.isNamedColor(n)?r+=` b-taskboard-color-${n}`:t.colorBox.style.color=n),t.colorBox.className=r,t.showBoxForNoColor||t.element.classList.toggle("b-colorless",!n),super.syncInputFieldValue(...e)}get innerElements(){return[{reference:"colorBox",className:"b-colorbox"},...super.innerElements]}}Gp._$name="ColorBoxCombo";class Xp extends Gp{static $name="ColumnCombo";static type="columncombo";changeStore(){return this.taskBoard.columns.chain()}}Xp.initClass(),Xp._$name="ColumnCombo";class Zp extends(gh.mixin(Kp)){static $name="ResourcesCombo";static type="resourcescombo";static configurable={displayField:"name",valueField:"id",multiSelect:!0,editable:!1,listItemTpl(e){const{avatarRendering:t,taskBoard:n}=this.owner;return yr.createElement(t.getResourceAvatar({resourceRecord:e,initials:e.initials,color:e.color,iconCls:e.iconCls,imageUrl:!1===e.image?null:e.imageUrl||(n.resourceImagePath||"")+(e.image||"")})).outerHTML+T.encodeHtml(e.name)},picker:{cls:"b-resources-picker"},chipView:{scrollable:null,itemTpl(e){const{avatarRendering:t,taskBoard:n}=this.owner;return yr.createElement(t.getResourceAvatar({resourceRecord:e,initials:e.initials,color:e.color,iconCls:e.iconCls,imageUrl:!1===e.image?null:e.imageUrl||(n.resourceImagePath||"")+(e.image||""),dataset:{btip:T.encodeHtml(e.name)}})).outerHTML}},avatarRendering:{value:!0,$config:"nullify"}};get innerElements(){return this.peekConfig("multiSelect")||this._multiSelect?super.innerElements:[{reference:"avatarContainer"},this.inputElement]}syncInputFieldValue(...e){const t=this;if(!t.multiSelect){const e=t.record;e&&go.sync({targetElement:t.avatarContainer,domConfig:{className:"b-resourcescombo-avatar-container",children:[t.avatarRendering.getResourceAvatar({resourceRecord:e,initials:e.initials,color:e.color,iconCls:e.iconCls,imageUrl:!1===e.image?null:e.imageUrl||(t.taskBoard.resourceImagePath||"")+(e.image||""),dataset:{btip:T.encodeHtml(e.name)}})]}})}super.syncInputFieldValue(...e)}changeStore(){return this.taskBoard.project.resourceStore.chain()}changeAvatarRendering(e,t){if(null==t||t.destroy(),e)return new nm({element:this.element})}}Zp.initClass(),Zp._$name="ResourcesCombo";class Jp extends Gp{static $name="SwimlaneCombo";static type="swimlanecombo";changeStore(){return this.taskBoard.swimlanes.chain()}}Jp.initClass(),Jp._$name="SwimlaneCombo";class Qp extends Sh{static $name="TaskColorPicker";static type="taskcolorpicker";static configurable={colorClasses:[{color:"red",text:"Red"},{color:"pink",text:"Pink"},{color:"purple",text:"Purple"},{color:"deep-purple",text:"Deep purple"},{color:"indigo",text:"Indigo"},{color:"blue",text:"Blue"},{color:"light-blue",text:"Light blue"},{color:"cyan",text:"Cyan"},{color:"teal",text:"Teal"},{color:"green",text:"Green"},{color:"light-green",text:"Light green"},{color:"lime",text:"Lime"},{color:"yellow",text:"Yellow"},{color:"amber",text:"Amber"},{color:"orange",text:"Orange"},{color:"deep-orange",text:"Deep orange"}],colorClassPrefix:"b-taskboard-background-color-",colors:null}}Qp.initClass(),Qp._$name="TaskColorPicker";class ef extends wh{static $name="TaskColorCombo";static type="taskcolorcombo";static configurable={picker:{type:"taskcolorpicker"},name:"eventColor",clearable:!0}}ef.initClass(),ef._$name="TaskColorCombo";class tf extends(Uc.mixin(Kp)){static $name="TaskEditor";static type="taskboardtaskeditor";static configurable={centered:!0,modal:{closeOnMaskTap:!0},closable:!0,autoUpdateRecord:!0,autoUpdateFields:!0,saveAndCloseOnEnter:!0,draggable:{handleSelector:".b-panel-header"},autoShow:!1,anchor:!0,closeAction:"destroy",scrollAction:"realign",title:"L{TaskBoard.editTask}",defaults:{labelWidth:"30%"},width:"30em",items:{name:{type:"text",label:"L{TaskBoard.name}",weight:100},description:{type:"textarea",label:"L{TaskBoard.description}",height:"5em",weight:200},resources:{type:"resourcescombo",label:"L{TaskBoard.resources}",weight:300},color:{type:"taskcolorcombo",label:"L{TaskBoard.color}",name:"eventColor",weight:400},column:{type:"columncombo",weight:500},swimlane:{type:"swimlanecombo",weight:600}},bbar:{hidden:!0,items:{saveButton:{text:"L{TaskBoard.save}",onClick:"up.onSaveClick",weight:100},cancelButton:{text:"L{TaskBoard.cancel}",onClick:"up.onCancelClick",weight:200}}},maximizeOnMobile:!0};changeItems(e,t){const{taskBoard:n}=this,{column:r,swimlane:s,resources:i}=e;return n?(r&&(r.name||(r.name=n.columnField),r.label||(r.label=T.capitalize(n.columnField))),s&&(n.swimlaneField&&n.swimlanes?(s.name||(s.name=n.swimlaneField),s.label||(s.label=T.capitalize(n.swimlaneField))):e.swimlane=null),n.project.resourceStore.count||(e.resources=null),n.project.eventStore.usesSingleAssignment&&i&&(i.multiSelect=!1)):e.column=e.swimlane=e.resources=null,super.changeItems(e,t)}processItemsObject(e,t,n){for(const t in e){const n=e[t];n&&!("name"in n)&&(n.name=t)}return super.processItemsObject(e,t,n)}updateAutoUpdateRecord(e){this.bbar.hidden=e}updateRecord(e){super.updateRecord(e),e&&(this.element.dataset.taskId=e.id)}onSaveClick(){const e=this,{record:t,owner:n}=e,{resources:r,...s}=e.values;if(e.isValid){if(!1===(null==n?void 0:n.trigger("beforeSave",{record:t,values:e.values,editor:e})))return;null==n||n.trigger("save",{record:t,values:e.values,editor:e}),e.close(),t.set(s),r&&(t.resources=r)}}onCancelClick(){var e,t;const n=this;!1!==(null===(e=n.owner)||void 0===e?void 0:e.trigger("beforeCancel",{editor:n}))&&(null===(t=n.owner)||void 0===t||t.trigger("cancel",{editor:n}),n.close())}onInternalKeyDown(e){const t=this;t.saveAndCloseOnEnter&&!t.readOnly&&"Enter"===e.key&&(e.preventDefault(),t.autoUpdateRecord?t.isValid&&(e.target.blur(),t.close()):t.onSaveClick()),super.onInternalKeyDown(e)}}tf.initClass(),tf._$name="TaskEditor";class nf extends Fp{static $name="TaskEdit";static type="taskEdit";static configurable={editorType:"taskboardtaskeditor",editorConfig:{},items:{},processItems:null};editor=null;static pluginConfig={assign:["editTask"],chain:["onActivateTask","populateTaskMenu"]};doDestroy(){var e;null===(e=this.editor)||void 0===e||e.destroy()}changeEditorConfig(e){return Ut.assertObject(e,"features.taskEdit.editorConfig"),e}changeEditorType(e){return Ut.assertString(e,"features.taskEdit.editorType"),e}changeItems(e){return Ut.assertObject(e,"features.taskEdit.items"),e}changeProcessItems(e){return Ut.assertFunction(e,"features.taskEdit.processItems"),e}async editTask(e,t=null){var n,s;const i=this,{client:a}=i,o=a.getColumn(e),l=a.swimlaneField&&(null===(n=a.swimlanes)||void 0===n?void 0:n.getById(e.getValue(a.swimlaneField)));if(i.disabled)return;if(!1===await a.trigger("beforeTaskEdit",{taskRecord:e}))return;i.isEditing&&i.cancelEdit();const c=il.resolveType(i.editorType),d=c.mergeConfigs(c.$meta.config.items,i.items);if(!1===(null===(s=i.processItems)||void 0===s?void 0:s.call(i,{items:d,taskRecord:e,columnRecord:o,swimlaneRecord:l})))return;const u=i.editor=c.new({items:d,owner:a,readOnly:e.readOnly},i.editorConfig);a.trigger("beforeTaskEditShow",{taskRecord:e,editor:u}),u.record=e,u.centered||!r.isHoverableDevice?u.show():(Io.scrollIntoView(t??a.getTaskElement(e)),u.showBy(t??a.getTaskElement(e))),u.isVisible&&u.ion({hide:i.onEditorHide,thisObj:i})}cancelEdit(){}onActivateTask({taskRecord:e,event:t}){t.defaultPrevented||this.editTask(e)}populateTaskMenu({items:e,taskRecord:t}){this.client.readOnly||this.disabled||(e.editTask={text:"L{TaskBoard.editTask}",icon:"b-fw-icon b-icon-edit",weight:100,onItem:()=>this.editTask(t),disabled:t.readOnly})}onEditorHide(){var e;null===(e=this.client.getTaskElement(this.editor.record))||void 0===e||e.focus()}}nf.initClass(),nf._$name="TaskEdit";class rf extends Jc{static $name="TaskMenu";static type="taskMenu";static configurable={processItems:null,items:null,type:"task",triggerEvent:"taskContextMenu",showAvatars:{value:!0,$config:"nullify"},menu:{align:"t90-b90",anchor:!0}};static get pluginConfig(){const e=super.pluginConfig;return e.chain.push("populateTaskMenu"),e}changeItems(e){return Ut.assertObject(e,"features.taskMenu.items"),e}changeProcessItems(e){return Ut.assertFunction(e,"features.taskMenu.processItems"),e}updateTriggerEvent(e){this.detachListeners("triggerEvent"),e&&this.client.ion({name:"triggerEvent",[e]:"onTriggerEvent",thisObj:this})}doDisable(e){super.doDisable(e),!this.isConfiguring&&this.client.recompose()}onTriggerEvent({event:e}){this.internalShowContextMenu(e)}showMenuFor(e,t=".b-taskboard-task-menu"){const n=this.client.getTaskElement(e),r=n.querySelector(t),s={taskRecord:e,columnRecord:this.client.getColumn(e),targetElement:n};let i=null;r&&(s.targetElement=r,i={target:r}),this.showContextMenu(s,i)}showContextMenu(e,...t){this.client.isSelected(e.taskRecord)||this.client.selectTask(e.taskRecord),super.showContextMenu(e,...t)}getDataFromEvent(e){return Ut.assign(super.getDataFromEvent(e),e.taskBoardData)}populateTaskMenu({items:e,taskRecord:t}){const{client:n,disabled:r}=this;if(!n.readOnly&&!r){var s;const{columnField:r,swimlaneField:i,selectedTasks:a}=n,{resourceStore:o,eventStore:l}=n.project,c=a.includes(t);e.column={text:`L{TaskBoard.changeColumn} ${r}`,icon:"b-fw-icon b-icon-move-left-right",weight:300,disabled:t.readOnly,menu:n.columns.map((e=>({ref:e.id,text:T.encodeHtml(e.text),cls:"b-column-menu-item",isColumn:!0,checked:t.getValue(r)===e.id,closeParent:!0}))),onItem({item:e}){e.isColumn&&(t.setValue(r,e.ref),e.parent.items.forEach((t=>{t!==e&&(t.checked=!1)})))}},null!==(s=n.swimlanes)&&void 0!==s&&s.count&&i&&(e.swimlane={text:T.xss`L{TaskBoard.changeSwimlane} ${i}`,icon:"b-fw-icon b-icon-move-up-down",weight:400,disabled:t.readOnly,menu:n.swimlanes.map((e=>({ref:e.id,text:T.encodeHtml(e.text),isSwimlane:!0,checked:t.getValue(i)===e.id,closeParent:!0}))),onItem({item:e}){e.isSwimlane&&(t.setValue(i,e.ref),e.parent.items.forEach((t=>{t!==e&&(t.checked=!1)})))}}),o.count&&(e.resources={text:"L{TaskBoard.resources}",icon:"b-fw-icon b-icon-user",weight:200,disabled:t.readOnly,menu:o.map((e=>{var r;const s=null===(r=this.avatarRendering)||void 0===r?void 0:r.getResourceAvatar({resourceRecord:e,initials:e.initials,color:e.color,iconCls:e.iconCls,imageUrl:e.imageUrl||(n.resourceImagePath||"")+(e.image||"")});return{ref:e.id,cls:"b-resource-menu-item",text:s?{className:"b-resource-menu-item-inner",children:[s,T.encodeHtml(e.name)]}:T.encodeHtml(e.name),resource:e,checked:t.resources.includes(e),toggleGroup:l.usesSingleAssignment?"single":null}})),onItem({item:e}){e.resource&&t[e.checked?"assign":"unassign"](e.resource)}}),e.removeTask={text:c&&a.length>1?"L{TaskBoard.removeTasks}":"L{TaskBoard.removeTask}",icon:"b-fw-icon b-icon-trash",cls:"b-separator",weight:500,disabled:t.readOnly,onItem:()=>n.removeTask(c?a:t)}}}get showMenu(){return!0}updateShowAvatars(e){var t;null===(t=this.avatarRendering)||void 0===t||t.destroy(),e&&(this.avatarRendering=new nm({element:this.client.element}))}}Fp.register(rf.type,rf),rf._$name="TaskMenu";class sf extends Fp{static $name="TaskTooltip";static type="taskTooltip";static configurable={tooltip:{value:{},$config:["lazy","nullify"]},template:null};static pluginConfig={chain:["render"]};changeTemplate(e){return Ut.assertFunction(e,"features.taskTooltip.template"),e}doDisable(e){super.doDisable(e),this._tooltip&&(this.tooltip.disabled=e)}changeTooltip(e,t){const n=this,{client:r}=n;if(Ut.assertObject(e,"features.taskTooltip.tooltip"),null==t||t.destroy(),e)return new Xu(Ut.assign({axisLock:"flexible",cls:"b-taskboard-tooltip",forSelector:".b-taskboardbase:not(.b-draghelper-active) .b-taskboard-card",scrollAction:"realign",forElement:r.element,showOnHover:!0,hoverDelay:0,hideDelay:100,anchorToTarget:!0,allowOver:Boolean(n.config.items||n.config.tools),getHtml:n.getTipHtml.bind(n),disabled:n.disabled,textContent:!1},e))}getTipHtml({tip:e,activeTarget:t}){const{client:n}=this,r=n.resolveTaskRecord(t),s=n.resolveColumnRecord(t),i=n.resolveSwimlaneRecord(t);if(this.template)return this.template({tip:e,taskRecord:r,columnRecord:s,swimlaneRecord:i,activeTarget:t});const a=[{class:"b-taskboard-tooltip-title",text:r.name},{class:"b-taskboard-tooltip-label",text:T.capitalize(n.columnField)},{class:"b-taskboard-tooltip-value",text:s.text}];return i&&a.push({class:"b-taskboard-tooltip-label",text:T.capitalize(n.swimlaneField)},{class:"b-taskboard-tooltip-value",text:i.text}),r.resources.length&&a.push({class:"b-taskboard-tooltip-label",text:this.L("L{TaskBoard.resources}")},{class:"b-taskboard-tooltip-value",text:r.resources.map((e=>e.name)).join(", ")}),{children:a}}render(){this.getConfig("tooltip")}}sf.initClass(),sf._$name="TaskTooltip";class af extends Ns{static $name="ColumnModel";static fields=["text","tooltip",{name:"color",type:"string"},"tasksPerRow",{name:"collapsible",type:"boolean",defaultValue:!0},{name:"collapsed",type:"boolean"},{name:"hidden",type:"boolean"},{name:"width",type:"number"},{name:"flex",type:"number"},{name:"minWidth",type:"number"}];get tasks(){return this.taskBoard.getColumnTasks(this,!0)}get taskBoard(){return this.firstStore.taskBoard}async collapse(){return this.taskBoard.collapse(this)}async expand(){return this.taskBoard.expand(this)}}af._$name="ColumnModel";var of=e=>class extends(e||Ns){static $name="ProjectModelCommon";static get configurable(){return{assignments:null,dependencies:null,resources:null,timeRanges:null}}static get autoExposeFields(){return!1}get assignments(){return this.assignmentStore.allRecords}updateAssignments(e){this.assignmentStore.data=e}get dependencies(){return this.dependencyStore.allRecords}updateDependencies(e){this.dependencyStore.data=e}get resources(){return this.resourceStore.allRecords}updateResources(e){this.resourceStore.data=e}get timeRanges(){return this.timeRangeStore.allRecords}getTimeRanges(e,t){const n=this.timeRangeStore,r=[];for(const s of n)s.isRecurring?r.push(...s.getOccurrencesForDateRange(e,t)):s.startDate<t&&e<s.endDate&&r.push(s);return r}updateTimeRanges(e){this.timeRangeStore.data=e}getResourceTimeRanges(e,t){const n=this.resourceTimeRangeStore,r=[];for(const s of n)s.isRecurring?r.push(...s.getOccurrencesForDateRange(e,t)):s.startDate<t&&(!s.endDate||e<s.endDate)&&r.push(s);return r}};const lf={startDate:1,endDate:1,constraintDate:1,deadlineDate:1};var cf=e=>class extends e{static $name="TimeZonedDatesMixin";static fields=[{name:"timeZone",persist:!1}];get timeZone(){return this.getData("timeZone")}set timeZone(e){this.setData("timeZone",e)}setLocalDate(e,t){const n=this;n.set(e,null!=n.timeZone?Dd.toTimeZone(t,n.timeZone):t,!0),n.setData(e,n[e])}getLocalDate(e){return null!=this.timeZone&&this[e]?Dd.fromTimeZone(this[e],this.timeZone):this[e]}applyChangeset(e){if(null!=this.timeZone)for(const t in lf)e[t]&&(this.setLocalDate(t,new Date(e[t])),delete e[t]);return super.applyChangeset(...arguments)}getFieldPersistentValue(e){if(null!=this.timeZone){const t=(null==e?void 0:e.field)??(null==e?void 0:e.name)??e;if(lf[t])return this.getLocalDate(t)}return super.getFieldPersistentValue(e)}convertToTimeZone(e){const t=this,n={...t.meta.modified},r={...lf};t.isTask&&!t.manuallyScheduled&&(delete r.startDate,delete r.endDate);for(const e in r)null!=t[e]?(r[e]=t[e],null!=t.timeZone&&(r[e]=t.getLocalDate(e),n[e]&&(n[e]=Dd.fromTimeZone(n[e],t.timeZone)))):delete r[e];t.timeZone=e;for(const e in r)t.setLocalDate(e,r[e],!1),r[e]=1,null!=t.timeZone&&n[e]&&(n[e]=Dd.toTimeZone(n[e],t.timeZone));t.clearChanges(!0,!0,r),Ut.isEmpty(n)||(t.meta.modified=n,t.stores.forEach((e=>e.modified.add(t))))}};class df extends(Ns.mixin(cf)){static $name="TimeSpan";static fields=[{name:"startDate",type:"date"},{name:"endDate",type:"date"},{name:"duration",type:"number",allowNull:!0,internal:!0},{type:"durationunit",name:"durationUnit",defaultValue:"d",internal:!0},{name:"fullDuration",persist:!1,column:{type:"duration"},useProp:!0},{name:"cls",defaultValue:"",internal:!0},{name:"iconCls",internal:!0},{name:"style",type:"object",internal:!0},{name:"name",type:"string",defaultValue:""}];construct(e,...t){const n=this;if(null!=e&&e.fullDuration){const{magnitude:t,unit:n}=e.fullDuration;e.duration=t,e.unit=n,delete e.fullDuration}super.construct(e,...t),n.normalize(),n.startDateMS&&n.endDateMS&&n.startDateMS>n.endDateMS&&console.error(`startDate > endDate for ${n.constructor.$name} record with id: ${n.id}`)}internalCalculateStartDate(e,t,n){return Bt.add(e,-t,n)}internalCalculateEndDate(e,t,n){return Bt.add(e,t,n)}internalCalculateDuration(e,t,n){return Bt.as(n,Bt.diff(e,t,"h"),"h")}internalNormalize(e,t,n,r){const s=this,i=null!=n;e&&t&&!i?s.setData("duration",s.internalCalculateDuration(e,t,r)):e&&!t&&i?s.setData("endDate",s.internalCalculateEndDate(e,n,r)):!e&&t&&i&&s.setData("startDate",s.internalCalculateStartDate(t,n,r))}normalize(){this.internalNormalize(this.startDate,this.endDate,this.duration,this.durationUnit||this.constructor.defaultValues.durationUnit)}get eventStore(){const e=this;if(e.isOccurrence)return e.recurringTimeSpan.eventStore;var t;e._eventStore||(e._eventStore=null===(t=e.stores)||void 0===t?void 0:t.find((e=>e.isEventStore)));return e._eventStore}updateInternalCls(e){this._cls?this._cls.value=e:this._cls=new Sn(e)}set internalCls(e){this.updateInternalCls(e),this.set("cls",this._cls.value)}get internalCls(){const{cls:e}=this;return null!=e&&e.isDomClassList?e:(this.updateInternalCls(e),this.setData("cls",this._cls.value),this._cls)}get cls(){return this._cls||(this._cls=new Sn(super.get("cls"))),this._cls}set cls(e){this.internalCls=e}get startDate(){return this.get("startDate")}set startDate(e){this.setStartDate(e)}get endDate(){return this.get("endDate")}set endDate(e){this.setEndDate(e)}get endingDate(){const e=this,{endDate:t,startDate:n}=e;return t||Bt.add(n,e.duration,e.durationUnit)}get duration(){return this.get("duration")}set duration(e){this.setDuration(e,this.durationUnit)}get durationUnit(){return this.get("durationUnit")}setDuration(e,t=this.durationUnit){e=parseFloat(e),this.set({duration:e,durationUnit:t,...this.updateDatesFromDuration(e,t)})}updateDatesFromDuration(e,t,n=this.startDate,r=this.endDate){const s={};return n?s.endDate=this.internalCalculateEndDate(n,e,t):r&&(s.startDate=this.internalCalculateStartDate(r,e,t)),s}getDurationInUnit(e,t){const n=this;return n.startDate&&n.endDate?Bt.getDurationInUnit(n.startDate,n.endDate,e,t):Bt.as(e,n.duration,n.durationUnit)}get fullDuration(){return new js({unit:this.durationUnit,magnitude:this.duration})}set fullDuration(e){"string"==typeof e&&(e=Bt.parseDuration(e,!0,this.durationUnit)),this.setDuration(e.magnitude,e.unit)}setStartDate(e,t=!0){const n=this,r={startDate:e};if(e){let s;if(t)s=null!=n.duration;else if(n.endDate){if(r.duration=n.internalCalculateDuration(e,n.endDate,n.durationUnit),r.duration<0)throw new Error("Negative duration")}else s=null!=n.duration;s&&(r.endDate=n.internalCalculateEndDate(e,n.duration,n.durationUnit))}else r.duration=null;n.set(r)}setEndDate(e,t=!1){const n=this,r={endDate:e};if(e){let s;if(!0===t)s=null!=n.duration;else if(n.startDate){if(r.duration=n.internalCalculateDuration(n.startDate,e,n.durationUnit),r.duration<0)throw new Error("Negative duration")}else s=null!=this.duration;s&&(r.startDate=n.internalCalculateStartDate(e,n.duration,n.durationUnit))}n.set(r)}setStartEndDate(e,t,n){if(e>t)throw new Error("Start date must be less or equal to end date");this.set({startDate:e,endDate:t},null,n)}get dates(){const e=[],t=Bt.startOf(this.startDate,"day"),n=this.endDate;for(let r=t;r<n;r=Bt.add(r,1,"day"))e.push(r);return e}get startDateMS(){var e;return null===(e=this.batching&&this.hasBatchedChange("startDate")?this.get("startDate"):this.startDate)||void 0===e?void 0:e.getTime()}get endDateMS(){var e;return null===(e=this.batching&&this.hasBatchedChange("endDate")?this.get("endDate"):this.endDate)||void 0===e?void 0:e.getTime()}get durationMS(){const{endDateMS:e,startDateMS:t}=this;return e&&t?e-t:Bt.asMilliseconds(this.duration||0,this.durationUnit)}get isMilestone(){return 0===this.duration}inSetNormalize(e){if("string"!=typeof e){let{startDate:t,endDate:n,duration:r,durationUnit:s=this.durationUnit}=e;"string"==typeof t&&(t=this.getFieldDefinition("startDate").convert(t)),"string"==typeof n&&(n=this.getFieldDefinition("endDate").convert(n)),"duration"in e?(t&&!n&&(n=this.internalCalculateEndDate(t,r,s)),!t&&n&&(t=this.internalCalculateStartDate(n,r,s))):t&&n&&(r=this.internalCalculateDuration(t,n,s));const i=Object.isFrozen(e)?Ut.clone(e):e;return t&&(i.startDate=t),n&&(i.endDate=n),null!=r&&(i.duration=r),i}}fieldToKeys(e,t){const n=super.fieldToKeys(e,t);if(n.fullDuration){const{magnitude:e,unit:t}=n.fullDuration;n.duration=e,n.durationUnit=t}return this.isEventModel||this.isTaskModel||!("duration"in n)&&!n.durationUnit||n.startDate&&n.endDate||Object.assign(n,this.updateDatesFromDuration(n.duration??this.duration,n.durationUnit??this.durationUnit,n.startDate,n.endDate)),n}inSet(e,t,n,r,s,i,a){var o;const l=this;s||(e=l.inSetNormalize(e)||e);const c=super.inSet(e,t,n,r,s,i,a);if((null===(o=l.project)||void 0===o||!o.isWritingData)&&e.startDate&&e.endDate){let t;e.startDate instanceof Date&&e.endDate instanceof Date?t=e.startDate>e.endDate:l.fieldMap.startDate.convert(e.startDate)>l.fieldMap.endDate.convert(e.endDate)&&(t=!0),t&&console.error(`startDate > endDate for ${l.constructor.$name} record with id: ${l.id}`)}return c}applyValue(e,t,n,r,s){"cls"===t&&this.updateInternalCls(n),super.applyValue(e,t,n,r,s)}forEachDate(e,t){return this.dates.forEach(e.bind(t))}get isScheduled(){const{startDateMS:e,endDateMS:t}=this;return t-e>=0}get isValid(){const{startDate:e,endDate:t}=this;return!e||!t||t-e>=0}shift(e,t=this.durationUnit){if("string"==typeof e){const n=e;e=t,t=n}return this.setStartDate(Bt.add(this.startDate,e,t,!0),!0)}get wbsCode(){return this._wbsCode||this.indexPath.join(".")}set wbsCode(e){this._wbsCode=e}fullCopy(){return this.copy.apply(this,arguments)}intersects(e){return this.intersectsRange(e.startDate,e.endDate)}intersectsRange(e,t){const n=this.startDate,r=this.endDate;return n&&r&&Bt.intersectSpans(n,r,e,t)}split(e=.5){const t=this,n=t.copy(),{fullDuration:r,eventStore:s,assignmentStore:i}=t,a=new js(r),o=new js(r);let l,c;return"string"==typeof e?(l=new js(e),l.unit===a.unit?o.magnitude-=l.magnitude:(o.magnitude=Bt.as(l.unit,a)-l.magnitude,o.unit=l.unit,c=!0)):(l=new js(e>1?e:t.duration*e,t.durationUnit),o.magnitude-=l.magnitude),n.startDate=Bt.add(t.startDate,l.magnitude,l.unit),c?(n.fullDuration=o,t.fullDuration=l):(n.duration=o.magnitude,t.duration=l.magnitude),s&&(s.add(n),i&&!s.usesSingleAssignment&&i.add(t.assignments.map((e=>{const t=Object.assign({},e.data,{eventId:n.id,event:null,resource:null});return delete t.id,t})))),n}toICSString(e={}){if(!this.isScheduled)return"";const{startDate:t,endDate:n}=this,r=e.DTSTAMP||Bt.format(new Date,"uu");delete e.DTSTAMP;let s={};s=this.allDay?{"DTSTART;VALUE=DATE":Bt.format(t,"u"),"DTEND;VALUE=DATE":Bt.format(n,"u")}:{DTSTART:Bt.format(t,"uu"),DTEND:Bt.format(n,"uu")};const i={BEGIN:"VCALENDAR",VERSION:"2.0",CALSCALE:"GREGORIAN",PRODID:`-//Bryntum AB//Bryntum Scheduler ${P.scheduler&&P.getVersion("scheduler")||P.calendar&&P.getVersion("calendar")||""} //EN`,END:"VCALENDAR"},a={BEGIN:"VEVENT",UID:this.id+"@bryntum.com",CLASS:"PUBLIC",SUMMARY:this.name,DTSTAMP:r,...s,...this.recurrenceRule?{RRULE:this.recurrenceRule}:{},...e,END:"VEVENT"},o=Object.keys(i).map((e=>`${e}:${i[e]}`)),l=Object.keys(a).map((e=>`${e}:${a[e]}`));return o.splice(o.length-1,0,...l),o.join("\n")}exportToICS(e){if(this.isScheduled){const t=new Blob([this.toICSString(e)],{type:"text/calendar"});r.downloadBlob(t,(this.name||"Event")+".ics")}}isEditable(e){return!!this.getFieldDefinition(e)||void 0}isFieldModified(e){return"fullDuration"===e?super.isFieldModified("duration")||super.isFieldModified("durationUnit"):super.isFieldModified(e)}}df._$name="TimeSpan";const uf=/^([+-]?[0-9])?(SU|MO|TU|WE|TH|FR|SA)$/,hf=["SU","MO","TU","WE","TH","FR","SA"];class gf extends ue{static decodeDay(e){let t,n;return(t=uf.exec(e))&&(n=[hf.indexOf(t[2])],t[1]&&(t[1]=parseInt(t[1],10),n.push(t[1]))),n}static encodeDay(e){let t;return Array.isArray(e)&&([e,t]=e),(t?t.toString():"")+hf[e]}static decode(e){const t=[];let n;if(e)for(let r=0;r<e.length;r++)(n=this.decodeDay(e[r]))&&t.push(n);return t}static encode(e){const t=[];let n;if(e)for(let r=0;r<e.length;r++)(n=this.encodeDay(e[r]))&&t.push(n);return t}}gf._$name="RecurrenceDayRuleEncoder";const mf=/ly$/i,pf=e=>{const t=e.replace(mf,"");return"DAI"===t?"DAY":t},ff=(e,t,n,r)=>r.buildOccurrence(e,n),vf=e=>yf=e;let yf;class bf extends ue{static frequency="NONE";static MAX_OCCURRENCES_COUNT=1e6;static processIterationConfig(e){var t;const{recurrence:n}=e,{frequency:r,interval:s,timeSpan:i,endDate:a,count:o}=n;if(!e.syncingStartDate&&!i.meta.isSyncedWithRule){const t=Bt.add(i.startDate,s,pf(r)),a=Bt.min(t,e.endDate||t);this.forEachDate({syncingStartDate:!0,startDate:i.startDate,endDate:a,recurrence:n,fn:ff})}const l=i.startDate;let{startDate:c=l,endDate:d=a}=e;c<l&&(c=l),a?(!d||d>a)&&(d=a):o&&c>l&&(this.forEachDate({recurrence:n,fn:vf}),(!d||d>yf)&&(d=new Date(yf.getTime()+1)));const u=c;return e.startOnly||(c=new Date(Bt.max(Bt.add(c,-s,pf(r)),l))),Object.assign({extraArgs:[],startOnly:!Boolean(i.durationMS)},e,{startDate:c,endDate:d,timeSpan:i,timeSpanStart:l,earliestVisibleDate:u,endDateMS:null===(t=d)||void 0===t?void 0:t.getTime(),timeSpanStartMS:l.getTime(),earliestVisibleDateMS:u.getTime(),durationMS:i.durationMS,spansStart:c<=l&&d>l})}static getOccurrenceIndex(e){if(e.isOccurrence)return Bt.diff(e.recurringTimeSpan.startDate,e.startDate,pf(e.recurringTimeSpan.recurrence.frequency))}static getNthDayInPeriod(e,t,n,r){let s,i,a;if(r){r>0?(i=1,a=e):(i=-1,a=t);const o=n-a.getDay();i*o<0&&(r+=i),s=new Date(a),s.setDate(a.getDate()+7*(r-i)+o),(s<e||s>t)&&(s=null)}return s}static buildDate(e,t,n){const r=new Date(e,t,n);if(r.getFullYear()===e&&r.getMonth()===t&&r.getDate()===n)return r}static isValidPosition(e){return Boolean(e)}static forEachDateAtPositions(e,t,n,r){const s=e.length,i={};for(let a=0;a<t.length;a++){const o=t[a];if(this.isValidPosition(o)){const t=o>0?e[o-1]:e[s+o];if(t&&!i[t.getTime()]&&(i[t.getTime()]=!0,!1===n.call(r,t)))return!1}}}static isInView(e,t,n,r,s){return(e?t>=n:t.valueOf()+r>n)&&!s.hasException(t)}static isInViewMS(e,t,n,r,s,i){return(e?n>=r:n+s>r)&&!i.hasException(t)}}bf._$name="AbstractRecurrenceIterator";class Cf extends bf{static frequency="DAILY";static forEachDate(e){const{startOnly:t,startDate:n,endDate:r,endDateMS:s,timeSpan:i,timeSpanStart:a,earliestVisibleDateMS:o,durationMS:l,spansStart:c,recurrence:d,fn:u,extraArgs:h,scope:g=this}=this.processIterationConfig(e),{interval:m}=d,p=n-a,f=864e5*m,v=Math.floor(p/f);let{count:y}=d,b=0,C=Bt.add(a,v*m,"day"),S=C.getTime();for(r||y||(y=this.MAX_OCCURRENCES_COUNT);!s||S<s;){if(b++,this.isInViewMS(t,C,S,o,l,i)&&(s&&S>s||!1===u.apply(g,[C,b,1===b&&c,i,...h])||y&&b>=y))break;C=Bt.add(C,m,"day"),S=C.getTime()}}}Cf._$name="DailyRecurrenceIterator";class Sf extends bf{static frequency="WEEKLY";static forEachDate(e){var t;const{startOnly:n,startDate:r,endDateMS:s,timeSpan:i,timeSpanStart:a,timeSpanStartMS:o,earliestVisibleDateMS:l,durationMS:c,spansStart:d,recurrence:u,fn:h,extraArgs:g,scope:m=this}=this.processIterationConfig(e),{interval:p,days:f}=u,{weekStartDay:v}=Bt,y=a.getHours(),b=a.getMinutes(),C=a.getSeconds(),S=a.getMilliseconds();let w,D,T=0,{count:E}=u,x=gf.decode(f);if(null!==(t=x)&&void 0!==t&&t.length||(x=[[a.getDay()]]),v>0)for(let e=0;e<x.length;e++)v>x[e][0]?x[e][0]=7-v-x[e][0]:x[e][0]-=v;for(x.sort(((e,t)=>e[0]-t[0])),w=Bt.getNext(E||p>1?a:r,"week",0),s||E||(E=this.MAX_OCCURRENCES_COUNT);!s||w.getTime()<s;){for(let e=0;e<x.length;e++){D=new Date(w.getFullYear(),w.getMonth(),w.getDate()+x[e][0],y,b,C,S);const t=D.getTime();if(t>=o){if(T++,this.isInViewMS(n,D,t,l,c,i)&&(s&&t>=s||!1===h.apply(m,[D,T,1===T&&d,i,...g])||E&&T>=E))return}}w=Bt.getNext(w,"week",p)}}}Sf._$name="WeeklyRecurrenceIterator";class wf extends bf{static frequency="MONTHLY";static getNthDayOfMonth(e,t){const n=Bt.daysInMonth(e);let r=null;return t&&Math.abs(t)<=n&&(r=new Date(e.getFullYear(),e.getMonth(),t<0?n+t+1:t)),r}static isValidPosition(e){return e&&Math.abs(e)>0&&Math.abs(e)<=31}static forEachDate(e){const{startOnly:t,startDate:n,endDate:r,timeSpan:s,timeSpanStart:i,earliestVisibleDate:a,durationMS:o,spansStart:l,recurrence:c,fn:d,extraArgs:u,scope:h=this}=this.processIterationConfig(e),{interval:g,days:m,count:p,positions:f}=c,v=gf.decode(m),y=f&&f.length,b={};let C,S,w,D,T,E,{monthDays:x}=c,k=0;for(S=Bt.startOf(p||g>1?i:n,"month"),w=new Date(Bt.getNext(S,"month",1)-1),x&&x.length||v&&v.length||(x=[i.getDate()]),v&&v.length&&v.forEach((e=>{e[1]&&(C=C||{},C[e[0]]=e[1])}));(!r||r>S)&&(!p||k<p);){if(D=[],v&&v.length){if(v.forEach((e=>{const t=e[0];let n=1,r=53;for(e[1]&&(n=r=e[1]),E=n;E<=r;E++)(T=this.getNthDayInPeriod(S,w,t,E))&&(T=Bt.copyTimeValues(T,i),b[T.getTime()]||(b[T.getTime()]=!0,D.push(T)))})),D.sort(((e,t)=>e-t)),!y)for(E=0;E<D.length;E++)if(T=D[E],T>=i){const e=this.isInView(t,T,a,o,s);if(k++,e&&(r&&T>=r||!1===d.apply(h,[T,k,1===k&&l,s,...u])||p&&k>=p))return!1}}else{const e=[];for(E=0;E<x.length;E++)(T=this.getNthDayOfMonth(S,x[E]))&&!b[T.getTime()]&&(b[T.getTime()]=!0,e.push(T));for(e.sort(((e,t)=>e-t)),E=0;E<e.length;E++)if(T=Bt.copyTimeValues(e[E],i),y)D.push(T);else if(T>=i){const e=this.isInView(t,T,a,o,s);if(k++,e&&(r&&T>r||!1===d.apply(h,[T,k,1===k&&l,s,...u])||p&&k>=p))return}}y&&D.length&&this.forEachDateAtPositions(D,f,(e=>{if(e>=i){const n=t?e>=a:e.valueOf()+o>a&&!s.hasException(e);if(k++,n&&(!r||e<=r)&&(!1===d.apply(h,[e,k,1===k&&l,s,...u])||p&&k>=p))return!1}})),S=Bt.getNext(S,"month",g),w=new Date(Bt.getNext(S,"month",1)-1)}}}wf._$name="MonthlyRecurrenceIterator";class Df extends bf{static frequency="YEARLY";static forEachDate(e){const{startOnly:t,startDate:n,endDate:r,timeSpan:s,timeSpanStart:i,earliestVisibleDate:a,durationMS:o,spansStart:l,recurrence:c,fn:d,extraArgs:u,scope:h=this}=this.processIterationConfig(e),{interval:g,days:m,count:p,positions:f}=c,v=gf.decode(m),y=f&&f.length,b={};let C,S,w,D,T,E,{months:x}=c,k=0;for(D=Bt.startOf(p||g>1?i:n,"year"),T=new Date(Bt.getNext(D,"year",1)-1),x&&x.sort(((e,t)=>e-t)),x&&x.length||v&&v.length||(x=[i.getMonth()+1]),v&&v.length&&v.forEach((e=>{e[1]&&(E=E||{},E[e[0]]=e[1])}));(!r||r>D)&&(!p||k<p);){if(w=[],v&&v.length){if(v.forEach((e=>{const t=e[0];let n=1,r=53;for(e[1]&&(n=r=e[1]),C=n;C<=r;C++)(S=this.getNthDayInPeriod(D,T,t,C))&&(S=Bt.copyTimeValues(S,i),b[S.getTime()]||(b[S.getTime()]=!0,w.push(S)))})),w.sort(((e,t)=>e-t)),!y)for(C=0;C<w.length;C++)if(S=w[C],S>=i){const e=this.isInView(t,S,a,o,s);if(k++,e&&(r&&S>=r||!1===d.apply(h,[S,k,1===k&&l,s,...u])||p&&k>=p))return}}else for(C=0;C<x.length;C++)if((S=this.buildDate(D.getFullYear(),x[C]-1,i.getDate()))&&(S=Bt.copyTimeValues(S,i),!b[S.getTime()]))if(b[S.getTime()]=!0,y)w.push(S);else if(S>=i){const e=t?S>=a:S.valueOf()+o>a&&!s.hasException(S);if(k++,e&&(r&&S>=r||!1===d.apply(h,[S,k,1===k&&l,s,...u])||p&&k>=p))return}y&&w.length&&this.forEachDateAtPositions(w,f,(e=>{if(e>=i){const n=t?e>=a:e.valueOf()+o>a&&!s.hasException(e);if(k++,n&&(!r||e<r)&&(!1===d.apply(h,[e,k,1===k&&l,s,...u])||p&&k>=p))return!1}})),D=Bt.getNext(D,"year",g),T=new Date(Bt.getNext(D,"year",1)-1)}}}Df._$name="YearlyRecurrenceIterator";const Tf={};function Ef(e){return e?"string"==typeof e&&(e=e.split(",").map((e=>parseInt(e,10)))):e=null,e}function xf(e){return e?"string"==typeof e&&(e=e.split(",")):e=null,e}function kf(e,t){return String(e)===String(t)}function If(e){return this.defaultValue&&void 0===e?this.defaultValue:this.allowNull&&null==e?null:(e=parseInt(e),isNaN(e)?void 0:e)}[Cf,Sf,wf,Df].forEach((e=>{Tf[e.frequency]=e}));class Rf extends Ns{static get $name(){return"RecurrenceModel"}get isRecurrenceModel(){return!0}static get fields(){return[{name:"frequency",defaultValue:"DAILY"},{name:"interval",defaultValue:1,convert:If},{name:"endDate",type:"date"},{name:"count",allowNull:!0,convert:If},{name:"days",convert:xf,isEqual:kf},{name:"monthDays",convert:Ef,isEqual:kf},{name:"months",convert:Ef,isEqual:kf},{name:"positions",convert:Ef,isEqual:kf}]}get dateFormat(){return this._dateFormat||"YYYYMMDDTHHmmss"}set dateFormat(e){this._dateFormat=e}get recurrenceIterator(){return Tf[this.frequency]}get timeSpan(){return this._timeSpan}set timeSpan(e){this._timeSpan=e}get rule(){const e=this,t=[];return e.frequency&&(t.push(`FREQ=${e.frequency}`),e.interval>1&&t.push(`INTERVAL=${e.interval}`),e.days&&e.days.length&&t.push("BYDAY="+e.days.join(",")),e.monthDays&&e.monthDays.length&&t.push("BYMONTHDAY="+e.monthDays.join(",")),e.months&&e.months.length&&t.push("BYMONTH="+e.months.join(",")),e.count&&t.push(`COUNT=${e.count}`),e.endDate&&t.push("UNTIL="+Bt.format(e.endDate,e.dateFormat)),e.positions&&e.positions.length&&t.push("BYSETPOS="+e.positions.join(","))),t.join(";")}set rule(e){const t=this,n={frequency:null,interval:null,count:null,endDate:null,days:null,monthDays:null,months:null,positions:null};if(t.beginBatch(),e){const r=e.split(";");for(let e=0,s=r.length;e<s;e++){const s=r[e].split("="),i=s[1];switch(s[0]){case"FREQ":n.frequency=i;break;case"INTERVAL":n.interval=i;break;case"COUNT":n.count=i,n.until=null;break;case"UNTIL":n.endDate=i?Bt.parse(i,t.dateFormat):null,n.count=null;break;case"BYDAY":n.days=i;break;case"BYMONTHDAY":n.monthDays=i;break;case"BYMONTH":n.months=i;break;case"BYSETPOS":n.positions=i}}}t.set(n),e&&t.sanitize(),t.endBatch()}construct(e={}){const t=this,{rule:n,timeSpan:r}=e;t._suspendedTimeSpanNotifying=0,delete e.timeSpan,delete e.rule,super.construct(...arguments),n&&(t.suspendTimeSpanNotifying(),t.rule=n,t.resumeTimeSpanNotifying()),t.timeSpan=r}forEachOccurrence(e,t,n){this.timeSpan.startDate&&this.recurrenceIterator.forEachDate({recurrence:this,startDate:e,endDate:t,fn:(e,t,r,s)=>n(s.buildOccurrence(e,r),r,t,e)})}sanitize(){var e;const t=this,n=null===(e=t.timeSpan)||void 0===e?void 0:e.startDate,r={};switch(t.isSanitizing=!0,t.frequency){case"DAILY":r.positions=null,r.days=null,r.monthDays=null,r.months=null;break;case"WEEKLY":{r.positions=null,r.monthDays=null,r.months=null;const{days:e}=t;n&&1===(null==e?void 0:e.length)&&e[0]===gf.encodeDay(n.getDay())&&(r.days=null);break}case"MONTHLY":{var s;null!==(s=t.monthDays)&&void 0!==s&&s.length&&(r.positions=null,r.days=null),r.months=null;const{monthDays:e}=t;n&&1===(null==e?void 0:e.length)&&e[0]===n.getDate()&&(r.monthDays=null);break}case"YEARLY":{r.monthDays=null;const{months:e}=t;n&&1===(null==e?void 0:e.length)&&e[0]===n.getMonth()+1&&(r.months=null);break}}t.set(r),t.isSanitizing=!1}copy(...e){const t=super.copy(...e);return t.dateFormat=this.dateFormat,t.timeSpan=this.timeSpan,t}afterChange(e,t,n){const r=super.afterChange(e,t,n),{timeSpan:s}=this;return this.isSanitizing||this.sanitize(),s&&(s.sanitizeRecurrenceData(this),this.isTimeSpanNotifyingSuspended||s.onRecurrenceChanged()),r}set(e,t,...n){const r="object"==typeof e?e:{[e]:t};r.count?r.endDate=null:r.endDate&&(r.count=null),super.set(r,void 0,...n)}get isTimeSpanNotifyingSuspended(){return Boolean(this._suspendedTimeSpanNotifying)}suspendTimeSpanNotifying(){this._suspendedTimeSpanNotifying++}resumeTimeSpanNotifying(){this._suspendedTimeSpanNotifying&&this._suspendedTimeSpanNotifying--}}function Mf(e){const t={},{dateFormat:n}=this;return e&&(e="string"==typeof e?e.split(","):ge.asArray(e)).forEach((e=>{"string"==typeof e&&(e=Bt.parse(e,n)),isNaN(e)||(t[Bt.makeKey(e)]=1)})),t}function Of(e){const t=[],{dateFormat:n}=this;for(const r in e)e[r]&&t.push(Bt.format(Bt.parseKey(r),n));return t}Rf._$name="RecurrenceModel";const Af=[];var Ff=e=>class extends(e||df){static get $name(){return"RecurringTimeSpan"}get supportsRecurring(){return!0}static get fields(){return[{name:"recurrenceRule",internal:!0},{name:"exceptionDates",convert:Mf,serialize:Of,internal:!0}]}remove(){if(!this.isOccurrence)return super.remove(...arguments);{const e=this,{recurringTimeSpan:t}=e;e.cancelBatch(),t.beginBatch(),e.detachFromRecurringEvent(),t.endBatch()}}get eventStore(){var e,t;let n=this.isOccurrence&&(null===(e=this.recurringEvent)||void 0===e?void 0:e.eventStore)||super.eventStore;return!n&&null!==(t=this.firstStore)&&void 0!==t&&t.isRecurringTimeSpansMixin&&(n=this.firstStore),n}get recurrenceModel(){return this._recurrenceModel||Rf}set recurrenceModel(e){this._recurrenceModel=e}setRecurrence(e,t,n){const r=this;let s;e&&(e.isRecurrenceModel||("string"==typeof e&&(e={frequency:e},t&&(e.interval=t),n&&(n instanceof Date?e.endDate=n:e.count=n)),e=new r.recurrenceModel(e)),e.timeSpan=r,s=e.rule),r.recurrence=e,r.recurrenceRule=s}get recurrence(){const e=this,t=e.recurrenceRule;return!e._recurrence&&t&&(e._recurrence=new e.recurrenceModel({rule:t,timeSpan:e,id:`${e.id}-recurrence`})),e._recurrence}set recurrence(e){const t=this;t._recurrence=e,e?(e.timeSpan=t,t.recurrenceRule=e.rule):t.isOccurrence?t.setData("recurrenceRule",null):t.recurrenceRule=null}get isRecurring(){return Boolean(!this.isOccurrence&&this.recurrence)}get isOccurrence(){return Boolean(this.recurringTimeSpan)}get recurringTimeSpan(){return this._recurringTimeSpan}get isPersistable(){return super.isPersistable&&(!this.supportsRecurring||!this.isOccurrence)}set recurringTimeSpan(e){this._recurringTimeSpan=e}getOccurrencesForDateRange(e,t=e){return this.eventStore.getOccurrencesForTimeSpan(this,e,t)}get occurrences(){if(this.isRecurring){const e=[];return this.occurrenceMap.forEach((t=>{t!==this&&e.push(t)})),e}return Af}get occurrenceMap(){return this._occurrencesMap||(this._occurrencesMap=new Map)}removeOccurrence(e,t=this.eventStore){const n=e.isTimeSpan?e.occurrenceDate:e;null==t||t.globalOccurrences.delete(this.createRecurrenceKey(n)),this.occurrenceMap.delete(Bt.makeKey(n))}removeOccurrencesFrom(e){this.occurrenceMap.forEach(((t,n)=>{Bt.parseKey(n)>=e&&this.removeOccurrence(t)}))}removeOccurrences(e){[this,...this.occurrences].forEach((t=>this.removeOccurrence(t,e)))}onRecurrenceChanged(){var e;this.recurrenceRule=(null===(e=this.recurrence)||void 0===e?void 0:e.rule)||null}sanitizeRecurrenceData(e=this.recurrence){if(e.endDate){const t=Bt.clearTime(e.endDate),{exceptionDates:n}=this;if(this.removeOccurrencesFrom(t),n)for(const e in n){Bt.parseKey(e)>=t&&delete n[e]}}}get occurrenceDate(){var e;return(null===(e=this.meta.modified)||void 0===e?void 0:e.startDate)||this.startDate}get occurrenceIndex(){return bf.getOccurrenceIndex(this)}buildOccurrence(e,t){var n;const r=this,{occurrenceMap:s,recurrence:i,meta:a}=r,o=null===(n=r.eventStore)||void 0===n?void 0:n.globalOccurrences,l=Bt.makeKey(e),c=r.createRecurrenceKey(e,l),d=!(e-r.startDate),{fieldMap:u}=r.constructor;let h=null==o?void 0:o.get(c),{duration:g}=r;!r.endDate||!r.allDay&&g||(g=Bt.as(r.durationUnit,r.endDate.getTime()-r.startDate.getTime()));const m=void 0!==g?Bt.add(e,g,r.durationUnit):void 0;return h||(t||d?(h=r,d||(r.setStartEndDate(e,m,!0),i.suspendTimeSpanNotifying(),i.sanitize(),i.resumeTimeSpanNotifying()),a.isSyncedWithRule=!0):(h=r.copy({[u.id.dataSource]:c,[u.startDate.dataSource]:e,[u.endDate.dataSource]:m,[u.duration.dataSource]:g,constraintDate:null,constraintType:null},{creatingOccurrence:!0}),h.recurringTimeSpan=r),null==o||o.set(c,h),s.set(l,h)),h}createRecurrenceKey(e=this.startDate,t=null){return`_generated:${this.id}:${t||Bt.makeKey(e)}`}convertToRealEvent(e,t){var n;if(!this.isOccurrence)return;const r=this,{recurringTimeSpan:s,resource:i,occurrenceIndex:a,recurrence:o}=r,l=o&&s.recurrence.count,c=(null==e||null===(n=e.resourceRecords)||void 0===n?void 0:n.value)||r.data.newResource;s.beginBatch(),r.detachFromRecurringEvent(),r.clearChanges(),r.setData("id",r.generateId(s.eventStore)),c&&delete r.data.resourceId,s.eventStore.add(r,t),l&&(r.recurrence.count=l-a),(c||i)&&r.assign(c||i),c&&delete r.data.resourceRecords,e&&delete e.resourceRecords,s.endBatch()}afterChange(e,t,n,...r){const s=this,{eventStore:i}=s;return"recurrenceRule"in t&&(s._recurrence=null,null==i||i.recurringEvents[t.recurrenceRule.value?"add":"delete"](s)),s.isOccurrence?s.convertToRealEvent(t,n):"newExceptionDate"in t&&(s.meta.modified.exceptionDates=!0,delete s.meta.modified.newExceptionDate,s.removeOccurrence(t.newExceptionDate.value)),super.afterChange(e,t,n,...r)}detachFromRecurringEvent(){const e=this,{recurringTimeSpan:t,occurrenceDate:n,startDate:r}=e;e.recurringTimeSpan=null,t.addExceptionDate(n),e.recurrenceRule&&(t.recurrence.endDate=Bt.add(r,-1,"minute"))}set newExceptionDate(e){if(e){(this.exceptionDates||(this.exceptionDates={}))[Bt.makeKey(e)]=1}}addExceptionDate(e){return this.set({newExceptionDate:e})}hasException(e){var t;return null===(t=this.exceptionDates)||void 0===t?void 0:t[Bt.makeKey(e)]}};class Pf extends(df.mixin(Ff)){static $name="ResourceTimeRangeModel";static fields=["resourceId","timeRangeColor"];static relations={resource:{foreignKey:"resourceId",foreignStore:"resourceStore",relatedCollectionName:"timeRanges",nullFieldOnRemove:!0}};static domIdPrefix="resourcetimerange";get domId(){return`${this.constructor.domIdPrefix}-${this.id}`}get isResourceTimeRange(){return!0}get resources(){return this.resource?[this.resource]:[]}get $linkedResources(){return this.resources}}Pf._$name="ResourceTimeRangeModel";const Lf=Object.freeze([]);var $f=e=>class extends(e||ue){static get $name(){return"RecurringTimeSpansMixin"}construct(...e){this.globalOccurrences=new Map,this.recurringEvents=new Set,super.construct(...e)}afterLoadData(){this.globalOccurrences.clear(),this.refreshRecurringEventsCache("clear"),this.refreshRecurringEventsCache("splice",this.storage.allValues),super.afterLoadData&&super.afterLoadData()}onDataChange({action:e,added:t,removed:n,replaced:r}){this.refreshRecurringEventsCache(e,t,n,r),super.onDataChange(...arguments)}refreshRecurringEventsCache(e,t=Lf,n=Lf,r){const{recurringEvents:s}=this,i=null==r?void 0:r.length;switch(e){case"clear":s.clear();break;case"splice":{if(i){t=t.slice(),n=n.slice();for(let e=0;e<i;e++)n.push(r[e][0]),t.push(r[e][1])}const e=t.length,a=n.length;if(a&&s.size)for(let e=0;e<a;e++)s.delete(n[e]);if(e)for(let n=0;n<e;n++){const e=t[n];e.isRecurring&&s.add(e)}break}}}getById(e){let t=super.getById(e);return t||(t=this.globalOccurrences.get(this.modelClass.asId(e))),t}onModelChange(e,t,n,r,s){const i=!r&&this.isRecurrenceRelatedFieldChange(e,n);if(i&&e.removeOccurrences(),super.onModelChange(...arguments),i){const e={action:"batch",records:this.storage.values};this.trigger("refresh",e),this.trigger("change",e)}}isRecurrenceRelatedFieldChange(e,t){return e.isRecurring||"recurrenceRule"in t}getOccurrencesForTimeSpan(e,t,n){const r=[];return e.isRecurring&&e.recurrence.forEachOccurrence(t,n,(e=>r.push(e))),r}set data(e){this.globalOccurrences.clear(),super.data=e}getRecurringTimeSpans(){return[...this.recurringEvents]}};class _f extends(ji.mixin($f)){static $name="ResourceTimeRangeStore";static get defaultConfig(){return{loadPriority:500,syncPriority:500,resourceStore:null,modelClass:Pf,storeId:"resourceTimeRanges"}}set resourceStore(e){this._resourceStore=e,this.isConfiguring||this.initRelations(!0)}get resourceStore(){return this._resourceStore}getResourcesForEvent(e){return[e.resource]}getRanges({resourceRecord:e,startDate:t,endDate:n}){return e.timeRanges.flatMap((e=>e.supportsRecurring?e.getOccurrencesForDateRange(t,n):e.intersectsRange(t,n)?e:[])).sort(((e,t)=>e.startDate-t.startDate))}}_f._$name="ResourceTimeRangeStore";class Nf extends Nr{static $name="storeTimeZonePlugin";static pluginConfig={before:["processRecord"],assign:["beforeSyncRecord","afterSyncRecord"]};get timeZone(){return this.client.project.timeZone}processRecord(e,t){(t||this.client.isLoadingData||void 0!==e.timeZone)&&this.convertRecordToTimeZone(e)}convertRecordToTimeZone(e,t=this.timeZone){if(e.timeZone!==t){var n,r;if(e.$ignoreChange=!0,null!==(n=e.baselines)&&void 0!==n&&n.count)for(const n of e.baselines)e.timeZone!==n.timeZone&&(n.timeZone=e.timeZone),n.convertToTimeZone(t);if(null!==(r=e.occurrences)&&void 0!==r&&r.length)for(const n of e.occurrences)e.timeZone!==n.timeZone&&(n.timeZone=e.timeZone),n.convertToTimeZone(t);e.convertToTimeZone(t),e.$ignoreChange=!1}}beforeSyncRecord({record:e}){null!=e.timeZone&&(e.$restoreTimeZone=e.timeZone,e.convertToTimeZone())}afterSyncRecord({record:e}){e.$restoreTimeZone&&(e.convertToTimeZone(e.$restoreTimeZone),e.$restoreTimeZone=null)}}Nf._$name="StoreTimeZonePlugin";var jf=e=>class extends(e||Ns){static $name="ProjectModelTimeZoneMixin";static configurable={timeZone:{$config:"lazy",value:null}};get _storesWithDates(){return[this.taskStore,this.timeRangeStore,this.resourceTimeRangeStore].filter((e=>e))}plugStore(e){e.hasPlugin(Nf)||e.addPlugins(Nf)}unplugStore(e){var t;null===(t=e.plugins.storeTimeZonePlugin)||void 0===t||t.destroy()}attachStore(e){super.attachStore(e),e&&null!=this.timeZone&&this._storesWithDates.includes(e)&&(this.plugStore(e),this.convertStoresToTimeZone([e]))}detachStore(e){super.detachStore(e),e&&!e.isDestroyed&&null!=this.timeZone&&(this.convertStoresToTimeZone([e],null),this.unplugStore(e))}relayStoreChange({source:e,action:t,records:n,replaced:r}){const s=this;var i;null!=s.timeZone&&s._storesWithDates.includes(e)&&(["add","replace"].includes(t)&&(null!==(i=n)&&void 0!==i&&i.length||null==r||!r.length||(n=r),n.length&&n.forEach((e=>e.timeZone=s.timeZone))))}convertStoresToTimeZone(e,t=this.timeZone){var n;const r=this,s=null===(n=r.stm)||void 0===n?void 0:n.autoRecord;s&&(r.stm.autoRecord=!1);for(const n of e)null==n||n.forEach((e=>n.plugins.storeTimeZonePlugin.convertRecordToTimeZone(e,t)));s&&(r.stmAutoRecord=s)}updateTimeZone(e,t){const n=this,r=n._isConfiguringTimeZone||n.isConfiguring;if(n.trigger("beforeTimeZoneChange",{timeZone:e,oldTimeZone:t,isConfiguring:r}),n.calendarManagerStore.forEach((e=>e.bumpVersion())),n._storesWithDates.forEach((e=>n.plugStore(e))),n.convertStoresToTimeZone(n._storesWithDates),n.startDate){const r=null!=t?Dd.fromTimeZone(n.startDate,t):n.startDate;n.startDate=null!=e?Dd.toTimeZone(r,e):r}n.ignoreRecordChanges=!0,n.commitAsync().then((()=>{n.isDestroyed||n.trigger("timeZoneChange",{timeZone:e,oldTimeZone:t,isConfiguring:r}),delete n._isConfiguringTimeZone}))}};class Vf extends(df.mixin(Ff)){static $name="TimeRangeModel";afterConstruct(){this.endDate||(this.endDate=this.startDate),super.afterConstruct()}}Vf._$name="TimeRangeModel";class Bf extends(ji.mixin($f)){static $name="TimeRangeStore";static defaultConfig={loadPriority:500,syncPriority:500,modelClass:Vf,storeId:"timeRanges"}}Bf._$name="TimeRangeStore";var zf=e=>class extends((e||Ns).mixin(of,jf)){static get $name(){return"ProjectModelMixin"}static get defaultConfig(){return{stm:{},timeRangeModelClass:Vf,resourceTimeRangeModelClass:Pf,timeRangeStoreClass:Bf,resourceTimeRangeStoreClass:_f,eventStore:{},assignmentStore:{},dependencyStore:{},resourceStore:{},timeRangesData:null,resourceTimeRangesData:null}}static configurable={json:null,timeRangeStore:{value:{},$config:"nullify"},resourceTimeRangeStore:{value:{},$config:"nullify"},events:null,resourceTimeRanges:null};get inlineData(){return T.safeJsonParse(super.json)}set inlineData(e){this.json=e}construct(e={}){super.construct(...arguments),e.timeRangesData&&(this.timeRangeStore.data=e.timeRangesData),e.resourceTimeRangesData&&(this.resourceTimeRangeStore.data=e.resourceTimeRangesData)}afterConstruct(){super.afterConstruct();const e=this;!e.timeRangeStore.stm&&e.stm.addStore(e.timeRangeStore),!e.resourceTimeRangeStore.stm&&e.stm.addStore(e.resourceTimeRangeStore)}attachStore(e){e&&e.ion({name:e.$$name,change:"relayStoreChange",thisObj:this}),super.attachStore(e)}detachStore(e){e&&(this.detachListeners(e.$$name),super.detachStore(e))}relayStoreChange(e){return super.relayStoreChange(e),this.trigger("change",{store:e.source,...e,source:this})}updateTimeRangeStore(e,t){this.detachStore(t),this.attachStore(e),t&&(t.project=null),e&&(e.project=this)}setTimeRangeStore(e){this.timeRangeStore=e}changeTimeRangeStore(e){return e&&!e.isStore&&(e=this.timeRangeStoreClass.new({modelClass:this.timeRangeModelClass},e)),e}updateResourceTimeRangeStore(e,t){this.detachStore(t),this.attachStore(e),t&&(t.project=null),e&&(e.project=this)}changeResourceTimeRangeStore(e){return e&&!e.isStore&&(e=this.resourceTimeRangeStoreClass.new({modelClass:this.resourceTimeRangeModelClass},e)),e}setResourceTimeRangeStore(e){this.resourceTimeRangeStore=e}get events(){return this.eventStore.allRecords}updateEvents(e){this.eventStore.data=e}get resourceTimeRanges(){return this.resourceTimeRangeStore.allRecords}updateResourceTimeRanges(e){this.resourceTimeRangeStore.data=e}async loadInlineData(e){return this.isLoadingInlineData=!0,e.resourceTimeRangesData&&(this.resourceTimeRangeStore.data=e.resourceTimeRangesData),e.timeRangesData&&(this.timeRangeStore.data=e.timeRangesData),super.loadInlineData(e)}toJSON(){const e=this,t={eventsData:e.eventStore.toJSON(),resourcesData:e.resourceStore.toJSON(),dependenciesData:e.dependencyStore.toJSON(),timeRangesData:e.timeRangeStore.toJSON(),resourceTimeRangesData:e.resourceTimeRangeStore.toJSON()};return e.eventStore.usesSingleAssignment||(t.assignmentsData=e.assignmentStore.toJSON()),t}get json(){return super.json}changeJson(e){return"string"==typeof e&&(e=T.safeJsonParse(e)),e}updateJson(e){e&&this.loadInlineData(e)}afterChange(e,t){super.afterChange(...arguments),t.calendar&&this.trigger("calendarChange")}doDestroy(){this.timeRangeStore.destroy(),this.resourceTimeRangeStore.destroy(),super.doDestroy()}},Wf=e=>class extends e{getCurrentConfig(e){const t=this,n=super.getCurrentConfig(e);if(n){for(const r of["eventStore","resourceStore","assignmentStore","dependencyStore","timeRangeStore","resourceTimeRangeStore"]){const s=t[r];if(s){s.count&&(n[s.id+"Data"]=s.getInlineData(e));const t=s.getCurrentConfig(e);t&&Object.keys(t).length>0?n[r]=Object.assign(n[r]||{},t):n[r]&&0===Object.keys(n[r]).length&&delete n[r]}}return t.taskStore.isTaskStore&&(delete n.eventModelClass,delete n.eventStoreClass,delete n.children),n}}};class Hf extends ue{set eventStore(e){const t=this;t.eventStoreDetacher&&t.eventStoreDetacher(),t._eventStore=e,e&&e.autoCommit&&(t.eventStoreDetacher=e.ion({beforecommit:t.onEventStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))}get eventStore(){return this._eventStore}set resourceStore(e){const t=this;t.resourceStoreDetacher&&t.resourceStoreDetacher(),t._resourceStore=e,e&&e.autoCommit&&(t.resourceStoreDetacher=e.ion({beforecommit:t.onResourceStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))}get resourceStore(){return this._resourceStore}set assignmentStore(e){const t=this;t.assignmentStoreDetacher&&t.assignmentStoreDetacher(),t._assignmentStore=e,e&&e.autoSync&&(t.assignmentStoreDetacher=e.ion({beforecommit:t.onAssignmentStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))}get assignmentStore(){return this._assignmentStore}set dependencyStore(e){const t=this;t.dependencyStoreDetacher&&t.dependencyStoreDetacher(),t._dependencyStore=e,e&&e.autoSync&&(t.dependencyStoreDetacher=e.ion({beforecommit:t.onDependencyStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))}get dependencyStore(){return this._dependencyStore}onEventStoreBeforeSync({changes:e}){return this.removeNonPersistableRecordsToCreate(e),this.shallContinueSync(e)}onResourceStoreBeforeSync({changes:e}){return this.removeNonPersistableRecordsToCreate(e),this.shallContinueSync(e)}onAssignmentStoreBeforeSync({changes:e}){return this.removeNonPersistableRecordsToCreate(e),this.shallContinueSync(e)}onDependencyStoreBeforeSync({changes:e}){return this.removeNonPersistableRecordsToCreate(e),this.shallContinueSync(e)}removeNonPersistableRecordsToCreate(e){const t=e.added||[];let n,r;for(r=t.length-1;r>=0;--r)n=t[r],n.isPersistable||t.splice(t.indexOf(n),1);0===t.length&&(e.added.length=0)}shallContinueSync(e){return Boolean(e.added&&e.added.length>0||e.modified&&e.modified.length>0||e.removed&&e.removed.length>0)}}Hf._$name="ModelPersistencyManager";var Uf=e=>class extends e{static get $name(){return"EventModelMixin"}static get isEventModel(){return!0}static get fields(){return[{name:"resourceId",internal:!0},{name:"resourceIds",type:"array",persist:!1,internal:!0},{name:"resources",column:{type:"resourceassignment"},persist:!1,internal:!0,useProp:!0},{name:"draggable",type:"boolean",persist:!1,defaultValue:!0,internal:!0},{name:"resizable",persist:!1,defaultValue:!0,internal:!0},{name:"allDay",type:"boolean",defaultValue:!1},{name:"eventStyle",internal:!0},{name:"eventColor",internal:!0},{name:"milestoneWidth",internal:!0},{name:"stickyContents",internal:!0}]}updateAssignmentEventIds(){this.assigned.forEach((e=>{e.eventId=this.id}))}syncId(e){super.syncId(e),this.updateAssignmentEventIds()}setValue(e,t){if("resource"!==e||this.usesSingleAssignment)return super.setValue(e,t);this.resources=ge.asArray(t)??[]}get resources(){return this.assignments.reduce(((e,{resource:t})=>(t&&e.push(t.$original),e)),[])}set resources(e){var t;e=ge.asArray(e);const n=this,r=e.map(n.constructor.asId);if(n.usesSingleAssignment)n.set("resourceId",r[0]);else if(null!==(t=n.fieldMap)&&void 0!==t&&t.resourceIds.persist)n.resourceIds=r;else{const e=n.assignments.map((e=>e.resource.id)),{onlyInA:t,onlyInB:s}=ge.delta(r,e);n.assignmentStore.add(t.map((e=>({resource:e,event:n})))),n.assignmentStore.remove(s.map((e=>n.assignments.find((t=>t.resource.id===e)))))}}forEachResource(e,t=this){for(const n of this.resources)if(!1===e.call(t,n))return}getResource(e){return null==e?this.resource:this.resourceStore?this.resourceStore.getById(e):null}get startDate(){let e;return e=this.isOccurrence?this.get("startDate"):this._startDate??super.startDate,this.allDay&&(e=this.constructor.getAllDayStartDate(e)),e}set startDate(e){this.batching?(this._startDate=e,this.set({startDate:e})):super.startDate=e}get endDate(){let e;return e=this.isOccurrence?this.get("endDate"):this._endDate??super.endDate,this.allDay&&(e=this.constructor.getAllDayEndDate(e)),e}set endDate(e){this.batching?(this._endDate=e,this.set({endDate:e})):super.endDate=e}get wrapStartDate(){return this.startDate}set wrapStartDate(e){}get wrapEndDate(){return this.endDate}set wrapEndDate(e){}get isEvent(){return!0}get isDraggable(){return!this.readOnly&&this.draggable}get isResizable(){return!this.isMilestone&&(!this.isParent||this.manuallyScheduled)&&this.resizable}get isPersistable(){return super.isPersistable&&!this.isCreating}endBatch(e,t,n){const r=this,s=r.isPersistable;if(super.endBatch(e,t,n),r.isPersistable&&!s&&!r.ignoreBag&&r.assigned)for(const e of r.assigned)e.stores.forEach((t=>t.updateModifiedBagForRecord(e)))}get isCreating(){return super.isCreating}set isCreating(e){var t,n;super.isCreating=e,null===(t=this.assignmentStore)||void 0===t||t.suspendAutoCommit(),this.assignments.forEach((t=>t.isCreating=e)),null===(n=this.assignmentStore)||void 0===n||n.resumeAutoCommit()}get usesSingleAssignment(){return!this.eventStore||this.eventStore.usesSingleAssignment}copy(...e){const t=super.copy(...e);return this.usesSingleAssignment||(t.resourceId=null),t}get persistableData(){const e=super.persistableData;return this.usesSingleAssignment||delete e.resourceId,e}get resource(){const{resources:e}=this;return e.length?e[0]:null}set resource(e){this.resourceId=this.constructor.asId(e)}get resourceId(){var e;return this.usesSingleAssignment?this.get("resourceId"):null===(e=this.assignments[0])||void 0===e?void 0:e.resourceId}set resourceId(e){this.applyResourceId(e)}get resourceIds(){var e,t;return null!==(e=this.fieldMap)&&void 0!==e&&e.resourceIds.persist?this.get("resourceIds"):(null===(t=this.resources)||void 0===t?void 0:t.map((e=>e.id)))??[]}set resourceIds(e){this.set("resourceIds",e)}get $linkedResources(){var e;return(null===(e=this.resources)||void 0===e?void 0:e.flatMap((e=>[e,...e.$links])))??[]}applyResourceId(e,t=!1){const n=this,{eventStore:r,assignments:s}=n;if(r){var i,a;const t=r.assignmentStore||(null===(i=r.crudManager)||void 0===i?void 0:i.assignmentStore);if(null!=e)if(n.meta.skipEnforcingSingleAssignment||(r.usesSingleAssignment=!0),null!=s&&s.length&&e!==s[0].resourceId){const n=Boolean(r.eventsSuspended);n&&t.suspendEvents(),s[0].resource=e,n&&t.resumeEvents()}else t.assignEventToResource(n,e);else(n.usesSingleAssignment||null!==(a=n.resourceIds)&&void 0!==a&&a.length)&&t.remove(s)}else t||n.set({resourceId:e})}applyResourceIds(e,t=!1){const n=this,{eventStore:r,assignments:s}=n;if(!1===n.fieldMap.resourceIds.persist)return!1;if(e=[...new Set(e)],r){var i,a;const t=r.assignmentStore||(null===(i=r.crudManager)||void 0===i?void 0:i.assignmentStore);if(null!==(a=e)&&void 0!==a&&a.length)if(null!=s&&s.length){const i=Boolean(r.eventsSuspended);i&&t.suspendEvents(),s.forEach((t=>{const n=e.find((e=>!s.some((t=>t.resourceId===e))));n&&(t.resource=n)}));const{onlyInA:a,onlyInB:o}=ge.delta(e,s.map((e=>e.resourceId)));t.add(a.map((e=>({resource:e,event:n})))),t.remove(o.map((e=>s.find((t=>t.resource.id===e))))),i&&t.resumeEvents()}else t.add(e.map((e=>({resource:e,event:n}))));else t.remove(s)}else t||n.set({resourceIds:e})}applyValue(e,t,n,r,s){if(s&&!this.meta.isAssigning){const{eventStore:e}=this;switch(s.name){case"resourceId":e&&(e.isAssigning=!0),this.applyResourceId(n,!0);break;case"resourceIds":e&&(e.isAssigning=!0),this.applyResourceIds(n,!0)}e&&(e.isAssigning=!1)}super.applyValue(e,t,n,r,s)}get assignments(){return[...this.assigned||[]]}assign(e,t=!1){const{eventStore:n}=this;n&&!n.usesSingleAssignment?n.assignEventToResource(this,e,t):(this.resourceId=this.constructor.asId(e),n||(this.meta.skipEnforcingSingleAssignment=!0))}unassign(e,t=!1){var n;const r=this;e=r.constructor.asId(e),r.meta.removingResource=t,null===(n=r.eventStore)||void 0===n||n.unassignEventFromResource(r,e),r.meta.removingResource=null}reassign(e,t){this.eventStore&&this.eventStore.reassignEventFromResourceToResource(this,e,t)}isAssignedTo(e){const t=this.constructor.asId(e);return this.assignments.some((e=>e.resourceId===t))}get predecessors(){return[...this.incomingDeps??[]]}get successors(){return[...this.outgoingDeps??[]]}get dependencies(){return[...this.incomingDeps??[],...this.outgoingDeps??[]]}normalize(){}inSetNormalize(){}get recurringEvent(){return this.recurringTimeSpan}get isInterDay(){const{durationMS:e}=this;if(e>=864e5||!e&&this.allDay)return!0;const{endDate:t,startDate:n}=this,r=Bt.clearTime(n);return n&&t?(r.setDate(r.getDate()+1),(t||Bt.add(n,e))>r):void 0}static getAllDayStartDate(e){return e&&e.isEvent&&(e=e.get("startDate")),e&&(e=Bt.clearTime(e,!0)),e}static getAllDayEndDate(e){return e&&e.isEvent&&(e=e.get("endDate")),e&&(e.getHours()>0||e.getMinutes()>0||e.getSeconds()>0||e.getMilliseconds()>0)&&(e=Bt.getNext(e,"d",1)),e}static getAllDayDisplayStartDate(e){return e&&e.isEvent&&(e=e.get("startDate")),Bt.clearTime(e,!0)}static getAllDayDisplayEndDate(e,t){return e&&e.isEvent&&(t=e.get("endDate"),e=e.get("startDate")),t&&(e=this.constructor.getAllDayDisplayStartDate(e),Bt.clearTime(t,!0).valueOf()===t.valueOf()?t=Bt.add(t,Bt.DAY,-1):e.valueOf()!==t.valueOf()&&(t=Bt.clearTime(t,!0))),t}isEditable(e){switch(e){case"endDate":case"duration":case"fullDuration":return this.isLeaf}return super.isEditable(e)}},Yf=e=>class extends(e||ue){static get $name(){return"PartOfProject"}};const qf=Ep;class Kf extends(qf.derive(df).mixin(Ff,Yf,Uf)){static get $name(){return"EventModel"}}Kf.exposeProperties(),Kf._$name="EventModel";const Gf=["SS","SF","FS","FF"];class Xf extends Ns{static get $name(){return"DependencyBaseModel"}static get Type(){return{StartToStart:0,StartToEnd:1,EndToStart:2,EndToEnd:3}}static get fields(){return[{name:"from"},{name:"to"},{name:"type",type:"int",defaultValue:2},{name:"cls",defaultValue:""},{name:"bidirectional",type:"boolean"},{name:"fromSide",type:"string"},{name:"toSide",type:"string"},{name:"lag",type:"number",allowNull:!0,defaultValue:0},{name:"lagUnit",type:"string",defaultValue:"d"},{name:"highlighted",persist:!1,internal:!0}]}construct(e){const t=e[this.fieldMap.from.dataSource],n=e[this.fieldMap.to.dataSource];null!=t&&(e.fromEvent=t),null!=n&&(e.toEvent=n),super.construct(...arguments)}get eventStore(){var e;return this.eventStore||(null===(e=this.unjoinedStores[0])||void 0===e?void 0:e.eventStore)}set from(e){const{fromEvent:t}=this;null!=t&&t.isModel&&t.id===e?this.set("from",e):this.fromEvent=e}get from(){return this.get("from")}set to(e){const{toEvent:t}=this;null!=t&&t.isModel&&t.id===e?this.set("to",e):this.toEvent=e}get to(){return this.get("to")}get hardType(){return this.getHardType()}set hardType(e){this.setHardType(e)}getHardType(){return this.get("type")}setHardType(e){let t;return e!==this.hardType&&(t=this.set({type:e,fromSide:null,toSide:null})),t}get lag(){return this.get("lag")}set lag(e){this.setLag(e)}setLag(e,t=this.lagUnit){1!==arguments.length?(e=parseFloat(e),this.set({lag:e,lagUnit:t})):"number"==typeof e?this.lag=e:(e=Bt.parseDuration(e),this.set({lag:e.magnitude,lagUnit:e.unit}))}getLag(){return this.lag?`${this.lag<0?"-":"+"}${Math.abs(this.lag)}${Bt.getShortNameOfUnit(this.lagUnit)}`:""}get fullLag(){return new js({unit:this.lagUnit,magnitude:this.lag})}set fullLag(e){"string"==typeof e?this.setLag(e):this.setLag(e.magnitude,e.unit)}get isPersistable(){const e=this,{stores:t,unjoinedStores:n}=e,r=t[0];let s;if(r){const{fromEvent:t,toEvent:n}=e,i=r.crudManager;s=t&&(i||!t.hasGeneratedId)&&n&&(i||!n.hasGeneratedId)}else s=Boolean(n[0]);return s&&super.isPersistable}getDateRange(){const{fromEvent:e,toEvent:t}=this;if(null!=e&&e.isScheduled&&null!=t&&t.isScheduled){const n=Xf.Type;let r,s;switch(this.type){case n.StartToStart:r=e.startDateMS,s=t.startDateMS;break;case n.StartToEnd:r=e.startDateMS,s=t.endDateMS;break;case n.EndToEnd:r=e.endDateMS,s=t.endDateMS;break;case n.EndToStart:r=e.endDateMS,s=t.startDateMS;break;default:throw new Error("Invalid dependency type: "+this.type)}return{start:Math.min(r,s),end:Math.max(r,s)}}return null}highlight(e){var t;const n=(null===(t=this.highlighted)||void 0===t?void 0:t.split(" "))??[];n.includes(e)||(this.highlighted=n.concat(e).join(" "))}unhighlight(e){const{highlighted:t}=this;if(t){const n=t.split(" "),r=n.indexOf(e);r>=0&&(n.splice(r,1),this.highlighted=n.join(" "))}}isHighlightedWith(e){return this.highlighted&&this.highlighted.split(" ").includes(e)}getConnectorString(e){const t=Gf[this.type];return e?t:this.type===Xf.Type.EndToStart?"":t}toString(){return`${this.from}${this.getConnectorString()}${this.getLag()}`}get isValid(){const{fromEvent:e,toEvent:t,type:n}=this;return"number"==typeof n&&e&&t&&e!==t}get fromEventName(){var e;return(null===(e=this.fromEvent)||void 0===e?void 0:e.name)||""}get toEventName(){var e;return(null===(e=this.toEvent)||void 0===e?void 0:e.name)||""}shouldRecordFieldChange(e,t,n){if(!super.shouldRecordFieldChange(e,t,n))return!1;if("from"===e||"to"===e||"fromEvent"===e||"toEvent"===e){var r;const e=null===(r=this.project)||void 0===r?void 0:r.eventStore;if(e&&e.oldIdMap[t]===e.getById(n))return!1}return!0}}Xf.exposeProperties(),Xf._$name="DependencyBaseModel";const Zf=Cp;class Jf extends(Yf(Zf.derive(Xf))){static get $name(){return"DependencyModel"}getTypeFromSides(e,t,n){const r=Xf.Type,s=n?"right":"left",i=n?"left":"right";return e===s?t===s?r.StartToStart:r.StartToEnd:t===i?r.EndToEnd:r.EndToStart}}Jf.exposeProperties(),Jf._$name="DependencyModel";class Qf extends Ns{static get fields(){return[{name:"iconCls",internal:!0},{name:"cls",internal:!0},{name:"rowHeight",internal:!0},{name:"href",internal:!0},{name:"target",internal:!0}]}}Qf.exposeProperties(),Qf._$name="GridRowModel";var ev=e=>class extends e{static get $name(){return"ResourceModelMixin"}static get isResourceModel(){return!0}static get fields(){return[{name:"name",type:"string",persist:!0},"eventColor","eventStyle","imageUrl","image","resourceMargin",{name:"barMargin",type:"number"},"eventLayout"]}updateAssignmentResourceIds(){this.assigned.forEach((e=>{e.resourceId=this.id}))}syncId(e){super.syncId(e),this.updateAssignmentResourceIds()}get events(){return this.assignments.reduce(((e,t)=>(t.event&&e.push(t.event),e)),[])}get assignments(){return this.assigned?[...this.assigned]:[]}set assignments(e){this.assignmentStore.remove(this.assignments),e.forEach((e=>{e.resource=this}))}getEvents(){return P.deprecate("scheduler","6.0.0","getEvents() is deprecated, use the events property instead"),this.events}get isPersistable(){return super.isPersistable&&(!this.parent||this.parent.isPersistable)}unassignAll(){this.assignments&&this.assignmentStore.remove(this.assignments)}get initials(){const{name:e=""}=this;if(!e)return"";const t=e.split(" ");return t[0][0]+(t.length>1?t[t.length-1][0]:"")}isWorkingTime(e){var t,n;const r=this.effectiveCalendar||(null===(t=this.project)||void 0===t?void 0:t.calendar);return!r||(null===(n=r.isWorkingTime)||void 0===n?void 0:n.call(r,e))}};const tv=hp;class nv extends(ev(Yf(tv.derive(Qf)))){static $name="ResourceModel"}nv.exposeProperties(),nv._$name="ResourceModel";var rv=e=>class extends e{static get $name(){return"AssignmentModelMixin"}static get fields(){return["resourceId","eventId",{name:"drawDependencies",type:"boolean"},"event","resource"]}construct(e,...t){e=e||{};const{fieldMap:n}=this,r=n.eventId.dataSource,s=n.resourceId.dataSource,i=n.event.dataSource,a=n.resource.dataSource,o=e[r],l=e[s],c=e[i],d=e[a];null!=o?e[i]=o:null!=c&&(e[r]=c.isModel?c.id:c),null!=l?e[a]=l:null!=d&&(e[s]=d.isModel?d.id:d),super.construct(e,...t)}get eventResourceKey(){return this.buildEventResourceKey(this.event,this.resource)}buildEventResourceKey(e,t){let n,r;return n=e?e.isModel?e.id:e:this.internalId,r=t?t.isModel?t.id:t:this.internalId,`${n}-${r}`}buildIndexKey({event:e,resource:t}){return this.buildEventResourceKey(e,t)}set(e,t,...n){const r=this.fieldToKeys(e,t);var s,i;"resource"in r?void 0!==(null===(s=r.resource)||void 0===s?void 0:s.id)&&(r.resourceId=r.resource.id):"resourceId"in r&&this.constructor.isProAssignmentModel&&(r.resource=r.resourceId);"event"in r?void 0!==(null===(i=r.event)||void 0===i?void 0:i.id)&&(r.eventId=r.event.id):"eventId"in r&&this.constructor.isProAssignmentModel&&(r.event=r.eventId);return super.set(r,null,...n)}afterChange(e,t,n,r,s){var i,a;const o=this;return!o.constructor.isProAssignmentModel&&null!=t&&t.resourceId&&(null===(i=o.resource)||void 0===i?void 0:i.id)!==t.resourceId.value?o.resource=t.resourceId.value:!(o.constructor.isProAssignmentModel&&null!==(a=o.project)&&void 0!==a&&a.propagatingSyncChanges&&null!=t&&t.eventId)||null!=t&&t.event||e.event.value!==t.eventId.value&&e.event.value.id!==t.eventId.value||(delete t.eventId,delete o.meta.modified.eventId),super.afterChange(...arguments)}set resourceId(e){const{resource:t}=this;null!=t&&t.isModel&&t.id===e?this.set("resourceId",e):this.resource=e}get resourceId(){var e;return(null===(e=this.resource)||void 0===e?void 0:e.id)??this.get("resourceId")}set eventId(e){const{event:t}=this;null!=t&&t.isModel&&t.id===e?this.set("eventId",e):this.event=e}get eventId(){var e;return(null===(e=this.event)||void 0===e?void 0:e.id)??this.get("eventId")}get eventName(){var e;return null===(e=this.event)||void 0===e?void 0:e.name}get resourceName(){var e;return null===(e=this.resource)||void 0===e?void 0:e.name}getResource(){return this.resource}get isAssignment(){return!0}get isPersistable(){var e;const{event:t,resource:n,unjoinedStores:r,assignmentStore:s}=this,i=null==s?void 0:s.crudManager;let a;return a=s?this.isValid&&t.isPersistable&&(i||!t.hasGeneratedId&&!n.hasGeneratedId):!this.isPhantom&&Boolean(r[0]),a&&super.isPersistable&&!(null!==(e=this.event)&&void 0!==e&&e.isCreating)}get isValid(){return null!=this.resource&&null!=this.event}toString(){return this.resourceName?`${this.resourceName} ${Math.round(this.units)}%`:""}shouldRecordFieldChange(e,t,n){if(!super.shouldRecordFieldChange(e,t,n))return!1;if("event"===e||"eventId"===e){var r;const e=null===(r=this.project)||void 0===r?void 0:r.eventStore;if(e&&e.oldIdMap[t]===e.getById(n))return!1}if("resource"===e||"resourceId"===e){var s;const e=null===(s=this.project)||void 0===s?void 0:s.resourceStore;if(e&&e.oldIdMap[t]===e.getById(n))return!1}return!0}};const sv=mp;class iv extends(rv(Yf(sv.derive(Ns)))){static get $name(){return"AssignmentModel"}}iv.exposeProperties(),iv._$name="AssignmentModel";var av=e=>class extends(e||ue){static $name="EventStoreMixin";static get defaultConfig(){return{loadPriority:100,syncPriority:200,storeId:"events",removeUnassignedEvent:!0,singleAssignment:null}}construct(e){if(super.construct(e),this.autoTree=!0,this.singleAssignment&&(this.usesSingleAssignment=!0),!this.modelClass.isEventModel)throw new Error("The model for the EventStore must subclass EventModel")}set filtersFunction(e){super.filtersFunction=e}get filtersFunction(){const e=super.filtersFunction;return e&&e!==Ce.returnTrue?t=>t.isCreating||e(t):e}getEventCounts(e){const t=this,{filtersFunction:n,added:r}=t,s=t.getEvents({...e,storeFilterFn:t.isFiltered?t.reapplyFilterOnAdd?n:e=>r.includes(e)?t.indexOf(e)>-1:n(e):null,dateMap:e.dateMap||!0});return s.forEach(((e,t)=>s.set(t,e.length))),s}forEachScheduledEvent(e,t=this){this.forEach((n=>{const{startDate:r,endDate:s}=n;if(r&&s)return e.call(t,n,r,s)}))}getTotalTimeSpan(){let e=new Date(9999,0,1),t=new Date(0);return this.forEach((n=>{n.startDate&&(e=Bt.min(n.startDate,e)),n.endDate&&(t=Bt.max(n.endDate,t))})),e=e<new Date(9999,0,1)?e:null,t=t>new Date(0)?t:null,this.lastTotalTimeSpan={startDate:e||null,endDate:t||e||null}}isEventPersistable(e){return e.isPersistable}isDateRangeAvailable(e,t,n,r){if(r.data.generatedParent)return!1;const s=new Set(this.getEventsForResource(r));if(null!=n&&n.isAssignment){n.event.resources.forEach((e=>{e.id!==n.resourceId&&this.getEventsForResource(e).forEach((e=>s.add(e)))}))}if(n){const e=n.isAssignment?n.event:n;s.delete(e)}const i=Array.from(s);return e.getTime()===t.getTime()?!i.some((n=>n.isScheduled&&(0===n.duration?n.startDate.getTime()===e.getTime():Bt.intersectSpans(e,t,n.startDate,n.endDate)))):!i.some((n=>n.isScheduled&&Bt.intersectSpans(e,t,n.startDate,n.endDate)))}filterEventsForResource(e,t,n=this){return e.getEvents(this).filter(t.bind(n))}getResourcesForEvent(e){return e.isOccurrence&&(e=e.recurringTimeSpan),this.assignmentStore.getResourcesForEvent(e)}getEventsForResource(e){return this.assignmentStore.getEventsForResource(e)}getAssignmentsForEvent(e){return this.assignmentStore.getAssignmentsForEvent(e)||[]}getAssignmentsForResource(e){return this.assignmentStore.getAssignmentsForResource(e)||[]}assignEventToResource(e,t,n=!1){return this.assignmentStore.assignEventToResource(e,t,void 0,n)}unassignEventFromResource(e,t){this.assignmentStore.unassignEventFromResource(e,t)}reassignEventFromResourceToResource(e,t,n){const r=this,s=Ns.asId(n),i=r.assignmentStore.getAssignmentForEventAndResource(e,t);i?i.resourceId=s:r.assignmentStore.assignEventToResource(e,n)}isEventAssignedToResource(e,t){return this.assignmentStore.isEventAssignedToResource(e,t)}removeAssignmentsForEvent(e){this.assignmentStore.removeAssignmentsForEvent(e)}removeAssignmentsForResource(e){this.assignmentStore.removeAssignmentsForResource(e)}append(e){return this.add(e)}get project(){return super.project}set project(e){var t;(super.project=e,this.detachListeners("project"),e)&&(null!==(t=e.assignmentStore)&&void 0!==t&&t.isAssignmentStore&&this.attachToAssignmentStore(e.assignmentStore),e.ion({name:"project",assignmentStoreChange:"onProjectAssignmentStoreChange",thisObj:this,prio:200}))}get usesResourceIds(){var e;return(null===(e=this.modelClass.fieldMap)||void 0===e?void 0:e.resourceIds.persist)??!1}get usesSingleAssignment(){return this.isChained?this.masterStore.usesSingleAssignment:this._usesSingleAssignment}set usesSingleAssignment(e){this._usesSingleAssignment=e;const{assignmentStore:t}=this;null!=t&&t.isStore&&!t.hasGenerateIdOverride&&(t.modelClass.generateId=function(){return null==this.singleAssignmentIdCounter&&(this.singleAssignmentIdCounter=0),"a-"+ ++this.singleAssignmentIdCounter},t.hasGenerateIdOverride=!0)}processRecords(e){var t;const{assignmentStore:n}=this,r=[];return n&&(n.skipInvalidateIndices=!0),e=super.processRecords(e,n&&!(null!==(t=this.stm)&&void 0!==t&&t.isRestoring)&&(e=>{const t=e.get("resourceId");e.reassignedFromReplace||null==t||n.includesAssignment(e.id,t)||r.push({id:n.modelClass.generateId(""),resourceId:t,eventId:e.id}),e.reassignedFromReplace=!1})||void 0),n&&(n.storage.invalidateIndices(),n.skipInvalidateIndices=!1,n.add(r)),e}joinRecordsToStore(e){const{assignmentStore:t}=this;t?(t.skipInvalidateIndices=!0,super.joinRecordsToStore(e),t.storage.invalidateIndices(),t.skipInvalidateIndices=!1):super.joinRecordsToStore(e)}processRecord(e,t=!1){var n;e=super.processRecord(e,t);const r=this,s=r.assignmentStore??(null===(n=r.crudManager)||void 0===n?void 0:n.assignmentStore),i=e.get("resourceId"),{resourceIds:a}=e;if(null!=a&&a.length&&!1!==e.meta.skipEnforcingSingleAssignment&&r.usesResourceIds)s?s.add(a.filter((t=>!s.some((n=>n.eventId===e.id&&n.resourceId===t)))).map((t=>({resource:t,event:e})))):r.$processResourceIds=!0;else if(null!=i&&!e.meta.skipEnforcingSingleAssignment){const n=r.getById(e.id);if(n&&n!==e&&!t){const t=s.storage.findItem("eventId",e.id);if(null!=t&&t.size){t.values().next().value.resource=i,e.reassignedFromReplace=!0}}else r.$processResourceIds=!0;r.usesSingleAssignment=!0}return e}processResourceIds(){var e,t;const n=this,r=n.assignmentStore??(null===(e=n.crudManager)||void 0===e?void 0:e.assignmentStore);if(n.$processResourceIds&&null!=r&&r.isAssignmentStore&&(null===(t=n.project)||void 0===t||!t.isSharingAssignmentStore||!n.isChained)){const e=[];n.forEach((t=>{const{resourceId:n,resourceIds:s,id:i}=t;null!=n?e.push({id:r.modelClass.generateId(""),resourceId:n,eventId:i}):null!=s&&s.length&&s.forEach((t=>{e.push({id:r.modelClass.generateId(""),resourceId:t,eventId:i})}))}),n,{includeFilteredOutRecords:!0}),r.useRawData={disableDefaultValue:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0},r.usesSingleAssignment=!1,r.verifyNoGeneratedIds=!1,r.data=e,r.usesSingleAssignment=!0,n.$processResourceIds=!1}}loadData(){super.loadData(...arguments),this.processResourceIds()}onBeforeRemoveAssignment({records:e}){var t;const n=this;if(n.removeUnassignedEvent&&!n.isRemoving&&!n.isSettingData&&(null===(t=n.stm)||void 0===t||!t.isRestoring)&&!n.usesSingleAssignment&&!n.assignmentStore.isSyncingDataOnLoad&&!n.resourceStore.isSyncingDataOnLoad){const t=new Set;e.forEach((n=>{const{event:r}=n;r&&!r.isRemoved&&r.assignments.every((t=>e.includes(t)))&&t.add(r)})),t.size&&n.remove([...t])}}onProjectAssignmentStoreChange({store:e}){this.attachToAssignmentStore(e)}attachToAssignmentStore(e){const t=this;t.detachListeners("assignmentStore"),e&&(t.processResourceIds(),e.ion({name:"assignmentStore",addPreCommit({records:e}){t.isSettingData||t.isAssigning||(t.usesSingleAssignment?e.forEach((e=>{const{event:t}=e;null!=t&&t.isEvent&&t.resourceId!==e.resourceId&&(t.meta.isAssigning=!0,t.set("resourceId",e.resourceId),t.meta.isAssigning=!1)})):t.usesResourceIds&&e.forEach((e=>{const{event:t}=e;if(null!=t&&t.isEvent){t.meta.isAssigning=!0;const n=t.resourceIds??[];n.includes(e.resourceId)||(t.resourceIds=[...n,e.resourceId]),t.meta.isAssigning=!1}})))},beforeRemove:"onBeforeRemoveAssignment",removePreCommit({records:e}){t.isSettingData||t.isAssigning||(t.usesSingleAssignment?e.forEach((e=>{var n;null===(n=t.getById(e.eventId))||void 0===n||n.set("resourceId",null)})):t.usesResourceIds&&e.forEach((({event:e,resourceId:t})=>{const n=e.resourceIds.slice(),r=null==n?void 0:n.indexOf(t);r>=0&&(n.splice(r,1),e.resourceIds=n)})))},removeAllPreCommit(){t.isSettingData||t.isAssigning||(t.usesSingleAssignment?t.allRecords.forEach((e=>e.set("resourceId",null))):t.usesResourceIds&&t.allRecords.forEach((e=>{e.resourceIds=[]})))},update({record:e,changes:n}){if("resourceId"in n){const{event:r}=e;if(t.usesSingleAssignment)r.meta.isAssigning=!0,r.set("resourceId",n.resourceId.value),r.meta.isAssigning=!1;else if(t.usesResourceIds){r.meta.isAssigning=!0;const e=r.resourceIds.slice(),t=null==e?void 0:e.indexOf(n.resourceId.oldValue);t>=0&&e.splice(t,1),null!=e&&e.includes(n.resourceId.value)||(e.push(n.resourceId.value),r.resourceIds=e),r.meta.isAssigning=!1}}},change({action:e,records:n}){"dataset"===e&&t.usesResourceIds&&n.forEach((({event:e,resourceId:t})=>{const n=e.resourceIds??[];n.includes(t)||(n.push(t),e.meta.isAssigning=!0,e.setData("resourceIds",n),e.meta.isAssigning=!1)}))},thisObj:t}))}set data(e){this.isSettingData=!0,!this.usesSingleAssignment||this.syncDataOnLoad||this.isChained||this.assignmentStore.removeAll(!0),super.data=e,this.isSettingData=!1}trigger(e,t){var n;const{changes:r}=t||{};return!r||!("resourceId"in r)||1!==Object.keys(r).length||null!==(n=this.stm)&&void 0!==n&&n.isRestoring||(t.isAssign=!0),super.trigger(...arguments)}remove(e,...t){const n=super.remove(e,...t);if(n.length&&this.usesSingleAssignment)for(const e of n){var r,s;if(!e.isOccurrence)null===(r=this.assignmentStore||(null===(s=this.crudManager)||void 0===s?void 0:s.assignmentStore))||void 0===r||r.remove(e.assignments,!0)}return n}};const ov=()=>!0;var lv=e=>class extends e{static $name="GetEventsMixin";getEvents({filter:e,date:t,startDate:n,endDate:r,startOnly:s,includeOccurrences:i,allowPartial:a,onlyAssigned:o=!1,dateMap:l=!1,dayTime:c=null,getDateIndex:d}){const u=this,h=arguments[0],{lastDateRange:g,added:m,filtersFunction:p}=u,f=e;if(o&&(h.filter=f?e=>f(e)&&e.resources.length:e=>e.resources.length),"startDate"in h||(n=h.startDate=t),"includeOccurrences"in h||(i=h.includeOccurrences=!0),"allowPartial"in h||(a=h.allowPartial=!s),h.storeFilterFn=u.isFiltered&&!h.ignoreFilters?u.reapplyFilterOnAdd?p:e=>m.includes(e)?u.indexOf(e)>-1:p(e):null,!r)if(n)(r=h.endDate=Bt.clearTime(n)).setDate(r.getDate()+1);else{if(i)throw new Error("getEvents MUST be passed startDate and endDate if recurring occurrences are requested");h.dateFilter=ov}h.dateFilter||(h.dateFilter=s?e=>{const t=e.hasBatchedChange("startDate")?e.get("startDate"):e.startDate;return t&&!(Bt.clearTime(t)-n)}:a?e=>{const t=e.hasBatchedChange("startDate")?e.get("startDate"):e.startDate,s=e.hasBatchedChange("endDate")?e.get("endDate"):e.endDate||t;return t&&(!(t-s)?Bt.betweenLesserEqual(t,n,r):Bt.intersectSpans(t,s,n,r))}:e=>{const t=e.hasBatchedChange("startDate")?e.get("startDate"):e.startDate,s=e.hasBatchedChange("endDate")?e.get("endDate"):e.endDate||t;return t&&t>=n&&s<=r});const v={startDate:n,endDate:r};return u.processConfiguredListeners(),u.trigger("loadDateRange",{old:g||{},new:F.clone(v),changed:Boolean(!g||g.startDate-v.startDate||g.endDate-v.endDate)}),u.lastDateRange=F.clone(v),l?u.getEventsAsMap(h):u.getEventsAsArray(h)}getEventsAsArray({filter:e,date:t,resourceRecord:n,startDate:r=t,endDate:s,startOnly:i,includeOccurrences:a=!0,dayTime:o=null,dateFilter:l,storeFilterFn:c,getDateIndex:d}){const u=this,h=[];if(c?u.count:u.allCount){let e=n?u.getEventsForResource(n):null;if(!n){const t=u.useDayIndex(o),n=new Set,a=i?"startDate":"date";u.recurringEvents.forEach((e=>{t.dayTime.startOfDay(e.startDate)<=r&&n.add(e)}));for(const e=new Date(r);e<s;e.setDate(e.getDate()+1)){const r=t.get(d?d(e):a,e);null==r||r.forEach((e=>n.add(e)))}e=[...n]}c&&(e=e.filter(c));for(let t=0,{length:n}=e;t<n;t++){const n=e[t];a&&n.isRecurring?h.push.apply(h,n.getOccurrencesForDateRange(r,s).filter(l)):l(n)&&h.push(n)}}return e?h.filter(e):h}getEventsAsMap({filter:e,date:t,resourceRecord:n,startDate:r=t,endDate:s,startOnly:i,includeOccurrences:a=!0,dateMap:o,dayTime:l=null,storeFilterFn:c,getDateIndex:d}){var u;const h=this;if(null!==(u=o)&&void 0!==u&&u.clear?o.clear():o=new Map,h.count){const t=h.useDayIndex(l),u=i?"startDate":"date",p=[],f=t=>(!e||e(t))&&(!c||c(t)),v=e=>!e.isRecurring&&f(e);if(l=t.dayTime,n)throw new Error("Querying for events for a resource and returning a date-keyed Map is not supported");var g;null===(g=h.recurringEvents)||void 0===g||g.forEach((e=>{l.startOfDay(e.startDate)<s&&p.push(e)}));for(const e=new Date(r);e<s;e.setDate(e.getDate()+1)){var m;let[n,r]=t.get(d?d(e):u,e,!0);null!==(m=n)&&void 0!==m&&m.size&&(n=[...n].filter(v),n.length&&(o.get(r)||o.set(r,[]).get(r)).push(...n))}for(let e=0,{length:t}=p;e<t;e++){const t=p[e],n=(a?t.getOccurrencesForDateRange(r,s):[t]).filter(f),c=Bt.add(s,1,"day");for(let e,t=0,{length:r}=n;t<r;t++){const r=n[t],s=l.startOfDay(r.startDate),a="startDate"!==(d?d(s):i?"startDate":"date")&&r.durationMS?Bt.min(r.endDate||Bt.add(r.startDate,r.duration,r.durationUnit),c):Bt.add(s,1,"day");for(;s<a;s.setDate(s.getDate()+1)){const t=l.dateKey(s);(e=o.get(t))||o.set(t,e=[]),e.push(r)}}}}return o}};const cv={date:"_dateIndex",startDate:"_startDateIndex"},dv=Object.values(cv),uv=Object.freeze([]),{MILLIS_PER_DAY:hv}=Du;class gv{constructor(e,t){this.dayTime=t||Du.MIDNIGHT,this.store=e,this.users=[this.dayTime]}add(e,t,n){const r=this[cv[e]],s=this.dayTime.dateKey(t);(r[s]||(r[s]=new Set)).add(n)}addEvent(e){var t;let n,r=null===(t=this.dayTime.startOfDay(e.startDate))||void 0===t?void 0:t.getTime();if(r){var s;n=(null===(s=e.endDate)||void 0===s?void 0:s.getTime())??r,this.add("startDate",r,e);do{this.add("date",r,e),r+=hv}while(r<n)}}clear(){dv.forEach((e=>this[e]=Object.create(null)))}get(e,t,n){!this.initialized&&this.initialize();let r,s=this[cv[e]];return t&&(r=this.dayTime.dateKey(t),s=n?[s[r],r]:s[r]),s}initialize(){this.initialized=!0,this.clear(),this.sync("splice",this.store.storage.allValues)}invalidate(){this.initialized=!1,dv.forEach((e=>this[e]=null))}matches(e){return this.dayTime.startShift===e.startShift}remove(e,t,n){const r=this[cv[e]][this.dayTime.dateKey(t)];r&&r.delete(n)}removeEvent(e,t,n){var r;let s,i=null===(r=this.dayTime.startOfDay(t))||void 0===r?void 0:r.getTime();if(i){s=(null==n?void 0:n.getTime())??i,this.remove("startDate",i,e);do{this.remove("date",i,e),i+=hv}while(i<s)}}sync(e,t,n,r,s){var i,a;n=n||uv;const o=this,l=(t=t||uv).length,c=n.length,d=null==r?void 0:r.length;let u,h,g;if(o.initialized)switch(e){case"clear":o.clear();break;case"splice":if(d)for(t=t.slice(),n=n.slice(),u=0;u<d;u++)n.push(r[u][0]),t.push(r[u][1]);if(c)for(u=0;u<c;u++)g=n[u],o.removeEvent(g,g.startDate,g.endDate);if(l)for(u=0;u<l;u++)h=t[u],h.isScheduled&&!h.isParent&&o.addEvent(h);break;case"reschedule":g=t[0],o.removeEvent(g,(null===(i=s.startDate)||void 0===i?void 0:i.oldValue)||g.startDate,(null===(a=s.endDate)||void 0===a?void 0:a.oldValue)||g.endDate),o.sync("splice",t)}}register(e){this.users.push(e)}unregister(e){const{users:t}=this,n=t.indexOf(e);return n>-1&&t.splice(n,1),!t.length}}const mv=gv.prototype;dv.forEach((e=>mv[e]=null)),mv.initialized=!1,gv._$name="EventDayIndex";const{MIDNIGHT:pv}=Du;var fv=e=>class extends e{static $name="DayIndexMixin";construct(e){super.construct(e),this.dayIndices=null}afterLoadData(){var e;this.syncIndices("splice",this.storage.allValues),null===(e=super.afterLoadData)||void 0===e||e.call(this)}onDataChange({action:e,added:t,removed:n,replaced:r}){this.syncIndices(e,t,n,r),super.onDataChange(...arguments)}onDataReplaced(e,t){this.syncIndices("clear"),this.syncIndices("splice",this.storage.values),super.onDataReplaced(e,t)}onModelChange(e,t,n,r,s){("startDate"in n||"endDate"in n)&&this.syncIndices("reschedule",[e],null,null,n),super.onModelChange(...arguments)}invalidateDayIndices(){var e;null===(e=this.dayIndices)||void 0===e||e.forEach((e=>e.invalidate()))}registerDayIndex(e){const t=this,n=t.dayIndices||(t.dayIndices=[]);let r,s;for(s=0;!r&&s<n.length;++s)n[s].matches(e)&&(r=n[s]).register(e);return!r&&n.push(r=new gv(t,e)),r}syncIndices(...e){var t;null===(t=this.dayIndices)||void 0===t||t.forEach((t=>t.sync(...e)))}unregisterDayIndex(e){const{dayIndices:t}=this;for(let n=null==t?void 0:t.length;n-- >0;)if(t[n].matches(e)){t[n].unregister(e)&&t.splice(n,1);break}}useDayIndex(e){const t=this,{dayIndices:n}=t;e=e||pv;for(let t=0;n&&t<n.length;++t)if(n[t].matches(e))return n[t];if(e.startShift)throw new Error(`No day index registered for ${e} on ${t.id}`);return t.registerDayIndex(pv)}},vv=e=>class extends($f(e||ue)){static get $name(){return"RecurringEventsMixin"}getRecurringEvents(){return this.getRecurringTimeSpans()}isEventPersistable(e){return super.isEventPersistable(e)&&(!e.supportsRecurring||!e.isOccurrence)}};const yv=Yf(xp.derive(ji));class bv extends(yv.mixin(vv,av,fv,lv)){static $name="EventStore";static get defaultConfig(){return{modelClass:Kf}}}bv._$name="EventStore";var Cv=e=>class extends e{static get $name(){return"DependencyStoreMixin"}static get defaultConfig(){return{loadPriority:400,syncPriority:400,storeId:"dependencies"}}reduceEventDependencies(e,t,n,r=!0,s){return s=s||(e=>this.getEventDependencies(e)),(e=ge.asArray(e)).reduce(((e,n)=>{n.children&&!r?n.traverse((n=>{e=s(n).reduce(t,e)})):e=s(n).reduce(t,e)}),n),n}mapEventDependencies(e,t,n,r,s){return this.reduceEventDependencies(e,((e,t)=>(n(t)&&e.push(t),e)),[],r,s)}mapEventPredecessors(e,t,n,r){return this.reduceEventPredecessors(e,((e,t)=>(n(t)&&e.push(t),e)),[],r)}mapEventSuccessors(e,t,n,r){return this.reduceEventSuccessors(e,((e,t)=>(n(t)&&e.push(t),e)),[],r)}getEventDependencies(e){return[].concat(e.predecessors||[],e.successors||[])}removeEventDependencies(e){this.remove(this.getEventDependencies(e))}removeEventPredecessors(e){this.remove(e.predecessors)}removeEventSuccessors(e,t){this.remove(e.successors)}getBySourceTargetId(e){return this.records.find((t=>e==this.constructor.makeDependencySourceTargetCompositeKey(t.from,t.to)))}getDependencyForSourceAndTargetEvents(e,t){return e=Ns.asId(e),t=Ns.asId(t),this.getBySourceTargetId(this.constructor.makeDependencySourceTargetCompositeKey(e,t))}getEventsLinkingDependency(e,t){return this.getDependencyForSourceAndTargetEvents(e,t)||this.getDependencyForSourceAndTargetEvents(t,e)}async isValidDependency(e,t,n){let r=e,s=t;return null!=e&&(e.isDependencyModel&&({fromEvent:r,toEvent:s}=e),r=this.eventStore.getById(r),s=this.eventStore.getById(s),r&&s?!(!r.project||!s.project)&&this.project.isValidDependency(r,s,n):e!==t)}isValidDependencyToCreate(e,t,n){return this.isValidDependency(e,t,n)}getHighlightedDependencies(e){return this.records.reduce(((t,n)=>(n.isHighlightedWith(e)&&t.push(n),t)),[])}static makeDependencySourceTargetCompositeKey(e,t){return`source(${e})-target(${t})`}getTimeSpanDependencies(e){return this.getEventDependencies(e)}};const Sv=Yf(wp.derive(ji));class wv extends(Cv(Sv.derive(ji))){static get defaultConfig(){return{modelClass:Jf}}}wv._$name="DependencyStore";var Dv=e=>class extends(e||ue){static get $name(){return"ResourceStoreMixin"}get isResourceStore(){return!0}static get defaultConfig(){return{loadPriority:200,syncPriority:100,storeId:"resources",autoTree:!0}}construct(e){if(super.construct(e),!this.modelClass.isResourceModel)throw new Error("Model for ResourceStore must subclass ResourceModel")}removeAll(){const e=super.removeAll(...arguments);return e&&this.assignmentStore.removeAll(),e}onRecordIdChange({record:e,oldValue:t,value:n}){super.onRecordIdChange({record:e,oldValue:t,value:n}),e.isFieldModified("id")&&(this.isChangingId=!0,e.updateAssignmentResourceIds(),this.isChangingId=!1)}get allResourceRecords(){return this._allResourceRecords||(this._allResourceRecords=this.getAllDataRecords())}getAvailableResources({startDate:e,endDate:t}){return this.query((n=>this.eventStore.isDateRangeAvailable(e,t,null,n)))}};const Tv=Yf(kp.derive(ji));class Ev extends(Dv(Tv)){static get defaultConfig(){return{modelClass:nv}}}Ev._$name="ResourceStore";var xv=e=>class extends e{static get $name(){return"AssignmentStoreMixin"}static get defaultConfig(){return{loadPriority:300,syncPriority:300,storeId:"assignments"}}add(e,...t){e=ge.asArray(e);for(let t=0;t<e.length;t++){var n;let r=e[t];if(r instanceof Ns||(e[t]=r=this.createRecord(r)),!this.isSyncingDataOnLoad&&-1!==this.storage.findIndex("eventResourceKey",r.eventResourceKey,!0))throw new Error(`Duplicate assignment Event: ${r.eventId} to resource: ${r.resourceId}`);null!==(n=r.event)&&void 0!==n&&n.isCreating&&(r.isCreating=!0)}return super.add(e,...t)}includesAssignment(e,t){return-1!==this.storage.findIndex("eventResourceKey",`${e}-${t}`,!0)}setStoreData(e){if(this.usesSingleAssignment)throw new Error("Data loading into AssignmentStore (multi-assignment mode) cannot be combined EventStore data containing resourceId (single-assignment mode)");super.setStoreData(e)}set storage(e){super.storage=e,this.storage.addIndex({property:"eventResourceKey",dependentOn:{event:!0,resource:!0},onDuplicate(e){console.warn(`Duplicate assignment of event ${e.eventId} to resource ${e.resourceId}`)}})}get storage(){return this._storage||super.storage}get isAssignmentStore(){return!0}getOccurrence(e,t){if(!e||null==t||!t.isOccurrence)return e;const n=this;return{id:`${t.id}:a${e.id}`,event:t,resource:e.resource,eventId:t.id,resourceId:e.resource.id,isAssignment:!0,isOccurrenceAssignment:!0,instanceMeta(e){return n.occurrenceInstanceMeta(this,e)}}}occurrenceInstanceMeta(e,t){const n=this,r=t.id||t,{id:s}=e;let{occurrenceMeta:i}=n;return i||(i=n.occurrenceMeta={}),i[s]||(i[s]={}),i[s][r]||(i[s][r]={})}mapAssignmentsForEvent(e,t,n){e=this.eventStore.getById(e);const r=Boolean(t),s=Boolean(n);return r||s?e.assignments.reduce(((e,i)=>{const a=r?t(i):i;return s&&!n(a)||e.push(a),e}),[]):e.assignments}mapAssignmentsForResource(e,t,n){e=this.resourceStore.getById(e);const r=Boolean(t),s=Boolean(n);return r||s?e.assignments.reduce(((e,i)=>{const a=r?t(i):i;return s&&!n(a)||e.push(a),e}),[]):e.assignments}getAssignmentsForEvent(e){return e.assignments}removeAssignmentsForEvent(e){return this.remove(e.assignments)}getAssignmentsForResource(e){return(e=this.resourceStore.getById(e)).assignments}removeAssignmentsForResource(e){this.remove(this.getAssignmentsForResource(e))}getResourcesForEvent(e){return e.resources}getEventsForResource(e){var t;return null===(t=e=this.resourceStore.getById(e))||void 0===t?void 0:t.events}assignEventToResource(e,t,n=null,r=!1){var s;const i=this,a=r?new Set(e.assignments):null;if(t=ge.asArray(t).map((e=>e.$original??e)),null!==(s=i.eventStore)&&void 0!==s&&s.usesSingleAssignment){var o,l;if(null!==(o=e.assignments)&&void 0!==o&&o.length)return i.isEventAssignedToResource(e,t[0])||(e.resource=t[0]),[];e.resourceId=null===(l=t[0])||void 0===l?void 0:l.id}let c=[];return i.suspendAutoCommit(),t.forEach((t=>{const s=i.getAssignmentForEventAndResource(e,t);if(s)r&&a.delete(s);else{const r={event:e,resource:t};c.push((null==n?void 0:n(r))??r)}})),c=i.add(c),r&&i.remove(Array.from(a)),i.resumeAutoCommit(),c}unassignEventFromResource(e,t){const n=this,r=[];if(!t)return n.removeAssignmentsForEvent(e);t=ge.asArray(t);for(let s=0;s<t.length;s++)n.isEventAssignedToResource(e,t[s])&&r.push(n.getAssignmentForEventAndResource(e,t[s]));return n.remove(r)}isEventAssignedToResource(e,t){return Boolean(this.getAssignmentForEventAndResource(e,t))}getAssignmentForEventAndResource(e,t){let n;return(e=this.eventStore.getById(e))&&(n=e.assignments)&&(t=this.resourceStore.$master.getById(t))?this.getOccurrence(n.find((e=>{var n;return(null===(n=e.resource)||void 0===n?void 0:n.$original)===t.$original})),e):null}};const kv=Yf(vp.derive(ji));class Iv extends(xv(kv)){static $name="AssignmentStore";static get defaultConfig(){return{modelClass:iv}}}Iv._$name="AssignmentStore";const Rv=Ap;class Mv extends(Wf(zf(Rv))){static get $name(){return"ProjectModel"}static get defaultConfig(){return{eventModelClass:Kf,dependencyModelClass:Jf,resourceModelClass:nv,assignmentModelClass:iv,eventStoreClass:bv,dependencyStoreClass:wv,resourceStoreClass:Ev,assignmentStoreClass:Iv}}construct(...e){super.construct(...e),P.isTestEnv&&(globalThis.bryntum.testProject=this),this.modelPersistencyManager=this.createModelPersistencyManager()}createModelPersistencyManager(){return new Hf({eventStore:this,resourceStore:this.resourceStore,assignmentStore:this.assignmentStore,dependencyStore:this.dependencyStore})}doDestroy(){this.modelPersistencyManager.destroy(),super.doDestroy()}get taskStore(){return this.eventStore}}Mv.applyConfigs=!0,Mv.initClass(),Mv._$name="ProjectModel";var Ov=e=>class extends e{static get $name(){return"AbstractCrudManagerValidation"}static get configurable(){return{validateResponse:!0,skipSuccessProperty:!0,crudLoadValidationWarningPrefix:"CrudManager load response error(s):",crudSyncValidationWarningPrefix:"CrudManager sync response error(s):",supportShortSyncResponseNote:'Note: Please consider enabling "supportShortSyncResponse" option to allow less detailed sync responses (https://bryntum.com/products/scheduler/docs/api/Scheduler/crud/AbstractCrudManagerMixin#config-supportShortSyncResponse)',disableValidationNote:'Note: To disable this validation please set the "validateResponse" config to false'}}get crudLoadValidationMandatoryStores(){return[]}getStoreLoadResponseWarnings(e,t,n){const r=[],{storeId:s}=e,i=this.crudLoadValidationMandatoryStores,a={[s]:{}};return t?t.rows||(r.push(`- "${s}" store section should have a "rows" property with an array of the store records.`),a[s].rows=["..."]):null!=i&&i.includes(s)&&(r.push(`- No "${s}" store section found. It should contain the store data.`),a[s].rows=["..."]),r.length&&Object.assign(n,a),r}getLoadResponseWarnings(e){const t=[],n={};return this.skipSuccessProperty||(n.success=!0),this.forEachCrudStore(((r,s,i)=>{t.push(...this.getStoreLoadResponseWarnings(i,null==e?void 0:e[s],n))})),t.length&&(t.push("Please adjust your response to look like this:\n"+JSON.stringify(n,null,4).replace(/"\.\.\."/g,"...")),t.push(this.disableValidationNote)),t}validateLoadResponse(e){const t=this.getLoadResponseWarnings(e);t.length&&console.warn(this.crudLoadValidationWarningPrefix+"\n"+t.join("\n"))}getStoreSyncResponseWarnings(e,t,n,r){const s=[],i=[],a=[],{storeId:o}=e,l={[o]:{}},c=e.phantomIdField||this.phantomIdField,{modelClass:d}=e.store,{idField:u}=d,h=(null==n?void 0:n.rows)||[],g=(null==n?void 0:n.removed)||[];let m=!1;if(null!=t&&t.added&&(i.push(...t.added.filter((e=>!h.find((t=>t[c]==e[c]))&&!g.find((t=>t[c]==e[c]||t[u]==e[c])))).map((e=>({[c]:e[c],[u]:"..."})))),i.length)){const e=i.map((e=>"#"+e[c])).join(", ");s.push(`- "${o}" store "rows" section should mention added record(s) ${e} sent in the request. It should contain the added records identifiers (both phantom and "real" ones assigned by the backend).`)}if(this.supportShortSyncResponse)!i.length&&n&&(("object"!=typeof n||Array.isArray(n))&&(s.push(`- "${o}" store section should be an Object.`),l[o]["..."]="..."),n.rows&&!Array.isArray(n.rows)&&(s.push(`- "${o}" store "rows" section should be an array`),i.push("...")),n.removed&&!Array.isArray(n.removed)&&(s.push(`- "${o}" store "removed" section should be an array:`),a.push("...")));else{if(null!=t&&t.updated){const e=t.updated.filter((e=>!h.find((t=>t[u]==e[u])))).map((e=>({[u]:e[u]})));if(i.push(...e),e.length){const t=e.map((e=>"#"+e[u])).join(", ");s.push(`- "${o}" store "rows" section should mention updated record(s) ${t} sent in the request. It should contain the updated record identifiers.`),m=!0}}if(i.length&&i.push("..."),null!=t&&t.removed&&(a.push(...t.removed.filter((e=>!h.find((t=>t[u]==e[u])))).map((e=>({[u]:e[u]})))),a.length)){const e=a.map((e=>"#"+e[u])).join(", ");s.push(`- "${o}" store "removed" section should mention removed record(s) ${e} sent in the request. It should contain the removed record identifiers.`),l[o].removed=a,a.push("..."),m=!0}}return i.length&&(l[o].rows=i),s.length||delete l[o],Object.assign(r,l),{messages:s,showSupportShortSyncResponseNote:m}}getSyncResponseWarnings(e,t){const n=[],r={},s=t.pack;this.skipSuccessProperty||(r.success=!0);let i=!1;return this.forEachCrudStore(((t,a,o)=>{const l=this.getStoreSyncResponseWarnings(o,null==s?void 0:s[a],e[a],r);i=i||l.showSupportShortSyncResponseNote,n.push(...l.messages)})),n.length&&(n.push("Please adjust your response to look like this:\n"+JSON.stringify(r,null,4).replace(/"\.\.\.":\s*"\.\.\."/g,",,,").replace(/"\.\.\."/g,"...")),i&&n.push(this.supportShortSyncResponseNote),n.push(this.disableValidationNote)),n}validateSyncResponse(e,t){const n=this.getSyncResponseWarnings(e,t);n.length&&console.warn(this.crudSyncValidationWarningPrefix+"\n"+n.join("\n"))}};class Av extends Error{}class Fv extends Av{constructor(e={}){var t,n;super(e.message||e.request&&T.capitalize(null===(t=e.request)||void 0===t?void 0:t.type)+" failed"||"Crud Manager request failed"),Object.assign(this,e),this.action=null===(n=this.request)||void 0===n?void 0:n.type}}const Pv=function(e,t,n){return e.store&&(e=e.store),t.store&&(t=t.store),(e=e[n]||0)<(t=t[n]||0)?-1:e>t?1:0},Lv=function(e,t){return Pv(e,t,"loadPriority")},$v=function(e,t){return Pv(e,t,"syncPriority")};var _v=e=>{e.$$meta=e.$meta;const t=[];return e.isEvents||t.push(Ne),e.isDelayable||t.push(Ur),t.push(Ov),class extends((e||ue).mixin(...t)){static get $name(){return"AbstractCrudManagerMixin"}static get defaultConfig(){return{crudRevision:null,crudStores:[],storeIdProperty:"storeId",crudFilterParam:"filter",transport:{},trackResponseType:!1,supportShortSyncResponse:!0,phantomIdField:"$PhantomId",phantomParentIdField:"$PhantomParentId",autoLoad:!1,autoSyncTimeout:100,autoSync:!1,resetIdsBeforeSync:!0,syncApplySequence:[],orderedCrudStores:[],writeAllFields:!1,crudIgnoreUpdates:0,autoSyncSuspendCounter:0,crudLoaded:!1,applyingLoadResponse:!1,applyingSyncResponse:!1,callOnFunctions:!0}}static configurable={loadUrl:null,syncUrl:null,forceSync:null};static delayable={doAutoLoad:"raf"};get isCrudManager(){return!0}construct(e={}){this._requestId=0,this.activeRequests={},this.crudStoresIndex={},super.construct(e)}afterConstruct(){super.afterConstruct(),this.autoLoad&&(this._autoLoadPromise=this.doAutoLoad())}get loadUrl(){var e,t;return null===(e=this.transport)||void 0===e||null===(t=e.load)||void 0===t?void 0:t.url}updateLoadUrl(e){Ut.setPath(this,"transport.load.url",e)}get syncUrl(){var e,t;return null===(e=this.transport)||void 0===e||null===(t=e.sync)||void 0===t?void 0:t.url}updateSyncUrl(e){Ut.setPath(this,"transport.sync.url",e)}getStoreDescriptor(e){return e?e instanceof Li?this.crudStores.find((t=>t.store===e)):"object"==typeof e?this.crudStoresIndex[e.storeId]:this.crudStoresIndex[e]||this.getStoreDescriptor(Li.getStore(e)):null}fillStoreDescriptor(e){const{store:t}=e,{storeIdProperty:n=this.storeIdProperty,modelClass:r}=t;return e.storeId||(e.storeId=t[n]||t.id),e.idField||(e.idField=r.idField),e.phantomIdField||(e.phantomIdField=r.phantomIdField),e.phantomParentIdField||(e.phantomParentIdField=r.phantomParentIdField),"writeAllFields"in e||(e.writeAllFields=t.writeAllFields),e}updateCrudStoreIndex(){const e=this.crudStoresIndex={};this.crudStores.forEach((t=>t.storeId&&(e[t.storeId]=t)))}getCrudStore(e){const t=this.getStoreDescriptor(e);return null==t?void 0:t.store}forEachCrudStore(e,t=this){if(!e)throw new Error("Iterator function must be provided");this.crudStores.every((n=>!1!==e.call(t,n.store,n.storeId,n)))}set crudStores(e){this._crudStores=[],this.addCrudStore(e);for(const e of this._crudStores)e.loadPriority=e.syncPriority=0}get crudStores(){return this._crudStores}get orderedCrudStores(){return this._orderedCrudStores}set orderedCrudStores(e){return this._orderedCrudStores=e}set syncApplySequence(e){this._syncApplySequence=[],this.addStoreToApplySequence(e)}get syncApplySequence(){return this._syncApplySequence}internalAddCrudStore(e){const t=this;let n;return e instanceof Li?n={store:e}:"object"==typeof e?(e.store||(e={storeId:e.id,store:new Li(e)}),n=e):n={store:Li.getStore(e)},t.fillStoreDescriptor(n),(e=n.store).setCrudManager?e.setCrudManager(t):e.crudManager=t,e.pageSize=null,(t.loadUrl||t.syncUrl)&&(e.autoCommit=!1,e.autoLoad=!1,(e.createUrl||e.updateUrl||e.deleteUrl||e.readUrl)&&console.warn("You have configured an URL on a Store that is handled by a CrudManager that is also configured with an URL. The Store URL's should be removed.")),t.bindCrudStoreListeners(e),n}addCrudStore(e,t,n){var r;if(null===(r=e=ge.asArray(e))||void 0===r||!r.length)return;const s=this,i=e.map(s.internalAddCrudStore,s);void 0===t?s.crudStores.push(...i):(n&&((n instanceof Li||"object"!=typeof n)&&(n=s.getStoreDescriptor(n)),t+=s.crudStores.indexOf(n)),s.crudStores.splice(t,0,...i)),s.orderedCrudStores.push(...i),s.updateCrudStoreIndex()}addPrioritizedStore(e){const t=this;t.hasCrudStore(e)||t.addCrudStore(e,ge.findInsertionIndex(e,t.crudStores,Lv)),t.hasApplySequenceStore(e)||t.addStoreToApplySequence(e,ge.findInsertionIndex(e,t.syncApplySequence,$v))}hasCrudStore(e){var t;return null===(t=this.crudStores)||void 0===t?void 0:t.some((t=>t===e||t.store===e||t.storeId===e))}removeCrudStore(e){const t=this,n=t.crudStores,r=n.find((t=>t===e||t.store===e||t.storeId===e));if(!r)throw new Error("Store not found in stores collection");t.unbindCrudStoreListeners(r.store),delete t.crudStoresIndex[r.storeId],ge.remove(n,r),t.syncApplySequence&&t.removeStoreFromApplySequence(e)}bindCrudStoreListeners(e){e.ion({name:e.id,addConfirmed:"onCrudStoreChange",change:"onCrudStoreChange",destroy:"onCrudStoreDestroy",thisObj:this})}unbindCrudStoreListeners(e){this.detachListeners(e.id)}addStoreToApplySequence(e,t,n){if(!e)return;e=ge.asArray(e);const r=this,s=e.reduce(((e,t)=>{const n=r.getStoreDescriptor(t);return n&&e.push(n),e}),[]);if(void 0===t)r.syncApplySequence.push(...s);else{let e=t;n&&((n instanceof Li||"object"!=typeof n)&&(n=r.getStoreDescriptor(n)),e+=r.syncApplySequence.indexOf(n)),r.syncApplySequence.splice(e,0,...s)}const i=r.syncApplySequence.map((({storeId:e})=>e));r.orderedCrudStores=[...r.syncApplySequence],r.crudStores.forEach((e=>{i.includes(e.storeId)||r.orderedCrudStores.push(e)}))}removeStoreFromApplySequence(e){const t=this.syncApplySequence.findIndex((t=>t===e||t.store===e||t.storeId===e));t>-1&&(this.syncApplySequence.splice(t,1),this.orderedCrudStores.splice(t,1))}hasApplySequenceStore(e){return this.syncApplySequence.some((t=>t===e||t.store===e||t.storeId===e))}onCrudStoreDestroy({source:e}){this.removeCrudStore(e)}onCrudStoreChange(e){const t=this;t.crudIgnoreUpdates||(t.crudStoreHasChanges(null==e?void 0:e.source)?(t.trigger("hasChanges"),t.autoSync&&t.scheduleAutoSync()):t.trigger("noChanges"))}suspendAutoSync(){this.autoSyncSuspendCounter++}resumeAutoSync(e=!0){const t=this;t.autoSyncSuspendCounter--,t.autoSyncSuspendCounter<=0&&(t.autoSyncSuspendCounter=0,e&&t.autoSync&&t.crudStoreHasChanges()&&t.scheduleAutoSync())}get isAutoSyncSuspended(){return this.autoSyncSuspendCounter>0}scheduleAutoSync(){const e=this;e.hasTimeout("autoSync")||e.isAutoSyncSuspended||e.setTimeout({name:"autoSync",fn:()=>{e.sync().catch((e=>{}))},delay:e.autoSyncTimeout})}async triggerFailedRequestEvents(e,t,n,r){const{options:s,type:i}=e;this.trigger("requestFail",{requestType:i,response:t,responseText:n,responseOptions:r}),this.trigger(i+"Fail",{response:t,responseOptions:r,responseText:n,options:s})}async internalOnResponse(e,t,n){const r=this,s=t?r.decode(t):null,{options:i,type:a}=e;if(t&&!s&&console.error("Failed to parse response: "+t),s&&(r.skipSuccessProperty?!1!==s.success:s.success)){if(!1!==r.trigger("beforeResponseApply",{requestType:a,response:s})&&!1!==r.trigger(`before${T.capitalize(a)}Apply`,{response:s,options:i})){if(r.crudRevision=s.revision,await r.applyResponse(e,s,i),r.isDestroyed)return;r.trigger("requestDone",{requestType:a,response:s,responseOptions:n}),r.trigger(a,{response:s,responseOptions:n,options:i}),"load"!==a&&r.crudStoreHasChanges()||(r.trigger("noChanges"),"load"===a&&r.emitCrudStoreEvents(e.pack.stores,"afterRequest"))}}else r.triggerFailedRequestEvents(e,s,t,n);return s}suspendChangeTracking(){this.crudIgnoreUpdates++}resumeChangeTracking(e){!this.crudIgnoreUpdates||--this.crudIgnoreUpdates||e||this.onCrudStoreChange()}get isChangeTrackingSuspended(){return this.crudIgnoreUpdates>0}crudStoreHasChanges(e){return e?this.isCrudStoreDirty(this.getCrudStore(e)):this.crudStores.some((e=>this.isCrudStoreDirty(e.store)))}isCrudStoreDirty(e){return Boolean(e.changes)}doAutoLoad(){return this.load().catch((e=>{}))}emitCrudStoreEvents(e,t,n){const r={action:"read"+t,...n};for(const n of this.crudStores)e.includes(n.storeId)&&n.store.trigger(t,r)}getLoadPackage(e){const t={type:"load",requestId:this.requestId},n=this.crudStores,r=Object.assign({},e);return delete r.request,t.stores=n.map((e=>{var t;const n=null==r?void 0:r[e.storeId],s=e.pageSize||(null===(t=e.store)||void 0===t?void 0:t.pageSize);if(n||s){const t=Object.assign({storeId:e.storeId,page:1},n);return s&&(t.pageSize=s),e.currentPage=t.page,n&&delete r[e.storeId],t}return e.storeId})),Object.assign(t,r),t}loadCrudStore(e,t,n){const r=null==t?void 0:t.rows;null!=n&&n.append||null!=t&&t.append?e.add(r,!1,{clean:!0}):e.data=r,e.trigger("load",{data:r})}loadDataToCrudStore(e,t,n){const r=e.store,s=null==t?void 0:t.rows;r.__loading=!0,s&&this.loadCrudStore(r,t,n,e),r.__loading=!1}loadCrudManagerData(e,t={}){const n=this;n.trigger("beforeLoadCrudManagerData"),n.suspendChangeTracking(),n.crudStores.forEach((r=>{const s=r.storeId,i=e[s];i&&n.loadDataToCrudStore(r,i,t[s])})),n.resumeChangeTracking(!0),n.trigger("loadCrudManagerData")}get isCrudManagerLoading(){return Boolean(this.activeRequests.load||this.applyingLoadResponse)}get isCrudManagerSyncing(){return Boolean(this.activeRequests.sync||this.applyingSyncResponse)}get isLoadingOrSyncing(){return Boolean(this.isCrudManagerLoading||this.isCrudManagerSyncing)}load(e){"string"==typeof e&&(e={request:{url:e}});const t=this,n=t.getLoadPackage(e);return t._autoLoadPromise=null,new Promise(((r,s)=>{if(!1!==t.trigger("beforeLoad",{pack:n})){var i;const{load:a}=t.activeRequests;a&&(t.cancelRequest(a.desc,a.reject),t.trigger("loadCanceled",{pack:n}));const o=F.assign({id:n.requestId,data:t.encode(n),type:"load",success:t.onCrudRequestSuccess,failure:t.onCrudRequestFailure,thisObj:t},null===(i=e)||void 0===i?void 0:i.request);t.activeRequests.load={type:"load",options:e,pack:n,resolve:r,reject(...e){o.success=o.failure=null,s(...e)},id:n.requestId,desc:t.sendRequest(o)},t.emitCrudStoreEvents(n.stores,"loadStart"),t.trigger("loadStart",{pack:n})}else t.trigger("loadCanceled",{pack:n}),s({cancelled:!0})}))}getActiveCrudManagerRequest(e){let t=this.activeRequests[e];return!t&&this.trackResponseType&&(t=Object.values(this.activeRequests)[0]),t}prepareAddedRecordData(e,t){const n=this,{store:r}=t,{isTree:s}=r,i=t.phantomIdField||n.phantomIdField,a=t.phantomParentIdField||n.phantomParentIdField,o=r.modelClass.allFields.filter((e=>e.subStore)),l=e.constructor,c=Object.assign(e.persistableData,{[i]:e.id});if(s){const{parent:t}=e;t&&!t.isRoot&&t.isPhantom&&(c[a]=t.id)}return n.resetIdsBeforeSync&&Ut.deletePath(c,l.idField),o.forEach((t=>{const r=e.get(t.name);r.allCount&&(c[t.dataSource]={added:r.getRange().map((e=>n.prepareAddedRecordData(e,{store:r})))})})),c}prepareAdded(e,t){return e.filter((e=>e.isValid)).map((e=>this.prepareAddedRecordData(e,t)))}prepareUpdated(e,t){const{store:n}=t,{isTree:r}=n,s=t.writeAllFields||!1!==t.writeAllFields&&this.writeAllFields,i=t.phantomParentIdField||this.phantomParentIdField,a=n.modelClass.allFields.filter((e=>e.subStore));if(t.store.tree){const n=t.store.rootNode;e=e.filter((e=>e!==n))}return e.filter((e=>e.isValid)).reduce(((e,t)=>{let n;if(n=s?t.persistableData:t.modificationDataToWrite,r){const{parent:e}=t;e&&!e.isRoot&&e.isPhantom&&(n[i]=e.id)}return a.forEach((e=>{const r=t.get(e.name);n[e.dataSource]=this.getCrudStoreChanges({store:r})})),Ut.isEmpty(n)||e.push(n),e}),[])}prepareRemoved(e){return e.map((e=>{const t=e.constructor;return Ut.setPath({},t.idField,e.id)}))}getCrudStoreChanges(e){const{store:t}=e;let n,{added:r=[],modified:s=[],removed:i=[]}=t.changes||{};return r.length&&(r=this.prepareAdded(r,e)),s.length&&(s=this.prepareUpdated(s,e)),i.length&&(i=this.prepareRemoved(i)),(r.length||s.length||i.length)&&(n={},r.length&&(n.added=r),s.length&&(n.updated=s),i.length&&(n.removed=i)),n}getChangesetPackage(){const{changes:e}=this;return e||this.forceSync?{type:"sync",requestId:this.requestId,revision:this.crudRevision,...e}:null}get changes(){const e={};return this.crudStores.forEach((t=>{const n=this.getCrudStoreChanges(t);n&&(e[t.storeId]=n)})),Object.keys(e).length>0?e:null}getRowsToApplyChangesTo({store:e,storeId:t},n,r){var s,i;const a=this,{modelClass:o}=e,l=o.idField,{updated:c,removed:d}=r||{};let u,h,g;if(n){var m,p;g=!0;const e={};u=(null===(m=n.rows)||void 0===m?void 0:m.slice())||[],h=(null===(p=n.removed)||void 0===p?void 0:p.slice())||[],[...u,...h].forEach((t=>{const n=Ut.getPath(t,l);e[n]=!0})),a.supportShortSyncResponse&&(null==c||c.forEach((t=>{const n=Ut.getPath(t,l);e[n]||u.push({[l]:n})})),null==d||d.forEach((t=>{const n=Ut.getPath(t,l);e[n]||h.push({[l]:n})})))}else(c||d)&&(g=!1,u=c,h=d);return u=null!==(s=u)&&void 0!==s&&s.length?u:null,h=null!==(i=h)&&void 0!==i&&i.length?h:null,{rows:u,removed:h,remote:g}}applyChangesToStore(e,t,n){const r=this,s=e.phantomIdField||r.phantomIdField,{store:i}=e,a=i.modelClass.getFieldDataSource("id"),o=i.modelClass.allFields.filter((e=>e.subStore)),{rows:l,removed:c,remote:d}=r.getRowsToApplyChangesTo(e,t,n),u=[],h=[];if(l)for(const e of l)i.getById(e[s]??e[a])?h.push(e):u.push(e);const g=[];h.length&&o.length&&h.forEach((e=>{var t,l;const c=i.getById(e[s]??e[a]),d=(null===(t=n.added)||void 0===t?void 0:t.find((t=>t[s]==e[s])))||(null===(l=n.updated)||void 0===l?void 0:l.find((t=>t[a]==e[a]))),u={};o.forEach((t=>{const n=c.get(t.name);r.applyChangesToStore({store:n},e[t.dataSource],null==d?void 0:d[t.dataSource]),u[t.dataSource]="foo",delete e[t.dataSource]})),g.push([c,u])}));const m=i.applyChangeset({removed:c,added:u,updated:h},null,s,d,!0);return g.forEach((([e,t])=>Object.assign(m.get(e.id),t))),m}applySyncResponse(e,t){const n=this,r=n.orderedCrudStores;n.applyingChangeset=n.applyingSyncResponse=!0,n.suspendChangeTracking();for(const i of r){var s;n.applyChangesToStore(i,e[i.storeId],null==t||null===(s=t.pack)||void 0===s?void 0:s[i.storeId])}n.resumeChangeTracking(!0),n.applyingChangeset=n.applyingSyncResponse=!1}applyLoadResponse(e,t){this.applyingLoadResponse=!0,this.loadCrudManagerData(e,t),this.applyingLoadResponse=!1}async applyResponse(e,t,n){const r=this;switch(r.trackResponseType&&t.type||e.type){case"load":r.validateResponse&&r.validateLoadResponse(t),r.applyLoadResponse(t,n);break;case"sync":r.validateResponse&&r.validateSyncResponse(t,e),r.applySyncResponse(t,e)}}applyChangeset(e,t=null,n,r=!1){const s=this,i=r?new Map:void 0;s.suspendAutoSync(),s.suspendChangeTracking();for(const{store:n,phantomIdField:a}of s.orderedCrudStores)if(e[n.id]){const o=n.applyChangeset(e[n.id],t,a||s.phantomIdField,!0,r);o&&i.set(n.id,o)}return s.resumeChangeTracking(!0),s.resumeAutoSync(!1),i}get requestId(){return Number.parseInt(`${Date.now()}${this._requestId++}`)}sync(){const e=this;return e.clearTimeout("autoSync"),e.activeRequests.sync?(e.trigger("syncDelayed"),e.activeSyncPromise=e.activeSyncPromise.finally((()=>e.sync()))):e.activeSyncPromise=new Promise(((t,n)=>{const r=e.getChangesetPackage();r?!1!==e.trigger("beforeSync",{pack:r})?(e.trigger("syncStart",{pack:r}),e.activeRequests.sync={type:"sync",pack:r,resolve:t,reject:n,id:r.requestId,desc:e.sendRequest({id:r.requestId,data:e.encode(r),type:"sync",success:e.onCrudRequestSuccess,failure:e.onCrudRequestFailure,thisObj:e})}):(e.trigger("syncCanceled",{pack:r}),n({cancelled:!0})):t(null)})).catch((e=>{if(e&&!e.cancelled)throw e;return e}))}async onCrudRequestSuccess(e,t,n){var r;const s=this,{type:i,id:a}=n;if(s.isDestroyed)return;let o="";n=s.activeRequests[i];try{o=await e.text()}catch(e){}if(s.isDestroyed)return;if((null===(r=n)||void 0===r?void 0:r.id)!==a)throw new Error(`Interleaved ${i} operation detected`);s.activeRequests[i]=null;const l=await s.internalOnResponse(n,o,t);if(!s.isDestroyed){if(!l||(s.skipSuccessProperty?!1===(null==l?void 0:l.success):null==l||!l.success)){const t={rawResponse:e,response:l,request:n};null!=l&&l.message&&(t.message=l.message),n.reject(new Fv(t))}s["crud"+T.capitalize(n.type)+"ed"]=!0,n.resolve({response:l,rawResponse:e,responseText:o,request:n})}}async onCrudRequestFailure(e,t,n){var r;const s=this;if(s.isDestroyed)return;n=s.activeRequests[n.type];const i=null==t||null===(r=t.abortController)||void 0===r?void 0:r.signal;if(!Boolean(null==i?void 0:i.aborted)){let r,i="";try{i=await e.text(),r=s.decode(i)}catch(e){}if(s.isDestroyed)return;if(s.triggerFailedRequestEvents(n,r,i,t),s.isDestroyed)return;n.reject(new Fv({rawResponse:e,request:n}))}s.activeRequests[n.type]=null}acceptChanges(){this.crudStores.forEach((e=>e.store.acceptChanges()))}revertChanges(){this.revertCrudStoreChanges()}revertCrudStoreChanges(){const{usesSingleAssignment:e}=this.eventStore;this.orderedCrudStores.forEach((({store:t})=>(!t.isAssignmentStore||!e)&&t.revertChanges()))}doDestroy(){const e=this,{load:t,sync:n}=e.activeRequests;for(t&&e.cancelRequest(t.desc,t.reject),n&&e.cancelRequest(n.desc,n.reject);e.crudStores.length>0;)e.removeCrudStore(e.crudStores[0]);super.doDestroy&&super.doDestroy()}}},Nv=e=>class t extends(e||ue){static get $name(){return"AjaxTransport"}static get defaultMethod(){return{load:"GET",sync:"POST"}}cancelRequest(e,t){var n;null===(n=e.abort)||void 0===n||n.call(e),this.isDestroying||t({cancelled:!0})}shouldUseBodyForRequestData(e,t,n){return!("HEAD"===t||"GET"===t||n)}sendRequest(e){const n=this,{data:r}=e,s=n.transport[e.type]||{},i=F.assign({},s,s.requestConfig);e.url&&(i.url=e.url),i.method=i.method||t.defaultMethod[e.type],i.params=F.assign(i.params||{},e.params);let a,o,{paramName:l}=i;if(n.shouldUseBodyForRequestData(s,i.method,l)?(i.body=r,i.headers=i.headers||{},i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json"):(l=l||"data",i.params[l]=r),!i.url)throw new Error("Trying to request without URL specified");function c(){i.queryParams=i.params,delete i.params;let t=!1;const r=F.assign({},i,i.fetchOptions);return a=Be.fetch(i.url,r),a.catch((e=>{var s,i;a.done=!0,null===(s=n.trigger)||void 0===s||s.call(n,"responseReceived",{success:!1});const o=null===(i=r.abortController)||void 0===i?void 0:i.signal;return o&&(t=o.aborted,t||console.warn(e)),{error:e,cancelled:t}})).then((t=>{var s;a.done=!0,null===(s=n.trigger)||void 0===s||s.call(n,"responseReceived",{success:Boolean(null==t?void 0:t.ok)});const i=null!=t&&t.ok?e.success:e.failure;return null==i?void 0:i.call(e.thisObj||n,t,r,e)}))}delete i.requestConfig,delete i.paramName;const d=n.trigger("beforeSend",{params:i.params,requestType:e.type,requestConfig:i,config:e});return o=F.isPromise(d)?d.then(c):c(),o.abort=()=>{var e,t;a.done||(null===(e=(t=a).abort)||void 0===e||e.call(t))},o}},jv=e=>class extends(e||ue){static get $name(){return"JsonEncoder"}static get defaultConfig(){return{encoder:{}}}encode(e){var t;return e=Object.assign({},null===(t=this.encoder)||void 0===t?void 0:t.requestData,e),T.safeJsonStringify(e)}decode(e){return T.safeJsonParse(e)}},Vv=e=>class extends((e||ue).mixin(_v,Nv,jv)){static get defaultConfig(){return{project:null}}startConfigure(e){this.getConfig("project"),super.startConfigure(e),this._changesToClear=new Map}async doAutoLoad(){const{project:e}=this;return e&&await e.commitAsync(),super.doAutoLoad()}applyProjectResponse(e){const t=this,{project:n}=t;t.applyingProjectResponse=!0;const r=n.fieldMap.startDate,s=n.fieldMap.endDate,i=Ut.getPath(e,r.dataSource),a=Ut.getPath(e,s.dataSource);"string"==typeof i&&Ut.setPath(e,r.dataSource,r.convert(i)),"string"==typeof a&&Ut.setPath(e,s.dataSource,s.convert(a)),n.setByDataSource(e),t._changesToClear.set(t,e),t.applyingProjectResponse=!1}loadCrudManagerData(e,t={}){const n=this,{project:r}=n;n.suspendChangeTracking(),super.loadCrudManagerData(...arguments),null!=e&&e.project&&(r.delayEnteringReplica&&r.hasDataInStores?r.ion({recordsUnlinked:()=>{n.suspendChangeTracking(),n.applyProjectResponse(e.project),n.resumeChangeTracking()},once:!0}):n.applyProjectResponse(e.project)),n.resumeChangeTracking()}async sync(){const{project:e}=this;if(this.suspendAutoSync(),e&&await e.commitAsync(),!this.isDestroying)return this.resumeAutoSync(!1),super.sync()}async applyResponse(e,t,n){var r,s,i;const a=this;if(!(a.isDestroyed||null!==(r=a.project)&&void 0!==r&&r.isDestroyed)){var o;if(a.trigger("beforeApplyResponse"),await super.applyResponse(e,t,n),null!=t&&t.project||a.supportShortSyncResponse&&null!=e&&null!==(s=e.pack)&&void 0!==s&&s.project)a.applyProjectResponse(t.project||(null==e||null===(o=e.pack)||void 0===o?void 0:o.project));if(a.project){var l,c;let n=e.type;a.trackResponseType&&(n=t.type||n);const r=`propagating${T.capitalize(n)}Changes`;a.suspendAutoSync(),a[r]=!0;const s=a.project.isInitialCommit&&!a.project.silenceInitialCommit;await a.project.commitAsync(),a[r]=!1,null===(l=a.resumeAutoSync)||void 0===l||l.call(a,s),null===(c=a.commitRespondedChanges)||void 0===c||c.call(a)}null===(i=a.trigger)||void 0===i||i.call(a,"applyResponse")}}applySyncResponse(...e){var t;const n=this,r=null===(t=n.project)||void 0===t?void 0:t.stm.disabled;!1===r&&n.ignoreRemoteChangesInSTM&&n.project.stm.disable(),super.applySyncResponse(...e),!1===r&&n.project.stm.enable()}shouldClearRecordFieldChange(e,t,n){var r;const s=e.getValue(t);return null!==(r=t=e.getFieldDefinition(t))&&void 0!==r&&r.isEqual?t.isEqual(s,n):Ut.isEqual(s,n)}commitRespondedChanges(){this._changesToClear.forEach(((e,t)=>{Object.entries(e).forEach((([e,n])=>{this.shouldClearRecordFieldChange(t,e,n)&&delete t.meta.modified[e]}))})),this._changesToClear.clear()}applyChangesToStore(e,t,n,...r){const s=super.applyChangesToStore(e,t,n,...r);if(s.size&&this.project)for(const[t,n]of s){const r=e.store.getById(t);r&&this._changesToClear.set(r,n)}return s}};class Bv extends Kf{static $name="TaskModel";static fields=["status","prio","description","eventColor",{name:"weight",type:"number"},{name:"readOnly",type:"boolean"}]}Bv._$name="TaskModel";class zv extends bv{static configurable={autoAssignWeight:!0,storeId:"tasks",modelClass:Bv,removeUnassignedEvent:!1,sorters:[{field:"weight",ascending:!0}]};afterLoadData(){const{records:e}=this;if(this.autoAssignWeight&&!e.some((e=>null!=e.weight)))for(let t=0;t<e.length;t++)e[t].setData("weight",100*(t+1))}}zv._$name="TaskStore";class Wv extends(Mv.mixin(Vv)){static configurable={eventStoreClass:zv,eventModelClass:Bv,taskStoreClass:zv,taskModelClass:Bv};construct(e){e.tasks&&(e.eventsData=e.tasks),e.tasksData&&(e.eventsData=e.tasksData),e.taskStore&&(e.eventStore=e.taskStore),e.taskModelClass&&(e.eventModelClass=e.taskModelClass),e.taskStoreClass&&(e.eventStoreClass=e.taskStoreClass),super.construct(e);const t=this;t.addPrioritizedStore(t.assignmentStore),t.addPrioritizedStore(t.resourceStore),t.addPrioritizedStore(t.taskStore)}get taskStore(){return this.eventStore}set taskStore(e){this.eventStore=e}get tasksData(){return this.eventsData}set tasksData(e){this.eventsData=e}get tasks(){return this.eventsData}set tasks(e){this.events=e}toJSON(){const{taskStore:e,assignmentStore:t,resourceStore:n}=this,r={tasksData:e.toJSON()};return null!=t&&t.count&&(r.assignmentsData=t.toJSON()),null!=n&&n.count&&(r.resourcesData=n.toJSON()),r}}Wv._$name="ProjectModel";class Hv extends Ns{static $name="SwimlaneModel";static fields=[{name:"text",type:"string"},{name:"color",type:"string"},{name:"collapsible",type:"boolean",defaultValue:!0},{name:"collapsed",type:"boolean"},{name:"hidden",type:"boolean"},{name:"height",type:"number"},{name:"flex",type:"number"},"tasksPerRow"];get taskBoard(){return this.firstStore.taskBoard}async collapse(){this.taskBoard.collapse(this)}async expand(){return this.taskBoard.expand(this)}get tasks(){return[...this.taskBoard.getSwimlaneTasks(this)||[]]}}Hv._$name="SwimlaneModel";var Uv=e=>class extends(e||ue){static $name="ExpandCollapse";static configurable={showCollapseInHeader:!0,collapseTitle:!1,showCollapseTooltip:!0};get widgetClass(){}changeShowCollapseInHeader(e){return Ut.assertBoolean(e,"showCollapseInHeader"),e}async collapse(e){return this.toggleCollapse(e,!0)}async expand(e){return this.toggleCollapse(e,!1)}async toggleCollapse(e,t=!e.collapsed){e.isSwimlaneModel?await this.toggleSwimlaneCollapse(e,t):await this.toggleColumnCollapse(e,t)}async toggleSwimlaneCollapse(e,t=!e.collapsed){return new Promise((n=>{const r=this,s=r.getSwimlaneElement(e),i=go.getChild(s,"body");t&&(i.style.height=`${i.getBoundingClientRect().height}px`),Mn.onTransitionEnd({element:i,property:"height",handler(){t?s.style.height="":(i.style.height="",s.style.height=`${e.height}px`),s.classList.remove(t?"b-collapsing":"b-expanding"),r.recompose.flush(),n()},thisObj:r}),s.classList.add(t?"b-collapsing":"b-expanding"),r.suspendDomTransition(),e.collapsed=t,r.trigger("swimlane"+(t?"Collapse":"Expand"),{swimlaneRecord:e}),r.trigger("swimlaneToggle",{swimlaneRecord:e,collapse:t}),r.resumeDomTransition()}))}async toggleColumnCollapse(e,t=!e.collapsed){return new Promise((n=>{var r,s;const i=this,{documentRoot:a}=i,o=i.getColumnElements(e),l=go.getChild(i.bodyElement,`header.${e.domId}`),c=e.width&&!e.flex,d=a.querySelectorAll(`.b-taskboard-card[data-column="${e.domId}"]`),u=`${null===(r=d[0])||void 0===r?void 0:r.getBoundingClientRect().width}px`,h=`${null===(s=o[0])||void 0===s?void 0:s.getBoundingClientRect().width}px`;d.forEach((e=>{t&&(e.style.width=u)})),o.unshift(l),o.forEach((e=>{t?(c||(e.style.width=h),e.classList.add("b-collapsing")):e.classList.add("b-expanding")})),Mn.onTransitionEnd({element:l,property:"width",handler(){d.forEach((e=>{t||(e.style.width="")})),o.forEach((e=>{t?e.classList.remove("b-collapsing"):(c||(e.style.width=""),e.classList.remove("b-expanding"))})),i.recompose.flush(),i.scrollable.syncOverflowState(),n()},thisObj:i}),l.offsetWidth,i.suspendDomTransition(),e.collapsed=t,i.trigger("column"+(t?"Collapse":"Expand"),{columnRecord:e}),i.trigger("columnToggle",{columnRecord:e,collapse:t}),i.resumeDomTransition()}))}populateColumnHeader(e){var t;null===(t=super.populateColumnHeader)||void 0===t||t.call(this,e);const{showCollapseInHeader:n,collapseTitle:r,hasSwimlanes:s,showCollapseTooltip:i}=this,{columnRecord:a,columnHeaderConfig:o}=e,{text:l,collapsed:c,collapsible:d}=a;yr.merge(o,{class:{"b-collapsed":c,"b-rotate-title":c&&!r&&!s},style:{minWidth:c?null:a.minWidth},children:{padder:{children:{expander:n&&d&&{tag:"button",class:{"b-taskboard-column-expander":1,"b-fw-icon":1,"b-icon-expand-column":1},dataset:{btip:i?T.xss`${this.L(c?"L{TaskBoard.expand}":"L{TaskBoard.collapse}",l)}`:null}}}}}})}populateColumn(e){var t;null===(t=super.populateColumn)||void 0===t||t.call(this,e);const{columnRecord:n,columnConfig:r}=e,{collapsed:s}=n;r.class["b-collapsed"]=s,s&&(r.style.minWidth=null)}populateSwimlane(e){var t;null===(t=super.populateColumn)||void 0===t||t.call(this,e);const{swimlaneRecord:n,swimlaneConfig:r}=e;if(n){const{showCollapseInHeader:e,showCollapseTooltip:t}=this,{text:s,collapsed:i,collapsible:a}=n;yr.merge(r,{class:{"b-collapsed":i,"b-collapsible":a},children:{header:{children:{title:{children:{"expander > text":e&&a&&{tag:"button",class:{"b-taskboard-swimlane-expander":1,"b-icon":1,"b-icon-expand-row":1},dataset:{btip:t?T.xss`${this.L(i?"L{TaskBoard.expand}":"L{TaskBoard.collapse}",s)}`:null}}}}}},body:{[i?"inert":null]:!0}}})}}onColumnHeaderClick({event:e,columnRecord:t}){(e.target.matches(".b-taskboard-column-expander")||t.collapsed)&&this.toggleCollapse(t)}onColumnClick({columnRecord:e}){e.collapsed&&this.toggleCollapse(e)}onSwimlaneHeaderClick({swimlaneRecord:e}){this.toggleCollapse(e)}},Yv=e=>class extends(e||ue){static $name="ResponsiveCards";static configurable={cardSizes:[{maxWidth:50,name:"micro",maxAvatars:1,headerItems:{text:null},bodyItems:{text:null}},{maxWidth:75,name:"tiny",maxAvatars:1,bodyItems:{text:null}},{maxWidth:175,name:"small",maxAvatars:2,bodyItems:{text:null}},{maxWidth:250,name:"medium",maxAvatars:3},{name:"large",maxAvatars:7}],resizeObserver:{value:!0,$config:["nullify"]}};get widgetClass(){}changeCardSizes(e){return Ut.assertArray(e,"cardSizes"),e}responsivenessSuspended=0;suspendResponsiveness(){this.responsivenessSuspended++}resumeResponsiveness(){this.responsivenessSuspended--}getCardSize(e,t){const n=this,{cardSizes:r}=n,s=n.getTasksPerRow(e,t),i=(n.getColumnWidth(e)-n.cardGap*(s-1))/s;return(null==r?void 0:r.find((e=>i<e.maxWidth)))||(null==r?void 0:r[r.length-1])}getColumnWidth(e){return e.instanceMeta(this).width}getTasksPerRow(e,t){return e.tasksPerRow||(null==t?void 0:t.tasksPerRow)||this.tasksPerRow}onChildResize(e){const t=this;if(t.recompose.suspended||t.responsivenessSuspended)return;let n=!1;for(const r of e){const{target:e,contentRect:s}=r;if(e.observedWidth!==s.width){const r=t.resolveColumnRecord(e),i=r&&t.columns.includes(r)&&t.getColumnElements(r);if(!r||r.collapsed||r.hidden||!i)return;r.instanceMeta(t).width=e.observedWidth=s.width;for(const e of i){const s=t.resolveSwimlaneRecord(e),i=t.getCardSize(r,s);i&&e.elementData.cardSize!==i.name&&(n=!0)}}}n&&(t.recompose.now(),t.scrollable.syncOverflowState())}changeResizeObserver(e,t){return null==t||t.disconnect(),this.isDestroying||!ResizeObserver?null:new ResizeObserver(this.onChildResize.bind(this))}populateColumn(e){var t;null===(t=super.populateColumn)||void 0===t||t.call(this,e);const{columnRecord:n,swimlaneRecord:r,columnConfig:s}=e,i=e.cardSize=this.getCardSize(n,r);i&&(s.class[`b-${i.name}-cards`]=i,s.elementData.cardSize=i.name)}};const qv={remove:1,move:1,update:1,filter:1};var Kv=e=>class extends(e||ue){static $name="TaskBoardColumns";static configurable={columns:{},autoGenerateColumns:!1,columnField:null};static properties={shouldAutoGenerateColumns:!1};get widgetClass(){}changeAutoGenerateColumns(e){return Ut.assertBoolean(e,"autoGenerateColumns"),e}changeColumnField(e){return Ut.assertString(e,"columnField"),e}updateColumnField(e,t){if(t){const{storage:n}=this.project.taskStore;t!==this.swimlaneField&&n.removeIndex(t),n.addIndex({property:e,unique:!1})}this.shouldAutoGenerateColumns=e&&this.autoGenerateColumns}changeColumns(e){return Li.from(e,{objectify:!0,modelClass:af},(e=>"string"==typeof e?{id:e,text:T.capitalize(e)}:e))}updateColumns(e){this.detachListeners("columns"),e&&((e.$store||e).taskBoard=this,e.ion({change:"onColumnsChange",refresh:"onColumnsChange",thisObj:this}))}get columns(){const e=this,{taskStore:t}=e.project;return e.shouldAutoGenerateColumns&&t.count&&(e.columns=t.getDistinctValues(e.columnField).sort(),e.shouldAutoGenerateColumns=!1),e._columns}onColumnsChange({action:e}){if("add"!==e&&"remove"!==e&&"removeAll"!==e&&"update"!==e||this.project.taskStore.storage.invalidateIndices(),qv[e]){const t={};"update"!==e&&"remove"!==e||(t.addTransition={width:1,opacity:1},t.removeTransition={width:1,opacity:1}),this.recomposeWithDomTransition(t)}else this.recompose()}getColumnTasks(e,t=!1){const n=this,{taskStore:r}=n.project,s=r.storage.findItem(n.columnField,e.id),i=s?[...s]:[];if(t&&s)if(n.swimlanes){const{swimlaneField:e}=n,t=n.swimlanes.map((e=>e.id));if(i.sort(((n,s)=>{const i=t.indexOf(n[e])-t.indexOf(s[e]);return 0!==i?i:null!=n.weight||null!=s.weight?n.weight-s.weight:r.indexOf(n)-r.indexOf(s)})),t.length&&e)return i.filter((n=>t.includes(n[e])))}else i.sort(((e,t)=>e.weight-t.weight));return i}getColumn(e){return this.columns.getById(e.getValue(this.columnField))}getNextTask(e,t=!0){const n=this.getColumn(e).tasks;let r=n.indexOf(e)+1;if(r===n.length){if(!t)return null;r=0}return n[r]}getPreviousTask(e,t=!0){const n=this.getColumn(e).tasks;let r=n.indexOf(e)-1;if(r<0){if(!t)return null;r=n.length-1}return n[r]}},Gv=e=>class extends(e||ue){static $name="TaskBoardDom";get widgetClass(){}resolveTaskRecord(e){var t;return(e=e.closest(".b-taskboard-card"))&&this.project.taskStore.getById(null===(t=e.elementData)||void 0===t?void 0:t.taskId)}resolveColumnRecord(e){var t;return(e=e.closest(".b-taskboard-column, .b-taskboard-column-header"))&&this.columns.getById(null===(t=e.elementData)||void 0===t?void 0:t.columnId)}resolveSwimlaneRecord(e){var t;return(e=e.closest(".b-taskboard-swimlane"))&&(null===(t=this.swimlanes)||void 0===t?void 0:t.getById(e.elementData.laneId))}getTaskElement(e){const t=this.getTaskColumnElement(e);return t&&go.getChild(t,`body.inner.${e.domId}`)}getTaskColumnElement(e){const t=this.columns.getById(e.getValue(this.columnField));return t&&go.getChild(this.getTaskSwimlaneElement(e),`body.${t.domId}`)}getTaskSwimlaneElement(e){var t,n;const r=null!==(t=this.swimlanes)&&void 0!==t&&t.count?null===(n=this.swimlanes.getById(e.getValue(this.swimlaneField)))||void 0===n?void 0:n.domId:"default";return go.getChild(this.bodyElement,r)}getSwimlaneElement(e){return go.getChild(this.bodyElement,e.domId)}getSwimlaneColumnElement(e,t){return e?go.getChild(this.getSwimlaneElement(e),`body.${t.domId}`):this.getColumnElement(t)}getColumnElement(e){var t;return null===(t=this.getColumnElements(e))||void 0===t?void 0:t[0]}getColumnElements(e){var t;return null!==(t=this.swimlanes)&&void 0!==t&&t.count?this.swimlanes.reduce(((t,n)=>(n.hidden||t.push(this.getSwimlaneColumnElement(n,e)),t)),[]):[this.getSwimlaneColumnElement({domId:"default"},e)]}getColumnHeaderElement(e){return go.getChild(this.bodyElement,`header.${e.domId}`)}getCardAt(e,t,n=".b-taskboard-card"){var r;return null===(r=this.documentRoot.elementFromPoint(e,t))||void 0===r?void 0:r.closest(n)}cacheCSSVar(e,t){const n=this;let r=n[`_${e}`];if(null==r){const s=n.css[e];r=yr.measureSize(s||t,n.element),s&&(n[`_${e}`]=r)}return r}get cardGap(){return this.cacheCSSVar("cardGap","1em")}},Xv=e=>class extends(e||ue){static $name="TaskBoardDomEvents";static configurable={activateTaskEvent:"taskDblClick",domEvents:{click:"click",dblclick:"dblClick",mouseup:"mouseUp",mousedown:"mouseDown",mousemove:"mouseMove",mouseover:"mouseOver",mouseout:"mouseOut",keydown:"keyDown",contextmenu:"contextMenu"},domListeners:{}};#e=null;get widgetClass(){}changeDomListeners(e){if(e)for(const t in this.domEvents)e[t]="triggerDomEvent";return e}resolveEvent(e){const{target:t}=e;return{taskRecord:this.resolveTaskRecord(t),columnRecord:this.resolveColumnRecord(t),swimlaneRecord:this.resolveSwimlaneRecord(t),event:e}}triggerDomEvent(e){const t=this,n=t.resolveEvent(e),r=t.domEvents[e.type],{target:s}=e;if(t.isScrolling||s.closest(".b-widget")!==t._element)return;let i;if(e.taskBoardData=n,n.taskRecord){const s=`task${T.capitalize(r)}`;i=t.trigger(s,n),s!==t.activateTaskEvent||e.defaultPrevented||t.trigger("activateTask",{taskRecord:n.taskRecord,event:e})}else n.columnRecord?i=s.closest(".b-taskboard-column-header")?t.trigger(`columnHeader${T.capitalize(r)}`,n):t.trigger(`column${T.capitalize(r)}`,n):n.swimlaneRecord&&(i=s.closest(".b-taskboard-swimlane-header")?t.trigger(`swimlaneHeader${T.capitalize(r)}`,n):t.trigger(`swimlane${T.capitalize(r)}`,n));if(!1!==i&&(t.trigger(r,n),("mouseOver"===r||"mouseOut"===r)&&n.taskRecord)){const i=s.closest(".b-taskboard-card");"mouseOver"===r&&i!==t.#e&&(t.#e=i,t.trigger("taskMouseEnter",n)),"mouseOut"!==r||i.contains(e.relatedTarget)||(t.#e=null,t.trigger("taskMouseLeave",n))}}domSyncCallback({action:e,domConfig:t,lastDomConfig:n,targetElement:r,syncId:s,jsx:i}){const a=this,{elementType:o}=(null==t?void 0:t.elementData)??{},l="reuseOwnElement"===e,{reactComponent:c}=this;var d;if(i&&this.processTaskItemContent)this.processTaskItemContent({jsx:i,targetElement:r,reactComponent:c,domConfig:t});else if(t)if("task"===o){const{taskId:n}=t.elementData,s=a.project.taskStore.getById(n);var u;if("newElement"===e)null===(u=a.cardIntersectionObserver)||void 0===u||u.observe(r);if("newElement"===e||"reuseOwnElement"===e)(!a.isVirtualized||s.instanceMeta(a).intersects)&&a.trigger("renderTask",{taskRecord:s,element:r,isRefresh:l});else if("removeElement"===e){var h;null===(h=a.cardIntersectionObserver)||void 0===h||h.unobserve(r),a.trigger("removeTaskElement",{taskId:n,element:r})}}else if("column"===o){var g;const{columnId:n,laneId:s}=t.elementData,i=a.columns.getById(n),o=null!=s&&(null===(g=a.swimlanes)||void 0===g?void 0:g.getById(s));"newElement"===e||"reuseOwnElement"===e?a.trigger("renderColumn",{columnRecord:i,swimlaneRecord:o,element:r,isRefresh:l}):"removeElement"===e&&a.trigger("removeColumnElement",{columnId:n,swimlaneRecord:o,element:r})}else if("swimlane"===o){var m;const{laneId:n}=t.elementData,s=null!=n&&"default"!==n&&(null===(m=a.swimlanes)||void 0===m?void 0:m.getById(n));"default"!==n&&("newElement"===e||"reuseOwnElement"===e?a.trigger("renderSwimlane",{swimlaneRecord:s,element:r,isRefresh:l}):"removeElement"===e&&a.trigger("removeSwimlaneElement",{swimlaneId:n,element:r}))}else null!==(d=t.class)&&void 0!==d&&d["b-taskboard-column-header-padder"]&&a.resizeObserver&&("newElement"===e&&(r.isResizeObserved||(a.resizeObserver.observe(r),r.isResizeObserved=!0)),"removeElement"===e&&r.isResizeObserved&&(a.resizeObserver.unobserve(r),delete r.isResizeObserved))}onClick(){}onMouseMove(){}onMouseUp(){}onTaskMouseDown(){}onTaskClick(){}onTaskDblClick(){}onTaskContextMenu(){}onColumnMouseDown(){}onColumnHeaderClick(...e){super.onColumnHeaderClick(...e)}onSwimlaneHeaderClick(...e){super.onSwimlaneHeaderClick(...e)}onActivateTask(){}},Zv=e=>class extends(e||ue){static $name="TaskBoardScroll";static configurable={scrollOptions:{animate:!0,block:"nearest",highlight:!0},testConfig:{scrollOptions:{animate:!1,block:"nearest"}}};get widgetClass(){}static delayable={onScrollEnd:P.isTestEnv?300:100};onInternalPaint({firstPaint:e}){if(e){const e=this;Mn.on({element:e.element,scroll(){e.isScrolling=!0,e.onScrollEnd()},capture:!0,thisObj:e})}}onScrollEnd(){this.isScrolling=!1,this.recomposeOnScrollEnd&&(this.recompose(),this.recomposeOnScrollEnd=!1)}changeScrollOptions(e){return Ut.assertObject(e,"scrollOptions"),e}async scrollToSwimlane(e,t=this.scrollOptions){const n=this.swimlanes.getById(e),r=n&&this.getSwimlaneElement(n);var s,i;if(r)return t=Ut.assign({x:!1,animate:(null===(s=t)||void 0===s?void 0:s.animate)||"smooth"===(null===(i=t)||void 0===i?void 0:i.behavior)},t),Io.scrollIntoView(r,t,this.rtl)}async scrollToColumn(e,t=this.scrollOptions){const n=this.columns.getById(e),r=n&&this.getColumnHeaderElement(n);var s,i;if(r)return t=Ut.assign({animate:(null===(s=t)||void 0===s?void 0:s.animate)||"smooth"===(null===(i=t)||void 0===i?void 0:i.behavior),y:!1},t),Io.scrollIntoView(r,t,this.rtl)}async scrollToIntersection(e,t,n=this.scrollOptions){const r=this.swimlanes.getById(e),s=this.columns.getById(t),i=r&&s&&this.getSwimlaneColumnElement(r,s);var a,o;if(i)return n=Ut.assign({animate:(null===(a=n)||void 0===a?void 0:a.animate)||"smooth"===(null===(o=n)||void 0===o?void 0:o.behavior),edgeOffset:10},n),Io.scrollIntoView(i,n,this.rtl)}async scrollToTask(e,t=this.scrollOptions){const n=this,r=n.project.taskStore.getById(e),s=r&&n.getTaskElement(r);if(s){var i,a;const e={start:10,end:10,top:10,bottom:10};return n.stickyHeaders&&(n.hasSwimlanes&&(e.top+=n.getTaskSwimlaneElement(r).syncIdMap.header.offsetHeight),e.top+=n.bodyElement.syncIdMap.header.offsetHeight),n.isVirtualized&&!n.getTaskHeight&&(s.scrollIntoView(),await new Promise(((e,t)=>{const s=n.ion({renderTask({taskRecord:t}){t===r&&(s(),e())},expires:{delay:200,alt:t}})}))),t=Ut.assign({animate:(null===(i=t)||void 0===i?void 0:i.animate)||"smooth"===(null===(a=t)||void 0===a?void 0:a.behavior),edgeOffset:e},t),Io.scrollIntoView(s,t,n.rtl)}}},Jv=e=>class extends(e||ue){static $name="TaskBoardStores";static configurable={projectModelClass:Wv,project:{},assignments:null,resources:null,tasks:null,newTaskDefaults:{},loadMaskDefaults:{useTransition:!0,showDelay:100},syncMask:null};get widgetClass(){}get assignments(){return this.project.assignmentStore.records}updateAssignments(e){this.project.assignmentStore.data=e}get resources(){return this.project.resourceStore.records}updateResources(e){this.project.resourceStore.data=e}get tasks(){return this.project.taskStore.records}updateTasks(e){this.project.taskStore.data=e}changeNewTaskDefaults(e){return Ut.assertObject(e,"newTaskDefaults"),e}changeProject(e){return e&&!e.isModel&&(e=this.projectModelClass.new(e)),this.attachToProject(e),e}attachToProject(e){const t=this;if(t.bindCrudManager(e),e){const{taskStore:n}=e;if(n){const{storage:e}=n;e.addIndex({property:t.columnField,unique:!1}),t.swimlaneField&&e.addIndex({property:t.swimlaneField,unique:!1}),Reflect.defineProperty(n.$master.modelClass.prototype,"columnSwimlaneIntersection",{get(){return this.buildIndexKey({[t.columnField]:this[t.columnField],[t.swimlaneField]:this[t.swimlaneField]})}}),n.$master.modelClass.prototype.buildIndexKey=function(e){var n;return`${e[t.columnField]}-/-${(null===(n=t.swimlanes)||void 0===n?void 0:n.count)&&e[t.swimlaneField]||"default"}`},e.addIndex({property:"columnSwimlaneIntersection",unique:!1,dependentOn:{[t.swimlaneField]:!0,[t.columnField]:!0}})}t.attachToProjectStore(e.taskStore,{change:"onTaskStoreChange",changePreCommit:"onTaskStoreEarlyChange",refresh:"onTaskStoreRefresh"}),t.attachToProjectStore(e.assignmentStore),t.attachToProjectStore(e.resourceStore)}}attachToProjectStore(e,t={}){this.detachListeners(e.$name),null==e||e.ion({name:e.$name,change:"recompose",refresh:"recompose",thisObj:this,...t})}onTaskStoreEarlyChange({action:e}){"add"===e&&this.recomposeWithDomTransition({addTransition:{height:1,opacity:1}})}onTaskStoreChange({action:e,changes:t}){const{columnField:n,swimlaneField:r}=this;"remove"===e||"filter"===e||"update"===e&&(t[n]||r&&t[r])?this.recomposeWithDomTransition({removeTransition:{height:1,opacity:1}}):this.recompose()}onTaskStoreRefresh({action:e}){"sort"===e?!this.taskSorterFn&&this.recomposeWithDomTransition():this.recompose()}async addTask(e,t=null,n={}){const r=this,{swimlaneField:s,swimlanes:i,project:a}=r,o=r.getColumnElement(e).syncIdMap.body,l=o.lastElementChild,c={[r.columnField]:e.id,name:r.L("L{TaskBoard.newTaskName}"),weight:(a.taskStore.max("weight")??0)+100,...r.newTaskDefaults,...n};let d=!1;s&&(t?c[s]=t.id:null!=i&&i.count&&(c[s]=i.first.id)),l&&l.offsetTop+l.offsetHeight>o.clientHeight-100&&(r.suspendDomTransition(),d=!0);const u=a.autoSync&&a.await("sync",!1),[h]=a.taskStore.add(c);if(r.recompose.now(),r.useDomTransition&&!r.domTransitionSuspended&&await r.await("transitionedRecompose",!1),!r.isDestroyed&&(await r.scrollToTask(h,Ut.assign({},r.scrollOptions,{highlight:!1,block:"nearest"})),!r.isDestroyed)){if(u){if(await u,r.isDestroyed)return;r.recompose.now()}return d&&r.resumeDomTransition(),r.features.simpleTaskEdit&&r.editTask(h),h}}async removeTask(e){const t=ge.asArray(e);return!1!==await this.trigger("beforeTaskRemove",{taskRecords:t})&&(this.project.taskStore.remove(t),!0)}},Qv=e=>class extends(e||ue){static $name="TaskBoardSwimlanes";static configurable={swimlanes:{},autoGenerateSwimlanes:!1,swimlaneField:null};static properties={shouldAutoGenerateSwimlanes:!1};get widgetClass(){}changeAutoGenerateSwimlanes(e){return Ut.assertBoolean(e,"autoGenerateSwimlanes"),e}changeSwimlaneField(e){return Ut.assertString(e,"swimlaneField"),e}updateSwimlaneField(e,t){if(!this.isConfiguring){const{storage:n}=this.project.taskStore;t&&t!==this.columnField&&n.removeIndex(t),n.addIndex({property:e,unique:!1})}this.shouldAutoGenerateSwimlanes=e&&this.autoGenerateSwimlanes}changeSwimlanes(e){return Li.from(e,{objectify:!0,modelClass:Hv},(e=>"string"==typeof e?{id:e,text:T.capitalize(e)}:e))}updateSwimlanes(e){this.detachListeners("swimlanes"),e&&((e.$store||e).taskBoard=this,e.ion({change:"onSwimlanesChange",refresh:"onSwimlanesChange",thisObj:this}))}get swimlanes(){const e=this,{taskStore:t}=e.project;return e.shouldAutoGenerateSwimlanes&&t.count&&(e.swimlanes=t.getDistinctValues(e.swimlaneField).sort(),e.shouldAutoGenerateSwimlanes=!1),e._swimlanes}onSwimlanesChange({action:e}){if("add"!==e&&"remove"!==e&&"removeAll"!==e&&"update"!==e||this.project.taskStore.storage.invalidateIndices(),"remove"===e||"update"===e||"filter"===e){const t={};return"update"===e&&(t.addTransition={height:1,opacity:1},t.removeTransition={height:1,opacity:1}),void this.recomposeWithDomTransition(t)}this.recompose()}get hasSwimlanes(){var e;return Boolean(this.swimlaneField&&(null===(e=this.swimlanes)||void 0===e?void 0:e.count))}getSwimlaneTasks(e){return this.project.taskStore.storage.findItem(this.swimlaneField,e.id)}getSwimlane(e){var t;return this.swimlaneField&&(null===(t=this.swimlanes)||void 0===t?void 0:t.getById(e.getValue(this.swimlaneField)))}},ey=e=>class extends(e||ue){static $name="TaskBoardVirtualization";static configurable={getTaskHeight:null,virtualize:{value:null,$config:"nullify"},drawOnScroll:!0};get widgetClass(){}changeVirtualize(e){return Ut.assertBoolean(e,"virtualize"),e}updateVirtualize(e){var t;const n=this;null===(t=n.cardIntersectionObserver)||void 0===t||t.disconnect(),n.cardIntersectionObserver=null,e&&(n.cardIntersectionObserver=new IntersectionObserver((e=>{for(const t of e)n.onCardIntersection(t.target,t.isIntersecting,t)}))),this.isConfiguring||this.isDestroying||this.refreshVirtualizedCards()}refreshVirtualizedCards(){const e=this;if(e.recompose.now(),e.cardIntersectionObserver)for(const t of e.element.querySelectorAll(".b-taskboard-card"))e.cardIntersectionObserver.observe(t)}changeGetTaskHeight(e){return e&&Ut.assertFunction(e,"getTaskHeight"),e}updateGetTaskHeight(e){this.isConfiguring||this.isDestroying||this.refreshVirtualizedCards()}compose(e){return e.class["b-virtualized"]=this.isVirtualized,super.compose(e)}get isVirtualized(){return Boolean(this.cardIntersectionObserver)}onCardIntersection(e,t,n){const r=this,{taskRecord:s}=e.elementData,i=s.instanceMeta(r),a=i.intersects;a!==t&&(i.intersects=t,!t&&a&&(i.lastHeight=n.boundingClientRect.height),r.isScrolling&&!r.drawOnScroll||r.queueColumnRecompose(r.getColumn(s),r.getSwimlane(s)),r.isScrolling&&(r.recomposeOnScrollEnd=!0))}renderCardOutline(e,t,n){var r;const s=this,{id:i,domId:a,weight:o}=e;return{id:`${s.id}-card-${a}`,class:{"b-taskboard-card":!0,"b-out-of-view":!0},tabIndex:0,dataset:{task:a,column:t.id,lane:null==n?void 0:n.id,weight:o,domTransition:!0},elementData:{elementType:"task",taskId:i,taskRecord:e,columnRecord:t,swimlaneRecord:n},style:{height:(null===(r=s.getTaskHeight)||void 0===r?void 0:r.call(s,e))||e.instanceMeta(s).lastHeight}}}renderCard(e,t,n){const{isVirtualized:r}=this,s=e.instanceMeta(this);if(r&&!s.dragging&&!s.intersects&&!this.isSelected(e))return this.renderCardOutline(e,t,n)}};class ty extends Np{static $name="TextItem";static type="text";static render({domConfig:e,value:t,taskRecord:n,config:r}){"id"===r.field&&n.hasGeneratedId?(e.class["b-generated-id"]=1,e.text=""):e.text=n.getFieldDefinition(r.field).print(t)}}ty.initClass(),ty._$name="TextItem";class ny extends Np{static $name="ResourceAvatarsItem";static type="resourceAvatars";static defaultEditor={type:"resourcescombo",pickerWidth:"13em"};static render({taskBoard:e,domConfig:t,config:n,taskRecord:r,cardSize:s}){const i=(null==s?void 0:s.maxAvatars)??n.maxAvatars??7,{resourceImagePath:a}=e,{resources:o}=r,l=o.length>i,c=o.length-i+1,d=o[i];let{avatarRendering:u}=e;if(u||(u=e.avatarRendering=new nm({element:e.element,colorPrefix:"b-taskboard-background-color-"})),!e.project.resourceStore.count)return!1;Ut.merge(t,{class:{"b-overlap":n.overlap},children:[...o.sort(((e,t)=>e.name.localeCompare(t.name))).slice(0,i-(l?1:0)).map(((e,t)=>({class:{"b-taskboard-resource-avatar-wrap":1},dataset:{resourceId:e.id},children:[u.getResourceAvatar({resourceRecord:e,imageUrl:!1===e.image?null:e.imageUrl||e.image&&(a||"")+e.image,initials:e.initials,color:e.eventColor,dataset:{btip:T.encodeHtml(e.name)}})]}))),l&&{class:{"b-taskboard-resource-avatar-overflow":1},dataset:{resourceId:"$overflow",btip:o.slice(-c).map((e=>T.encodeHtml(e.name))).join(", "),count:c},children:[u.getResourceAvatar({resourceRecord:d,imageUrl:!1===d.image?null:d.imageUrl||d.image&&a+d.image,initials:d.initials})]}],syncOptions:{syncIdField:"resourceId"}})}static onClick({source:e,taskRecord:t,event:n}){const r=n.target.closest(".b-resource-avatar, .b-taskboard-resource-avatar-overflow");if(r){if(r.matches(".b-resource-avatar")){const s=e.project.resourceStore.getById(r.dataset.resourceId);e.trigger("resourceAvatarClick",{resourceRecord:s,taskRecord:t,element:r,event:n})}else e.trigger("resourceAvatarOverflowClick",{taskRecord:t,element:r,event:n});return!1}}}ny.initClass(),ny._$name="ResourceAvatarsItem";const ry={resourceAvatars:1,separator:1,taskMenu:1},sy=".b-taskboard-taskitem",iy=/\s*<\s*/,ay=/\s*>\s*/;var oy=e=>class extends(e||ue){static $name="TaskItems";static configurable={headerItems:{value:{text:{type:"text",field:"name"}},$config:{merge:"items"}},bodyItems:{value:{text:{type:"text",field:"description"}},$config:{merge:"items"}},footerItems:{value:{resourceAvatars:{type:"resourceAvatars",field:"resources"}},$config:{merge:"items"}},processItems:null};get widgetClass(){}changeProcessItems(e){return Ut.assertFunction(e,"processItems"),e}mergeItems(e,t){return t&&e&&(e=Ut.mergeItems(t,e)),e}changeHeaderItems(e,t){return Ut.assertObject(e,"headerItems"),this.mergeItems(e,t)}changeBodyItems(e,t){return Ut.assertObject(e,"bodyItems"),this.mergeItems(e,t)}changeFooterItems(e,t){return Ut.assertObject(e,"footerItems"),this.mergeItems(e,t)}renderItems(e,t,n,r){for(const s in t){const i=t[s];if(i&&!i.hidden){"field"in i||(s.includes(">")?[i.field]=s.split(ay):s.includes("<")?[,i.field]=s.split(iy):i.field=s);const{field:t}=i,a=e.getValue(t);if(null!=a||ry[i.type]||i.renderNull){const o=Np.resolveType(i.type),l={class:{"b-taskboard-taskitem":1,[`b-taskboard-${T.hyphenate(i.type)}`]:1,[i.cls]:i.cls,"b-editable":!e.readOnly&&o.getEditorConfig({config:i,item:o})},dataset:{role:`item-${t}`,field:t,ref:s},elementData:{item:o,taskRecord:e,config:i},style:{order:i.order,style:i.style}};!1!==o.render({taskBoard:this,domConfig:l,value:a,config:i,taskRecord:e,cardSize:r})&&(n.children[s]=l)}}}}populateCard(e){var t;null===(t=super.populateCard)||void 0===t||t.call(this,e);const n=this,{processItems:r}=n,{taskRecord:s,cardConfig:i,cardSize:a}=e,{headerItems:o,bodyItems:l,footerItems:c}=a||{},{header:d,body:u,footer:h}=i.children;let{headerItems:g,bodyItems:m,footerItems:p}=n;(o||r)&&(g=Ut.clone(g)),(l||r)&&(m=Ut.clone(m)),(c||r)&&(p=Ut.clone(p)),o&&Ut.merge(g,o),l&&Ut.merge(m,l),c&&Ut.merge(p,c),null==r||r({headerItems:g,bodyItems:m,footerItems:p,taskRecord:s,cardSize:a}),n.renderItems(s,g,d,a),n.renderItems(s,m,u,a),n.renderItems(s,p,h,a)}resolveTaskItem(e){const t=e.closest(sy)||e.querySelector(`:scope > * > ${sy}, :scope > ${sy}`);return t?{...t.elementData,element:t}:null}onTaskClick(e){const t=this.resolveTaskItem(e.event.target);if(t){var n;const{config:r,item:s}=t;null===(n=s.onClick)||void 0===n||n.call(s,{config:r,...e})}super.onTaskClick(e)}onTaskDblClick(e){const t=this.resolveTaskItem(e.event.target);if(t){var n;const{config:r,item:s}=t;null===(n=s.onDblClick)||void 0===n||n.call(s,{config:r,...e})}super.onTaskDblClick(e)}};const ly=["navigateDown","navigateLeft","navigateUp","navigateRight","activate"];var cy=e=>class extends(e||ue){static $name="TaskNavigation";static configurable={keyMap:{ArrowDown:"navigateDown",ArrowLeft:"navigateLeft",ArrowUp:"navigateUp",ArrowRight:"navigateRight",Enter:"activate"},navigateable:!0,selectOnNavigation:!1};get widgetClass(){}getTaskNear(e,t){var n;const{documentRoot:r}=this,s=yr.measureSize(this.css.cardGap||"1em",this.bodyElement.querySelector(".b-taskboard-swimlane-body .b-taskboard-column"));let i=null===(n=r.elementFromPoint(e,t))||void 0===n?void 0:n.closest(".b-taskboard-card");var a,o;i||(i=null===(a=r.elementFromPoint(e,t-s))||void 0===a?void 0:a.closest(".b-taskboard-card"));i||(i=null===(o=r.elementFromPoint(e,t+s))||void 0===o?void 0:o.closest(".b-taskboard-card"));return i}focusAndOptionallySelect(e,t){if(e){const n=this,r=n.resolveTaskRecord(document.activeElement);if(t&&r&&!n.isSelected(r)&&n.selectTask(r,!0),n.selectOnNavigation||t){const s=n.resolveTaskRecord(e);n.isSelected(s)?t&&n.deselectTask(r):n.selectTask(s,t)}e.focus()}}navigateNext(e,t){const n=this,{taskRecord:r,swimlaneRecord:s,columnRecord:i}=e.taskBoardData,a=n.getTaskElement(r);let o=null,l=i;do{if(l=n.columns.getNext(l,!0),!l.hidden){const e=n.getSwimlaneColumnElement(s,l),t=vn.from(e,null,!0).center.x,r=vn.from(a,null,!0).center.y;o=n.getTaskNear(t,r)}}while(!o&&l!==i);n.focusAndOptionallySelect(o,t)}navigatePrev(e,t){const n=this,{taskRecord:r,swimlaneRecord:s,columnRecord:i}=e.taskBoardData,a=n.getTaskElement(r);let o=null,l=i;do{if(l=n.columns.getPrev(l,!0),!l.hidden){const e=n.getSwimlaneColumnElement(s,l),t=vn.from(e,null,!0).center.x,r=vn.from(a,null,!0).center.y;o=n.getTaskNear(t,r)}}while(!o&&l!==i);n.focusAndOptionallySelect(o,t)}navigateRight(e,t=!1){this["navigate"+(this.rtl?"Prev":"Next")](e,t)}navigateLeft(e,t=!1){this["navigate"+(this.rtl?"Next":"Prev")](e,t)}navigateDown(e,t=!1){const{taskRecord:n}=e.taskBoardData,r=this.getNextTask(n,!0);this.focusAndOptionallySelect(this.getTaskElement(r),t)}navigateUp(e,t=!1){const{taskRecord:n}=e.taskBoardData,r=this.getPreviousTask(n,!0);this.focusAndOptionallySelect(this.getTaskElement(r),t)}activate(e){const{taskRecord:t}=this.resolveEvent(e);t&&this.trigger("activateTask",{taskRecord:t,event:e})}isActionAvailable({action:e,event:t}){const n=this.resolveEvent(t);return t.taskBoardData=n,("activate"!==e||!n.taskRecord||t.target===this.getTaskElement(n.taskRecord))&&Boolean((this.navigateable||!ly.includes(e))&&(null==n?void 0:n.taskRecord))}},dy=e=>class extends(e||ue){static $name="TaskSelection";static configurable={selectedTasks:[],isTaskSelectable:null,keyMap:{" ":"keyboardSelect","Ctrl+ ":"keyboardToggleSelect","Shift+ArrowDown":"selectDown","Shift+ArrowLeft":"selectLeft","Shift+ArrowUp":"selectUp","Shift+ArrowRight":"selectRight"}};get widgetClass(){}changeSelectedTasks(e){return Ut.assertArray(e,"selectedTasks"),e.filter((e=>{var t;return!1!==(null===(t=this.isTaskSelectable)||void 0===t?void 0:t.call(this,e))}))}toggleTaskSelection(e,t=!1,n=null){const r=this;null==n?r.isSelected(e)?t?r.deselectTask(e):r.selectTask(e,!1):r.selectTask(e,t):n?r.selectTask(e,t):r.deselectTask(e)}selectTask(e,t=!1){var n;const{selectedTasks:r}=this,s={action:"select",select:[e]};!1!==(null===(n=this.isTaskSelectable)||void 0===n?void 0:n.call(this,e))&&(t||(s.deselect=r.slice(),r.length=0),ge.include(r,e),this.triggerSelectionChange(s),this.recompose())}deselectTask(e){ge.remove(this.selectedTasks,e),this.triggerSelectionChange({action:"deselect",deselect:[e]}),this.recompose()}deselectAll(){const{selectedTasks:e}=this;if(e.length){const t=e.slice();e.length=0,this.triggerSelectionChange({action:"deselect",deselect:t}),this.recompose()}}isSelected(e){return this.selectedTasks.includes(e)}triggerSelectionChange(e){this.trigger("selectionChange",Object.assign({selection:this.selectedTasks,select:[],deselect:[]},e))}onTaskClick(e){super.onTaskClick(e);const{event:t,taskRecord:n}=e;t.defaultPrevented||this.toggleTaskSelection(n,t.ctrlKey)}keyboardSelect(e){if(!yr.isEditable(e.target)){const{taskRecord:t}=this.resolveEvent(e);if(t)return this.toggleTaskSelection(t,!1),!0}return!1}keyboardToggleSelect(e){const{taskRecord:t}=this.resolveEvent(e);t&&this.toggleTaskSelection(t,!0)}onClick(e){super.onClick(e),!e.taskRecord&&this.navigateable&&this.deselectAll()}selectUp(e){this.navigateUp(e,!0)}selectDown(e){this.navigateDown(e,!0)}selectLeft(e){this.navigateLeft(e,!0)}selectRight(e){this.navigateRight(e,!0)}populateCard(e){var t;null===(t=super.populateCard)||void 0===t||t.call(this,e);const{taskRecord:n,cardConfig:r}=e;r.class["b-selected"]=this.isSelected(n)}populateBody(e){var t;null===(t=super.populateBody)||void 0===t||t.call(this,e);const{bodyConfig:n}=e;n.class["b-has-selection"]=Boolean(this.selectedTasks.length)}};class uy extends Np{static $name="ImageItem";static type="image";static defaultEditor=null;static render({domConfig:e,value:t,config:n}){t&&Object.assign(e,{tag:"img",src:(n.baseUrl||"")+t,draggable:!1})}}uy.initClass(),uy._$name="ImageItem";class hy extends Np{static $name="JsxItem";static type="jsx";static defaultEditor=null;static render({domConfig:e,config:t,taskRecord:n,value:r}){e.retainChildren=!0,e.children=[t.jsx({value:r,taskRecord:n,config:t})]}}hy.initClass(),hy._$name="JsxItem";class gy extends Np{static $name="ProgressItem";static type="progress";static configurable={};static defaultEditor=null;static render({domConfig:e,value:t,config:n}){const r=Math.round(100*t/(n.max||100))+"%";e.children=[{class:"b-taskboard-progress-outline",dataset:{percent:r},children:[{class:"b-taskboard-progress-progress",style:{width:r},dataset:{percent:r}}]}],e.dataset.percent=e.dataset.btip=r}}gy.initClass(),gy._$name="ProgressItem";class my extends Np{static $name="RatingItem";static type="rating";static defaultEditor=null;static render({domConfig:e,value:t,config:n}){const{max:r=t}=n;e.children=[];for(let n=0;n<r;n++)e.children.push({tag:"i",class:{"b-icon b-icon-star":1,"b-filled":n<t}})}}my.initClass(),my._$name="RatingItem";class py extends Np{static $name="SeparatorItem";static type="separator";static defaultEditor=null;static render({domConfig:e}){e.tag="hr"}}py.initClass(),py._$name="SeparatorItem";class fy extends(gh.mixin(Kp)){static $name="TagCombo";static type="tagcombo";static configurable={multiSelect:!0,editable:!1,separator:",",picker:{cls:"b-tag-picker"},chipView:{closable:!1}};afterConfigure(){var e;const t=this;if((null===(e=t.store)||void 0===e||!e.count)&&t.taskBoard&&t.name){const{name:e,separator:n}=t,r=[];t.taskBoard.project.taskStore.forEach((t=>{const s=t[e];s&&("string"==typeof s?r.push(...s.split(n)):r.push(...s))})),t.items=[...new Set(r)].sort()}}changeValue(e,t){this.$expectsString=!1,this.separator&&"string"==typeof e&&(e=e.split(this.separator),this.$expectsString=!0),super.changeValue(e,t)}get value(){const e=super.value;return this.$expectsString?e.join(this.separator):e}set value(e){super.value=e}}fy.initClass(),fy._$name="TagCombo";class vy extends Np{static $name="TagsItem";static type="tags";static defaultEditor={type:"tagcombo",pickerWidth:"10em"};static render({domConfig:e,value:t,config:n}){let r;t&&("string"==typeof t?r=t.split(n.separator||",").map((e=>({text:e}))):Array.isArray(t)&&(r=t.map((e=>"string"==typeof e?{text:e}:{text:n.textProperty&&e[n.textProperty],cls:n.clsProperty&&e[n.clsProperty]}))),r&&(e.children=r.map((e=>{const t="cls"in e?e.cls:yr.makeValidId(e.text,"-").toLowerCase();return{class:{"b-taskboard-tags-tag":1,[t]:Boolean(t)},text:e.text}}))))}}vy.initClass(),vy._$name="TagsItem";class yy extends Np{static $name="TemplateItem";static type="template";static defaultEditor=null;static render({domConfig:e,value:t,config:n,taskRecord:r}){const s=n.template({taskRecord:r,config:n,value:t});"string"==typeof s?e.html=s:Ut.isObject(s)?Ut.merge(e,s):Array.isArray(s)&&(e.children=s)}}yy.initClass(),yy._$name="TemplateItem";class by extends Np{static $name="TodoListItem";static type="todoList";static defaultEditor=null;static render({domConfig:e,value:t,config:n,taskRecord:r}){if(t){const{textField:s="text",checkedField:i="checked",clsField:a="cls",checkedIcon:o="b-icon b-icon-checked",uncheckedIcon:l="b-icon b-icon-unchecked"}=n;if(!1!==this.firstRender){if(!r.getFieldDefinition(n.field).isArrayDataField)throw new Error('TodoListItem has to be mapped to a field with `type : "array"`')}e.children=t.map(((e,t)=>({class:{"b-taskboard-todolist-todo":1,[e[a]]:e[a],"b-checked":e[i]},children:{icon:{tag:"i",class:e[i]?o:l},text:{tag:"span",text:e[s]}},elementData:{index:t}}))),this.firstRender=!1}}static onClick({source:e,taskRecord:t,event:n,config:r}){const s=n.target.closest(".b-taskboard-todolist-todo");if(s&&!t.readOnly){const{checkedField:i="checked",field:a}=r,{index:o}=s.elementData,l=t.getValue(a).slice(),c=l[o];c[i]=!c[i],t.setValue(a,l),e.trigger("todoToggle",{taskRecord:t,todo:c,checked:c[i],element:s,event:n}),n.preventDefault()}}static onDblClick({event:e}){e.preventDefault()}}by.initClass(),by._$name="TodoListItem";var Cy=e=>class extends(e.mixin(lu)){static get $name(){return"CrudManagerView"}static config={clearMaskDelay:null,testConfig:{clearMaskDelay:0}};afterConstruct(){super.afterConstruct();const{crudManager:e,project:t}=this;this.loadMask&&(e||t).isCrudManagerLoading&&this.onCrudManagerLoadStart()}applySyncMask(){const{syncMask:e}=this;e&&(this.masked=Ao.mergeConfigs(this.loadMaskDefaults,e))}bindCrudManager(e){this.detachListeners("crudManager");let t={};this.isTaskBoardBase||(t={beforeApplyResponse:"onCrudManagerBeforeApplyResponse",applyResponse:"onCrudManagerApplyResponse",beforeLoadCrudManagerData:"onCrudManagerBeforeLoadCrudManagerData",loadCrudManagerData:"onCrudManagerLoadCrudManagerData"}),null==e||e.ion({name:"crudManager",loadStart:"onCrudManagerLoadStart",beforeSend:"onCrudManagerBeforeSend",load:"onCrudManagerLoad",loadCanceled:"onCrudManagerLoadCanceled",syncStart:"onCrudManagerSyncStart",sync:"onCrudManagerSync",syncCanceled:"onCrudManagerSyncCanceled",requestFail:"onCrudManagerRequestFail",responseReceived:"onAjaxTransportResponseReceived",...t,thisObj:this})}onCrudManagerBeforeSend({params:e}){var t;null===(t=this.applyStartEndParameters)||void 0===t||t.call(this,e)}onCrudManagerLoadStart(){var e;this.applyLoadMask(),null===(e=this.toggleEmptyText)||void 0===e||e.call(this)}onCrudManagerSyncStart(){this.applySyncMask()}onCrudManagerBeforeApplyResponse(){this.suspendRefresh()}onCrudManagerApplyResponse(){this.resumeRefresh(!0)}onCrudManagerBeforeLoadCrudManagerData(){this.crudManager.applyingLoadResponse||this.suspendRefresh()}async onCrudManagerLoadCrudManagerData(){this.crudManager.applyingLoadResponse||(await this.project.commitAsync(),!this.isDestroyed&&this.resumeRefresh(!0))}onCrudManagerRequestFinalize(e=!0,t,n){const r=this;var s;e?null===(s=r.toggleEmptyText)||void 0===s||s.call(r):(r.masked||r.applyLoadMask(),r.applyMaskError(`<div class="b-grid-load-failure">\n                    <div class="b-grid-load-fail">${r.L(`L{GridBase.${t}FailedMessage}`)}</div>\n                    ${n&&n.message?`<div class="b-grid-load-fail">${r.L("L{CrudManagerView.serverResponseLabel}")} ${n.message}</div>`:""}\n                </div>`))}onCrudManagerLoadCanceled(){this.onCrudManagerRequestFinalize(!0,"load")}onCrudManagerSyncCanceled(){this.onCrudManagerRequestFinalize(!0,"sync")}onCrudManagerLoad(){this.onCrudManagerRequestFinalize(!0,"load")}onCrudManagerSync(){this.onCrudManagerRequestFinalize(!0,"sync")}onCrudManagerRequestFail({requestType:e,response:t}){this.onCrudManagerRequestFinalize(!1,e,t)}onAjaxTransportResponseReceived(){const e=this;null!=e.clearMaskDelay?e.setTimeout((()=>e.masked=null),e.clearMaskDelay):e.masked=null}get widgetClass(){}};We.publishLocale({localeName:"En",localeDesc:"English (US)",localeCode:"en-US",GridBase:{loadFailedMessage:"Data loading failed!",syncFailedMessage:"Data synchronization failed!"},CrudManagerView:{serverResponseLabel:"Server response:"},TaskBoard:{column:"column",columns:"columns",Columns:"Columns",swimlane:"swimlane",swimlanes:"swimlanes",Swimlanes:"Swimlanes",task:"task",tasks:"tasks",addTask:"Add L{TaskBoard.task}",cancel:"Cancel",changeColumn:"Change L{TaskBoard.column}",changeSwimlane:"Change L{TaskBoard.swimlane}",collapse:e=>`Collapse ${e}`,color:"Color",description:"Description",editTask:"Edit L{TaskBoard.task}",expand:e=>`Expand ${e}`,filterColumns:"Filter L{TaskBoard.columns}",filterSwimlanes:"Filter L{TaskBoard.swimlanes}",filterTasks:"Filter L{TaskBoard.tasks}",moveColumnLeft:"Move L{TaskBoard.column} left",moveColumnRight:"Move L{TaskBoard.column} right",name:"Name",newTaskName:"New L{TaskBoard.task}",removeTask:"Remove L{TaskBoard.task}",removeTasks:"Remove L{TaskBoard.tasks}",resources:"Resources",save:"Save",scrollToColumn:"Scroll to L{TaskBoard.column}",scrollToSwimlane:"Scroll to L{TaskBoard.swimlane}",zoom:"Zoom"},TodoListField:{add:"Add",newTodo:"New todo"},UndoRedo:{UndoLastAction:"Undo",RedoLastAction:"Redo"}});const Sy=(e,t)=>e.weight-t.weight;class wy extends(Hc.mixin(jr,es,eu,Ug,Cy,Uv,Hg,Yv,Kv,Gv,Xv,Zv,Jv,Qv,ey,oy,cy,dy)){static $name="TaskBoardBase";static type="taskboardbase";static featureable={factory:Fp};static configurable={layout:"vbox",features:!0,taskRenderer:null,swimlaneRenderer:null,tasksPerRow:1,stretchCards:null,showCountInHeader:!0,stickyHeaders:!1,useDomTransition:!1,resourceImagePath:null,cssVarPrefix:"taskboard",scrollManager:{value:{},$config:["nullify","lazy"]},taskSorterFn:null,contentElMutationObserver:!1,textContent:!1,scrollable:!0};isInitiallyComposed=!1;domTransitionSuspended=0;columnRecomposeQueue=new Map;static delayable={recomposeColumns:"raf"};onPaintOverride(){}onInternalPaint(...e){this.onPaintOverride()||super.onInternalPaint(...e)}changeResourceImagePath(e){return Ut.assertString(e,"resourceImagePath"),e}changeUseDomTransition(e){return Ut.assertBoolean(e,"useDomTransition"),e}changeStickyHeaders(e){return Ut.assertBoolean(e,"stickyHeaders"),e}changeScrollManager(e,t){return null==t||t.destroy(),e?Uu.new({element:this.element,owner:this},e):null}changeShowCountInHeader(e){return Ut.assertBoolean(e,"showCountInHeader"),e}changeTasksPerRow(e){return Ut.assertNumber(e,"tasksPerRow"),e}changeSwimlaneRenderer(e){return Ut.assertFunction(e,"swimlaneRenderer"),e}changeTaskRenderer(e){return Ut.assertFunction(e,"taskRenderer"),e}changeTaskSorterFn(e){return!0===e?Sy:(e&&Ut.assertFunction(e,"taskSorterFn"),e)}queueColumnRecompose(e,t){this.columnRecomposeQueue.set(`${e.id}.-.${null==t?void 0:t.id}`,{columnRecord:e,swimlaneRecord:t}),this.recomposeColumns()}recomposeColumns(){for(const[,{columnRecord:e,swimlaneRecord:t}]of this.columnRecomposeQueue)this.recomposeColumn(e,t);this.columnRecomposeQueue.clear()}recomposeColumn(e,t){const n=this.getSwimlaneColumnElement(t,e),r=yr.normalizeChildren(this.renderColumn(t,e));r.onlyChildren=!0,go.sync({targetElement:n,domConfig:r,callback:this.domSyncCallback,syncOptions:{syncIdField:"column",releaseThreshold:0}})}renderCard(e,t,n){var r,s;const i=super.renderCard(e,t,n);if(i)return i;const a=this,{id:o,domId:l,eventColor:c,weight:d}=e,u=c||(null==n?void 0:n.color)||t.color,h=yr.isNamedColor(u)?u:null,g=a.getCardSize(t,n),m={id:`${a.id}-card-${l}`,class:{"b-taskboard-card":!0,[`b-taskboard-color-${h}`]:h,"b-readonly":e.readOnly,...e.cls},tabIndex:0,dataset:{task:l,column:t.id,lane:null==n?void 0:n.id,weight:d,domTransition:!0},style:{color:h?null:u,height:(null===(r=a.getTaskHeight)||void 0===r?void 0:r.call(a,e))??null},elementData:{elementType:"task",taskId:o,taskRecord:e,columnRecord:t,swimlaneRecord:n},children:{header:{tag:"header",class:{"b-taskboard-card-header":1},children:{},syncOptions:{syncIdField:"role"}},body:{tag:"section",class:{"b-taskboard-card-body":1},children:{},syncOptions:{syncIdField:"role"}},footer:{tag:"footer",class:{"b-taskboard-card-footer":1},children:{},syncOptions:{syncIdField:"role"}}}},{children:p}=m,{header:f,body:v,footer:y}=p;return a.populateCard({taskRecord:e,columnRecord:t,swimlaneRecord:n,cardConfig:m,cardSize:g}),null===(s=a.taskRenderer)||void 0===s||s.call(a,{taskRecord:e,columnRecord:t,swimlaneRecord:n,cardConfig:m,cardSize:g}),null!=f.html||null!=f.text||f.children&&0!==Object.keys(f.children).length||(p.header=null),null!=v.html||null!=v.text||v.children&&0!==Object.keys(v.children).length||(p.body=null),null!=y.html||null!=y.text||y.children&&0!==Object.keys(y.children).length||(p.footer=null),m}renderColumnHeader(e){var t,n;const r=this,{text:s,id:i,domId:a,width:o,flex:l,minWidth:c,color:d,tooltip:u}=e,h=yr.isNamedColor(d)?d:null,g={id:`${r.id}-column-header-${a}`,class:{"b-taskboard-column-header":1,"b-fixed-width":o&&!l,[`b-taskboard-color-${h}`]:h,"b-last":e===this.columns.last},style:{color:h?null:d,width:o,flex:l,minWidth:c},children:{padder:{class:{"b-taskboard-column-header-padder":1},children:{title:{class:{"b-taskboard-column-title":1},dataset:{btip:u},children:[{tag:"span",class:"b-column-title-text",text:s},r.showCountInHeader&&{tag:"span",class:{"b-taskboard-column-count":1},html:`(${(null===(t=r.getColumnTasks(e))||void 0===t?void 0:t.length)??0})`}]}}}},dataset:{column:a,domTransition:!0},elementData:{elementType:"columnHeader",columnId:i}};return Xu.showOverflow=!0,r.populateColumnHeader({columnRecord:e,columnHeaderConfig:g}),null===(n=r.columnHeaderRenderer)||void 0===n||n.call(r,{columnRecord:e,columnHeaderConfig:g}),g}renderColumn(e,t){var n;const r=this,{taskSorterFn:s,stretchCards:i,columnField:a,swimlaneField:o}=r,{width:l,flex:c,id:d,domId:u,minWidth:h,color:g}=t,{taskStore:m}=r.project,p=m.isTree?m.query((t=>!(t[a]!==d||o&&e&&t[o]!==e.id))):Array.from(m.storage.findItem("columnSwimlaneIntersection",`${t.id}-/-${(null==e?void 0:e.id)??"default"}`)||[]),f=r.getTasksPerRow(t,e),v=`${r.id}-column-${(null==e?void 0:e.domId)??"default"}-${u}`,y=yr.isNamedColor(g)?g:null,b={id:v,class:{"b-taskboard-column":1,"b-fixed-width":l&&!c,[`b-${f}-task${f>1?"s":""}-per-row`]:1,"b-inline":f>1,[`b-taskboard-color-${y}`]:y,"b-last":t===this.columns.last},style:{color:y?null:g,width:l,flex:c,minWidth:h},dataset:{column:u,lane:null==e?void 0:e.id,domTransition:!0},elementData:{elementType:"column",columnId:d,laneId:null==e?void 0:e.id},children:{body:{id:`${v}-body`,class:{"b-taskboard-column-body":1},dataset:{role:"body",domTransition:!0},children:[{class:{"b-taskboard-column-body-inner":1},style:{"grid-template-columns":`repeat(${i?Math.min(f,p.length):f}, 1fr)`},dataset:{role:"inner",domTransition:!0},children:(s?p.sort(s):p.sort(((e,t)=>m.indexOf(e)-m.indexOf(t))),p.map((n=>r.renderCard(n,t,e)))),syncOptions:{syncIdField:"task",releaseThreshold:r.isVirtualized?1e3:0}}],syncOptions:{syncIdField:"role"}}},syncOptions:{syncIdField:"role"}};return r.populateColumn({columnRecord:t,swimlaneRecord:e,columnConfig:b}),null===(n=r.columnRenderer)||void 0===n||n.call(r,{columnRecord:t,swimlaneRecord:e,columnConfig:b}),b}renderSwimlane(e){var t,n;const r=this,{showCountInHeader:s,columns:i}=r,{id:a="default",domId:o="default",text:l,height:c,flex:d,color:u}=e||{},h=`${r.id}-swimlane-${o}`,g=yr.isNamedColor(u)?u:null,m={id:h,class:{"b-taskboard-swimlane":1,"b-fixed-height":c&&!d,"b-last":!e||e===r.swimlanes.last,[`b-taskboard-color-${g}`]:g},style:{color:g?null:u,height:c,flex:d},dataset:{lane:o,domTransition:!0},elementData:{elementType:"swimlane",laneId:a},children:{header:e&&{id:`${h}-header`,tag:"header",class:{"b-taskboard-swimlane-header":1},dataset:{role:"header",domTransition:"preserve-padding"},children:{title:{class:{"b-taskboard-swimlane-title":1},children:{text:l,count:s&&{tag:"span",class:{"b-taskboard-swimlane-count":1},text:`(${(null===(t=r.getSwimlaneTasks(e))||void 0===t?void 0:t.size)??0})`}}}}},body:{id:`${h}-body`,class:{"b-taskboard-swimlane-body":1},dataset:{role:"body",domTransition:!0},children:i.map((t=>!t.hidden&&r.renderColumn(e,t))),syncOptions:{syncIdField:"column",releaseThreshold:0}}},syncOptions:{syncIdField:"role"}};return r.populateSwimlane({swimlaneRecord:e,swimlaneConfig:m}),null===(n=r.swimlaneRenderer)||void 0===n||n.call(r,{swimlaneRecord:e,swimlaneConfig:m}),m}get bodyConfig(){var e;const t=this,{stickyHeaders:n,showCountInHeader:r,columns:s,columnField:i,swimlaneField:a,tasksPerRow:o,headerItems:l,bodyItems:c,footerItems:d,selectedTasks:u,showCollapseInHeader:h,showCollapseTooltip:g,taskSorterFn:m,stretchCards:p}=t;if(!t.rendered)return t.setTimeout((()=>t.recompose()),0),{reference:"bodyElement",listeners:Ut.assign({thisObj:t},t.domListeners)};const f={skipClone:!0,reference:"bodyElement",class:{"b-taskboard-body":1,"b-sticky-headers":n},children:[{tag:"header",id:`${t.id}-column-headers`,class:{"b-taskboard-column-headers":1},children:s.map((e=>!e.hidden&&t.renderColumnHeader(e))),dataset:{lane:"header",domTransition:!0},syncOptions:{syncIdField:"column"}}],syncOptions:{syncIdField:"lane",releaseThreshold:0,ignoreRefs:"children"}};let{swimlanes:v}=t;null!==(e=v)&&void 0!==e&&e.count||(v=[null]);for(const e of v)null!=e&&e.hidden||f.children.push(t.renderSwimlane(e));return t.populateBody({bodyConfig:f}),t.isComposed=!0,f}populateCard(e){var t;null===(t=super.populateCard)||void 0===t||t.call(this,e)}populateColumn(e){var t;null===(t=super.populateColumn)||void 0===t||t.call(this,e)}populateColumnHeader(e){var t;null===(t=super.populateColumnHeader)||void 0===t||t.call(this,e)}populateSwimlane(e){var t;null===(t=super.populateSwimlane)||void 0===t||t.call(this,e)}populateBody(e){var t;null===(t=super.populateBody)||void 0===t||t.call(this,e)}afterRecompose(){super.afterRecompose();const e=this;!e.isInitiallyComposed&&e.isComposed&&(e.isInitiallyComposed=!0,e.initialCompose()),e.project.taskStore.count>0&&e.trigger("renderTasks",{taskRecords:e.project.taskStore.allRecords}),e.transitionRecompose=null}initialCompose(){this.trigger("initialCompose")}onRenderColumn(){}onRemoveColumnElement(){}onRenderSwimlane(){}onRemoveSwimlaneElement(){}suspendDomTransition(){this.domTransitionSuspended++}resumeDomTransition(){this.domTransitionSuspended--}recomposeWithDomTransition(e){const t=this;t.useDomTransition&&!t.domTransitionSuspended&&(t.transitionRecompose={selector:"[data-dom-transition]",duration:300,element:t._bodyElement,...e}),t.recompose.suspended?t._recomposeQueued=!0:t.recompose()}resumeRecompose(){super.resumeRecompose(),this._recomposeQueued&&(this._recomposeQueued=null,this.recompose())}getCurrentConfig(e){const t=super.getCurrentConfig(e);return t.columns&&delete t.columns.modelClass,t}refresh(){this.recompose()}}wy.initClass(),P.setVersion("taskboard","5.6.2"),wy._$name="TaskBoardBase";class Dy extends Np{static $name="TaskMenuItem";static type="taskMenu";static defaultEditor=null;static render({taskBoard:e,domConfig:t}){if(!e.features.taskMenu||e.features.taskMenu.disabled)return!1;t.tag="button",t.class["b-icon b-icon-menu-horizontal"]=1}static onClick({source:e,event:t}){var n;null===(n=e.features.taskMenu)||void 0===n||n.showContextMenu(t,{target:t.target})}}Dy.initClass(),Dy._$name="TaskMenuItem";class Ty extends wy{static $name="TaskBoard";static type="taskboard";static configurable={features:{columnHeaderMenu:!0,columnToolbars:!0,taskDrag:!0,taskDragSelect:!0,taskEdit:!0,taskMenu:!0}}}Ty.initClass(),Ty._$name="TaskBoard";class Ey extends(cg.mixin(Kp)){static $name="ColumnFilterField";static type="columnfilterfield";static configurable={store:"this.taskBoard.columns",field:"text",label:"L{TaskBoard.filterColumns}",width:"20em",triggers:{filter:{cls:"b-icon b-icon-filter",align:"start"}}}}Ey.initClass(),Ey._$name="ColumnFilterField";class xy extends(Dc.mixin(Kp)){static $name="ColumnPickerButton";static type="columnpickerbutton";static configurable={text:"L{TaskBoard.Columns}",icon:"b-icon-picker",pressedIcon:"b-icon-picker-rotated",iconAlign:"end",menuIcon:null,menu:{items:null}};onToggleColumn({item:e}){e.column.hidden=!e.checked}onMenuBeforeShow(e){super.onMenuBeforeShow(e),e.source.items=this.taskBoard.columns.map((e=>({ref:e.id,text:T.encodeHtml(e.text),checked:!e.hidden,column:e,onItem:"up.onToggleColumn"})))}}xy.initClass(),xy._$name="ColumnPickerButton";class ky extends(Dc.mixin(Kp)){static $name="ColumnScrollButton";static type="columnscrollbutton";static configurable={text:"L{TaskBoard.scrollToColumn}",icon:"b-icon-picker",pressedIcon:"b-icon-picker-rotated",iconAlign:"end",menuIcon:null,menu:[]};onClickColumn({item:e}){this.setTimeout((()=>{var t;return null===(t=this.taskBoard)||void 0===t?void 0:t.scrollToColumn(e.column)}),100)}changeMenu(e){return e&&(e=this.taskBoard.columns.map((e=>({ref:e.id,text:T.encodeHtml(e.text),column:e,onItem:"up.onClickColumn"})))),super.changeMenu(e)}}ky.initClass(),ky._$name="ColumnScrollButton";class Iy extends gh{static get $name(){return"ProjectCombo"}static get type(){return"projectcombo"}static get configurable(){return{project:null,displayField:"title",valueField:"url",highlightExternalChange:!1,editable:!1}}updateProject(e){var t;null!==(t=e.transport.load)&&void 0!==t&&t.url&&(this.value=e.transport.load.url)}onChange({value:e,userAction:t}){t&&this.project&&(this.project.transport.load.url=e,this.project.load())}}Iy.initClass(),Iy._$name="ProjectCombo";class Ry extends(Iy.mixin(Kp)){static $name="ProjectCombo";static type="taskboardprojectcombo";static configurable={project:null};updateTaskBoard(e){e&&(this.project=e.project)}afterConfigure(){this._taskBoard||this.updateTaskBoard(this.taskBoard)}}Ry.initClass(),Ry._$name="ProjectCombo";class My extends(cg.mixin(Kp)){static $name="SwimlaneFilterField";static type="swimlanefilterfield";static configurable={store:"this.taskBoard.swimlanes",field:"text",label:"L{TaskBoard.filterSwimlanes}",width:"20em",triggers:{filter:{cls:"b-icon b-icon-filter",align:"start"}}}}My.initClass(),My._$name="SwimlaneFilterField";class Oy extends(Dc.mixin(Kp)){static $name="SwimlanePickerButton";static type="swimlanepickerbutton";static configurable={text:"L{TaskBoard.Swimlanes}",icon:"b-icon-picker",pressedIcon:"b-icon-picker-rotated",iconAlign:"end",menuIcon:null,menu:{items:null}};onToggleSwimlane({item:e}){e.swimlane.hidden=!e.checked}onMenuBeforeShow(e){super.onMenuBeforeShow(e),e.source.items=this.taskBoard.swimlanes.map((e=>({ref:e.id,text:T.encodeHtml(e.text),checked:!e.hidden,swimlane:e,onItem:"up.onToggleSwimlane"})))}}Oy.initClass(),Oy._$name="SwimlanePickerButton";class Ay extends(Dc.mixin(Kp)){static $name="SwimlaneScrollButton";static type="swimlanescrollbutton";static configurable={text:"L{TaskBoard.scrollToSwimlane}",icon:"b-icon-picker",pressedIcon:"b-icon-picker-rotated",iconAlign:"end",menuIcon:null,menu:[]};onClickSwimlane({item:e}){this.setTimeout((()=>{var t;return null===(t=this.taskBoard)||void 0===t?void 0:t.scrollToSwimlane(e.swimlane)}),100)}changeMenu(e){return e&&(e=this.taskBoard.swimlanes.map((e=>({ref:e.id,text:T.encodeHtml(e.text),swimlane:e,onItem:"up.onClickSwimlane"})))),super.changeMenu(e)}}Ay.initClass(),Ay._$name="SwimlaneScrollButton";class Fy extends(cg.mixin(Kp)){static $name="TaskFilterField";static type="taskfilterfield";static configurable={store:"this.taskBoard.project.taskStore",field:"name",label:"L{TaskBoard.filterTasks}",width:"20em",triggers:{filter:{cls:"b-icon b-icon-filter",align:"start"}}}}Fy.initClass(),Fy._$name="TaskFilterField";class Py extends sh{static $name="TodoListField";static type="todolistfield";static alias="todolist";static configurable={textField:"text",checkedField:"checked",editableItems:!0,list:{type:"list",multiSelect:!0,store:{fields:[]},itemIconTpl:()=>'<i class="b-todo-checkbox b-icon"></i>'},addButton:{type:"button",cls:"b-todo-add",icon:"b-icon-add",text:"L{TodoListField.add}"},role:null};compose(){const{editableItems:e}=this;return{class:{"b-editable":e}}}changeList(e){return il.create(Ut.assign({itemTpl:e=>T.xss`<div class="b-todo-text">${e.getValue(this.textField)}</div><i class='b-todo-edit b-icon b-icon-edit' data-noselect></i>`},e))}updateList(e){e.ion({item:"onItemClick",thisObj:this}),e.ion({selectionChange:"onSelectionChange",thisObj:this})}changeAddButton(e){const t=il.create(e);return this.ariaElement=t.element,t}updateAddButton(e){e.ion({click:"onAddClick",thisObj:this})}get childItems(){return[this.list,this.addButton]}get inputElement(){return this.list.element}get innerElements(){return super.innerElements.concat(this.addButton.element)}changeValue(e){e=e||[];let t=!1;return this.eachAncestor((e=>{if(e.autoUpdateRecord)return t=!0,!1})),this.originalValue=t?e:Ut.clone(e),e&&(e=Ut.clone(e)).forEach(((e,t)=>{e.id=t+1,e.originalIndex=t})),e}updateValue(e){if(e){const t=this;t.list.items=e,t.isSettingValue=!0,t.list.selected.values=e.filter((e=>e[t.checkedField])),t.isSettingValue=!1}}get value(){return this.originalValue.slice()}set value(e){super.value=e}get isValid(){return!0}editItem(e,t){const n=this,r=new jh({appendTo:n.element,owner:n,cls:"b-todo-editor",inputField:{type:"text",triggers:{remove:{cls:"b-todo-remove b-icon-trash",handler(){n.removeItem(e),r.cancelEdit()}}}},style:"z-index : 20000",internalListeners:{complete({value:t}){n.originalValue[e.originalIndex][n.textField]=t,n.triggerFieldChange({value:n.value,userAction:!0})},finishEdit(){r.destroy()},thisObj:n}});r.startEdit({target:t,record:e,field:n.textField})}removeItem(e){const t=this,{originalIndex:n}=e;t.list.store.forEach((t=>{t.parentIndex>e.parentIndex&&t.originalIndex--})),t.list.store.remove(e),t.originalValue.splice(n,1),t.triggerFieldChange({value:t.value,userAction:!0})}onSelectionChange(){const e=this,{list:t}=e;e.isSettingValue||(e.originalValue.forEach(((n,r)=>{const s=t.store.getAt(r);s&&(n[e.checkedField]=t.selected.includes(s))})),e.triggerFieldChange({value:e.value,userAction:!0}))}onItemClick({record:e,event:t}){t.target.matches(".b-todo-edit")&&this.editItem(e,t.target.closest(".b-list-item"))}onAddClick(){const e=this;e.originalValue.push({[e.textField]:e.L("L{newTodo}"),[e.checkedField]:!1}),e.value=e.originalValue,e.triggerFieldChange({value:e.value,userAction:!0})}}Py.initClass(),Py._$name="TodoListField";class Ly extends(ph.mixin(Kp)){static $name="UndoRedo";static type="taskboardundoredo";construct(){super.construct(...arguments),this.stm=this.taskBoard.project.stm}}Ly.initClass(),Ly._$name="UndoRedo";class $y extends(wg.mixin(Kp)){static $name="ZoomSlider";static type="zoomslider";static configurable={text:"L{TaskBoard.zoom}",max:10,min:1,value:null,showValue:!1};calculateValue(e){return this.max-e+1}afterConstruct(){this.value=this.calculateValue(this.taskBoard.tasksPerRow)}onInput({value:e}){this.taskBoard.tasksPerRow=this.calculateValue(e)}updateValue(e){super.updateValue(e),this.onInput({value:e})}getTooltipHtml(e){const t=this.calculateValue(e);return`${t} card${1===t?"":"s"} per row`}}$y.initClass(),$y._$name="ZoomSlider";class _y extends(ue.mixin(_v)){get revision(){return this.crudRevision}set revision(e){this.crudRevision=e}get json(){return T.safeJsonStringify(this)}set json(e){"string"==typeof e&&(e=T.safeJsonParse(e)),this.forEachCrudStore((t=>{const n=`${t.storeId}Data`;e[n]&&(t.data=e[n])}))}static get defaultConfig(){return{stores:null}}construct(e={}){e.stores&&(e.crudStores=e.stores,delete e.stores),super.construct(e)}toJSON(){const e={};return this.forEachCrudStore(((t,n)=>e[`${n}Data`]=t.toJSON())),e}get inlineData(){return this.toJSON()}set inlineData(e){this.json=e}set stores(e){e!==this.crudStores&&(this.crudStores=e)}get stores(){return this.crudStores}get isLoading(){return this.isCrudManagerLoading}addStore(...e){return this.addCrudStore(...e)}removeStore(...e){return this.removeCrudStore(...e)}getStore(...e){return this.getCrudStore(...e)}hasChanges(...e){return this.crudStoreHasChanges(...e)}loadData(...e){return this.loadCrudManagerData(...e)}}_y._$name="AbstractCrudManager";class Ny extends(_y.mixin(Vv,Nv,jv)){static $name="CrudManager";static get defaultConfig(){return{projectClass:Mv,resourceStoreClass:Ev,eventStoreClass:bv,assignmentStoreClass:Iv,dependencyStoreClass:wv,resourceStore:{},eventStore:{},assignmentStore:{},dependencyStore:{},project:null}}buildProject(){return new this.projectClass(this.buildProjectConfig())}buildProjectConfig(){return Ut.cleanupProperties({eventStore:this.eventStore,resourceStore:this.resourceStore,assignmentStore:this.assignmentStore,dependencyStore:this.dependencyStore,resourceTimeRangeStore:this.resourceTimeRangeStore})}set project(e){const t=this;e!==t._project&&(t.detachListeners("beforeDataReady"),t.detachListeners("afterDataReady"),t._project=e,e&&(t.eventStore=e.eventStore,t.resourceStore=e.resourceStore,t.assignmentStore=e.assignmentStore,t.dependencyStore=e.dependencyStore,t.timeRangeStore=e.timeRangeStore,t.resourceTimeRangeStore=e.resourceTimeRangeStore,e.ion({name:"beforeDataReady",dataReady:()=>t.suspendChangeTracking(),prio:100,thisObj:t}),e.ion({name:"afterDataReady",dataReady:()=>t.resumeChangeTracking(),prio:-100,thisObj:t})),t.eventStore||(t.eventStore={}),t.resourceStore||(t.resourceStore={}),t.assignmentStore||(t.assignmentStore={}),t.dependencyStore||(t.dependencyStore={}))}get project(){return this._project}get timeRangeStore(){var e;return null===(e=this._timeRangeStore)||void 0===e?void 0:e.store}set timeRangeStore(e){var t;this.setFeaturedStore("_timeRangeStore",e,null===(t=this.project)||void 0===t?void 0:t.timeRangeStoreClass)}get resourceTimeRangeStore(){var e;return null===(e=this._resourceTimeRangeStore)||void 0===e?void 0:e.store}set resourceTimeRangeStore(e){var t;this.setFeaturedStore("_resourceTimeRangeStore",e,null===(t=this.project)||void 0===t?void 0:t.resourceTimeRangeStoreClass)}get resourceStore(){var e;return null===(e=this._resourceStore)||void 0===e?void 0:e.store}set resourceStore(e){this.setFeaturedStore("_resourceStore",e,this.resourceStoreClass)}get eventStore(){var e;return null===(e=this._eventStore)||void 0===e?void 0:e.store}set eventStore(e){this.setFeaturedStore("_eventStore",e,this.eventStoreClass)}get assignmentStore(){var e;return null===(e=this._assignmentStore)||void 0===e?void 0:e.store}set assignmentStore(e){this.setFeaturedStore("_assignmentStore",e,this.assignmentStoreClass)}get dependencyStore(){var e;return null===(e=this._dependencyStore)||void 0===e?void 0:e.store}set dependencyStore(e){this.setFeaturedStore("_dependencyStore",e,this.dependencyStoreClass)}setFeaturedStore(e,t,n){var r;const s=this,i=null===(r=s[e])||void 0===r?void 0:r.store;var a;i!==t&&(t=Li.getStore(t,(null===(a=t)||void 0===a?void 0:a.storeClass)||n),i&&s.removeStore(i),s[e]=t&&{store:t}||null,s.addPrioritizedStore(s[e]));return s[e]}getChangesetPackage(){var e,t;const n=super.getChangesetPackage();return n&&(this.eventStore.usesSingleAssignment||null!==(e=this.eventStore.modelClass.fieldMap)&&void 0!==e&&null!==(t=e.resourceIds)&&void 0!==t&&t.persist)&&(delete n[this.assignmentStore.storeId],!this.crudStores.some((e=>n[e.storeId])))?null:n}get crudLoadValidationMandatoryStores(){return[this._eventStore.storeId,this._resourceStore.storeId]}}Ny._$name="CrudManager";class jy extends(globalThis.customElements?HTMLElement:Object){connectedCallback(){this.setup()}async setup(){const e=this;if(e.shadowRoot)return;let t,n;const s=e.tagName.substring(8).toLowerCase(),i=(!r.isChrome||!document.fonts.check('normal 14px "Font Awesome 6 Free"'))&&e.getAttribute("fa-path"),a=document.getElementById("bryntum-theme"),o=e.getAttribute("theme")||"stockholm",l=e.getAttribute("stylesheet")||(null==a?void 0:a.href)||`${s}.${o}.css`,c=e.getAttribute("mode")||"open",d=e._rootElement=e.attachShadow({mode:c}),u=e.linkTag=yr.createElement({tag:"link",rel:"stylesheet",href:l,parent:d,dataset:{bryntumTheme:!0,loading:!0}}),h=[new Promise((e=>{t=e}))],g={appendTo:d,features:{}};e.convertDatasetToConfigs(e.dataset,g),u.onload=()=>{delete u.dataset.loading,t()},i&&(n=new FontFace(r.isFirefox?"FontAwesome5Free":"Font Awesome 6 Free",`url("${i}/fa-solid-900.woff2")`),document.fonts.add(n),h.push(n.load())),await h[0],e.ready=Promise.all(h);for(const t of e.children){const n=t.tagName;if("FEATURE"===n){const n=t.dataset.name,r=e.convertDatasetToConfigs(t.dataset);delete r.name,Object.keys(r).length?g.features[n]="false"!==r.use&&!1!==r.use&&r:g.features[n]="false"!==t.textContent}else if("TBAR"===n||"BBAR"===n)g[n.toLowerCase()]=Array.from(t.children).map((t=>e.convertDatasetToConfigs(t.dataset)));else if("INLINESTYLE"===n){const e=document.createElement("style");e.innerHTML=t.innerHTML,d.appendChild(e)}}e.widget=e.createInstance(g),e.dispatchEvent(new CustomEvent("ready"))}convertDatasetToConfigs(e,t={},n=!1){for(const r in e){let s=e[r];!n&&"string"==typeof s&&s.startsWith("{")?s=this.convertDatasetToConfigs(JSON.parse(s.replace(/'/g,'"'))):(s=T.safeJsonParse(s)??s,"null"===s&&(s=null)),t[r]=s}return t}destroy(){var e,t,n;const r=this;if(!r.widget)return;const{shadowRoot:s}=r,i=s.bryntum,a=r.widget.constructor,o=s.querySelector(".b-float-root");null==i||null===(e=i.tooltip)||void 0===e||null===(t=e.get(Xu))||void 0===t||t.destroy(),null==i||null===(n=i.errorTooltip)||void 0===n||n.destroy(),r.widget.destroy(),null==o||o.remove(),a.removeFloatRoot(o),r.linkTag.remove(),r.widget=null}}jy._$name="WidgetTag";const Vy={resourceavatars:"resourceAvatars",taskmenu:"taskMenu",todolist:"todoList"};class By extends jy{createInstance(e){const t=[],n=[],r=[],s=[],i=[],a={},o={},l={};for(const e of this.children)switch(e.tagName){case"COLUMN":t.push(this.convertDatasetToConfigs(e.dataset,{text:e.innerHTML}));break;case"SWIMLANE":n.push(this.convertDatasetToConfigs(e.dataset,{text:e.innerHTML}));break;case"DATA":Array.from(e.children||[]).forEach((e=>{const t=Object.assign({},e.dataset);switch(e.tagName){case"TASK":r.push(t);break;case"RESOURCE":s.push(t);break;case"ASSIGNMENT":i.push(t);break;default:console.warn("Unknown data type: "+e.tagName)}}));break;case"HEADERITEMS":case"BODYITEMS":case"FOOTERITEMS":{const t="HEADERITEMS"===e.tagName?a:"BODYITEMS"===e.tagName?o:l;for(const n of e.children){t[Vy[n.tagName.toLowerCase()]||n.tagName.toLowerCase()]=this.convertDatasetToConfigs(n.dataset,{})}break}}return new Ty(Object.assign(e,{columns:t,swimlanes:n,headerItems:a,bodyItems:o,footerItems:l,project:{tasksData:r,resourcesData:s,assignmentsData:i}}))}}try{var zy;null===(zy=globalThis.customElements)||void 0===zy||zy.define("bryntum-taskboard",By)}catch(e){}By._$name="TaskBoardTag",e.AbstractAssignmentStoreMixin=sp,e.AbstractCalendarManagerStoreMixin=ip,e.AbstractCalendarMixin=Qm,e.AbstractCrudManager=_y,e.AbstractCrudManagerMixin=_v,e.AbstractCrudManagerValidation=Ov,e.AbstractDependencyStoreMixin=ap,e.AbstractEventStoreMixin=lp,e.AbstractHasAssignmentsMixin=ep,e.AbstractPartOfProjectGenericMixin=Ym,e.AbstractPartOfProjectModelMixin=Km,e.AbstractPartOfProjectStoreMixin=qm,e.AbstractResourceStoreMixin=dp,e.ActionBase=ma,e.AddAction=Ma,e.AjaxHelper=Be,e.AjaxStore=ji,e.AjaxTransport=Nv,e.Animator=Rl,e.ArrayDataField=bs,e.ArrayHelper=ge,e.AssignmentModel=iv,e.AssignmentModelMixin=rv,e.AssignmentStore=Iv,e.AssignmentStoreMixin=xv,e.AsyncHelper=je,e.AvatarRendering=nm,e.Badge=vc,e.Bag=ii,e.Base=ue,e.BooleanCombo=fh,e.BooleanDataField=Cs,e.BrowserHelper=r,e.Button=Dc,e.ButtonGroup=vh,e.CI=om,e.CIFromSetOrArrayOrValue=np,e.CSSHelper=Ja,e.CalendarCache=Lm,e.CalendarCacheInterval=_m,e.CalendarCacheIntervalMultiple=Nm,e.CalendarCacheMultiple=Wm,e.CalendarCacheSingle=Um,e.CalendarIntervalMixin=Gm,e.CalendarIntervalStore=Xm,e.CalendarPanel=yh,e.Checkbox=Ch,e.ChipView=ch,e.ChronoMixinBase=class{initialize(e){e&&Object.assign(this,e)}static new(e){const t=new this;return t.initialize(e),t}},e.ClickRepeater=Ml,e.Clipboardable=e=>class extends(e||ue){static $name="Clipboardable";static configurable={useNativeClipboard:!1};construct(...e){super.construct(...e),globalThis.bryntum.clipboard||(globalThis.bryntum.clipboard=new Wd),globalThis.bryntum.clipboard.ion({paste:"onClipboardPaste",contentChange:"onClipboardContentChange",thisObj:this})}get clipboard(){return globalThis.bryntum.clipboard}onClipboardPaste({text:e,source:t}){const n=this,{clipboardText:r,isCut:s}=n,i=n.compareClipboardText(r,e);var a;i&&s?(null===(a=n.handleCutData)||void 0===a||a.call(n,{text:e,source:t}),n.isCut=!1,n.cutData=null):i||n.clearClipboard(!1)}onClipboardContentChange({newText:e}){this.compareClipboardText(this.clipboardText,e)||this.clearClipboard(!1)}set cutData(e){var t,n;const r=this;null===(t=r._cutData)||void 0===t||t.forEach((e=>r.setIsCut(e,!1))),r._cutData=ge.asArray(e),null===(n=r._cutData)||void 0===n||n.forEach((e=>r.setIsCut(e,!0)))}get cutData(){return this._cutData}setIsCut(){}async writeToClipboard(e,t,n={}){if(!1===await this.beforeCopy({data:e,isCut:t,...n}))return;const r=this,s="string"==typeof e,i=s?e:r.stringConverter?r.stringConverter(e):T.safeJsonStringify(e);return r.clipboardText=i,await r.clipboard.writeText(i,r.useNativeClipboard),r.clipboardData=e,r.isCut=t,r.cutData=t&&!s?e:null,i}async readFromClipboard(e={},t=!1){var n;const r=this,{clipboard:s}=r,i=await s.readText(r.useNativeClipboard),{isOwn:a,data:o}=r.transformClipboardText(i),l=i&&a&&r.isCut;if(!(null==o||Array.isArray(o)&&0==o.length||!1===await(null===(n=r.beforePaste)||void 0===n?void 0:n.call(r,{data:o,text:i,...e,isCut:l}))))return a||r.clearClipboard(!1),t||s.triggerPaste(r),o}async clearClipboard(e=!0){const t=this;t.clipboardData=t.clipboardText=t.cutData=null,t.isCut=!1,e&&await t.clipboard.clear(t.useNativeClipboard)}compareClipboardText(e,t){const n=/\r\n|(?!\r\n)[\n-\r\x85\u2028\u2029]/g;return(null==e?void 0:e.replace(n,"\n"))===(null==t?void 0:t.replace(n,"\n"))}transformClipboardText(e){const t=this,n=t.compareClipboardText(t.clipboardText,e);return{isOwn:n,data:n?t.clipboardData:t.stringParser&&e?t.stringParser(e):e}}hasClipboardData(){const{clipboard:e}=this,{_content:t}=e;if(!this.useNativeClipboard||!e.hasNativeAccess)return Boolean(t&&this.transformClipboardText(t).data)}},e.CollapseTool=Nl,e.Collection=ni,e.CollectionFilter=Ws,e.CollectionSorter=Ys,e.ColorBoxCombo=Gp,e.ColorField=wh,e.ColorPicker=Sh,e.ColumnCombo=Xp,e.ColumnDrag=Pp,e.ColumnFilterField=Ey,e.ColumnHeaderMenu=$p,e.ColumnModel=af,e.ColumnPickerButton=xy,e.ColumnScrollButton=ky,e.ColumnToolbars=_p,e.Combo=gh,e.Config=Y,e.Container=yl,e.ContextMenuBase=Jc,e.CoreAssignmentMixin=mp,e.CoreAssignmentStoreMixin=vp,e.CoreCalendarManagerStoreMixin=bp,e.CoreCalendarMixin=yp,e.CoreDependencyMixin=Cp,e.CoreDependencyStoreMixin=wp,e.CoreEventMixin=up,e.CoreEventStoreMixin=xp,e.CoreHasAssignmentsMixin=Dp,e.CoreHasDependenciesMixin=Tp,e.CorePartOfProjectGenericMixin=Jm,e.CorePartOfProjectModelMixin=tp,e.CorePartOfProjectStoreMixin=pp,e.CoreResourceMixin=hp,e.CoreResourceStoreMixin=kp,e.CrudManager=Ny,e.CrudManagerView=Cy,e.DataField=ys,e.DataGenerator=Rd,e.DateDataField=Ss,e.DateField=Mh,e.DateHelper=Bt,e.DatePicker=Ih,e.DateTimeField=$h,e.DayTime=Du,e.Delayable=Ur,e.DelayableWrapper=Op,e.DemoBot=Od,e.DependencyBaseModel=Xf,e.DependencyModel=Jf,e.DependencyStore=wv,e.DependencyStoreMixin=Cv,e.DisplayField=Th,e.DomClassList=Sn,e.DomDataStore=Vi,e.DomHelper=yr,e.DomSync=go,e.DragContext=Xd,e.DragHelper=ld,e.DragProxy=Zd,e.DragTipProxy=Zu,e.Draggable=Jd,e.Droppable=Qd,e.Duration=js,e.DurationField=_h,e.DynamicObject=sc,e.Editor=jh,e.EventHelper=Mn,e.EventModel=Kf,e.EventModelMixin=Uf,e.EventStore=bv,e.EventStoreMixin=av,e.Events=Ne,e.ExpandCollapse=Uv,e.Factoryable=fs,e.Featureable=eu,e.Fencible=yu,e.Field=sh,e.FieldContainer=Qu,e.FieldFilterPicker=rg,e.FieldFilterPickerGroup=ig,e.FieldSet=ag,e.FileField=og,e.FilePicker=lg,e.FilterField=cg,e.Finalizable=Hd,e.Formatter=Ld,e.Fullscreen=mo,e.FunctionHelper=Ce,e.GetEventsMixin=lv,e.GlobalEvents=xr,e.GridRowModel=Qf,e.Histogram=Qg,e.Hoverable=e=>class extends(e.mixin(Ur)){static get $name(){return"Hoverable"}static get configurable(){return{hoverCls:null,hoverAnimationCls:null,hoverRootCls:null,hoverRootActiveCls:null,hoverDelay:null,hoverElement:null,hoverIgnoreElement:null,hoverEdges:null,hoverEdgeSize:10,hoverRootElement:{$config:"nullify",value:null},hoverSelector:null,hoverTarget:{$config:"nullify",value:null},hoverTrack:null,hoverZone:null}}static get delayable(){return{setHoverTarget:0}}hoverEnter(e){}hoverIgnore(e){var t;return null===(t=this.hoverIgnoreElement)||void 0===t?void 0:t.contains(e)}hoverLeave(e){}hoverMove(e){}onHoverMouseMove(e){const t=this,{hoverEdges:n,hoverEdgeSize:r,hoverTarget:s}=t;if(s){if(n){const{top:i,left:a,width:o,height:l,right:c,bottom:d}=s.getBoundingClientRect(),{clientX:u,clientY:h}=e,g=a+o/2,m=i+l/2,p=h<(r?i+r:m),f=u>=(r?c-r:g),v=p||h>=(r?d-r:m)?p?"t":"b":"",y=f||u<(r?a+r:g)?f?"r":"l":"";t.hoverZone=(n.includes(v)?v:"")+(n.includes(y)?y:"")}t.hoverEvent=e,t.hoverTrack&&t.hoverMove(e)}}onHoverMouseOver(e){this.hoverEvent=e,this.hoverElement=e.target}onHoverMouseOut(e){this.hoverEvent=e,this.hoverElement=e.relatedTarget}updateHoverDelay(e){this.setHoverTarget.delay=e}changeHoverEdges(e){return!0===e?"trbl":(e||"").replace("v","tb").replace("h","lr")}updateHoverEdges(){this.syncHoverListeners()}changeHoverElement(e){if(!this.hoverIgnore(e))return e}updateHoverElement(e){const{hoverSelector:t}=this;var n;t&&(e=null===(n=e)||void 0===n?void 0:n.closest(t));this.setHoverTarget(e)}updateHoverRootElement(e,t){const{hoverRootCls:n}=this;n&&(null==t||t.classList.remove(n),null==e||e.classList.add(n)),this.syncHoverListeners()}changeHoverTarget(e,t){return t&&(this.hoverZone=null),e}updateHoverTarget(e,t){const n=this,{hoverCls:r,hoverAnimationCls:s,hoverRootActiveCls:i,hoverRootElement:a}=n;i&&(null==a||a.classList[e?"add":"remove"](i)),t&&(r&&t.classList.remove(r),s&&t.classList.remove(s),n.hoverLeave(t)),e&&(r&&e.classList.add(r),n.hoverEnter(t),n.hoverTrack&&n.hoverMove(n.hoverEvent),s&&(e.getBoundingClientRect(),e.classList.add(s)))}updateHoverTrack(){this.syncHoverListeners()}updateHoverZone(e){const{hoverAnimationCls:t,hoverTarget:n}=this;if(n){const{className:r}=n,s=Sn.change(r,e?ou[e]:null,au);r!==s&&(n.className=s,e&&t&&(n.classList.remove(t),n.getBoundingClientRect(),n.classList.add(t)))}}setHoverTarget(e){this.hoverTarget=e}syncHoverListeners(){var e;const t=this,n=t.hoverRootElement,r={element:n,thisObj:t,mouseover:"onHoverMouseOver",mouseout:"onHoverMouseOut"};(t.hoverTrack||t.hoverEdges)&&(r.mousemove="onHoverMouseMove"),null===(e=t._hoverRootDetacher)||void 0===e||e.call(t),t._hoverRootDetacher=n&&Mn.on(r)}},e.IdHelper=Us,e.Identifiable=rs,e.ImageItem=uy,e.InsertAction=La,e.InsertChildAction=Da,e.InstancePlugin=Nr,e.IntegerDataField=Ts,e.IntervalCache=zm,e.JsonEncoder=jv,e.JsxItem=hy,e.KeyMap=Fo,e.Label=sg,e.Labelable=Ju,e.Layout=ol,e.List=lh,e.LoadMaskable=lu,e.LocaleHelper=We,e.LocaleManager=Ue,e.Localizable=Je,e.MAX_DATE=Am,e.MI=cm,e.MIN_DATE=Om,e.Mask=Ao,e.Menu=Xc,e.MenuItem=Kc,e.MessageDialog=hg,e.Minifiable=e=>class extends(e||ue){static $name="Minifiable";static configurable={minifiable:!0,minified:null};compose(){const{minified:e}=this;return{class:{"b-minified":e}}}get widgetClass(){}},e.Model=Ns,e.ModelDataField=Es,e.ModelLink=hs,e.ModelStm=as,e.Month=Tu,e.Navigator=$d,e.NumberDataField=xs,e.NumberField=Ah,e.NumberFormat=Bd,e.ObjectDataField=ks,e.ObjectHelper=Ut,e.Objects=F,e.Override=du,e.PagingToolbar=gg,e.Panel=Hc,e.PanelCollapser=nc,e.PanelCollapserOverlay=vg,e.Parser=Hu,e.PartOfProject=Yf,e.PasswordField=yg,e.PickerField=ah,e.Pluggable=jr,e.Point=yn,e.Popup=Uc,e.ProgressItem=gy,e.ProjectCombo=Ry,e.ProjectCrudManager=Vv,e.ProjectModel=Wv,e.ProjectModelCommon=of,e.ProjectModelMixin=zf,e.ProjectModelTimeZoneMixin=jf,e.Promissory=Ro,e.RTL=Po,e.Radio=bg,e.RadioGroup=Cg,e.RandomGenerator=kd,e.RatingItem=my,e.Rectangle=vn,e.RecurrenceModel=Rf,e.RecurringEventsMixin=vv,e.RecurringTimeSpan=Ff,e.RecurringTimeSpansMixin=$f,e.RemoveAction=ja,e.RemoveAllAction=za,e.RemoveChildAction=ka,e.Renderable=Oo,e.ResizeHelper=dd,e.ResizeMonitor=yo,e.ResourceAvatarsItem=ny,e.ResourceModel=nv,e.ResourceModelMixin=ev,e.ResourceStore=Ev,e.ResourceStoreMixin=Dv,e.ResourceTimeRangeModel=Pf,e.ResourceTimeRangeStore=_f,e.ResourcesCombo=Zp,e.Responsive=Hg,e.ResponsiveCards=Yv,e.Ripple=dl,e.Rotatable=Pl,e.Scale=tm,e.SchedulerCoreEvent=Ep,e.SchedulerCoreProjectMixin=Ap,e.SchedulerProjectCombo=Iy,e.SchedulerProjectModel=Mv,e.ScrollManager=Uu,e.Scroller=Io,e.SeparatorItem=py,e.SimpleTaskEdit=Vp,e.SlideToggle=Dg,e.Slider=wg,e.SortedMap=Bm,e.Splitter=kg,e.State=es,e.StateBase=Wi,e.StateProvider=Zr,e.StateStorage=Yr,e.StateTrackingManager=Za,e.Store=Li,e.StoreCRUD=oi,e.StoreChained=Si,e.StoreChanges=li,e.StoreDataField=Is,e.StoreFilter=ci,e.StoreGroup=hi,e.StoreProxy=gi,e.StoreRelation=mi,e.StoreSearch=yi,e.StoreSort=bi,e.StoreState=wi,e.StoreStm=Oi,e.StoreSum=pi,e.StoreSync=Ri,e.StoreTree=ki,e.StringDataField=ws,e.StringHelper=T,e.Styleable=Ug,e.SwimlaneCombo=Jp,e.SwimlaneDrag=Bp,e.SwimlaneFilterField=My,e.SwimlaneModel=Hv,e.SwimlanePickerButton=Oy,e.SwimlaneScrollButton=Ay,e.Tab=Ig,e.TabBar=Mg,e.TabPanel=Pg,e.TagCombo=fy,e.TagsItem=vy,e.TaskBoard=Ty,e.TaskBoardBase=wy,e.TaskBoardColumns=Kv,e.TaskBoardDom=Gv,e.TaskBoardDomEvents=Xv,e.TaskBoardFeature=Fp,e.TaskBoardLinked=Kp,e.TaskBoardScroll=Zv,e.TaskBoardStores=Jv,e.TaskBoardSwimlanes=Qv,e.TaskBoardTag=By,e.TaskBoardVirtualization=ey,e.TaskColorCombo=ef,e.TaskColorPicker=Qp,e.TaskDrag=Up,e.TaskDragSelect=qp,e.TaskEdit=nf,e.TaskEditor=tf,e.TaskFilterField=Fy,e.TaskItem=Np,e.TaskItems=oy,e.TaskMenu=rf,e.TaskModel=Bv,e.TaskNavigation=cy,e.TaskSelection=dy,e.TaskStore=zv,e.TaskTooltip=sf,e.TemplateHelper=gd,e.TemplateItem=yy,e.TextAreaField=Lg,e.TextAreaPickerField=$g,e.TextField=ih,e.TextItem=ty,e.TimeField=Ph,e.TimePicker=Fh,e.TimeRangeModel=Vf,e.TimeRangeStore=Bf,e.TimeSpan=df,e.TimeZoneHelper=Dd,e.TimeZonedDatesMixin=cf,e.Toast=Td,e.TodoListField=Py,e.TodoListItem=by,e.Tool=Ll,e.Toolable=lc,e.Toolbar=Fc,e.Tooltip=Xu,e.Transaction=sa,e.TreeNode=cs,e.UndoRedo=Ly,e.UndoRedoBase=ph,e.UnspecifiedTimeIntervalModel=Zm,e.UpdateAction=ya,e.VersionHelper=P,e.WalkHelper=Ii,e.Wbs=Ti,e.WebSocketManager=zd,e.Widget=il,e.WidgetHelper=Ed,e.WidgetTag=jy,e.XMLHelper=xd,e.YearPicker=Dh,e.ZoomSlider=$y,e.binarySearch=jm,e.combineCalendars=e=>{const t=$m(e);if(0===t.length)throw new Error("No calendars to combine");t.sort(((e,t)=>e.internalId<t.internalId?-1:1));const n=t.map((e=>e.internalId+"/")).join(""),r=t.map((e=>e.version+"/")).join("");let s,i=Hm.get(n);return s=i&&i.versionsHash===r?i.cache:new Wm({calendarCaches:t.map((e=>e.calendarCache))}),s},e.delay=rp,e.format=(e,...t)=>e.replace(/{(\d+)}/g,((e,n)=>void 0!==t[n]?t[n]:e)),e.isDateFinite=e=>{if(!e)return!1;const t=e.getTime();return t!==Om.getTime()&&t!==Am.getTime()},e.isEqualEffectiveDirection=(e,t)=>!(e&&!t||!e&&t)&&(!e&&!t||e.direction===t.direction&&("own"===e.kind&&"own"===t.kind||"enforced"===e.kind&&"enforced"===t.kind&&e.enforcedBy===t.enforcedBy||"inherited"===e.kind&&"inherited"===t.kind&&e.inheritedFrom===t.inheritedFrom)),e.isNotNumber=e=>Number(e)!==e,e.later=sm,e.stripDuplicates=$m,e.unitMagnitudes=Nt,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=taskboard.umd.min.js.map