/*!
 *
 * Bryntum TaskBoard 5.6.2
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
import{Animator as v,Delayable_default as D,DomClassList as x,DomHelper as E,EventHelper as f,ObjectHelper as L,PanelCollapser as g,__publicField as h}from"./chunk-MZVS5JQA.js";var{dockIsHorz:k}=g.maps,H={top:0,down:0,left:1,bottom:2,up:2,right:3},d={up:{from:"translate(0,0)",to:"translate(0,-100%)"},down:{from:"translate(0,0)",to:"translate(0,100%)"},left:{from:"translate(0,0)",to:"translate(-100%,0)"},right:{from:"translate(0,0)",to:"translate(100%,0)"}},i=class extends g.mixin(D){static get configurable(){return{autoCloseDelay:1e3,autoClose:!0,revealing:{value:null,$config:null,default:!1},recollapseTool:{type:"collapsetool",cls:"b-recollapse",collapsify:"overlay",handler(){var l;(l=this.collapsible)==null||l.toggleReveal()}}}}static get delayable(){return{doAutoClose:0}}doAutoClose(){this.toggleReveal(!1)}updateAutoCloseDelay(l){const{doAutoClose:e}=this;(e.suspended=l==null||l<0)||(e.delay=l,e.immediate=!l)}changeRecollapseTool(l){const e=this,{panel:t}=e;if(e.isConfiguring||e.isDestroying||!t||t.isDestroying)return l;t.tools={recollapse:l}}beforeCollapse(l){if(super.beforeCollapse(l)===!1)return!1;this.panel.revealed&&(l.animation=null)}applyHeaderDock(l,e=!0){var t;(t=this.panel)==null||t.recompose(),super.applyHeaderDock(l,e)}collapseBegin(l){const e=this,{collapseDir:t,innerElement:a}=e,{animation:n}=l,{collapseTool:r,panel:o}=e;e.configuredWidth=o._lastWidth,e.configuredHeight=o._lastHeight,e.applyHeaderDock(!0),e.lockInnerSize(),r==null||r.element.classList.add("b-collapsed"),n&&(o.element.classList.add("b-collapsing"),n.element=a,n.transform=d[t],l.animation=v.run(n))}onComplete(l){var e,t;super.onComplete(l);const a=this,{panel:n}=a,{element:r}=n;a.autoCloseLeaveDetacher=(e=a.autoCloseLeaveDetacher)==null?void 0:e.call(a),a.autoCloseClickDetacher=(t=a.autoCloseClickDetacher)==null?void 0:t.call(a),a.doAutoClose.cancel(),l==="reveal"&&a.autoClose&&(n.containsFocus&&(a.autoCloseLeaveDetacher=f.on({element:r,mouseenter:o=>{a.doAutoClose.cancel()},mouseleave:o=>{a.doAutoClose()}})),a.autoCloseClickDetacher=f.on({element:document.body,thisObj:n,mousedown:o=>{var s;!n.owns(o)&&!((s=a.revealer)!=null&&s.contains(o.target))&&a.autoCloseDelay!=null&&a.doAutoClose.now()}}))}expandBegin(l){const e=this,{animation:t}=l,{collapseDir:a,collapseTool:n,innerElement:r,panel:o}=e,{element:s}=o;s.classList.remove("b-collapsed","b-collapsing"),e.restoreConfiguredSize(),e.lockInnerSize(!1),e.lockInnerSize(),n==null||n.element.classList.remove("b-collapsed"),t&&(s.classList.add("b-collapsed","b-expanding"),t.element=r,t.transform={from:d[a].to,to:d[a].from},l.animation=v.run(t))}expandEnd(l){super.expandEnd(l);const{panel:e}=this;l.completed&&(e.revealed=!1),e.element.classList.remove("b-expanding")}expandRevert(l){super.expandRevert(l),this.panel.element.classList.add("b-expanding")}get innerElement(){return this.panel.overlayElement}get innerSizeElement(){return this.panel.element}get toolsConfig(){const l=this,{direction:e}=l,t=super.toolsConfig,a=l.recollapseTool;return a?{...t,recollapse:a&&L.assign({direction:e.toLowerCase()},a)}:t}lockInnerSize(l=!0){const e=this,{panel:t}=e,a=l&&t.rectangle(),n=l?[0,0,0,0]:"",r=super.lockInnerSize(l);return l&&(n[H[e.collapseDir]]=`-${a[e.collapseDim]+10}px`),t.element.style.clipPath=l?`inset(${n.join(" ")})`:"",r}onOverlayTransitionDone(l){const e=this,{panel:t}=e;l.srcElement===t.overlayElement&&e.revealing&&(e.revealing=!1,e.onComplete(t.revealed?"reveal":"unreveal"))}onRevealerClick(){this.toggleReveal()}toggleReveal(l){const{panel:e}=this,{element:t}=e;e.collapsed&&(this.revealer=E.getActiveElement(t),l==null&&(l=!e.revealed),e.revealed!==l&&e.trigger("beforeToggleReveal",{reveal:l})!==!1&&(!l&&t.contains(this.revealer)&&e.revertFocus(!0),this.revealing=!0,e.revealed=l))}updateRevealing(l){const e=this,t=/left|right/i,{panel:a}=e,n=t.test(e.collapseDir)?"height":"width";a&&(e.innerElement.style[n]="0px",e.innerElement.style[`min-${n}`]="100%",a.element.classList[l?"add":"remove"]("b-panel-overlay-revealing"))}wrapCollapser(l,e){var t;const a=this,{collapseDir:n,panel:r}=a,{expandedHeaderDock:o,header:s,uiClassList:c}=r,u=(t=r.tools)==null?void 0:t.recollapse,[C,b]=a.splitHeaderItems({as:"element",dock:a.collapseDock}),y=k[o],m=r.hasHeader?r.title||(s==null?void 0:s.title)||"\xA0":null;return u&&(u.direction=n),["overlayElement",{class:{...c,[`b-panel-overlay-header-${o}`]:1,[`b-panel-overlay-${n}`]:1,[`b-${y?"h":"v"}box`]:1,"b-panel-overlay":1,"b-box-center":1},listeners:{transitionend:p=>a.onOverlayTransitionDone(p),transitioncancel:p=>a.onOverlayTransitionDone(p)},children:{overlayHeaderElement:m&&{tag:"header",class:new x({...c,[`b-dock-${o}`]:1,"b-panel-header":1,"b-panel-overlay-header":1},s==null?void 0:s.cls),children:[...C,{reference:"overlayTitleElement",html:m,class:{...c,[`b-align-${(s==null?void 0:s.titleAlign)||"start"}`]:1,"b-header-title":1}},...b]},[l]:e}}]}};h(i,"$name","PanelCollapserOverlay"),h(i,"type","overlay"),i.initClass(),i._$name="PanelCollapserOverlay";export{i as PanelCollapserOverlay};
//# sourceMappingURL=chunk-6XUOCF5K.js.map
