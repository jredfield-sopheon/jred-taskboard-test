/*!
 *
 * Bryntum TaskBoard 5.6.2
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
var Ja=Object.defineProperty,Za=(s,e,t)=>e in s?Ja(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,x=(s,e,t)=>(Za(s,typeof e!="symbol"?e+"":e,t),t),Ks=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)},Qa=(s,e,t)=>(Ks(s,e,"read from private field"),t?t.call(s):e.get(s)),eo=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},to=(s,e,t,i)=>(Ks(s,e,"write to private field"),i?i.call(s,t):e.set(s,t),t),Ys,j=class{static cacheFlags(s=navigator.platform,e=navigator.userAgent){const t=this;t._isLinux=!!s.match(/Linux/),t._isMac=!!s.match(/Mac/),t._isWindows=!!s.match(/Win32/),t._isMobile=!!(e.match(/Mobile|Opera Mini|Opera Mobi|Puffin/)||typeof globalThis.orientation=="number"),t._isWebkit=!!(e.match(/WebKit/)&&!e.match(/Edg/)),t._firefoxVersion=t.getVersion(e,/Firefox\/(\d+)\./),t._isFirefox=t._firefoxVersion>0,t._chromeVersion=t.getVersion(e,/Chrom(?:e|ium)\/(\d+)\./),t._isChrome=t._chromeVersion>0,t._isSafari=!!e.match(/Safari/)&&!t._isChrome,t._isMobileSafari=!!e.match(/Mobile.*Safari/),t._safariVersion=t.getVersion(e,/Version\/(.*).Safari/),t._isAndroid=!!e.match(/Android/g)}static get supportsOverflowClip(){if(this._supportsOverflowClip==null){const s=document.createElement("div");s.style.overflow="clip",s.style.display="none",document.documentElement.appendChild(s),this._supportsOverflowClip=s.ownerDocument.defaultView.getComputedStyle(s).getPropertyValue("overflow")==="clip",s.remove()}return this._supportsOverflowClip}static get supportsSticky(){return!0}static getVersion(s,e){const t=s.match(e);return t?parseFloat(t[1]):0}static get isTouchDevice(){return this._isTouchDevice===void 0&&(this._isTouchDevice=globalThis.matchMedia("(pointer:coarse)").matches),this._isTouchDevice}static get isHoverableDevice(){return this._isHoverableDevice===void 0&&(this._isHoverableDevice=globalThis.matchMedia("(any-hover: hover)").matches),this._isHoverableDevice}static get isBrowserEnv(){return typeof window!="undefined"}static get isMac(){return this._isMac}static get isWindows(){return this._isWindows}static get isLinux(){return this._isLinux}static get isAndroid(){return this._isAndroid}static get isWebkit(){return this._isWebkit}static get isChrome(){return this._isChrome}static get chromeVersion(){return this._chromeVersion}static get isFirefox(){return this._isFirefox}static get firefoxVersion(){return this._firefoxVersion}static get isSafari(){return this._isSafari}static get safariVersion(){return this._safariVersion}static get isMobileSafari(){return this._isMobileSafari}static get isMobile(){return this._isMobile}static get platform(){const s=this;return s._isLinux?"linux":s._isMac?"mac":s._isWindows?"windows":s._isAndroid?"android":s._isMobileSafari?"ios":null}static get supportsPassive(){return!0}static get supportsRandomUUID(){if(this._supportsRandomUUID===void 0)try{this._supportsRandomUUID=globalThis.crypto.randomUUID().length>0}catch(s){this._supportsRandomUUID=!1}return this._supportsRandomUUID}static get storageAvailable(){let s,e;try{return s=localStorage,e="__storage_test__",s.setItem(e,e),s.removeItem(e),!0}catch(t){return t instanceof DOMException&&(t.code===22||t.code===1014||t.name==="QuotaExceededError"||t.name==="NS_ERROR_DOM_QUOTA_REACHED")&&s.length!==0}}static setLocalStorageItem(s,e){this.storageAvailable&&localStorage.setItem(s,e)}static getLocalStorageItem(s){return this.storageAvailable&&localStorage.getItem(s)}static removeLocalStorageItem(s){this.storageAvailable&&localStorage.removeItem(s)}static searchParam(s,e=null,t=document.location.search){const i=new RegExp(`[?&]${s}=?([^&]*)`),r=t.match(i);return r&&r[1]||e}static getCookie(s){const e=encodeURIComponent(s)+"=",t=document.cookie.split(";");for(let i=0;i<t.length;i++){let r=t[i];for(;r.charAt(0)===" ";)r=r.substring(1,r.length);if(r.indexOf(e)===0)return decodeURIComponent(r.substring(e.length,r.length))}return""}static download(s,e){const t=document.createElement("a");t.download=s,t.href=e||s,t.style.cssText="display:none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}static downloadBlob(s,e){const t=globalThis.URL.createObjectURL(s);this.download(e,t),globalThis.URL.revokeObjectURL(t)}static get queryString(){var s;const e=new URL(globalThis.location.href).searchParams;return(s=Object.fromEntries)==null?void 0:s.call(Object,e.entries())}static copyToClipboard(s){let e=!0;const t=document.createElement("textarea");t.value=s,t.style.height=t.style.width=0,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(i){e=!1}return t.remove(),e}static isBryntumOnline(s){return s=Array.isArray(s)?s:[s],!!(/^(www\.)?bryntum\.com/.test(globalThis.location.host)||s!=null&&s.some(e=>this.queryString[e]!=null))}static get isCSP(){const{bryntum:s,document:e}=globalThis;return s.CSP==null&&(s.CSP=!!e.querySelector('meta[http-equiv="Content-Security-Policy"]')),s.CSP}};x(j,"supportsPointerEvents",!!(globalThis.PointerEvent||globalThis.MSPointerEvent)),x(j,"supportsPointerEventConstructor",typeof PointerEvent!="undefined"),x(j,"PointerEventConstructor",globalThis.PointerEvent||globalThis.CustomEvent),x(j,"isPhone",(Ys=globalThis.matchMedia)==null?void 0:Ys.call(globalThis,"(max-height:414px) or (max-width:414px)").matches),j.isBrowserEnv&&j.cacheFlags(),j._$name="BrowserHelper";var{hasOwnProperty:io,toString:ro}=Object.prototype,{isFrozen:Gs}=Object,so=/\s*<\s*/,no=/\s*>\s*/,Xs={},Js={},Zs=Object.freeze({}),$=class ye{static assign(e,...t){for(let i,r,n=0;n<t.length;n++)if(i=t[n],i)for(r in i)e[r]=i[r];return e}static assignIf(e,...t){for(let i,r,n=0;n<t.length;n++)if(i=t[n],i)for(r in i)(!(r in e)||e[r]===void 0)&&(e[r]=i[r]);return e}static blend(e,t,i){i=i||Xs,e=e||{};const{clone:r=ye.clone,merge:n=ye.blend}=i;if(Array.isArray(t)){if(t.length>1)return t.forEach(l=>{e=ye.blend(e,l,i)}),e;t=t[0]}if(t){let l,a,o;for(a in t)o=t[a],o&&ye.isObject(o)&&(l=e[a],i.key=a,l&&ye.isObject(l)?(Gs(l)&&(e[a]=l=r(l,i)),o=n(l,o,i)):o=Gs(o)?o:r(o,i)),e[a]=o}return e}static clone(e,t){let i=e,r;if(e&&typeof e=="object")if(t&&typeof t=="object"&&t&&(t=null),ye.isObject(e))if(e.skipClone)i=e;else{i={};for(r in e)i[r]=ye.clone(e[r])}else if(Array.isArray(e))for(i=[],r=e.length;r-- >0;)i[r]=ye.clone(e[r]);else ye.isDate(e)?i=new Date(e.getTime()):t&&(i=t(e));return i}static createTruthyKeys(e){const t=k.split(e),i=t&&{};if(t)for(const r of t)r&&(i[r]=!0);return i}static getPath(e,t){return t.split(".").reduce((i,r)=>(i||Zs)[r],e)}static getPathDefault(e,t,i){const r=Array.isArray(t)?t:typeof t=="string"?t.split("."):[t],n=r.length-1;return r.reduce((l,a,o)=>(i&&!(a in l)&&(l[a]=o===n?i:{}),(l||Zs)[a]),e)}static hasPath(e,t){return t.split(".").every(i=>e&&i in e?(e=e[i],!0):!1)}static getTruthyKeys(e){const t=[];for(const i in e)e[i]&&t.push(i);return t}static getTruthyValues(e){const t=[];for(const i in e)e[i]&&t.push(e[i]);return t}static isClass(e){var t;return typeof e=="function"&&((t=e.prototype)==null?void 0:t.constructor)===e}static isDate(e){return!!(e!=null&&e.getUTCDate)&&ye.typeOf(e)==="date"}static isPromise(e){if(Promise&&Promise.resolve)return Promise.resolve(e)===e||typeof(e==null?void 0:e.then)=="function";throw new Error("Promise not supported in your environment")}static isEmpty(e){if(e&&typeof e=="object")for(const t in e)return!1;return!0}static isObject(e){const t=e==null?void 0:e.constructor;return!!(t?t===Object||t.getPrototypeOf&&t.prototype&&!Object.getPrototypeOf(t.prototype):e&&typeof e=="object")}static isInstantiated(e){return e?typeof e=="object"&&!ye.isObject(e):!1}static merge(e,...t){return ye.blend(e,t)}static mergeItems(e,t,i){i=i||Xs;let r,n,l,a,o,u,c;const{merge:d=ye.blend}=i;if(e=e||{},Array.isArray(t))t.forEach(f=>{e=ye.mergeItems(e,f,i)});else if(t)for(o in t)if(c=t[o],r=null,o.includes(">")?([o,r]=o.split(no),n=0):o.includes("<")&&([r,o]=o.split(so),n=1),o in e)c&&e[o]&&d&&(i.key=o,c=d(e[o],c,i)),e[o]=c;else if(!r)e[o]=c,a==null||a.set(o,a.size);else{if(!a){a=new Map,l=0;for(const f in e)a.set(f,l++)}if(l=a.get(r),e[o]=c,l==null&&n)l=a.size;else{u=u||[],l=(l||0)+n;for(const f of a){const[g,h]=f;l<=h&&(u&&(u[a.size-h-1]=g),a.set(g,h+1))}if(u)for(;u.length;){const f=u.pop(),g=e[f];delete e[f],e[f]=g}}a.set(o,l)}return e}static setPath(e,t,i){return t.split(".").reduce((r,n,l,a)=>l===a.length-1?r[n]=i:(r[n]instanceof Object||(r[n]={}),r[n]),e),e}static typeOf(e){let t,i;return e===null?i="null":e!==e?i="nan":(i=typeof e,i==="object"?e.isBase?i="instance":Array.isArray(e)?i="array":(i=Js[t=ro.call(e)])||(Js[t]=i=t.slice(8,-1).toLowerCase()):i==="function"&&e.isBase&&(i="class")),i}};Object.defineProperty($,"hasOwn",{value:Object.hasOwn||((s,e)=>io.call(s,e))}),$._$name="Objects";var Qs,en,tn,rn,sn=/([a-z])([A-Z])/g,lo=/[\n\r]/g,ao=/[.*+?^${}()|[\]\\]/g,oo=/[&<]/,uo=/(^[^a-z]+[^\w]+)/gi,co=/\s+/,fo=/^[^a-z]+|[^\w:.-]+/gi,ho=(s,e)=>en[e.toLowerCase()]||String.fromCharCode(parseInt(e.substr(2),10)),go=(s,e)=>Qs[e],po=(s,e,t)=>`${e}-${t.toLowerCase()}`,mo=(s,e,t)=>`${e} ${t.toLowerCase()}`,yo=s=>s?`_x${[...s].map(e=>e.charCodeAt(0).toString(16)).join("")}`:"__blank__",nn={},ln={},ft=[],vo=function(s,e){if(e&&typeof e=="object"){for(;ft.length&&ft[ft.length-1]!==this;)ft.pop();if(ft.includes(e))return"[Circular]";ft.push(e)}return e},an=class ct{static capitalize(e){return e&&e[0].toUpperCase()+e.substr(1)}static uncapitalize(e){return e&&e[0].toLowerCase()+e.substr(1)}static hyphenate(e){const t=nn[e];return t||(nn[e]=e.replace(sn,po))}static separate(e){const t=ln[e];return t||(ln[e]=this.capitalize(e.replace(sn,mo)))}static createId(e){return String(e).replace(uo,yo)}static makeValidDomId(e,t=""){return e==null?null:String(e).replace(fo,t)}static escapeRegExp(e,t){let i=e.replace(ao,"\\$&");return t!==void 0&&(i=new RegExp(i,t)),i}static decodeHtml(e){return e&&String(e).replace(rn,ho)}static encodeHtml(e=""){return e&&String(e).replace(tn,go)}static encodeHtmlBR(e){var t;return(t=ct.encodeHtml(e))==null?void 0:t.replace(lo,"<br>")}static isHtml(e){return typeof e=="string"&&oo.test(e||"")}static initHtmlEntities(e){e=e||{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};const t=Object.keys(e);Qs=e,en=t.reduce((i,r)=>(i[e[r]]=r,i),{}),tn=new RegExp(`([${t.map(i=>"[-]".includes(i)?"\\"+i:i).join("")}])`,"g"),rn=new RegExp(`(${Object.values(e).join("|")}|&#[0-9]+;)`,"ig")}static safeJsonParse(e){let t=null;try{t=JSON.parse(e)}catch(i){}return t}static safeJsonStringify(e,t=null,i=null){let r=null;try{t==="circular"&&(ft.length=0,t=vo),r=JSON.stringify(e,t,i)}catch(n){}return r}static joinPaths(e,t="/"){return e.join(t).replace(new RegExp("\\"+t+"+","g"),t)}static split(e,t=co){let i=e;return typeof i=="string"&&(i=e.trim(),i=i?i.split(t):[]),i}static xss(e,...t){const i=[];let r=t.length;for(i[r]=e[r];r-- >0;)i[r]=e[r]+ct.encodeHtml(t[r]);return i.join("")}static xssBR(e,...t){const i=[];let r=t.length;for(i[r]=e[r];r-- >0;)i[r]=e[r]+ct.encodeHtmlBR(t[r]);return i.join("")}static toJavaScriptValue(e,t){const i=$.typeOf(e);if(i==="boolean"||i==="string"||i==="number"||e===null)return ct.safeJsonStringify(e);if(e===globalThis)return"window";if(i==="date")return`new Date(${e.getFullYear()}, ${e.getMonth()}, ${e.getDate()}, ${e.getHours()}, ${e.getMinutes()}, ${e.getSeconds()}, ${e.getMilliseconds()})`;if(i==="array")return`[${e.map(r=>ct.toJavaScriptValue(r,t))}]`;if(i==="object"||i==="instance")return this.toJavaScriptString(e,t);if(i==="function"){let r=e.toString();return r.match(/^async (\w+?)\(/)?r=r.replace(/^async (\w+?)\(/,"async function("):!r.startsWith("async(")&&r.match(/^(\w+?)\(/)&&(r=r.replace(/^(\w+?)\(/,"function(")),r}if(i==="class")return e.toJavaScriptValue?e.toJavaScriptValue(t):Object.prototype.hasOwnProperty.call(e,"$name")?e.$name:e.name}static toJavaScriptString(e,t={}){var i;const r=(i=t.level)!=null?i:0,n=2;return`{
`+Object.keys(e).map(l=>" ".repeat((r+1)*n)+(l.match(/[- *]/)?`"${l}"`:l)+`: ${ct.toJavaScriptValue(e[l],{...t,level:r+1})}`).join(`,
`)+`
`+" ".repeat(r*n)+"}"}static encodeAttributeSelector(e,t){return`[${e}="${String(t).replace(/["\\]/g,"\\$&")}"]`}static generateUUID(){var e;return j.supportsRandomUUID?globalThis.crypto.randomUUID():(e=globalThis.crypto)!=null&&e.getRandomValues?("10000000-1000-4000-8000"+-1e11).replace(/[018]/g,t=>(t^globalThis.crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)):`${Date.now()}-${++ct.fakeNodeUUIDIndex}`}};x(an,"fakeNodeUUIDIndex",0);var k=an;k.initHtmlEntities(),k._$name="StringHelper";var le=class Cr{static setVersion(e,t){e=e.toLowerCase(),Te[e]={version:t,isNewerThan(n){return Cr.semanticCompareVersion(n,t,"<")},isOlderThan(n){return Cr.semanticCompareVersion(n,t,">")}};let i="";typeof productName!="undefined"&&(i=productName);const r=`${i}.${e}${t.replace(/\./g,"-")}`;if(j.isBrowserEnv&&!globalThis.bryntum.silenceBundleException)if(globalThis.bryntum[r]===!0)if(this.isTestEnv)globalThis.BUNDLE_EXCEPTION=!0;else{let n=i||e;n==="core"&&(n="grid");let l=k.capitalize(n);throw n==="schedulerpro"&&(l="SchedulerPro"),new Error(`The Bryntum ${l} bundle was loaded multiple times by the application.

Common reasons you are getting this error includes:

* Imports point to different types of the bundle (e.g. *.module.js and *.umd.js)
* Imports point to both sources and bundle
* Imports do not use the shortest relative path, JS treats them as different files
* Cache busters differ between imports, JS treats ${n}.module.js?1 and ${n}.module.js?2 as different files
* Imports missing file type, verify they all end in .js

See https://bryntum.com/products/${n}/docs/guide/${l}/gettingstarted/es6bundle#troubleshooting for more information

`)}else globalThis.bryntum[r]=!0}static getVersion(e){if(e=e.toLowerCase(),!Te[e])throw new Error("No version specified! Please check that you import VersionHelper correctly into the class from where you call `deprecate` function.");return Te[e].version}static semanticCompareVersion(e,t,i="="){e=e||"",t=t||"";const r=e.split(/[-.]/),n=t.split(/[-.]/),l=i.includes("<"),a=(u,c)=>{const d=["rc","beta","alpha"],f=u.map(g=>{if(d.includes(g))return-d.indexOf(g)-2;const h=Number.parseInt(g);return Number.isNaN(h)?-d.length:h});for(;f.length<c;)f.push(-1);return f},o=()=>{const u=Math.max(r.length,n.length),c=a(r,u),d=a(n,u);for(let f=0;f<u;f++)if(c[f]!==d[f])return l?c[f]<d[f]:c[f]>d[f];return!0};switch(i){case"=":return e===t;case"<=":case">=":return e===t||o();case"<":case">":return e!==t&&o()}return!1}static checkVersion(e,t,i){return Cr.semanticCompareVersion(Te.getVersion(e),t,i)}static deprecate(e,t,i){if(Te.checkVersion(e,t,"<"))console.warn(`Deprecation warning: You are using a deprecated API which will change in v${t}. ${i}`);else throw new Error(`Deprecated API use. ${i}`)}static get isTestEnv(){var e,t,i;const r=!!((e=globalThis.bryntum)!=null&&e.isTestEnv);try{return r||!!((i=(t=globalThis.parent)==null?void 0:t.bryntum)!=null&&i.isTestEnv)}catch(n){return r}}static get isDebug(){return!1}},Te=le;j.isBrowserEnv&&(Te.isTestEnv&&(j._isHoverableDevice=!0),globalThis.bryntum=Object.assign(globalThis.bryntum||{},{getVersion:Te.getVersion.bind(Te),checkVersion:Te.checkVersion.bind(Te),deprecate:Te.deprecate.bind(Te),license:"%LICENSE%"})),le._$name="VersionHelper";var{defineProperty:Vi,getOwnPropertyDescriptor:on}=Reflect,{hasOwnProperty:un,toString:Dr}=Object.prototype,_r=Symbol("instanceProperties"),cn=Symbol("configuring"),At=Symbol("lazyConfigValues"),dn=Dr.call(new Date),bo=/\s+/,Co=(s,e)=>(s[e]=1,s),ie=class Qt{static get(e,t){const{cache:i}=this,r=i[e]||(i[e]=new Qt(e));let n=r,l;return t&&(l=Qt.makeCacheKey(e,t),(n=l&&i[l])||(n=r.extend(t),l&&(i[l]=n))),n}constructor(e){const t=this,i=e[0].toUpperCase()+e.substr(1);t.base=t,t.name=e,t.field="_"+e,t.capName=i,t.changer="change"+i,t.initializing="initializing"+i,t.updater="update"+i}get descriptor(){let e=this._descriptor;return(!e||!un.call(this,"_descriptor"))&&(this._descriptor=e=this.makeDescriptor()),e}get initDescriptor(){let e=this._initDescriptor;return(!e||!un.call(this,"_initDescriptor"))&&(this._initDescriptor=e=this.makeInitter()),e}equal(e,t){return e===t}extend(e){const t=Object.assign(Object.create(this),e),{equal:i,merge:r}=e,{equalityMethods:n}=Qt;return typeof i=="string"&&(i.endsWith("[]")?t.equal=Qt.makeArrayEquals(n[i.substr(0,i.length-2)]):t.equal=n[i]),typeof r=="string"&&(t.merge=Qt.mergeMethods[r]),t}define(e){const t=on(e,this.name);let i=this.descriptor;t&&t.get&&(i=Object.assign({},i),i.get=t.get),Vi(e,this.name,i)}defineInitter(e,t){const{name:i}=this,r=e[_r];let n,l;!r[i]&&(l=on(e,i))&&!("value"in l)&&(r[i]=l),Vi(e,i,this.initDescriptor),this.lazy&&(n=e[At]||(e[At]=new Map),n.set(i,t))}static makeArrayEquals(e){return(t,i)=>{let r,n=t&&i&&t.length===(r=i.length);if(n&&Array.isArray(t)&&Array.isArray(i))if(e)for(;n&&r-- >0;)n=e(t[r],i[r]);else for(;n&&r-- >0;)n=t[r]===i[r];else n=e?e(t,i):t===i;return n}}static makeCacheKey(e,t){const i=Object.keys(t).sort();for(let r,n,l,a=i.length;a-- >0;)if(l=t[r=i[a]],l==null&&l===!1)i.splice(a,1);else{if(n=typeof l,n==="function")return null;n==="string"?i[a]=`${r}:"${l}"`:n==="number"&&(i[a]=`${r}:${l}`)}return i.length?`${e}>${i.join("|")}`:e}makeDescriptor(){const e=this,{base:t,field:i,changer:r,updater:n,name:l}=e;return t!==e&&t.equal===e.equal?t.descriptor:{get(){var a;return(a=this.configObserver)==null||a.get(l,this),this[i]},set(a){var o,u;const c=this;let d=c[i],f,g;if(typeof a=="string"){let h=a;a.startsWith("up.")?h=(o=c.owner)==null?void 0:o.resolveProperty(a.substr(3)):a.startsWith("this.")&&(h=c.resolveProperty(a.substr(5))),h!==void 0&&typeof h!="function"&&(a=h)}c[r]&&(f=(g=c[r](a,d))===void 0,f||(a=g,d=c[i])),!f&&!(e.equal===fn?d===a:e.equal(d,a))&&(c[i]=a,f=!0,(u=c[n])==null||u.call(c,a,d)),f&&!c.isDestroyed&&!c.onConfigChange.$nullFn&&c.onConfigChange({name:l,value:a,was:d,config:e})}}}makeInitter(){const e=this;return e!==e.base?e.lazy?e.makeLazyInitter():e.base.initDescriptor:e.makeBasicInitter()}makeBasicInitter(){const e=this,{initializing:t,name:i}=e;return{configurable:!0,get(){const r=this;return e.removeInitter(r),r[t]=!0,r[i]=r[cn][i],r[t]=!1,r.configDone[i]=!0,r[i]},set(r){e.removeInitter(this),this.configDone[i]=!0,this[i]=r}}}makeLazyInitter(){const e=this,{initializing:t,name:i}=e;return{configurable:!0,get(){const r=this,n=r[At].get(i);return e.removeInitter(r),r.isDestroying||(r[t]=!0,r[i]=n,r[t]=!1),r[i]},set(r){e.removeInitter(this),this[i]=r}}}removeInitter(e){const{name:t}=this,i=e[_r][t],r=e[At];i?Vi(e,t,i):delete e[t],r!=null&&r.delete(t)&&!r.size&&delete e[At]}setDefault(e,t){Vi(e.prototype,this.field,{configurable:!0,writable:!0,value:t})}merge(e,t){if(t&&e&&$.isObject(e)){if(t.isBase)return t.setConfig(e);$.isObject(t)&&(e=$.merge($.clone(t),e))}return e}},{prototype:ei}=ie,{equal:fn}=ei;ie.symbols={configuring:cn,instanceProperties:_r,lazyConfigs:At},ie.cache=Object.create(null),ie.equalityMethods={array:ie.makeArrayEquals(),date(s,e){return s===e?!0:s&&e&&Dr.call(s)===dn&&Dr.call(e)===dn?s.getTime()===e.getTime():!1},strict:ie.equal=fn},ie.mergeMethods={distinct(s,e){let t=e?e.slice():[];if(s!=null)if($.isObject(s))if(e===void 0)t=s;else{let i,r;for(i in s)r=t.indexOf(i),s[i]?r<0&&t.push(i):r>-1&&t.splice(r,1)}else Array.isArray(s)?s.forEach(i=>!t.includes(i)&&t.push(i)):t.includes(s)||t.push(s);return t},merge:ie.merge=ei.merge,classList(s,e){if(typeof s=="string"){if(!s.length)return e;s=s.split(bo)}return Array.isArray(s)&&(s=s.reduce(Co,{})),ie.merge(s,e)},objects(s,e){return s===!0?e||{}:ie.merge(s,e)},replace(s){return s},items(s,e,t,i){return i?$.mergeItems(e,s,{merge:(r,n)=>ei.merge(n,r)}):ei.merge(s,e)}},Object.assign(ei,{_descriptor:null,_initDescriptor:null,lazy:!1,nullify:!1,render:!1}),ie._$name="Config";var wo=class{constructor(s){s&&Object.assign(this,s)}getInherited(s,e=!0){var t;let i=this[s];return s in this||(i=(t=this.super)==null?void 0:t.getInherited(s,e),(i||e)&&(this[s]=i=Object.create(i||null))),i}},{getPrototypeOf:hn}=Object,{hasOwn:ke}=$,{defineProperty:gn}=Reflect,zi=Symbol("classMetaData"),pn=Symbol("mixinTag"),Mr=Symbol("originalConfig"),ef=Symbol("createdAt"),Be=ie.symbols.configuring,So=ie.symbols.instanceProperties,Pt=ie.symbols.lazyConfigs,Eo={merge:"replace",simple:!0},Bi=()=>{},mn=s=>new wo(s),yn={},To=Object.freeze({}),vn=Object.freeze([]),R=class dt{static get isBase(){return!0}get isBase(){return!0}static get declarable(){return["declarable","configurable","defaultConfig","properties","prototypeProperties"]}constructor(...e){const t=this,i=t.constructor;t.$meta.class!==i&&Bi(i.$meta),t.construct(...e),t.afterConstruct(),t.isConstructing=!1}static new(...e){return e=e.filter(t=>t),new this(e.length>1?this.mergeConfigs(...e):e[0])}construct(...e){e[0]!==null&&this.configure(...e),this.afterConfigure()}static destroy(...e){const t=i=>{i!=null&&i.destroy?i.destroy():Array.isArray(i)&&i.forEach(t)};t(e)}destroy(){const e=this,{id:t}=e;e.isDestroying=!0,e.destroy=Bi,e.doDestroy(),Object.setPrototypeOf(e,null);for(const i in e)i!=="destroy"&&i!=="isDestroying"&&delete e[i];delete e[Mr],e.isDestroyed=!0,e.id=t}_thisIsAUsedExpression(e){}static get $$name(){return ke(this,"$name")&&this.$name||ke(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}startConfigure(e){}finishConfigure(e){}afterConfigure(){}afterConstruct(){}callback(e,t,i=vn){const{handler:r,thisObj:n}=this.resolveCallback(e,t==="this"?this:t)||To;return r==null?void 0:r.apply(n,i)}resolveProperty(e){let t=this;for(;t;){if($.hasPath(t,e))return $.getPath(t,e);t=t.owner}}resolveCallback(e,t=this,i=!0){if(e!=null&&e.substring){if(e.endsWith("?")&&(i=!1,e=e.substring(0,e.length-1)),e.startsWith("up.")){for(e=e.substring(3),t=this.owner;t&&!t[e];t=t.owner);if(!t)return}else e.startsWith("this.")&&(e=e.substring(5),t=this);if(!t||!(t instanceof Object))return;e=t[e]}if(typeof e=="function")return{handler:e,thisObj:t};if(i)throw new Error(`No method named ${e} on ${t.$$name||"thisObj object"}`)}bindCallback(e,t=this){if(e){const{handler:i,thisObj:r}=this.resolveCallback(e,t);if(i)return i.bind(r)}}delay(e,t,i=e.name||e){return e=this.setTimeout?e:e.bind(this),(this.setTimeout?this:globalThis)[typeof t=="number"?"setTimeout":"requestAnimationFrame"](e,t,i)}doDestroy(){const e=this,{nullify:t}=e.$meta;if(t)for(let i=0;i<t.length;++i)e[t[i].field]!=null&&(e[t[i].name]=null)}destroyProperties(...e){var t,i;const r=this;let n;for(n of e)n in r&&(!r[Be]||!r[Be][n])&&((i=(t=r[n])==null?void 0:t.destroy)==null||i.call(t),delete r[n])}configure(e={}){const t=this,i=t.$meta,{beforeConfigure:r}=e,n=i.configs,l=t.getDefaultConfiguration();let a,o,u;t.initialConfig=e,t.isConfiguring=!0,Object.assign(t,t.getProperties());for(o in e)u=e[o],a=n[o],l[o]=a?a.merge(u,l[o],null,i):u;r&&(delete l.beforeConfigure,r(t,l)),t.setConfig(t[Mr]=l,!0),t.isConfiguring=!1}getConfig(e){return this[e]}setConfig(e,t){var i;const r=this,n=r[Be],l=n?r.configDone:r.configDone={},a=r.$meta.configs,o=r[Pt];let u,c;r[So]={},r[Be]=n?Object.setPrototypeOf(Object.assign({},e),n):e;for(c in e)e[c]!=null||ke(e,c)?(u=a[c]||ie.get(c),o!=null&&o.has(c)||u.defineInitter(r,e[c]),t||(l[c]=!1)):l[c]=!0;t&&r.startConfigure(e);for(c in e)!l[c]&&!(t&&((i=a[c])!=null&&i.lazy))&&(r[c]=e[c]);return n?r[Be]=n:delete r[Be],t&&r.finishConfigure(e),r}hasConfig(e){var t;const i=this,r=i[Be];return!!(i["_"+e]!=null||((t=i[Pt])==null?void 0:t.get(e))!=null||!i.configDone[e]&&r&&(r[e]!=null||ke(r,e)))}peekConfig(e){const t=this,i=t[Pt],r=t[Be];if(i!=null&&i.has(e))return i.get(e);if(r&&e in r){if(t.configDone[e])return t[e];if(r[e]!=null||ke(r,e))return r[e]}}triggerConfig(e){const t=this,{configDone:i}=t,r=t[Pt],n=t[Be],l=r!=null&&r.has(e)||n&&(n[e]!=null||ke(n,e))?!i[e]:null;return l&&t.getConfig(e),l}triggerConfigs(e){const t=this,i=t.$meta.configs,r=t[Pt],n=r?[...r.keys()].filter(l=>i[l].lazy===e):vn;for(const l of n)t.triggerConfig(l);return n.length?n:null}onConfigChange(){}get config(){const e={},t=this[Mr];for(const i in t)e[i]=t[i];return e}static processConfigValue(e,t){if(e===globalThis)return globalThis;if(Array.isArray(e))return e.map(i=>dt.processConfigValue(i,t));if(e instanceof dt)return t.visited.has(e)?void 0:e.getCurrentConfig(t);if(e instanceof HTMLElement||e instanceof DocumentFragment)return null;if($.isObject(e)){const i={};for(const r in e)r!=="owner"&&(i[r]=dt.processConfigValue(e[r],t));return i}return e}getConfigValue(e,t){var i;const r=this,n=r[Pt];if(!((i=r.$meta.configs[e])!=null&&i.lazy))return dt.processConfigValue(r[e],t);if(n!=null&&n.has(e))return dt.processConfigValue(n.get(e),t)}preProcessCurrentConfigs(){}getCurrentConfig(e={}){const t=this,i=e.configs==="all"?t.config:$.clone(t.initialConfig),r=e.visited||(e.visited=new Set),n=e.depth||(e.depth=0),l={};if(!r.has(t)){r.add(t),this.preProcessCurrentConfigs(i);for(const a in i){const o=t.getConfigValue(a,{...e,depth:n+1});o!==void 0&&(l[a]=o)}return l}}getConfigString(e={}){return k.toJavaScriptString(this.getCurrentConfig(e))}getTestCase(e={}){const t=this.isGantt?"Gantt":this.isSchedulerPro?"SchedulerPro":this.isCalendar?"Calendar":this.isScheduler?"Scheduler":this.isGrid?"Grid":this.isTaskBoard?"TaskBoard":null;if(t){const i=t.toLowerCase(),r=`../../build/${i}.module.js`;let n,l;e.import==="static"?(n=`import * as module from "${r}";Object.assign(window, module);`,l=""):(n=`import("${r}").then(module => { Object.assign(window, module);
`,l="});");const a=le.getVersion(i);return a&&(n+=`
console.log('${t} ${a}');
`),`${n}      
const ${i} = new ${t}(${this.getConfigString(e)});
${l}`}}downloadTestCase(e={}){e.output="return";const t=this.getTestCase(e);j.download("app.js","data:application/javascript;charset=utf-8,"+escape(t))}static initClass(){return this.$meta.class}static get $meta(){const e=this;let t=e[zi];return ke(e,zi)||(e[zi]=t=mn(),t.class=e,e.setupClass(t)),t}static onClassMixedIn(){}static mergeConfigs(e,...t){const i=this.$meta.configs,r=$.clone(e)||{};let n,l,a,o;for(l=0;l<t.length;++l)if(n=t[l],n)for(a in n)o=n[a],i[a]?o=i[a].merge(o,r[a]):r[a]&&o&&(o=ie.merge(o,r[a])),r[a]=o;return r}static mixin(...e){let t=this,i;for(i=0;i<e.length;++i){const r=e[i],n=r[pn]||(r[pn]=Symbol("mixinTag"));t[n]||(t=r(t),t[n]=!0,ke(t,"onClassMixedIn")&&t.onClassMixedIn())}return t}static setupClass(e){var t;const i=e.class,r=hn(i).$meta,n=i.$$name,l=r.names,a=i.prototype;if(gn(a,"$meta",{value:e}),Object.assign(e,{super:r,config:Object.create(r.config),configs:Object.create(r.configs),declarables:r.declarables,forkConfigs:r.forkConfigs,hierarchy:Object.freeze([...r.hierarchy,i]),names:l.includes(n)?l:Object.freeze([...l,n]),properties:r.properties,nullify:(t=r.nullify)==null?void 0:t.slice()}),l!==e.names){const o=`is${n}`,u=c=>{ke(c,o)||gn(c,o,{get(){return!0}})};u(a),u(i)}for(let o,u,c=0;c<e.declarables.length;++c)o=e.declarables[c],ke(i,o)&&(u=yn[o]||(yn[o]=`setup${k.capitalize(o)}`),i[u](i,e))}static setupConfigs(e,t,i){const r=e.config,n=e.configs,l=e.class,a=e.super;let{nullify:o}=e,u,c,d,f,g,h;for(const p in t)g=t[p],i?(u=n[p])?g=u.merge(g,r[p],e,a):u=ie.get(p,Eo):(c=d=f=void 0,g&&typeof g=="object"&&"$config"in g&&(d=g.$config,d&&!$.isObject(d)&&(d=$.createTruthyKeys(d)),f="default"in g,c=f?g.default:c,g=g.value),(u=n[p])?(h=u.nullify,d&&(u=u.extend(d)),g=u.merge(g,r[p],e,a)):(u=ie.get(p,d),u.define(l.prototype),f=!(u.field in l.prototype),h=!1),f&&u.setDefault(l,c),u.nullify&&!h&&(o||(o=e.nullify||(e.nullify=[]))).push(u)),g&&($.isObject(g)||Array.isArray(g))&&!Object.isFrozen(g)&&(e.forkConfigs=!0),n[p]=u,r[p]=g}static setupConfigurable(e,t){e.setupConfigs(t,e.configurable,!1)}static setupDefaultConfig(e,t){e.setupConfigs(t,e.defaultConfig,!0)}static setupDeclarable(e,t){const i=e.declarable;let r=t.declarables,n,l;for(l=0;l<i.length;++l)r.includes(i[l])||(n||(t.declarables=n=r=r.slice()),r.push(i[l]))}static setupProperties(e,t){t.properties=t.super.properties.slice(),t.properties.push(e),Object.freeze(t.properties)}static setupPrototypeProperties(e){Object.assign(e.prototype,e.prototypeProperties)}getDefaultConfiguration(){return this.constructor.getDefaultConfiguration()}static getDefaultConfiguration(){const e=this.$meta,t=e.forkConfigs?dt.fork(e.config):Object.create(e.config);if(le.isTestEnv&&j.isBrowserEnv&&t.testConfig&&globalThis.__applyTestConfigs)for(const i in t.testConfig)t[i]=t.testConfig[i];return t}static fork(e){let t=e,i,r;if(e&&$.isObject(e)&&!Object.isFrozen(e)){t=Object.create(e);for(i in e)r=e[i],r&&($.isObject(r)?t[i]=dt.fork(r):Array.isArray(r)&&(t[i]=r.slice()))}return t}getProperties(){const e=this.$meta.properties,t={};for(let i=0;i<e.length;i++)Object.assign(t,e[i].properties);return t}static get superclass(){return hn(this)}classHierarchy(e){const t=this.$meta.hierarchy,i=e?t.indexOf(e):0;return i>0?t.slice(i):t}static isOfTypeName(e){return this.$meta.names.includes(e)}detachListeners(e){let t=this.$detachers;if(t=t==null?void 0:t[e],t)for(;t.length;)t.pop()()}trackDetacher(e,t){const i=this.$detachers||(this.$detachers={});(i[e]||(i[e]=[])).push(t)}untrackDetachers(e){const t=this.$detachers;if(t)for(const i in t){const r=t[i];for(let n=r.length;n-- >0;)r[n].eventer===e&&r.splice(n,1)}}},Ir=R.prototype;Ir.onConfigChange.$nullFn=Bi.$nullFn=!0,R[zi]=Ir.$meta=mn({class:R,config:Object.freeze({}),configs:Object.create(null),declarables:R.declarable,forkConfigs:!1,hierarchy:Object.freeze([R]),names:Object.freeze(["Base"]),nullify:null,properties:Object.freeze([]),super:null}),Object.assign(Ir,{$detachers:null,configObserver:null,isConstructing:!0,isDestroyed:!1,isDestroying:!1}),R.emptyFn=Bi,le.setVersion("core","5.6.2"),R._$name="Base";var V=class Ha{static clean(e){return e.reduce((t,i)=>(i!=null&&!(Array.isArray(i)&&i.length===0)&&i!==""&&t.push(i),t),[])}static from(e,t,i){const r=[];if(e)for(const n of e)(!t||t(n))&&r.push(i?i(n):n);return r}static remove(e,...t){let i,r,n=!1;t=t[0]instanceof Set?[...t[0]]:t;for(let l=0;l<t.length;l++)r=t[l],(i=e.indexOf(r))!==-1&&(e.splice(i,1),n=!0);return n}static findInsertionIndex(e,t,i=this.lexicalCompare,r){const n=t.length;let l,a;return r<n&&(l=r>0?i(t[r-1],e):0,a=r<n-1?i(e,t[r]):0,l<1&&a<1)?r:this.binarySearch(t,e,i)}static findLast(e,t,i){for(let{length:r}=e,n=r-1;n>=0;n--)if(t.call(i,e[n],n,e))return e[n]}static binarySearch(e,t,i=0,r=e.length,n=this.lexicalCompare){const l=e.length;let a,o;for(i instanceof Function?(n=i,i=0):r instanceof Function&&(n=r,r=l),--r;i<=r;)a=i+r>>1,o=n(t,e[a]),o>=0?i=a+1:o<0&&(r=a-1);return i}magnitudeCompare(e,t){return e<t?-1:e>t?1:0}lexicalCompare(e,t){return e=String(e),t=String(t),e<t?-1:e>t?1:0}static fill(e,t={},i=null){const r=[],n=Array.isArray(t)?t:[t];for(let l=0;l<e;l++)for(const a of n){const o=Object.assign({},a);i&&i(o,l),r.push(o)}return r}static populate(e,t,i=!1){const r=[];for(let n=0;n<e;n++)r.push(t(n+(i?1:0)));return r}static include(e,...t){for(const i of t)e.includes(i)||e.push(i)}static unique(e){return[...new Set(e)]}static allowNegative(e){return new Proxy(e,{get(t,i,r){if(typeof i!="string")return Reflect.get(t,i,r);const n=Number(i);return Number.isNaN(n)?Reflect.get(t,i,r):t[n<0?t.length+n:n]},set(t,i,r,n){if(typeof i!="string")return Reflect.set(t,i,r,n);const l=Number(i);return Number.isNaN(l)?Reflect.set(t,i,r,n):(t[l<0?t.length+l:l]=r,!0)}})}static delta(e,t,i=!1){if(!t)return i?{toAdd:e,toRemove:[],toKeep:[]}:{onlyInA:e,onlyInB:[],inBoth:[]};const r=[],n=[],l=new Set,a=new Set(t);for(let o=0;o<e.length;o++){const u=e[o];a.has(u)?l.add(u):r.push(u)}for(let o=0;o<t.length;o++){const u=t[o];l.has(u)||n.push(u)}return i?{toAdd:r,toRemove:n,toKeep:l}:{onlyInA:r,onlyInB:n,inBoth:[...l]}}static asArray(e){return e==null?e:e instanceof Set?Array.from(e):Array.isArray(e)?e:[e]}static identity(e){return e}static keyBy(e,t,i=Ha.identity){const r=typeof t=="string"?l=>l==null?void 0:l[t]:t,n=typeof i=="string"?l=>l==null?void 0:l[i]:i;return e.reduce((l,a)=>(l[r(a)]=n(a),l),{})}static aggregate(e,t,i,r,n={}){const l=e.length,a=e[0].length,o=[];n.targetArray=o,n.arrays=e;for(let u=0;u<a;u++)n.entryIndex=u,o.push(r(u,n));for(let u=0;u<l;u++){const c=e[u];n.rowIndex=u;for(let d=0;d<a;d++){n.entryIndex=d;const f=t(c[d],n);o[d]=i(o[d],f,u,d,n)}}return o}static groupBy(e,t){const i=typeof t=="string"?r=>r==null?void 0:r[t]:t;return e.reduce((r,n)=>{const l=i(n);return(r[l]=r[l]||[]).push(n),r},{})}};V._$name="ArrayHelper";var bn=/,\s*/,Or=Symbol("decompiled"),xo=/^\s*(async\s+)?([a-z_]\w*)\s*=>([\s\S]+)$/i,Do=/^\s*(async\s*)?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)\s+=>([\s\S]+)$/i,_o=/^(\s*async)?(?:\s*function)?(?:\s*([a-z_]\w*))?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)([\s\S]+)$/i,{hasOwnProperty:Mo}=Object.prototype,re=class js{static after(e,t,i,r,n){const l=typeof i=="string",a=(n==null?void 0:n.return)!==!1,o=(...u)=>{const c=o.$nextHook.call(e,...u),d=r!=null&&r.isDestroyed?void 0:a?l?r[i](c,...u):i.call(r,c,...u):l?r[i](...u):i.call(r,...u);return d===void 0?c:d};return js.hookMethod(e,t,o)}static before(e,t,i,r){const n=typeof i=="string",l=(...a)=>{const o=r!=null&&r.isDestroyed?0:n?r[i](...a):i.call(r,...a);return o===!1?o:l.$nextHook.call(e,...a)};return js.hookMethod(e,t,l)}static curry(e){return function t(...i){return i.length>=e.length?e.apply(this,i):function(...r){return t.apply(this,i.concat(r))}}}static bindAll(e){for(const t in e)typeof e[t]=="function"&&(e[t]=e[t].bind(e))}static createInterceptor(e,t,i){return function(...r){const n=i||this;return t.call(n,...r)!==!1?e.call(n,...r):!1}}static createSequence(e,t,i){return(...r)=>{const n=e.call(i,...r),l=t.call(i,...r);return l===void 0?n:l}}static createThrottled(e,t,i,r,n){let l=-Number.MAX_VALUE,a,o;const u=()=>{o=0,l=performance.now(),a.push.apply(a,r),e.apply(i,a)},c=function(...d){const f=performance.now()-l;a=d,f>=t?(clearTimeout(o),u()):(o||(o=setTimeout(u,t-f)),n&&(a.push.apply(a,r),n.apply(i,a)))};return c.cancel=()=>clearTimeout(o),c}static createBuffered(e,t,i,r){let n,l;const a=()=>{l=0,o.isPending=!1,n.push.apply(n,r),e.apply(i,n)},o=function(...u){n=u,l&&clearTimeout(l),o.isPending=!0,l=setTimeout(a,t)};return o.cancel=()=>{o.isPending=!1,clearTimeout(l)},o}static decompile(e){if(!(Or in e)){const t=e.toString();let i=xo.exec(t),r,n,l,a,o;i?(r=[i[2]],n=i[3]):(i=Do.exec(t))?(o=i[2].trim(),r=o?o.split(bn):[],n=i[3]):(i=_o.exec(t))&&(l=i[2],o=i[3].trim(),r=o?o.split(bn):[],n=i[4]),n=n==null?void 0:n.trim(),e[Or]=a=i&&{args:r,async:!!i[1],body:n!=null&&n.startsWith("{")?n.substring(1,n.length-1).trim():n},l&&(a.name=l)}return e[Or]}static hookMethod(e,t,i){return i.$nextHook=e[t],e[t]=i,()=>{var r;if(Mo.call(e,t)){let n=e[t],l;if(n===i)((r=Object.getPrototypeOf(e))==null?void 0:r[t])===i.$nextHook?delete e[t]:e[t]=i.$nextHook;else for(;l=n==null?void 0:n.$nextHook;n=l)if(l===i){n.$nextHook=i.$nextHook;break}}}}static noThrow(e,t,i){const r=e[t];e[t]=(...n)=>{try{return r.apply(e,n)}catch(l){return i==null?void 0:i(l)}}}static returnTrue(){return!0}static animate(e,t,i,r="linear"){let n=!1;const l=new Promise(a=>{const o=performance.now(),u=()=>{const c=Math.min((performance.now()-o)/e,1),d=i&&i.setTimeout?i:globalThis;n||t.call(i,this.easingFunctions[r](c))===!1&&a(),n||c===1?d.requestAnimationFrame(()=>a()):d.requestAnimationFrame(u)};u()});return l.cancel=()=>(n=!0,l.cancelled=!0,!1),l}},Q=.5,Qe=1.70158,xe=7.5625,ji=1.525,Fr=2/2.75,Lr=2.25/2.75,kr=1/2.75,Ar=1.5/2.75,Pr=2.5/2.75,Rr=2.625/2.75,$r=.75,Nr=.9375,Vr=.984375,Io=1.70158,Oo=1.70158;re.easingFunctions={linear:s=>s,easeInQuad:s=>Math.pow(s,2),easeOutQuad:s=>-(Math.pow(s-1,2)-1),easeInOutQuad:s=>(s/=Q)<1?Q*Math.pow(s,2):-Q*((s-=2)*s-2),easeInCubic:s=>Math.pow(s,3),easeOutCubic:s=>Math.pow(s-1,3)+1,easeInOutCubic:s=>(s/=Q)<1?Q*Math.pow(s,3):Q*(Math.pow(s-2,3)+2),easeInQuart:s=>Math.pow(s,4),easeOutQuart:s=>-(Math.pow(s-1,4)-1),easeInOutQuart:s=>(s/=Q)<1?Q*Math.pow(s,4):-Q*((s-=2)*Math.pow(s,3)-2),easeInQuint:s=>Math.pow(s,5),easeOutQuint:s=>Math.pow(s-1,5)+1,easeInOutQuint:s=>(s/=Q)<1?Q*Math.pow(s,5):Q*(Math.pow(s-2,5)+2),easeInSine:s=>-Math.cos(s*(Math.PI/2))+1,easeOutSine:s=>Math.sin(s*(Math.PI/2)),easeInOutSine:s=>-Q*(Math.cos(Math.PI*s)-1),easeInExpo:s=>s===0?0:Math.pow(2,10*(s-1)),easeOutExpo:s=>s===1?1:-Math.pow(2,-10*s)+1,easeInOutExpo:s=>s===0?0:s===1?1:(s/=Q)<1?Q*Math.pow(2,10*(s-1)):Q*(-Math.pow(2,-10*--s)+2),easeInCirc:s=>-(Math.sqrt(1-s*s)-1),easeOutCirc:s=>Math.sqrt(1-Math.pow(s-1,2)),easeInOutCirc:s=>(s/=Q)<1?-Q*(Math.sqrt(1-s*s)-1):Q*(Math.sqrt(1-(s-=2)*s)+1),easeOutBounce:s=>s<kr?xe*s*s:s<Fr?xe*(s-=Ar)*s+$r:s<Pr?xe*(s-=Lr)*s+Nr:xe*(s-=Rr)*s+Vr,easeInBack:s=>s*s*((Qe+1)*s-Qe),easeOutBack:s=>(s=s-1)*s*((Qe+1)*s+Qe)+1,easeInOutBack:s=>{let e=Io;return(s/=Q)<1?Q*(s*s*(((e*=ji)+1)*s-e)):Q*((s-=2)*s*(((e*=ji)+1)*s+e)+2)},elastic:s=>-1*Math.pow(4,-8*s)*Math.sin((s*6-1)*(2*Math.PI)/2)+1,swingFromTo:s=>{let e=Oo;return(s/=Q)<1?Q*(s*s*(((e*=ji)+1)*s-e)):Q*((s-=2)*s*(((e*=ji)+1)*s+e)+2)},swingFrom:s=>s*s*((Qe+1)*s-Qe),swingTo:s=>(s-=1)*s*((Qe+1)*s+Qe)+1,bounce:s=>s<kr?xe*s*s:s<Fr?xe*(s-=Ar)*s+$r:s<Pr?xe*(s-=Lr)*s+Nr:xe*(s-=Rr)*s+Vr,bouncePast:s=>s<kr?xe*s*s:s<Fr?2-(xe*(s-=Ar)*s+$r):s<Pr?2-(xe*(s-=Lr)*s+Nr):2-(xe*(s-=Rr)*s+Vr),easeFromTo:s=>(s/=Q)<1?Q*Math.pow(s,4):-Q*((s-=2)*Math.pow(s,3)-2),easeFrom:s=>Math.pow(s,4),easeTo:s=>Math.pow(s,.25)},re._$name="FunctionHelper";var{isArray:Cn}=Array,{hasOwnProperty:Fo}=Object.prototype,wn={thisObj:1,detachable:1,once:1,detacher:1,prio:1,args:1,expires:1,buffer:1,throttle:1,name:1,$internal:1},Sn=(s,e)=>e.prio-s.prio,De=s=>class Hs extends(s||R){constructor(){super(...arguments),x(this,"eventsSuspended",null)}static get $name(){return"Events"}static get declarable(){return["deprecatedEvents"]}static setupDeprecatedEvents(t,i){const r=i.getInherited("deprecatedEvents"),n=t.deprecatedEvents;for(const l in n)r[l.toLowerCase()]=r[l]=n[l]}static get configurable(){return{listeners:{value:null,$config:{merge(t,i){if(t!==null){if(!t)return i;i&&(t=t?[t]:[],t.push[Cn(i)?"apply":"call"](t,i))}return t}}},internalListeners:null,bubbleEvents:null}}destroy(){this.trigger("beforeDestroy"),super.destroy()}construct(t,...i){(this.configuredListeners=t==null?void 0:t.listeners)&&(t=$.assign({},t),delete t.listeners),super.construct(t,...i),this.processConfiguredListeners()}processConfiguredListeners(){if(this.configuredListeners){const t=this,{isConfiguring:i}=t;t.isConfiguring=!1,t.listeners=t.configuredListeners,t.configuredListeners=null,t.isConfiguring=i}}doDestroy(){this.trigger("destroy"),this.removeAllListeners(!1),super.doDestroy()}static setupClass(t){super.setupClass(t),Hs.prototype.onListen.$nullFn=!0,Hs.prototype.onUnlisten.$nullFn=!0}addListener(t,i,r){var n;if(Cn(t)){for(let o=0,{length:u}=t;o<u;o++)this.addListener(t[o],i);return}const l=this,a=l.$meta.getInherited("deprecatedEvents");if(typeof t=="string")return l.addListener({[t]:i,detachable:i.detachable!==!1,thisObj:r});{i=t.thisObj=t.thisObj!==void 0?t.thisObj:i;for(const d in t)if(!wn[d]&&t[d]!=null){const f=d.toLowerCase(),g=a==null?void 0:a[f],h=l.eventListeners||(l.eventListeners={}),p=V.asArray(t[d]);if(g){const{product:m,invalidAsOfVersion:y,message:b}=g;le.deprecate(m,y,b)}for(const m of p){const y=m.expires||t.expires,b={fn:typeof m=="object"?m.fn:m,thisObj:m.thisObj!==void 0?m.thisObj:i,args:m.args||t.args,prio:m.prio!==void 0?m.prio:t.prio!==void 0?t.prio:0,once:m.once!==void 0?m.once:t.once!==void 0?t.once:!1,buffer:m.buffer||t.buffer,throttle:m.throttle||t.throttle,$internal:t.$internal,catchAll:d==="catchAll"};if(y){const{alt:C}=y,T=C?y.delay:y,_=t.name||d,L=()=>{l.un(f,b),C&&!b.called&&l.callback(C,i)};l.isDelayable?l.setTimeout({fn:L,name:_,cancelOutstanding:!0,delay:T}):globalThis.setTimeout(L,T)}let S=h[f]||(h[f]=[]);S.$firing&&(h[f]=S=S.slice()),S.splice(V.findInsertionIndex(b,S,Sn,S.length),0,b),!l.onListen.$nullFn&&S.length<2&&l.onListen(f),(n=l.afterAddListener)==null||n.call(l,f,b)}}t.relayAll&&l.relayAll(t.relayAll),i&&i!==l&&l.attachAutoDetacher(t,i);const o=t.detachable!==!1,u=t.name,c=t.expires||o||u?()=>{l.isDestroyed||l.removeListener(t,i)}:null;if(c&&(c.eventer=l,c.listenerName=u,u&&(i!=null&&i.trackDetacher)&&i.trackDetacher(u,c),t.expires&&l.delay(c,isNaN(t.expires)?t.expires.delay:t.expires,u),o))return c}}on(t,i,r){return this.addListener(t,i,r)}ion(t){return t.$internal=!0,this.on(t)}un(...t){this.removeListener(...t)}updateInternalListeners(t,i){i==null||i.detach(),t&&(t.detach=this.ion(t))}get listeners(){return this.eventListeners}changeListeners(t){if(this.isConfiguring)this.getConfig("internalListeners"),t&&this.on(t,this);else{if(Array.isArray(t))for(let i=0,r=t[0],{length:n}=t;i<n;r=t[++i])"thisObj"in r||(t[i]=$.assign({thisObj:this},r));else t&&!("thisObj"in t)&&(t=$.assign({thisObj:this},t));return t}}updateListeners(t,i){i&&this.un(i),t&&this.on(t)}removeListener(t,i=t.thisObj,r){const n=this;if(typeof t=="string")return n.removeListener({[t]:i},r);Object.entries(t).forEach(([l,a])=>{var o;if(!wn[l]&&a!=null){l=l.toLowerCase();const{eventListeners:u}=n,c=n.findListener(l,a,i);if(c>=0){let d=u[l];(o=n.afterRemoveListener)==null||o.call(n,l,d[c]),d.length>1?(d.$firing&&(u[l]=d=d.slice()),d.splice(c,1)):(delete u[l],n.onUnlisten.$nullFn||n.onUnlisten(l))}}}),t.thisObj&&!t.thisObj.isDestroyed&&n.detachAutoDetacher(t)}findListener(t,i,r){var n;const l=(n=this.eventListeners)==null?void 0:n[t],a=i.fn||i,o=i.thisObj||r;if(l){for(let u,c=0,{length:d}=l;c<d;c++)if(u=l[c],u.fn===a&&u.thisObj===o)return c}return-1}hasListener(t){var i;return!!((i=this.eventListeners)!=null&&i[t==null?void 0:t.toLowerCase()])}relayAll(t,i,r=!0){this.relayAllTargets||(this.relayAllTargets=[]);const{relayAllTargets:n}=this;t.ion({beforeDestroy:({source:l})=>{l===t&&n.filter(o=>o.through===t).forEach(o=>V.remove(n,o))}}),n.push({through:t,prefix:i,transformCase:r})}removeAllListeners(t=!0){var i;const r=this.eventListeners;let n,l;for(const a in r){const o=r[a];for(n=o.length;n-- >0;){const u=o[n];(!u.$internal||!t)&&(this.removeListener(a,u),l=u.thisObj,(i=l==null?void 0:l.untrackDetachers)==null||i.call(l,this))}}}relayEvents(t,i,r=""){const n={detachable:!0,thisObj:this};return i.forEach(l=>{n[l]=(a,...o)=>this.trigger(r+l,a,...o)}),t.on(n)}onListen(){}onUnlisten(){}destructorInterceptor(){const{autoDetachers:t,target:i,oldDestructor:r}=this;for(let n=0;n<t.length;n++){const{dispatcher:l,config:a}=t[n];l.isDestroyed||l.removeListener(a,i)}r.call(i)}attachAutoDetacher(t,i){const r=t.thisObj||i,n="doDestroy"in r?"doDestroy":"destroy";if(n in r){let{$autoDetachers:l}=r;l||(r.$autoDetachers=l=[]),r.$oldDestructor||(r.$oldDestructor=r[n],r[n]=this.destructorInterceptor.bind({autoDetachers:l,oldDestructor:r.$oldDestructor,target:r})),l.push({config:t,dispatcher:this})}else r[n]=()=>{this.removeListener(t)}}detachAutoDetacher(t){const i=t.thisObj;i.$oldDestructor&&!i.isDestroying&&(V.remove(i.$autoDetachers,i.$autoDetachers.find(r=>r.config===t&&r.dispatcher===this)),i.$autoDetachers.length||(i["doDestroy"in i?"doDestroy":"destroy"]=i.$oldDestructor,i.$oldDestructor=null))}once(t,i){return this.on({[t]:()=>this.callback(i),once:!0})}await(t,i={checkLog:!0,resetLog:!0,args:null}){const r=this;i===!1&&(i={checkLog:!1});const{args:n}=i;return new Promise(l=>{var a;if(i.checkLog&&((a=r._triggered)!=null&&a[t])&&(l(),i.resetLog&&r.clearLog(t)),n){const o=r.on({[t]:(...u)=>{(typeof n=="function"?n(...u):Object.keys(n).every(d=>d in u[0]&&u[0][d]===n[d]))&&(l(...u),i.resetLog&&r.clearLog(t),o())},prio:-1e4})}else r.on({[t]:(...o)=>{l(...o),i.resetLog&&r.clearLog(t)},prio:-1e4,once:!0})})}clearLog(t){this._triggered&&(t?delete this._triggered[t]:this._triggered={})}trigger(t,i){var r,n,l,a;const o=this,u=t.toLowerCase(),{eventsSuspended:c,relayAllTargets:d,callOnFunctions:f}=o;let g=(r=o.eventListeners)==null?void 0:r[u],h;if(o._triggered||(o._triggered={}),o._triggered[t]=!0,c)return c.shouldQueue&&c.queue.push(arguments),!0;if((n=o.eventListeners)!=null&&n.catchall&&((g=g?g.slice():[]).push(...o.eventListeners.catchall),g.sort(Sn)),!g&&!d&&!f)return!0;if(i?"source"in i||(Object.isExtensible(i)?i.source=o:i=Object.setPrototypeOf({source:o},i)):i={source:o},i.type!==u&&(i.constructor!==Object?Reflect.defineProperty(i,"type",{get:()=>u}):i.type=u),i.eventName=t,!("bubbles"in i)&&((l=o.bubbleEvents)!=null&&l[t])&&(i.bubbles=o.bubbleEvents[t]),f){const m="on"+k.capitalize(t);if(m in o){const y=o[m]?o.callback(o[m],o,[i]):!0;let b;if($.isPromise(y)?(h||(h=[])).push(y):b=y===!1||b,!o.isDestroyed&&Fo.call(o,m)&&!((a=o.pluginFunctionChain)!=null&&a[m])){const S=Object.getPrototypeOf(o);if(m in S){const C=S[m].call(o,i);if($.isPromise(C)?(h||(h=[])).push(C):b=C===!1||b,o.isDestroyed)return}}if(b)return!1}}let p;if(g){let m=0,y=!1;for(g.$firing=!0,m;m<g.length&&!o.isDestroyed&&!y;m++){const b=g[m];if(p===!1&&!b.$internal)continue;let S,C=b.thisObj;if(!C||!C.isDestroyed){if(b.called=!0,b.once&&o.removeListener(u,b),typeof b.fn=="string"){if(C&&(S=C[b.fn]),!S){const _=o.resolveCallback(b.fn);S=_.handler,C=_.thisObj}}else S=b.fn;if(b.buffer){if(!b.bufferFn){const _=Number(b.buffer);if(typeof _!="number"||isNaN(_))throw new Error(`Incorrect type for buffer, got "${_}" (expected a Number)`);b.bufferFn=re.createBuffered(S,_,C,b.args)}S=b.bufferFn}if(b.throttle){const _=Number(b.throttle);if(typeof _!="number"||isNaN(_))throw new Error(`Incorrect type for throttle, got "${_}" (expected a Number)`);b.throttledFn||(b.throttledFn=re.createThrottled(S,_,C,b.args)),S=b.throttledFn}const T=S.call(C||o,...b.args||[],i);p!==!1&&(p=T),b.$internal&&T===!1&&(y=!0),$.isPromise(T)&&(T.$internal=b.$internal,(h||(h=[])).push(T))}}if(g.$firing=!1,y)return!1}return d==null||d.forEach(m=>{let y=t;if(m.transformCase&&(y=k.capitalize(y)),m.prefix&&(y=m.prefix+y),m.through.trigger(y,i)===!1)return!1}),i.bubbles&&o.owner&&!o.owner.isDestroyed?o.owner.trigger(t,i):(h=h==null?void 0:h.filter(m=>p!==!1||m.$internal),h!=null&&h.length?new Promise(m=>{Promise.all(h).then(y=>{const b=!y.some(S=>S===!1);m(b)})}):p!==!1)}suspendEvents(t=!1){const i=this.eventsSuspended||(this.eventsSuspended={shouldQueue:t,queue:[],count:0});i.count++}resumeEvents(){const t=this.eventsSuspended;if(t&&--t.count===0&&(this.eventsSuspended=null,t.shouldQueue))for(const i of t.queue)this.trigger(...i);return!this.eventsSuspended}},zr=class{static animationFrame(){return new Promise(s=>{requestAnimationFrame(s)})}static sleep(s){return new Promise(e=>{setTimeout(()=>{e()},s)})}static yield(){return Promise.resolve()}};zr._$name="AsyncHelper";var Lo=/^(\w+)=(.*)$/,ko=function(s){const e={},t=s.split("&");for(const i of t){const[r,n,l]=Lo.exec(i),a=decodeURIComponent(n),o=decodeURIComponent(l);if(r){let u=e[a];u?(Array.isArray(u)||(u=e[a]=[u]),u.push(o)):e[a]=o}}return e},En=class Lt{static get(e,t){return this.fetch(e,t)}static post(e,t,i={}){return!(t instanceof FormData)&&typeof t!="string"&&(t=JSON.stringify(t),i.headers=i.headers||{},i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json"),this.fetch(e,Object.assign({method:"POST",body:t},i))}static fetch(e,t){let i;if(t=$.merge({},Lt.DEFAULT_FETCH_OPTIONS,t),typeof AbortController!="undefined"&&(i=t.abortController=new AbortController,t.signal=i.signal),"credentials"in t||(t.credentials="include"),t.queryParams){const n=Object.entries(t.queryParams);if(n.length){let l=!1;if(t.headers&&t.addQueryParamsToBody===!0){const a=new Headers(t.headers).get("Content-Type");let o;switch(a){case"application/x-www-form-urlencoded":o=URLSearchParams;break;case"multipart/form-data":o=FormData;break}if(o){const u=t.body||(t.body=new o);u instanceof o&&(n.forEach(([c,d])=>u.set(c,d)),l=!0)}}l||(e+=(e.includes("?")?"&":"?")+n.map(([a,o])=>`${a}=${encodeURIComponent(o)}`).join("&"))}}const r=new Promise((n,l)=>{fetch(e,t).then(a=>{t.parseJson?a.json().then(o=>{a.parsedJson=o,n(a)}).catch(o=>{a.parsedJson=null,a.error=o,l(a)}):n(a)}).catch(a=>{a.stack=r.stack,l(a)})});return r.stack=new Error().stack,r.abort=function(){i==null||i.abort()},r}static mockUrl(e,t){const i=this;(i.mockAjaxMap||(i.mockAjaxMap={}))[e]=t,Lt.originalFetch||(Lt.originalFetch=Lt.fetch,Lt.fetch=i.mockAjaxFetch.bind(i))}static async mockAjaxFetch(e,t){const i=e.split("?");let r=this.mockAjaxMap[i[0]],n=null;if(r){typeof r=="function"&&(r=await r(i[0],i[1]&&ko(i[1]),t));try{n=(t==null?void 0:t.parseJson)&&JSON.parse(r.responseText)}catch(l){n=null,r.error=l}return r=Object.assign({status:200,ok:!0,headers:new Headers,statusText:"OK",url:e,parsedJson:n,text:()=>new Promise(l=>{l(r.responseText)}),json:()=>new Promise(l=>{l(n)})},r),new Promise(function(l,a){r.synchronous?l(r):setTimeout(function(){l(r)},"delay"in r?r.delay:100)})}else return Lt.originalFetch(e,t)}};x(En,"DEFAULT_FETCH_OPTIONS",{});var ht=En;ht._$name="AjaxHelper";var je=typeof self!="undefined"?self:typeof globalThis!="undefined"?globalThis:null,Tn=class Pi{static mergeLocales(...e){const t={};return e.forEach(i=>{Object.keys(i).forEach(r=>{typeof i[r]=="object"?t[r]={...t[r],...i[r]}:t[r]=i[r]})}),t}static trimLocale(e,t){const i=(r,n)=>{e[r]&&(n?e[r][n]&&delete e[r][n]:delete e[r])};Object.keys(t).forEach(r=>{Object.keys(t[r]).length>0?Object.keys(t[r]).forEach(n=>i(r,n)):i(r)})}static normalizeLocale(e,t){if(!e)throw new Error('"nameOrConfig" parameter can not be empty');if(typeof e=="string"){if(!t)throw new Error('"config" parameter can not be empty');t.locale?t.name=e||t.name:t.localeName=e}else t=e;let i={};if(t.name||t.locale)i=Object.assign({localeName:t.name},t.locale),t.desc&&(i.localeDesc=t.desc),t.code&&(i.localeCode=t.code),t.path&&(i.localePath=t.path);else{if(!t.localeName)throw new Error(`"config" parameter doesn't have "localeName" property`);i=Object.assign({},t)}for(const r of["name","desc","code","path"])i[r]&&delete i[r];if(!i.localeName)throw new Error("Locale name can not be empty");return i}static get locales(){return je.bryntum.locales||{}}static set locales(e){je.bryntum.locales=e}static get localeName(){return je.bryntum.locale||"En"}static set localeName(e){je.bryntum.locale=e||Pi.localeName}static get locale(){return Pi.localeName&&this.locales[Pi.localeName]||this.locales.En||Object.values(this.locales)[0]||{localeName:"",localeDesc:"",localeCoode:""}}static publishLocale(e,t){const{locales:i}=je.bryntum,r=Pi.normalizeLocale(e,t),{localeName:n}=r;return!i[n]||t===!0?i[n]=r:i[n]=this.mergeLocales(i[n]||{},r||{}),i[n]}};x(Tn,"skipLocaleIntegrityCheck",!1);var _e=Tn;je.bryntum=je.bryntum||{},je.bryntum.locales=je.bryntum.locales||{},_e._$name="LocaleHelper";var Ao=class extends De(R){static get defaultConfig(){return{throwOnMissingLocale:le.isTestEnv}}construct(...s){var e;const t=this;if(super.construct(...s),j.isBrowserEnv){const i=document.querySelector("script[data-default-locale]");i?t.applyLocale(i.dataset.defaultLocale):(e=t.locale)!=null&&e.localeName&&t.applyLocale(t.locale.localeName)}}get locales(){return _e.locales}set locales(s){_e.locales=s}set locale(s){this.applyLocale(s)}get locale(){return _e.locale}registerLocale(s,e){le.deprecate("Core","6.0.0","LocaleManager.registerLocale deprecated, use LocaleHelper.publishLocale instead"),_e.publishLocale(s,e)}extendLocale(s,e){le.deprecate("Core","6.0.0","LocaleManager.extendLocale deprecated, use LocaleManager.applyLocale instead");const t=_e.publishLocale(s,e);return this.applyLocale(t,!0)}applyLocale(s,e,t=!1){const i=this;let r;if(typeof s=="string")if(typeof e!="object"){if(r=i.locales[s],!r){if(t)return!0;throw new Error(`Locale "${s}" is not published. Publish with LocaleHelper.publishLocale() before applying.`)}}else r=_e.publishLocale(s,e);else r=_e.publishLocale(s);if(i.locale.localeName&&i.locale.localeName===r.localeName&&e!==!0)return i.locale;_e.localeName=r.localeName;const n=()=>{i.trigger("locale",r)};return r.localePath?new Promise((l,a)=>{i.loadLocale(r.localePath).then(o=>{o.text().then(u=>{new Function(u)(),j.isBrowserEnv&&(r=i.locales[r.localeName],r&&delete r.localePath),n(),l(r)})}).catch(o=>a(o))}):(n(),r)}loadLocale(s){return ht.get(s)}set throwOnMissingLocale(s){this._throwOnMissingLocale=s}get throwOnMissingLocale(){return this._throwOnMissingLocale}},Po=new Ao,ge=Po,Ro=Object.getPrototypeOf(Object),xn=/L{.*?}/g,Dn=/L{(.*?)}/g,_n=/((.*?)\.)?(.+)/g,$o=s=>s.replace(/{(\d+)}/gm,"[[$1]]"),Mn=s=>s.replace(/\[\[(\d+)]]/gm,"{$1}"),No=Object.freeze(Object.create(null)),ti=s=>class Ve extends(s||R){static get $name(){return"Localizable"}static get configurable(){return{localeClass:null,localizable:null,localizableProperties:{value:[],$config:{merge:"distinct"}}}}static clsName(t){var i,r;return typeof t=="string"?t:t===Ro?"Object":t.$$name||t.name||((i=t.prototype)==null?void 0:i.$$name)||((r=t.prototype)==null?void 0:r.name)}static parseLocaleString(t){const i=[];let r;if(t!=null&&t.includes("L{"))for(t=$o(t),Dn.lastIndex=0;(r=Dn.exec(t))!=null;){_n.lastIndex=0;const n=_n.exec(r[1]);i.push({match:Mn(r[0]),localeKey:Mn(n[3]),localeClass:n[2]})}return i.length>0?i:[{match:t,localeKey:t,localeClass:void 0}]}construct(t={},...i){super.construct(t,...i),ge.ion({locale:"updateLocalization",thisObj:this}),this.updateLocalization()}get localeClass(){return this._localeClass||null}localizeProperty(t){var i,r,n;const l=this,a=$.getPath(l,t),o=((i=l.$meta.configs[t])==null?void 0:i.localeKey)||((n=(r=l.fieldMap)==null?void 0:r[t])==null?void 0:n.defaultValue);let u;return o?(u=Ve.localize(o,l,l.localeClass||l),u&&!(t in(l.initialConfig||No))&&$.setPath(l.isColumn?l.data:l,t,u)):typeof a=="string"&&(l.originalLocales=l.originalLocales||{},u=$.getPath(l.originalLocales,t),u===void 0&&($.setPath(l.originalLocales,t,a),u=a),u&&$.setPath(l,t,u=l.optionalL(u,l))),u||a}updateLocalization(){var t,i;this.localizable!==!1&&((t=this.localizableProperties)==null||t.forEach(this.localizeProperty,this),(i=this.trigger)==null||i.call(this,"localized"))}static getTranslation(t,i,r){const n=ge.locale;let l=null,a,o;if(n)for(const{match:u,localeKey:c,localeClass:d}of this.parseLocaleString(t)){const f=h=>{var p;const m=(p=n[h])==null?void 0:p[c];return m&&(typeof m=="function"?l=i!=null?m(i):m:typeof m=="object"||t===u?l=m:l=(l||t).replace(u,m),typeof m=="string"&&m.includes("L{")&&(l=this.getTranslation(m,i,r))),m};let g=!1;for(o=r;o&&(a=Ve.clsName(o))&&!(g=f(a));o=Object.getPrototypeOf(o))if(typeof o=="string")break;!g&&d&&f(d)}return l}static localize(t,i=void 0,...r){(r==null?void 0:r.length)===0&&(r=[this]);let n=null;return r.some(l=>(n=Ve.getTranslation(t,i,l),n!=null)),n}static L(t,i=void 0,...r){(r==null?void 0:r.length)===0&&(r=[this]);const n=this.localize(t,i,...r);if(n==null&&ge.throwOnMissingLocale&&t.includes("L{"))throw new Error(`Localization is not found for '${t}' in '${r.map(l=>Ve.clsName(l)).join(", ")}'. ${ge.locale.localeName?`Locale : ${ge.locale.localeName}`:""}`);return n!=null?n:t}L(t,i){const{localeClass:r,constructor:n}=this;return r&&Ve.clsName(r)!==Ve.clsName(n)?Ve.L(t,i,r,n):Ve.L(t,i,n)}static optionalL(t,i=void 0,...r){const n=ge.throwOnMissingLocale;ge.throwOnMissingLocale=n&&xn.test(t),(r==null?void 0:r.length)===0&&(r=[this]);const l=Ve.L(t,i,...r);return ge.throwOnMissingLocale=n,l}optionalL(t,i=this,r=!1){const n=ge.throwOnMissingLocale;ge.throwOnMissingLocale=n&&xn.test(t)&&!r;const l=this.L(t,i);return ge.throwOnMissingLocale=n,l}get localeManager(){return ge}get localeHelper(){return _e}},Vo={localeName:"En",localeDesc:"English (US)",localeCode:"en-US",Object:{Yes:"Yes",No:"No",Cancel:"Cancel",Ok:"OK",Week:"Week",None:"None"},ColorPicker:{noColor:"No color"},Combo:{noResults:"No results",recordNotCommitted:"Record could not be added",addNewValue:s=>`Add ${s}`},FilePicker:{file:"File"},Field:{badInput:"Invalid field value",patternMismatch:"Value should match a specific pattern",rangeOverflow:s=>`Value must be less than or equal to ${s.max}`,rangeUnderflow:s=>`Value must be greater than or equal to ${s.min}`,stepMismatch:"Value should fit the step",tooLong:"Value should be shorter",tooShort:"Value should be longer",typeMismatch:"Value is required to be in a special format",valueMissing:"This field is required",invalidValue:"Invalid field value",minimumValueViolation:"Minimum value violation",maximumValueViolation:"Maximum value violation",fieldRequired:"This field is required",validateFilter:"Value must be selected from the list"},DateField:{invalidDate:"Invalid date input"},DatePicker:{gotoPrevYear:"Go to previous year",gotoPrevMonth:"Go to previous month",gotoNextMonth:"Go to next month",gotoNextYear:"Go to next year"},NumberFormat:{locale:"en-US",currency:"USD"},DurationField:{invalidUnit:"Invalid unit"},TimeField:{invalidTime:"Invalid time input"},TimePicker:{hour:"Hour",minute:"Minute",second:"Second"},List:{loading:"Loading...",selectAll:"Select All"},GridBase:{loadMask:"Loading...",syncMask:"Saving changes, please wait..."},PagingToolbar:{firstPage:"Go to first page",prevPage:"Go to previous page",page:"Page",nextPage:"Go to next page",lastPage:"Go to last page",reload:"Reload current page",noRecords:"No records to display",pageCountTemplate:s=>`of ${s.lastPage}`,summaryTemplate:s=>`Displaying records ${s.start} - ${s.end} of ${s.allCount}`},PanelCollapser:{Collapse:"Collapse",Expand:"Expand"},Popup:{close:"Close"},UndoRedo:{Undo:"Undo",Redo:"Redo",UndoLastAction:"Undo last action",RedoLastAction:"Redo last undone action",NoActions:"No items in the undo queue"},FieldFilterPicker:{equals:"equals",doesNotEqual:"does not equal",isEmpty:"empty",isNotEmpty:"not empty",contains:"contains",doesNotContain:"does not contain",startsWith:"starts with",endsWith:"ends with",isOneOf:"one of",isNotOneOf:"not one of",isGreaterThan:"greater than",isLessThan:"less than",isGreaterThanOrEqualTo:"greater or equals",isLessThanOrEqualTo:"less or equals",isBetween:"between",isNotBetween:"not between",isBefore:"before",isAfter:"after",isToday:"today",isTomorrow:"tomorrow",isYesterday:"yesterday",isThisWeek:"this week",isNextWeek:"next week",isLastWeek:"last week",isThisMonth:"this month",isNextMonth:"next month",isLastMonth:"last month",isThisYear:"this year",isNextYear:"next year",isLastYear:"last year",isYearToDate:"year to date",isTrue:"true",isFalse:"false",selectAProperty:"Select property",selectAnOperator:"Select operator",caseSensitive:"Case-sensitive",and:"and",dateFormat:"D/M/YY",selectValue:"Select value",selectOneOrMoreValues:"Select value(s)",enterAValue:"Enter value",enterANumber:"Enter number",selectADate:"Select date",selectATime:"Select time"},FieldFilterPickerGroup:{addFilter:"Add filter"},DateHelper:{locale:"en-US",weekStartDay:0,nonWorkingDays:{0:!0,6:!0},weekends:{0:!0,6:!0},unitNames:[{single:"millisecond",plural:"ms",abbrev:"ms"},{single:"second",plural:"seconds",abbrev:"s"},{single:"minute",plural:"minutes",abbrev:"min"},{single:"hour",plural:"hours",abbrev:"h"},{single:"day",plural:"days",abbrev:"d"},{single:"week",plural:"weeks",abbrev:"w"},{single:"month",plural:"months",abbrev:"mon"},{single:"quarter",plural:"quarters",abbrev:"q"},{single:"year",plural:"years",abbrev:"yr"},{single:"decade",plural:"decades",abbrev:"dec"}],unitAbbreviations:[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],parsers:{L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A"},ordinalSuffix:s=>{const e=["11","12","13"].find(i=>s.endsWith(i));let t="th";if(!e){const i=s[s.length-1];t={1:"st",2:"nd",3:"rd"}[i]||"th"}return s+t}}},tf=_e.publishLocale(Vo),{toString:In}=Object.prototype,zo=In.call(new Date),Hi=new Date,Br=1e3*60*60,jr=(s,e)=>isNaN(s)||s==null?e:s,Bo=/([ES]){([^}]+)}/g,On=s=>{const e=["11","12","13"].find(i=>s.endsWith(i));let t="th";if(!e){const i=s[s.length-1];t={1:"st",2:"nd",3:"rd"}[i]||"th"}return s+t},he=(s,e,t)=>(tt[s]||(tt[s]=new Intl.DateTimeFormat(et,e))).format(t),ii=(s,e,t,i=!1)=>{let r=he(s,e,t);return/am|pm/i.test(r)&&(r=r.replace(/^0/,""),i&&(r=r.replace(/:00/,""))),r},jo=(s,e)=>Math.floor((s.getTime()-e.getTime()-(s.getTimezoneOffset()-e.getTimezoneOffset())*ve.minute.millisecond)/ve.day.millisecond)+1,Fn=s=>s>=0?s:s+7,Ho=/([^\w])(S+)/gm,Wo=(s,e)=>e+"SSS",Ln=/[:.\-/\s]/,et="en-US",He=On,Wi={},ri={},tt={},Hr={},kn=s=>{const e=Wr[s];if(!e)throw new Error("Only international formats should be used here");if(ri[s]!==void 0)return ri[s];const t=new Intl.DateTimeFormat(et,e),i=t.formatToParts(new Date(2001,1,2,3,4,5,6)).map(r=>{const n=r.type,l=e[n];if(n==="literal")return r.value.replace(/,/g,"");if(n==="day")return l==="numeric"?"D":"DD";if(n==="month")return l==="short"?"MMM":l==="long"?"MMMM":l==="numeric"?"M":"MM";if(n==="year")return l==="numeric"?"YYYY":"YY"}).join("");return ri[s]=i},An=2020,Pn=0,Rn=1,Wr={l:{year:"numeric",month:"numeric",day:"numeric"},ll:{year:"numeric",month:"short",day:"numeric"}},ae={M:s=>s.getMonth()+1,Mo:s=>He(ae.M(s).toString()),MM:s=>(s.getMonth()+1).toString().padStart(2,"0"),MMM:s=>he("MMM",{month:"short"},s),MMMM:s=>he("MMMM",{month:"long"},s),Q:s=>Math.ceil((s.getMonth()+1)/3),Qo:s=>He(ae.Q(s).toString()),D:s=>s.getDate(),Do:s=>He(ae.D(s).toString()),DD:s=>s.getDate().toString().padStart(2,"0"),DDD:s=>Math.ceil((new Date(s.getFullYear(),s.getMonth(),s.getDate(),12,0,0)-new Date(s.getFullYear(),0,0,12,0,0))/ve.day.millisecond),DDDo:s=>He(ae.DDD(s).toString()),DDDD:s=>ae.DDD(s).toString().padStart(3,"0"),d:s=>s.getDay(),do:s=>He(s.getDay().toString()),d1:s=>he("d1",{weekday:"narrow"},s).substr(0,1),dd:s=>ae.ddd(s).substring(0,2),ddd:s=>he("ddd",{weekday:"short"},s),dddd:s=>he("dddd",{weekday:"long"},s),u:s=>{const e=tt.u||(tt.u=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"})),t=e.formatToParts(s);return`${t[4].value}${t[2].value}${t[0].value}Z`},uu:s=>{const e=tt.uu||(tt.uu=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),t=e.formatToParts(s);return`${t[4].value}${t[2].value}${t[0].value}T${t[6].value}${t[8].value}${t[10].value}Z`},e:s=>s.getDay(),E:s=>s.getDay()+1,W:s=>z.getWeekNumber(s)[1],Wo:s=>He(ae.W(s).toString()),WW:s=>ae.W(s).toString().padStart(2,"0"),Wp:s=>`${z.localize("L{Week}")} ${ae.W(s)}`,WWp:s=>`${z.localize("L{Week}")} ${ae.WW(s)}`,Wp0:s=>`${z.localize("L{Week}")[0]}${ae.W(s)}`,WWp0:s=>`${z.localize("L{Week}")[0]}${ae.WW(s)}`,Y:s=>s.getFullYear(),YY:s=>(s.getFullYear()%100).toString().padStart(2,"0"),YYYY:s=>s.getFullYear(),A:s=>s.getHours()<12?"AM":"PM",a:s=>s.getHours()<12?"am":"pm",H:s=>s.getHours(),HH:s=>s.getHours().toString().padStart(2,"0"),h:s=>s.getHours()%12||12,hh:s=>ae.h(s).toString().padStart(2,"0"),k:s=>s.getHours()||24,kk:s=>ae.k(s).toString().padStart(2,"0"),K:s=>ii("K",{hour:"numeric"},s),KK:s=>ii("KK",{hour:"2-digit"},s),m:s=>s.getMinutes(),mm:s=>ae.m(s).toString().padStart(2,"0"),s:s=>s.getSeconds(),ss:s=>ae.s(s).toString().padStart(2,"0"),S:s=>Math.floor(s.getMilliseconds()/100).toString(),SS:s=>Math.floor(s.getMilliseconds()/10).toString().padStart(2,"0"),SSS:s=>s.getMilliseconds().toString().padStart(3,"0"),z:s=>he("z",{timeZoneName:"short"},s),zz:s=>he("zz",{timeZoneName:"long"},s),Z:s=>E.getGMTOffset(s),LT:s=>ii("LT",{hour:"2-digit",minute:"2-digit"},s),LST:s=>ii("LST",{hour:"numeric",minute:"2-digit"},s,!0),LTS:s=>ii("LTS",{hour:"2-digit",minute:"2-digit",second:"2-digit"},s),L:s=>he("L",{year:"numeric",month:"2-digit",day:"2-digit"},s),l:s=>he("l",Wr.l,s),LL:s=>he("LL",{year:"numeric",month:"long",day:"numeric"},s),ll:s=>he("ll",Wr.ll,s),LLL:s=>he("LLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"},s),lll:s=>he("lll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},s),LLLL:s=>he("LLLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"long"},s),llll:s=>he("llll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"short"},s)},Uo=Object.keys(ae).sort((s,e)=>e.length-s.length),qo=`^(?:${Uo.join("|")})`,pe=()=>({}),Ko=s=>tu.test(s),Ur=s=>Ko(s)&&{milliseconds:parseInt(s.padEnd(3,"0").substring(0,3))},$n={YYYY:s=>{const e=parseInt(s);return{year:e>=1e3&&e<=9999?e:NaN}},Y:s=>({year:parseInt(s)}),YY:s=>{const e=parseInt(s);return{year:e+(e>1968?1900:2e3)}},M:s=>({month:parseInt(s)-1}),MM:s=>({month:parseInt(s)-1}),Mo:s=>({month:parseInt(s)-1}),MMM:s=>{const e=(s||"").toLowerCase();for(const[t,i]of Object.entries(z._monthShortNamesIndex))if(e.startsWith(t))return{month:i.value}},MMMM:s=>{const e=(s||"").toLowerCase();for(const[t,i]of Object.entries(z._monthNamesIndex))if(e.startsWith(t))return{month:i.value}},DD:s=>({date:parseInt(s)}),D:s=>({date:parseInt(s)}),Do:s=>({date:parseInt(s)}),DDD:pe,DDDo:pe,DDDD:pe,d:pe,do:pe,d1:pe,dd:pe,ddd:pe,dddd:pe,Q:pe,Qo:pe,W:pe,Wo:pe,WW:pe,e:pe,E:pe,HH:s=>({hours:parseInt(s)}),hh:s=>({hours:parseInt(s)}),mm:s=>({minutes:parseInt(s)}),H:s=>({hours:parseInt(s)}),m:s=>({minutes:parseInt(s)}),ss:s=>({seconds:parseInt(s)}),s:s=>({seconds:parseInt(s)}),S:Ur,SS:Ur,SSS:Ur,A:s=>({amPm:s.toLowerCase()}),a:s=>({amPm:s.toLowerCase()}),L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A",l:{type:"dynamic",parser:()=>kn("l")},ll:{type:"dynamic",parser:()=>kn("ll")},Z:s=>{if(!s||!zn.test(s)&&s!=="Z")return null;let e=0;if(s!=="Z"){const t=zn.exec(s);if(t){const i=t[1]==="+"?1:-1,r=parseInt(t[2])||0,n=parseInt(t[3])||0;e=i*(r*60+n)}else e=-1*new Date().getTimezoneOffset()}return{timeZone:e}}},Yo=Object.keys($n).sort((s,e)=>e.length-s.length),Nn=new RegExp(`(${Yo.join("|")})`),Go=new RegExp("^(LL|LLL|lll|LLLL|llll)$"),ve={decade:{decade:1,year:10,quarter:40,month:120,week:520,day:3652,hour:24*3652,minute:1440*3652,second:86400*3652,millisecond:864e5*3652},year:{decade:.1,year:1,quarter:4,month:12,week:52,day:365,hour:24*365,minute:1440*365,second:86400*365,millisecond:864e5*365},quarter:{decade:1/40,year:1/4,quarter:1,month:3,week:4,day:91,hour:24*91,minute:1440*91,second:86400*91,millisecond:864e5*91},month:{decade:1/120,year:1/12,quarter:1/3,month:1,week:4,day:-30,hour:-24*30,minute:-1440*30,second:-86400*30,millisecond:-864e5*30},week:{decade:-1/520,year:-1/52,quarter:-1/13,month:-1/4,day:7,hour:168,minute:10080,second:604800,millisecond:6048e5},day:{decade:-1/3652,year:-1/365,quarter:-1/91,month:-1/30,week:1/7,hour:24,minute:1440,second:86400,millisecond:864e5},hour:{decade:-1/(3652*24),year:-1/(365*24),quarter:-1/(91*24),month:-1/(30*24),week:1/168,day:1/24,minute:60,second:3600,millisecond:36e5},minute:{decade:-1/(3652*1440),year:-1/(365*1440),quarter:-1/(91*1440),month:-1/(30*1440),week:1/10080,day:1/1440,hour:1/60,second:60,millisecond:6e4},second:{decade:-1/(3652*86400),year:-1/(365*86400),quarter:-1/(91*86400),month:-1/(30*86400),week:1/604800,day:1/86400,hour:1/3600,minute:1/60,millisecond:1e3},millisecond:{decade:-1/(3652*864e5),year:-1/(365*864e5),quarter:-1/(91*864e5),month:-1/(30*864e5),week:1/6048e5,day:1/864e5,hour:1/36e5,minute:1/6e4,second:1/1e3}},Vn={ms:"millisecond",milliseconds:"millisecond",s:"second",seconds:"second",m:"minute",mi:"minute",min:"minute",minutes:"minute",h:"hour",hours:"hour",d:"day",days:"day",w:"week",weeks:"week",M:"month",mo:"month",mon:"month",months:"month",q:"quarter",quarters:"quarter",y:"year",years:"year",dec:"decade",decades:"decade"},Xo=/^\s*([-+]?\d+(?:[.,]\d*)?|[-+]?(?:[.,]\d+))\s*([^\s]+)?/i,Jo=/^\s*([-+]?\d+)(?![.,])\s*([^\s]+)?/i,Rt=["millisecond","second","minute","hour","day","week","month","quarter","year","decade"],Zo=[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],qr=["decade","year","month","week","day","hour","minute","second","millisecond"],Qo=["milliseconds","seconds","minutes","hours","date","month","year"],eu=s=>{const e=parseFloat(s);return isNaN(e)?null:e},tu=/^[0-9]+$/,zn=/([+-])(\d\d):*(\d\d)*$/,We={millisecond:0,second:1,minute:2,hour:3,day:4,week:5,month:6,quarter:7,year:8,decade:9},iu={round(s,e=1){return Math.round(s/e)*e},floor(s,e=1){return Math.floor(s/e)*e},ceil(s,e=1){return Math.ceil(s/e)*e}},Bn={},jn=class Ye extends ti(){static get $name(){return"DateHelper"}static set defaultFormat(e){E._defaultFormat=e}static get defaultFormat(){return E._defaultFormat||"YYYY-MM-DDTHH:mm:ssZ"}static set defaultParseFormat(e){this._defaultParseFormat=e}static get defaultParseFormat(){return this._defaultParseFormat||this._defaultFormat||"YYYY-MM-DDTHH:mm:ss.SSSZ"}static buildParser(e){const t=e.split(Nn),i=[];return t.length===1||Go.test(e)?[]:(t.reduce((r,n,l,a)=>{if(l!==0||n!=="")if(Nn.test(n)){const o=this.localize("L{parsers}")||{},u=o[n]||$n[n];if(n==="Z"&&l<a.length-2)throw new Error(`Invalid format ${e} TimeZone (Z) must be last token`);const c=typeof u=="function"||typeof u=="string"?u:u.parser();if(typeof c=="string"){const d=E.buildParser(c),f=d.pop();delete f.last,i.push(...d),r=f}else r.pattern=n,r.fn=c}else r.splitter=n,i.push(r),r={};else Object.prototype.hasOwnProperty.call(r,"pattern")&&i.push(r);return r},{}),i[i.length-1].last=!0,i)}static makeKey(e){if(e.length===10)return e;e.getTime&&(e=e.getTime());const t=Bn[Math.trunc(e/Br)];if(t)return t;Hi.setTime(e);const i=Hi.getMonth()+1,r=Hi.getDate();return Bn[Math.trunc(e/Br)]=`${Hi.getFullYear()}-${i<10?"0"+i:i}-${r<10?"0"+r:r}`}static parseKey(e){return E.parse(e,"YYYY-MM-DD")}static parse(e,t=E.defaultParseFormat,i=!1){if(e instanceof Date)return e;if(typeof e!="string"||!e)return null;const r={year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null};t=t.replace(Ho,Wo);let n=Hr[t],l;if(n||(n=Hr[t]=E.buildParser(t)),e.includes("\u202F")&&(e=e.replace(/\s/g," ")),n.reduce((o,u)=>{var c;if(u.last)Object.assign(r,u.fn(o));else{let d;if(u.splitter==="T"&&o.indexOf("T")===-1)d=o.indexOf(" ");else{const h=o.indexOf("+");let{splitter:p}=u;!i&&Ln.test(p)&&(p=Ln),d=u.splitter!==""?o.search(typeof p=="string"?k.escapeRegExp(p):p):((c=u.pattern)==null?void 0:c.length)||-1,h>-1&&d>h&&(d=-1)}let f,g;if(d===-1||u.pattern==="SSS"&&o.match(/^\d+Z$/)){const h=o.split(/([Z\-+])/);h.length===1?(f=o,g=""):(f=h[0],g=`${h[1]}${h[2]}`)}else f=o.substring(0,d)||o,g=o.substring(d+u.splitter.length);if(u.fn){const h=u.fn(f);h?Object.assign(r,h):g=f+g}return g}},e),r.year&&!r.date&&(r.date=1),r.date>31||r.month>12)return null;const a=E.create(r,i);return a?l=a:i||(l=new Date(e)),l}static create(e,t=!1){const i={...e};let r=isNaN(i.year)||t&&(isNaN(i.month)||isNaN(i.date)),n=!1;if(!r){let a=!0;Qo.forEach(o=>{(!(o in i)||isNaN(i[o]))&&(i[o]=0),a=a&&i[o]===null}),r=a}if(r||(i.amPm==="am"?i.hours=i.hours%12:i.amPm==="pm"&&(i.hours=i.hours%12+12),"timeZone"in i&&(n=!0,i.minutes-=i.timeZone),t&&(i.year==null||i.month==null||i.date==null)))return null;const l=[jr(i.year,An),jr(i.month,Pn),jr(i.date,Rn),i.hours,i.minutes,i.seconds,i.milliseconds];return n?new Date(Date.UTC(...l)):new Date(...l)}static toUTC(e){return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))}static format(e,t=E.defaultFormat){if(!e||isNaN(e))return null;let i=Wi[t],r="";if(!i){i=Wi[t]=[];for(let n=0;n<t.length;n++){const l=t.slice(n).match(qo),a=l==null?void 0:l[0];if(a){const o=this.localize("L{formats}")||{},u=o[a]||ae[a];i.push(u),n+=a.length-1}else if(t[n]==="{"){const o=t.indexOf("}",n+1);o===-1?(i.push(t.substr(n+1)),n=t.length):(i.push(t.substring(n+1,o)),n=o)}else i.push(t[n])}}return i.forEach(n=>{typeof n=="string"?r+=n:r+=n(e)}),r}static formatRange(e,t){return t.replace(Bo,(i,r,n)=>Ye.format(e[r==="S"?0:1],n))}static asMilliseconds(e,t=null){return typeof e=="string"&&(t=e,e=1),E.as("millisecond",e,t)}static asMonths(e){const t=E.as("ms",E.daysInMonth(e),"day"),i=(e.valueOf()-E.startOf(e,"month").valueOf())/t;return e.getYear()*12+e.getMonth()+i}static monthsToDate(e){const t=Math.floor(e),i=e-t,r=new Date(0,t),n=E.as("ms",E.daysInMonth(r),"days");return r.setTime(r.getTime()+i*n),r}static formatDelta(e,t){let i,r;typeof t=="boolean"?i=t:t&&(i=t.abbrev);const n=this.getDelta(e,t),l=[],a=(t==null?void 0:t.separator)||(i?"":" ");for(r in n)l.push(`${n[r]}${a}${r}`);return(t==null?void 0:t.asString)===!1?l:l.join(", ")}static getDelta(e,t){let i,r,n,l,a,o,u;typeof t=="boolean"?i=t:t&&(i=t.abbrev,l=E.normalizeUnit(t.precision),o=t.maxUnit,u=!i&&t.ignoreLocale);const c={},d=i?E.getShortNameOfUnit:E.getLocalizedNameOfUnit,f=o?qr.slice(qr.indexOf(o)):qr;for(a of f)if(r=E.as(a,e),n=l===a,r=Math[n?"round":"floor"](r),(r||n&&!c.length)&&(c[u?a:d.call(E,a,r!==1)]=r,e-=E.as("ms",r,a)),n||!e)break;return c}static as(e,t,i="ms"){return typeof t=="string"&&(t=E.parseDuration(t)),typeof t=="object"&&(i=t.unit,t=t.magnitude),e===i||(e=E.normalizeUnit(e),i=E.normalizeUnit(i),e===i)?t:We[i]>We[e]?t*Math.abs(ve[i][e]):t/Math.abs(ve[e][i])}static formatContainsHourInfo(e){const t=/(\\.)/g;return/([HhKkmSsAa]|LT|L{3,}|l{3,})/.test(e.replace(t,""))}static is24HourFormat(e){return E.format(E.getTime(13,0,0),e).includes("13")}static add(e,t,i="ms",r=!0){let n;if(typeof e=="string"?n=E.parse(e):r?n=new Date(e.getTime()):n=e,typeof t=="string"){const l=Ye.parseDuration(t);t=l.magnitude,i=l.unit}else t&&typeof t=="object"&&(i=t.unit,t=t.magnitude);if(!i||t===0)return n;switch(i=E.normalizeUnit(i),i){case"millisecond":n.setTime(n.getTime()+t);break;case"second":n.setTime(n.getTime()+t*1e3);break;case"minute":n.setTime(n.getTime()+t*6e4);break;case"hour":n.setTime(n.getTime()+t*36e5);break;case"day":t%1===0?(n.setDate(n.getDate()+t),n.getHours()===23&&e.getHours()===0&&n.setHours(n.getHours()+1)):n.setTime(n.getTime()+t*864e5);break;case"week":n.setDate(n.getDate()+t*7);break;case"month":{let l=n.getDate();l>28&&(l=Math.min(l,E.getLastDateOfMonth(E.add(E.getFirstDateOfMonth(n),t,"month")).getDate())),n.setDate(l),n.setMonth(n.getMonth()+t);break}case"quarter":E.add(n,t*3,"month",!1);break;case"year":n.setFullYear(n.getFullYear()+t);break;case"decade":n.setFullYear(n.getFullYear()+t*10);break}return n}static diff(e,t,i="ms",r=!0){if(i=E.normalizeUnit(i),!e||!t)return 0;let n;switch(i){case"year":n=E.diff(e,t,"month")/12;break;case"quarter":n=E.diff(e,t,"month")/3;break;case"month":n=(t.getFullYear()-e.getFullYear())*12+(t.getMonth()-e.getMonth()),n===0&&r&&(n=E.diff(e,t,"day",r)/E.daysInMonth(e));break;case"week":n=E.diff(e,t,"day")/7;break;case"day":{const l=e.getTimezoneOffset()-t.getTimezoneOffset();n=(t-e+l*60*1e3)/864e5;break}case"hour":n=(t-e)/36e5;break;case"minute":n=(t-e)/6e4;break;case"second":n=(t-e)/1e3;break;case"millisecond":n=t-e;break}return r?n:Math.round(n)}static startOf(e,t="day",i=!0,r=E.weekStartDay){if(!e)return null;switch(t=E.normalizeUnit(t),i&&(e=E.clone(e)),t){case"year":return e.setMonth(0,1),e.setHours(0,0,0,0),e;case"quarter":return e.setMonth((E.get(e,"quarter")-1)*3,1),e.setHours(0,0,0,0),e;case"month":return e.setDate(1),e.setHours(0,0,0,0),e;case"week":{const n=e.getDay()-r;return e.setDate(e.getDate()-n),e.setHours(0,0,0,0),e}case"day":return e.setHours(0,0,0,0),e;case"hour":e.getMinutes()>0&&e.setMinutes(0);case"minute":e.getSeconds()>0&&e.setSeconds(0);case"second":e.getMilliseconds()>0&&e.setMilliseconds(0);case"millisecond":return e}}static endOf(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}static clone(e){return new Date(e.getTime())}static clearTime(e,t=!0){return e?(t&&(e=new Date(e.getTime())),e.setHours(0,0,0,0),e):null}static midnight(e,t){let i=E.clearTime(e);return t&&i<e&&(i=E.add(i,1,"d")),i}static getTimeOfDay(e,t="ms"){const i=e.getHours()*ve.hour.millisecond+e.getMinutes()*ve.minute.millisecond+e.getSeconds()*ve.second.millisecond+e.getMilliseconds();return t==="ms"?i:E.as(t,i,"ms")}static set(e,t,i){if(!t)return e;if(typeof t=="string")switch(E.normalizeUnit(t)){case"millisecond":(i!==0||e.getMilliseconds()>0)&&e.setMilliseconds(i);break;case"second":(i!==0||e.getSeconds()>0)&&e.setSeconds(i);break;case"minute":(i!==0||e.getMinutes()>0)&&e.setMinutes(i);break;case"hour":e.setHours(i);break;case"day":case"date":e.setDate(i);break;case"week":throw new Error("week not implemented");case"month":e.setMonth(i);break;case"quarter":e.setDate(1),e.setMonth((i-1)*3);break;case"year":e.setFullYear(i);break}else Object.entries(t).sort((r,n)=>We[r[0]]-We[n[0]]).forEach(([r,n])=>{E.set(e,r,n)});return e}static setDateToMidday(e,t=!0){return E.set(E.clearTime(e,t),"hour",12)}static constrain(e,t,i){return t!=null&&(e=E.max(e,t)),i==null?e:E.min(e,i)}static getTime(e,t=0,i=0,r=0){return e instanceof Date&&(r=e.getMilliseconds(),i=e.getSeconds(),t=e.getMinutes(),e=e.getHours()),new Date(An,Pn,Rn,e,t,i,r)}static copyTimeValues(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),e}static get isDSTEnabled(){const e=new Date().getFullYear(),t=new Date(e,0,1),i=new Date(e,6,1);return t.getTimezoneOffset()!==i.getTimezoneOffset()}static isDST(e){const t=e.getFullYear(),i=new Date(t,0,1),r=new Date(t,6,1);return e.getTimezoneOffset()<Math.max(i.getTimezoneOffset(),r.getTimezoneOffset())}static isBefore(e,t){return e<t}static isAfter(e,t){return e>t}static isEqual(e,t,i=null){return i===null?e&&t&&e.getTime()===t.getTime():E.startOf(e,i)-E.startOf(t,i)===0}static compare(e,t,i=null){return i&&(e=E.startOf(e,i),t=E.startOf(t,i)),e<t?-1:e>t?1:0}static clamp(e,t,i){if(!isNaN(e))return t!=null&&(e=Math.max(e,t)),i!=null&&(e=Math.min(e,i)),new Date(e)}static isSameDate(e,t){return E.compare(e,t,"d")===0}static isSameTime(e,t){return e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds()&&e.getMilliseconds()===t.getMilliseconds()}static isStartOf(e,t){return E.isEqual(e,E.startOf(e,t))}static betweenLesser(e,t,i){return t.getTime()<=e.getTime()&&e.getTime()<i.getTime()}static betweenLesserEqual(e,t,i){return t.getTime()<=e.getTime()&&e.getTime()<=i.getTime()}static intersectSpans(e,t,i,r){return E.betweenLesser(e,i,r)||E.betweenLesser(i,e,t)}static compareUnits(e,t){return Math.sign(We[E.normalizeUnit(e)]-We[E.normalizeUnit(t)])}static timeSpanContains(e,t,i,r){return i-e>=0&&t-r>=0}static get weekStartDay(){return E._weekStartDay==null&&(E._weekStartDay=this.localize("L{weekStartDay}")||0),E._weekStartDay}static get nonWorkingDays(){return{...this.localize("L{nonWorkingDays}")}}static get nonWorkingDaysAsArray(){return Object.keys(this.nonWorkingDays).map(Number)}static get weekends(){return{...this.localize("L{weekends}")}}static get(e,t){switch(E.normalizeUnit(t)){case"millisecond":return e.getMilliseconds();case"second":return e.getSeconds();case"minute":return e.getMinutes();case"hour":return e.getHours();case"date":case"day":return e.getDate();case"week":return ae.W(e);case"month":return e.getMonth();case"quarter":return Math.floor(e.getMonth()/3)+1;case"year":return e.getFullYear()}return null}static daysInYear(e){const t=e.getFullYear(),i=new Date(t+1,0,1)-new Date(t,0,1);return this.as("day",i)}static daysInMonth(e){return 32-new Date(e.getFullYear(),e.getMonth(),32).getDate()}static hoursInDay(e){const t=e.getFullYear(),i=e.getMonth(),r=e.getDate(),n=new Date(t,i,r+1)-new Date(t,i,r);return this.as("hour",n)}static getNormalizedUnitDuration(e,t){let i;switch(t){case"month":i=E.asMilliseconds(E.daysInMonth(e),"day");break;case"year":i=E.asMilliseconds(E.daysInYear(e),"day");break;case"day":i=E.asMilliseconds(E.hoursInDay(e),"hour");break;default:i=E.asMilliseconds(t)}return i}static getFirstDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth(),1)}static getLastDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}static min(e,t){return e.getTime()<t.getTime()?e:t}static max(e,t){return e.getTime()>t.getTime()?e:t}static getNext(e,t,i=1,r=E.weekStartDay){if(t==="week"){const n=E.clone(e),l=n.getDay();return E.startOf(n,"day",!1),E.add(n,r-l+7*(i-(r<=l?0:1)),"day",!1),n.getDay()!==r&&E.add(n,1,"hour"),n}return E.startOf(E.add(e,i,t),t,!1)}static isValidDate(e){return E.isDate(e)&&!isNaN(e)}static isDate(e){return e&&In.call(e)===zo}static getStartOfNextDay(e,t=!1,i=!1){let r=E.add(i?e:E.clearTime(e,t),1,"day");if(r.getDate()===e.getDate()){const n=E.add(E.clearTime(e,t),2,"day").getTimezoneOffset(),l=e.getTimezoneOffset();r=E.add(r,l-n,"minute")}return r}static getEndOfPreviousDay(e,t=!1){const i=t?e:E.clearTime(e,!0);return i-e?i:E.add(i,-1,"day")}static getWeekDescription(e,t=e){const i=e.getMonth()===t.getMonth()?Ye.format(e,"MMMM"):`${Ye.format(e,"MMM")} - ${Ye.format(t,"MMM")}`,r=Ye.getWeekNumber(e);return`${r[1]}, ${i} ${r[0]}`}static getWeekNumber(e,t=Ye.weekStartDay){const i=new Date(e.getFullYear(),0,1),r=new Date(e.getFullYear(),11,31),n=Fn(i.getDay()-t),l=Fn(r.getDay()-t),a=jo(e,i);let o;if(n<4?o=Math.floor((a+n-1)/7)+1:o=Math.floor((a+n-1)/7),o){let c=e.getFullYear();return o===53&&l<3&&(c++,o=1),[c,o]}const u=Ye.getWeekNumber(new Date(e.getFullYear()-1,11,31))[1];return[e.getFullYear()-1,u]}static formatCount(e,t){return t=E.normalizeUnit(t),e!==1&&(t+="s"),e+" "+t}static getUnitToBaseUnitRatio(e,t,i=!1){return e=E.normalizeUnit(e),t=E.normalizeUnit(t),e===t?1:ve[e]&&ve[e][t]&&(i||ve[e][t]>0)?1/E.as(t,1,e):ve[t]&&ve[t][e]&&(i||ve[t][e]>0)?E.as(e,1,t):-1}static getShortNameOfUnit(e){return e=E.parseTimeUnit(e),E.unitLookup[e].abbrev}static getLocalizedNameOfUnit(e,t=!1){const i=e.charAt(0)===e.charAt(0).toUpperCase();return e=E.normalizeUnit(e),e=E.parseTimeUnit(e),e=E.unitLookup[e][t?"plural":"single"],i&&(e=k.capitalize(e)),e}static normalizeUnit(e){if(!e)return null;const t=e.toLowerCase();return t==="date"||Rt.includes(t)?t:Vn[e]||Vn[t]}static getUnitByName(e){return E.normalizeUnit(e)||E.normalizeUnit(E.parseTimeUnit(e))}static getDurationInUnit(e,t,i,r){return E.diff(e,t,i,r)}static doesUnitsAlign(e,t){return!(e!==t&&t==="week")}static getSmallerUnit(e){return Rt[We[E.normalizeUnit(e)]-1]||null}static getLargerUnit(e){return Rt[We[E.normalizeUnit(e)]+1]||null}static round(e,t,i,r){return E.snap("round",e,t,i,r)}static floor(e,t,i,r){return E.snap("floor",e,t,i,r)}static ceil(e,t,i,r){return E.snap("ceil",e,t,i,r)}static snap(e,t,i,r,n=E.weekStartDay){const l=iu[e];if(typeof i=="string"&&(i=E.parseDuration(i)),$.isObject(i)){const o=i.magnitude||i.increment;switch(i.unit){case"week":{if(!r){const u=t.getDay();r=E.add(E.clearTime(t),u>=n?n-u:-(u-n+7),"day")}return E[e](t,`${o*7} days`,r)}case"month":{t=E.asMonths(t);let u;return r?(r=E.asMonths(r),u=r+l(t-r,o)):u=l(t,o),E.monthsToDate(u)}case"quarter":return E[e](t,`${o*3} months`,r);case"year":return E[e](t,`${o*12} months`,r);case"decade":return E[e](t,`${o*10} years`,r)}i=E.as("ms",o,i.unit)}const a=t.getTimezoneOffset()*1e3*60;if(r){const o=r.getTimezoneOffset()*1e3*60,u=t-r+o-a,c=new Date(r.getTime()+l(u,i)),d=o-c.getTimezoneOffset()*1e3*60;return d&&E.add(c,-d,"ms",!1),new Date(c)}else return new Date(l(t.valueOf()-a,i)+a)}static parseDuration(e,t=!0,i){var r;const n=t?Xo:Jo,l=n.exec(e);if(e==null||!l)return null;const a=eu((r=l[1])==null?void 0:r.replace(",",".")),o=E.parseTimeUnit(l[2])||i;return o?{magnitude:a,unit:o}:null}static parseTimeUnit(e){const t=e==null?null:E.durationRegEx.exec(e.toLowerCase());if(!t)return null;for(let i=0;i<Rt.length;i++)if(t[i+1])return Rt[i]}static getGMTOffset(e=new Date){if(!e)return;const t=e.getTimezoneOffset();return t?(t>0?"-":"+")+Math.abs(Math.trunc(t/60)).toString().padStart(2,"0")+":"+Math.abs(t%60).toString().padStart(2,"0"):"Z"}static fillDayNames(){const e=new Date("2000-01-01T12:00:00"),t=E._dayNames||[],i=E._dayShortNames||[];t.length=0,i.length=0;for(let r=2;r<9;r++)e.setDate(r),t.push(E.format(e,"dddd")),i.push(E.format(e,"ddd"));E._dayNames=t,E._dayShortNames=i}static getDayNames(){return E._dayNames}static getDayName(e){return E._dayNames[e]}static getDayShortNames(){return E._dayShortNames}static getDayShortName(e){return E._dayShortNames[e]}static fillMonthNames(){const e=new Date("2000-01-15T12:00:00"),t=E._monthNames||[],i=E._monthShortNames||[],r={},n={};t.length=0,i.length=0;for(let l=0;l<12;l++){e.setMonth(l);const a=E.format(e,"MMMM");t.push(a);const o=E.format(e,"MMM");i.push(o),r[a.toLowerCase()]={name:a,value:l},n[o.toLowerCase()]={name:o,value:l}}E._monthNames=t,E._monthShortNames=i,E._monthNamesIndex=r,E._monthShortNamesIndex=n}static getMonthShortNames(){return E._monthShortNames}static getMonthShortName(e){return E._monthShortNames[e]}static getMonthNames(){return E._monthNames}static getMonthName(e){return E._monthNames[e]}static set locale(e){et=e,tt={},Wi={},ri={}}static get locale(){return et}static setupDurationRegEx(e=[],t=[]){const i=this,r={};let n="";for(let l=0;l<t.length;l++){const a=t[l],o=e[l];o.canonicalUnitName=Rt[l],r[o.single]=r[o.single.toUpperCase()]=r[o.canonicalUnitName]=r[o.canonicalUnitName.toUpperCase()]=o,n+=`${l?"|":""}(`;for(let u=0;u<a.length;u++)n+=`${a[u]}|`;if(et=i.localize("L{locale}")||"en-US",et!=="en-US"){const u=Zo[l];for(let c=0;c<u.length;c++)n+=`${u[c]}|`}n+=`${o.single}|${o.plural}|${o.canonicalUnitName}|${o.canonicalUnitName}s)`}i.unitLookup=r,i.durationRegEx=new RegExp(`^(?:${n})$`)}static applyLocale(){const e=this,t=e.localize("L{unitAbbreviations}")||[],i=e.unitNames=e.localize("L{unitNames}");i!=="unitNames"&&(et=e.localize("L{locale}")||"en-US",et==="en-US"?He=On:He=e.localize("L{ordinalSuffix}")||He,Wi={},ri={},Hr={},tt={},E._weekStartDay=null,E.setupDurationRegEx(i,t),E.fillDayNames(),E.fillMonthNames())}};x(jn,"MS_PER_DAY",Br*24);var z=jn,E=z;E.useIntlFormat=he,ge.ion({locale:"applyLocale",prio:1e3,thisObj:E}),ge.locale&&E.applyLocale(),z._$name="DateHelper";var{hasOwn:Kr}=$,Hn=1.005.toFixed(2)==="1.01"?null:function(s,e){const t=s.toString().split("."),i=+(t[1]?t.join(".")+"1":t[0]);return s.toFixed.call(i,e)},w=class wr extends ${static transformArrayToNamedObject(e,t="ref"){const i={};return e.forEach((r,n)=>{const l=r[t]!=null&&r[t].toString().length?r[t]:n;i[l]=r}),i}static transformNamedObjectToArray(e,t="ref"){return Object.keys(e).filter(i=>e[i]).map(i=>{const r=e[i];return r[t]=i,r})}static isEqual(e,t,i=!1){if(e===null&&t!==null||e===void 0&&t!==void 0||t===null&&e!==null||t===void 0&&e!==void 0)return!1;if(e==null&&t==null||e===t)return!0;const r=typeof e;if(r===typeof t){switch(r){case"number":case"string":case"boolean":return e===t}switch(!0){case(e instanceof Date&&t instanceof Date):return e.getTime()===t.getTime();case(Array.isArray(e)&&Array.isArray(t)):return e.length===t.length?e.every((l,a)=>we.isEqual(l,t[a],i)):!1;case(r==="object"&&e.constructor.prototype===t.constructor.prototype):return i?we.isDeeplyEqual(e,t,i):k.safeJsonStringify(e,"circular")===k.safeJsonStringify(t,"circular")}}return String(e)===String(t)}static isDeeplyEqual(e,t,i={}){if(e===t)return!0;if(!e||!t)return!1;const r=we.keys(e,i.ignore),n=we.keys(t,i.ignore);if(r.length!==n.length)return!1;for(let l=0;l<r.length;l++){const a=r[l],o=n[l];if(a!==o)return!1;const u=e[a],c=t[o];if(!(i.shouldEvaluate&&i.shouldEvaluate(a,{value:u,object:e},{value:c,object:t})===!1)){if(i.evaluate){const d=i.evaluate(a,{value:u,object:e},{value:c,object:t});if(d===!1)return!1;if(d===!0)continue}if(!we.isEqual(u,c,i))return!1}}return!0}static isPartial(e,t){return e=String(e).toLowerCase(),t=String(t).toLowerCase(),e.indexOf(t)!==-1}static isLessThan(e,t){return e instanceof Date&&t instanceof Date?z.isBefore(e,t):e<t}static isMoreThan(e,t){return e instanceof Date&&t instanceof Date?z.isAfter(e,t):e>t}static fork(e){let t,i,r;if(e&&e.constructor===Object){t=Object.setPrototypeOf({},e);for(i in e)r=e[i],r&&(r.constructor===Object?t[i]=we.fork(r):r instanceof Array&&(t[i]=r.slice()))}else t=e;return t}static copyProperties(e,t,i){let r,n;for(n=0;n<i.length;n++)r=i[n],r in t&&(e[r]=t[r]);return e}static copyPropertiesIf(e,t,i){if(t)for(const r of i)!(r in e)&&r in t&&(e[r]=t[r]);return e}static entries(e,t){const i=[],r=typeof t=="function";if(e)for(const n in e)(r?!t(n,e[n]):!(t!=null&&t[n]))&&i.push([n,e[n]]);return i}static fromEntries(e,t){if(t=t||{},e)for(let i=0;i<e.length;++i)t[e[i][0]]=e[i][1];return t}static keys(e,t,i){const r=[],n=typeof t=="function";if(e){let l=0;for(const a in e)(n?!t(a,e[a]):!(t!=null&&t[a]))&&(r.push(i?i(a,l):a),++l)}return r}static values(e,t,i){const r=[],n=typeof t=="function";if(e){let l=0;for(const a in e)(n?!t(a,e[a]):!(t!=null&&t[a]))&&(r.push(i?i(e[a],l):e[a]),++l)}return r}static pathExists(e,t){return t.split(".").every(r=>!e||!(r in e)?!1:(e=e[r],!0))}static pathifyKeys(e,t){const i={};for(const r in e)if(Kr(e,r)){const n=t==null?void 0:t[r],l=(n==null?void 0:n.type)==="object"||(n==null?void 0:n.complexMapping)||!t;if(l&&Array.isArray(e[r]))i[r]=e[r].slice();else if(l&&e[r]instanceof Object){const a=this.pathifyKeys(e[r]);for(const o in a)i[`${r}.${o}`]=a[o]}else i[r]=e[r]}return i}static deletePath(e,t){t.split(".").reduce((i,r,n,l)=>{if(i==null)return null;if(Kr(i,r))if(n===l.length-1)delete i[r];else return i[r]},e)}static coerce(e,t){const i=$.typeOf(e),r=$.typeOf(t),n=typeof e=="string";if(i!==r)switch(r){case"string":return String(e);case"number":return Number(e);case"boolean":return n&&(!e||e==="false"||e==="0")?!1:!!e;case"null":return n&&(!e||e==="null")?null:!1;case"undefined":return n&&(!e||e==="undefined")?void 0:!1;case"date":return n&&isNaN(e)?z.parse(e):Date(Number(e))}return e}static wrapProperty(e,t,i,r,n=!0){const l={};let a=Object.getPrototypeOf(e),o=Object.getOwnPropertyDescriptor(a,t);for(;!o&&a&&n;)a=Object.getPrototypeOf(a),a&&(o=Object.getOwnPropertyDescriptor(a,t));o?(o.set?l.set=u=>{o.set.call(e,u),r&&r.call(e,o.get.call(e))}:l.set=r,o.get?l.get=()=>{let u=o.get.call(e);return i&&(u=i.call(e,u)),u}:l.get=i):(l.set=u=>{e[`_${t}`]=u,r&&r.call(e,u)},l.get=()=>{let u=e[`_${t}`];return i&&(u=i.call(e,u)),u}),Object.defineProperty(e,t,l)}static hookProperty(e,t,i){const r=wr.getPropertyDescriptor(i.prototype,"value"),n=wr.getPropertyDescriptor(e,t),l=`_${t}`,a=class{get value(){return n?n.get.call(this):this[l]}set value(u){n?n.set.call(this,u):this[l]=u}},o=wr.getPropertyDescriptor(a.prototype,"value");return Object.setPrototypeOf(i.prototype,a.prototype),Object.defineProperty(e,t,{configurable:!0,get:r.get||o.get,set:r.set||o.set}),()=>delete e[t]}static getPropertyDescriptor(e,t){let i=null;for(let r=e;r&&!i&&!Kr(r,"isBase");r=Object.getPrototypeOf(r))i=Object.getOwnPropertyDescriptor(r,t);return i}static cleanupProperties(e,t=!1){return Object.entries(e).forEach(([i,r])=>{t?r===void 0&&delete e[i]:r==null&&delete e[i]}),e}static removeAllProperties(e){return Object.keys(e).forEach(t=>delete e[t]),e}static assertType(e,t,i){const r=$.typeOf(e);if(e!=null&&r!==t)throw new Error(`Incorrect type "${r}" for ${i}, expected "${t}"`)}static assertObject(e,t){we.assertType(e,"object",t)}static assertInstance(e,t){we.assertType(e,"instance",t)}static assertClass(e,t){we.assertType(e,"class",t)}static assertFunction(e,t){if(typeof e!="function"||e.isBase||e.$$name)throw new Error(`Incorrect type for ${t}, got "${e}" (expected a function)`)}static assertNumber(e,t){const i=Number(e);if(typeof e!="number"||isNaN(i))throw new Error(`Incorrect type for ${t}, got "${e}" (expected a Number)`)}static assertBoolean(e,t){we.assertType(e,"boolean",t)}static assertString(e,t){we.assertType(e,"string",t)}static assertArray(e,t){we.assertType(e,"array",t)}static toFixed(e,t){return Hn?Hn(e,t):e.toFixed(t)}static roundTo(e,t=1){return Math.round(e/t)*t}static round(e,t){if(t==null)return e;const i=10**t;return Math.round(e*i)/i}static getMapPath(e,t,i){const r=Array.isArray(t)?t:typeof t=="string"?t.split("."):[t],n=r.length===1,l=r[0],a=e.has(l)?e.get(l):e.set(l,n?i:{}).get(l);return n?a:we.getPathDefault(a,r.slice(1),i)}},we=w;w._$name="ObjectHelper";var gt=Symbol("value"),Wn=Symbol("length"),Z=class Fe{static change(e,t,i,r="string"){i=Fe.normalize(i,"object");const n=Fe.normalize(e,"array").filter(l=>!i[l]);if(t){t=Fe.normalize(t,"array");for(let l=0;l<t.length;++l)n.includes(t[l])||n.push(t[l])}return Fe.normalize(n,r)}static from(e,t){return e&&(e.isDomClassList?t=t!=null?t:!0:(t=t!=null?t:$.isObject(e)&&!$.isEmpty(e),e=new Fe(e)),!e.value&&!t&&(e=null)),e||(t?new Fe:null)}static normalize(e,t="string"){e=e||"";const i=typeof e,r=t==="array",n=t==="object",l=!r&&!n;let a=i==="string",o,u,c;for(i==="object"&&(e.nodeType===Element.ELEMENT_NODE&&typeof e.getAttribute=="function"?(e=e.getAttribute("class")||"",a=!0):e!=null&&e.isDomClassList?e=e.values:e instanceof DOMTokenList?e=Array.from(e):e instanceof Map?e=Array.from(e.keys()).filter(d=>e.get(d)):e instanceof Set?e=Array.from(e):Array.isArray(e)||(e=$.getTruthyKeys(e))),a&&(e=[...new Set(k.split(e))]),u=e.length;u-- >0;)o=e[u],o.length?o.includes(" ")&&e.splice(u,1,...k.split(o)):e.splice(u,1);if(r)c=e;else if(l)c=e.join(" ");else for(c=Object.create(null),u=0;u<e.length;++u)c[e[u]]=!0;return c}constructor(...e){this.process(1,e)}clear(){for(const e in this)this[e]=!1;return this}set(...e){return this.clear().process(1,e)}get isDomClassList(){return!0}clone(){return new Fe(this)}contains(e){return typeof e=="string"&&e?!!this[e]:!1}toString(){return this.length?`${this.value} `:""}toJSON(){return this.toString()}trim(){return this.value}isEqual(e){const t=Fe.normalize(e,"array"),i=t.length;if(this.length===i){for(let r=0;r<i;r++)if(!this[t[r]])return!1;return!0}return!1}get value(){let e=this[gt],t;return e==null&&(t=$.getTruthyKeys(this),this[Wn]=t.length,this[gt]=e=t.join(" ")),e}set value(e){const t=this,i=Object.keys(t),r=i.length;for(let n=0;n<r;n++)delete t[i[n]];e?t.process(1,[e]):delete t[gt]}get values(){return $.getTruthyKeys(this)}get length(){return this.value?this[Wn]:0}process(e,t){for(let i,r,n=0;n<t.length;n++)if(t[n])if(i=t[n],i.isDomClassList||$.isObject(i))for(r in i)this[r]=e?i[r]:!i[r];else for(i=Fe.normalize(t[n],"array"),r=0;r<i.length;++r)this[i[r]]=e;return delete this[gt],this}assign(e){for(const t in e)!this[t]!=!e[t]&&(this[t]=e[t],delete this[gt]);return this}assignTo(e){const t=e.nodeType===Element.ELEMENT_NODE?e.classList:e,i=Fe.from(t);i.add(this),t.value=i.value}add(...e){return this.process(1,e)}remove(...e){return this.process(0,e)}toggle(e,t=!this[e]){if(t=!!t,!!this[e]!==t)return this[e]=t,delete this[gt],!0}split(){return $.getTruthyKeys(this)}forEach(e){return $.getTruthyKeys(this).forEach(e)}};Z.prototype[gt]=null,Z._$name="DomClassList";var ru=5,su=s=>s.floating,nu={touchend:1,pointerup:1},lu={Meta:1,Control:1,Alt:1},Ae=new class extends R.mixin(De){suspendFocusEvents(){Ui=!0}resumeFocusEvents(){Ui=!1}setupFocusListenersOnce(e,t){e&&!Ae.observedElements.has(e)&&(Ae.setupFocusListeners(e,t),Ae.observedElements.add(e))}detachFocusListeners(e){e.$globalEventsDetacher&&(e.$globalEventsDetacher(),e.$globalEventsDetacher=null,Ae.observedElements.delete(e))}setupFocusListeners(e=document,t,i=!1){const r={element:e,touchstart(n){if(!Oe&&n.changedTouches.length===1){if(Oe=n.changedTouches[0],!j.isAndroid){const l=({clientX:u,clientY:c,type:d})=>{(nu[d]||Math.max(Math.abs(u-Oe.clientX),Math.abs(c-Oe.clientY))>ru)&&(Yr=null,a(),clearTimeout(o))},a=t.on({element:document,touchmove:l,touchend:l,pointermove:l,pointerup:l,capture:!0}),o=setTimeout(()=>{Yr=Oe.identifier,a(),n.target.dispatchEvent(new MouseEvent("contextmenu",t.copyEvent({},n)))},t.longPressTime)}}else Oe=null},touchend:{handler:n=>{Oe&&(n.changedTouches[0].identifier===Yr?(n.stopImmediatePropagation(),n.cancelable!==!1&&n.preventDefault()):n.changedTouches.length===1&&n.changedTouches[0].identifier===Oe.identifier&&Ae.trigger("globaltap",{event:n}),Oe=null)},passive:!1},mousedown:{handler:n=>{qi="mouse",Oe||Ae.trigger("globaltap",{event:n}),pt=n;const l=n.ctrlKey||n.altKey||n.shiftKey||n.metaKey;!se&&l?se=new KeyboardEvent("keydown",{key:n.ctrlKey?"Control":n.shiftKey?"Shift":n.altKey?"Alt":"Meta",ctrlKey:n.ctrlKey,altKey:n.altKey,shiftKey:n.shiftKey,metaKey:n.metaKey}):se&&!l&&(se=null)},passive:!1},mouseup(){pt=null},pointerdown:{passive:!1,handler:n=>{var l;si=n,v.usingKeyboard=!1,(l=e.classList)==null||l.remove("b-using-keyboard"),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&v.removeClsGlobally(e,"b-using-keyboard")}},pointerup:{passive:!1,handler:n=>{(si==null?void 0:si.pointerId)===n.pointerId&&(si=null)}},keydown(n){if(qi="key",se=n,Gr=n.target,!lu[n.key])if(v.usingKeyboard=!0,e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(const l of e.children)l.matches(".b-outer")&&l.classList.add("b-using-keyboard");else e.classList.add("b-using-keyboard")},mouseenter(n){Gr=n.target},keypress(){qi="key"},keyup(){se=null},focusin(n){var l,a,o;const{Widget:u}=Ae;if((l=n.target)!=null&&l.shadowRoot||(a=n.target)!=null&&a._shadowRoot||(u.resetFloatRootScroll(),Ui))return;const c=n.relatedTarget?n.relatedTarget instanceof HTMLElement?n.relatedTarget:document.body:null,d=n.target||document.body,f=u.fromElement(c),g=u.fromElement(d),h=v.getCommonAncestor(f,g),p=!!(c&&d.compareDocumentPosition(c)&4),m=u.query(au);let y=null;if(d&&d!==document.body?y=v.getActiveElement(d):y=v.getActiveElement(document),m&&!m._isRevertingFocus&&(!g||!m.owns(g)&&!(m.element.compareDocumentPosition(g.element)&4&&g.up(su))))return m.focus();let b=Jr("focusout",c,n.target,f,g,p);for(let C=f,T;C&&C!==h;C=T)if(T=C.owner,!C.isDestroying&&C.onFocusOut&&(C.onFocusOut(b),n.target&&y!==v.getActiveElement(n.target)))return;if(h&&n.target===h.element)!h.isDestroying&&v.getActiveElement(h)===d&&h.focusElement&&h.focusElement!==h.element&&(!h.element.contains(y)||h.focusDescendant)&&h.setTimeout(()=>{var C;return(C=h.focus)==null?void 0:C.call(h)},0);else{b=Jr("focusin",d,c,f,g,p);for(let C=g;C&&C!==h;C=C.owner)C.isDestroying||(o=C.onFocusIn)==null||o.call(C,b)}const S=v.getCommonAncestor((c==null?void 0:c.nodeType)===Element.ELEMENT_NODE?c:null,d)||d.parentNode;S&&(b=Jr("focusmove",d,c,f,g,p,{bubbles:!0}),S.dispatchEvent(b))},focusout(n){if(!Ui&&(!n.relatedTarget||!Ae.Widget.fromElement(n.relatedTarget))){const l=n.relatedTarget&&n.relatedTarget instanceof HTMLElement?n.relatedTarget:null;r.focusin({target:l,relatedTarget:n.target}),se=pt=null}},blur:{element:globalThis,handler(n){n.target===globalThis&&(se=null,pt=null)}},capture:!0,passive:!0};i&&(Xr==null||Xr()),Xr=this.detachEvents=e.$globalEventsDetacher=t.on(r)}get lastInteractionType(){return qi}get shiftKeyDown(){return se==null?void 0:se.shiftKey}get ctrlKeyDown(){return(se==null?void 0:se.ctrlKey)||(se==null?void 0:se.metaKey)}get altKeyDown(){return se==null?void 0:se.altKey}get currentOverElement(){return Gr}isKeyDown(e){return e?(se==null?void 0:se.key)===e||se[(e==null?void 0:e.toLowerCase())+"Key"]===!0:!!se}isMouseDown(e=0){return(pt==null?void 0:pt.button)===e}get currentMouseDown(){return pt}get currentPointerDown(){return si}get currentTouch(){return Oe}get currentKeyDown(){return se}},au=s=>s.isVisible&&s.isTopModal;Ae.observedElements=new Set;var Oe,Yr,Ui=!1,qi,se,pt,si,Gr,Xr;function Jr(s,e,t,i,r,n,l){const a=new CustomEvent(s,l);return Object.defineProperty(a,"_target",{get(){return e}}),Object.defineProperty(a,"relatedTarget",{get(){return t}}),a.fromWidget=i,a.toWidget=r,a.backwards=n,a}var be=Ae,ou=["clientX","clientY","pageX","pageY","screenX","screenY"],uu={element:1,thisObj:1,once:1,delegate:1,delay:1,capture:1,passive:1,throttled:1,autoDetach:1,expires:1,block:1},it=!0,Un={configurable:it,value:!0},cu={Spacebar:"Space",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},du={Control:"ctrl",Alt:"alt",Shift:"shift"},fu=/^(ctrl|shift|alt|meta)$/,hu=["altKey","bubbles","button","buttons","cancelBubble","cancelable","clientX","clientY","ctrlKey","layerX","layerY","metaKey","pageX","pageY","returnValue","screenX","screenY","shiftKey"],qn=class Wa{static normalizeEvent(e){return w.copyPropertiesIf(e,e.changedTouches[0]||e.touches[0],ou)}static copyEvent(e,t){return w.copyProperties(e,t,hu)}static getXY(e){return e.touches&&(e=e.touches[0]),[e.clientX,e.clientY]}static getDistanceBetween(e,t){const i=ne.getXY(e),r=ne.getXY(t);return Math.sqrt(Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2))}static getPagePoint(e){return new nt(e.pageX,e.pageY)}static getClientPoint(e){return new nt(e.clientX,e.clientY)}static addListener(e,t,i,r){return e.nodeType?typeof t=="string"?r=Object.assign({element:e,[t]:i},r):r=Object.assign({element:e},t):r=e,ne.on(r)}static on(e){const t=e.element,i=e.thisObj,r=[];for(const l in e)if(!uu[l]){let a=e[l];typeof a!="object"&&(a={handler:a});const o=a.element||t;r.push(ne.addElementListener(o,l,a,e))}const n=()=>{for(let l,a=0;a<r.length;a++)l=r[a],ne.removeEventListener(l[0],l[1],l[2]);r.length=0};return i&&e.autoDetach!==!1&&(i.doDestroy=re.createInterceptor(i.doDestroy,n,i)),n}static addElementListener(e,t,i,r){const n=ne.createHandler(e,t,i,r),{spec:l}=n,a=i.expires||r.expires,o=l.capture!=null||l.passive!=null?{capture:l.capture,passive:l.passive}:void 0;if(e.addEventListener(t,n,o),a){const u=i.thisObj||r.thisObj,c=u!=null&&u.isDelayable?u:globalThis,{alt:d}=a,f=d?a.delay:a,{spec:g}=n;g.expires=a,g.timerId=c[typeof f=="number"?"setTimeout":"requestAnimationFrame"](()=>{g.timerId=null,ne.removeEventListener(e,t,n),d&&!n.called&&(typeof d=="string"?u[d]:d).call(u)},f,`listener-timer-${performance.now()}`)}return[e,t,n,o]}static getComposedPathTarget(e){return e.composedPath()[0]||e.path[0]}static fixEvent(e){var t,i,r;if(e.fixed)return e;const{type:n,target:l}=e;if((l!=null&&l.shadowRoot||(i=(t=l==null?void 0:l.getRootNode)==null?void 0:t.call(l))!=null&&i.host)&&e.composedPath){const a=this.getComposedPathTarget(e),o=l;Object.defineProperty(e,"target",{value:a,configurable:it}),Object.defineProperty(e,"originalTarget",{value:o,configurable:it})}if(Object.defineProperty(e,"fixed",Un),n.startsWith("key")){const a=cu[e.key];a&&Object.defineProperty(e,"key",{value:a,configurable:it}),e.key===" "&&!e.code&&Object.defineProperty(e,"code",{value:"Space",configurable:it})}if(e.metaKey&&!e.ctrlKey&&Object.defineProperty(e,"ctrlKey",Un),l&&"offsetX"in e&&(Object.getOwnPropertyDescriptor(e,"borderOffsetX")||Object.defineProperty(e,"borderOffsetX",{get:()=>e.offsetX+(j.isSafari?0:parseInt(l.ownerDocument.defaultView.getComputedStyle(l).getPropertyValue("border-left-width")))}),Object.getOwnPropertyDescriptor(e,"borderOffsetY")||Object.defineProperty(e,"borderOffsetY",{get:()=>e.offsetY+(j.isSafari?0:parseInt(l.ownerDocument.defaultView.getComputedStyle(l).getPropertyValue("border-top-width")))})),(l==null?void 0:l.nodeType)===Element.DOCUMENT_NODE&&"clientX"in e){const a=v.elementFromPoint(e.clientX,e.clientY);Object.defineProperty(e,"target",{value:a,configurable:it})}if((l==null?void 0:l.nodeType)===Element.TEXT_NODE){const a=e.target.parentElement;Object.defineProperty(e,"target",{value:a,configurable:it})}if(((r=e.relatedTarget)==null?void 0:r.nodeType)===Element.TEXT_NODE){const a=e.target.parentElement;Object.defineProperty(e,"relatedTarget",{value:a,configurable:it})}return n.startsWith("touch")&&e.touches.length&&this.normalizeEvent(e),e}static createHandler(e,t,i,r){const n=i.delay||r.delay,l=i.throttled||r.throttled,a=i.block||r.block,o="once"in i?i.once:r.once,u="capture"in i?i.capture:r.capture,c="passive"in i?i.passive:r.passive,d="delegate"in i?i.delegate:r.delegate,f=i.handler,g=i.expires,h=i.thisObj||r.thisObj,{rtlSource:p=h}=h||{};let m=(y,...b)=>{ne.playingDemo&&y.isTrusted||h!=null&&h.isDestroyed||(y=ne.fixEvent(y,p==null?void 0:p.rtl),m.called=!0,(typeof f=="string"?h[f]:f).call(h,y,...b),delete y.target,delete y.relatedTarget,delete y.originalarget,delete y.key,delete y.code,delete y.ctrlKey,delete y.fixed)};if(a){const y=m;let b,S;m=(C,...T)=>{const _=performance.now();(!b||C.target!==S||_-b>a)&&(S=C.target,b=_,y(C,...T))}}if(n!=null){const y=m,b=h!=null&&h.setTimeout?h:globalThis;m=(...S)=>{b.setTimeout(()=>{y(...S)},n)}}if(l!=null){let y,b=l;l.buffer&&(y=S=>l.alt.call(ne,ne.fixEvent(S,p==null?void 0:p.rtl)),b=l.buffer),h!=null&&h.isDelayable?m=h.throttle(m,{delay:b,throttled:y}):m=re.createThrottled(m,b,h,null,y)}if(o){const y=m;m=(...b)=>{ne.removeEventListener(e,t,m),y(...b)}}if(d){const y=m;m=(b,...S)=>{var C;b=ne.fixEvent(b,p==null?void 0:p.rtl);const T=((C=b.target.closest)==null?void 0:C.call)&&b.target.closest(d);T&&(Object.defineProperty(b,"currentTarget",{get:()=>T,configurable:!0}),y(b,...S))}}return i.thisObj&&i.autoDetach!==!1&&(h.doDestroy=re.createInterceptor(h.doDestroy,()=>ne.removeEventListener(e,t,m),h)),m.spec={delay:n,throttled:l,block:a,once:o,thisObj:h,capture:u,expires:g,passive:c,delegate:d},m}static removeEventListener(e,t,i){const{expires:r,timerId:n,thisObj:l,capture:a}=i.spec;r!=null&&r.alt&&n&&(l!=null&&l.isDelayable?l:globalThis)[typeof r.delay=="number"?"clearTimeout":"cancelAnimationFrame"](n),e.removeEventListener(t,i,a)}static onTransitionEnd({element:e,animationName:t,property:i,handler:r,mode:n=t?"animation":"transition",duration:l=v[`get${n==="transition"?"Property":""}${k.capitalize(n)}Duration`](e,i),thisObj:a=globalThis,args:o=[],timerSource:u,runOnDestroy:c}){let d;u=u||(a.isDelayable?a:globalThis);const f=[e,i,...o],g=()=>{h(),a.isDestroyed||(a.callback?a.callback(r,a,f):r.apply(a,f))},h=ne.on({element:e,[`${n}end`]({animationName:p,propertyName:m,target:y}){var b;y===e&&(m===i||p!=null&&p.match(t))&&(d&&((b=u.clearTimeout)==null||b.call(u,d),d=null),g())}});return l!=null&&(d=u.setTimeout(g,l+50,"onTransitionEnd",c)),h}static async waitForTransitionEnd(e){return new Promise(t=>{e.handler=t,Wa.onTransitionEnd(e)})}static createDblClickWrapper(e,t,i){let r,n,l;return()=>{n||(n=ne.on({element:e,touchstart:a=>{r=a.changedTouches[0].identifier,a.preventDefault()},touchend:a=>{if(a.changedTouches[0].identifier===r){a.preventDefault(),clearTimeout(l),r=n=null;const o=K.from(a.changedTouches[0].target,null,!0),u=a.changedTouches[0].pageX-o.x,c=a.changedTouches[0].pageY-o.y,d=Object.assign({browserEvent:a},a),f=new MouseEvent("dblclick",d);Object.defineProperties(f,{target:{value:a.target},offsetX:{value:u},offsetY:{value:c}}),typeof t=="string"&&(t=i[t]),t.call(i,f)}},once:!0}),l=setTimeout(()=>{n(),r=n=null},ne.dblClickTime))}}static toSpecialKey(e,t=j.isMac?"metaKey":"ctrlKey"){let i=!1;return e===!0?i=t:typeof e=="string"&&(e=e.toLowerCase(),e.match(fu)&&(i=`${e}Key`)),i}static specialKeyFromEventKey(e){return du[e]||"no-special-key"}};x(qn,"eventNameMap",{mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseenter:"MouseEnter",mouseleave:"MouseLeave",mousemove:"MouseMove",mouseover:"MouseOver",mouseout:"MouseOut",keyup:"KeyUp",keydown:"KeyDown",keypress:"KeyPress"});var B=qn,ne=B;ne.longPressTime=700,ne.dblClickTime=300,j.isTouchDevice&&ne.on({element:document,touchmove:s=>{s.target.closest(".b-dragging")&&s.preventDefault()},passive:!1,capture:!0}),B._$name="EventHelper";var gu=14,pu={align:"t0-t0"},ni=Node.ELEMENT_NODE,Ki=Node.TEXT_NODE,{isObject:mu}=w,Kn=/[+-]?\d*\.?\d+[eE]?-?\d*/g,Pe=Kn.source,yu=new RegExp(`matrix\\((?:${Pe}),\\s?(?:${Pe}),\\s?(?:${Pe}),\\s?(?:${Pe}),\\s?(${Pe}),\\s?(${Pe})`),vu=new RegExp("matrix3d\\((?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(-?\\d*),\\s?(-?\\d*)"),Yi=new RegExp(`(?:${yu.source})|(?:${vu.source})`),bu=new RegExp(`translate(3d|X)?\\((${Pe})px(?:,\\s?(${Pe})px)?`),Cu=new RegExp(`translate(3d|Y)?\\((${Pe})px(?:,\\s?(${Pe})px)?`),wu=/\s+/,Su=/\s*;\s*/,Eu=/\s*:\s*/,Tu=/^-?((\d+(\.\d*)?)|(\.?\d+))$/,xu="$bryntum",Du={elementData:"",for:"htmlFor",retainElement:""},_u={tag:1,html:1,text:1,children:1,tooltip:1,style:1,dataset:1,parent:1,nextSibling:1,ns:1,reference:1,class:1,className:1,unmatched:1,onlyChildren:1,listeners:1,compareHtml:1,syncOptions:1,keepChildren:1},Yn={length:1,parentRule:1,style:1},Mu={INPUT:1,TEXTAREA:1},Iu={BUTTON:1,IFRAME:1,EMBED:1,INPUT:1,OBJECT:1,SELECT:1,TEXTAREA:1,BODY:1},Gi=globalThis,oe=document,Ou=Object.freeze({}),Zr=Array.prototype.slice,Fu=Promise.resolve(),Lu=["font-size","font-size-adjust","font-style","font-weight","font-family","font-kerning","font-stretch","line-height","text-transform","text-decoration","letter-spacing","word-break"],ku=s=>s._hidden,Au=s=>s.parentNode||s.host,Pu=(s,e,t)=>t.key==="children"?w.mergeItems(s,e,t):w.blend(s,e,t),Qr=s=>{const e=s.ownerDocument.defaultView.getComputedStyle(s);return e.getPropertyValue("display")!=="none"&&e.getPropertyValue("visibility")!=="hidden"},rt=s=>s&&(s===oe.body||!!s.offsetParent||(s.ownerDocument.defaultView&&"offsetParent"in s&&v.getStyleValue(s,"position")!=="fixed"?s.offsetParent:rt(s.parentNode))),Gn=s=>s instanceof Node?s:typeof s=="string"?D.createElementFromTemplate(s):D.createElement(s),li=Object.create(null),Xn=(s,e)=>{const t=li[s]||[k.hyphenate(s),e];return li[s]||(li[t[0]]=li[s]=t),t},Ru=s=>s.ownerSVGElement?s.ownerSVGElement.parentNode:s.offsetParent,$u=/b-slide-in-from-\w+/;["top","right","bottom","left","width","height","maxWidth","maxHeight","minWidth","minHeight","borderSpacing","borderWidth","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","letterSpacing","lineHeight","outlineWidth","textIndent","wordSpacing"].forEach(s=>Xn(s,!0));var ai=null,Nu=0,mt=null,es,Jn,Zn,v=class Ri{static async slideIn(e,t=1){const i=`b-slide-in-${t>0?"next":"previous"}`,{classList:r,parentNode:{classList:n}}=e;n.add(".b-sliding-child-element"),r.add(i),await B.waitForTransitionEnd({element:e,animationName:$u}),r.remove(i),n.remove(".b-sliding-child-element")}static isFocusable(e,t=!1){if(!t&&(!D.isVisible(e)||D.Widget.fromElement(e,ku)))return!1;const i=e.nodeName;return Iu[i]||(i==="A"||i==="LINK")&&!!e.href||e.getAttribute("tabIndex")!=null||e.contentEditable==="true"}static isEditable(e){return e.isContentEditable||Mu[e.nodeName]}static isInView(e,t=!1,i){if(!rt(e))return!1;const r=(i==null?void 0:i.positioned)&&Ri.getStyleValue(i.element,"position")!=="fixed",n=K.from(globalThis),l=t?"contains":"intersect",a=r&&i.element.offsetParent,o=r&&K.from(a);if(n.height=oe.scrollingElement.scrollHeight,e===oe.body)return n;const u=this.getViewportIntersection(e,n,l);return u&&r&&u.translate(oe.scrollingElement.scrollLeft,oe.scrollingElement.scrollTop),r&&u?u.translate(-o.x+a.scrollLeft,-o.y+a.scrollTop):u}static getViewportIntersection(e,t,i){const{parentNode:r}=e,{parentElement:n}=r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.getRootNode().host:e,l=n.ownerDocument.defaultView.getComputedStyle(n),a=l.overflowX!=="visible"||l.overflowY!=="visible",o=Ru(e);let u=K.from(e,null,!0);for(let c=a?e.parentNode:o;u&&c!==oe.documentElement;c=c.parentNode){c.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&c.host&&(c=c.host.parentNode);const d=c===oe.body,f=c.ownerDocument.defaultView.getComputedStyle(c);f.display!=="contents"&&(d||f.overflow!=="visible")&&(u=(d?t:K.client(c,null,!0,!0))[i](u,!1,!0))}return u}static isVisible(e){const t=e.ownerDocument;for(;e;e=Au(e)){if(e===t)return!0;if(e.nodeType===e.ELEMENT_NODE&&!Qr(e))return!1}return!1}static isDOMEvent(e){return e instanceof Event}static merge(e,...t){return w.blend(e,t,{merge:Pu})}static normalizeChildren(e,t,i){var r;let n=e==null?void 0:e.children,l,a,o,u,c;if((r=e==null?void 0:e.syncOptions)!=null&&r.ignoreRefs&&(i=!0),n&&!(e instanceof Node))if(Array.isArray(n))for(a=0;a<n.length;++a)D.normalizeChildren(n[a],t,i);else{u=n,e.children=n=[];for(o in u)l=u[o],l!=null&&l.isWidget&&(l=l.element),c=!o.startsWith("$")&&!D.isElement(l),c&&(t==null||t(o,!i)),l&&(l instanceof Node||(l.reference===!1?delete l.reference:c&&typeof l!="string"&&(l.reference=o),D.normalizeChildren(l,t,i)),n.push(l))}return e}static roundPx(e,t=globalThis.devicePixelRatio||1){const i=1/t;return Math.round(e/i)*i}static floorPx(e,t=globalThis.devicePixelRatio||1){const i=1/t;return Math.floor(e*i)/i}static isCustomElement(e){return!!(e!=null&&e.shadowRoot)}static elementFromPoint(e,t){let i=document.elementFromPoint(e,t);return D.isCustomElement(i)&&(i=i.shadowRoot.elementFromPoint(e,t)||i),i}static childFromPoint(e,t,i,r=e){const n=i==null?t:new K(t,i,0,0);let l=null;return Array.from(e.children).reverse().some(a=>{if(K.from(a,r).contains(n))return l=a.children.length&&D.childFromPoint(a,n,null,r)||a,!0}),l}static unitize(e,t,i="px"){const[r,n]=Xn(e);return t!=null&&(t=String(t),t=n&&Tu.test(t)?t+i:t),[r,t]}static get activeElement(){let e=document.activeElement;for(;e.shadowRoot;)e=e.shadowRoot.activeElement;return e}static getActiveElement(e){e!=null&&e.isWidget&&(e=e.element);let t=((e==null?void 0:e.getRootNode())||document).activeElement;for(;t!=null&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}static getRootElement(e){var t;const i=(t=e.getRootNode)==null?void 0:t.call(e),{nodeType:r}=i;return r===Node.DOCUMENT_NODE?i.body:r===Node.DOCUMENT_FRAGMENT_NODE?i:e.ownerDocument.contains(e)?e.ownerDocument.body:null}static getOutermostElement(e){var t;const i=(t=e.getRootNode)==null?void 0:t.call(e);if(i!=null&&i.body)return i==null?void 0:i.body;for(;e.parentNode!==i&&e.parentNode;)e=e.parentNode;return e}static isValidFloatRootParent(e){return e===document.body||e.constructor.name==="ShadowRoot"}static getId(e){return e.id||(e.id="b-element-"+ ++Nu)}static getCommonAncestor(e,t){var i,r;if(e===t)return e;for(;e&&!((i=e[e.isWidget?"owns":"contains"])!=null&&i.call(e,t)||e===t);)e=(r=e.owner)!=null&&r.isWidget&&e.owner!==e?e.owner:e.parentNode;return e}static getElement(e){return e instanceof Element?e:oe.querySelector(e)}static setAttributes(e,t){const i=D.getElement(e);if(i&&t)for(const r in t)t[r]==null?i.removeAttribute(r):i.setAttribute(r,t[r])}static setLength(e,t,i){return arguments.length===1?i=typeof e=="number"?`${e}px`:e!=null?e:"":(e=D.getElement(e),i=e.style[t]=typeof i=="number"?`${i}px`:i!=null?i:""),i}static percentify(e,t=2){const i=Math.pow(10,t);return e==null||e===""||isNaN(e)?"":`${Math.round(e*i)/i}%`}static getChild(e,t){return e.querySelector(":scope>"+t)}static hasChild(e,t){return D.getChild(e,t)!=null}static children(e,t){return(t[0]===">"||t.startsWith("# "))&&(t[0]==="#"&&(t=t.substr(2)),t=":scope "+t),Array.from(e.querySelectorAll(t))}static getChildElementCount(e){return e.childElementCount}static down(e,t){return e?e.matches&&e.matches(t)?e:(t=":scope "+t,e.querySelector(t)):null}static isDescendant(e,t){const i=D.getRootElement(e),r=D.getRootElement(t);return r&&i!==r&&r.host?D.isDescendant(i,r.host):e.contains(t)}static getEventElement(e,t="target"){return!e||D.isElement(e)?e:e[t]}static isElement(e){return(e==null?void 0:e.nodeType)===document.ELEMENT_NODE&&D.isNode(e)}static isReactElement(e){return(e==null?void 0:e.$$typeof)===Symbol.for("react.element")}static isNode(e){return!!e&&typeof e.nodeType=="number"&&!mu(e)}static forEachSelector(e,t,i){if(typeof e=="string")throw new Error("DomHelper.forEachSelector must provide a root element context (for shadow root scenario)");D.children(e,t).forEach(i)}static forEachChild(e,t){Array.from(e.children).forEach(t)}static removeEachSelector(e,t){D.forEachSelector(e,t,i=>i.remove())}static removeClsGlobally(e,...t){t.forEach(i=>D.forEachSelector(e,"."+i,r=>r.classList.remove(i)))}static up(e,t){return le.deprecate("Core","6.0.0","DomHelper.up() deprecated, use native `element.closest()` instead"),e.closest(t)}static getAncestor(e,t,i=null){let r=!1,n,l=e;for(t=V.asArray(t);l=l.parentElement;){if(t.includes(l)){r=!0;break}if(i&&l===i)break;n=l}return r?n||e:null}static getParents(e){const t=[];for(;e.parentElement;)t.push(e.parentElement),e=e.parentElement;return t}static makeValidId(e,t=""){return k.makeValidDomId(e,t)}static createElement(e={},t){var i,r;let n=t,l,a,o,u,c,d,f,g,h,p,m;if(typeof n=="boolean")throw new Error("Clean up");t&&(c=t.ignoreRefs,h=t.refOwner,p=t.refs,n=t.returnAll,m=t.syncIdField,c&&(o=!0,c=c!=="children")),typeof e.parent=="string"&&(e.parent=document.getElementById(e.parent));const y=e.parent||e.nextSibling&&e.nextSibling.parentNode,{dataset:b,html:S,reference:C,syncOptions:T,text:_}=e;if(T&&(m=T.syncIdField||m,u=T.ignoreRefs,u&&(o=!0,c=u!=="children",t={...t,ignoreRefs:!0})),c&&(h=null),e.ns?l=oe.createElementNS(e.ns,e.tag||"svg"):l=oe.createElement(e.tag||"div"),_!=null?D.setInnerText(l,_):S!=null&&(S instanceof DocumentFragment?l.appendChild(S):l.innerHTML=S),e.tooltip&&D.Widget.attachTooltip(l,e.tooltip),e.style&&D.applyStyle(l,e.style),b)for(f in b)g=b[f],g!=null&&(l.dataset[f]=g);y&&this.addChild(y,l,e.nextSibling),h&&(l.$refOwnerId=h.id),C&&!c&&(h?(l.$reference=C,h.attachRef(C,l,e)):(p||(t=Object.assign({},t),t.refs=p={}),p[C]=l,l.setAttribute("data-reference",C)));const L=e.className||e.class,F=Object.keys(e);for(L&&l.setAttribute("class",Z.normalize(L)),a=0;a<F.length;++a)f=F[a],g=e[f],(d=Du[f])!=null?l[d||f]=g:!_u[f]&&f&&g!=null&&l.setAttribute(f,g);!e["aria-hidden"]&&!e.role&&!e.tabIndex&&!Ri.isFocusable(l,!0)&&!l.htmlFor&&l.setAttribute("role","presentation"),(r=t==null?void 0:t.callback)==null||r.call(t,{action:"newElement",domConfig:e,targetElement:l,syncId:h?C:t.syncIdField&&((i=e.dataset)==null?void 0:i[t.syncIdField])}),n===!0?t.returnAll=n=[l]:Array.isArray(n)&&n.push(l),e.children&&(m&&(l.syncIdMap={}),e.children.forEach(M=>{var P,W,H;if(M)if(typeof M=="string"){const I=document.createTextNode(M);h&&(I.$refOwnerId=h.id),l.appendChild(I)}else if(isNaN(M.nodeType)){M.parent=l,!M.ns&&e.ns&&(M.ns=e.ns);const I=D.createElement(M,{...t,ignoreRefs:(W=(P=e.syncOptions)==null?void 0:P.ignoreRef)!=null?W:o}),Y=(H=M.dataset)==null?void 0:H[m];Y!=null&&(l.syncIdMap[Y]=I),delete M.parent}else l.appendChild(M)})),l.lastDomConfig=e;const O=p||n||l;return e.replaceElement&&e.replaceElement.replaceWith(O),O}static createElementFromTemplate(e,t=Ou){const{array:i,raw:r,fragment:n}=t;let l;if(D.supportsTemplate){if((es||(es=oe.createElement("template"))).innerHTML=e,l=es.content,n)return l.cloneNode(!0)}else if(l=(Jn||(Jn=new DOMParser)).parseFromString(e,"text/html").body,n){const a=l.childNodes;for(l=document.createDocumentFragment();a.length;)l.appendChild(a[0]);return l}return r?l=l.childNodes:l=l.children,l.length===1&&!i?l[0]:Zr.call(l)}static triggerMouseEvent(e,t="contextmenu"){const i=this.isInView(e),r=i||K.from(e),n=r.center,l=new MouseEvent(t,{clientX:n.x,clientY:n.y,bubbles:!0});e.dispatchEvent(l)}static insertFirst(e,t){return t&&t.nodeType!==ni&&t.tag&&(t=D.createElement(t)),e.insertBefore(t,e.firstElementChild)}static insertBefore(e,t,i){return t&&t.nodeType!==ni&&t.tag&&(t=D.createElement(t)),i?e.insertBefore(t,i):D.insertFirst(e,t)}static insertAt(e,t,i){const r=Array.from(e.children);if(i>=r.length)return D.append(e,t);const n=r[i];return D.insertBefore(e,t,n)}static append(e,t){if(t.forEach){if(Array.isArray(t)&&(t=t.map(i=>Gn(i))),e.append)e.append(...t);else{const i=document.createDocumentFragment();t.forEach(function(r){i.appendChild(r)}),e.appendChild(i)}return t}else return e.appendChild(Gn(t))}static getTranslateX(e){const t=e.style.transform;let i=bu.exec(t);return i?parseFloat(i[2]):(i=Yi.exec(t)||Yi.exec(D.getStyleValue(e,"transform")),i?parseFloat(i[1]||i[3]):0)}static getTranslateY(e){const t=e.style.transform;let i=Cu.exec(t);if(i){const r=parseFloat(i[i[1]==="Y"?2:3]);return isNaN(r)?0:r}else return i=Yi.exec(t)||Yi.exec(D.getStyleValue(e,"transform")),i?parseFloat(i[2]||i[4]):0}static getTranslateXY(e){return[D.getTranslateX(e),D.getTranslateY(e)]}static getOffsetX(e,t=null){return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:e.offsetLeft}static getOffsetY(e,t=null){return t?e.getBoundingClientRect().top-t.getBoundingClientRect().top:e.offsetTop}static getOffsetXY(e,t=null){return[D.getOffsetX(e,t),D.getOffsetY(e,t)]}static focusWithoutScrolling(e){function t(r){r.forEach(({element:n,scrollLeft:l,scrollTop:a})=>{n.scrollLeft!==l&&(n.scrollLeft=l),n.scrollTop!==a&&(n.scrollTop=a)})}if(!j.isSafari)e.focus({preventScroll:!0});else{const r=D.getParents(e),n=r.map(l=>({element:l,scrollLeft:l.scrollLeft,scrollTop:l.scrollTop}));e.focus(),setTimeout(()=>t(n),0)}}static getPageX(e){return e.getBoundingClientRect().left+Gi.pageXOffset}static getPageY(e){return e.getBoundingClientRect().top+Gi.pageYOffset}static getExtremalSizePX(e,t){const i=k.hyphenate(t),r=i.split("-")[1];let n=D.getStyleValue(e,i);return/%/.test(n)?e.parentElement?n=parseInt(D.getStyleValue(e.parentElement,r),10):n=NaN:n=parseInt(n,10),n}static setScale(e,t,i=t){const r=D.getStyleValue(e,"transform").split(/,\s*/);r.length>1?(r[0].startsWith("matrix3d")?(r[0]=`matrix3d(${t}`,r[5]=i):(r[0]=`matrix(${t}`,r[3]=i),e.style.transform=r.join(",")):e.style.transform=`scale(${t}, ${i})`}static setTranslateX(e,t){const i=D.getStyleValue(e,"transform").split(/,\s*/);t=D.roundPx(t),i.length>1?(i[i[0].startsWith("matrix3d")?12:4]=t,e.style.transform=i.join(",")):e.style.transform=`translateX(${t}px)`}static setTranslateY(e,t){const i=D.getStyleValue(e,"transform").split(/,\s*/);t=D.roundPx(t),i.length>1?(i[i[0].startsWith("matrix3d")?13:5]=t,e.style.transform=i.join(",")+")"):e.style.transform=`translateY(${t}px)`}static setTop(e,t){D.setLength(e,"top",t)}static setLeft(e,t){D.setLength(e,"left",t)}static setTopLeft(e,t,i){D.setLength(e,"top",t),D.setLength(e,"left",i)}static setRect(e,{x:t,y:i,width:r,height:n}){D.setTopLeft(e,i,t),D.setLength(e,"width",r),D.setLength(e,"height",n)}static setTranslateXY(e,t,i){if(t==null)return D.setTranslateY(e,i);if(i==null)return D.setTranslateX(e,t);t=D.roundPx(t),i=D.roundPx(i);const r=D.getStyleValue(e,"transform").split(/,\s*/),n=r[0].startsWith("matrix3d");r.length>1?(r[n?12:4]=t,r[n?13:5]=i,e.style.transform=r.join(",")+")"):e.style.transform=`translate(${t}px, ${i}px)`}static addTranslateX(e,t){D.setTranslateX(e,D.getTranslateX(e)+t)}static addTranslateY(e,t){D.setTranslateY(e,D.getTranslateY(e)+t)}static addLeft(e,t){D.setLeft(e,D.getOffsetX(e)+t)}static addTop(e,t){D.setTop(e,D.getOffsetY(e)+t)}static alignTo(e,t,i=pu,r){t=t instanceof K?t:K.from(t,!0);const n=D.getTranslateXY(e),l=K.from(e,!0);r&&(l.roundPx(),t.roundPx());const a=l.alignTo(Object.assign(i,{target:t}));D.setTranslateXY(e,n[0]+a.x-l.x,n[1]+a.y-l.y)}static getStyleValue(e,t,i,r){const n=i?e.style:e.ownerDocument.defaultView.getComputedStyle(e,r);if(Array.isArray(t)){const l={};for(const a of t)l[a]=n.getPropertyValue(k.hyphenate(a));return l}return n.getPropertyValue(k.hyphenate(t))}static getEdgeSize(e,t,i){const r=t==="border"?"-width":"",n={raw:{}};for(const l of["top","right","bottom","left"])(!i||i.includes(l[0]))&&(n[l]=parseFloat(n.raw[l]=D.getStyleValue(e,`${t}-${l}${r}`)));return n.width=(n.left||0)+(n.right||0),n.height=(n.top||0)+(n.bottom||0),n}static parseStyle(e){if(typeof e=="string"){const t=e.split(Su);e={};for(let i=0,{length:r}=t;i<r;i++){const n=t[i].split(Eu);e[n[0]]=n[1]}}return e||{}}static applyStyle(e,t,i=!1){if(typeof t=="string")i?(t.length||e.style.cssText.length)&&(e.style.cssText=t):e.style.cssText+=t;else if(t){i&&(e.style.cssText=""),t.style&&typeof t.style!="string"&&(t=w.assign({},t,t.style));let r,n;for(r in t)Yn[r]||([r,n]=D.unitize(r,t[r]),n==null?e.style.removeProperty(r):e.style.setProperty(r,n));typeof t.style=="string"&&(e.style.cssText+=t.style)}}static getCSSText(e){if(typeof e=="string")return e;let t="";for(const i in e)Yn[i]||(t+=`${k.hyphenate(i)}:${e[i]};`);return t}static addClasses(e,t){le.deprecate("Core","6.0.0","DomHelper.addClasses should be replaced by native classList.add"),e.classList.add(...t)}static removeClasses(e,t){le.deprecate("Core","6.0.0","DomHelper.removeClasses should be replaced by native classList.remove"),e.classList.remove(...t)}static toggleClasses(e,t,i=null){t=V.asArray(t),i===!0?e.classList.add(...t):i===!1?e.classList.remove(...t):t.forEach(r=>e.classList.toggle(r))}static addTemporaryClass(e,t,i,r=globalThis,n=t){i>0&&(e.classList.add(t),r.setTimeout({fn:l=>e.classList.remove(l),delay:i,name:n,args:[t],cancelOutstanding:!0}))}static getPropertyTransitionDuration(e,t){const i=globalThis.getComputedStyle(e),r=i.transitionProperty.split(", "),n=i.transitionDuration.split(", "),l=r.indexOf(k.hyphenate(t));let a;return l!==-1&&(a=parseFloat(n[l])*1e3),a}static getAnimationDuration(e){return parseFloat(D.getStyleValue(e,"animation-duration"))*1e3}static highlight(e,t=globalThis){return e instanceof K?e.highlight():new Promise(i=>{t.setTimeout(()=>{e.classList.add("b-fx-highlight"),t.setTimeout(()=>{e.classList.remove("b-fx-highlight"),i()},1e3)},0)})}static get scrollBarWidth(){if(ai===null){const e=Zn||(Zn=D.createElement({parent:oe.documentElement,className:"b-scrollbar-measure-element",style:"position:absolute;top:-9999em;height:100px;overflow-y:scroll"}));e.parentNode!==oe.documentElement&&oe.documentElement.appendChild(e),ai=e.offsetWidth}return ai}static get scrollBarPadElement(){return{className:"b-yscroll-pad",children:[{className:"b-yscroll-pad-sizer"}]}}static resetScrollBarWidth(){ai=null}static measureText(e,t,i=!1,r=void 0){const n=D.getMeasureElement(t,r);n[i?"innerHTML":"innerText"]=e;const l=n.clientWidth;return n.className="",l}static measureSize(e,t,i=!0){if(!e)return 0;if(typeof e=="number")return e;if(!e.length)return 0;if(/^\d+(px)?$/.test(e))return parseInt(e);if(t){const r=D.getMeasureElement(t);r.innerHTML="",r.style.width=D.setLength(e);const n=i?r.offsetWidth:r.getBoundingClientRect().width;return r.style.width=r.className="",n}return/^\d+em$/.test(e)?parseInt(e)*gu:isNaN(e)?0:parseInt(e)}static getMeasureElement(e,t=oe.body){const i=Gi.getComputedStyle(e),r=t.offScreenDiv=t.offScreenDiv||D.createElement({parent:t,style:"position:fixed;top:-10000px;left:-10000px;visibility:hidden;contain:strict",className:"b-measure-element",children:[{style:"white-space:nowrap;display:inline-block;will-change:contents;width:auto;contain:none"}]},{returnAll:!0})[1];return Lu.forEach(n=>{r.style[n]!==i[n]&&(r.style[n]=i[n])}),r.className=e.className,r.parentElement.parentElement!==t&&t.appendChild(r.parentElement),r}static stripTags(e){return(D.$domParser||(D.$domParser=new DOMParser)).parseFromString(e,"text/html").body.textContent}static sync(e,t){if(typeof e=="string")if(e===""){t.innerHTML="";return}else e=D.createElementFromTemplate(e);return D.performSync(e,t),t}static performSync(e,t){return e.outerHTML!==t.outerHTML?(D.syncAttributes(e,t),D.syncContent(e,t),D.syncChildren(e,t),!0):!1}static getSyncAttributes(e){const t={},i=[];for(let r=0;r<e.attributes.length;r++){const n=e.attributes[r];if(n.specified){const l=n.name.toLowerCase();t[l]=n.value,i.push(l)}}return{attributes:t,names:i}}static syncAttributes(e,t){const{attributes:i,names:r}=D.getSyncAttributes(e),{attributes:n,names:l}=D.getSyncAttributes(t),a=r.includes("dataset"),o=r.filter(d=>!l.includes(d)),u=l.filter(d=>!r.includes(d)&&(!a||!d.startsWith("data-"))),c=r.filter(d=>l.includes(d));if(o.length>0)for(let d=0;d<o.length;d++){const f=o[d];f==="style"?D.applyStyle(t,i.style,!0):f==="dataset"?Object.assign(t.dataset,i.dataset):t.setAttribute(f,i[f])}if(u.length>0)for(let d=0;d<u.length;d++)t.removeAttribute(u[d]);if(c.length>0)for(let d=0;d<c.length;d++){const f=c[d];if(f==="style")D.applyStyle(t,i.style,!0);else if(f==="dataset")Object.assign(t.dataset,i.dataset);else if(f==="class"&&(i.class.isDomClassList||typeof i.class=="object")){let g;i.class.isDomClassList?g=i.class:g=new Z(i.class),g.isEqual(n.class)||t.setAttribute("class",g)}else n[f]!==i[f]&&t.setAttribute(f,i[f])}}static syncContent(e,t){D.getChildElementCount(e)===0&&(t.innerText=e.innerText)}static setInnerText(e,t){const{firstChild:i}=e;(i==null?void 0:i.nodeType)===Element.TEXT_NODE?i.data=t:e.textContent=t}static syncChildren(e,t){const i=this,r=Zr.call(e.childNodes),n=Zr.call(t.childNodes);for(;r.length;){const l=r.shift(),a=n.shift();if(l&&l.nodeType!==Ki&&l.nodeType!==ni)throw new Error(`Source node type ${l.nodeType} not supported by DomHelper.sync()`);if(a&&a.nodeType!==Ki&&a.nodeType!==ni)throw new Error(`Target node type ${a.nodeType} not supported by DomHelper.sync()`);if(!a)t.appendChild(l);else if(l.nodeType===a.nodeType)l.nodeType===Ki?a.data=l.data:l.tagName===a.tagName?i.performSync(l,a):(t.insertBefore(l,a),a.remove());else if(l.nodeType===Ki&&a.nodeType===ni)t.innerText=l.data.trim();else{const o=l.parentElement||l;throw new Error(`Currently no support for transforming nodeType.
${o.outerHTML}`)}}n.forEach(l=>{l.remove()})}static syncClassList(e,t){const{classList:i}=e,r=typeof t=="string",n=r?t.split(wu):Z.normalize(t,"array"),l=n.length;let a=i.length!==l,o;for(o=0;!a&&o<l;o++)a=!i.contains(n[o]);return a&&(e.className=r?t:n.join(" ")),a}static updateClassList(e,t){const{classList:i}=e;let r,n,l=!1;for(r in t)n=!!t[r],i.contains(r)!==n&&(i[n?"add":"remove"](r),l=!0);return l}static setTheme(e,t){e=e.toLowerCase();const{head:i}=document,r=D.getThemeInfo(t).name.toLowerCase();let n=i.querySelectorAll("[data-bryntum-theme]:not([data-loading])"),l=0;if(r===e)return Fu;D.removeEachSelector(i,"#bryntum-theme[data-loading],link[data-bryntum-theme][data-loading]");const a={theme:e,prev:r};function o(u,c,d){const f=Ri.createElement({tag:"link",rel:"stylesheet",dataset:{loading:!0,bryntumTheme:!0},href:u.href.replace(r,e),nextSibling:u});f.addEventListener("load",()=>{delete f.dataset.loading,mt=null,++l===n.length&&(n.forEach(g=>g.remove()),be.trigger("theme",a),c(a))}),f.addEventListener("error",g=>{delete f.dataset.loading,d(g)})}if(n.length)return new Promise((u,c)=>{n.forEach((d,f)=>{o(d,u,c,f===n.length-1)})});{const u=i.querySelector("#bryntum-theme:not([data-loading])")||i.querySelector(`[href*="${r}.css"]:not([data-loading])`);if(!(u!=null&&u.href.includes(`${r}.css`)))throw new Error(`Theme link for ${r} not found`);return n=[u],new Promise((c,d)=>o(u,c,d))}}static get themeInfo(){return Ri.getThemeInfo()}static getThemeInfo(e){if(!mt){const t=D.createElement({parent:document.body,className:"b-theme-info"}),i=D.getStyleValue(t,"content",!1,":before");if(i)try{mt=JSON.parse(i.replace(/^["']|["']$|\\/g,""))}catch(r){mt=null}mt=mt||(e?{name:e}:null),t.remove()}return mt}static async transition({element:e,selector:t="[data-dom-transition]",duration:i,action:r,thisObj:n=this,addTransition:l={},removeTransition:a={}}){const o=new Set,u=Array.from(e.querySelectorAll(t)),c=new Map(u.map(h=>{let p=0,m=h.parentElement;for(;m&&m!==e;)p++,m=m.parentElement;h.$depth=p,h.scrollHeight>h.offsetHeight&&getComputedStyle(h).overflow==="auto"&&(h.$scrollTop=h.scrollTop,o.add(h));const{parentElement:y}=h,b=K.from(h,e),S=K.from(h,y),C=getComputedStyle(y),T=parseFloat(C.borderLeftWidth);return T&&(b.left-=T,S.left-=T),[h.id,{element:h,globalBounds:b,localBounds:S,depth:p,parentElement:y}]}));r.call(n);const d=Array.from(e.querySelectorAll(t)),f=new Map(d.map(h=>{const p=K.from(h,e),m=K.from(h,h.parentElement),y=globalThis.getComputedStyle(h.parentElement),b=parseFloat(y.borderLeftWidth);return b&&(p.left-=b,m.left-=b),[h.id,{element:h,globalBounds:p,localBounds:m}]})),g=["position","top","left","width","height","padding","margin","zIndex","minWidth","minHeight","opacity","overflow"];for(const[h,p]of c){const m=f.get(h);if(m){const{element:y}=m,{style:b,parentElement:S}=y,C=parseInt(D.getStyleValue(y,"zIndex")),{globalBounds:T,localBounds:_,depth:L,parentElement:F}=p,O=F!==S;w.copyProperties(y.$initial={parentElement:S},b,g);let M;O?(m.bounds=m.globalBounds,M=T,e.appendChild(y)):(m.bounds=m.localBounds,M=_,F.appendChild(y));let P="hidden";o.has(y)&&(y.$scrollPlaceholder=D.createElement({parent:y,style:{height:y.scrollHeight}}),P="auto");const W={position:"absolute",top:`${M.top}px`,left:`${M.left}px`,width:`${M.width}px`,height:`${M.height}px`,minWidth:0,minHeight:0,margin:0,zIndex:L+(C||0),overflow:P};y.dataset.domTransition!=="preserve-padding"&&(W.padding=0),Object.assign(b,W),m.processed=!0}else{const{element:y,localBounds:b,depth:S,parentElement:C}=p;y.$initial={removed:!0},Object.assign(y.style,{position:"absolute",top:`${b.top}px`,left:`${b.left}px`,width:`${b.width}px`,height:`${b.height}px`,minWidth:0,minHeight:0,padding:0,margin:0,zIndex:S,overflow:"hidden"}),C.appendChild(y),f.set(h,{element:y,bounds:b,removed:!0,processed:!0}),d.push(y)}}for(const[,h]of f)if(!h.processed){const{element:p}=h,{style:m,parentElement:y}=p,b=h.bounds=h.localBounds;p.classList.add("b-dom-transition-adding"),w.copyProperties(p.$initial={parentElement:y},m,g),Object.assign(m,{position:"absolute",top:l.top?0:`${b.top}px`,left:l.left?0:`${b.left}px`,width:l.width?0:`${b.width}px`,height:l.height?0:`${b.height}px`,opacity:l.opacity?0:null,zIndex:y.$depth+1,overflow:"hidden"})}for(const h of o)h.scrollTop=h.$scrollTop;e.classList.add("b-dom-transition"),e.firstElementChild.offsetWidth;for(const[,{element:h,bounds:p,removed:m}]of f)m?Object.assign(h.style,{top:a.top?0:`${p.top}px`,left:a.left?0:`${p.left}px`,width:a.width?0:`${p.width}px`,height:a.height?0:`${p.height}px`,opacity:a.opacity?0:h.$initial.opacity}):Object.assign(h.style,{top:`${p.top}px`,left:`${p.left}px`,width:`${p.width}px`,height:`${p.height}px`,opacity:h.$initial.opacity});await zr.sleep(i),e.classList.remove("b-dom-transition");for(const h of d)h.$initial&&(h.$initial.removed?h.remove():(w.copyProperties(h.style,h.$initial,g),h.$scrollPlaceholder&&(h.$scrollPlaceholder.remove(),delete h.$scrollPlaceholder),h.classList.remove("b-dom-transition-adding"),h.$initial.parentElement.appendChild(h)));for(const h of o)h.scrollTop=h.$scrollTop,delete h.$scrollTop}static async loadScript(e){return new Promise((t,i)=>{const r=document.createElement("script");r.src=e,r.onload=t,r.onerror=i,document.head.appendChild(r)})}static isNamedColor(e){return e&&!/^(#|hsl|rgb|hwb|lab|lch|oklab|oklch)/.test(e)}static createColorStyle(e){return e!=null&&e.length?this.isNamedColor(e)?`var(--cal-color-${e})`:e:""}static get NodeFilter(){return NodeFilter}static addChild(e,t,i){e.insertBefore(t,i)}static cloneStylesIntoShadowRoot(e,t){return new Promise((i,r)=>{t&&e.querySelectorAll('style, link[rel="stylesheet"]').forEach(a=>a.remove());const n=document.querySelectorAll('link[rel="stylesheet"]');let l=0;n.forEach(a=>{const o=a.cloneNode();o.addEventListener("load",()=>{l+=1,l===n.length&&i()}),o.addEventListener("error",u=>{r(o.href)}),e.appendChild(o)}),document.querySelectorAll("style").forEach(a=>{const o=a.cloneNode();o.innerText=a.innerText,e.appendChild(o)}),n.length||i()})}},D=v,Qn,Vu=()=>D.isTouchEvent=!1,el=()=>{D.isTouchEvent=!0,clearTimeout(Qn),Qn=setTimeout(Vu,400)};if(oe.addEventListener("touchstart",el,!0),oe.addEventListener("touchend",el,!0),D.canonicalStyles=li,D.supportsTemplate="content"in oe.createElement("template"),D.elementPropKey=xu,D.numberRe=Kn,!("children"in Node.prototype)){const s=e=>e.nodeType===e.ELEMENT_NODE;Object.defineProperty(Node.prototype,"children",{get:function(){return Array.prototype.filter.call(this.childNodes,s)}})}Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(s){const e=(this.document||this.ownerDocument).querySelectorAll(s);let t=e.length;for(;--t>=0&&e.item(t)!==this;);return t>-1}),Gi.Element&&!Element.prototype.closest?Node.prototype.closest=Element.prototype.closest=function(s){let e=this;if(!oe.documentElement.contains(e))return null;do{if(e.matches(s))return e;e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===e.ELEMENT_NODE);return null}:Node.prototype.closest=function(s){var e;return(e=this.parentNode)==null?void 0:e.closest(s)},function(s){s.forEach(function(e){Object.prototype.hasOwnProperty.call(e,"remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),globalThis.addEventListener("resize",()=>ai=null),v._$name="DomHelper";var ts,tl=["border-top-width","border-right-width","border-bottom-width","border-left-width"],zu=["margin-top","margin-right","margin-bottom","margin-left"],Bu=["padding-top","padding-right","padding-bottom","padding-left"],st={t:"border-top-width",r:"border-right-width",b:"border-bottom-width",l:"border-left-width"},Xi={t:"padding-top",r:"padding-right",b:"padding-bottom",l:"padding-left"},ju=/^([trblc])(\d*)-([trblc])(\d*)$/i,Hu=/^([trblc])(\d*)$/i,Ji=["top","right","bottom","left"],oi={t:0,r:1,b:2,l:3},is=["b-t","l-r","t-b","r-l"],Wu={bt:1,tb:1,lr:2,rl:2},il=Object.freeze([0,0]),Uu=["width","height"],Zi=(s,e=s,t=s,i=e)=>Array.isArray(s)?Zi.apply(null,s):[s,e,t,i],qu=Object.freeze([]);function rl(s,e){const t=ju.exec(s),i=t[1],r=t[3],n=parseInt(t[2]||50),l=parseInt(t[4]||50),a=e&&!(oi[i]&1)?100-n:n,o=e&&!(oi[r]&1)?100-l:l,u=Wu[i+r];return{myAlignmentPoint:i+a,myEdge:i,myOffset:a,targetAlignmentPoint:r+o,targetEdge:r,targetOffset:o,startZone:oi[r],edgeAligned:u}}function Ku(s){return`${Ji[(oi[s.myEdge]+2)%4][0]}${s.myOffset}-${Ji[(oi[s.targetEdge]+2)%4][0]}${s.targetOffset}`}function Yu(s){return s==null?il:typeof s=="number"?[s,s]:s}var K=class Ie{constructor(e,t,i,r){x(this,"isRectangle",!0),w.assertNumber(e,"Rectangle.x"),w.assertNumber(t,"Rectangle.y"),w.assertNumber(i,"Rectangle.width"),w.assertNumber(r,"Rectangle.height");const n=this;i<0&&(e+=i,i=-i),r<0&&(t+=r,r=-r),n._x=e,n._y=t,n._width=i,n._height=r}static from(e,t,i){if(typeof e=="string"?e=document.querySelector(e):(e==null?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&(e=e.host||e.ownerDocument),typeof t=="string"&&(t=document.querySelector(t)),e==null||e.isRectangle)return e;if(e=e.element||e,i===void 0&&typeof t=="boolean"&&(i=t,t=null),!(t!=null&&t.isRectangle))if(t){let{scrollLeft:u,scrollTop:c}=t;j.isSafari&&t===document.body&&(u=c=0),t=Ie.from(t).translate(-u,-c)}else ts||(ts=new Ie(0,0,0,0)),t=ts;const r=e===document||e===globalThis,n=e===document.body&&document.body.offsetHeight===0,l=n&&e.getBoundingClientRect(),a=n?new Ie(l.left,l.top,l.width,document.body.parentElement.scrollHeight):r?new Ie(0,0,globalThis.innerWidth,globalThis.innerHeight):e.getBoundingClientRect(),o=i||r?[0,0]:[globalThis.pageXOffset,globalThis.pageYOffset];return new Ie(a.left+o[0]-t.x,a.top+o[1]-t.y,a.width,a.height)}static fromScreen(e,t){return Ie.from(e,t,!0)}static inner(e,t,i=!1){const r=this.from(e,t,i);if(document.body.contains(e)){const n=v.getStyleValue(e,tl);r.x+=parseFloat(n[st.l]),r.y+=parseFloat(n[st.t]),r.right-=parseFloat(n[st.r]),r.bottom-=parseFloat(n[st.b])}return r}static content(e,t,i=!1){const r=this.from(e,t,i);if(document.body.contains(e)){const n=v.getStyleValue(e,tl),l=v.getStyleValue(e,Bu);r.x+=parseFloat(n[st.l])+parseFloat(l[Xi.l]),r.y+=parseFloat(n[st.t])+parseFloat(l[Xi.t]),r.right-=parseFloat(n[st.r])+parseFloat(l[Xi.r]),r.bottom-=parseFloat(n[st.b])+parseFloat(l[Xi.b])}return r}static client(e,t,i=!1,r){const n=this.content(e,t,i),l=v.scrollBarWidth,a=r?[...e.children].filter(u=>v.getStyleValue(u,"position")==="sticky"):qu;let o;l&&!e.classList.contains("b-hide-scroll")&&(e.scrollHeight>e.clientHeight&&v.getStyleValue(e,"overflow-y")!=="hidden"&&(o=parseFloat(v.getStyleValue(e,"padding-right")),n.right+=o-Math.max(o,l)),e.scrollWidth>e.clientWidth&&v.getStyleValue(e,"overflow-x")!=="hidden"&&(o=parseFloat(v.getStyleValue(e,"padding-bottom")),n.bottom+=o-Math.max(o,l)));for(let u=0,{length:c}=a;u<c;u++){const d=a[u],f=this.fromScreen(d);parseFloat(v.getStyleValue(d,"left"))===0?n.x+=f.width:parseFloat(v.getStyleValue(d,"right"))===0?n.right-=f.width:parseFloat(v.getStyleValue(d,"top"))===0?n.y+=f.height:parseFloat(v.getStyleValue(d,"bottom"))===0&&(n.bottom-=f.height)}return n}static outer(e,t,i=!1){const r=this.from(e,t,i);if(document.body.contains(e)){const n=v.getStyleValue(e,zu);r.x-=parseFloat(n["margin-left"]),r.y-=parseFloat(n["margin-top"]),r.right+=parseFloat(n["margin-right"]),r.bottom+=parseFloat(n["margin-bottom"])}return r}static union(...e){let{x:t,y:i,right:r,bottom:n}=e[0],l;if(e.length>1)for(let a=1;a<e.length;a++)l=e[a],l.x<t&&(t=l.x),l.y<i&&(i=l.y),l.right>r&&(r=l.right),l.bottom>n&&(n=l.bottom);return new Ie(t,i,r-t,n-i)}roundPx(e=globalThis.devicePixelRatio||1){const t=this;return t._x=v.roundPx(t._x,e),t._y=v.roundPx(t._y,e),t._width=v.roundPx(t._width,e),t._height=v.roundPx(t._height,e),t}static get $$name(){return hasOwnProperty.call(this,"$name")&&this.$name||hasOwnProperty.call(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}clone(){const e=this,t=new Ie(e.x,e.y,e.width,e.height);return t.isAlignRectangle=e.isAlignRectangle,t.minHeight=e.minHeight,t.minWidth=e.minWidth,t}contains(e){const t=this;return e.isRectangle?e._x>=t._x&&e._y>=t._y&&e.right<=t.right&&e.bottom<=t.bottom:!1}intersect(e,t=!1,i=!1){const r=this,n=Math.max(r.y,e.y),l=Math.min(r.right,e.right),a=Math.min(r.bottom,e.bottom),o=Math.max(r.x,e.x);return(i?a>=n&&l>=o:a>n&&l>o)?t?!0:new Ie(o,n,l-o,a-n):!1}equals(e,t=!1){const i=t?r=>Math.round(r):r=>r;return e.isRectangle&&i(e.x)===i(this.x)&&i(e.y)===i(this.y)&&i(e.width)===i(this.width)&&i(e.height)===i(this.height)}translate(e,t){return this._x+=e||0,this._y+=t||0,this}moveTo(e,t){return e!=null&&(this._x=e),t!=null&&(this._y=t),this}getDelta(e){return[e.x-this.x,e.y-this.y]}get center(){const e=new nt(this.x+this.width/2,this.y+this.height/2,0,0);return e.target=this.target,e}set x(e){const t=e-this._x;this._x=e,this._width-=t}get x(){return this._x}get start(){return this.left}set left(e){this.x=e}get left(){return this.x}set top(e){this.y=e}get top(){return this.y}set y(e){const t=e-this._y;this._y=e,this._height-=t}get y(){return this._y}set width(e){this._width=e}get width(){return this._width}set height(e){this._height=e}get height(){return this._height}set right(e){this._width=e-this._x}get right(){return this._x+this._width}get end(){return this.right}set bottom(e){this._height=e-this._y}get bottom(){return this._y+this._height}getStart(e,t=!0){return t?e?this.right:this.left:this.top}getEnd(e,t=!0){return t?e?this.left:this.right:this.bottom}get area(){return this.width*this.height}set minWidth(e){const t=this;isNaN(e)?t._minWidth=null:(t._minWidth=Number(e),t.isAlignRectangle||(t.width=Math.max(t.width,t._minWidth)))}get minWidth(){return this._minWidth}set minHeight(e){const t=this;isNaN(e)?t._minHeight=null:(t._minHeight=Number(e),t.isAlignRectangle||(t.height=Math.max(t.height,t._minHeight)))}get minHeight(){return this._minHeight}adjust(e,t,i,r){const n=this;return n.x+=e,n.y+=t,n.width+=i,n.height+=r,n}inflate(e,t=e,i=e,r=t){return Array.isArray(e)&&([e,t,i,r]=Zi(e)),this.adjust(-r,-e,t,i)}deflate(e,t=e,i=e,r=t){return Array.isArray(e)&&([e,t,i,r]=Zi(e)),this.adjust(r,e,-t,-i)}constrainTo(e,t){const i=this,r=i.height,n=i.y,l=i.minWidth||i.width,a=i.minHeight||i.height;if(i.height>=e.height){if(t&&a>e.height)return!1;i._y=e.y,i.height=e.height}if(i.width>=e.width){if(t&&l>e.width)return i.y=n,i.height=r,!1;i._x=e.x,i.width=e.width}return i.translate.apply(i,i.constrainVector=[Math.min(e.right-i.right,0),Math.min(e.bottom-i.bottom,0)]),i.translate(Math.max(e.x-i.x,0),Math.max(e.y-i.y,0)),i}alignTo(e){let t=this.clone(),{target:i,constrainTo:r,constrainPadding:n}=e,l,a,o,u;if(i&&!i.isRectangle&&(i=Ie.from(i.element?i.element:i)),r){if(!r.isRectangle){u=r===globalThis||r===document;const O="ignorePageScroll"in e?e.ignorePageScroll:!u;r=Ie.from(r.element?r.element:r,null,O)}n&&(n=Zi(n),n[0]=Math.min(n[0],i.top),n[1]=Math.min(n[1],r.right-i.right),n[2]=Math.min(n[2],r.bottom-i.bottom),n[3]=Math.min(n[3],i.left),r=r.deflate.apply(r.clone(),n))}const c=this,d=Yu(e.offset),{align:f,axisLock:g,anchorSize:h,anchorPosition:p,matchSize:m,position:y,rtl:b}=e,S=rl(f,b),C=r&&r.clone(),T=[],_=[{zone:a=S.startZone,align:f}],L=m&&Uu[S.startZone&1],F=c[L];if(L&&g?t[L]=i[L]:!S.edgeAligned&&m&&(t.width=i.width,t.height=i.height),r&&t.constrainTo(r),r&&S.startZone!=null)if(g)_.push({zone:a=(a+2)%4,align:Ku(S)}),g==="flexible"&&(_.push({zone:a=(S.startZone+1)%4,align:is[a]}),_.push({zone:a=(a+2)%4,align:is[a]}));else for(let O=1;O<4;O++)_.push({zone:a=(a+1)%4,align:is[a]});if(p){const O=S.startZone&1?"y":"x";l={[O]:p[O],edge:Ji[(S.startZone+2)%4]}}if(C&&i&&(C.adjust(-i.width,-i.height,i.width,i.height),i.constrainTo(C)),t.minWidth=c.minWidth,t.minHeight=c.minHeight,y)t.moveTo(y.x,y.y),t.translate.apply(t,d),r&&t.constrainTo(r);else{const O=S.myEdge==="c"||S.targetEdge==="c",M=h&&!O?[h[1]+d[0],h[1]+d[1]]:d,P=i.getAlignmentPoint(S.targetAlignmentPoint,M),W=t.getAlignmentPoint(S.myAlignmentPoint);t.translate(P[0]-W[0],P[1]-W[1]);let H=t.intersect(i,!0);if(H)r&&t.constrainTo(r),o=S.startZone,t.translate(...M);else if(r&&!r.contains(t)){const I=t.clone(),Y=[];let G,A;l=null,T[0]=G=r.clone(),G.bottom=i.y-M[1],T[1]=G=r.clone(),G.x=i.right+M[0],T[2]=G=r.clone(),G.y=i.bottom+M[1],T[3]=G=r.clone(),G.right=i.x-M[0];for(let X=0;X<_.length;X++){if(L&&X==2&&(t[L]=F),G=T[o=_[X].zone],t=t.alignTo({target:i,offsets:M,align:_[X].align}),t.constrainTo(G,!0)&&(Y.push({result:t,zone:o}),!A||t.width<c.width||t.height<c.height)){t.align=_[X].align;break}if(!A||G.area>A.area){const U=t.clone();switch(o){case 0:U.moveTo(null,G.bottom-U.height);break;case 1:U.moveTo(G.left);break;case 2:U.moveTo(null,G.top);break;case 3:U.moveTo(G.right-U.width);break}A={area:G.area,result:U,zone:o}}}Y.length?(Y.length>1&&!g&&Y.sort((X,U)=>{const te=Math.sqrt((I.x-X.result.x)**2+(I.y-X.result.y)**2),de=Math.sqrt((I.x-U.result.x)**2+(I.y-U.result.y)**2);return te-de}),t=Y[0].result,o=Y[0].zone):(t=A.result,o=A.zone,u&&t.constrainTo(r))}else o=S.startZone;if(t.zone=o,t.overlap=H=t.intersect(i,!0),h&&!H){if(!l){const I=o&1,Y=I?"y":"x",G=I?"bottom":"right",A=Math.max(i[Y],t[Y]),X=Math.min(i[G],t[G]);let U=A+(X-A)/2-h[0]/2;const te=U+h[0];te>t[G]&&(U-=te-t[G]),U<t[Y]&&(U+=t[Y]-U),l={[Y]:U-t[Y],edge:Ji[(o+2)%4]}}t.anchor=l}}return t}getAlignmentPoint(e,t=il){const i=this,r=Hu.exec(e),n=r[1].toLowerCase(),l=Math.min(Math.max(parseInt(r[2]||50),0),100)/100;switch(n){case"t":return[i.x+i.width*l,i.y-t[1]];case"r":return[i.right+t[0],i.y+i.height*l];case"b":return[i.x+i.width*l,i.bottom+t[1]];case"l":return[i.x-t[0],i.y+i.height*l];case"c":return[i.x+i.width/2,i.y+i.height/2]}}highlight(){const e=this,t=v.createElement({parent:document.body,style:`position:absolute;z-index:9999999;pointer-events:none;
                            left:${e.x}px;top:${e.y}px;width:${e.width}px;height:${e.height}px`});return v.highlight(t).then(()=>t.remove())}visualize(e,t){const i=this,r=w.merge({style:{left:`${i.x}px`,top:`${i.y}px`,width:`${i.width}px`,height:`${i.height}px`,pointerEvents:"none",...e.class?{}:{position:"absolute","z-index":9999999}}},e);return t?r:v.createElement(r)}toString(e=","){return[`${this.top}px`,`${this.right}px`,`${this.bottom}px`,`${this.left}px`].join(e)}},nt=class extends K{static from(s){const e=s.changedTouches,t=e?e[0].screenX:s.screenX,i=e?e[0].screenY:s.pageY;return new this.constructor(t,i)}constructor(s,e){super(s,e,0,0)}constrain(s){return this.x=Math.min(Math.max(this.x,s.x),s.right-1),this.y=Math.min(Math.max(this.y,s.y),s.bottom-1),this}toArray(){return[this.x,this.y]}};K._$name="Rectangle";function Gu(s,e){const t=w.getPropertyDescriptor(s,e);return t&&(t.get||t.set)?t:null}var $t=class extends R.mixin(De,ti){static get configurable(){return{clientListeners:null,disabled:!1,client:null,keyMap:null}}updateClient(s){this.owner||(this.owner=s)}updateKeyMap(s){const{client:e}=this;e.keyMap=e.mergeKeyMaps(e.keyMap,s,k.uncapitalize(this.constructor.$name))}static initPlugins(s,...e){const t=s.plugins||(s.plugins={});for(const i of e)t[i.$$name]=new i(s)}get enabled(){return!this.disabled}getFocusRevertTarget(){var s;return(s=this.client)==null?void 0:s.getFocusRevertTarget()}construct(...s){const e=this;let[t,i]=s,r;s.length===1?w.isObject(t)&&(i=t,t=i.client):(i=w.assign({},i),delete i.client),e.client=t,super.construct(i),e.applyPluginConfig(t),r=e.clientListeners,r&&(r=w.assign({},r),r.thisObj=e,t.ion(r))}applyPluginConfig(s){const e=this,t=e.pluginConfig||e.constructor.pluginConfig;if(t){const{assign:i,chain:r,after:n,before:l,override:a}=t;i&&e.applyAssign(s,i),(r||n)&&e.applyChain(s,r||n),l&&e.applyChain(s,l,!1),a&&e.applyOverride(s,a)}}applyAssign(s,e){e.forEach(t=>this.assign(s,t))}applyChain(s,e,t=!0){if(Array.isArray(e))for(const i of e)this.chain(s,i,i,t);else for(const i in e)this.chain(s,i,e[i],t)}applyOverride(s,e){const t=this;t.overridden||(t.overridden={}),e.forEach(i=>{if(!t[i])throw new Error(`Trying to chain fn ${s.$$name}#${i}, but plugin fn ${t.$$name}#${i} does not exist`);typeof s[i]=="function"&&(t.overridden[i]=s[i].bind(s)),s[i]=t[i].bind(t)})}assign(s,e){const t=this,i=Gu(t,e);i?Object.defineProperty(s,e,{configurable:!0,enumerable:!0,get:i.get&&i.get.bind(t),set:i.set&&i.set.bind(t)}):s[e]=t[e].bind(t)}chain(s,e,t,i=!0){let r=0;typeof e=="object"&&(e=e.fn),typeof t=="object"&&(r=t.prio||0,t=t.fn);const n=this,l=s.pluginFunctionChain||(s.pluginFunctionChain={}),a=n[t]&&n[t].bind(n),o=n.functionChainRunner;if(!a)throw new Error(`Trying to chain fn ${s.$$name}#${t}, but plugin fn ${n.$$name}#${t} does not exist`);if(!l[e]){let u=s[e];u&&(u=u.bind(s),u.$this=s,u.$prio=0),l[e]=u?[u]:[],s[e]=(...c)=>o(l[e],c)}a.$this=n,a.$prio=r,l[e][i?"push":"unshift"](a),l[e].$sorted=!1}functionChainRunner(s,e){let t,i,r;for(s.$sorted||(s.sort((n,l)=>l.$prio-n.$prio),s.$sorted=!0),i=0;i<s.length&&(t=s[i],!(!t.$this.isDestroyed&&(r=t(...e),r===!1)));i++);return r}doDisable(s){var e,t,i,r;const n=this,{constructor:l}=n,a="featureClass"in l?l.featureClass:`b-${l.$$name.toLowerCase()}`,o=k.uncapitalize(l.$$name);a&&((t=(e=n.client)==null?void 0:e._element)==null||t.classList[s?"remove":"add"](a)),n.isConfiguring||(s?n.trigger("disable"):n.trigger("enable"),(r=(i=n.client).syncSplits)==null||r.call(i,u=>{const c=u.features[o];c&&(c.disabled=s)}))}updateDisabled(s){this.doDisable(s)}throwOverrideIsMissing(s){throw new Error(`Trying to override fn ${s.plugIntoName}#${s.fnName}, but plugin fn ${s.pluginName}#${s.fnName} does not exist`)}get rootElement(){return this.client.rootElement}};x($t,"$name","InstancePlugin"),$t._$name="InstancePlugin";var sl=s=>class extends(s||R){static get $name(){return"Pluggable"}get plugins(){return this._plugins||(this._plugins={}),this._plugins}set plugins(t){t&&(Array.isArray(t)||(t=[t]),$t.initPlugins(this,...t)),this.initPlugins()}initPlugins(){}addPlugins(...t){$t.initPlugins(this,...t)}hasPlugin(t){return this.getPlugin(t)!=null}getPlugin(t){var i;return typeof t=="function"&&(t=t.$$name),(i=this.plugins)==null?void 0:i[t]}get widgetClass(){}},{defineProperty:rs}=Reflect,Qi;j.isBrowserEnv?Qi=globalThis.performance:Qi={now(){return new Date().getTime()}};var J=null;if(le.isTestEnv){const s=globalThis.bryntum||(globalThis.bryntum={});J=s.globalDelays={timeouts:new Map,intervals:new Map,animationFrames:new Map,idleCallbacks:new Map,isEmpty(e=!1){return J.timeouts.size+J.animationFrames.size+J.idleCallbacks.size+(e?J.intervals.size:0)===0},getFiltered({ignoreTimeouts:e=[],maxDelay:t=5e3,includeIntervals:i=!1}){const r=[],n=["timeouts","animationFrames","idleCallbacks"];i&&n.push("intervals");for(const l of n){const a=J[l];for(const[,o]of a.entries())!e.includes(o.name)&&(!Number.isInteger(o.delay)||o.delay<t)&&r.push(o)}return r}}}var ui=(s,e,t,i)=>{const r=typeof e=="string",n=(i==null?void 0:i.appendArgs)||[],l=()=>{t.timerId=null,t.lastCallTime=Qi.now();const a=t.args;t.args=null,r?s[e](...a,...n):e.call(s,...a,...n),t.called=!0,++t.calls};return i&&(s=i.thisObj||s),t.lastCallTime=-9e9,t.calls=0,t.invoker=l,l.wrapFn=t,l},er=(s,e,t="clearTimeout")=>(e.cancel=()=>{e.isPending&&(s[t](e.timerId),e.args=e.timerId=null)},e.flush=()=>{e.isPending&&(s[t](e.timerId),e.timerId=null,e.invoker())},e.now=(...i)=>{e.cancel(),e.args=i,e.invoker()},e.resume=i=>{const r=e.suspended;e.suspended=i||r<1?0:r-1},e.suspend=()=>{++e.suspended},e.immediate=!1,e.suspended=0,e.timerId=null,rs(e,"isPending",{get(){return e.timerId!==null}}),e),lt=s=>class extends(s||R){static get $name(){return"Delayable"}static get declarable(){return["delayable"]}doDestroy(){const t=this;super.doDestroy(),t.timeoutIds&&(t.timeoutIds.forEach((i,r)=>{typeof i=="function"&&i(),clearTimeout(r),J==null||J.timeouts.delete(r)}),t.timeoutIds=null),t.timeoutMap&&(t.timeoutMap.forEach((i,r)=>clearTimeout(r)),t.timeoutMap=null),t.intervalIds&&(t.intervalIds.forEach(i=>{clearInterval(i),J==null||J.intervals.delete(i)}),t.intervalIds=null),t.animationFrameIds&&(t.animationFrameIds.forEach(i=>{cancelAnimationFrame(i),J==null||J.animationFrames.delete(i)}),t.animationFrameIds=null),t.idleCallbackIds&&(t.idleCallbackIds.forEach(i=>{cancelIdleCallback(i),J==null||J.idleCallbacks.delete(i)}),t.idleCallbackIds=null)}hasTimeout(t){var i;return!!((i=this.timeoutMap)!=null&&i.has(t))}setTimeout({fn:t,delay:i,name:r,runOnDestroy:n,cancelOutstanding:l,args:a}){(arguments.length>1||typeof arguments[0]=="function")&&([t,i,r,n]=arguments),typeof t=="string"?r=t:r||(r=t.name||t),l&&this.clearTimeout(r);const o=this,u=o.timeoutIds||(o.timeoutIds=new Map),c=o.timeoutMap||(o.timeoutMap=new Map),d=setTimeout(()=>{typeof t=="string"&&(t=o[r]),u==null||u.delete(d),c==null||c.delete(r),J==null||J.timeouts.delete(d),t.apply(o,a)},i);return u.set(d,n?t:!0),J==null||J.timeouts.set(d,{fn:t,delay:i,name:r}),r&&c.set(r,d),d}clearTimeout(t){var i;let r=t;if(typeof r=="string")if(this.timeoutMap)r=this.timeoutMap.get(t),this.timeoutMap.delete(t);else return;clearTimeout(r),(i=this.timeoutIds)==null||i.delete(r),J==null||J.timeouts.delete(r)}clearInterval(t){var i;clearInterval(t),(i=this.intervalIds)==null||i.delete(t),J==null||J.intervals.delete(t)}setInterval(t,i,r){const n=setInterval(t,i);return(this.intervalIds||(this.intervalIds=new Set)).add(n),J==null||J.intervals.set(n,{fn:t,delay:i,name:r}),n}requestAnimationFrame(t,i=[],r=this){const n=this.animationFrameIds||(this.animationFrameIds=new Set),l=requestAnimationFrame(()=>{J==null||J.animationFrames.delete(l),n.delete(l)&&t.apply(r,i)});return n.add(l),J==null||J.animationFrames.set(l,{fn:t,extraArgs:i,thisObj:r}),l}requestIdleCallback(t,i=[],r=this){const n=this.idleCallbackIds||(this.idleCallbackIds=new Set),l=requestIdleCallback(()=>{J==null||J.idleCallbacks.delete(l),n.delete(l)&&t.apply(r,i)});return n.add(l),J==null||J.idleCallbacks.set(l,{fn:t,extraArgs:i,thisObj:r}),l}createOnFrame(t,i=[],r=this,n){let l;const a=(...o)=>{l!=null&&n&&(this.cancelAnimationFrame(l),l=null),l==null&&(l=this.requestAnimationFrame(()=>{typeof t=="string"&&(t=r[t]),l=null,o.push(...i),t.apply(r,o)}))};return a.cancel=()=>this.cancelAnimationFrame(l),a}cancelAnimationFrame(t){var i;cancelAnimationFrame(t),(i=this.animationFrameIds)==null||i.delete(t),J==null||J.animationFrames.delete(t)}cancelIdleCallback(t){var i;cancelIdleCallback(t),(i=this.idleCallbackIds)==null||i.delete(t),J==null||J.idleCallbacks.delete(t)}async nextAnimationFrame(){return new Promise(t=>this.requestAnimationFrame(t))}buffer(t,i){let r=i;i&&typeof i!="number"?r=i.delay:i=null;const n=(...a)=>{if(n.suspended)return;const{delay:o}=n;n.cancel(),n.called=!1,n.args=a,n.immediate||!o?l():n.timerId=this.setTimeout(l,o)},l=ui(this,t,n,i);return n.delay=r,er(this,n)}raf(t,i){let r=i;i&&typeof i!="boolean"?r=i.cancelOutstanding:i=null;const n=(...a)=>{n.suspended||(n.cancelOutstanding&&n.cancel(),n.called=!1,n.args=a,n.immediate?l():n.isPending||(n.timerId=this.requestAnimationFrame(l)))},l=ui(this,t,n,i);return n.cancelOutstanding=r,er(this,n,"cancelAnimationFrame")}idle(t,i){let r=i;i&&typeof i!="boolean"?r=i.cancelOutstanding:i=null;const n=(...a)=>{n.suspended||(n.cancelOutstanding&&n.cancel(),n.called=!1,n.args=a,n.immediate?l():n.isPending||(n.timerId=this.requestIdleCallback(l)))},l=ui(this,t,n,i);return n.cancelOutstanding=r,this.setTimeout(()=>this.idleCallbackIds.delete(n.timerId)&&n.now(),100),er(this,n,"cancelIdleCallback")}throttle(t,i){let r=i,n;i&&typeof i!="number"?(r=i.delay,n=i.throttled):i=null;const l=this,a=(...u)=>{if(a.suspended)return;const{delay:c}=a,d=Qi.now()-a.lastCallTime;a.args=u,a.immediate||d>=c?(l.clearTimeout(a.timerId),o()):(a.isPending||(a.timerId=l.setTimeout(o,c-d),a.called=!1),n&&(n.wrapFn.args=u,n()))},o=ui(l,t,a,i);return a.delay=r,n&&(n=ui(l,n,()=>{},i)),er(l,a)}static setupDelayable(t){t.setupDelayableMethods(t.delayable)}static setupDelayableMethods(t,i=null){const r=this,n=t.static,l=i||r.prototype;n&&delete t.static;for(const a in t){let o=t[a];const u=a+"Now",c=typeof o;l[u]||(l[u]=l[a]),c==="number"?o={type:"buffer",delay:o}:c==="string"&&(o={type:o}),rs(l,a,{get(){const d=this[o.type]((...f)=>{this[u](...f)},o);return rs(this,a,{value:d}),d}})}}get widgetClass(){}},Nt=class{get data(){return Object.create(null)}get keys(){return[]}clear(){}getItem(s){return null}removeItem(s){}setItem(s,e){}};Nt._$name="StateStorage";var Xu=class extends Nt{constructor(s){super(),this.prefix=s.prefix||""}get isLocal(){return!0}get data(){const s=nl(),e=this.keys;for(const t of e)s[t]=this.getItem(t);return s}get keys(){return ll(this.prefix,this.prefix.length)}clear(){const s=ll(this.prefix);for(const e of s)localStorage.removeItem(e)}getItem(s){const e=localStorage.getItem(this.prefix+s);return e===null?e:JSON.parse(e)}removeItem(s){return localStorage.removeItem(this.prefix+s)}setItem(s,e){return localStorage.setItem(this.prefix+s,JSON.stringify(e))}},Ju=class extends Nt{constructor(){super(),this.clear()}get isMemory(){return!0}get data(){return w.clone(this._data)}get keys(){return Object.keys(this._data)}clear(){this._data=nl()}getItem(s){return s in this._data?this._data[s]:null}removeItem(s){delete this._data[s]}setItem(s,e){this._data[s]=e}},nl=()=>Object.create(null),ll=(s,e=0)=>{const t=[],i=localStorage.length;for(let r,n=0;n<i;++n)r=localStorage.key(n),r.startsWith(s)&&t.push(r.slice(e));return t},al=new Nt,ss={local:Xu,memory:Ju},ci=class Ua extends R.mixin(lt,De){static get $name(){return"StateProvider"}static get configurable(){return{prefix:"bryntum-state:",storage:"local"}}static get delayable(){return{writeStatefuls:50}}static get instance(){return this._instance}static set instance(e){e==null?e=ol:((typeof e=="string"||w.isClass(e)||e instanceof Nt)&&(e={storage:e}),w.isObject(e)&&(e=new Ua(e))),this._instance=e}static setup(e){return this.instance=e,this.instance}doDestroy(){self.writeStatefuls.flush(),super.doDestroy()}get data(){return this.storage.data}set data(e){if(!e)this.clear();else for(const t in e)this.setValue(t,e[t])}clear(){return this.storage.clear(),this}changeStorage(e){if(e==null)e=al;else{if(typeof e=="string"){if(!ss[e])throw new Error(`Invalid storage type "${e}" (expected one of: "${Object.keys(ss).join('", "')}")`);e=ss[e]}w.isClass(e)&&(e=new e(this))}return e}saveStateful(e,t){(this.pendingSaves||(this.pendingSaves=[])).push([e,t]),this.writeStatefuls()}writeStatefuls(){const e=this,{pendingSaves:t}=e,i=t==null?void 0:t.length,r=[],n=[];if(e.pendingSaves=null,i){for(let l,a,o,u=0;u<i;++u)[a,l]=t[u],!a.isDestroying&&a.isSaveStatePending&&(o=a.saveState({...l,immediate:!0}),o&&(r.push(o),n.push(a)));r.length&&e.trigger("save",{stateIds:r,saved:n})}}getValue(e){return this.writeStatefuls.flush(),this.storage.getItem(e)}setValue(e,t){const i=this,{storage:r}=i,n=i.getValue(e);return t!=null?(r.setItem(e,t),i.trigger("set",{key:e,value:t,was:n})):n!==null&&(r.removeItem(e),i.trigger("remove",{key:e,was:n})),i}},ol=new ci({storage:al});ci._instance=ol,ci._$name="StateProvider";var Zu=/boolean|number|string/,ns=s=>{var e;return e=class extends(s||R){afterConstruct(){super.afterConstruct(),this.loadState()}finalizeInit(){this.loadState(),super.finalizeInit()}get isStateful(){return!0}get isStatefulActive(){return!this.statefulSuspended&&!this.isResponsivePending&&!this.isResponsiveUpdating}get state(){return this._state=this.getState()}set state(t){this._state=t,t&&this.applyState(t)}updateStatefulEvents(t){var i;const r=this,n={name:"statefulEvents",thisObj:r};if(r.detachListeners(n.name),t&&(typeof t=="string"?t=k.split(t):Array.isArray(t)||(t=w.getTruthyKeys(t)),t.length)){for(const l of t)n[l]="onStatefulEvent";(i=r.ion)==null||i.call(r,n)}}get statefulId(){const t=this,{responsiveState:i}=t;let r=t.stateId;return r==null&&t.hasGeneratedId===!1&&t.stateful!==!1&&(r=t.id),r&&i&&(r=`${r}[${i}]`),r}get statefulness(){const{stateful:t}=this;return Array.isArray(t)?w.createTruthyKeys(t):t}get stateProvider(){return this._stateProvider||ci.instance}applyState(t){t=this.pruneState(t),t&&this.setConfig(t)}getState(){const t=this,{initialConfig:i,statefulness:r,isConstructing:n}=t,{configs:l}=t.$meta,a=n?Object.setPrototypeOf(i,t.$meta.config):t;let o=null,u,c;if(r){o={};for(u in r)if(r[u]){if(c=a[u],c!=null&&c.isStateful)c=c.state;else if(!n&&(w.isDate(c)&&(c=z.format(c,"YYYY-MM-DDTHH:mm:ssZ")),l[u].equal(c,i==null?void 0:i[u])||!Zu.test(typeof c)))continue;o[u]=c}}return o}loadState(t,i){typeof t=="boolean"&&(i=t,t=null);const r=this,{statefulLoaded:n}=r;if(r.isStatefulActive&&(i||!n)){const l=r.loadStatefulData(t||(t=r.statefulId));!n&&t&&(r.defaultState=r.state,r.statefulLoaded=!0),l&&(r.state=l)}}loadStatefulData(t){var i;return t=this.isStatefulActive?t||this.statefulId:null,t&&((i=this.stateProvider)==null?void 0:i.getValue(t))}resetDefaultState(){this.defaultState&&(this.state=this.defaultState)}resumeStateful(t=!1){this.statefulSuspended=t?0:Math.max(this.statefulSuspended-1,0)}saveState(t){typeof t=="string"?t={id:t}:t=t||{};const i=this,{stateProvider:r}=i,n=t.id||i.isStatefulActive&&i.statefulId;if(n&&r)return t.immediate?(i.isSaveStatePending=!1,r.setValue(n,i.state)):i.isSaveStatePending||(i.isSaveStatePending=!0,r.saveStateful(i,t)),n}suspendStateful(){++this.statefulSuspended}onConfigChange({name:t,value:i,was:r,config:n}){if(super.onConfigChange({name:t,value:i,was:r,config:n}),!this.isConstructing&&this.isStatefulActive&&this.statefulId){const{stateful:l}=this;(Array.isArray(l)?l.includes(t):l!=null&&l[t])&&this.saveState()}}onStatefulEvent(){this.isConstructing||this.saveState()}pruneState(t){const{statefulness:i}=this;if(i){const r={};for(const n in t)i[n]&&(r[n]=t[n]);t=r}return t}get widgetClass(){}},x(e,"$name","State"),x(e,"configurable",{stateful:{value:null,$config:{merge:"classList"}},statefulEvents:{$config:{merge:"classList"},value:["stateChange"]},stateId:null,stateProvider:null}),x(e,"prototypeProperties",{statefulLoaded:!1,statefulSuspended:0}),e},ul=w.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null)),Qu={string:1,number:1},di=s=>class extends(s||R){static get $name(){return"Identifiable"}static get declarable(){return["identifiable"]}static get configurable(){return{id:""}}static setupIdentifiable(t,i){const{identifiable:r}=t;r.idMap=Object.create(null),Reflect.defineProperty(t,"identifiable",{get(){return r}})}doDestroy(){this.constructor.unregisterInstance(this),super.doDestroy()}changeId(t){return(this.hasGeneratedId=!t)?this.generateAutoId():t}updateId(t,i){const r=this,n=r.constructor;i&&n.unregisterInstance(r,i),(!r.hasGeneratedId||n.identifiable.registerGeneratedId!==!1)&&n.registerInstance(r,t)}generateAutoId(){return this.constructor.generateId(`b-${this.$$name.toLowerCase()}-`)}static get all(){return Object.values(this.identifiable.idMap)}static generateId(t="generatedId"){return t+(ul[t]=(ul[t]||0)+1)}static registerInstance(t,i=t.id){const{idMap:r}=this.identifiable;if(i in r&&!this.disableThrow)throw new Error("Id "+i+" already in use");r[i]=t}static unregisterInstance(t,i=t.id){const{idMap:r}=this.identifiable;Qu[typeof t]?delete r[t]:r[i]===t&&delete r[i]}static getById(t){const i=this.identifiable.idMap;if(i)return i[t]}static get registeredInstances(){const t=this.identifiable.idMap;return t?Object.values(t):[]}},cl=Symbol("STM_PROP"),dl={parentIndex:1},fl=s=>class extends(s||R){static get $name(){return"ModelStm"}static get defaultConfig(){return{stm:null}}joinStore(t){this.stm||(this.stm=t.stm)}unjoinStore(t,i=!1){var r;this.stm===t.stm&&(this.stm=null),(r=super.unjoinStore)==null||r.call(this,t,i)}get stm(){return this[cl]}set stm(t){this[cl]=t}beforeChronoFieldSet(t,i){var r;const n=this;return!n.inSetting&&((r=n.stm)!=null&&r.enabled)&&!dl[t]&&!n.constructor.nonPersistableFields[t]&&n.getFieldDefinition(t)?{[t]:{value:i,oldValue:n[t]}}:null}afterChronoFieldSet(t,i,r){r&&this.afterSet(t,i,!1,!1,r,!0)}shouldRecordFieldChange(t,i,r){const n=this.firstStore;return!(this.constructor.nonPersistableFields[t]||i==null&&r==null||i===r||i instanceof Date&&r instanceof Date&&i.getTime()===r.getTime()||t==="id"||t==="$PhantomId"||t==="parentId"&&n&&n.oldIdMap[i]===n.getById(r))}afterSet(t,i,r,n,l,a){const{stm:o}=this,u=this.constructor.nonPersistableFields;if(o!=null&&o.isBase&&o.enabled&&!dl[t]&&!u[t]&&l){let c;const[d,f]=Object.keys(l).reduce((g,h)=>{const{value:p,oldValue:m}=l[h];return this.shouldRecordFieldChange(h,m,p)&&(c=!0,g[0][h]=p,g[1][h]=m),g},[{},{}]);c&&o.onModelUpdate(this,d,f,a)}}beforeInsertChild(t){var i;const r=((i=super.beforeInsertChild)==null?void 0:i.call(this,t))||[],{stm:n}=this;return n!=null&&n.enabled&&r.push(t.reduce((l,a)=>(a.root===this.root&&l.set(a,{parent:a.parent,index:a.parent?a.parentIndex:void 0}),l),new Map)),r}afterInsertChild(t,i,r,n){var l;const{stm:a}=this;if(a!=null&&a.enabled){const o=r.pop();n&&a.onModelInsertChild(this,t,n,o)}(l=super.afterInsertChild)==null||l.call(this,t,i,r,n)}beforeRemoveChild(t,i){const r=super.beforeRemoveChild?super.beforeRemoveChild(t,i):[],{stm:n}=this;return n!=null&&n.enabled&&!i&&r.push(t.reduce((l,a)=>(l.set(a,{parentIndex:a.parentIndex,orderedParentIndex:a.orderedParentIndex}),l),new Map)),r}afterRemoveChild(t,i,r){var n;const{stm:l}=this;if(l!=null&&l.enabled&&!r){const a=i.pop();t&&t.length&&l.onModelRemoveChild(this,t,a)}(n=super.afterRemoveChild)==null||n.call(this,t,i,r)}},ec={includeFilteredOutRecords:!1},ls=s=>(s=s||!1,typeof s=="boolean"&&(s={includeFilteredOutRecords:s}),s||ec),hl=s=>class extends(s||R){static get $name(){return"TreeNode"}static set convertEmptyParentToLeaf(t){t===!0?t={onLoad:!0,onRemove:!0}:t===!1&&(t={onLoad:!1,onRemove:!1}),this._convertEmptyParentToLeaf=t}constructor(...t){super(...t),this.children&&(this.orderedChildren=this.orderedChildren||[])}static get convertEmptyParentToLeaf(){return this._convertEmptyParentToLeaf||{onLoad:!1,onRemove:!1}}ingestChildren(t,i=this.stores){const{inProcessChildren:r,constructor:n}=this,l=i[0];if(t===!0)return r?!0:[];if(t){t=V.asArray(t);const a=t.length,o=[];for(let u=0,c;u<a;u++)c=t[u],c=c.isModel?c:l?l.createRecord(c,!1,!0):new n(c,null,null,!0),c=l?l.processRecord(c):c,o.push(c);if(this.children===!0&&l){const u=l.createSorterFn(l.sorters);o.sort(u)}return o}}processChildren(t=this.stores){const i=this,{meta:r}=i;i.inProcessChildren=!0;const n=i.ingestChildren(i.data[i.constructor.childrenField],t);if(n){const{convertEmptyParentToLeaf:l}=i.constructor;if(l===!0||l.onLoad?n.length:Array.isArray(n)){if(r.isLeaf=!1,i.children===!0)i.children=[];else if(n.length===0){i.children=n;return}i.insertChild(n)}else n===!0?(r.isLeaf=!1,i.children=!0):i.isRoot||(r.isLeaf=i.constructor.convertEmptyParentToLeaf.onLoad)}i.inProcessChildren=!1}ancestorsExpanded(t=this.firstStore){const{parent:i}=this;return!i||i.isExpanded(t)&&i.ancestorsExpanded(t)}isExpanded(t=this.firstStore){const i=this.instanceMeta(t.id);return Object.prototype.hasOwnProperty.call(i,"collapsed")||(i.collapsed=!this.expanded),!i.collapsed}get expanded(){return this.data.expanded}get childLevel(){let t=this,i=-1;for(;t&&!t.isRoot;)++i,t=t.parent;return i}get isLeaf(){return this.meta.isLeaf!==!1&&!this.isRoot}get isParent(){return!this.isLeaf}get isLoaded(){return this.isParent&&Array.isArray(this.children)}get descendantCount(){return this.getDescendantCount()}get visibleDescendantCount(){return this.getDescendantCount(!0)}getDescendantCount(t=!1,i=this.firstStore){const{children:r}=this;return!r||!Array.isArray(r)||t&&!this.isExpanded(i)?0:r.reduce((n,l)=>n+l.getDescendantCount(t),r.length)}get allChildren(){return this.getAllChildren(!1)}get allUnfilteredChildren(){return this.getAllChildren(!0)}getAllChildren(t=!1){const{[t?"unfilteredChildren":"children"]:i}=this;return!i||i===!0?[]:i.reduce((r,n)=>(r.push(n),r.push.apply(r,t?n.allUnfilteredChildren:n.allChildren),r),[])}get firstChild(){const{children:t}=this;return(t==null?void 0:t.length)&&t[0]||null}get lastChild(){const{children:t}=this;return(t==null?void 0:t.length)&&t[t.length-1]||null}get previousSiblingsTotalCount(){let t=this.previousSibling,i=this.parentIndex;for(;t;)i+=t.descendantCount,t=t.previousSibling;return i}get previousOrderedSibling(){var t,i;return(i=(t=this.parent)==null?void 0:t.orderedChildren[this.orderedParentIndex-1])!=null?i:null}get nextOrderedSibling(){var t,i;return(i=(t=this.parent)==null?void 0:t.orderedChildren[this.orderedParentIndex+1])!=null?i:null}get root(){var t;return((t=this.parent)==null?void 0:t.root)||this}get parentId(){return this.parent&&!this.parent.isAutoRoot?this.parent.id:null}set parentId(t){const i=this,{parent:r}=i,n=t===null?i.firstStore.rootNode:i.firstStore.getById(t);n===r||!r&&!n||(i.isBatchUpdating?i.meta.batchChanges.parentId=t:n?n.appendChild(i):i.parent.removeChild(i))}static set parentIdField(t){this._parentIdField=t,Object.defineProperty(this.prototype,t,{set:function(i){this.parentId=i},get:function(){return this.parentId}})}static get parentIdField(){return this._parentIdField||"parentId"}getChildren(t){let i;return t.includeFilteredOutRecords?i=this.unfilteredChildren||this.children:t.useOrderedTree?i=this.orderedChildren:i=this.children,i}traverse(t,i,r){r=ls(r);const n=this,l=n.getChildren(r);i||t.call(n,n);for(let a=0,o=l==null?void 0:l.length;a<o;a++)l[a].traverse(t,!1,r)}traverseBefore(t,i,r){r=ls(r);const n=this,l=n.getChildren(r);for(let a=0,o=l==null?void 0:l.length;a<o;a++)l[a].traverse(t,!1,r);i||t.call(n,n)}traverseWhile(t,i,r){r=ls(r);const n=this;let l=i||t.call(n,n)!==!1;if(l){const a=n.getChildren(r);a!=null&&a.length&&(l=a.every(o=>o.traverseWhile(t,!1,r)))}return l}bubble(t,i=!1){let r=this;for(i||t.call(r,r);r.parent;)r=r.parent,t.call(r,r)}bubbleWhile(t,i=!1){let r=this,n=!0;for(i||(n=t.call(r,r));n&&r.parent;)r=r.parent,n=t.call(r,r);return n}contains(t,i=!1){return t&&typeof t=="object"&&(t=t.id),!this.traverseWhile(r=>r.id!=t,i)}getTopParent(t){let i;return t?(i=[],this.bubbleWhile(r=>(i.push(r),r.parent&&!r.parent.isRoot))):(i=null,this.bubbleWhile(r=>(i=r,r.parent&&!r.parent.isRoot))),i}appendChild(t,i=!1,r={}){return this.insertChild(t,null,i,r)}insertChild(t,i=null,r=!1,n={}){var l,a,o,u,c,d,f;const g=this,h=Array.isArray(t);if(t=V.asArray(t),typeof i=="number"&&(i=(a=(l=g.children)==null?void 0:l[i])!=null?a:null),!r&&!g.stores.every(b=>b.trigger("beforeAdd",{records:t,parent:g})!==!1))return null;t=g.ingestChildren(t);const p=(c=(u=i==null?void 0:i.parentIndex)!=null?u:(o=g.children)==null?void 0:o.length)!=null?c:0,m=(d=g.beforeInsertChild)==null?void 0:d.call(g,t),y=g.internalAppendInsert(t,i,r,n);return y.length&&g.convertToParent(r),(f=g.afterInsertChild)==null||f.call(g,p,t,m,y),h||!y?y:y[0]}convertToParent(t=!1){const i=this,r=i.isLeaf;i.meta.isLeaf=!1,i.children||(i.children=[]),r&&!i.root.isLoading&&!t&&i.signalNodeChanged({isLeaf:{value:!1,oldValue:!0}})}signalNodeChanged(t,i=this.stores){i.forEach(r=>{r.trigger("update",{record:this,records:[this],changes:t}),r.trigger("change",{action:"update",record:this,records:[this],changes:t})})}tryInsertChild(){return this.insertChild(...arguments)}internalAppendInsert(t,i,r,n){const l=this,{stores:a,root:o,children:u}=l,{firstStore:c}=o,{parentIdField:d}=l.constructor,f=l.id;let g,h,p,m,y,b;if(!o.isLoading&&c)for(b={},y=[],p=0;p<t.length;p++){const S=t[p];b[S.id]=S.root===o,y[p]=S.parentIndex}if(i&&i.parent!==l&&(i=null),u){const S=i?i.parentIndex:u.length;if(u[h=S]===t[0]||u[h=S-1]===t[0])for(g=!0,p=0;g&&p<t.length;p++)t[p]!==u[h+p]&&(g=!1)}if(g)return t;for(p=0;p<t.length;p++){const S=t[p],C=S.parent;if(c&&!o.isLoading&&S.traverse(T=>{T.root===o&&(b[T.id]=!0)}),(C==null?void 0:C.removeChild(S,b==null?void 0:b[S.id],r,{isInserting:!0,...n}))===!1)m||(t=t.slice(),m=!0),t.splice(p--,1);else{S.parent=l,S.data[d]=f;const{meta:T}=S;T.modified[d]===f&&!C&&(T.oldParentId=f),C&&(T.oldParentId=C.id)}}if(t.length){Array.isArray(u)||(l.children=[]),Array.isArray(l.orderedChildren)||(l.orderedChildren=[]);const S=l.addToChildren(i,t,n);a.forEach(C=>{C.isChained||(t.forEach(T=>{T.joinStore(C)}),C.onNodeAddChild(l,t,S,b,r),t.forEach((T,_)=>{if(T.meta.oldParentId!=null&&!(l.inProcessChildren||l.isLoading)){const L={[d]:f,[l.getDataSource("parentIndex")]:T.parentIndex},F={},{modified:O,oldParentId:M}=T.meta,P=y[_];if(delete T.meta.oldParentId,l.id!==M&&(F[d]={value:f,oldValue:M}),T.parentIndex!==P&&(F.parentIndex={value:T.parentIndex,oldValue:P}),O[d]===l.id?Reflect.deleteProperty(O,d):d in O||(O[d]=M),b[T.id]){const W=C.getById(M);W.isLeaf&&!r&&W.signalNodeChanged({isLeaf:{value:!0,oldValue:!1}},[C])}T.afterChange(L,F)}T.traverse(L=>{!L.ignoreBag&&!L.isLinked&&C.updateModifiedBagForRecord(L)})}))})}return t}removeChild(t,i=!1,r=!1,n={}){var l,a;const o=this,u=[],c=o.isLeaf,{children:d,stores:f}=o;if(t=V.asArray(t),t=t.filter(h=>h.parent===o),!r){for(const h of f)if(!h.isChained&&h.trigger("beforeRemove",{parent:o,records:t,isMove:i})===!1)return!1}const g=(l=o.beforeRemoveChild)==null?void 0:l.call(o,t,i);for(const h of t){const{parentIdField:p}=h.constructor,{modified:m}=h.meta,y=h.parent?h.parent.id:null;!(p in m)&&!h.isLinked&&(m[p]=y);const b=o.removeFromChildren(h,n);f.forEach(S=>{if(!S.isChained){const{isRemoving:C}=S;S.isRemoving=!0,u.push(...S.onNodeRemoveChild(o,[h],b,{isMove:i,silent:r})),S.isRemoving=C}}),i||(h.parent=h.parentIndex=h.unfilteredIndex=h.nextSibling=h.previousSibling=null,h.data[p]=null)}return(o.unfilteredChildren||d).length===0&&o.constructor.convertEmptyParentToLeaf.onRemove&&!o.isRoot&&(o.meta.isLeaf=!0),o.isLeaf!==c&&!r&&!i&&o.signalNodeChanged({isLeaf:{value:!0,oldValue:!1}}),(a=o.afterRemoveChild)==null||a.call(o,t,g,i),u}clearParentId(){const t=this;Reflect.deleteProperty(t.data,t.parentIdField),Reflect.deleteProperty(t.originalData,t.parentIdField),t.meta.modified&&Reflect.deleteProperty(t.meta.modified,t.parentIdField)}replaceChildren(t){return this.clearChildren(),this.data[this.constructor.childrenField]=t,this.processChildren(),this.children}clearChildren(t=!1){const i=this,{stores:r}=i,n=i.unfilteredChildren||i.children;i.children=[],i.orderedChildren=[],n&&n!==!0&&(r.forEach(l=>{l.isChained||l.onNodeRemoveChild(i,n,0,{unfiltered:!0,silent:t})}),i.unfilteredChildren&&(i.unfilteredChildren=[]))}clear(){var t;const i=this,{stores:r}=i,n=(t=i.children)==null?void 0:t.slice();if(!(!i.isRoot||!n)){for(const l of r)if(!l.isChained&&l.trigger("beforeRemove",{parent:i,records:n,isMove:!1,removingAll:!0})===!1)return!1;i.children.length=0,i.unfilteredChildren&&(i.unfilteredChildren.length=0),r.forEach(l=>{n.forEach(a=>{a.stores.includes(l)&&a.unjoinStore(l),a.parent=a.parentIndex=a.nextSibling=a.previousSibling=null}),l.storage.suspendEvents(),l.storage.clear(),l.storage.resumeEvents(),l.added.clear(),l.modified.clear(),l.trigger("removeAll"),l.trigger("change",{action:"removeall"})})}}updateChildrenIndices(t,i,r=!1){let n=null;for(let l=0;l<t.length;l++){const a=t[l],o=a[i];i==="parentIndex"||i==="orderedParentIndex"?o===void 0||r?a.setData(i,l):o!==l&&a.set(i,l,!0):a[i]=l,i==="parentIndex"&&(a.previousSibling=n,n&&(n.nextSibling=a),l===t.length-1&&(a.nextSibling=null),n=a)}}addToChildren(t,i,r={}){var n;const l=this,a=[[l.children,"parentIndex",t],[l.unfilteredChildren,"unfilteredIndex",t],[l.orderedChildren,"orderedParentIndex",(r==null?void 0:r.orderedBeforeNode)===void 0?(r==null?void 0:r.orderedParentIndex)!==void 0?l.orderedChildren[r==null?void 0:r.orderedParentIndex]:t:r==null?void 0:r.orderedBeforeNode]];for(const o of a){const[u,c,d]=o;if(u){const f=d?c==="orderedParentIndex"?u.indexOf(d):d[c]:u.length;o.push(f),u.splice(f,0,...i),(n=r==null?void 0:r[c])!=null&&n.skip||l.updateChildrenIndices(u,c)}}return a[0][3]}removeFromChildren(t,i){var r;const n=[[this.children,"parentIndex"],[this.unfilteredChildren,"unfilteredIndex"],[this.orderedChildren,"orderedParentIndex"]];for(const l of n){const[a,o]=l;if(a){const u=a.indexOf(t);l.push(u),u>-1&&(a.splice(u,1),(r=i==null?void 0:i[o])!=null&&r.skip||this.updateChildrenIndices(a,o))}}return n[0][2]}sortOrderedChildren(t=!0,i=!1){const r=[];return this.isLeaf||(this.orderedChildren.sort((n,l)=>{var a,o;if(i){const u=(a=n.meta.modified.orderedParentIndex)!=null?a:n.orderedParentIndex,c=(o=l.meta.modified.orderedParentIndex)!=null?o:l.orderedParentIndex,d=u-c;return d!==0&&(r.push(n),r.push(l)),d}else return n.orderedParentIndex-l.orderedParentIndex}),t&&this.orderedChildren.forEach(n=>{r.push(...n.sortOrderedChildren(t,i))}),this.updateChildrenIndices(this.orderedChildren,"orderedParentIndex",!0)),new Set(r)}sortVisibleChildren(t=!0,i){const r=this;r.isLeaf||(r.children.sort(i),t&&r.orderedChildren.forEach(n=>n.sortVisibleChildren(t,i)),r.updateChildrenIndices(r.children,"parentIndex",!0))}sortUnfilteredChildren(t=!0,i){const r=this;!r.isLeaf&&r.unfilteredChildren&&(r.unfilteredChildren.sort(i),t&&r.orderedChildren.forEach(n=>n.sortUnfilteredChildren(t,i)),r.updateChildrenIndices(r.unfilteredChildren,"unfilteredIndex",!0))}unjoinStore(t,i=!1){var r;const n=this;n.unfilteredChildren&&(n.children=n.unfilteredChildren.slice(),n.unfilteredChildren=null),(r=super.unjoinStore)==null||r.call(this,t,i)}},gl={id:1,stores:1,parentIndex:1,parent:1,previousSibling:1,nextSibling:1,unfilteredIndex:1},tc={get(s,e){return e==="proxyMeta"?this.proxyMeta:e==="constructor"?s.constructor:e==="setData"?this.setDataOverride:e==="set"?this.setOverride:gl[e]?this.proxyMeta.data[e]:Reflect.get(s,e,this.proxyRecord)},set(s,e,t){return gl[e]?this.proxyMeta.data[e]=t:s[e]=t,!0},setDataOverride(s,e){s==="parentIndex"?this.proxyMeta.data.parentIndex=e:this.proxyMeta.originalRecord.setData(s,e)},setOverride(s,e,...t){s==="parentIndex"?this.proxyMeta.data.parentIndex=e:this.proxyMeta.originalRecord.set(s,e,...t)}},pl=s=>{var e;return e=class extends(s||R){link(){if(this.isLinked)return this.$original.link();const t=this,i={...tc,proxyMeta:{originalRecord:t,data:{id:`${t.id}_link_${k.generateUUID()}`,stores:[]}}},r=new Proxy(t,i);return i.proxyRecord=r,(t.meta.linkedRecords||(t.meta.linkedRecords=[])).push(r),r}get isLinked(){var t;return!!((t=this.proxyMeta)!=null&&t.originalRecord)}get hasLinks(){return!!(!this.proxyMeta&&this.$links.length)}removeLink(t,i=null,r=!1){if(t.hasLinks)for(const n of t.$links.slice())i?V.include(i,n):n.remove(r);else t.isLinked&&V.remove(t.$original.$links,t)}beforeRemove(t){this.removeLink(this,t)}removeChild(t,i,r,n){if(!(n!=null&&n.isInserting)){t=V.asArray(t);for(const l of t)this.removeLink(l,null,r)}return super.removeChild(t,i,r,n)}get $originalId(){return this.$original.id}get $links(){var t;return(t=this.meta.linkedRecords)!=null?t:[]}},x(e,"$name","ModelLink"),x(e,"isModel",!0),e},{defineProperty:ml}=Reflect,as=Symbol("owner"),ic=/[\s,]+/,Vt=s=>class extends(s||R){static get $name(){return"Factoryable"}static get declarable(){return["factoryable","alias","type"]}static register(t,i,r=globalThis.__BRYNTUM_EXAMPLE){const{factoryable:n}=this.initClass(),{caseless:l,registry:a}=n,o=k.split(t,ic);for(let u,c,d=0;d<o.length;++d){if(c=o[d],u=l?c.toLowerCase():c,!r&&u in a)throw new Error(`Type "${c}" already registered with ${n.class.name} factory`);a[c]=a[u]=i.initClass()}}static isA(t,i){return this.isType(t,i,!0)}static isType(t,i,r){const{factoryable:n}=this,{caseless:l,registry:a}=n,o=a[l?i.toLowerCase():i];return o?r?t instanceof o:t.constructor===o:!1}static setupAlias(t){t.register(t.alias,t)}static setupFactoryable(t,i){const r=i.super.class;let{factoryable:n}=t;n={caseless:!0,defaultType:null,extends:r.factoryable?[r]:null,typeKey:"type",...n},n.class=t,n.registry=Object.create(null),n.extends&&!Array.isArray(n.extends)&&(n.extends=[n.extends]),ml(t,"factoryable",{get(){return n}})}static setupType(t,i){const{type:r}=t;t.register(r,t,i.replaceType),ml(t.prototype,"type",{value:r})}static create(t,i){return this.reconfigure(null,t,i)}static reconfigure(t,i,r){const n=this,{factoryable:l}=n,{typeKey:a}=l;let o=r,u,c,d,f,g,h,p,m,y;if(r&&!w.isClass(r)&&(o=null,p=typeof r,p==="function"?h=r:p==="string"?o=r:w.isObject(r)?(u=r.cleanup,c=r.defaults,f=r.owner,h=r.setup,o=r.type,m=r.transform):f=r),m&&(i=typeof m=="string"?f[m](i):m(i)),y=i,typeof y=="string")i={};else if(i){if(i===!0&&(i={}),!w.isObject(i))return f&&i!==t&&(t==null?void 0:t[as])===f&&(typeof u=="string"?f[u](t):u==null||u(t),t.destroy()),i;y=i[a]}if(y=y&&n.resolveType(y),t){if(i&&(!y||t.constructor===y))return a in i&&(i=w.assign({},i),delete i[a]),t.setConfig(i),t;f&&t[as]===f&&(typeof u=="string"?f[u](t):u==null||u(t),t.destroy())}if(i){if(c){if(!(d=y)){if(!(d=c[a]||o||l.defaultType))throw new Error(`No default mergeType defined for ${l.class.name} factory`);d=n.resolveType(d)}d&&(i=d.mergeConfigs(c,i))}if(h){if(g=typeof h=="string"?f[h](i,y,c):h(i,y,c),g===null)return g;i=g||i}if(!y){if(!(y=i[a]||o||l.defaultType))throw new Error(`No default type defined for ${l.class.name} factory`);y=n.resolveType(y)}c&&!d&&(i=y.mergeConfigs(c,i)),a in i&&(i=w.assign({},i),delete i[a]),i=new y(i),f&&(i[as]=f)}return i||null}static resolveType(t,i){if(typeof t!="string")return t;const{factoryable:r}=this,n=r.extends;let l=r.registry[r.caseless?t.toLowerCase():t],a;for(a=0;!l&&n&&a<n.length;++a)l=n[a].resolveType(t,!0);if(!l&&!i)throw new Error(`Invalid type name "${t}" passed to ${r.class.name} factory`);return l}},{getOwnPropertyDescriptor:rc}=Reflect,Me=class extends R.mixin(Vt){static get $name(){return"DataField"}static get type(){return"auto"}static get factoryable(){return{defaultType:"auto"}}static get prototypeProperties(){return{compare:null,compareItems:null,dataSource:null,alwaysWrite:!1,nullable:!0,nullText:null,nullValue:void 0,persist:!0,readOnly:!1,internal:!1,useProp:null}}construct(s){const e=this;s&&(e.name=s.name,Object.assign(e,s)),e.compare&&(e.compareItems=(t,i)=>e.compare(t==null?void 0:t[e.name],i==null?void 0:i[e.name]))}defineAccessor(s,e){const{name:t,dataSource:i}=this;!e&&t in s&&s.$meta.hierarchy.some(r=>{var n;return((n=rc(r.prototype,t))==null?void 0:n.enumerable)===!1})||Reflect.defineProperty(s,t,{configurable:!0,enumerable:!0,get:this.complexMapping?function(){return this.complexGet(t,i)}:function(){return this.batching&&t in this.meta.batchChanges?this.meta.batchChanges[t]:i in this.data?this.data[i]:this.data[t]},set(r){const n=this.$meta.fields.map[t];n&&n.readOnly||this.set(t,r)}})}isEqual(s,e){return w.isEqual(s,e)}print(s){return s==null?this.nullText:this.printValue(s)}printValue(s){return String(s)}};Me._$name="DataField";var fi=class extends Me{isEqual(s,e){return s===e}getAt(s,e){return s.get(this.name)[e]}};x(fi,"$name","ArrayDataField"),x(fi,"type","array"),fi.initClass(),fi._$name="ArrayDataField";var zt=class extends Me{static get prototypeProperties(){return{nullValue:!1}}isEqual(s,e){return s==null&&e==null?!0:super.isEqual(s,e)}convert(s){var e;return s==null?this.nullable?s:this.nullValue:((e=s.toLowerCase)==null?void 0:e.call(s))==="false"?!1:!!s}};x(zt,"$name","BooleanDataField"),x(zt,"type","boolean"),x(zt,"alias","bool"),zt.initClass(),zt._$name="BooleanDataField";var os=class extends Me{static get $name(){return"DateDataField"}static get type(){return"date"}static get prototypeProperties(){return{format:null}}convert(s){return s==null?this.nullable||(s=this.nullValue):s==="now"?s=new Date:s instanceof Date||(s=z.parse(s,this.format||z.defaultParseFormat),(!s||isNaN(s))&&(s=void 0)),s}serialize(s){return s instanceof Date&&(s=z.format(s,this.format||z.defaultFormat)),s}printValue(s){return z.format(s,this.format||z.defaultFormat)}};os.initClass(),os._$name="DateDataField";var tr=class extends Me{static get $name(){return"StringDataField"}static get type(){return"string"}static get prototypeProperties(){return{nullValue:""}}convert(s){return s==null?this.nullable?s:this.nullValue:String(s)}};tr.initClass(),tr._$name="StringDataField";var Bt=class extends Me{static get prototypeProperties(){return{nullValue:0,rounding:"round"}}convert(s){return s==null?this.nullable?s:this.nullValue:Math[this.rounding](Number(s))}};x(Bt,"$name","IntegerDataField"),x(Bt,"type","integer"),x(Bt,"alias","int"),Bt.initClass(),Bt._$name="IntegerDataField";var ir=class extends Me{static get $name(){return"ModelDataField"}static get type(){return"model"}static get prototypeProperties(){return{complexMapping:!0}}isEqual(s,e){return s&&e&&e instanceof s.constructor&&e.id==s.id}};x(ir,"configurable",{modelClass:null}),ir.initClass(),ir._$name="ModelDataField";var jt=class extends Me{static get prototypeProperties(){return{nullValue:0,precision:null}}isEqual(s,e){return isNaN(Number(s))&&isNaN(Number(e))||super.isEqual(s,e)}convert(s){if(s==null)return this.nullable?s:this.nullValue;if(s=Number(s),isNaN(s))return;let e=this.precision;return e?(e=10**e,s=Math.round(s*e)/e):e===0&&(s=Math.round(s)),s}};x(jt,"$name","NumberDataField"),x(jt,"type","number"),x(jt,"alias","float"),jt.initClass(),jt._$name="NumberDataField";var us=class extends Me{static get $name(){return"ObjectDataField"}static get type(){return"object"}static get prototypeProperties(){return{complexMapping:!0}}};us.initClass(),us._$name="ObjectDataField";var sc=s=>typeof s=="string"&&s.startsWith("_generated"),hi=class extends Me{init(s,e){var t;const i=this,r=`${i.name}Store`,n={skipStack:!0,syncDataOnLoad:!0};if(i.store&&w.assign(n,i.store),i.modelClass&&(n.modelClass=i.modelClass),(t=e[`init${k.capitalize(r)}`])==null||t.call(e,n),!n.storeClass&&!i.storeClass)throw new Error(`Field '${i.name}' with type 'store' must have a storeClass configured`);const l=e.meta[r]=new(n.storeClass||i.storeClass)(n);i.complexMapping?w.setPath(s,i.dataSource,l):s[i.dataSource]=l,l.verifyNoGeneratedIds=!1,l.usesId=!l.count||!l.every(a=>a.hasGeneratedId),l.$currentValue=i.getValue(l),l.ion({change:({action:a})=>{const o=i.getValue(l);if(!l.$isSettingStoreFieldData){const u=l.$preserveCurrentDataset;l.$preserveCurrentDataset=i.subStore&&(a==="update"||a==="remove"||a==="add"),i.$isUpdatingRecord=!0,e.set(i.name,o),i.$isUpdatingRecord=!1,l.$preserveCurrentDataset=u}l.$currentValue=o}})}set(s,e,t){var i,r;const n=this,l=`${n.name}Store`,{[l]:a}=t.meta;if(!a)return t.meta.initableValues.set(n,s),!1;a.$isSettingStoreFieldData||(a.$isSettingStoreFieldData=!0,s=(r=(i=t[`process${k.capitalize(l)}Data`])==null?void 0:i.call(t,s,t))!=null?r:s,a.$preserveCurrentDataset||(a.data=s),a.$isSettingStoreFieldData=!1,a.usesId=!a.count||!a.every(o=>o.hasGeneratedId))}serialize(s,e){const t=e.meta[`${this.name}Store`];return this.$isUpdatingRecord?this.getValue(t):t.$currentValue}getValue(s){return s.allRecords.map(e=>{const t=e.persistableData;return s.usesId||delete t.id,t})}isEqual(s,e){if(s==null&&e==null)return!0;if(s==null&&e!=null||s!=null&&e==null)return!1;if(s.isStore&&e.isStore)return w.isDeeplyEqual(s.$currentValue,e.$currentValue);if(s.isStore&&e.isStore||!s.isStore&&!e.isStore)return w.isEqual(s,e,!0);{const t=s.isStore?s:e,i=t.modelClass,r=i.$meta.fields.defs,n=s.isStore?s.$currentValue:e.$currentValue,l=s.isStore?e:s;if(n.length!==l.length)return!1;for(let a=0;a<r.length;a++){const o=r[a];if(o.persist)for(let u=0;u<n.length;u++){const c=n[u][o.dataSource],d=l[u][o.dataSource];if(!(c!==void 0&&d===void 0&&(o.dataSource===i.idField&&sc(c)||o.defaultValue!==void 0&&w.isEqual(o.defaultValue,c,!0)))&&!w.isEqual(c,d,!0))return!1}}return!0}}getOldValue(s){const e=s.meta[`${this.name}Store`];return e?w.clone(e.$currentValue):null}getAt(s,e){const t=s.meta[`${this.name}Store`];return t==null?void 0:t.getAt(e)}};x(hi,"$name","StoreDataField"),x(hi,"type","store"),hi.initClass(),hi._$name="StoreDataField";var yl=class extends tr{static get $name(){return"DurationUnitDataField"}static get type(){return"durationunit"}isEqual(s,e){return z.compareUnits(s,e)===0}};yl.initClass(),yl._$name="DurationUnitDataField";var vl=new RegExp(/^(.*?)\.(.*)/),cs=/(.*)\[(.*)]\.?(.*)/,{defineProperty:nc}=Reflect,{hasOwn:gi}=w,Re=void 0,lc={children:1,data:1,meta:1},ac=["name","title","text","label","description"],oc={boolean:1,number:1,date:1,object:1},bl={parentId:1,$PhantomId:2,id:3},Cl=class Ws extends R.mixin(fl,hl,pl){static get $name(){return"Model"}static get declarable(){return["fields"]}static get fields(){return[{name:"parentIndex",type:"number",persist:!1,internal:!0},{name:"orderedParentIndex",type:"number",persist:!1,internal:!0},{name:"readOnly",type:"boolean"},{name:"expanded",internal:!0},{name:"groupParent",persist:!1,internal:!0}]}static set idField(e){this._assignedIdField=!0,this._idField=e}static get idField(){return this._idField}static set childrenField(e){this._childrenField=e}static get childrenField(){if(!this._childrenField){const e=this.fieldMap.children;this._childrenField=(e==null?void 0:e.dataSource)||"children"}return this._childrenField}get indexPath(){const e=[];let t=this,i=t.childLevel;for(t=this;t&&!t.isRoot;t=t.parent)e[i--]=t.parentIndex+1;return e}construct(e={},t=null,i=null,r=!1,n=!1,l=!1){var a,o;const u=this,c=(a=V.asArray(t))!=null?a:[],{constructor:d,fieldMap:f}=u;let g=null;if(t=c[0],u.meta={modified:{},...d.metaConfig,...i},d.applyConfigs){g={},(!u.useRawData||!u.useRawData.enabled)&&(e={...e});const h=u.getDefaultConfiguration();if(d.autoExposeFields)for(const p in h)p in e&&(e[p]!==void 0&&(g[p]=e[p]),delete e[p]);else for(const p in e)p in d.fieldMap||(e[p]===void 0?g[p]=h[p]:g[p]=e[p],delete e[p])}if(super.construct(g),r||d.exposeProperties(e,l),!gi(d,"idFieldProcessed")){let h=u.meta.idField;h||(d._assignedIdField?h=d.idField:t&&(h=t.idField)),h&&h!==f.id.dataSource&&d.addField({name:"id",dataSource:h,internal:!0}),d._idField=f.id.dataSource,d.idFieldProcessed=!0}u._internalId=Ws._internalIdCounter++,u.stores=[],u.unjoinedStores=[],u.originalData||(u.originalData=e),u.data=d.processData(e,!1,t,u,n),(o=u.meta.initableValues)!=null&&o.size&&u.assignInitables(),u.id==null&&u.setData("id",u.generateId(t)),u.data[d.childrenField]&&u.processChildren(c),u.generation=0}set isCreating(e){const t=this;!!t.meta.isCreating!==e&&(t.meta.isCreating=e,t.stores.forEach(i=>{i.onIsCreatingToggle(t,e)}))}get isCreating(){return!!this.meta.isCreating}equals(e){if(e instanceof this.constructor){for(let t=this.$meta.fields.defs,i=0,{length:r}=t;i<r;i++){const n=t[i],{name:l}=n;if(l!=="id"&&!n.isEqual(this.getValue(l),e.getValue(l)))return!1}return!0}return!1}get subclass(){return new this.constructor(Object.setPrototypeOf({id:Re},this.data),this.stores[0],null,!0)}static processData(e,t=!1,i,r,n){const{fieldMap:l,fieldDataSourceMap:a,defaultValues:o}=this,{useRawData:u={enabled:!1}}=i||{},c=n||u.enabled?e:w.clone(e);let d;if(t=t||u.disableDefaultValue||n,!t)for(d in o){const f=a[d];let g=o[d];Array.isArray(g)&&(g=g.slice()),f!=null&&f.complexMapping?w.getPath(c,d)===Re&&w.setPath(c,d,g):c[d]===Re&&(c[d]=g)}if(!u.disableTypeConversion&&!n)for(d in l){const f=l[d],{name:g,dataSource:h}=f,p=h!==g,m=f.complexMapping,y=p&&(m?w.pathExists(e,h):h in e),b=g in e&&(!p||!y),S=!u.disableTypeConversion&&f.convert;if((b||S)&&(!t||b||y)){const C=b?c[g]:m?w.getPath(c,h):c[h],T=S?f.convert(C,e,r):C;m?w.setPath(c,h,T):c[h]=T,p&&delete c[g]}}return this.$meta.fields.initable.length&&this.initInitables(r,c),c}static setupClass(e){super.setupClass(e),e.fields||this.setupFields(this,e)}static setupFields(e,t){var i,r,n,l,a;const o=gi(e,"fields")&&e.fields,u=t.super.fields,c=t.fields={defs:(i=u==null?void 0:u.defs.slice())!=null?i:[],exposedData:!1,defaults:u?{...u.defaults}:{},exposed:Object.create((r=u==null?void 0:u.exposed)!=null?r:null),ordinals:Object.create((n=u==null?void 0:u.ordinals)!=null?n:null),map:Object.create((l=u==null?void 0:u.map)!=null?l:null),sources:Object.create((a=u==null?void 0:u.sources)!=null?a:null)};gi(e,"defaults")&&Object.assign(c.defaults,e.defaults),gi(e,"idField")&&(e.addField({name:"id",dataSource:e.idField,internal:!0}),c.exposed[e.idField]=!0),o!=null&&o.length&&o.map(e.addField,e),c.initable=c.defs.filter(d=>d.init),e.exposeRelations()}static get defaultValues(){return this.$meta.fields.defaults}static get allFields(){return this.$meta.fields.defs}get allFields(){return this.$meta.fields.defs}static get fieldMap(){return this.$meta.fields.map}get fieldMap(){return this.$meta.fields.map}static get fieldDataSourceMap(){return this.$meta.fields.sources}static exposeProperties(e,t=!0){const i=this,r=i.$meta.fields,n=t?"exposed":"map";if(e&&i.autoExposeFields&&!r.exposedData){let l,a,o;for(l in e)!r[n][l]&&l!==i.childrenField&&(o=w.typeOf(e[l]),a={name:l,dataSource:l,fromData:!0},oc[o]&&(a.type=o),i.addField(a));r.exposedData=!0}i.exposeRelations()}static addField(e){if(e==null)return;typeof e=="string"&&(e={name:e});const t=this.initClass(),i=t.$meta.fields,{ordinals:r}=i,n=i.exposed,{name:l}=e,a=i.map[l],o=e.dataSource||(e.dataSource=l);let u,c;if(!a||e.type&&e.type!==a.type)u=Me.create(e),u.definedBy=a?a.definedBy:t,u.ordinal=a?a.ordinal:r[l]=i.defs.length;else{u=Object.create(a);for(c in e)c!=="type"&&(u[c]=e[c])}return u.owner=t,i.defs[u.ordinal]=u,i.map[l]=u,i.sources[o]||(i.sources[o]=u),o.includes(".")&&(u.complexMapping=!0),u.complexMapping?n[o.split(".")[0]]=!0:n[o]=!0,"defaultValue"in u&&(i.defaults[o]=u.defaultValue),lc[l]||u.defineAccessor(t.prototype),t._nonPersistableFields=null,t._alwaysWriteFields=null,u}static removeField(e){const t=this.initClass(),i=t.$meta.fields,r=i.map[e],{ordinals:n}=i,l=n[e];if(r){i.defs.splice(l,1),delete n[e],delete i.defaults[e],delete i.exposed[e],delete i.map[e],delete i.sources[r.dataSource];for(const a in n)n[a]>l&&--n[a];delete t.prototype[e]}}static exposeRelations(){const e=this;if(!gi(e,"exposedRelations")&&e.relations){e.exposedRelations=[];for(const t in e.relations){const i=e.relations[t];i.relationName=t,e.exposedRelations.push(i),Reflect.ownKeys(e.prototype).includes(t)||nc(e.prototype,t,{enumerable:!0,get:function(){return this.getForeign(t)},set:function(r){this.setForeign(t,r,i)}})}}}static initInitables(e,t){const i=e.meta.initableValues=new Map;for(const r of this.$meta.fields.initable){const n=w.getPath(t,r.dataSource);n!==void 0&&i.set(r,n),!r.lazy&&r.init(t,e)}}assignInitables(){const{initableValues:e}=this.meta;for(const[t,i]of e)t.set(i,this.data,this)!==!1&&e.delete(t)}static get autoExposeFields(){return!0}static fieldSorter(e,t){return(bl[e]||100)-(bl[t]||100)}get fields(){return this.$meta.fields.defs}getFieldDefinition(e){return this.constructor.getFieldDefinition(e)}getFieldDefinitionFromDataSource(e){return this.$meta.fields.sources[e]}get fieldNames(){return Object.keys(this.data)}static getFieldDefinition(e){var t,i;const r=this.fieldMap[e];if(!r){if(e.includes("[")){const[,n,,l]=e.match(cs),a=n.includes(".")?this.getFieldDefinition(n):this.fieldMap[n];if(a!=null&&a.isStoreDataField)return(t=a.modelClass)==null?void 0:t.getFieldDefinition(l)}else if(e.includes(".")){const[n,l]=e.split(".",2),a=this.fieldMap[n];if(a.isModelDataField&&a.modelClass)return(i=a.modelClass)==null?void 0:i.getFieldDefinition(l)}}return r}static getFieldDataSource(e){var t;return((t=this.getFieldDefinition(e))==null?void 0:t.dataSource)||e}getDataSource(e){const t=this.constructor.getFieldDefinition(e);return(t==null?void 0:t.dataSource)||(t==null?void 0:t.name)}static processField(e,t,i){const r=this.fieldMap[e];return r!=null&&r.convert?r.convert(t,this.data,i):t}initRelations(){const e=this;e.constructor.exposedRelations&&e.stores.forEach(i=>{var r;i.modelRelations||i.initRelations();const n=[];(r=i.modelRelations)==null||r.forEach(l=>{n.push({related:e.initRelation(l),config:l})}),i.updateRecordRelationCache(e,n)})}initRelation(e){const t=this,i=t.get(e.foreignKey),r=i!==Re&&typeof e.foreignStore!="string"&&e.foreignStore.getById(i),n=t.meta.relationCache||(t.meta.relationCache={});return n[e.relationName]=r||(i!=null?{id:i,placeHolder:!0}:null),r}removeRelation(e){const{relationName:t,foreignKey:i,nullFieldOnRemove:r}=e;this.meta.relationCache[t]&&(delete this.meta.relationCache[t],r&&this.setData(i,null))}getForeign(e){var t;return(t=this.meta.relationCache)==null?void 0:t[e]}setForeign(e,t,i){const r=Ws.asId(t);return this.set(i.foreignKey,r)}getRelationConfig(e){var t,i;return(i=(t=this.firstStore)==null?void 0:t.modelRelations)==null?void 0:i.find(r=>r.foreignKey===e)}flatGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:t in this.data?this.data[t]:this.data[e]}complexGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:w.getPath(this.data,t)}get(e){if(!e)return;const t=this,i=t.fieldMap[e];if(!i){if(e.includes("[")){const[,r,n,l]=e.match(cs),a=t.fieldMap[r];if(a!=null&&a.getAt){t._thisIsAUsedExpression(t[r]);const o=a.getAt(t,n);return o&&l?o.isModel?o.getValue(l):o[l]:o}return null}if(e.includes("."))return w.hasPath(t.data,e)?t.complexGet(e,e):w.getPath(t,e)}return i!=null&&i.complexMapping?t.complexGet(e,i.dataSource):t.flatGet(e,(i==null?void 0:i.dataSource)||e)}getValue(e){if(e)return e in this?this[e]:this.get(e)}setValue(e,t){e in this?this[e]=t:this.set(e,t)}setData(e,t){var i,r;const{data:n,fieldMap:l}=this;if(typeof e=="string"){const a=l[e],o=(i=a==null?void 0:a.dataSource)!=null?i:e;a!=null&&a.set?a.set(t,this.data,this):a!=null&&a.complexMapping?w.setPath(n,o,t):n[o]=t}else{const a=Object.keys(e);for(let o=0;o<a.length;o++){const u=a[o],c=l[u],d=(r=c==null?void 0:c.dataSource)!=null?r:u;c!=null&&c.set?c.set(t,this.data,this):d&&(c!=null&&c.complexMapping?w.setPath(n,d,e[u]):n[d]=e[u])}}}getData(e){var t;const i=this.fieldMap[e],r=(t=i==null?void 0:i.dataSource)!=null?t:e;if(r)return i!=null&&i.complexMapping?w.getPath(this.data,r):this.data[r]}syncId(e){const t=this.id;if(t!==e){this.setData("id",e);const i={id:{value:e,oldValue:t}};this.afterChange(i,i)}}set(e,t,i=!1,r=!1,n=!1,l=!1,a=!0){var o;const u=this;if(u.isBatchUpdating)return u.inBatchSet(e,t,i||u.$silenceBatch),null;{const c=u.inSet(e,t,i,r,n,l,a);return(o=u.afterSet)==null||o.call(u,e,t,i,r,c),c}}fieldToKeys(e,t){return typeof e!="string"?w.assign({},e):{[e]:t}}inBatchSet(e,t,i){const r=this,{meta:n,constructor:l,fieldMap:a}=r,o={};let u,c=!1;if(typeof e!="string"?Object.keys(r.fieldToKeys(e,t)).forEach(d=>{u=a[d]||w,t=l.processField(d,e[d],r),u.isEqual(n.batchChanges[d],t)||(o[d]={value:t,oldValue:r.get(d)},n.batchChanges[d]=t,c=!0)}):(u=a[e]||w,u.isEqual(n.batchChanges[e],t)||(o[e]={value:t,oldValue:r.get(e)},n.batchChanges[e]=t,c=!0)),c&&(r.generation++,!i)){const d={action:"update",record:r,records:[r],changes:o};r.stores.forEach(f=>{f.trigger("batchedUpdate",{...d})}),r.forEachLinked((f,g)=>f.trigger("batchedUpdate",{...d,record:g,records:[g]}))}}inSet(e,t,i,r,n=!1,l=!1,a=!0){var o,u,c;const d=this,{data:f,meta:g,fieldMap:h,constructor:p}=d,{prototype:m,childrenField:y,relations:b}=p,S={},C=d.fieldToKeys(e,t),T=Object.keys(C).sort(p.fieldSorter);let _=!1;if(!i&&a&&!d.triggerBeforeUpdate(C))return null;d.inSetting=!0;for(let L=0;L<T.length;L++){const F=T[L];if(F===y)continue;if(F.includes("[")){const[,te,de,fe]=F.match(cs),Ze=d.fieldMap[te];if(Ze!=null&&Ze.getAt){const xr=Ze.getAt(d,de);xr.isModel?xr.set(fe,C[F]):w.setPath(xr,fe,C[F]);continue}}const O=F.includes(".");if(b&&O){const[,te,de]=F.match(vl);if(b[te]){d[te].set(de,C[F]);continue}}const M=h[F],P=M||w,W=M==null?void 0:M.readOnly,H=(o=M==null?void 0:M.dataSource)!=null?o:F,I=!n&&!M&&F in m||(M==null?void 0:M.useProp),Y=I?d[H]:M!=null&&M.complexMapping||O?w.getPath(f,H):f[H],G=p.processField(F,C[F],d),A=C[F]={value:G},X=d.getRelationConfig(F),U=(te,de)=>P.isEqual(te,de)||te==null&&de==null;!W&&!U(Y,G)&&(!l||G!==void 0)&&(d.generation++,A.oldValue=(c=(u=M==null?void 0:M.getOldValue)==null?void 0:u.call(M,d))!=null?c:Y,_=!0,F in g.modified&&U(g.modified[F],G)?(Reflect.deleteProperty(g.modified,F),d.isReverting&&(d.data[H]=G)):d.ignoreBag||(F in g.modified||d.storeFieldChange(F,Y),A.oldValue===Re&&Reflect.deleteProperty(A,"oldValue")),S[F]=A,d.applyValue(I,H,G,n,M),X&&!r&&(d.initRelation(X),d.stores.forEach(te=>te.cacheRelatedRecord(d,G,X.relationName,A.oldValue))))}return _&&d.afterChange(C,S,i,r,n),d.inSetting=!1,_?S:null}applyValue(e,t,i,r,n){var l;const a=this;if(((n==null?void 0:n.dataSource)||t)===a.constructor.idField&&(a.$isPhantom=!1),((n==null?void 0:n.dataSource)||t)===a.constructor.parentIdField)(l=a.parent)!=null&&l.isRoot&&(i==null||!a.firstStore.getById(i))||(a.firstStore.getById(i)||a.firstStore.rootNode).insertChild(a,null,!1,{orderedParentIndex:{skip:!0}});else if(e)a[(n==null?void 0:n.name)||t]=i;else if(n!=null&&n.set)n.set(i,a.data,a);else{let o=n==null?void 0:n.complexMapping;if(!n&&t.includes(".")){const u=t.split(".")[0];n=a.constructor.fieldMap[u],o=(n==null?void 0:n.complexMapping)||(n==null?void 0:n.type)==="object"}o?w.setPath(a.data,t,i):a.data[t]=i}}afterChange(e,t,i,r,n){for(const l of this.stores)l.onModelChange(this,e,t,i,r,n);this.forEachLinked((l,a)=>l.onModelChange(a,e,t,i,r,n))}forEachLinked(e){for(const t of this.$links)for(const i of t.stores)e(i,t)}get isPersistable(){return!this.isBatchUpdating&&!this.isCreating}get isModified(){return!!(this.meta.modified&&Object.keys(this.meta.modified).length>0)}get hasPersistableChanges(){return this.isPersistable&&!w.isEmpty(this.rawModificationData)}isFieldModified(e){return this.isModified&&e in this.meta.modified}getFieldPersistentValue(e){const t=typeof e=="string"?this.getFieldDefinition(e):e,i=(t==null?void 0:t.name)||e;let r;return(!t||t.persist)&&(r=this.getValue(i),t!=null&&t.serialize&&(r=t.serialize(r,this))),r}get modifications(){const e=this.rawModifications;return e&&Object.keys(e).length&&(e[this.constructor.idField]=this.id),e}get rawModifications(){const e=this,t={};if(!e.isModified)return null;let i=!1;return Object.keys(e.meta.modified).forEach(r=>{const n=e.getFieldPersistentValue(r);n!==Re&&(t[r]=n,i=!0)}),i?t:null}get modificationData(){const e=this.rawModificationData;return e&&Object.keys(e).length&&w.setPath(e,this.constructor.idField,this.id),e}get rawModificationData(){const e=this,{fieldMap:t}=e.constructor,i={};if(!e.isModified)return null;let r=!1;return Object.keys(e.meta.modified).forEach(n=>{let l=t[n],a=l==null?void 0:l.dataSource;if(n.includes(".")){const o=n.match(vl)[1];l=t[o],a=n}if(l!=null&&l.persist){const o=e.getFieldPersistentValue(n);o!==Re&&(w.setPath(i,a,o),r=!0)}}),r?i:null}get modificationDataToWrite(){const e=this.constructor.alwaysWriteFields,t=this.modificationData;return e.forEach(i=>{t[this.getFieldDefinition(i).dataSource]=this.getFieldPersistentValue(i)}),t}get persistableData(){const e=this,t={};return e.fields.forEach(i=>{const r=e.getFieldPersistentValue(i);r!==Re&&(i!=null&&i.complexMapping?w.setPath(t,i.dataSource,r):t[i.dataSource]=r)}),t}get dataByFieldName(){const{data:e}=this;return this.fields.reduce((t,i)=>(w.hasPath(e,i.dataSource)&&(t[i.name]=e[i.dataSource]),t),{})}get isCommitting(){return!!this.meta.committing}clearChanges(e=!0,t=!0,i=null){const r=this,{meta:n}=r;if(i)for(const a in i)delete n.modified[a];else n.modified={};const l=w.isEmpty(n.modified);n.committing=!1,t&&r.stores.forEach(a=>{if(l&&a.modified.remove(r),a.added.remove(r),e){const o=a.collectDescendants(r).all;a.added.remove(o),l&&a.modified.remove(o)}})}storeFieldChange(e,t){this.meta.modified[e]=t}revertChanges(e=!1){this.isReverting=!0,this.set(this.meta.modified,Re,e),this.isReverting=!1}setByDataSource(e){var t;const i=this,{fieldDataSourceMap:r}=i.constructor,n=w.pathifyKeys(e,r),l={};for(const a in n){const o=r[a],u=(t=o==null?void 0:o.name)!=null?t:a;l[u]=n[a]}return i.set(l)}applyChangeset(e,t="$PhantomId",i=!0){var r;const n=this,l=n.constructor,{idField:a,fieldDataSourceMap:o}=l,u=w.pathifyKeys(e,o),c=w.pathifyKeys(n.modificationData),d={},f=t in e&&!(a in e);!f&&t in u&&delete u[t];for(const h in u){const p=o[h],m=(r=p==null?void 0:p.name)!=null?r:h;(i||((p==null?void 0:p.name)===a?f:u[h]===c[h]))&&(d[m]=u[h])}const g=n.set(d);return n.clearChanges(!1,!0,i?null:d),g?Object.entries(g).reduce((h,[p,m])=>(h[p]=m.value,h),{}):{}}get internalId(){return this._internalId}get isPhantom(){return this.id===""||this.id==null||this.hasGeneratedId||!!this.$isPhantom}get isModel(){return!0}get hasGeneratedId(){return typeof this.id=="string"&&this.id.startsWith("_generated")}static generateId(e=this.$$name){return`_generated${e}_${k.generateUUID()}`}generateId(){return this.constructor.generateId()}static asId(e){return e!=null&&e.isModel?e.id:w.isObject(e)?e[this.fieldMap.id.dataSource]:e}get json(){return k.safeJsonStringify(this)}toJSON(){const{children:e,unfilteredChildren:t}=this,i=this.persistableData;return(t||e)&&(i[this.constructor.childrenField]=(t||e).map(r=>r.toJSON())),i}toString(){const e=this,t=ac.find(r=>r in e.constructor.fieldMap),i=t?{[e.constructor.idField]:e.id,[t]:e[t]}:e.data;return k.safeJsonStringify(i)}get isBatchUpdating(){return!!this.batching}hasBatchedChange(e){var t,i;return(i=(t=this.meta)==null?void 0:t.batchChanges)==null?void 0:i[e]}beginBatch(e=!1){const t=this;t.batching||(t.batching=0,t.meta.batchChanges={}),e&&(t.$silenceBatch=(t.$silenceBatch||0)+1),t.batching++}endBatch(e=!1,t=!1,i=!0){const r=this,{parentIdField:n}=r.constructor;if(r.batching&&(r.batching--,r.$silenceBatch&&r.$silenceBatch--,!(r.batching>0)&&!w.isEmpty(r.meta.batchChanges))){let{batchChanges:l}=r.meta;r.meta.batchChanges=null,l[n]&&(l={...l},r.parentId=l[n],delete l[n]),r.set(l,Re,e,!1,t,void 0,i)}}cancelBatch(){if(this.batching){const e=this,{batchChanges:t}=e.meta,i={};if(e.batching=null,e.meta.batchChanges=null,e.generation++,!e.$silenceBatch){Object.entries(t).forEach(([n,l])=>{i[n]={oldValue:l,value:e[n]}});const r={action:"update",record:e,records:[e],changes:i};e.stores.forEach(n=>{n.trigger("batchedUpdate",{...r})}),e.forEachLinked((n,l)=>{n.trigger("batchedUpdate",{...r,record:l,records:[l]})})}e.$silenceBatch&&e.$silenceBatch--}}triggerBeforeUpdate(e){var t;return!((t=this.stores)!=null&&t.some(i=>i.trigger("beforeUpdate",{record:this,changes:e})===!1))}copy(e=null,t){const i=this,r=w.clone(i.data),n=i.constructor.idField,l=w.isObject(t)?t.deep:t;let a;if(e&&typeof e=="object"?(a=e[n],Object.assign(r,e)):a=e,l&&i.children?r.children=i.children.map(u=>u.copy(void 0,t)):(delete r.children,delete r.expanded),i.$meta.fields.initable.length>0){const u=i.toJSON();for(const c of i.$meta.fields.initable)r[c.name]=u[c.name]}e!==!1&&(r[n]=a||i.generateId(i.firstStore));const o=new i.constructor(r,null,null,!1,!0);return o.originalInternalId=i.internalId,o}copyData(e,t,i){const r={};e.allFields.forEach(({name:n})=>{n!==e.constructor.idField&&(r[n]=t?e.get(n):e.getValue(n))}),this.set(r,null,i)}remove(e=!1){const t=this,{parent:i,stores:r}=t;i?i.removeChild(t):r.length&&!t.isSpecialRow&&r.slice().forEach(l=>l.remove(t,e,!1,!0))}beforeRemove(e,t){return super.beforeRemove(e,t)}get isValid(){return!0}get firstStore(){return this.stores.length>0&&this.stores[0]}joinStore(e){var t;const i=this,{stores:r}=i;if(!r.includes(e)){const{unjoinedStores:n}=i;super.joinStore(e),e.register(i),r.push(e),n.includes(e)&&n.splice(n.indexOf(e),1),i.isLoaded&&i.children.forEach(l=>l.joinStore(e)),i.initRelations(),e.tree&&!i.isRoot&&!((t=e.stm)!=null&&t.isRestoring)&&(i.instanceMeta(e.id).collapsed=!i.expanded)}}unjoinStore(e,t=!1){var i,r,n;const l=this,{stores:a,unjoinedStores:o}=l;a.includes(e)&&(e.isDestroying||(e.unregister(l),o.push(e)),(r=(i=l.unfilteredChildren||l.children)==null?void 0:i.forEach)==null||r.call(i,u=>u.unjoinStore(e,t)),a.splice(a.indexOf(e),1),(n=super.unjoinStore)==null||n.call(this,e,t),e.uncacheRelatedRecord(l))}isPartOfStore(e){return e?e.includes(this):this.stores.length>0}get isRemoved(){return!this.isPartOfStore()}instanceMeta(e){var t;const{meta:i}=this,r=e.id||e;return((t=i.map)==null?void 0:t[r])||this.setInstanceMeta(r,{})}setInstanceMeta(e,t){const{meta:i}=this,r=e.id||e;return i.map||(i.map={}),i.map[r]=t}get isGroupHeader(){return"groupRowFor"in this.meta}get isGroupFooter(){return"groupFooterFor"in this.meta}get isSpecialRow(){var e;return!!((e=this.meta)!=null&&e.specialRow)}get $original(){return this.isLinked?this.proxyMeta.originalRecord:this}static get nonPersistableFields(){const e=this;return e._nonPersistableFields||(e._nonPersistableFields={},e.allFields.forEach(t=>{(!t.persist||t.calculated)&&(e._nonPersistableFields[t.name]=1)})),e._nonPersistableFields}static get alwaysWriteFields(){const e=this;return e._alwaysWriteFields||(e._alwaysWriteFields=[],e.allFields.forEach(t=>{t.alwaysWrite&&e._alwaysWriteFields.push(t.name)})),e._alwaysWriteFields}get domId(){return typeof this.id=="string"?this.id.replace(/[ .]/g,"-"):this.id}static toJavaScriptValue(e){const{names:t}=this.$meta,i=t[t.length-2],r=t[t.length-3];return`class ${i} extends ${r} { static fields = ${k.toJavaScriptValue(this.fields,e)}; }`}getCurrentConfig(e){const{data:t,children:i}=this,{defaultValues:r,applyConfigs:n}=this.constructor,l=n?super.getCurrentConfig(e):{};if(l){for(const a of this.fields)if(a.persist){const o=w.getPath(t,a.dataSource);a.isEqual(o,r[a.name])||w.setPath(l,a.dataSource,R.processConfigValue(o,e))}if(i)if(Array.isArray(i)){l.children=[];for(const a of i)l.children.push(a.getCurrentConfig(e))}else l.children=i;this.hasGeneratedId&&delete l.id,delete l.parentId,delete l.parentIndex}return l}};x(Cl,"relations",null);var ue=Cl;ue._idField="id",ue._internalIdCounter=1,ue._assignedIdField=!1,ue.exposeProperties(),ue._$name="Model";var rr=class qa{constructor(e,t){typeof e=="number"||e===null?(this._magnitude=e,this._unit=t):(typeof e=="string"&&Object.assign(this,z.parseDuration(e)),typeof e=="object"&&Object.assign(this,e))}get magnitude(){return this._magnitude}set magnitude(e){this._magnitude=typeof e=="number"&&e}get unit(){return this._unit}set unit(e){this._unit=z.parseTimeUnit(e)}get isValid(){return this._magnitude!=null&&!!z.normalizeUnit(this._unit)}get milliseconds(){return this.isValid?Math.round(z.asMilliseconds(this._magnitude,this._unit)):0}isEqual(e){return!!e&&this._magnitude!=null&&e._magnitude!=null&&this.milliseconds===e.milliseconds}toString(e){const t=this,i=e?"getShortNameOfUnit":"getLocalizedNameOfUnit";return t.isValid?`${t._magnitude} ${z[i](t._unit,t._magnitude!==1)}`:""}toJSON(){return this.toString()}valueOf(){return this.milliseconds}diff(e){return new qa({unit:this.unit,magnitude:z.as(this.unit,this.milliseconds-e.milliseconds)})}};rr._$name="Duration";var uc=(s,e)=>s==null?void 0:s[e],cc=/^is(this|next|last)(week|month|year)$/i,dc=["isToday","isTomorrow","isYesterday","isThisWeek","isNextWeek","isLastWeek","isThisMonth","isNextMonth","isLastMonth","isThisYear","isNextYear","isLastYear","isYearToDate"],wl=class Sr extends R.mixin(di){static get defaultConfig(){return{value:null,operator:null,filterBy:null,convert:null,caseSensitive:!0,id:null,type:null,internal:null,disabled:!1}}static get configurable(){return{property:null}}construct(e){typeof e=="function"&&(e={filterBy:e}),e.type?e.type==="date"&&e.value!=null&&!Array.isArray(e.value)?e.value=new Date(e.value):e.type==="duration"&&e.value!=null&&!Array.isArray(e.value)&&(e.value=new rr(e.value)):z.isDate(e.value)||Array.isArray(e.value)&&e.value.every(z.isDate)?e.type="date":e.value instanceof rr&&(e.type="duration"),super.construct(e)}get id(){return this._id||(this.internal?this._id=Sr.generateId(`b-internal-${this.property}-filter-`):this._id=this.property||Sr.generateId("b-filter-")),this._id}set id(e){this._id=e}onChange(e){var t;const i=this;!i.isConfiguring&&((t=i.owner)!=null&&t.onFilterChanged)&&!i.owner.isConfiguring&&i.owner.onFilterChanged(i,e)}get filterBy(){return this._filterBy||this.defaultFilterBy}set filterBy(e){this._filterBy=e}defaultFilterBy(e){const t=this;let i;return e.isModel?i=e.getValue(t.property):t._propertyItems.length>1?i=t._propertyItems.reduce(uc,e):i=e[t.property],t[t.operator](t.convert(i))}updateProperty(e){this._propertyItems=e.split("."),this.onChange("property")}set value(e){const t=this;t._value=e,Array.isArray(e)&&({date:1,duration:1}[t.type]||e.length>0&&typeof e[0]=="string")?t._filterValue=e.map(i=>t.convert(i)):!t.caseSensitive&&Array.isArray(e)&&e.length>0&&typeof e[0]=="string"?t._filterValue=e.map(i=>i==null?void 0:i.toLowerCase()):!t.caseSensitive&&typeof e=="string"?t._filterValue=e.toLowerCase():t._filterValue=t.convert(e),t.onChange("value")}get value(){return this._value}get filterValue(){return this._filterValue}set operator(e){this._operator=e,this.onChange("operator")}get operator(){const e=this;return e._operator?e._operator:Array.isArray(e.filterValue)?"isIncludedIn":typeof e.filterValue=="string"?"*":"="}convert(e){var t;return this.operator!=="sameTime"&&!(typeof this.filterValue=="string"&&e instanceof Date)&&(this.operator==="sameDay"&&(e=z.clearTime(e)),e=(t=e==null?void 0:e.valueOf())!=null?t:e),e=!this.caseSensitive&&typeof e=="string"?e.toLowerCase():e,e}filter(e){return this.filterBy(e)}startsWith(e){return String(e).startsWith(this.filterValue)}endsWith(e){return String(e).endsWith(this.filterValue)}isIncludedIn(e){return this.filterValue.length===0||this.filterValue.includes(e)}isNotIncludedIn(e){return!this.isIncludedIn(e)}includes(e){return this.filterValue.length===0||String(e).includes(this.filterValue)}doesNotInclude(e){return!this.includes(e)}sameTime(e){return z.isSameTime(e,this.filterValue)}sameDay(e){return e===this.filterValue}"="(e){return w.isEqual(e,this.filterValue)}"!="(e){return!w.isEqual(e,this.filterValue)}">"(e){return w.isMoreThan(e,this.filterValue)}">="(e){return w.isMoreThan(e,this.filterValue)||w.isEqual(e,this.filterValue)}"<"(e){return w.isLessThan(e,this.filterValue)}"<="(e){return w.isLessThan(e,this.filterValue)||w.isEqual(e,this.filterValue)}"*"(e){return w.isPartial(e,this.filterValue)}between(e){const[t,i]=this._filterValue;return(w.isMoreThan(e,t)||w.isEqual(e,t))&&(w.isLessThan(e,i)||w.isEqual(e,i))}notBetween(e){return!this.between(e)}empty(e){return e==null||String(e).length===0}notEmpty(e){return!this.empty(e)}isToday(e){return this.between(e)}isTomorrow(e){return this.between(e)}isYesterday(e){return this.between(e)}isThisWeek(e){return this.between(e)}isNextWeek(e){return this.between(e)}isLastWeek(e){return this.between(e)}isThisMonth(e){return this.between(e)}isNextMonth(e){return this.between(e)}isLastMonth(e){return this.between(e)}isThisYear(e){return this.between(e)}isNextYear(e){return this.between(e)}isLastYear(e){return this.between(e)}isYearToDate(e){return this.between(e)}isTrue(e){return e===!0}isFalse(e){return e===!1}setRelativeDateValues(){this._filterValue=Sr.getRelativeDateRange(this._operator).map(e=>e.valueOf())}static getRelativeDateRange(e,t=new Date){let i,r,n,l,a,o,u;switch(e){case"isYearToDate":return[z.floor(t,"1 year"),t];case"isToday":return i=z.floor(t,"1 day"),[i,z.add(i,1,"day")];case"isYesterday":return i=z.floor(t,"1 day"),[z.add(i,-1,"day"),i];case"isTomorrow":return r=z.getStartOfNextDay(t),[r,z.add(r,1,"day")];case"isThisWeek":case"isNextWeek":case"isLastWeek":case"isThisMonth":case"isNextMonth":case"isLastMonth":case"isThisYear":case"isNextYear":case"isLastYear":if(n=e.toLowerCase().match(cc),!n)throw new Error(`Unrecognized relative date expression: ${e}`);return[,o,u]=n,l=`1 ${u}`,a=z.floor(t,l),o==="next"?a=z.add(a,1,u):o==="last"&&(a=z.add(a,-1,u)),[a,z.add(a,1,u)]}}static generateFiltersFunction(e){if(!e||!e.length&&!e.count)return re.returnTrue;for(const t of e)t.type==="date"&&dc.includes(t._operator)&&t.setRelativeDateValues();return function(t){let i=!0;for(const r of e)if(r.disabled||(i=r.filter(t)),!i)break;return i}}};x(wl,"$name","CollectionFilter");var me=wl;me._$name="CollectionFilter";var Sl=w.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null)),sr=class{static generateId(s="generatedId"){return s+(Sl[s]=(Sl[s]||0)+1)}};sr._$name="IdHelper";var pi=class extends R{static get defaultConfig(){return{property:null,direction:"ASC",sortFn:null,convert:null,id:null,useLocaleSort:null}}construct(s){typeof s=="function"&&(s={sortFn:s}),super.construct(s)}get id(){return this._id||(this._id=this.property||sr.generateId("b-sorter"))}set id(s){this._id=s}set sortFn(s){this._sortFn=s}get sortFn(){return this._sortFn?this._sortFn:this.defaultSortFn}defaultSortFn(s,e){const t=this,{convert:i,property:r,useLocaleSort:n}=t,l=t.direction.toLowerCase()==="desc"?-1:1;if(s=s[r],e=e[r],i&&(s=i(s),e=i(e)),n&&s!=null&&e!=null&&typeof s=="string"){if(n===!0)return String(s).localeCompare(e);if(typeof n=="string")return String(s).localeCompare(e,n);if(typeof n=="object")return String(s).localeCompare(e,n.locale,n)}return(s>e?1:s<e?-1:0)*l}static generateSortFunction(s,e){const t=s.isCollection?s.values:s,i=t.length;return(r,n)=>{let l,a;for(a=0;a<i;++a)if(l=t[a].sortFn(r,n),l)return l;return e?e(r,n):0}}};pi._$name="CollectionSorter";var fc=()=>0,hc=(s,e)=>e-s,ds=Symbol("filteredIndicesProperty"),Ht=Object.freeze([]),gc=Object.freeze({action:"sort",added:Ht,removed:Ht,replaced:Ht}),pc=Object.freeze({action:"filter",added:Ht,removed:Ht,replaced:Ht}),yt={string:1,number:1};function El(s,e,t,i){if(e.unique!==!1)e.set(t,s),i&&e.count++;else{let r=e.get(t);r||(r=new Set,e.set(t,r)),r.add(s)}}function mc(s,e,t){e.unique!==!1?e.delete(t):e.has(t)&&(e.get(t).delete(s),e.get(t).size||e.delete(t))}function Tl(s,e,t,i,r=!1){for(let n=0;n<s.length;n++){const l=s[n];for(let a=0;a<i;a++){const o=t[a],u=l[o],c=e[o];El(l,c,u,!r&&c.onDuplicate)}}}var vt=class Us extends R.mixin(De){constructor(){super(...arguments),x(this,"_sortFunction",null),x(this,"_addedValues",null)}static get configurable(){return{idProperty:"id",extraKeys:null,autoFilter:!0,autoSort:!0,sorters:{$config:["lazy"],value:[]}}}get isCollection(){return!0}construct(e){this.generation=0,this._values=[],super.construct(e)}doDestroy(){var e;super.doDestroy();const t=this;t._values.length=0,t.isFiltered&&(t._filteredValues.length=0,t.filters.destroy()),(e=t._sorters)==null||e.destroy()}clear(){const e=this,t=e._values.slice();e.totalCount&&(e._values.length=0,e._filteredValues&&(e._filteredValues.length=0),e._indicesInvalid=!0,e.generation++,e.trigger("change",{action:"clear",removed:t}))}equals(e,t){if(e.isCollection&&(e=e.values),e.length===this.count){let{values:i}=this;return t&&(e=e.map(t),i=i.map(t)),V.delta(e,i).inBoth.length===this.count}return!1}replaceValues({values:e,filteredValues:t,silent:i=!1,isNewDataset:r=!1}){const n=this;let l,a;n.isFiltered&&!r?(!!t?e&&(l=n._values,n._values=e.slice()):(t=e.slice(),e=null),a=n._filteredValues,n._filteredValues=t.slice()):(l=n._values,n._values=e.slice(),t=null,n.isFiltered&&r&&n.autoFilter?(n._filterFunction=null,n._filteredValues=n._values.filter(n.filterFunction)):n._filteredValues&&(n._filteredValues.length=0)),n._indicesInvalid=!0,n._addedValues=void 0,n.generation++,i||n.trigger("change",{action:"replaceValues",replacedValues:l,replacedFilteredValues:a,values:e,filteredValues:t})}set values(e){this.invalidateIndices(),this.splice(0,this._values.length,e)}get values(){return this.isFiltered?this._filteredValues:this._values}get filteredValues(){return this._filteredValues}[Symbol.iterator](){return this.values[Symbol.iterator]()}forEach(e,t=!1){(this.isFiltered&&!t?this._filteredValues:this._values).forEach(e)}map(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).map(e)}reduce(e,t=!1,i=[]){return(this.isFiltered&&!t?this._filteredValues:this._values).reduce(e,i)}find(e,t=!1){return(this.isFiltered&&!t?this._filteredValues:this._values).find(e)}get first(){return this.values[0]}get last(){return this.values[this.count-1]}get allValues(){return this._values}get addedValues(){return this._addedValues}match(e,t=!0){const i=this,{_values:r}=i,n=[];return i.forEach(l=>{const a=e.get(l.id,!0);if(a){const o=i.indexOf(l,!0),u=r[o];r[o]=a,i.removeFromIndices(u),i.addToIndices(a)}else t&&n.push(l)}),n.length&&i.remove(n),i.isFiltered&&(i._filteredValues=i._values.filter(i.filterFunction)),n}add(...e){e.length===1?this.splice(this._values.length,null,...e):this.splice(this._values.length,null,e)}remove(...e){e.length===1?this.splice(0,...e):this.splice(0,e)}move(e,t){for(e=V.asArray(e);e.length&&e[0]===t;)e.shift();if(!e.length)return;const i=this,{_values:r}=i,n=i.indexOf(e[0],!0);if(e.length===1&&r[n+1]===t)return;i.suspendEvents(),i.remove(e),i.resumeEvents();const l=t?i.indexOf(t,!0):r.length;if(l===-1)throw new Error("Collection move beforeItem parameter must be present in Collection");return r.splice(l,0,...e),i._indicesInvalid=1,i.trigger("change",{action:"move",items:e,from:n,to:l}),l}splice(e=0,t,...i){const r=this,n=r.idProperty,l=r._values,a={},o=[],u=[],c=r.totalCount;let d,f;if((i==null?void 0:i.length)===1&&Array.isArray(i[0])&&(i=i[0]),r.trigger("beforeSplice",{index:e,toRemove:t,toAdd:i})!==!1){if(i)if(c&&i.length){const g=r.indices[n];d=[];for(let h=0;h<i.length;h++){const p=i[h],m=p[n],y=g.get(m),b=y?l.indexOf(y):-1;a[m]=!0,b!==-1?l[b]!==p&&(u.push([l[b],p]),l[b]=p):d.push(p)}}else d=i;if(t){if(typeof t=="number"){t=Math.min(t,l.length-e);for(let g=e;t;--t){const h=l[g][n];a[h]?(e++,g++):(o.push(l[g]),l.splice(g,1),f=!0)}}else{let g=d.length===0,h;t=V.asArray(t);const p=t.reduce((m,y)=>{const b=typeof y=="number",S=b?y:r.indexOf(y,!0);return g&&(h!=null&&S!==h+1||b)&&(g=!1),S>=0&&S<c&&m.push(S),h=S,m},[]).sort(hc);if(g)p.length&&(o.push.apply(o,t),l.splice(p[p.length-1],p.length),f=!0);else for(let m=0;m<p.length;m++){const y=p[m];if(y!==-1){const b=l[y][n];a[b]||(o.unshift(l[y]),l.splice(y,1),f=!0)}}}o.length&&!r._indicesInvalid&&o.forEach(r.removeFromIndices,r)}if(d.length){l.splice(Math.min(e,l.length),0,...d),f=!0,r._indicesInvalid||d.forEach(r.addToIndices,r),r._addedValues||(r._addedValues=new Set);for(const g of d)r._addedValues.add(g)}if(o.length&&r._addedValues)for(const g of o)r._addedValues.delete(g);u.length&&!r._indicesInvalid&&u.forEach(g=>{r.removeFromIndices(g[0]),r.addToIndices(g[1])}),f||u.length?(r.isSorted?r.onSortersChanged():r.isFiltered&&(r.autoFilter?r.onFiltersChanged({action:"splice",oldCount:1}):r._filteredValues.splice(Math.min(e,r._filteredValues.length),0,...d)),r.generation++,r.trigger("change",{action:"splice",removed:o,added:d,replaced:u,oldCount:c})):r.trigger("noChange",{index:e,toRemove:t,toAdd:i})}}changeId(e,t){const i=this,{idProperty:r}=i,n=yt[typeof e]?e:e[r],l=i.get(n);if(l){const a=i.get(t);if(a&&l!==a)throw new Error(`Attempt to set item ${n} to already existing member's id ${t}`);i.removeIndexEntry(e,r,n),i.addIndexEntry(e,r,t),l[r]=t}}get(e,t=!1){return this.getBy(this.idProperty,e,t)}getAt(e,t=!1){return this.isFiltered&&!t?this._filteredValues[e]:this._values[e]}getBy(e,t,i=!1){return this.findItem(e,t,this.isFiltered&&i)}get count(){return this.values.length}get totalCount(){return this._values.length}updateIdProperty(e){this.addIndex({property:e,unique:!0})}changeSorters(e){return new Us({values:V.asArray(e),internalListeners:{change:"onSortersChanged",thisObj:this}})}addSorter(e){const t=e instanceof pi?e:new pi(e);return this.sorters.add(t),t}get isSorted(){var e;return!!((e=this._sorters)!=null&&e.count)}onSortersChanged(){const e=this;e._sortFunction=null,e._addedValues=null,e._values.sort(e.sortFunction),e.trigger("change",gc)}get sortFunction(){return this._sortFunction||(this.isSorted?this._sortFunction=pi.generateSortFunction(this.sorters.values):this._sortFunction=fc),this._sortFunction}get filters(){return this._filters||(this._filters=new Us({internalListeners:{change:"onFiltersChanged",thisObj:this}})),this._filters}addFilter(e){const t=e instanceof me?e:new me(e);return this.filters.add(t),t}removeFilter(e){const{filters:t}=this;e.isCollectionFilter||(e=t.get(e)),t.remove(e)}clearFilters(){this.filters.clear()}get isFiltered(){return!!(this._filters&&this._filters.count)}onFiltersChanged({action:e,removed:t,oldCount:i}){const r=this,n=i||e==="clear"&&t.length?r._filteredValues:r._values;r._filterFunction=null,r._filteredValues=r._values.filter(r.filterFunction),r._indicesInvalid=!0;const{toAdd:l,toRemove:a}=V.delta(r._filteredValues,n,!0);r.trigger("change",{...pc,added:l,removed:a})}get filterFunction(){return this._filterFunction||(this.isFiltered?this._filterFunction=me.generateFiltersFunction(this.filters.values):this._filterFunction=re.returnTrue),this._filterFunction}changeExtraKeys(e){return V.asArray(e).map(i=>typeof i=="string"?{property:i,unique:!0}:i)}updateExtraKeys(e){for(let t=0;t<e.length;t++)this.addIndex(e[t])}addIndex(e){const t=this;e&&((t._indices||(t._indices={}))[e.property]=new Map,Object.assign(t._indices[e.property],e),t.invalidateIndices(),e.dependentOn&&(t.hasCompositeIndex=!0))}findIndex(e,t,i=!1){const r=this.findItem(e,t,i);return r?(this.isFiltered&&!i?this._filteredValues:this._values).indexOf(r):-1}findItem(e,t,i=!1){var r;const n=this,{isFiltered:l}=n,a=l&&!i?n.indices[ds][e]:n.indices[e];if(a){const o=(r=a.get(t))!=null?r:typeof t=="string"&&t.length&&!isNaN(t)&&a.get(Number(t))||null;if(o!=null)return o}else{const o=l&&!i?n._filteredValues:n._values,u=o.length;for(let c=0;c<u;c++){const d=o[c];if(d[e]==t)return d}}return null}removeIndex(e){delete this._indices[e],this.hasCompositeIndex=Object.values(this.indices).some(t=>t.dependentOn)}indexOf(e,t=!1){return this.findIndex(this.idProperty,yt[typeof e]?e:e[this.idProperty],t)}includes(e,t=!1){return Array.isArray(e)?e.some(i=>this.includes(i)):!!this.findItem(this.idProperty,yt[typeof e]?e:e[this.idProperty],t)}get indices(){return this._indicesInvalid&&this.rebuildIndices(),this._indices}invalidateIndices(){this._indicesInvalid=!0}rebuildIndices(){const e=this,t=e.isFiltered,i=e._indices||(e._indices={}),r=Object.keys(i),n=r.length,l=e._values;let a=!1,o;t&&(o=i[ds]={});for(let u=0;u<n;u++){const c=i[r[u]];if(c.clear(),c.onDuplicate&&(c.count=0,a=!0),t){let d=o[r[u]];d?d.clear():(d=o[r[u]]=new Map,d.unique=c.unique)}}if(Tl(l,i,r,n),a)for(let u=0;u<n;u++){const c=i[r[u]];if(c.onDuplicate&&c.count>c.size){const d=new Set;for(let f=0;f<l.length;f++){const g=l[f],h=g[r[u]];d.has(h)&&c.onDuplicate(g,h,c),d.add(h)}}}t&&Tl(e._filteredValues,o,r,n,!0),e._indicesInvalid=!1}getIndices(e){const t=[this.indices[e]];return this.isFiltered&&t.push(this.indices[ds][e]),t}addToIndices(e){Object.keys(this.indices).forEach(t=>{this.addIndexEntry(e,t,e[t])})}removeFromIndices(e){Object.keys(this.indices).forEach(t=>{this.removeIndexEntry(e,t,e[t])})}removeIndexEntry(e,t,i){this.getIndices(t).forEach(r=>mc(e,r,i))}addIndexEntry(e,t,i){this.getIndices(t).forEach(r=>El(e,r,i))}onItemMutation(e,t){const i=this;!i._indicesInvalid&&Object.keys(i.indices).length>1&&Object.keys(t).forEach(r=>{var n;if(i.indices[r]){const{value:a,oldValue:o}=t[r];i.removeIndexEntry(e,r,o),i.addIndexEntry(e,r,a)}if(i.hasCompositeIndex){const a=Object.values(i.indices).find(o=>{var u;return(u=o.dependentOn)==null?void 0:u[r]});if(a){const o={};for(const c in a.dependentOn)o[c]=((n=t[c])==null?void 0:n.oldValue)||e[c];const u=e.buildIndexKey(o);i.removeIndexEntry(e,a.property,u),i.addIndexEntry(e,a.property,e[a.property])}}})}};vt._$name="Collection";var xl=new WeakMap,mi=s=>{if(s&&typeof s=="object"){let e=xl.get(s);e===void 0&&(e=Symbol("bscik"),xl.set(s,e)),s=e}return s},yi=class{constructor(s){const e=this;e.generation=0,e.items=new Set,e.idMap={},e.idProperty="id",s&&(s.idProperty&&(e.idProperty=s.idProperty),s.values&&(e.values=s.values))}get(s){return this.idMap[mi(s)]}get count(){return this.items.size}add(...s){s.length===1&&Array.isArray(s[0])&&(s=s[0]);const e=this,{items:t,idMap:i,idProperty:r}=e,n=s.length;for(let l=0;l<n;l++){const a=s[l],o=yt[typeof a]?a:mi(a[r]),u=i[o];u==null?(i[o]=a,t.add(a),e.generation++):u!==a&&(i[o]=a,t.delete(u),t.add(a))}}at(s){let e,t;s<0&&(s+=this.count);for(e of this.items)if(!s--){t=e;break}return t}remove(s){s=V.asArray(s);const{items:e,idMap:t,idProperty:i}=this,r=s.length;for(let n=0;n<r;n++){const l=s[n],a=yt[typeof l]?l:mi(l[i]),o=t[a];o!=null&&(e.delete(o),delete t[a],this.generation++)}}clear(){this.items.clear(),this.idMap={},this.generation++}countOf(s){let e=0,t;for(t of this.items)s(t)&&++e;return e}changeId(s,e){const t=this,{idMap:i,idProperty:r}=t,n=yt[typeof s]?s:mi(s[r]),l=t.get(n);if(l){const a=t.get(e);if(a&&l!==a)throw new Error(`Attempt to set item ${n} to already existing member's id ${e}`);l[r]=e,delete i[n],i[e]=l}}filter(s,e){const{items:t}=this,i=[];let r=0;return t.forEach(n=>{s.call(e,n,r++,t)&&i.push(n)}),i}includes(s){const e=yt[typeof s]?s:mi(s[this.idProperty]);return!!this.idMap[e]}map(s,e){const{items:t}=this,i=new Array(t.size);let r=0;return t.forEach(n=>{i[r]=s.call(e,n,r++,t)}),i}forEach(s,e){return this.items.forEach(s,e)}find(s,e=0){let t,i;e<0&&(e+=this.countOf(s));for(t of this.items)if(s(t)&&!e--){i=t;break}return i}[Symbol.iterator](){return this.items[Symbol.iterator]()}indexOf(s,e){let t=-1,i;for(i of this.items)if((!e||e(i))&&(++t,i===s))return t;return-1}get values(){return[...this.items]}set values(s){s=V.asArray(s),this.clear(),this.add.apply(this,s),this.generation++}sort(s){this.values=this.values.sort(s)}some(s,e){return this.values.some(s,e)}};yi._$name="Bag";var Dl=s=>class extends(s||R){static get $name(){return"StoreCRUD"}static get defaultConfig(){return{autoCommit:!1}}static get properties(){return{isRemoving:!1,suspendCount:0}}remove(t,i=!1){const r=this,{storage:n}=r;if(t=V.asArray(t).reduce((l,a)=>(a=r.getById(a),a&&l.push(a),l),[]),t.length===0)return t;if(!r.tree&&!i&&r.trigger("beforeRemove",{records:t})===!1)return[];if(r.isRemoving=!0,r.isGrouped){const l=n.count,a=[],o=new Set;for(const u of t){const c=u.groupParent.get(r.id);c.meta.collapsed&&a.push(u),V.remove(c.groupChildren,u),V.remove(c.unfilteredGroupChildren,u),c.meta.childCount--,o.add(c)}for(const u of o)u.groupChildren.length>0&&r.onModelChange(u,{},{});a.length&&n.trigger("change",{action:"splice",removed:a,added:[],replaced:[],oldCount:l})}else if(r.tree){const l=[],a=t.length>1,o=t[0],u=a?void 0:n.indexOf(o),c=t.reduce((f,g)=>{const{parent:h}=g;return h&&(f[h.id]||(f[h.id]=[h,[]]),f[h.id][1].push(g)),f},{}),d=Array.from(Object.values(c));if(!i&&r.trigger("beforeRemove",{records:t,isMove:!1,parent:a?void 0:o.parent})===!1)return r.isRemoving=!1,[];r.suspendAutoCommit(),d.sort((f,g)=>g[0].childLevel-f[0].childLevel);for(const[f,g]of d)l.push(...f.removeChild(g,!1,!0));return i||(r.trigger("remove",{parent:a?void 0:o.parent,index:u,isChild:!0,allRecords:l,isMove:!1,records:t}),r.trigger("change",{action:"remove",records:t})),r.resumeAutoCommit(),r.isRemoving=!1,t}if(t.length===0)return r.isRemoving=!1,t;for(const l of t)l.beforeRemove(t);return i&&r.suspendEvents(),n.remove(t),i&&r.resumeEvents(),r.autoCommit&&r.doAutoCommit(),r.isRemoving=!1,t}clear(t=!1){var i,r;const n=this,{storage:l}=n;if(n.storage.totalCount||(r=(i=n.rootNode)==null?void 0:i.unfilteredChildren)!=null&&r.length){if(!t&&n.trigger("beforeRemove",{records:l.allValues,removingAll:!0})===!1)return null;if(n.rootNode)n.isChained||n.rootNode.clearChildren(t);else if(t){const a=n.registeredRecords;for(let o=a.length-1,u;o>=0;o--)u=a[o],u&&!u.isDestroyed&&u.unjoinStore(n)}t&&(n.removed.clear(),l.suspendEvents()),l.clear(),t&&l.resumeEvents(),n.added.clear(),n.modified.clear()}}removeAll(t=!1){const i=this,r=i.storage;let n;if(i.isRemoving=!0,t){r.suspendEvents();const l=i.registeredRecords;for(let a=l.length-1,o;a>=0;a--)o=l[a],o&&!o.isDestroyed&&!o.isRoot&&o.unjoinStore(i)}return i.tree?n=i.rootNode.clear()!==!1:n=i.clear()!==null,t&&r.resumeEvents(),i.isRemoving=!1,n}add(t,i=!1,r={}){const n=this,{storage:l}=n;if(t=V.asArray(t),!(t!=null&&t.length))return;if(n.tree=n.tree||!!(n.autoTree&&t[0].children),n.tree){const o=new Map,u=n.modelClass.getFieldDataSource("parentIndex"),{parentIdField:c}=n.modelClass,d=[];return t.forEach(f=>{const g=f[c];o.has(g)||o.set(g,{append:[],insert:[]});const h=o.get(g);!f.isModel&&u in f?h.insert.push(f):h.append.push(f)}),o.forEach(({append:f,insert:g},h)=>{const p=h==null?n.rootNode:n.getById(h);if(!p)throw new Error(`Parent node with id ${h} not found, cannot add children.`);if(f.length&&d.push(...p.appendChild(f,i,r)),g.length)for(const m of g)d.push(p.insertChild(m,m[u],i,r))}),n.isFiltered&&n.reapplyFilterOnAdd&&n.filter({silent:!0}),n.reapplySortersOnAdd&&!n.isSyncingDataOnLoad&&n.sort(),d}if(!i&&n.trigger("beforeAdd",{records:t})===!1)return null;if(n.tree=n.tree||!!(n.autoTree&&t[0].children),n.tree)return n.rootNode.appendChild(t);const a=n.processRecords(t);return i&&n.suspendEvents(),n.addingClean=r.clean,l.add(a),n.addingClean=!1,i&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),a}processRecords(t,i){return t.map(r=>{const n=this.processRecord(r.isModel?r:this.createRecord(r));return i==null||i.call(this,n),n})}insert(t,i,r=!1){var n;const l=this,a=l.storage,o=l.getAt(t),u=a.values,c=[];if(i=V.asArray(i),l.tree){const p=l.rootNode;return p.insertChild(i,(n=p.children)==null?void 0:n[t],r)}if(!r&&l.trigger("beforeAdd",{records:i})===!1)return null;let d,f,g;if(u[f=t]===i[0]||u[f=t-1]===i[0])for(d=!0,g=0;d&&g<i.length;g++)i[g]!==u[f+g]&&(d=!1);if(d)return null;const h=l.processRecords(i,p=>{const m=a.indexOf(p);p.children&&p.children.length&&l.autoTree&&(l.tree=!0),m>-1&&(m<t&&o&&t--,c.push(m)),p.meta.previousIndex=m});return l.suspendEvents(),l.storage.remove(c),l.resumeEvents(),r&&l.suspendEvents(),a.splice(t,0,...h),r&&l.resumeEvents(),l.autoCommit&&l.doAutoCommit(),h}move(t,i){this.isTree?i.parent.insertChild(t,i):this.storage.move(t,i)}setMultiple(t,i,r){const n=this,l=[],a=[];n.forEach(o=>{t(o)&&(a.push(o.set(i,r,!0)),l.push(o))}),n.trigger("updateMultiple",{records:l,all:n.records.length===l.length}),n.trigger("change",{action:"updatemultiple",records:l,all:n.records.length===l.length}),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}setAll(t,i){const r=this,n=[];r.forEach(l=>{n.push(l.set(t,i,!0))}),r.trigger("updateMultiple",{records:r.records,all:!0}),r.trigger("change",{action:"updatemultiple",records:r.records,all:!0}),r.reapplyFilterOnUpdate&&r.isFiltered&&r.filter()}acceptChanges(){const t=this;t.added.forEach(i=>i.clearChanges(!0,!1)),t.modified.forEach(i=>i.clearChanges(!0,!1)),t.added.clear(),t.modified.clear(),t.removed.clear()}commit(t=!1){const{changes:i}=this;return!t&&this.trigger("beforeCommit",{changes:i})===!1?!1:(this.acceptChanges(),t||this.trigger("commit",{changes:i}),i)}revertChanges(){const t=this,{changes:i}=t;if(i){const r={action:"clearchanges",changes:i};t.add(t.removed.values,!0),t.remove(t.added.values,!0),t.modified.forEach(n=>n.revertChanges(!0)),t.added.clear(),t.modified.clear(),t.removed.clear(),t.trigger("change",r),t.trigger("refresh",r)}}get changes(){const t=this,i=t.modified.values.filter(r=>r.rawModifications);return t.added.count||i.length||t.removed.count?{added:t.added.values.slice(),modified:i,removed:t.removed.values.slice()}:null}get autoCommit(){return this._autoCommit}set autoCommit(t){this._autoCommit=t,t&&this.changes&&this.commit()}suspendAutoCommit(){this.suspendCount++}resumeAutoCommit(t=!0){this.suspendCount--,this.autoCommit&&t&&this.doAutoCommit()}doAutoCommit(){this.suspendCount<=0&&this.commit()}},_l=s=>class extends(s||R){static get $name(){return"StoreChanges"}static get configurable(){return{applyChangesetFilterSortTarget:"changes"}}applyChangesFromStore(t){const i=this,{changes:r}=t;r&&(r.added&&i.add(r.added),r.removed&&i.remove(r.removed.map(n=>n.id)),r.modified&&r.modified.forEach(n=>{const l=i.getById(n.id);l==null||l.set(n.modifications)}))}applyChangeset(t,i=null,r="$PhantomId",n=!0,l=!1){var a,o,u,c,d;const f=this,{added:g,updated:h,modified:p,removed:m}=(a=i==null?void 0:i(t,f))!=null?a:t,y=(o=h!=null?h:p)!=null?o:[],b=f.modelClass.getFieldDataSource("id"),S=f.modelClass.getFieldDataSource("parentId"),C=l?new Map:null,T=[],_=[];let L=!1,F=[];if(f.trigger("startApplyChangeset"),f._groupVisibleRecordIds=[],f.isGrouped&&f.forEach(O=>{f._groupVisibleRecordIds.push(O.id)}),(g==null?void 0:g.length)>0){const O=[],M=[];for(const H of g)f.getById(H[r])||f.getById(w.getPath(H,b))?O.push(H):M.push(H);y.unshift.apply(y,O);const P=f.reapplySortersOnAdd;f.reapplySortersOnAdd=!1;const W=(u=f.add(M,!1,{orderedParentIndex:{skip:!0}}))!=null?u:[];if(T.push(...W),f.reapplySortersOnAdd=P,f.tree)for(const H of W){const{parent:I}=H;if(I.isRoot){L=!0,F=[I];break}!I.isRoot&&F.every(Y=>!Y.contains(I))&&F.push(I)}for(const H of W)C==null||C.set(H.id,H.data),H.clearChanges()}if((y==null?void 0:y.length)>0)for(const O of y){const M=O[r],P=w.getPath(O,b),W=w.getPath(O,S),H=(c=f.getById(M))!=null?c:f.getById(P);if(H){const I=W!=null?(d=f.getById(W))==null?void 0:d.isLeaf:!1,Y=H.applyChangeset(O,r,n);I&&f.toggleCollapse(H.parent,!1),f.tree&&!L&&F.every(G=>!G.contains(H))&&(H.parent.isRoot?(L=!0,F=[H.parent]):F.push(H.parent)),C==null||C.set(P,Y),_.push(H)}}if((m==null?void 0:m.length)>0&&f.applyRemovals(m),f.applyChangesetFilterSortTarget==="changes"){const O=f.filterChangeset(T,_);F.push(...O)}if(f.afterChangesetApplied(F),f.tree&&f.isSorted&&f.reapplySortersOnAdd&&(g!=null&&g.length||y!=null&&y.length)){const O=new Set;F.forEach(M=>{O.has(M)||(O.add(M),M.sortVisibleChildren(!1,f.sorterFn),M.sortUnfilteredChildren(!1,f.sorterFn))}),f.storage.replaceValues({values:f.collectDescendants(f.rootNode).visible,silent:!0}),f.afterPerformSort(!1)}return f._groupVisibleRecordIds=null,f.trigger("endApplyChangeset"),C}afterChangesetApplied(t){const i=new Set;t.forEach(r=>{i.has(r)||r.traverse(n=>{i.has(n)||(i.add(n),n.sortOrderedChildren(!1,!1),n.children&&n.updateChildrenIndices(n.children,"parentIndex",!0),n.unfilteredChildren&&n.updateChildrenIndices(n.unfilteredChildren,"unfilteredIndex",!0))})})}applyRemovals(t){const i=this,{removed:r}=i,n=i.modelClass.idField,l=[];for(const a of t){const o=w.getPath(a,n);if(r.includes(o)){const u=r.get(o);u.clearChanges(!1,!0,null),u.$isPhantom=!0,r.remove(o)}else l.push(o)}i.remove(l);for(const a of l)r.remove(a)}filterChangeset(t,i){const r=this,{isFiltered:n,tree:l,isGrouped:a,filtersFunction:o}=r,u=r.isSorted?r.createSorterFn(r.sorters):void 0,{allValues:c,addedValues:d,isSorted:f}=r.storage,g=u!=null||f?u!=null?u:r.storage.sortFunction:null,h=new Set;if(!n)return[];let p=!1,m;if(a&&(m=r.groupers,r.clearGroupers(!0)),l){const b=new Set(i.filter(o));for(const C of t.filter(o))b.add(C);b.forEach(C=>C.bubble(T=>b.add(T))),b.delete(r.rootNode);const S=V.groupBy(Array.from(b).filter(C=>{var T,_;return!((_=(T=C.parent)==null?void 0:T.children)!=null&&_.includes(C))}),"parentId");for(const C of Object.values(S)){const{parent:T}=C[0];T.unfilteredChildren&&(T.children.push(...C),h.add(T))}}else if(g&&!a){const{filteredValues:b}=r.storage,S=d?b.findLastIndex(_=>!d.has(_))+1:b.length,C=b.slice(0,S),T=new Set(i.filter(o));for(const _ of b)T.has(_)&&T.delete(_);for(const _ of T)C.push(_);C.sort(g),b.splice(0,S,...C),p=!0}else{const b=i.filter(S=>o(S)&&!r.storage.includes(S));b.length>0&&(r.includeInSubset(c,r.storage.filteredValues,b),p=!0)}const y=new Set(t.filter(b=>!o(b)));if(y.size>0){if(l)for(const b of y)V.remove(b.parent.children,b),h.add(b.parent);else V.remove(r.storage.filteredValues,y);p=!0}return m&&(r.group(m[0],null,!1,!0,!0),p=!0),l&&h.size>0?r.storage.replaceValues({values:r.collectDescendants(r.rootNode).visible,silent:!0}):p&&(r._idMap=null,r.trigger("refresh")),[...h]}includeInSubset(t,i,r){const n=new Set(r);let l=0,a=0,o=n.size===0;for(;a<t.length&&!o;){const u=i[l];let c=t[a];for(;u!==c;)n.has(c)&&(i.splice(l,0,c),l++,n.delete(c),o=n.size===0),c=t[++a];n.has(u)&&n.delete(u),l<i.length&&l++}return i}},Ml=s=>class extends(s||R){static get $name(){return"StoreFilter"}static get defaultConfig(){return{filters:null,reapplyFilterOnAdd:!1,reapplyFilterOnUpdate:!1}}set reapplyFilterOnAdd(t){this.storage.autoFilter=t}get reapplyFilterOnAdd(){return this.storage.autoFilter}set filters(t){const i=this,r=i.filters;if(r.clear(),i._filtersFunction=null,t){if(t.constructor.name==="Object")for(const n of Object.entries(t))n[0]==="filterBy"&&typeof n[1]=="function"?r.add(new me({filterBy:n[1]})):r.add(new me(n[1].constructor.name==="Object"?Object.assign({property:n[0]},n[1]):{property:n[0],value:n[1]}));else Array.isArray(t)?r.add(...t.map(n=>n instanceof me?n:new me(n))):t.isCollection?r.add(...t.values):r.add(new me({filterBy:t}));r.forEach(n=>n.owner=i)}}get filters(){return this._filters||(this._filters=new vt({extraKeys:["property"]}))}set filtersFunction(t){this._filtersFunction=t}get filtersFunction(){const t=this,{filters:i,isGrouped:r}=t;if(!t._filtersFunction)if(i.count){const n=me.generateFiltersFunction(i);t._filtersFunction=l=>r&&l.isSpecialRow?l.groupChildren.some(n):n(l)}else t._filtersFunction=re.returnTrue;return t._filtersFunction}get isFiltered(){return this.filters.values.some(t=>!t.disabled)}traverseFilter(t){const i=this,r=!t.isRoot&&i.filtersFunction(t),n=t.unfilteredChildren||t.children;return!n||!n.length?r:(t.unfilteredChildren||(t.unfilteredChildren=t.children.slice()),t.children=t.unfilteredChildren.filter(l=>i.traverseFilter(l)),i.isSorted&&t.children.sort(i.sorterFn),t.updateChildrenIndices(t.unfilteredChildren,"unfilteredIndex",!0),t.updateChildrenIndices(t.children,"parentIndex",!0),r||!!t.children.length)}traverseClearFilter(t){const i=this;t.unfilteredChildren&&(t.children=t.orderedChildren.slice(),t.unfilteredChildren=null),t.children&&(i.isSorted&&t.children.sort(i.sorterFn),t.children.forEach(r=>i.traverseClearFilter(r)),t.updateChildrenIndices(t.children,"parentIndex",!0))}get latestFilterField(){return this.filters.last?this.filters.last.property:null}addFilter(t,i=!1){const r=this;if(t=t instanceof me?t:new me(t),t.owner=r,r.filters.add(t),!i){if(r.remoteFilter)return r.filter().then(()=>t);r.filter()}return t}filter(t){const i=this;let r=!1,n;if(t){let a=typeof t;if(a==="object"&&("silent"in t||"replace"in t||t.filters)&&(r=t.silent,t.replace&&i.clearFilters(t.filters.length===0),n=t.internal,t=t.filters,a=typeof t),t){const o=i.isFiltered;if(i.isConfiguring=!0,Array.isArray(t))t.forEach(u=>i.addFilter(u,!0),i);else if(a==="function"){const u=new me(t);u.internal=n,i.addFilter(u,!0)}else a==="string"?i.addFilter({property:t,value:arguments[1]},!0):i.addFilter(t,!0);if(i.isConfiguring=!1,!i.isFiltered&&!o)return null}}i.filtersFunction=null;const l=i.performFilter(r);return i._idMap=null,l}performFilter(t){const i=this,{storage:r,filters:n,rootNode:l}=i,a=i.count;i.trigger("beforeFilter",{filters:n});let o,u;if(i.tree){const c=r.values;i.isFiltered?i.traverseFilter(l):i.traverseClearFilter(l);const d=i.collectDescendants(l).visible;r.replaceValues({values:d,silent:!0});const f=V.delta(d,c,!0);o=f.toAdd,u=f.toRemove}else r.ion({change({removed:c,added:d}){u=c,o=d},once:!0}),i.isFiltered?(i.isGrouped&&i.includeCollapsed(),r.addFilter({id:"primary-filter",filterBy:i.filtersFunction}),i.isGrouped&&i.excludeCollapsed()):r.filters.clear();i.afterPerformFilter(t||i.isRemoteDataLoading?null:{action:"filter",filters:n,oldCount:a,added:o,removed:u,records:i.storage.values})}afterPerformFilter(t){this.resetRelationCache(),t&&this.triggerFilterEvent(t)}triggerFilterEvent(t){this.trigger("filter",t),this.remoteFilter||(this.trigger("refresh",t),this.trigger("change",t))}filterBy(t){return this.filter(t)}removeFilter(t,i=!1){const r=this,n=t instanceof me?t:r.filters.get(t);if(n){if(r.filters.remove(n),r._filtersFunction=null,!i){if(r.remoteFilter)return r.filter().then(()=>n);r.filter()}return n}}clearFilters(t=!0){if(this.filters.remove(this.filters.values.filter(i=>!i.internal)),t)return this.filter()}convertFilterToString(t){const i=this.filters.getBy("property",t);return i&&!i.filterBy?String(i):""}doDestroy(){var t;(t=this._filters)==null||t.destroy(),super.doDestroy()}},yc={add:1,replace:1},vc=({_groupValue:s},{_groupValue:e})=>s<e?-1:s>e?1:0,Il=s=>{var e;return e=class extends(s||R){static get properties(){return{collapsedGroups:new Set}}construct(t){super.construct(t),this.ion({change:"onDataChanged",thisObj:this})}get GroupRow(){var t;return this._GroupRowClass||(this._GroupRowClass=(t=class extends this.modelClass{get isCollapsed(){return this.meta.collapsed}},x(t,"isSpecialRow",!0),x(t,"fields",[{name:"_groupValue"}]),t))}updateGroupers(t){this.setGroupers(t)}setGroupers(t,i=null){const r=this,{storage:n}=r;let l;return t!=null&&t.length?r._groupers=t:r.groupers&&(delete r._groupers,r.includeCollapsed(),n.replaceValues({values:r.removeHeadersAndFooters(n._values),filteredValues:n.isFiltered?r.removeHeadersAndFooters(n._filteredValues):null,silent:!0}),l=r.group(null,null,null,!1,i==null?void 0:i.silent)),r._idMap=null,l}get unfilteredGroupRecords(){var t;const i=this;if(i.isGrouped){const{generation:r}=i.storage;((t=i._unfilteredGroupRecords)==null?void 0:t.generation)!==r&&(i._unfilteredGroupRecords=i.storage.allValues.filter(n=>n.isSpecialRow),i._unfilteredGroupRecords.generation=r)}return i._unfilteredGroupRecords||[]}getGroupHeaderForRecord(t,i=!1){if(this.isGrouped)return t?t.meta.groupRowFor?t:t.groupParent.get(this.id):this.groupRecords.last}includeCollapsed(){for(const t of this.collapsedGroups)this.expand(this.getById(t),!1)}excludeCollapsed(){for(const t of this.collapsedGroups)this.collapse(this.getById(t))}onDataChange({source:t,action:i,removed:r}){var n;const l=this,{groupers:a}=l;a&&(a.length?(i==="splice"&&(r!=null&&r.length)||i==="move")&&t.replaceValues({...l.prepareGroupRecords(),silent:!0}):t.replaceValues({values:l.removeHeadersAndFooters(t._values),filteredValues:t.isFiltered?l.removeHeadersAndFooters(t._filteredValues):null,silent:!0})),(n=super.onDataChange)==null||n.call(this,...arguments)}move(t,i){const r=this;if(r.isGrouped&&!r.tree){let n=i;if(i!=null&&i.isSpecialRow&&(n=r.getPrev(i,!1,!1),!n))return;const l=r.getGroupHeaderForRecord(n),a=r.groupers[0].field,o=l.meta.groupRowFor,{reapplyFilterOnUpdate:u}=r;if(r.reapplyFilterOnUpdate=!1,r.beginBatch(),t.forEach(c=>c.setValue(a,o)),r.endBatch(),r.reapplyFilterOnUpdate=u,r.isFiltered&&(i!=null&&i.isSpecialRow)){const{unfilteredGroupRecords:c}=r,d=c.indexOf(l);i=c[d+1]}}super.move(t,i)}collapse(t){return t&&!t.meta.collapsed?(this.excludeGroupRecords(t),t.meta.collapsed=!0,this.collapsedGroups.add(t.id),this.trigger("toggleGroup",{groupRecord:t,collapse:!0}),!0):!1}expand(t,i=!0){return t!=null&&t.meta.collapsed?(this.includeGroupRecords(t),t.meta.collapsed=!1,i&&this.collapsedGroups.delete(t.id),i&&this.trigger("toggleGroup",{groupRecord:t,collapse:!1}),!0):!1}removeHeadersAndFooters(t){return t.filter(i=>{var r;return i.unfilteredGroupChildren&&(i.groupChildren.length=i.unfilteredGroupChildren.length=i.meta.childCount=0),i.isSpecialRow||i.isLinked&&((r=i.groupParent)!=null&&r.get(this.id))?(this.unregister(i),!1):!0})}prepareGroupRecords(){var t;const i=this,{GroupRow:r,isFiltered:n,reapplyFilterOnUpdate:l,groupRecords:a}=i,o=i.groupers[0],u=o.ascending!==!1?1:-1,{field:c,fn:d=vc}=o,f=typeof c=="function",g=c===i.modelClass.idField,h=new vt,p=i._groupVisibleRecordIds||[],m=C=>{const T=!n||i.filtersFunction(C);return l?T:T||p.includes(C.id)},y=!!(i.startGroupsCollapsed&&!(a!=null&&a.count));a==null||a.forEach(C=>{C.isCollapsed&&i.includeGroupRecords(C)});const b=i.removeHeadersAndFooters(i.storage._values);if(i.sorters.length&&b.sort(i.sorterFn),n&&(i.filtersFunction=null),b.forEach(C=>{const T=C,_=f?c(C):C[c],L=V.asArray(_==null?"__novalue__":_),F=Array.isArray(L),O=F&&!L.length,M=O?1:L.length;for(let P=0;P<M;P++){const W=O?[]:L[P],H=`group-header-${typeof W=="number"?W:k.createId(W)}`;let I=h.get(H);if(I||(I=(a==null?void 0:a.get(H))||new r({[i.modelClass.idField]:H,[g?"":c]:W,_groupValue:W},i,{collapsed:y,specialRow:!0,groupRowFor:W,groupField:c,emptyArray:O}),h.add(I),I.meta.childCount=0,I.groupChildren=[],I.unfilteredGroupChildren=[],I.stores=[i]),i.register(I),P>0){const Y=T.groupLinks||(T.groupLinks=[]);C=Y[W]||(Y[W]=T.link()),C.stores=[i],i.register(C)}C.groupParent||C.setData("groupParent",new Map),C.groupParent.set(i.id,I),m(C)&&(I.groupChildren.push(C),I.meta.childCount++),I.unfilteredGroupChildren.push(C)}}),h._values.sort((C,T)=>d(C,T)*u),i.useGroupFooters)for(let C=0,T=h.count;C<T;C++){const _=h.values[C],L=_.meta.groupRowFor,F=`group-footer-${typeof L=="number"?L:k.createId(L)}`,O=i.getById(F)||new r({[i.modelClass.idField]:F,[g?"":c]:L,_groupValue:L},i,{specialRow:!0,groupFooterFor:L,groupRecord:_});O.stores=[i],i.register(O),O.groupChildren=_.groupChildren,h.splice(++C,0,O),T++,_.groupChildren.push(O),_.unfilteredGroupChildren.push(O),_.meta.childCount++}i._idMap=null;const S={values:h.reduce((C,T)=>(T.isGroupFooter||(C.push(T),T.meta.collapsed||C.push(...T.unfilteredGroupChildren)),C),!1,[])};return n&&(S.filteredValues=S.values.filter(m)),(t=i.groupRecords)==null||t.forEach(C=>{h.includes(C)||C.destroy()}),i.groupRecords=h,S}get isGrouped(){var t;return!!((t=this.groupers)!=null&&t.length)}group(t,i,r=!1,n=!0,l=!1){var a,o;const u=this;let c,d;if(t&&typeof t=="object"&&(i=t.ascending,d=t.fn,t=t.field),r?u.groupers.push(c={field:t,ascending:i,complexMapping:t.includes(".")}):t&&(i==null&&(i=((a=u.groupInfo)==null?void 0:a.field)===t&&((o=u.groupInfo)==null?void 0:o.fn)===d?!u.groupInfo.ascending:!0),u.groupInfo=c={field:t,ascending:i,fn:d,complexMapping:t.includes(".")},u.groupers=[u.groupInfo]),c){const{prototype:f}=u.modelClass;c.complexMapping&&!Object.prototype.hasOwnProperty.call(f,t)&&Object.defineProperty(f,t,{get(){return w.getPath(this,t)}})}if(n!==!1){if(u.remoteSort&&!u.isRemoteDataLoading)return u.sort(null,null,!1,!0).then(()=>u.onAfterGrouping(l));u.sort(null,null,!1,!0)}u.onAfterGrouping(l)}onAfterGrouping(t){if(t)return;const i=this,r=i.groupers||[];i.trigger("group",{isGrouped:i.isGrouped,groupers:r,records:i.storage.values}),i.trigger("refresh",{action:"group",isGrouped:i.isGrouped,groupers:r,records:i.storage.values})}addGrouper(t,i=!0){return this.group(t,i,!0)}removeGrouper(t){const i=this,{groupers:r}=i;if(!r)return;const n=r.findIndex(l=>l.field===t);if(n>-1)return r.splice(n,1),r.length?i.group():i.clearGroupers()}clearGroupers(t=!1){return this.setGroupers(null,{silent:t})}isRecordInGroup(t,i){var r;if(!this.isGrouped)return null;const n=(r=this.groupers[0])==null?void 0:r.field;return t.getValue(n)===i&&!t.isSpecialRow}isInCollapsedGroup(t){const i=t.groupParent.get(this.id);return i==null?void 0:i.meta.collapsed}getGroupRecords(t){return this.isGrouped?this.storage.values.filter(i=>this.isRecordInGroup(i,t)):null}getGroupTitles(){return this.isGrouped?this.getDistinctValues(this.groupers[0].field):null}onDataChanged({changes:t,action:i}){this.isGrouped&&(!t&&yc[i]||t&&this.groupers.some(r=>r.field in t))&&this.sort()}internalIncludeExcludeGroupRecords(t,i){const r=this,n=r.indexOf(t),l=r.allIndexOf(t),{id:a,storage:o}=r,{_filteredValues:u,_values:c}=o,{meta:d,groupChildren:f,unfilteredGroupChildren:g}=t;l===-1||d.collapsed&&!i||!d.collapsed&&i||(g.forEach(h=>h.instanceMeta(a).hiddenByCollapse=!i),i?(u&&u.splice(n+1,0,...f.filter(h=>!r.isAvailable(h))),o._values.splice(l+1,0,...g.filter(h=>!r.isAvailable(h)))):(u&&u.splice(n+1,f.length),c.splice(l+1,g.length)),o._indicesInvalid=!0,r._idMap=null)}excludeGroupRecords(t){this.internalIncludeExcludeGroupRecords(t,!1)}includeGroupRecords(t){this.internalIncludeExcludeGroupRecords(t,!0)}collectGroupRecords(t,i=!0){return(t?this.storage.allValues:this.storage.values).reduce((n,l)=>(l.isSpecialRow&&(i&&!l.isGroupFooter&&n.push(l),l.isGroupHeader&&n.push.apply(n,l.groupChildren)),n),[])}},x(e,"$name","StoreGroup"),x(e,"configurable",{groupers:null,useGroupFooters:!1,startGroupsCollapsed:null}),e},Ol=s=>class extends(s||R){static get configurable(){return{objectify:null}}initProxy(){if(!globalThis.Proxy)throw new Error("Proxy not supported");return new Proxy(this,{get(i,r){if(r in i)return i[r];if(r==="$store")return i;let n=i.getById(r);return!n&&!isNaN(parseInt(r))&&(n=i.getAt(parseInt(r))),n},set(i,r,n){return r in i||i.isDestroying||r==="_triggered"?i[r]=n:i.add({[i.modelClass.idField]:r,...n}),!0},deleteProperty(i,r){return i.isDestroying?(delete i[r],!0):!!i.remove(r).length},has(i,r){if(r in i)return!0;if(r.startsWith("{")&&r.endsWith("}")){const n=k.safeJsonParse(r);r=n==null?void 0:n.id}return i.includes(r)}})}},Fl=s=>{var e;return e=class extends(s||R){initRelations(t){const i=this,r=i.modelClass.exposedRelations;t&&i.modelRelations&&i.modelRelations.forEach(n=>{var l;return(l=n.storeDetacher)==null?void 0:l.call(n)}),(!i.modelRelations||i.modelRelations.length===0||t)&&r&&(i.modelRelations=[],r==null||r.forEach(n=>{const l={...n},{foreignStore:a,relationName:o,relatedCollectionName:u}=l,c=typeof a=="string"?i[a]:a;if(l.dependentStore=i,i.modelRelations.push(l),c){l.foreignStoreProperty=l.foreignStore,l.foreignStore=c;const d=c.dependentStoreConfigs;if(d.has(i)){const f=d.get(i);if(t){const g=f.find(h=>h.relationName===o);g&&V.remove(f,g)}f.push(l)}else d.set(i,[l]);u&&c.initRelationCollection(l,i),c.count>0&&c.updateDependentStores("dataset",c.records)}}))}initRelationCollection(t,i){const r=this,n=t.relatedCollectionName,l=r.collectionStores||(r.collectionStores={});l[n]={store:i,config:t},r[n+"Store"]||(r[n+"Store"]=i),r.count>0&&r.initModelRelationCollection(n,r.allRecords)}initModelRelationCollection(t,i){const r=this;i.forEach(n=>{n.traverse(l=>{const a=t in l?`$related${k.capitalize(t)}`:t;Object.defineProperty(l,a,{enumerable:!0,configurable:!0,get:function(){return r.getCollection(this,t)},set:function(o){return r.setCollection(this,t,o)}})})})}resetRelationCache(){this.relationCache={},this.forEach(t=>t.initRelations())}updateRecordRelationCache(t,i){i==null||i.forEach(r=>{const{config:n}=r,l=r.related?r.related.id:t.getValue(n.foreignKey);l!==void 0&&this.cacheRelatedRecord(t,l,n.relationName,l)})}getRelationCollection(t,i){var r;const n=ue.asId(i);return((r=this.relationCache[t])==null?void 0:r[n])||[]}getCollection(t,i){var r;const{config:n,store:l}=this.collectionStores[i];return((r=l.relationCache[n.relationName])==null?void 0:r[t.id])||[]}setCollection(t,i,r){const{config:n,store:l}=this.collectionStores[i],a=l.relationCache[n.relationName]||(l.relationCache[n.relationName]={}),o=(a[t.id]||[]).slice(),u=[],c=[];l.suspendEvents(),o.forEach(d=>{r.includes(d)||(d[n.foreignKey]=null,l.remove(d),c.push(d))}),r.forEach(d=>{d.isModel instanceof ue?d.stores.includes(l)||(l.add(d),u.push(d)):([d]=l.add(d),u.push(d)),d[n.foreignKey]=t.id}),l.resumeEvents(),c.length&&(l.trigger("remove",{records:c}),l.trigger("change",{action:"remove",records:c})),u.length&&(l.trigger("add",{records:u}),l.trigger("change",{action:"add",records:u}))}cacheRelatedRecord(t,i,r,n=null){const l=this,a=l.relationCache[r]||(l.relationCache[r]={});n!==null&&l.uncacheRelatedRecord(t,r,n),i!=null&&V.include(a[i]||(a[i]=[]),t)}uncacheRelatedRecord(t,i=null,r=null){const n=this;function l(a,o){const u=n.relationCache[a],c=u==null?void 0:u[o];if(c){const d=c.indexOf(t);d>=0&&c.splice(d,1),c.length===0&&delete u[o]}}r!=null?l(i,r):t.meta.relationCache&&Object.entries(t.meta.relationCache).forEach(([a,o])=>l(a,o==null?void 0:o.id))}updateDependentStores(t,i){this.dependentStoreConfigs.forEach(r=>{r.forEach(n=>{const{dependentStore:l,relatedCollectionName:a,relationName:o,foreignKey:u}=n,c=l.relationCache[o];if(t==="dataset"){a&&this.initModelRelationCollection(a,i),l.forEach(d=>{const f=d.initRelation(n);f&&l.cacheRelatedRecord(d,f.id,o,f.id)});return}if(t==="removeall"){l.forEach(d=>d.removeRelation(n)),delete l.relationCache[o];return}t==="replace"&&(i=i.map(d=>d[1])),(t==="add"||t==="replace")&&a&&this.initModelRelationCollection(a,i),(t==="add"||t==="replace"||t==="remove")&&i.forEach(d=>{const f=c==null?void 0:c[d.id];switch(t){case"remove":f&&f.forEach(g=>g.removeRelation(n));break;case"add":case"replace":l.forEach(g=>{g.getValue(u)==d.id&&(g.initRelation(n),l.cacheRelatedRecord(g,d.id,o))});break}})})})}updateDependentRecordIds(t,i){var r;(r=this.dependentStoreConfigs)==null||r.forEach(n=>{n.forEach(l=>{var a;const{dependentStore:o,relationName:u,foreignKey:c}=l,d=o.relationCache[u],f=(a=d==null?void 0:d[t])==null?void 0:a.slice();f==null||f.forEach(g=>{o.cacheRelatedRecord(g,i,u,t),g.set(c,i,!1,!0)})})})}},x(e,"$name","StoreRelation"),e},Ll=s=>class extends(s||R){static get $name(){return"StoreSum"}sum(t,i=this.storage.values){return i?i.reduce((r,n)=>{if(n.isSpecialRow)return r;const l=Number(n.getValue(t));return isNaN(l)?r:r+l},0):0}min(t,i=this.storage.values){return i!=null&&i.length?i.reduce((r,n)=>{const l=n.getValue(t);return typeof(l==null?void 0:l.valueOf())==="number"&&l<r&&(r=l),r},i[0].getValue(t)):0}max(t,i=this.storage.values){return i!=null&&i.length?i.reduce((r,n)=>{const l=n.getValue(t);return typeof(l==null?void 0:l.valueOf())==="number"&&l>r&&(r=l),r},i[0].getValue(t)):0}average(t,i=this.storage.values){if(!(i!=null&&i.length))return 0;let r=0;const n=i.reduce((l,a)=>{if(a.isSpecialRow)return l;const o=parseFloat(a.getValue(t));return isNaN(o)?l:(r++,l+o)},0);return r>0?n/r:0}groupSum(t,i){return this.sum(i,this.getGroupRecords(t))}},fs=(s,e)=>String(s).toLowerCase().includes(e),kl={string:fs,number:fs,boolean:fs,date:(s,e)=>s instanceof Date&&e instanceof Date?s-e===0:String(s.getMonth()+1).includes(e)||String(s.getDate()).includes(e)||String(s.getFullYear()).includes(e),object:(s,e)=>s===e,undefined:(s,e)=>s===e},Al=s=>class extends(s||R){static get $name(){return"StoreSearch"}search(t,i=null,r,n){const l=this.isTree&&!n?this.rootNode.allChildren:this.getAllDataRecords(n),a=l.length,o=[];if(t==null)return[];typeof t=="string"&&(t=t.toLowerCase());let u,c,d,f,g,h;for(u=0;u<a;u++){d=l[u],c=0;for(const p of i||d.fieldNames){f=d.getValue(p),g=f instanceof Date?"date":typeof f;const m=r==null?void 0:r[c];m&&(f=m(f),g="string"),h=kl[g],f&&(h!=null&&h(f,t))&&o.push({index:u,data:d,field:p,id:d.id}),c++}}return o}findByField(t,i,r=!1,n=!1){const l=this.getAllDataRecords(n),a=l.length,o=new Set,u=[];let c,d,f;for(i!=null&&(i=String(i).toLowerCase()),c=0;c<a;c++)if(d=l[c],f=d.getValue(t),!r||!o.has(f)){const g=f instanceof Date?"date":typeof f,h=kl[g];(i==null&&f===i||i===""&&f===""||i&&h(f,i))&&(u.push({id:d.id,index:c,data:d}),r&&o.add(f))}return u}find(t,i=!1){return this.getAllDataRecords(i).find(t)}findRecord(t,i,r=!1){const n=l=>w.isEqual(l[t],i);return this.isTree?this.query(n,r)[0]:this.getAllDataRecords(r).find(n)}query(t,i=!1){if(this.isTree){const r=[];return this.traverse(n=>{t(n)&&r.push(n)},void 0,void 0,i),r}return this.getAllDataRecords(i).filter(t)}some(t,i=!1){return this.getAllDataRecords(i).some(t)}},Pl=s=>class extends(s||R){static get $name(){return"StoreSort"}static get defaultConfig(){return{useLocaleSort:null}}static get configurable(){return{sorters:[],reapplySortersOnAdd:!1}}get isSorted(){return!!this.sorters.length||this.isGrouped}changeSorters(t){return t.map(i=>this.normalizeSorterConfig(i,!0))}updateReapplySortersOnAdd(t){this.storage.autoSort=t}sort(t,i,r=!1,n=!1){const l=this,a=l.allRecords,o=l.sorters?l.sorters.slice():[];let u=null,c;if(t)if(Array.isArray(t))l.sorters=t.map(d=>l.normalizeSorterConfig(d,typeof d=="string"?!0:i));else{const d=l.normalizeSorterConfig(t,i);r?(c=l.getCurrentSorterByField(d.field),c?(u=c.ascending,c.ascending=d.ascending):l.sorters.push(d)):l.sorters=[d]}return!n&&l.trigger("beforeSort",{sorters:l.sorters,records:a,currentSorters:o})===!1?(l.sorters=o,u!==null&&(c.ascending=u),null):l.performSort(n)}normalizeSorterConfig(t,i){var r,n,l;const a=this,o={ascending:i};if(typeof t=="object"?(w.assign(o,t),t.fn&&(delete o.fn,o.sortFn=t.fn),o.ascending=(r=t.ascending)!=null?r:i):typeof t=="function"?o.sortFn=t:o.field=t,o.ascending==null){const u=a.getCurrentSorterByField(o.field);o.ascending=u?!u.ascending:!0}if(o.sortFn==null){const u=(l=(n=a.modelClass)==null?void 0:n.$meta.fields.map[o.field])==null?void 0:l.compareItems;u&&(o.sortFn=u)}return o}getCurrentSorterByField(t){return typeof t=="string"&&this.sorters.find(i=>i.field===t)||null}addSorter(t,i=!0){return this.sort(t,i,!0)}removeSorter(t){const i=this.sorters.findIndex(r=>r.field===t||r.sortFn===t);if(i>-1)return this.sorters.splice(i,1),this.sort()}clearSorters(t=!1){if(this.sorters.length)return this.sorters.length=0,this.sort(void 0,void 0,void 0,t)}createSorterFn(t){const i=this.useLocaleSort;return(r,n)=>{for(let l=0;l<t.length;l++){const a=t[l],{field:o,ascending:u=!0,useLocaleSort:c=i}=a,d=a.fn||a.sortFn,f=u?1:-1;if(d){const p=d.call(a,r,n);if(p===0)continue;if(p!==null)return p*f}const g=r.isModel?r.getValue(o):r[o],h=n.isModel?n.getValue(o):n[o];if(g!==h){if(g==null)return-f;if(h==null)return f;if(c&&typeof g=="string"){if(c===!0)return String(g).localeCompare(h)*f;if(typeof c=="string")return String(g).localeCompare(h,c)*f;if(typeof c=="object")return String(g).localeCompare(h,c.locale,c)*f}if(g>h)return f;if(g<h)return-f}}return 0}}get sorterFn(){return this.createSorterFn(this.remoteSort?[{field:"_remoteSortIndex"}]:this.sorters)}performSort(t){const i=this,{rootNode:r,storage:n,sorterFn:l}=i;i.tree?(!i.isChained&&r.traverse(a=>{a.isLoaded&&a.isParent&&(a.children.sort(l),a.updateChildrenIndices(a.children,"parentIndex",!0))}),n.replaceValues({values:i.collectDescendants(r).visible,silent:!0})):i.isGrouped?n.replaceValues({...i.prepareGroupRecords(),silent:!0}):n.replaceValues({values:n.values.sort(l),silent:!0}),i.afterPerformSort(t||i.isRemoteDataLoading)}afterPerformSort(t){if(t)return;const i=this;i._idMap=null;const r={action:"sort",sorters:i.sorters,records:i.allRecords};i.trigger("sort",r),i.trigger("refresh",r)}},Rl=()=>!0,$l=s=>class extends(s||R){static get $name(){return"StoreChained"}static get defaultConfig(){return{chainedFilterFn:null,chainedFields:null,masterStore:null,doRelayToMaster:["add","remove","insert"],dontRelayToMaster:[],excludeCollapsedRecords:!0,chainSuspended:0}}static get properties(){return{chainedStores:null}}construct(t){super.construct(t);const i=this,{masterStore:r}=i,n=i.syncOrder?"sort":"";r&&(i.methodNamesToRelay.forEach(l=>i[l]=(...a)=>i.relayToMaster(l,a)),i.removeAll=(...l)=>{r.remove(i.getRange(),...l)},r.ion({changePreCommit:i.onMasterDataChangedPreCommit,change:i.onMasterDataChanged,[n]:i.onMasterDataChanged,prio:1,thisObj:i}),r.chainedStores||(r.chainedStores=[]),r.chainedStores.push(i),i.fillFromMaster())}get $master(){return this.masterStore||this}get isChained(){return!!this.masterStore}set chainedFilterFn(t){this._chainedFilterFn=this.thisObj?t.bind(this.thisObj):t}get chainedFilterFn(){return this._chainedFilterFn||Rl}get methodNamesToRelay(){const t=Array.isArray(this.doRelayToMaster),i=Array.isArray(this.dontRelayToMaster);return t&&this.doRelayToMaster.filter(r=>!i||!this.dontRelayToMaster.includes(r))||[]}updateChainedStores(){this.chainedStores&&this.chainedStores.forEach(t=>t.fillFromMaster())}fillFromMaster(){const t=this,{masterStore:i,isTree:r}=t;let n=[];if(!t.isChained)throw new Error("fillFromMaster only allowed on chained store");if(!t.isChainSuspended){if(i.isGrouped&&i.isFiltered?i.forEach(l=>n.push(l),i,{includeFilteredOutRecords:!0,includeCollapsedGroupRecords:!0}):n=i.allRecords.filter(l=>!l.isSpecialRow&&t.chainedFilterFn(l)),r&&(t.idRegister={},t.internalIdRegister={},n.forEach(l=>{l.stores.includes(t)?t.register(l):l.joinStore(t)}),t.excludeCollapsedRecords)){const l=t.getChildren(t.rootNode);n=t.doIncludeExclude(l,!0)}t.isFillingFromMaster=!0,t.data=n,t.isFillingFromMaster=!1}}commitToMaster(){const t=this,i=t.masterStore;if(!t.isChained)throw new Error("commitToMaster only allowed on chained store");return i.beginBatch(),i.remove(t.removed.values),i.add(t.added.values),i.endBatch(),t.commit()}relayToMaster(t,i){return this.masterStore[t](...i)}onMasterDataChangedPreCommit(t){this.onMasterDataChanged(t),this.$masterEventhandled=!0}onMasterDataChanged({action:t,changes:i,$handled:r,isMove:n}){var l;if(this.$masterEventhandled){this.$masterEventhandled=!1;return}n&&t==="remove"||(t!=="update"||(l=this.chainedFields)!=null&&l.some(a=>a in i))&&this.fillFromMaster()}makeChained(t=Rl,i,r){if(this.isChained){const n=t;t=l=>n(l)&&this.chainedFilterFn(l)}return new((r==null?void 0:r.storeClass)||this.constructor)({storeId:void 0,id:`${this.id}-chained-${k.generateUUID()}`,...r||{},tree:!1,autoTree:!1,masterStore:this.$master,modelClass:this.modelClass,syncDataOnLoad:!1,chainedFilterFn:t,chainedFields:i})}chain(){return this.makeChained(...arguments)}doDestroy(){var t;(t=this.chainedStores)==null||t.forEach(i=>i.destroy()),super.doDestroy()}suspendChain(){this.chainSuspended++}resumeChain(t=!1){this.chainSuspended&&!--this.chainSuspended&&t&&this.fillFromMaster()}get isChainSuspended(){return this.chainSuspended>0}},Nl=s=>class extends(s||R){static get $name(){return"StoreState"}getState(){const{sorters:t,groupers:i,filters:r}=this,n={};return t!=null&&t.length&&(n.sorters=t.map(l=>{const a=w.cleanupProperties(w.clone(l));return delete a.fn,delete a.sortFn,a})),i!=null&&i.length&&(n.groupers=i.map(l=>{const a=w.cleanupProperties(w.clone(l));return delete a.fn,a})),r!=null&&r.values.length&&(n.filters=r.values.map(l=>{const a=w.cleanupProperties(w.clone(l.config));return a.value=l.value,a.caseSensitive&&delete a.caseSensitive,a})),n}applyState(t){const i=this,{sorters:r=[],groupers:n=[],filters:l=[]}=t,{sortParamName:a,filterParamName:o}=i;i.sorters=r.filter(u=>u.field||u.sortFn&&!a),i.groupers=n.slice(),i.sort(),i.filters=l.filter(u=>u.property||u.filterBy&&!o),i.filter()}},bc=s=>String(s).padStart(6,"0"),nr=class ze{constructor(e){this.value=e,this._padded=null}set value(e){this._value=String(e!=null?e:"")}get value(){return this._value}static from(e){return e==null||e instanceof ze?e:new ze(e)}static pad(e){return e instanceof ze?e.valueOf():ze.split(e).map(bc).join(".")}static split(e){let t,i;if(e||e===0)switch(typeof e){case"object":e=String(e);case"string":for(i=e.split("."),t=i.length;t-- >0;)i[t]=parseInt(i[t],10);break;case"number":i=[e];break}return i||[]}static compare(e,t){return e===t?0:!e||!t?e?1:t?-1:0:(e=ze.pad(e),t=ze.pad(t),e<t?-1:t<e?1:0)}append(e){const t=this.value;return ze.from(t?`${t}.${e}`:e)}isEqual(e){return!ze.compare(this,e)}match(e){let t=!1;if(e){const i=this.value,r=e[0]==="*",n=e.endsWith("*"),l=e.length;r===n?t=i.indexOf(r?e.substr(1,l-2):e)>-1:r?t=i.endsWith(e.substr(1)):t=i.startsWith(e.substr(0,l-1))}return t}toString(){return this.value}toJSON(){return this.toString()}valueOf(){var e;return(e=this._padded)!=null?e:this._padded=ze.pad(this.value)}};nr._$name="Wbs";var Cc=Object.freeze([]),vi=Symbol("StopBranch"),Vl=s=>{var e;return e=class extends(s||R){get StopBranch(){return vi}get isTree(){return this.tree||this.masterStore&&this.masterStore.tree}get leaves(){const t=this,i=[];return t.isTree?(t.traverse(r=>{r.isLeaf&&i.push(r)}),i):(t.allRecords.forEach(r=>{r.isLeaf&&i.push(r),r.traverse(n=>{n.isLeaf&&i.push(n)},!0)}),i)}async loadChildren(t){}onNodeAddChild(t,i,r,n,l=!1){var a;const o=this,u=t===o.rootNode&&t.isLoading,{storage:c}=o,{previousSibling:d}=i[0];let f;const{visible:g,all:h}=o.collectDescendants(i,void 0,void 0,{inCollapsedBranch:!(t.isExpanded(o)&&t.ancestorsExpanded(o)),applyFilter:o.isFiltered&&o.reapplyFilterOnAdd});if(!u&&h.length)for(const p of h)!o.modified.includes(p)&&!n[p.id]&&(o.removed.includes(p)?o.removed.remove(p):p.isLinked||o.added.add(p));if(u&&o.rootVisible&&(g.unshift(t),h.unshift(t)),g.length?(r===0||!d?f=c.indexOf(t):f=c.indexOf(d)+d.getDescendantCount(!0,o),c.suspendEvents(),o.storage.splice(++f,0,g),c.resumeEvents(),o._idMap=null):o._allRecords=null,o.updateDependentStores("add",i),u&&g.length){if(o.sorters.length&&o.sort(null,null,!1,!0),(a=o.afterLoadData)==null||a.call(o),!l){const p={action:"dataset",data:o._data,records:g};o.trigger("refresh",p),o.trigger("change",p)}}else if(!l){const p={action:"add",parent:t,isChild:!0,isMove:n,records:i,allRecords:h,index:f};if(o.trigger("add",p),o.trigger("change",p),Object.values(n).some(m=>m)){const m={newParent:t,records:i.filter(y=>n[y.id]),oldParents:i.map(y=>o.getById(y.meta.oldParentId))};o.trigger("move",m)}}}onNodeRemoveChild(t,i,r,n={isMove:!1,silent:!1,unfiltered:!1}){const l=this,{storage:a}=l,o=[],u=[],{isMove:c,silent:d,unfiltered:f}=n,g=f&&l.isFiltered,h=g&&t.unfilteredChildren?t.unfilteredChildren:i;if(l.collectDescendants(h,o,u,{inCollapsedBranch:!(t.isExpanded(l)&&t.ancestorsExpanded(l)),unfiltered:g}),!c){for(const p of i)p.unjoinStore(l);for(const p of u)p.stores.includes(l)&&p.unjoinStore(l),l.added.includes(p)?l.added.remove(p):p.isLinked||l.removed.add(p);l.modified.remove(u)}if(o.length?(r=a.indexOf(o[0]),r>-1&&(a.suspendEvents(),a.splice(r,o.length),a.resumeEvents(),l._idMap=null)):(r=-1,l._allRecords=null),!d&&(l.fireRemoveEventForMoveAction||!c)){const p={action:"remove",parent:t,isChild:!0,isMove:c,records:i,allRecords:u,index:r};l.trigger("remove",p),l.trigger("change",p)}return u}collectDescendants(t,i=[],r=[],n={}){var l;const a=this,{inCollapsedBranch:o=!1,unfiltered:u=!1,applyFilter:c=!1}=n,d=Array.isArray(t)?t:(l=a.getChildren(t,u))!=null?l:[];if(c)return{visible:d.flatMap(f=>this.collectVisibleNodeDescendantsFiltered(f)),all:d.flatMap(f=>f.allChildren)};for(let f=0,g=d.length,h;f<g;f++)h=d[f],o||i.push(h),r.push(h),a.collectDescendants(h,i,r,{inCollapsedBranch:o||!h.isExpanded(a),unfiltered:u});return{visible:i,all:r}}collectVisibleNodeDescendantsFiltered(t){const i=t.unfilteredChildren||t.children;if(!i||i.length===0||!t.isLeaf&&!t.isExpanded(this))return this.filtersFunction(t)?[t]:[];const r=i.flatMap(n=>this.collectVisibleNodeDescendantsFiltered(n));return r.length||this.filtersFunction(t)?[t,...r]:[]}getChildren(t,i=!1){const r=this,n=(i||r.isChained)&&t.unfilteredChildren||t.children;return n!=null&&n.length?r.isChained?n.filter(r.chainedFilterFn).sort(r.sorterFn):n:Cc}internalToggleTreeSubRecords(t,i){const r=this,{storage:n}=r,l=n.indexOf(t),a=r.doIncludeExclude(r.getChildren(t),i);if(r.isFiltered&&i&&t.unfilteredChildren&&r.updateChildrenHiddenState(t),a.length&&l!==!1){if(n.suspendEvents(),i){n.splice(l+1,0,...a);const o={action:"add",isExpand:!0,records:a,index:l+1};r.trigger("add",o),r.trigger("change",o)}else{n.splice(l+1,a.length);const o={action:"remove",isCollapse:!0,records:a,index:l+1};r.trigger("remove",o),r.trigger("change",o)}n.resumeEvents(),r._idMap=null}}updateChildrenHiddenState(t){var i;(i=t.unfilteredChildren)==null||i.forEach(r=>{r.instanceMeta(this.id).hidden=!1,r.isLeaf||this.updateChildrenHiddenState(r)})}doIncludeExclude(t,i,r=[]){const n=this,l=(t==null?void 0:t.length)||0;for(let a=0;a<l;a++){const o=t[a];if(!n.isChained||n.chainedFilterFn(o)){const u=o.instanceMeta(n.id);(i||!u.hidden)&&r.push(o),u.hidden=!i,o.isExpanded(n)&&n.doIncludeExclude(n.getChildren(o),i,r)}}return r}async toggleCollapse(t,i){const r=this,n=r.getById(t),l=n.instanceMeta(r);if(i===void 0&&(i=!l.collapsed),!l.isLoadingChildren&&!n.isLeaf&&n.isExpanded(r)===i){if(r.trigger("beforeToggleNode",{record:n,collapse:i}),l.collapsed=i,l.collapsed)return r.onNodeCollapse(n),!0;{r.onNodeExpand(n);let a=!0;if(!n.isLoaded){l.isLoadingChildren=!0;try{await r.loadChildren(n)}catch(o){l.collapsed=!0,a=!1,r.trigger("loadChildrenException",{record:n,exception:o})}finally{l.isLoadingChildren=!1}}return a}}}onNodeCollapse(t){if(t.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(t,!1)}onNodeExpand(t){if(t.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(t,!0)}transformToTree(t){const{parentIdField:i,idField:r,childrenField:n}=this.modelClass,l=new Map,a=new Set,o=[];for(const c of t){const d=c[r];d!=null&&l.set(d,c)}const u=c=>{const d=Object.assign({},c);return d[n]=[],l.set(d[r],d),a.add(c[r]),d};for(let c of t){const d=c[r];a.has(d)?c=l.get(d):c=u(c);const f=c[i];if(f!=null){let g=l.get(f);g&&(g[n]||(g=u(g)),g[n].push(c))}else c[n]?o.push(c):c[r]!=null?o.push(u(c)):o.push(c)}return l.forEach(c=>{var d,f;(f=(d=c[n]).sort)==null||f.call(d,(g,h)=>g.parentIndex-h.parentIndex)}),o}treeify(t,i,r=!1){const{length:n}=t,l=[],a=[],o={};let u,c;for(u=0;u<n;u++){let f=t[u];f=f.field||f,t[u].call||(t[u]=g=>g[f],t[u].fieldName=f),l[u]=new Map}this.rootNode.traverse(f=>{var g;if(c=[],f.isLeaf){for(u=0;u<n;u++){const h=((g=c[(c==null?void 0:c.length)-1])==null?void 0:g.path)||"",p=l[u],m=V.asArray(t[u](f))||[],y=[];if(m[0]===vi)break;for(let b=0,{length:S}=m;b<S;b++){const C=m[b],T=`${h+(C!=null&&C.isModel?C.id:C)}/`,_=k.makeValidDomId(`generated_${T}`,"_"),L=t[u].fieldName,F=p.get(_)||p.set(_,{id:_,key:C,path:T,expanded:!0,readOnly:!0,children:[],generatedParent:!0,field:L,firstGroupChild:f}).get(_);y.push(F)}c.forEach(b=>{y.forEach(S=>{b.children.includes(S)||b.children.push(S)})}),c=y}c.length?c.forEach((h,p)=>h.children.push(p?f.link():f)):a.push(f)}},!0),(i||r)&&l.forEach(f=>f.forEach((g,h,p)=>{i==null||i(g),r&&(g=this.createRecord(g),p.set(h,g))})),o.children=[...l[0].values(),...a];const d=f=>{f.children&&(f.children.sort((g,h)=>{if(g.isLeaf===h.isLeaf)if(g.isLeaf){let p;for(let m=0;!p&&m<n;m++){const y=t[m](g),b=t[m](h);if(y===vi||b===vi)return g.isLeaf<h.isLeaf?-1:g.isLeaf>h.isLeaf?1:0;p=y<b?-1:b>y?1:0}return p}else return typeof g.key=="string"&&typeof h.key=="string"?g.key.localeCompare(h.key,void 0,{numeric:!0}):g.key<h.key?-1:g.key>h.key?1:0;else return g.isLeaf<h.isLeaf?-1:g.isLeaf>h.isLeaf?1:0}),f.children.forEach(d))};return d(o),o}treeifyFlatData(t){const{childrenField:i,parentIdField:r}=this.modelClass;let n=!1,l=!0;for(const a of t){if(a.isModel||Array.isArray(a[i])){l=!1;break}a[r]!=null&&(n=!0)}return l&&n&&(t=this.transformToTree(t)),t}async indent(t){const i=this;if(t=Array.isArray(t)?t:[t],t=t.filter(r=>{let n=!!r.previousSibling;for(;n&&!r.isRoot;)n=!t.includes(r.parent),r=r.parent;return n}),t.length&&i.trigger("beforeIndent",{records:t})!==!1){t.sort((r,n)=>nr.compare(r.wbsCode,n.wbsCode)),i.beginBatch();for(const r of t){const n=r.previousSibling;n.appendChild(r),i.toggleCollapse(n,!1)}i.endBatch(),i.trigger("indent",{records:t}),i.trigger("change",{action:"indent",records:t})}}async outdent(t){const i=this;if(t=Array.isArray(t)?t:[t],t=t.filter(r=>{const{parent:n}=r;let l=n&&!n.isRoot;for(;l&&!r.isRoot;)l=!t.includes(n),r=r.parent;return l}),t.length&&i.trigger("beforeOutdent",{records:t})!==!1){t.sort((r,n)=>nr.compare(r.wbsCode,n.wbsCode)),i.beginBatch();for(const r of t){const{parent:n}=r,l=n.children.slice(n.children.indexOf(r)+1);n.parent.insertChild(r,n.nextSibling),r.appendChild(l),i.toggleCollapse(r,!1)}i.endBatch(),i.trigger("outdent",{records:t}),i.trigger("change",{action:"outdent",records:t})}}},x(e,"$name","StoreTree"),x(e,"StopBranch",vi),x(e,"configurable",{transformFlatData:null,fireRemoveEventForMoveAction:le.checkVersion("core","6.0","<")}),e},lr=class{static preWalk(s,e,t){const i=[s];let r,n;for(;i.length;)r=i.pop(),t(r),n=e(r),n&&i.push.apply(i,n.slice().reverse())}static preWalkWithParent(s,e,t){const i=[{node:s,parent:null}];for(;i.length;){const{parent:r,node:n}=i.pop();t(r,n);const l=e(n);Array.isArray(l)&&i.push(...l.slice().reverse().map(a=>({node:a,parent:n})))}}static preWalkUnordered(s,e,t){const i=[s];let r,n;for(;i.length;)r=i.pop(),t(r),n=e(r),n&&i.push.apply(i,n)}static postWalk(s,e,t){const i=new Map,r=[s];let n,l;for(;r.length;)n=r[r.length-1],i.has(n)?(t(n),r.pop()):(l=e(n),l&&r.push(...l.slice().reverse()),i.set(n,n))}static prePostWalk(s,e,t,i){const r=new Map,n=[s];let l,a;for(;n.length;)l=n[n.length-1],r.has(l)?(i(l),n.pop()):(t(l),a=e(l),a&&n.push(...a.slice().reverse()),r.set(l,l))}};lr._$name="WalkHelper";var zl=s=>class extends(s||R){static get $name(){return"StoreSync"}static get configurable(){return{syncDataOnLoad:null,shouldSyncDataset:null,shouldSyncRecord:null}}syncDataset(t){var i;const r=this,{storage:n}=r,l=(i=r.shouldSyncDataset)==null?void 0:i.call(r,{data:t});if(l===!1)return;r.trigger("startApplyChangeset"),r.isSyncingDataOnLoad=!0;const{toAdd:a,toRemove:o,toMove:u,updated:c,ids:d}=r.tree?r.syncTreeDataset(t,l):r.syncFlatDataset(t,l);let{threshold:f}=r.syncDataOnLoad,g=!1;if(f&&(typeof f=="string"&&(f=parseInt(f,10)/100*r.count),g=a.length+o.length+u.length+c.length>f),r.tree){if(a.length&&r.add(a,g).forEach(m=>m.clearParentId()),u.length)for(const{parent:p,node:m,index:y}of u)r.getById(p.id).insertChild(m,y);r.remove(o,g)}else g&&r.suspendEvents(),r.remove(o),r.add(a),g&&r.resumeEvents();f&&!g&&c.forEach(({record:p,toSet:m,wasSet:y})=>r.onModelChange(p,m,y)),r.acceptChanges();const h={added:a,removed:o,updated:c,thresholdSurpassed:g};if(r.isFiltered&&!r.remoteFilter&&r.filter({silent:r.isRemoteDataLoading}),r.isGrouped)r.group(null,null,!1,!0,r.isRemoteDataLoading);else if(r.isSorted)r.remoteSort?n.replaceValues({values:n.values.sort(r.createSorterFn(r.sorters)),silent:!0}):r.sort();else if(!r.tree)n.values.some((p,m)=>p.id!==d[m])&&(n.replaceValues({values:n.values.sort((p,m)=>d.indexOf(p.id)-d.indexOf(m.id)),silent:!0}),!g&&r.afterPerformSort());else{let p=!1,m=0;lr.preWalk(r.rootNode,y=>Array.isArray(y.children)&&!p?y.children:null,y=>{y.id!==d[m++]&&(p=!0)}),p&&(r.sort((y,b)=>d.indexOf(y.id)-d.indexOf(b.id),void 0,void 0,!0),r.clearSorters(!0),!g&&r.afterPerformSort())}g&&r.trigger("refresh",{action:"batch",data:t,records:n.values,syncInfo:h}),r.isSyncingDataOnLoad=!1,r.trigger("endApplyChangeset"),r.trigger("loadSync",h)}syncFlatDataset(t,i){if(!t)return{toRemove:this.records};const r=this,{idField:n,allFields:l}=r.modelClass,a=[],o=[],u=[],c={},d=[],f=Array.isArray(i),{threshold:g,keepMissingValues:h}=r.syncDataOnLoad;let p=0;if(t.forEach(m=>{var y,b,S;m=m.isModel?m.data:m;const C=m[n],T=r.getById(C);if(!f||i.includes(C))if(T){if(((y=r.shouldSyncRecord)==null?void 0:y.call(r,{record:T,data:m}))!==!1){if((b=r.beforeSyncRecord)==null||b.call(r,{record:T,data:m}),h===!1)for(const L of l)!(L.dataSource in m)&&L.dataSource in T.data&&(m[L.dataSource]=L.defaultValue);const _=T.set(m,null,!!g);_&&u.push({record:T,wasSet:_,toSet:m}),(S=r.afterSyncRecord)==null||S.call(r,{record:T,data:m})}}else o.push(r.processRecord(r.createRecord(m)));T&&p++,c[C]=1,d.push(C)}),p<r.allRecords.filter(m=>!m.isSpecialRow).length)if(i)for(const m of i)c[m]||a.push(r.getById(m));else r.forEach(m=>{c[m.id]||a.push(m)},r,{includeFilteredOutRecords:!0,includeCollapsedGroupRecords:!0});return{toAdd:o,toRemove:a,toMove:[],updated:u,ids:d}}syncTreeDataset(t){if(!t)return{toRemove:this.records};const i=this,{idField:r,parentIdField:n,childrenField:l,allFields:a}=i.modelClass,{keepMissingValues:o,threshold:u}=i.syncDataOnLoad,c=[],d=[],f=[],g=[],h=new Set,p=[];return i.transformFlatData&&(t=i.treeifyFlatData(t)),lr.preWalkWithParent({isRoot:!0,id:i.rootNode.id,children:t},m=>m.children,(m,y)=>{var b;if(m){const{id:S,node:C}=i.resolveSyncNode(y);if(C){if(((b=i.shouldSyncRecord)==null?void 0:b.call(i,{record:C,data:y}))!==!1){let T;const _=C.children;if(_!==!0&&y[l]===!0&&(C.clearChildren(),C.data[l]=C.children=!0,delete y[l],i.toggleCollapse(C,!0),T=!0),C.parent.id!==m[r]&&f.push({node:C,parent:m,index:m[l].indexOf(y)}),o===!1)for(const F of a)F.name!=="parentId"&&!(F.dataSource in y)&&F.dataSource in C.data&&(y[F.dataSource]=F.defaultValue);typeof y.expanded=="boolean"&&this.toggleCollapse(C,!y.expanded);const L=C.set(y,null,!!u);L?g.push({record:C,wasSet:L,toSet:y}):T&&C.signalNodeChanged({[l]:{value:!0,oldValue:_}})}}else y[n]=m[r],d.push({...y,...Array.isArray(y[l])?{children:[]}:void 0});h.add(C),p.push(S)}}),h.length!==t.length&&i.traverse(m=>{h.has(m)||c.push(m)}),{toAdd:d,toRemove:c,toMove:f,updated:g,ids:p}}resolveSyncNode(t){const i=t[this.modelClass.idField],r=this.getById(i);return{id:i,node:r}}},Bl=Symbol("STM_PROP"),jl=s=>class extends(s||R){static get $name(){return"StoreStm"}static get defaultConfig(){return{stm:null,ignoreRemoteChangesInSTM:!1}}get stm(){return this[Bl]}set stm(t){var i;const r=this;r.stm!==t&&((i=r.stm)!=null&&i.hasStore(r)&&r.stm.removeStore(r),r[Bl]=t,r.stm&&!r.stm.hasStore(r)&&r.stm.addStore(r))}add(t,i=!1,r={}){let n;const{stm:l}=this;return!this.tree&&(l!=null&&l.enabled)?(n=super.add(t,i),n!=null&&n.length&&l.onStoreModelAdd(this,n,i)):n=super.add(t,i,r),n}insert(t,i,r=!1){let n;const{stm:l}=this;if(!this.tree&&(l!=null&&l.enabled)){const a=(Array.isArray(i)?i:[i]).reduce((o,u)=>{const c=u instanceof ue?this.indexOf(u):void 0;return c!==void 0&&c!==-1&&o.set(u,c),o},new Map);n=super.insert(t,i),n!=null&&n.length&&(t=this.indexOf(n[0]),l.onStoreModelInsert(this,t,n,a,r))}else n=super.insert(t,i,r);return n}remove(t,i=!1,r){let n;const{stm:l}=this;if(!this.tree&&(l!=null&&l.enabled)){const o=(Array.isArray(t)?t:[t]).map(u=>this.getById(u)).filter(u=>!!u).reduce((u,c)=>{const d=this.indexOf(c);return d!==void 0&&d!==-1&&u.set(c,d),u},new Map);n=super.remove(t,i,r),n!=null&&n.length&&l.onStoreModelRemove(this,n,o,i)}else n=super.remove(t,i,r);return n}removeAll(t){const{stm:i}=this;let r;if(i!=null&&i.enabled){const{tree:n,rootNode:l,allRecords:a}=this,o=a.length,u=n?l.children.slice():a.slice();r=super.removeAll(t),o&&this.count===0&&i.onStoreRemoveAll(this,u,t)}else r=super.removeAll(t);return r}beforeApplyChangeset(){const{stm:t,crudManager:i}=this;let r=!1,n=null;return!(i!=null&&i.applyingChangeset)&&(t!=null&&t.enabled)&&(r=!0,t.isRecording&&(n=t.stash()),this.ignoreRemoteChangesInSTM?t.disable():t.startTransaction()),{shouldResume:r,transactionId:n}}applyChangeset(t,i,r,n,l){const{shouldResume:a,transactionId:o}=this.beforeApplyChangeset(),u=super.applyChangeset(t,i,r,n,l);return this.afterApplyChangeset(a,o),u}afterApplyChangeset(t,i){if(t){const{stm:r}=this;this.ignoreRemoteChangesInSTM?r.enable():r.stopTransaction(),r.applyStash(i)}}},ar=class extends yi{add(...s){return s.length===1&&Array.isArray(s[0])&&(s=s[0]),super.add(...s.filter(e=>e.isPersistable))}};ar._$name="StoreBag";var wc={splice:1,clear:1},Sc={includeFilteredOutRecords:!1,includeCollapsedGroupRecords:!1},hs=(s,e)=>(e=e||!1,typeof e=="boolean"&&(e={includeFilteredOutRecords:e,includeCollapsedGroupRecords:!1}),e||Sc),Ce=class Ge extends R.mixin(lt,di,De,sl,ns,Ml,_l,Dl,Fl,Ll,Al,Pl,Il,$l,Nl,Vl,jl,zl,Ol){static get $name(){return"Store"}static get properties(){return{relationCache:{},dependentStoreConfigs:new Map,addingClean:!1}}static get configurable(){return{id:!0,modelClass:ue,verifyNoGeneratedIds:!0}}static get defaultConfig(){return{fields:null,autoTree:!0,data:null,tree:!1,callOnFunctions:!0,storage:null,useRawData:!1,allowNoId:!0,preventSubClassingModel:null,storeClass:null}}static get identifiable(){return{registerGeneratedId:!1}}constructor(...e){if(super(...e),this.objectify)return this.initProxy()}construct(e={}){const t=this;Object.assign(t,{added:new ar,removed:new ar,modified:new ar,idRegister:{},internalIdRegister:{},oldIdMap:{}}),e.storeId&&(e=w.assign({id:e.storeId},e)),super.construct(e),t.initRelations()}static from(e,t={},i=null){return e&&!e.isStore&&(typeof e=="string"?e=Ge.getStore(e):(Array.isArray(e)?(i&&(e=e.map(r=>r.isModel?r:i(r))),e=w.assign({},t,{data:e})):e=w.assign({},t,e),e=new Ge(e))),e}doDestroy(){var e,t,i,r;const n=this,l=n.registeredRecords;(t=(e=n.stm)==null?void 0:e.removeStore)==null||t.call(e,n);for(let a=l.length-1,o;a>=0;a--)o=l[a],o!=null&&o.isDestroyed||o.unjoinStore(n);(i=n._storage)==null||i.destroy(),n.isChained||(r=n.rootNode)==null||r.destroy(),super.doDestroy()}beginBatch(){this.suspendEvents()}endBatch(){if(this.resumeEvents()){const{values:e}=this.storage;this.trigger("refresh",{action:"batch",data:e,records:e})}}set storage(e){const t=this;e!=null&&e.isCollection?t._storage=e:t._storage=new vt(e),t._storage.autoFilter=t.reapplyFilterOnAdd,t._storage.autoSort=t.reapplySortersOnAdd;for(const i of t._storage)i.joinStore(t);t._storage.ion({change:"onDataChange",thisObj:t})}get storage(){return this._storage||(this.storage={}),this._storage}get allRecords(){var e;const t=this;if(((e=t._allRecords)==null?void 0:e.generation)!==t.storage.generation){if(t.isTree){const i=t.collectDescendants(t.rootNode,void 0,void 0,{unfiltered:!0}).all;t.rootVisible&&i.unshift(t.rootNode),t._allRecords=i}else t._allRecords=t.isGrouped?t.collectGroupRecords():t.storage.allValues;t._allRecords.generation=t.storage.generation}return t._allRecords}getAllDataRecords(e){const t=this;return t.tree?e?t.allRecords:t.rootNode.allChildren:t.isGrouped?t.collectGroupRecords(e,!1):e?t.storage.allValues:t.storage.values}onIsCreatingToggle(e,t){const i=this,r=e.isPersistable&&!t;i.added[r?"add":"remove"](e),r&&(i.trigger("addConfirmed",{record:e}),i.autoCommit&&i.doAutoCommit())}joinRecordsToStore(e){const{allCount:t}=this;for(let i=0;i<e.length;i++){const r=e[i];r.setData("parentIndex",t+i-e.length),r.joinStore(this)}}onDataChange({source:e,action:t,added:i,removed:r,replaced:n,oldCount:l,items:a,from:o,to:u}){const c=this,d=wc[t],f=d&&(i==null?void 0:i.length),g=d&&(r==null?void 0:r.length);let h,p;if(c._idMap=null,f&&c.joinRecordsToStore(i),n==null||n.forEach(([m,y])=>{m.unjoinStore(c,!0),y.joinStore(c)}),super.onDataChange(...arguments),!c.isTree){if(f){for(const m of i)c.removed.includes(m)?c.removed.remove(m):!c.addingClean&&!m.isLinked&&c.added.add(m);h=!c.remoteFilter&&c.isFiltered&&c.reapplyFilterOnAdd,h&&c.filter({silent:!0}),p=!c.remoteSort&&c.isSorted&&c.reapplySortersOnAdd,p&&c.sort(null,null,!1,!0)}if(g){for(const m of r)m.cancelBatch(),m.unjoinStore(c),c.added.includes(m)?c.added.remove(m):!m._undoingInsertion&&!m.isCreating&&!m.isLinked&&c.removed.add(m);c.modified.remove(r),h=!c.remoteFilter&&c.isFiltered,h&&c.filter({silent:!0})}}switch(t){case"clear":c.relationCache={},c.updateDependentStores("removeall"),c.trigger("removeAll"),c.trigger("change",{action:"removeall"});break;case"splice":if(f){c.updateDependentStores("add",i);const m=i.reduce((S,C)=>{const{previousIndex:T}=C.meta;return T>-1&&T<S&&(S=T),S},i[0].meta.previousIndex),y=e.indexOf(i[0],!e.autoFilter),b={records:i,index:y};m>-1&&(b.oldIndex=m),c.trigger("add",b),c.trigger("change",Object.assign({action:"add"},b)),h&&c.triggerFilterEvent({action:"filter",filters:c.filters,oldCount:l,records:c.storage.allValues}),p&&c.trigger("sort",{action:"sort",sorters:c.sorters,records:c.storage.allValues})}r.length&&(c.updateDependentStores("remove",r),c.trigger("remove",{records:r}),c.trigger("change",{action:"remove",records:r})),n.length&&(c.updateDependentStores("replace",n),c.trigger("replace",{records:n,all:c.records.length===n.length}),c.trigger("change",{action:"replace",replaced:n,all:c.records.length===n.length}));break;case"filter":(c.isGrouped||c.isSorted)&&c.performSort(!0);break;case"move":{const m=Math.min(o,u),y=Math.min(c.storage.allValues.length-1,Math.max(o,u));for(let b=c.storage.allValues,S=m;S<=y;S++)b[S].setData("parentIndex",S);c.trigger("move",{record:a[0],records:a,from:o,to:u}),c.isFiltered&&c.performFilter(),c.trigger("change",{action:t,record:a[0],records:a,from:o,to:u});break}}}onDataReplaced(e,t){var i;const r=this,{storage:n}=r,l=n.allValues,a=r.sorters.length>0;for(let u=0;u<l.length;u++)l[u].joinStore(r);if(!r.remoteFilter&&r.isFiltered&&r.filter({silent:!0}),r.remoteSort?r.isGrouped&&n.replaceValues({...r.prepareGroupRecords(),silent:!0}):(r.isGrouped&&r.group(null,null,!1,!a,!0),a&&r.sort(null,null,!1,!0)),!r.useRawData.disableDuplicateIdCheck){const{idMap:u}=r;if(Object.keys(u).length<n.values.length){const c=[];throw n.values.forEach(d=>u[d.id]?delete u[d.id]:c.push(d)),new Error(`Id collision on ${c.map(d=>d.id)}`)}}const o={action:e,data:t,records:n.values};r.updateDependentStores(e,o.records),(i=r.afterLoadData)==null||i.call(r),r.isRemoteDataLoading||r.trigger("refresh",o),r.trigger("change",o)}onModelChange(e,t,i,r,n){const l=this,a={record:e,records:[e],changes:i,batch:e.batching!=null,fromRelationUpdate:n},o=e.ignoreBag||e.isLinked?!1:l.updateModifiedBagForRecord(e);if(l.storage.onItemMutation(e,i),"id"in i){const{oldValue:u,value:c}=t.id;l.updateDependentRecordIds(u,c),l.onRecordIdChange({record:e,oldValue:u,value:c})}if(!r){if("id"in i){const{oldValue:u,value:c}=t.id;l.trigger("idChange",{store:l,record:e,oldValue:u,value:c})}l.onUpdateRecord(e,i),l.trigger("update",a),l.trigger("change",Object.assign({action:"update"},a))}l.autoCommit&&o&&l.doAutoCommit()}updateModifiedBagForRecord(e){const t=this;let i=!1;return e.isModified?!t.modified.includes(e)&&!t.added.includes(e)&&e.isPartOfStore(t)&&!e.isRoot&&(e.isPhantom?t.added.add(e):t.modified.add(e),i=!0):t.modified.remove(e),i}get idMap(){const e=this,t=!e._idMap,i=e._idMap||(e._idMap={});if(t){const r=e.storage.values;for(let n,l=0,a=0;l<r.length;l++)n=r[l],i[n.id]={index:l,visibleIndex:a,record:n},n.isSpecialRow||a++;if(e.isFiltered)for(let n=0,l=e.storage._values.length;n<l;n++){const a=e.storage._values[n];a.id in i?i[a.id].unfilteredIndex=n:i[a.id]={index:-1,unfilteredIndex:n,record:a}}}return i}changeModelClass(e){const{fields:t}=this;this.originalModelClass=e;let i=e;if(t!=null&&t.length){class r extends e{static get fields(){return t}}i=r}else if(!this.preventSubClassingModel){class r extends e{}i=r}return i.initClass(),i}set storeId(e){this.id=e}get storeId(){return this.id}changeId(e,t){return super.changeId(e!==!0&&e,t)}updateId(e,t){const i=Ge.getById(e);i&&Ge.unregisterInstance(i),super.updateId(e,t)}generateAutoId(){return Ge.generateId("store-")}get tree(){return this._tree}set tree(e){this._tree=e,e&&!this.rootNode&&(this.rootNode=this.buildRootNode(),this.rootNode.isAutoRoot=!0)}buildRootNode(){return{}}static getStore(e,t){if(e instanceof Ge)return e;if(this.getById(e))return this.getById(e);if(Array.isArray(e)){let i;const r=e.map(n=>(n instanceof ue?i=n.constructor:typeof n=="string"&&(n={text:n}),n));if(!i){class n extends ue{}i=n}e={autoCreated:!0,data:r,modelClass:i,allowNoId:!0},t||(t=Ge)}if(t)return new t(e)}static get stores(){return Ge.registeredInstances}get rootNode(){return this.masterStore?this.masterStore.rootNode:this._rootNode}set rootNode(e){var t;const i=this,r=i._rootNode;e!==r&&(r&&(i.clear(!0),i.removed.clear()),e instanceof ue?(e.instanceMeta(i).collapsed=!1,i._rootNode=e):i._rootNode=e=new i.modelClass(Object.assign({expanded:!0,[i.modelClass.idField]:`${i.id}-rootNode`},e),i,null,!0),i._tree=!0,e.isRoot=!0,e.joinStore(i),((t=e.children)!=null&&t.length||i.rootVisible)&&(e.isLoading=!0,i.onNodeAddChild(e,e.children||[],0),e.isLoading=!1),i.trigger("rootChange",{oldRoot:r,rootNode:e}))}set data(e){this.setStoreData(e)}setStoreData(e){const t=this,{idField:i,childrenField:r}=t.modelClass;if(t.transformFlatData&&(e==null?void 0:e.length)>0&&!Object.isExtensible(e[0])&&(t.useRawData=t.useRawData||{disableDuplicateIdCheck:!1,disableDefaultValue:!1,disableTypeConversion:!1},e=w.clone(e)),t.getConfig("plugins"),t.processConfiguredListeners(),e&&!Array.isArray(e)&&(e=w.transformNamedObjectToArray(e,i)),t.tree=!t.isChained&&(t.tree||!!(t.autoTree&&(e!=null&&e.some(n=>n[r])))),e&&(t.remoteSort||t.remoteFilter))for(let n=0;n<e.length;n++)e[n]._remoteSortIndex=n;if(!t.syncDataOnLoad||!t._data){if(t._data=e,t.tree){t.transformFlatData&&(e=t.treeifyFlatData(e));const n=t.rootNode;if(n.isLoading=!0,t.clear(!0),n.appendChild(e),t.updateDependentStores("dataset",[n]),n.isLoading=!1,e.length===0){const l={action:"dataset",data:[],records:[]};t.trigger("refresh",l),t.trigger("change",l)}else t.isFiltered&&t.filter()}else t.loadData(e);t.added.clear(),t.removed.clear(),t.modified.clear()}else t.syncDataset(e)}loadData(e,t="dataset"){var i,r;const n=this,{storage:l,allowNoId:a}=n,o=n.modelClass.fieldMap.id.dataSource,u=n.find(d=>d.isCreating);u&&l.values.splice(n.records.indexOf(u),1);let c=n.verifyNoGeneratedIds;if(n.removeHeadersAndFooters(n.storage.values),n._idMap=null,n.oldIdMap={},e){if(!(e[0]instanceof ue)){n.modelClass.exposeProperties(e[0]);const f=e.length,g=new Array(f);for(let h=0;h<f;h++){const p=e[h];if(!a&&p[o]==null)throw new Error(`Id required but not found on row ${h}`);c&&((r=(i=p[o])==null?void 0:i.startsWith)!=null&&r.call(i,"_generated"))&&(console.warn(`Generated id found in data: ${p[o]}. Generated ids are temporary and should be replaced with real ids by the backend`),c=!1),g[h]=n.processRecord(n.createRecord(p,!0),!0),g[h].setData("parentIndex",h)}n.clear(!0),l.replaceValues({values:g,isNewDataset:!0,silent:!0})}else n.clear(!0),l.replaceValues({values:e.slice(),isNewDataset:!0,silent:!0});u&&!l.values.includes(u)&&l.values.push(u),n._data=e,n.onDataReplaced(t,e)}else n.clear(!0),n._data=null;n.isSyncingDataOnLoad=!1}get data(){return this._data}getRange(e,t,i=!0){return(i?this.storage.allValues:this.storage.values).slice(e,t)}createRecord(e,t=!1,i=!1){return new this.modelClass(e,this,null,t,!1,i)}processRecord(e,t=!1){return e}refreshData(){this.filter(),this.sort()}onRecordIdChange({record:e,oldValue:t,value:i}){const r=this,n=r._idMap,{idRegister:l,oldIdMap:a}=r;if(r.storage._indicesInvalid=!0,a[t]=e,n&&!n[i]){const o=n[t];delete n[t],n[i]=o}r.added.changeId(t,i),r.removed.changeId(t,i),r.modified.changeId(t,i),delete l[t],l[i]=e,e.index=r.storage.indexOf(e)}onUpdateRecord(e,t){const i=this,{internalId:r}=t,{internalIdRegister:n}=i;r&&(this.storage._indicesInvalid=!0,delete n[r.oldValue],n[r.value]=e),i.reapplyFilterOnUpdate&&i.isFiltered&&i.filter()}get useRawData(){return this._useRawData}set useRawData(e){e===!0?this._useRawData={enabled:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0,disableDefaultValue:!1}:this._useRawData=e?Object.assign(e,{enabled:!0}):{enabled:!1}}getCount(e=!0){return e?this.count:this.originalCount}get originalCount(){var e;return this.storage.totalCount-(((e=this.groupRecords)==null?void 0:e.count)||0)}get count(){return this.storage.count}get allCount(){return this.isTree?this.rootNode.descendantCount:this.storage.totalCount}get records(){return this.storage.values}get first(){return this.storage.values[0]}get last(){return this.storage.values[this.storage.values.length-1]}getAt(e,t=!1){return this.storage.getAt(e,t)}register(e){const t=this;if(!t.useRawData.disableDuplicateIdCheck){const i=t.isTree&&t.idRegister[e.id];if(i&&i!==e)throw new Error(`Id collision on ${e.id}`)}t.idRegister[e.id]=e,t.internalIdRegister[e.internalId]=e}unregister(e){delete this.idRegister[e.id],delete this.internalIdRegister[e.internalId]}get registeredRecords(){return Object.values(this.idRegister)}getById(e){if(e!=null&&e.isModel){const t=e;return t.hasLinks&&!this.storage.allValues.includes(t)?t.$links.find(i=>this.storage.allValues.includes(i)):t}return this.idRegister[e]}isAvailable(e){const t=this.getById(e);return t&&this.storage.includes(t)||!1}getByInternalId(e){return this.internalIdRegister[e]}includes(e){return this.isTree?this.idRegister[ue.asId(e)]!=null:this.indexOf(e)>-1}indexOf(e,t=!1,i=!1){if(e!=null&&e.isModel&&!e.stores.includes(this.$store||this)){const l=e.$links.find(a=>this.storage.allValues.includes(a));return l?this.indexOf(l,t):-1}if(this.isTree)return(i?this.rootNode.allChildren:this.storage.values).indexOf(this.getById(e));const r=ue.asId(e);if(r==null)return-1;const n=this.idMap[r];return n?n[t?"visibleIndex":"index"]:-1}allIndexOf(e){return this.isTree?this.allRecords.indexOf(this.getById(e)):this.storage.indexOf(e,!0)}getDistinctValues(e,t=!1){const i=this,r=[],n={};let l;return i.forEach(a=>{if(!a.isSpecialRow&&!a.isRoot){l=a.getValue(e);const o=l instanceof Date?l.getTime():l;n[o]||(r.push(l),n[o]=1)}},i,{includeCollapsedGroupRecords:!0,includeFilteredOutRecords:t}),r}getValueCount(e,t){let i=0;return this.forEach(r=>{w.isEqual(r.getValue(e),t)&&i++}),i}set json(e){typeof e=="string"&&(e=k.safeJsonParse(e)),this.data=e}get json(){return k.safeJsonStringify(this)}get formattedJSON(){return k.safeJsonStringify(this,null,4)}toJSON(){return(this.isTree?this.rootNode.unfilteredChildren||this.rootNode.children||[]:this.allRecords).map(e=>e.toJSON())}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.project}getInlineData(e){var t;const i=[];return this.tree?(t=this.rootNode.children)==null||t.forEach(r=>i.push(r.getCurrentConfig(e))):this.forEach(r=>i.push(r.getCurrentConfig(e))),i}getCurrentConfig(e){var t;const i=super.getCurrentConfig(e),{state:r}=this;return i&&(i.data&&(i.data=this.getInlineData(e)),delete i.project,delete i.stm,delete i.asyncEvents,((t=i.modelClass)==null?void 0:t.$meta.hierarchy[i.modelClass.$meta.hierarchy.length-2])===this.constructor.defaultConfig.modelClass&&delete i.modelClass,this.tree||delete i.tree,r&&Object.assign(i,r)),i}forEach(e,t=this,i){const r=this,n=(l,a)=>{if(!l.isRoot&&!l.isSpecialRow)return e.call(t,l,a)};if(i=hs(r,i),r.isTree)r.isChained&&(i={...i,sorterFn:r.sorterFn}),r.rootNode.traverseWhile(n,!1,i);else{const l=i.includeFilteredOutRecords?r.storage.allValues:r.storage.values;if(r.isGrouped&&i.includeCollapsedGroupRecords)for(let a=0;a<l.length;a++){const o=l[a],u=i.includeFilteredOutRecords?o.unfilteredGroupChildren:o.groupChildren;if(u&&o.meta.collapsed===!0)for(let c=0;c<u.length;c++){const d=u[c];if(n(d,c)===!1)return}else if(n(o,a)===!1)return}else for(let a=0;a<l.length;a++)if(n(l[a],a)===!1)return}}map(e,t=this){return this.storage.values.map(e,t)}flatMap(e,t=this){return this.storage.values.flatMap(e,t)}every(e,t=this,i){return this.storage[i?"allValues":"values"].every(e,t)}reduce(e,t=[],i=this){return i!==this&&(e=e.bind(i)),this.storage.values.reduce(e,t,i)}[Symbol.iterator](){return this.storage.values[Symbol.iterator]()}traverse(e,t=this.rootNode,i=t===this.rootNode,r){const n=this;if(r=hs(n,r),n.isTree){if(typeof t=="boolean"&&(i=t,t=n.rootNode),n.isChained){const l=e;e=a=>{n.chainedFilterFn(a)&&l(a)}}t.traverse(e,i,r)}else n.forEach(l=>l.traverse(e,!1,r),n,r)}traverseWhile(e,t=this.rootNode,i=t===this.rootNode,r){const n=this;if(r=hs(n,r),n.isTree){if(typeof t=="boolean"&&(i=t,t=n.rootNode),n.isChained){const l=e;e=a=>{n.chainedFilterFn(a)&&l(a)}}t.traverseWhile(e,i,r)}else for(const l of n.storage)if(l.traverse(e,!1,r)===!1)break}getNext(e,t=!1,i=!1){const r=this,n=r.storage.values;let l=r.indexOf(e);if(l>=n.length-1)if(t)l=-1;else return null;const a=n[l+1];return i&&a&&a.isSpecialRow?r.getNext(n[l+1],t,!0):a}getPrev(e,t=!1,i=!1){const r=this,n=r.storage.values;let l=r.indexOf(e);if(l===0)if(t)l=n.length;else return null;const a=n[l-1];return i&&a&&a.isSpecialRow&&l>0?r.getPrev(n[l-1],t,!0):a}getAdjacent(e,t=!0,i=!1,r=!1){return t?this.getNext(e,i,r):this.getPrev(e,i,r)}getNextLeaf(e,t=!1){const i=this,r=i.leaves,n=i.getById(e);let l=r.indexOf(n);if(l>=r.length-1)if(t)l=-1;else return null;return r[l+1]}getPrevLeaf(e,t=!1){const i=this,r=i.leaves,n=i.getById(e);let l=r.indexOf(n);if(l===0)if(t)l=r.length;else return null;return r[l-1]}getAdjacentLeaf(e,t=!0,i=!1){return t?this.getNextLeaf(e,i):this.getPrevLeaf(e,i)}};Ce.initClass(),Ce._$name="Store";var Ec=(s,e)=>(Array.isArray(e[1])?e[1].forEach(t=>s.push(encodeURIComponent(e[0])+"="+encodeURIComponent(t))):s.push(encodeURIComponent(e[0])+"="+encodeURIComponent(e[1])),s),or=Promise.resolve(),bi=s=>String(s).padStart(2,"0"),Tc=s=>`${s.getFullYear()}-${bi(s.getMonth()+1)}-${bi(s.getDate())}T${bi(s.getHours())}:${bi(s.getMinutes())}:${bi(s.getSeconds())}.${s.getMilliseconds()}`,Ci=class extends Ce{static get defaultConfig(){return{headers:null,fetchOptions:null,sendAsFormData:null,writeAllFields:null,parentIdParamName:"id",responseSuccessProperty:"success",responseDataProperty:"data",responseTotalProperty:"total",filterParamName:null,restfulFilter:!1,sortParamName:null,pageParamName:null,pageStartParamName:null,pageSizeParamName:"pageSize",useRestfulMethods:null,httpMethods:{create:"POST",read:"GET",update:"PUT",delete:"DELETE"}}}updatePageSize(s){const e=this;if(!this.isConfiguring){const t=e.currentPage=e.currentPage?Math.min(e.currentPage,Math.floor((e.allCount+s-1)/s)):1;s&&e.loadPage(t)}}afterConstruct(s){super.afterConstruct(s),this.autoLoad&&this.load().catch(()=>{})}get isLoading(){return this._isLoading?2:this.loadTriggerPromise?1:!1}get isCommitting(){return!!this.commitPromise}set pageParamName(s){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageStartParamName)throw new Error("Configs pageStartParamName and pageParamName are mutually exclusive");this._pageParamName=s}get pageParamName(){return this._pageParamName}set pageStartParamName(s){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageParamName)throw new Error("Configs pageParamName and pageStartParamName are mutually exclusive");this._pageStartParamName=s}get pageStartParamName(){return this._pageStartParamName}get isPaged(){return this.pageParamName||this.pageStartParamName}get allCount(){return"remoteTotal"in this?this.remoteTotal:super.allCount}get lastPage(){if(this.isPaged)return Math.floor((this.allCount+this.pageSize-1)/this.pageSize)}buildQueryString(s,...e){const t=s.includes("?"),i=Object.entries(Object.assign({},...e)).reduce(Ec,[]).join("&");return i?(t?"&":"?")+i:""}async performSort(s){const e=this;if(e.remoteSort&&!e.isRemoteDataLoading){e.isRemoteDataLoading=!0;const t=await e.internalLoad({},"",i=>{e.data=i.data,e.afterPerformSort(s)});return e.isRemoteDataLoading=!1,t}else super.performSort(s)}async performFilter(s){var e;const t=this;if(t.remoteFilter){(e=t.loadingPromise)==null||e.abort(),t.isRemoteDataLoading=!0;const i=t.count,{filters:r}=t;t.currentPage=1;const n=await t.internalLoad({},"",l=>{t.data=l.data,l=s?null:{action:"filter",filters:r,oldCount:i,records:t.storage.values},t.afterPerformFilter(l),t.trigger("refresh",l)});return t.isRemoteDataLoading=!1,n}else super.performFilter(s)}encodeFilterParams(s){const e=[];for(const{property:t,operator:i,value:r,caseSensitive:n}of s)e.push({field:t,operator:i,value:r,caseSensitive:n});return JSON.stringify(e,function(t,i){return t===""?i:this[t]instanceof Date?Tc(this[t]):i})}encodeSorterParams(s){return JSON.stringify(s.filter(e=>!e.sortFn).map(e=>e))}buildReadUrl(){const{readUrl:s}=this;return this.restfulFilter&&this.filters.count?(s.endsWith("/")?s:s+"/")+this.filters.first.value:s}internalLoad(s,e,t,i=0){s=w.assign({},this.params,s);const r=this,n=r.buildReadUrl(),l={action:"read"+e,params:s,url:n};if(!n)throw new Error("No load url specified");if(r.trigger("beforeLoad"+e,l)===!1)throw!1;return r.loadArgs=[n,l,s,e,t],i===!1?new Promise((a,o)=>r.sendLoadRequest(a,o)):r.loadTriggerPromise||(r.loadTriggerPromise=new Promise((a,o)=>{r.setTimeout({delay:i,fn:"sendLoadRequest",args:[a,o],cancelOutstanding:!0})}))}async sendLoadRequest(s,e){const t=this,[i,r,n,l,a]=t.loadArgs;if(t.loadTriggerPromise=null,i){if(t._isLoading=!0,t.trigger(`load${l}Start`,r),t.trigger("beforeRequest",r),t.filterParamName&&t.isFiltered&&(n[t.filterParamName]=t.encodeFilterParams(t.filters.values)),t.remoteSort&&t.isSorted&&(n[t.sortParamName]=t.encodeSorterParams(t.groupers?t.groupers.concat(t.sorters):t.sorters)),t.isPaged){if(!(t.pageParamName in n||t.pageStartParamName in n)){const u=Math.min(t.currentPage||1,t.allCount?t.lastPage:1/0);t.pageParamName?n[t.pageParamName]=u:n[t.pageStartParamName]=(u-1)*t.pageSize}n[t.pageSizeParamName]=t.pageSize}const o={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(o.method=t.httpMethods.read,r.body&&(o.body=JSON.stringify(r.body)));try{const u=t.loadingPromise=ht.get(r.url+t.buildQueryString(r.url,n),w.assign(o,t.fetchOptions)),c=await u,d=c.parsedJson,f=Array.isArray(d),g=f||d&&w.getPath(d,t.responseSuccessProperty)!==!1,h=f?null:w.getPath(d,t.responseTotalProperty);if(t.isDestroyed)return;if(t.loadingPromise=null,t._isLoading=!1,r.response=c,r.json=d,g){if(h!=null&&(t.remoteTotal=parseInt(h,10)),t.isPaged)if(t.remoteTotal>=0){const p=t.pageParamName?n[t.pageParamName]:n[t.pageStartParamName]/t.pageSize+1;t.currentPage=Math.min(p,t.lastPage)}else throw new Error("A paged store must receive its responseTotalProperty in each data packet");r.data=f?d:w.getPath(d,t.responseDataProperty),await a(r),!t.isDestroyed&&t.trigger("load"+l,r),s(r)}else Object.assign(r,{exception:!0,exceptionType:"server",error:d==null?void 0:d.error}),!t.isDestroyed&&t.trigger("exception",r),e(r);!t.isDestroyed&&t.trigger("afterRequest",r)}catch(u){t._isLoading=!1,r.exception=!0,u instanceof Response?(r.exceptionType=u.ok?"server":"network",r.response=u,r.error=u.error):(r.exceptionType="server",r.error=u),!t.isDestroyed&&t.trigger("exception",r),e(r),!t.isDestroyed&&t.trigger("afterRequest",r)}}}async load(s){const e=this;return e.isPaged?e.loadPage(e.currentPage||1,s):e.internalLoad(s,"",t=>{e.data=t.data})}async loadChildren(s){return this.readUrl?this.internalLoad({[this.parentIdParamName]:s.id},"Children",e=>{e.parentRecord=s,s.children.length&&s.clearChildren(!0),s.data[s.constructor.childrenField]=e.data,s.processChildren(s.stores)},!1):this.immediatePromise}async loadPage(s,e){this.allCount&&(s=Math.min(s,this.lastPage));const t=this,i=t.pageParamName?{[t.pageParamName]:s}:{[t.pageStartParamName]:(s-1)*t.pageSize};return i[t.pageSizeParamName]=t.pageSize,t.internalLoad(w.assign(i,e),"Page",r=>{t.loadData(r.data,"pageLoad")})}async nextPage(s){const e=this;return e.isPaged&&e.currentPage!==e.lastPage?e.loadPage(e.currentPage+1,s):or}async previousPage(s){return this.isPaged&&this.currentPage!==1?this.loadPage(this.currentPage-1,s):or}async commit(){const s=this,{changes:e}=s,t=[];if(s.commitPromise)return!1;if(!e)return s.modified.count&&(s.modified.forEach(i=>i.clearChanges(!0,!1)),s.modified.clear()),or;if(s.trigger("beforeCommit",{changes:e})!==!1){[...e.added,...e.modified,...e.removed].forEach(n=>n.meta.committing=!0),s.trigger("commitStart",{changes:e});const i={action:"commit",exception:!1,changes:e};let r=s.commitRemoved(i);return r&&t.push(r),r=s.commitAdded(i),r&&t.push(r),r=s.commitModified(i),r&&t.push(r),t.length?(r=t.length===1?t[0]:Promise.all(t),s.commitPromise=new Promise((n,l)=>{r.then(()=>{s.commitPromise=null,i.exception?(s.trigger("exception",i),l(i)):(s.trigger("commit",{changes:e}),n(i))}).catch(()=>{s.commitPromise=null,l(i)})})):(s.modified.forEach(n=>n.clearChanges(!0,!1)),s.modified.clear(),s.added.forEach(n=>n.clearChanges(!0,!1)),s.added.clear(),s.removed.clear(),s.trigger("commit",{changes:e}),or)}}doAutoCommit(){this.suspendCount<=0&&this.commit().catch(s=>{const{response:e}=s;if(!(e&&(e.ok&&e.parsedJson||[500,404].includes(e.status))))throw s})}commitAdded(s){const e=this,t=e.added,i={action:"create",params:e.params};return t.count&&e.createUrl?new Promise(r=>{const n=t.values.map(u=>u.persistableData);s.create=i,i.body={data:n},e.trigger("beforeRequest",i);let l=i.body;if(e.sendAsFormData){const u=new FormData;u.append("data",JSON.stringify(n)),l=u}const a={headers:e.headers,parseJson:!0},o=e.createUrl+e.buildQueryString(e.createUrl,e.params);e.useRestfulMethods&&(a.method=e.httpMethods.create),ht.post(o,l,w.assign(a,e.fetchOptions)).then(u=>{const c=u.parsedJson,d=Array.isArray(c),f=d||c&&c.success!==!1;s.response=u,i.json=c,i.response=u,f?(e.processReturnedData(t.values,d?c:w.getPath(c,e.responseDataProperty)),t.clear(),e.trigger("commitAdded"),e.trigger("refresh",i),r(s)):(t.forEach(g=>g.meta.committing=!1),s.exception=i.exception=!0,s.exceptionType=i.exceptionType="server",e.trigger("exception",i),r(s)),e.trigger("afterRequest",i)}).catch(u=>{t.forEach(c=>c.meta.committing=!1),s.exception=i.exception=!0,u instanceof Response?(s.response=u,i.exceptionType=u.ok?"server":"network",i.response=u,i.error=u.error):(i.exceptionType="server",i.error=u),e.trigger("exception",i),r(s),e.trigger("afterRequest",i)})}):null}commitModified(s){const e=this,{modified:t}=e.changes,i={action:"update",params:e.params},r=t.length&&e.updateUrl?new Promise(n=>{const l=t.map(u=>e.writeAllFields?u.persistableData:u.modificationDataToWrite).filter(u=>!w.isEmpty(u));if(l.length===0){e.modified.clear(),t.forEach(u=>u.meta.committing=!1),n();return}s.update=i,i.body={data:l},e.trigger("beforeRequest",i);let a=i.body;if(e.sendAsFormData){const u=new FormData;u.append("data",JSON.stringify(l)),a=u}const o={headers:e.headers,parseJson:!0};e.useRestfulMethods&&(o.method=e.httpMethods.update),ht.post(e.updateUrl+e.buildQueryString(e.updateUrl,e.params),a,w.assign(o,e.fetchOptions)).then(u=>{const c=u.parsedJson,d=Array.isArray(c),f=d||c&&c.success!==!1;s.response=u,i.json=c,i.response=u,f?(e.processReturnedData(t,d?c:w.getPath(c,e.responseDataProperty),!0),e.modified.clear(),e.trigger("commitModified"),e.trigger("refresh",i),n(s)):(t.forEach(g=>g.meta.committing=!1),s.exception=i.exception=!0,i.exceptionType="server",e.trigger("exception",i),n(s)),e.trigger("afterRequest",i)}).catch(u=>{t.forEach(c=>c.meta.committing=!1),s.exception=i.exception=!0,u instanceof Response?(s.response=u,i.exceptionType=u.ok?"server":"network",i.response=u,i.error=u.error):(i.exceptionType="server",i.error=u),e.trigger("exception",i),n(s),e.trigger("afterRequest",i)})}):null;return!t.length&&e.modified.count&&e.modified.clear(),r}processReturnedData(s,e,t=!1){const i=this,r=i.modelClass,n=r.fieldMap.id.dataSource;e.forEach((l,a)=>{const o=s[a];o.clearChanges(!0,!1),o.syncId(l[n]),Object.assign(s[a].data,r.processData(l,t,i,o))})}commitRemoved(s){const e=this,t=e.removed,i={action:"delete",params:e.params};return t.count&&e.deleteUrl?new Promise(r=>{s.delete=i,i.body={ids:t.map(a=>a.id)},e.trigger("beforeRequest",i);let n=i.body;if(e.sendAsFormData){const a=new FormData;a.append("id",JSON.stringify(n.ids)),n=a}const l={headers:e.headers,parseJson:!0};e.useRestfulMethods&&(l.method=e.httpMethods.delete),ht.post(e.deleteUrl+e.buildQueryString(e.deleteUrl,e.params),n,w.assign(l,e.fetchOptions)).then(a=>{const o=a.parsedJson,u=Array.isArray(o),c=u||o&&o.success!==!1;s.response=a,i.json=o,i.response=a,c?(t.forEach(d=>d.meta.committing=!1),t.clear(),e.trigger("commitRemoved"),e.trigger("refresh",i),r(s)):(t.forEach(d=>d.meta.committing=!1),s.exception=i.exception=!0,i.exceptionType="server",e.trigger("exception",i),r(s)),e.trigger("afterRequest",i)}).catch(a=>{t.forEach(o=>o.meta.committing=!1),s.exception=i.exception=!0,a instanceof Response?(s.response=a,i.exceptionType=a.ok?"server":"network",i.response=a,i.error=a.error):(i.exceptionType="server",i.error=a),e.trigger("exception",i),r(s),e.trigger("afterRequest",i)})}):null}get remoteFilter(){return!!(this.filterParamName||this.restfulFilter)}get remoteSort(){return!!this.sortParamName}};x(Ci,"$name","AjaxStore"),x(Ci,"configurable",{params:null,pageSize:50}),Ci._$name="AjaxStore";var Hl=class{static get(s,e){const t=s._domData||(s._domData={});return e!=null?t[e]:t}static remove(s,e){const{_domData:t}=s,i=t==null?void 0:t[e];return t==null||delete t[e],i}static set(s,e,t){arguments.length===3?(s._domData||(s._domData={}))[e]=t:s._domData=e}static assign(s,e){Object.assign(s._domData||(s._domData={}),e)}};Hl._$name="DomDataStore";var gs=class{static insertRule(s,e=document.head){const t=this.getStyleSheet(e),i=t.cssRules.length;if(t.insertRule(s,0),t.cssRules.length>i)return t.cssRules[0]}static findRule(s){let e;const t=typeof s=="function";return Array.prototype.find.call(document.head.querySelectorAll("link[rel=stylesheet],style[type*=css]"),i=>{if(e=Array.prototype.find.call(i.sheet.rules||i.sheet.cssRules,r=>t?s(r):r.selectorText===s),e)return!0}),e}static getStyleSheet(s=document.head){return s.$bryntumStylesheet||(s.$bryntumStylesheet=v.createElement({tag:"style",id:"bryntum-private-styles",type:"text/css",parent:s}).sheet),s.$bryntumStylesheet}static getCSSVersion(){return getComputedStyle(document.documentElement).getPropertyValue("--bryntum-version").replace(/[" ]/gm,"")}};gs._$name="CSSHelper";var Wl=Array.prototype.slice,Ul=Object.freeze([]),xc=Object.freeze({}),ql=/[&<]/,{getPrototypeOf:Kl}=Object,{toString:Dc}=Object.prototype,{isEqual:Yl,isObject:_c}=w,Mc={parent:1,elementData:1,ns:1,syncOptions:1},Gl=()=>({ignore:Mc,refsFound:new Set}),Xl={class:1,className:1,classname:1},Ic={bigint:1,boolean:1,function:1,number:1,string:1,symbol:1},Oc={tag:1,html:1,text:1,children:1,tooltip:1,parent:1,nextSibling:1,ns:1,reference:1,elementData:1,retainElement:1,compareHtml:1,syncOptions:1,listeners:1,isReleased:1,null:1,"":1,keepChildren:1,retainChildren:1},Fc=(s,e)=>{const t="className"in e?"className":"class",i=e[t];if(i)if(typeof i=="string"){const r=i.split(" ");r.includes(s)||(r.push(s),e[t]=r.join(" "))}else Array.isArray(i)?i.includes(s)||i.push(s):i.isDomClassList?i.add(s):w.isObject(i)&&(i[s]=1)},Lc=(s,e)=>{const t="className"in e?"className":"class",i=e[t];if(i)if(typeof i=="string"){const r=i.split(" ");r.includes(s)&&(r.splice(r.indexOf(s),1),e[t]=r.join(" "))}else Array.isArray(i)?i.includes(s)&&i.splice(i.indexOf(s),1):i.isDomClassList?i.remove(s):w.isObject(i)&&delete i[s]},bt=class ee{static checkEquality(e,t,i,r){var n;if(e===t)return!0;if(e==null)return t==null;if(!e||!t)return!1;const l=typeof e;if(l!==typeof t||Ic[l])return!1;let o=i.equalityCache||(i.equalityCache=new Map),u=!!r,c,d,f,g,h,p,m;if(o=o.get(e)||o.set(e,new Map).get(e),c=o.get(t),c===void 0){if(c=!0,Kl(e)!==Kl(t)||e instanceof Node)c=!1;else if(Array.isArray(e)){if(d=e.length,d!==t.length)c=!1;else for(;d-- >0;)if(!ee.checkEquality(e[d],t[d],i,u)){c=!1;break}}else{p=e.syncOptions,g=p==null?void 0:p.ignoreRefs,g&&(u=!0,r=g!=="children"),f=i.ignore||xc;for(h in t)if(!f[h]&&!(h in e)&&!(r&&h==="reference")){c=!1;break}if(c){if(Dc.call(t)==="[object Date]")c=e.getTime()===t.getTime();else if(v.isReactElement(e)||v.isReactElement(t))c=!1;else for(h in e)if(!f[h]&&!(r&&h==="reference")){if(!(h in t)){c=!1;break}if(m=e[h],!ee.checkEquality(m,t[h],i,u)){c=!1;break}}}}!r&&_c(e)&&e.reference&&((n=i.refsFound)==null||n.add(e.reference)),o.set(t,c)}return c}static sync(e){var t;const i=e,{refOwner:r}=e,n=r==null?void 0:r.byRef,l=Gl();let a=e.affected,o,u,c,d;if(typeof a=="string"&&(a=[a]),e={...e,checkEqualityOptions:l},r){if(r.byRef={},a)for(u in n)a.includes(u)||(r.byRef[u]=n[u]);e.refsWas=n}if(i.changed=ee.performSync(e,e.targetElement),r)for(a||(a=Object.keys(n)),o=0;o<a.length;++o)u=a[o],c=n[u],l.refsFound.has(u)||c.retainElement?r.byRef[u]=c:(d=c.lastDomConfig,(t=c.blur)==null||t.call(c),c.remove(),r.detachRef(u,c,d));return e.targetElement}static performSync(e,t){const{domConfig:i,callback:r}=e,{lastDomConfig:n}=t;if((e.configEquality||ee.checkEquality)(i,n,e.checkEqualityOptions,e.ignoreRefs))r==null||r({action:"none",domConfig:i,targetElement:t});else return i?(i.onlyChildren||(ee.syncAttributes(i,t,e),ee.syncContent(i,t)),i.keepChildren||ee.syncChildren(e,t)):(t.innerHTML=null,t.syncIdMap=null),t.lastDomConfig=i!=null&&i.onlyChildren&&n?{...n,children:i.children}:i,!0;return!1}static syncDataset(e,t){const{lastDomConfig:i}=t,r=e===i,n=Object.keys(e.dataset),l=i&&i.dataset&&Object.keys(i.dataset),a=V.delta(n,l);let o,u,c,d;for(u=0;u<a.onlyInA.length;u++)o=a.onlyInA[u],d=e.dataset[o],d!=null&&t.setAttribute(`data-${k.hyphenate(o)}`,d);for(u=0;u<a.inBoth.length;u++)o=a.inBoth[u],d=e.dataset[o],(r||d!=i.dataset[o])&&(c=`data-${k.hyphenate(o)}`,d==null?t.removeAttribute(c):t.setAttribute(c,d));for(u=0;u<a.onlyInB.length;u++)t.removeAttribute(`data-${k.hyphenate(a.onlyInB[u])}`)}static addCls(e,t){const{lastDomConfig:i}=t;e=Z.normalize(e,"array"),e.forEach(r=>{t.classList.add(r),Fc(r,i)})}static removeCls(e,t){const{lastDomConfig:i}=t;e=Z.normalize(e,"array"),e.forEach(r=>{t.classList.remove(r),Lc(r,i)})}static syncClassList(e,t,i){let r=e.className||e.class,n=!1,l,a,o,u,c,d;if(i){for(a=Z.normalize(t,"array"),r=Z.normalize(r,"object"),d=Z.normalize(i.className||i.class,"object"),c=[],o=0,u=a.length;o<u;++o)l=a[o],r[l]||!(l in d)?(d[l]=1,c.push(l)):n=!0;for(l in r)d[l]||(c.push(l),n=!0);if(!n)return;r=c.join(" ")}else r=Z.normalize(r);t.setAttribute("class",r)}static getSyncAttributes(e){const t={},i=[];return e&&Object.keys(e).forEach(r=>{if(!Oc[r]){const n=r.toLowerCase();t[n]=e[r],i.push(n)}}),{attributes:t,names:i}}static syncAttributes(e,t,i){const{lastDomConfig:r}=t,n=e===r,l=ee.getSyncAttributes(e),{attributes:a,names:o}=l,{attributes:u,names:c}=n?l:ee.getSyncAttributes(r),{onlyInA:d,onlyInB:f,inBoth:g}=n?{onlyInA:Ul,onlyInB:Ul,inBoth:o}:V.delta(o,c);let h,p;for(p=0;p<d.length;p++){h=d[p];const m=a[h];h==="style"&&m!=null?v.applyStyle(t,m,!0):h==="dataset"?ee.syncDataset(e,t):Xl[h]?ee.syncClassList(e,t):m!=null&&t.setAttribute(h,m)}for(p=0;p<f.length;p++)t.removeAttribute(f[p]);for(p=0;p<g.length;p++){h=g[p];const m=a[h],y=u[h];m==null?t.removeAttribute(h):h==="style"?i.strict?n?ee.syncStyles(t,m):Yl(m,y,!0)||ee.syncStyles(t,m,y):(n||!Yl(m,y,!0))&&v.applyStyle(t,m,!0):h==="dataset"?ee.syncDataset(e,t):Xl[h]?ee.syncClassList(e,t,i.strict&&t.lastDomConfig):(n||m!==y)&&t.setAttribute(h,m)}}static syncStyles(e,t,i){let r,n,l;if(!i)r=t;else{if(r={},t=v.parseStyle(t),i=v.parseStyle(i),t)for(n in t)l=t[n],i[n]!==l&&(r[n]=l);for(n in i)n in t||(r[n]="")}v.applyStyle(e,r)}static syncContent(e,t){var i;const{html:r,text:n}=e,l=n!=null?n:r;if(t.didSetTextContent=!1,e.elementData&&(t.elementData=e.elementData),l instanceof DocumentFragment)t.childNodes.length===1&&v.getChildElementCount(t)===0&&l.childNodes.length===1&&v.getChildElementCount(l)===0?v.setInnerText(t,l.firstChild.data):(t.innerHTML="",t.appendChild(l));else if(r!=null&&ql.test(r))t.innerHTML=String(r);else if(l!=null){const{lastDomConfig:a}=t;(i=a==null?void 0:a.children)!=null&&i.length||a!=null&&a.html&&ql.test(t.lastDomConfig.html)?t.innerHTML=l:(v.setInnerText(t,String(l)),t.didSetTextContent=!0)}}static insertTextNode(e,t,i,r,n=null){const l=document.createTextNode(e);t.insertBefore(l,n),r&&(l.$refOwnerId=r.id),i==null||i({action:"newNode",domConfig:e,targetElement:l})}static insertElement(e,t,i,r,n,l,a){var o;const u=a.ns?document.createElementNS(a.ns,e.tag||"svg"):document.createElement(e.tag||"div");t.insertBefore(u,i),ee.performSync(a,u),l!=null&&(n[l]=u),!e.role&&!e.tabIndex&&!e["aria-hidden"]&&!v.isFocusable(u,!0)&&!u.htmlFor&&u.setAttribute("role","presentation"),r&&(u.$refOwnerId=r.id,l&&(u.$reference=l,r.attachRef(l,u,e))),(o=a.callback)==null||o.call(a,{action:"newElement",domConfig:e,targetElement:u,syncId:l})}static syncChildren(e,t){var i,r,n,l;let{domConfig:a,syncIdField:o,callback:u,releaseThreshold:c,configEquality:d,ns:f,refOwner:g,refsWas:h,strict:p,checkEqualityOptions:m,ignoreRefs:y}=e,b=null,S,C,T;const _=a.syncOptions||{};if((i=a.html)!=null?i:a.text)return;y=!!((r=_.ignoreRefs)!=null?r:y),y&&(g=h=null),"strict"in _&&(p=_.strict);const L=g?g.byRef:{},F=Wl.call(a.children||[]),O=Wl.call(t.childNodes),M=h||t.syncIdMap||{},P=t.releasedIdMap||{},W=I=>{for(;O.length&&O[0].parentNode!==t;)O.shift();return(I?O.shift():O[0])||null};o=_.syncIdField||o,p=_.strict||p,u=_.callback||u,d=_.configEquality||d,c="releaseThreshold"in _?_.releaseThreshold:c,o&&(t.syncIdMap=L);const H={checkEqualityOptions:m||Gl(),ignoreRefs:y,refOwner:g,refsWas:h,strict:p,syncIdField:o,releaseThreshold:c,callback:u,configEquality:d};for(;F.length;){const I=F.shift();if(T=null,!I)continue;if(v.isReactElement(I)){u({jsx:I,targetElement:t,domConfig:a});continue}if(Array.isArray(I)){this.syncChildren({...e,domConfig:{...e.domConfig,children:I}},t);continue}if(I instanceof Node){C=W(),I!==C&&t.insertBefore(I,C),S=O.indexOf(I),S>-1&&O.splice(S,1);continue}const Y=typeof I=="string";if(H.domConfig=I,H.ns=I.ns||f,!Y){if(g?T=I.reference:o&&I.dataset&&(T=I.dataset[o]),T!=null&&!I.unmatched){const U=M[T]||P[T];if(U){const{lastDomConfig:te}=U;U.retainElement||ee.performSync(H,U)&&(u==null||u({action:"reuseOwnElement",domConfig:I,targetElement:U,lastDomConfig:te,syncId:T})),I.retainElement&&(U.retainElement=!0),L[T]=U,V.remove(O,U),delete P[T],U.isReleased=!1,C=W(),(U.parentNode!==t||p&&U.nextSibling!==C)&&t.insertBefore(U,C)}else p?ee.insertElement(I,t,W(),g,L,T,H):(F.push(I),I.unmatched=!0);continue}I.unmatched&&delete I.unmatched}let G=null,A=null,X;for(;!A&&(X=W(!0));){if(g){if(X.$refOwnerId!==g.id)continue;if(X.$reference){if(!p)continue;G=X;break}A=X}else X.retainElement||(A=X);A||(b||(b=[])).push(X)}if(G||!A)Y?ee.insertTextNode(I,t,u,g,G):ee.insertElement(I,t,G,g,L,T,H);else if(!Y&&A.nodeType===Node.ELEMENT_NODE&&(I.tag||"div").toLowerCase()===A.tagName.toLowerCase()){const{lastDomConfig:U}=A,te=ee.performSync(H,A);if(o&&((n=U==null?void 0:U.dataset)==null?void 0:n[o])!=null){const de=U.dataset[o];delete P[de],delete M[de]}T!=null&&(L[T]=A),A.isReleased=!1,te&&(u==null||u({action:"reuseElement",domConfig:I,targetElement:A,lastDomConfig:U,syncId:T}))}else Y&&A.nodeType===Node.TEXT_NODE?A.data=I:(Y?ee.insertTextNode(I,t,u,g,A):ee.insertElement(I,t,A,g,L,T,H),(l=A.blur)==null||l.call(A),A.remove())}if(!(t.didSetTextContent&&O.length===1&&O[0].nodeType===Node.TEXT_NODE)&&!a.retainChildren){for(;C=W(!0);)(!g||C.$refOwnerId===g.id&&!C.$reference)&&(b||(b=[])).push(C);b&&ee.syncChildrenCleanup(t,b,L,u,g,c,o)}}static syncChildrenCleanup(e,t,i,r,n,l,a){var o;let u=0,c;for(const d of t){const{lastDomConfig:f}=d;if(d.nodeType===Element.TEXT_NODE){d.remove();continue}d.retainElement?a&&f&&(i[d.dataset[a]]=d):!n&&a&&(l==null||u<l)?(d.isReleased||(d.className="b-released",d.isReleased=!0,f!=null&&f.dataset&&(e.releasedIdMap||(e.releasedIdMap={}),e.releasedIdMap[f.dataset[a]]=d),r==null||r({action:"releaseElement",domConfig:f,lastDomConfig:f,targetElement:d}),f&&(f.isReleased=!0,f.className&&(f.className="b-released"),f.class&&(f.class="b-released"),f.style&&(f.style=null))),u++):((o=d.blur)==null||o.call(d),d.remove(),n&&(c=d.$reference,c&&n.detachRef(c,d,f)),e.releasedIdMap&&a&&(f!=null&&f.dataset)&&delete e.releasedIdMap[f.dataset[a]],r==null||r({action:"removeElement",domConfig:d.lastDomConfig,lastDomConfig:d.lastDomConfig,targetElement:d}))}}static removeChild(e,t){if(e.contains(t)){const i=e.syncIdMap;if(i){const r=Object.values(i).indexOf(t);r>-1&&delete i[Object.keys(i)[r]]}e.removeChild(t)}}static addChild(e,t,i){e.appendChild(t),e.syncIdMap||(e.syncIdMap={}),e.syncIdMap[i]=t}static getChild(e,t){var i;const r=String(t).split(".");for(const n of r)if(e=(i=e==null?void 0:e.syncIdMap)==null?void 0:i[n],!e)return null;return e}};bt._$name="DomSync";var $e=class{static init(){const s=["fullscreenEnabled","requestFullscreen","exitFullscreen","fullscreenElement"],e=n=>s.map(l=>{let a=n+k.capitalize(l);return n==="moz"&&(a=a.replace("screen","Screen"),"mozCancelFullScreen"in document&&l==="exitFullscreen"&&(a="mozCancelFullScreen")),a});this.functions="fullscreenEnabled"in document&&s||"webkitFullscreenEnabled"in document&&e("webkit")||"mozFullScreenEnabled"in document&&e("moz")||"msFullscreenEnabled"in document&&e("ms")||[];const t=["fullscreenchange","fullscreenerror"],i=["MSFullscreenChange","MSFullscreenError"],r=n=>t.map(l=>n+k.capitalize(l));this.events="fullscreenEnabled"in document&&t||"webkitFullscreenEnabled"in document&&r("webkit")||"mozFullscreenEnabled"in document&&r("moz")||"msFullscreenEnabled"in document&&i||[],this.onFullscreenChange(this.onInternalFullscreenChange.bind(this))}static get enabled(){return!!(this.functions[0]&&document[this.functions[0]])}static async request(s){return this.functions[1]&&(s==null?void 0:s[this.functions[1]]())}static async exit(){return this.functions[2]&&document[this.functions[2]]()}static get isFullscreen(){return!!this.element}static get element(){return this.functions[3]&&document[this.functions[3]]}static onFullscreenChange(s){this.events[0]&&document.addEventListener(this.events[0],s)}static unFullscreenChange(s){this.events[0]&&document.removeEventListener(this.events[0],s)}static onInternalFullscreenChange(){const s=this,{element:e}=s;if(e){if(!e.closest(".b-floatroot")){const t=v.getRootElement(e),{floatRoot:i}=t;i&&(s._floatRoot=i,s._oldParent=i.parentElement,e.appendChild(i))}}else s._floatRoot&&s._oldParent.appendChild(s._floatRoot),s._oldParent=null,s._floatRoot=null}};$e.init(),$e._$name="Fullscreen";var ps=null,ms=[],kc=s=>{var e;return s.nodeType===s.ELEMENT_NODE&&((e=s.ownerDocument.defaultView)==null?void 0:e.getComputedStyle(s).getPropertyValue("position"))==="absolute"},ce=class Ka{static addResizeListener(e,t){const i=this;if((e===document||e===globalThis)&&(e=document.body),e.nodeType===e.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e.classList.contains("b-resize-monitored")||(e.classList.add("b-resize-monitored"),e._bResizemonitor={handlers:[]}),e===document.body)i.hasWindowResizeListener||(globalThis.addEventListener("resize",i.onWindowResize),i.hasWindowResizeListener=!0);else if(globalThis.ResizeObserver)i.resizeObserver||(i.resizeObserver=new ResizeObserver(i.onElementResize)),i.resizeObserver.observe(e);else{e.classList.add("b-no-resizeobserver");const[r,n,l]=v.createElement({parent:e,className:"b-resize-monitors",children:[{className:"b-resize-monitor-expand"},{className:"b-resize-monitor-shrink"}]},{returnAll:!0});n.scrollLeft=n.scrollTop=l.scrollLeft=l.scrollTop=1e6,n.addEventListener("scroll",i.onSizeMonitorScroll,!0),l.addEventListener("scroll",i.onSizeMonitorScroll,!0),(t.targetMutationMonitor=new MutationObserver(a=>{const o=[],u=[];for(const d of a)d.type==="childList"&&(o.push.apply(o,d.addedNodes),u.push.apply(u,d.removedNodes));const c=[...o.filter(d=>!u.includes(d)),...u.filter(d=>!o.includes(d))];c.length!==0&&(c.length>0&&c.every(kc)||n.dispatchEvent(new CustomEvent("scroll",{bubbles:!1})))})).observe(e,{childList:!0,subtree:!0}),t.monitorElement=r}e._bResizemonitor.handlers.push(t)}static removeResizeListener(e,t){if(e){(e===document||e===globalThis)&&(e=document.body);const i=e._bResizemonitor;let r=0;i&&i.handlers&&(V.remove(i.handlers,t),r=i.handlers.length),r||(e.classList.remove("b-resize-monitored"),this.resizeObserver?this.resizeObserver.unobserve(e):(t.monitorElement&&(t.monitorElement.remove(),t.monitorElement=null),t.targetMutationMonitor&&t.targetMutationMonitor.disconnect()))}}static onElementResize(e){for(const t of e){const i=t.target,r=i._bResizemonitor,n=t.contentRect||i.getBoundingClientRect();if(rt(i)&&(!r.rectangle||n.width!==r.rectangle.width||n.height!==r.rectangle.height)){const l=r.rectangle;r.rectangle=n;for(const a of r.handlers)a(i,l,n)}}}static onSizeMonitorScroll(e){var t;if(e.target.isConnected||(t=document.body)!=null&&t.contains(e.target)){e.stopImmediatePropagation();const i=e.target.parentNode,r=i.parentNode,n=r._bResizemonitor,l=r.getBoundingClientRect();(!n.rectangle||l.width!==n.rectangle.width||l.height!==n.rectangle.height)&&(ms.push([r,n.rectangle,l]),n.rectangle=l,ps||(ps=requestAnimationFrame(Ka.fireResizeEvents))),i.firstChild.scrollLeft=i.firstChild.scrollTop=i.childNodes[1].scrollTop=i.childNodes[1].scrollLeft=1e6}}static onWindowResize(e){const t=document.body,i=t._bResizemonitor,r=i.rectangle;i.rectangle=document.documentElement.getBoundingClientRect();for(const n of i.handlers)n(t,r,i.rectangle)}static fireResizeEvents(){for(const e of ms)for(const t of e[0]._bResizemonitor.handlers)e[0].offsetParent&&t.apply(this,e);ps=null,ms.length=0}static removeGlobalListeners(){globalThis.removeEventListener("resize",this.onWindowResize)}};ce._$name="ResizeMonitor";var Jl={auto:"auto",true:"auto",false:"hidden","hidden-scroll":"auto",clip:j.supportsOverflowClip?"clip":"hidden"},Zl="b-widget-scroller",ys={block:"nearest"},Ql=Promise.resolve(),ea=s=>new Promise(e=>B.on({element:s===document.documentElement?globalThis:s,scroll:e,once:!0})),Ac={x:1},ur={auto:1,scroll:1},Pc={true:1,auto:1},Rc={overflowX:"auto",overflowY:"auto"},$c=s=>{var e,t,i,r;let n,l,a,o;return s?typeof s=="number"?n=l=a=o=s:(n=(e=s.top)!=null?e:0,l=(t=s.bottom)!=null?t:0,a=(i=s.start)!=null?i:0,o=(r=s.end)!=null?r:0):n=l=a=o=0,{top:n,bottom:l,start:a,end:o}},vs=class $i extends lt(De(R)){static get configurable(){return{widget:null,element:{$config:{nullify:!0},value:null},contentElement:{$config:{nullify:!0},value:null},overflowX:null,overflowY:null,translate:null,x:0,y:0,rtlSource:null,propagateSync:null}}static get delayable(){return{onScrollEnd:{type:"buffer",delay:100}}}get isRTL(){var e;return!!((e=this.rtlSource)!=null&&e.rtl)}syncOverflowState(){const e=this,{element:t}=e,{hasOverflowX:i,hasOverflowY:r}=e,n=e.hasOverflowX=t.scrollWidth>t.clientWidth,l=e.hasOverflowY=t.scrollHeight>t.clientHeight;if(i!==n||r!==l){const a=new Z(t.classList,{"b-horizontal-overflow":n,"b-vertical-overflow":l});v.syncClassList(t,a),e.isConfiguring||e.trigger("overflowChange",{x:n,y:l})}}hasOverflow(e="y"){const t=this,i=t[`overflow${e.toUpperCase()}`],r=t[`overflow${e==="y"?"x":"y"}`];if(!v.scrollBarWidth||!Pc[i]||r==="hidden-scroll"){const n=e==="y"?"Height":"Width";return t[`scroll${n}`]>t[`client${n}`]}return t[`hasOverflow${e.toUpperCase()}`]}hasScrollbar(e="y"){const{element:t}=this;if(t&&v.scrollBarWidth){const i=e==="y",r=i?"Width":"Height",n=t[`client${r}`],l=parseInt(v.getStyleValue(t,`border${i?"Left":"Top"}Width`))+parseInt(v.getStyleValue(t,`border${i?"Right":"Bottom"}Width`)),a=t[`offset${r}`]-l-n;return Math.abs(a-v.scrollBarWidth)<2}}addPartner(e,t=Ac){const i=this;typeof t=="string"&&(t={[t]:1}),i.partners||(i.partners={}),i.partners[e.id]={scroller:e,axes:t},t.x&&(e.x=i.x),t.y&&(e.y=i.y),e.isPartneredWith(i)||e.addPartner(i,t)}eachPartner(e){const{partners:t}=this;t&&Object.values(t).forEach(e)}removePartner(e){e&&this.isPartneredWith(e)&&(delete this.partners[e.id],e.removePartner(this))}isPartneredWith(e){var t;return!!((t=this.partners)!=null&&t[e.id])}clearPartners(){this.partners&&Object.values(this.partners).forEach(e=>e.scroller.removePartner(this))}async scrollIntoView(e,t=ys){const i=this,{isRectangle:r}=e,n=r?e:K.from(e),{xDelta:l,yDelta:a}=i.getDeltaTo(e,t),o=i.scrollBy(l,a,t);return(t.highlight||t.focus)&&o.then(()=>{var u,c;e=r?n.translate(-l,-a):(c=(u=t.elementAfterScroll)==null?void 0:u.call(t))!=null?c:e,t.highlight&&(isNaN(t.highlight)?(i.widget||i).callback(t.highlight,null,[e]):v.highlight(e,i)),t.focus&&v.focusWithoutScrolling(e)}),o}static async scrollIntoView(e,t=ys,i=!1){const r=K.from(e),n=typeof t=="object"?t.animate:t,l=$i._globalScroller||($i._globalScroller=new $i),a=[];l.rtlSource={rtl:i};let o=0,u=0,c;for(let d=e.parentNode;d.nodeType===Node.ELEMENT_NODE;d=d.parentNode){if(d===document.body&&d!==document.scrollingElement)continue;const f=d===document.scrollingElement?Rc:d.ownerDocument.defaultView.getComputedStyle(d);if(t.y!==!1&&ur[f.overflowY]&&d.scrollHeight>d.clientHeight||t.x!==!1&&ur[f.overflowX]&&d.scrollWidth>d.clientWidth){l.element=d,l.positionDirty=!0;const{xDelta:g,yDelta:h}=l.getDeltaTo(r,t);(g||h)&&(a.push({element:d,x:d.scrollLeft,y:d.scrollTop,xDelta:g,yDelta:h}),r.translate(-g,-h),o+=g,u+=h)}}if(a.length){const d=Math.abs(o),f=Math.abs(u);let g=n&&(typeof n=="number"?n:typeof n.duration=="number"?n.duration:300);if(g&&(d>10||f>10))Math.max(d,f)<50&&(g=Math.min(g,500)),c=l.scrollAnimation=re.animate(g,h=>{const p=h===1;for(const{element:m,x:y,y:b,xDelta:S,yDelta:C}of a)l.element=m,S&&(l.x=Math[i?"min":"max"](y+(p?S:Math.round(S*h)),0)),C&&(l.y=Math.max(b+(p?C:Math.round(C*h)),0))},null,n.easing),c.then(()=>{l.scrollAnimation=null});else{for(const{element:h,xDelta:p,yDelta:m}of a)h.scrollTop+=m,h.scrollLeft+=p;c=ea(a[a.length-1].element)}}else c=Ql;return(t.highlight||t.focus)&&c.then(()=>{t.highlight&&(isNaN(t.highlight)?l.callback(t.highlight,null,[e]):v.highlight(e,l)),t.focus&&e.focus()}),c}scrollBy(e=0,t=0,i=ys){const r=this,n=typeof i=="object"?i.animate:i,l=Math.abs(e),a=Math.abs(t);r.scrollAnimation&&(r.scrollAnimation.cancel(),r.scrollAnimation=null),(e||t)&&(r.silent=i.silent);let o=n&&(typeof n=="number"?n:typeof n.duration=="number"?n.duration:300);if(o&&(l>10||a>10)){const{x:u,y:c}=r;let d=u,f=c;return Math.max(l,a)<50&&(o=Math.min(o,500)),r.scrollAnimation=re.animate(o,g=>{var h,p;const m=g===1;if(e){if(Math.abs(r.x-d)>1&&!i.force)return(h=r.scrollAnimation)==null?void 0:h.cancel();r.x=Math.max(u+(m?e:Math.round(e*g)),0)}if(t){if(Math.abs(r.y-f)>1&&!i.force)return(p=r.scrollAnimation)==null?void 0:p.cancel();r.y=Math.max(c+(m?t:Math.round(t*g)),0)}d=r.x,f=r.y},r,n.easing),r.element.classList.add("b-scrolling"),r.scrollAnimation.then(()=>{r.isDestroyed||(r.element.classList.remove("b-scrolling"),r.scrollAnimation=null)}),r.scrollAnimation}else{if(e||t){const u=r.x,c=r.y;if(Math.round(l)>=1&&(r.x+=e),Math.round(a)>=1&&(r.y+=t),r.x!==u||r.y!==c)return ea(r.element)}return Ql}}async scrollTo(e,t,i){const{x:r,y:n}=this,l=e==null?0:e-r,a=t==null?0:t-n;return this.scrollingToCenter=i==null?void 0:i.scrollingToCenter,this.scrollBy(l,a,i)}doDestroy(){var e,t;const i=this;i._element&&(i._element.removeEventListener("scroll",i.scrollHandler),(e=i.wheelListenerRemover)==null||e.call(i)),(t=i.scrollAnimation)==null||t.cancel(),Object.values(i.partners||{}).forEach(({scroller:r})=>r.removePartner(i)),super.doDestroy()}onElMutation(e){const t=this,[i,r]=v.getTranslateXY(t.element);if(t._x!==-i||t.y!==-r){const n=new CustomEvent("scroll",{bubbles:!0});Object.defineProperty(n,"target",{get:()=>t.element}),t.onScroll(n)}}onElResize(){const e=this,{widget:t}=e;t!=null&&t.isAnimating?t.findListener("animationend","onElResize",e)===-1&&t.ion({animationEnd:"onElResize",thisObj:e,once:!0}):e.syncOverflowState()}onScroll(e){const t=this,{_x:i,_y:r,element:n}=t;let l=0;t.overflowX==="clip"&&n.scrollLeft!==i&&(n.scrollLeft=i,++l),t.overflowY==="clip"&&n.scrollTop!==r&&(n.scrollTop=r,++l),l!==2&&(!t.widget||!t.widget.isDestroyed)&&(t.positionDirty=!0,n.classList.contains("b-scrolling")||n.classList.add("b-scrolling"),e.widget=t.widget,e.scrollingToCenter=t.scrollingToCenter,t.silent||t.trigger("scroll",e),t.syncPartners(),t.controllingPartner=null,t.onScrollEnd(e))}syncPartners(e,t=this.propagateSync){const i=this;i.partners&&Object.values(i.partners).forEach(({axes:r,scroller:n})=>{(n!==i.controllingPartner||e)&&n.sync(i,r)&&t&&n.syncPartners(e,t)})}onScrollEnd(e){const t=this;t.silent&&(t.silent=!1),t.trigger("scrollEnd",e),t.scrollingToCenter=!1,t.controllingPartner=null,t.element.classList.remove("b-scrolling")}getDeltaTo(e,t){const i=this;if(!i.viewport)return{xDelta:0,yDelta:0};const{x:r,y:n,scrollWidth:l,scrollHeight:a,isRTL:o}=i,u=e instanceof K?e:K.from(e),c=t.block||"nearest",d=i.viewport,f=$c(t.edgeOffset),g=d.width>=u.width+(f.start+f.end)?f:{start:0,end:0},h=d.height>=u.height+(f.top+f.bottom)?f:{top:0,bottom:0},p=new K(o?d.right- -r-l:d.x-r,d.y-n,l,a),m=u.clone().adjust(-g.start,-h.top,g.end,h.bottom).constrainTo(p),y=m.clone(),b=i.isRTL?-1:1;let S=0,C=0;if(c==="start")y.moveTo(d.x+(i.isRTL?d.width-y.width:0),d.y),S=m.x-y.x,C=m.y-y.y;else if(c==="end")y.moveTo(d.x+(i.isRTL?0:d.width-y.width),d.bottom-y.height),S=m.x-y.x,C=m.y-y.y;else if(c==="center"){const T=d.center;y.moveTo(T.x-y.width/2,T.y-y.height/2),S=S||m.x-y.x,C=C||m.y-y.y}else y.width>d.width?S=y.x-d.x:y.right>d.right?S=y.right-d.right:y.x<d.x&&(S=y.x-d.x),y.height>d.height?C=y.y-d.y:y.bottom>d.bottom?C=y.bottom-d.bottom:y.y<d.y&&(C=y.y-d.y);return S=b*Math.round(S),C=Math.round(C),t.constrainToScrollable!==!1&&(S=Math.max(Math.min(S,i.maxX-r),-r),C=Math.max(Math.min(C,i.maxY-n),-n)),{xDelta:t.x===!1?0:S,yDelta:t.y===!1?0:C}}get viewport(){return K.client(this.element)}updateWidget(e){this.rtlSource=this.owner=e}updateElement(e,t){var i;const r=this;if(r===$i._globalScroller){r._element=e,r.positionDirty=!0;return}const n=r.scrollHandler||(r.scrollHandler=r.onScroll.bind(r)),l=r.resizeHandler||(r.resizeHandler=r.onElResize.bind(r));if(t&&(r.translate?(i=r.mutationObserver)==null||i.disconnect():(t.removeEventListener("scroll",n),t.classList.remove(Zl),t.style.overflowX=t.style.overflowY=""),ce.removeResizeListener(t,l)),e){if(r.translate){if(r.mutationObserver||(r.mutationObserver=new MutationObserver(r.mutationHandler||(r.mutationHandler=r.onElMutation.bind(r)))),r._x=r._y=0,document.contains(e)){const[a,o]=v.getTranslateXY(e);r._x=-a,r._y=-o}r.mutationObserver.observe(e,{attributes:!0})}else e.addEventListener("scroll",n),e.classList.add(Zl);ce.addResizeListener(e,l),r.widget||(r.rtlSource={get rtl(){return v.getStyleValue(e,"direction")==="rtl"}}),r.isRTL&&e.classList.add("b-rtl"),r.positionDirty&&(r.updateOverflowX(r.overflowX),r.updateOverflowY(r.overflowY)),r.syncOverflowState(),r.isConfiguring&&(r._x&&r.updateX(r._x),r._y&&r.updateY(r._y))}r.positionDirty=!0}get x(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[i,r]=v.getTranslateXY(t);e._x=-i,e._y=-r}else e._x=Math.abs(t.scrollLeft),e._y=t.scrollTop;e.positionDirty=!1}return e._x}get scrollLeft(){return this.x*(this.isRTL?-1:1)}changeX(e){if(e=Math.max(e,0),!this.isConfiguring||e)return e;this._x=e}updateContentElement(e){e&&(e=typeof e=="string"?this.element.querySelector(e):e,ce.addResizeListener(e,this.resizeHandler))}updateX(e){var t;const i=this,{element:r}=i;r&&!((t=i.widget)!=null&&t.isConfiguring)&&(e=Math.round(e),i.trigger("scrollStart",{x:e}),i.translate?v.setTranslateX(r,-e):r.scrollLeft=i.isRTL?-e:e),i.positionDirty=!0}sync(e,t){const i=this,{x:r,y:n}=t;let l=!1;return r!=null&&i.x!==e.x&&(i.controllingPartner=e,i.x=e.x,l=!0),n!=null&&i.y!==e.y&&(i.controllingPartner=e,i.y=e.y,l=!0),l}get y(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[i,r]=v.getTranslateXY(t);e._x=-i,e._y=-r}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._y}changeY(e){if(!this.isConfiguring||e)return e;this._y=e}updateY(e){const{element:t,widget:i}=this;t&&!(i!=null&&i.isConfiguring)&&(this.trigger("scrollStart",{y:e}),this.translate?v.setTranslateY(t,-e):t.scrollTop=e),this.positionDirty=!0}get maxX(){return this.scrollWidth-this.clientWidth}get maxY(){return this.scrollHeight-this.clientHeight}get lastScrollLeft(){return(this.scrollWidth-this.clientWidth)*(this.isRTL?-1:1)}updateOverflowX(e,t){const i=this,{element:r,translate:n}=i,{style:l,classList:a}=r;t==="hidden-scroll"&&a.remove("b-hide-scroll"),e==="hidden-scroll"&&!n&&(ur[l.overflowY]?(e="hidden",i.enableWheel()):a.add("b-hide-scroll")),n||(l.overflowX=Jl[e]||e),i.isConfiguring||(i.positionDirty=!0,i.syncOverflowState())}updateOverflowY(e,t){const i=this,{element:r,translate:n}=i,{style:l,classList:a}=r;t==="hidden-scroll"&&a.remove("b-hide-scroll"),e==="hidden-scroll"&&!n&&(ur[l.overflowX]?(e="hidden",i.enableWheel()):a.add("b-hide-scroll")),n||(l.overflowY=Jl[e]||e),i.isConfiguring||(i.positionDirty=!0,i.syncOverflowState())}enableWheel(){this.wheelListenerRemover||(this.wheelListenerRemover=B.on({element:this.element,wheel:"onWheel",thisObj:this}))}onWheel(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)&&this.overflowX==="hidden-scroll"?this.x+=e.deltaX:this.overflowY==="hidden-scroll"&&(this.y+=e.deltaY)}get scrollWidth(){var e,t;return(t=(e=this.element)==null?void 0:e.scrollWidth)!=null?t:0}set scrollWidth(e){const t=this,{element:i,isRTL:r}=t;let n=t.widthStretcher;n&&e==null?(n.remove(),t.widthStretcher=null):e&&(e=Math.abs(e),n||(n=t.widthStretcher=v.createElement({className:"b-scroller-stretcher b-horizontal-stretcher",retainElement:!0})),n.style.transform=`translateX(${(e-1)*(r?-1:1)}px)`,i&&!i.contains(n)&&i.insertBefore(n,i.firstElementChild)),t.propagate!==!1&&t.eachPartner(({scroller:l})=>{l.propagate=!1,l.scrollWidth=e,delete l.propagate}),t.positionDirty=!0,t.syncOverflowState()}get scrollHeight(){var e,t;return(t=(e=this.element)==null?void 0:e.scrollHeight)!=null?t:0}set scrollHeight(e){const t=this,i=t.stretcher||(t.stretcher=v.createElement({className:"b-scroller-stretcher"}));i.style.transform=`translateY(${e-1}px)`,t.element&&t.element.lastChild!==i&&t.element.appendChild(i),t.positionDirty=!0,t.syncOverflowState()}get clientWidth(){var e;return((e=this.element)==null?void 0:e.clientWidth)||0}get clientHeight(){var e;return((e=this.element)==null?void 0:e.clientHeight)||0}get id(){return this._id||(this.widget?this._id=`${this.widget.id}-scroller`:this._id=sr.generateId("scroller-")),this._id}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(),delete e.widget,delete e.element}};vs._$name="Scroller";var cr=class{constructor(s){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),s&&s(this)}};cr._$name="Promissory";var{defineProperty:bs}=Reflect,wi=class qs extends R.mixin(ti,De,lt,di){static get configurable(){return{element:null}}static get delayable(){return{refreshDom:"raf"}}static get identifiable(){return{}}static get renderConfigs(){const e=this,t=e.$meta;let i=t.renderConfigs,r,n;if(i===void 0){i=null,r=t.configs;for(n in r)r[n].render&&(i||(i=new Set)).add(n);t.renderConfigs=e.prototype.$renderConfigs=i}return i}construct(...e){this.$iid=++qs.$idSeed,this.byRef={},super.construct(...e),this.onDraw!==qs.prototype.onDraw&&this.initDrawable()}startConfigure(e){this.element=this.renderContext.renderDom(),super.startConfigure(e)}get element(){return this.refreshDom.flush(),this._element}changeElement(e,t){const i=this;return t&&t.remove(),e&&(e.id=i.id,e=v.createElement(e,{refOwner:i})),e}updateId(e,t){const i=this;if(t){const r=i.element;r.id=e,i.fixRefOwnerId(r,e,t)}}get classes(){return this.element.classList}fixRefOwnerId(e,t,i){if(e.$refOwnerId===i){e.$refOwnerId=t;const r=e.$reference;r&&(e.id=`${t}-${r}`);for(const n of e.childNodes)this.fixRefOwnerId(n,t,i)}}onConfigChange({name:e}){!this.isConfiguring&&this.$renderConfigs.has(e)&&this.refreshDom()}attachRef(e,t,i){const r=this,n="_"+e,{listeners:l}=i;n in r||bs(r,e,{get(){return r.refreshDom.flush(),r[n]},set(a){r[n]=a}}),t.id=`${r.id}-${e}`,r.byRef[e]=t,r[e]=t,l&&(i.listeners={on:l,un:B.on(Object.assign({element:t,thisObj:r},l))})}detachRef(e,t,i){i.listeners&&(i.listeners.un(),i.listeners=null),this[e]=null,delete this.byRef[e]}renderDom(){return{}}get renderContext(){const e=this,t=e.$meta,i=e.constructor;let r=t.renderConfigs||i.renderConfigs,n=e;if(!r){n=Object.create(e),r=new Set;for(const l in t.configs)bs(n,l,{get(){return r.add(l),e[l]}});n.renderDom=()=>e.renderDom.call(n),e.$renderConfigs=r}return bs(e,"renderContext",{value:n}),n}refreshDom(){bt.sync({targetElement:this.element,domConfig:this.renderContext.renderDom(),refOwner:this,strict:!0})}onListen(e){e==="draw"&&this.initDrawable()}initDrawable(){const e=this;if(!e.intersector){let t=Object.values(e.byRef).find(i=>i.classList.contains("b-drawable"));t||(t=e.element,t.classList.add("b-drawable")),e.intersector=new IntersectionObserver(i=>{e.isDestroyed||i.forEach(r=>{r.isIntersecting&&e.onDraw({count:++e.drawCounter})})}),e.intersector.observe(t)}}onDraw(e){this.trigger("draw",e)}};wi.$idSeed=0,Object.assign(wi.prototype,{drawCounter:0,hasGeneratedId:!1,intersector:null}),wi._$name="Renderable";var Ct=class Ni extends wi{construct(e){if(e){let r=e.element,n;r&&(le.deprecate("Core","4.0.0",'Mask "element" config has been renamed to "target"'),e=n=Object.assign({},e),delete n.element,n.target=r),r=e.target,typeof r=="string"&&(e=n=n||Object.assign({},e),n.target=e.owner[r])}super.construct(e);const t=this,{type:i}=t;t.target||(t.target=document.body),t.maskName=`mask${typeof i=="string"?i.trim():""}-${Ni.counter++}`,t.show()}doDestroy(){const e=this,{element:t}=e;if(e.type==="trial")return!1;t&&(e.element=null,e.mode.endsWith("blur")&&v.forEachChild(t,i=>{i.classList.remove(`b-masked-${e.mode}`)}),e.target.classList.remove("b-masked"),e.target[e.maskName]=null,V.remove(Ni.masks,e)),super.doDestroy()}get maskElement(){return this.element}set error(e){this.setConfig(this.errorDefaults),this.text=e}renderDom(){const e=this,{maxProgress:t}=e;return{class:{"b-mask":1,"b-delayed-show":e.showDelay,"b-widget":1,[`b-mask-${e.mode}`]:1,"b-progress":t,"b-prevent-transitions":!e.useTransition},children:[{reference:"maskContent",class:"b-mask-content b-drawable",children:[t?{reference:"progressElement",class:"b-mask-progress-bar",style:{width:`${Math.max(0,Math.min(100,Math.round(e.progress/t*100)))}%`}}:null,{reference:"maskText",class:"b-mask-text",html:(e.icon?`<i class="b-mask-icon ${e.icon}"></i>`:"")+e.text}]}]}}static mergeConfigs(...e){const t={};for(const i of e)typeof i=="string"?t.text=i:w.assign(t,i);return t}static mask(e,t=document.body){return Ni.new({target:t},typeof e!="string"?{...e}:{text:e})}static unmask(e=document.body){const t=this.getElementMasks(e);return t.length>0?t[t.length-1].close():null}static unmaskAll(e=document.body){return this.getElementMasks(e).forEach(t=>t.close())}static getElementMasks(e){return this.masks.filter(t=>t.target===e)}updateAutoClose(e){this.deferredClose.cancel(),e&&(this.deferredClose.delay=e,this.deferredClose())}updateCover(){this.syncCover()}syncCover(){var e,t;(t=(e=this.owner)==null?void 0:e.syncMaskCover)==null||t.call(e,this)}onOwnerResize(){this.syncCover()}updateOwner(e){this.detachListeners("cover"),e==null||e.ion({name:"cover",recompose:"onOwnerResize",resize:"onOwnerResize",thisObj:this})}updateShowDelay(e){const{delayedShow:t}=this;t.delay=e,e||t.flush()}deferredClose(){var e;const{owner:t}=this;this.close().then(()=>{var i;(i=t==null?void 0:t.onMaskAutoClose)==null||i.call(t,this)}),(e=t==null?void 0:t.onMaskAutoClosing)==null||e.call(t,this)}delayedShow(){this.classes.remove("b-delayed-show")}show(){const e=this,{element:t,target:i,hiding:r,maskName:n}=e;r&&(r.resolve(),e.hiding=null,e.clearTimeout("hide")),e.showDelay&&(t.classList.add("b-delayed-show"),e.delayedShow()),t.classList.add("b-visible"),t.classList.remove("b-hidden"),i.classList.add("b-masked"),i[n]||(i[n]=e,i.appendChild(t)),V.include(Ni.masks,e),e.shown=!0,e.trigger("show"),e.mode.endsWith("blur")&&v.forEachChild(i,l=>{l!==t&&l.classList.add(`b-masked-${e.mode}`)})}hide(){const e=this,{target:t,element:i}=e;let{hiding:r}=e;if(!r){if(!e.shown)return Promise.resolve();e.hiding=r=new cr,e.shown=!1,i.classList.remove("b-visible"),i.classList.add("b-hidden"),t.classList.remove("b-masked"),e.mode.endsWith("blur")&&v.forEachChild(t,n=>{n!==i&&n.classList.remove(`b-masked-${e.mode}`)}),r.promise=r.promise.then(()=>{e.hiding===r&&(e.hiding=null)}),e.setTimeout(()=>r.resolve(),500,"hide")}return r.promise}async close(){await this.hide(),this.destroy()}};x(Ct,"$name","Mask"),x(Ct,"type","mask"),x(Ct,"configurable",{autoClose:null,cover:null,icon:"b-icon b-icon-spinner",errorDefaults:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},maxProgress:null,mode:"dark",progress:null,owner:{$config:"nullify",value:null},target:null,text:null,type:null,showDelay:null,useTransition:!1}),x(Ct,"delayable",{deferredClose:0,delayedShow:0,syncCover:{type:"throttle",delay:100}}),x(Ct,"counter",0),x(Ct,"masks",[]);var Si=Ct;Si._$name="Mask";var ta=s=>{var e;return e=class extends(s||R){get widgetClass(){}get keyMapElement(){return this.element}get keyMapSubComponents(){return this.features}matchKeyMapEntry(t,i=this.keyMap){if(i&&!t.handled&&t.key!==void 0)return w.keys(i).find(r=>{const n=r.split("+"),l=n.includes("Alt"),a=n.includes("Shift"),o=n.includes("Ctrl");let u=n[n.length-1].toLowerCase();return u==="space"&&(u=" "),u===t.key.toLowerCase()&&(!t.altKey&&!l||t.altKey&&l)&&(!t.ctrlKey&&!o||t.ctrlKey&&o)&&(!t.shiftKey&&!a||t.shiftKey&&a)})}performKeyMapAction(t){var i;const{keyMap:r}=this;let n=!1;if(r&&!t.handled&&t.key!==void 0){const l=this.matchKeyMapEntry(t);if(r[l]){const a=V.asArray(r[l]);t.fromKeyMap=!0;let o;for(let u of a){if(o=!0,w.isObject(u)){if(!u.handler)continue;u.preventDefault===!1&&(o=!1),u=u.handler}if(typeof u=="string"){const{thisObj:c,handler:d}=this.resolveKeyMapAction(u);if(((i=c.isActionAvailable)==null?void 0:i.call(c,{key:l,action:u,event:t,actionName:u.split(".").pop()}))!==!1&&d.call(c,t)!==!1){n=!0;break}}else if(u.call(this)!==!1){n=!0;break}}delete t.fromKeyMap,n&&(o&&t.preventDefault(),t.handled=!0)}}return n}resolveKeyMapAction(t){const{keyMapSubComponents:i}=this;if(t.startsWith("up.")||t.startsWith("this."))return this.resolveCallback(t);if(i&&t.includes(".")){const[r,n]=t.split(".");if(r&&n)return{thisObj:i[r],handler:i[r][n]}}return{thisObj:this,handler:this[t]}}updateKeyMap(t){var i;(i=this.keyMapDetacher)==null||i.call(this),w.isEmpty(t)||(this.keyMapDetacher=B.on({element:this.keyMapElement,keydown:"keyMapOnKeyDown",thisObj:this}))}keyMapOnKeyDown(t){this.performKeyMapAction(t)}mergeKeyMaps(t,i,r=null){const n={};t&&w.assign(n,t);for(const l in i){if(!i[l])continue;const a=V.asArray(t==null?void 0:t[l]),o=[];if(a!=null&&a.length&&o.push(...a),!(a!=null&&a.some(u=>{const c=u.handler?u.handler:u;return typeof c=="string"&&c.startsWith(r+".")}))){for(const u of V.asArray(i[l]))w.isObject(u)&&u.handler?o.push(w.assignIf({handler:(r?r+".":"")+u.handler},u)):typeof u=="function"?o.push(u):o.push((r?r+".":"")+u);o.sort((u,c)=>{const d=(u.weight||0)-(c.weight||0);return d===0&&(a!=null&&a.length)?a.indexOf(u)-a.indexOf(c):d})}n[l]=o}return n}},x(e,"$name","KeyMap"),x(e,"configurable",{keyMap:{value:null,$config:{merge:"objects",nullify:!0}}}),e},ia=s=>{var e;return e=class extends(s||R){get widgetClass(){}get isRTL(){return this.rtl}updateRtl(t){const{element:i}=this;i&&(i.classList.toggle("b-rtl",t===!0),i.classList.toggle("b-ltr",t===!1))}startConfigure(t){var i,r;if((i=super.startConfigure)==null||i.call(this,arguments),!t.floating&&t.rtl==null){const n=this,l=t.rootElement||t.forElement||((r=n.parent)==null?void 0:r.contentElement)||(n.floating?n.floatRoot:n.changeElementRef(n.getRenderContext(t)[0]||t.adopt||document.body)),a=t.owner||t.parent||n.constructor.fromElement(l);a?t.rtl=a[a.isConfiguring?"peekConfig":"getConfig"]("rtl"):t.rtl=(l==null?void 0:l.nodeType)===1&&getComputedStyle(l).getPropertyValue("direction")==="rtl",t.rtl&&(n.configDone.rtl=!1)}}render(...t){var i,r;super.render&&super.render(...t),(j.isChrome&&j.chromeVersion<87||j.isFirefox&&j.firefoxVersion<66||j.isSafari&&j.safariVersion<14.1)&&this.element.classList.add("b-legacy-inset"),(getComputedStyle(this.element).direction==="rtl"||(i=this.owner)!=null&&i.rtl)&&(this.rtl=!0,(r=this.childItems)==null||r.forEach(n=>n.rtl=!0))}},x(e,"$name","RTL"),x(e,"configurable",{rtl:null}),e},ra=Object.freeze({highlight:!1,onlyName:!1}),Ei=[],Cs="highlightExternalChange",ws=/transparent|rgba\(0,\s*0,\s*0,\s*0\)/,dr=Symbol("renderConfigObserver"),Nc={INPUT:1,TEXTAREA:1},Ss=(s,e,t,i)=>{let r=(t==null?void 0:t.listeners)||(t==null?void 0:t.internalListeners);if(r=(r==null?void 0:r.on)||r,r){const n=B.on(w.assign({element:e,thisObj:s},r));i?(s._refListeners||(s._refListeners=Object.create(null)))[i]=n:t.listeners={on:r,un:n}}},sa=(s,e)=>s&&e&&e[w.keys(s)[0]]?ie.merge(s,e):s,Vc=s=>{s.isVisible&&s.triggerPaint()},zc=/^:not\((.+)\)$/,Bc=/absolute|fixed/i,jc=s=>s.scale!=null,{hasOwn:wt}=w,{defineProperty:na}=Reflect,la=s=>parseFloat(s)*(s.endsWith("ms")?1:1e3),aa=["b-aligned-above","b-aligned-right","b-aligned-below","b-aligned-left"],Hc={configurable:!0,get(){return!1}},fr=/(?:L\{([^}.]+)\})/,Wc=(s,e)=>"L{Tooltip."+e+"}",oa=/^([trblc])(\d*)-([trblc])(\d*)$/i,Uc=(s,e)=>(oa.test(s)&&(s={align:s}),oa.test(e)&&(e={align:e}),ie.merge(s,e)),qc=/^[\w.]+$/,ua={1:"maxHeight",2:"height",4:"maxWidth",8:"width"},Kc=s=>!s.isRipple&&!s.closest(e=>e.isMessageDialog||e.isSharedTooltip),N=class q extends R.mixin(ti,De,lt,di,Vt,ta,ia){static mergeCls(e,t){return t&&e?e=new Z(t).assign(typeof e=="string"?new Z(e):e):e&&!e.isDomClassList&&(e=new Z(e)),e}static get $name(){return"Widget"}static get type(){return"widget"}static get configurable(){return{element:!0,callOnFunctions:!0,id:"",html:null,content:null,cls:{$config:{merge:"classList"},value:null},ui:{$config:{merge:"classList"},value:null},collapsify:null,contentElementCls:{$config:{merge:"classList"},value:null},defaultCls:{$config:{merge:"classList"},value:null},dock:null,forwardTwinEvents:{$config:{merge:"classList"},value:null},parent:null,tab:null,elementAttributes:null,htmlCls:{$config:{merge:"classList"},value:{"b-html":1}},style:null,disabled:null,readOnly:{value:null,default:!1,$config:null},ignoreParentReadOnly:null,adopt:null,appendTo:null,insertBefore:null,insertFirst:null,dataset:null,tooltip:{$config:["lazy","nullify"],value:null},showTooltipWhenDisabled:!0,preventTooltipOnTouch:null,monitorResize:{$config:["lazy","nullify"],value:null},masked:{$config:"nullify",value:null},maskDefaults:{target:"element"},cache:{},floating:null,positioned:null,draggable:null,align:{$config:{merge:Uc},value:"t-b"},centered:null,constrainTo:void 0,anchor:null,owner:null,scrollAction:null,hideAnimation:{$config:{merge:sa},value:null},showAnimation:{$config:{merge:sa},value:null},x:null,y:null,scrollable:{$config:["lazy","nullify"],value:null},scrollerClass:vs,defaultBindProperty:"html",defaultAction:null,overflowable:{value:null,default:!0,$config:null},width:null,height:null,maxHeight:null,maxWidth:null,minWidth:null,minHeight:null,scaleToFitWidth:null,allowGrowWidth:!0,margin:null,flex:null,weight:null,alignSelf:null,ripple:null,title:null,localizableProperties:["title","ariaLabel","ariaDescription"],requireSize:!1,ref:null,hidden:null,textAlign:null,ignoreScrollDuration:500,tag:"div",recomposeAsync:null,rootElement:null,htmlMutationObserver:{$config:["lazy","nullify"],value:{childList:!0,subtree:!0}},role:{$config:"lazy",value:"presentation"},ariaLabel:{$config:"lazy",value:null},ariaDescription:{$config:"lazy",value:null},ariaElement:"element",ariaHasPopup:null,realignTimeout:300,testConfig:{ignoreScrollDuration:100,realignTimeout:50},maximizeOnMobile:null}}static get prototypeProperties(){return{hasGeneratedId:!1,innerItem:!0}}static get declarable(){return["renderConfigs"]}static get delayable(){return{recompose:"raf",doHideOrRealign:"raf",onAlignConstraintChange:"raf"}}static get factoryable(){return{defaultType:"widget"}}static get identifiable(){return{}}static get all(){return super.all}static get recomposeAsync(){return q._recomposeAsync}static set recomposeAsync(e){if(q._recomposeAsync=e,e!=null){const{all:t}=q;for(let i=0;i<t.length;++i)t[i].isComposable&&(t[i].recomposeAsync=e)}}isType(e,t){return q.isType(this,e,t)}static setupRenderConfigs(e,t){const i=t.getInherited("renderConfigs"),{renderConfigs:r}=e;if(r){if(Array.isArray(r))for(const n of r)i[n]=!0;else w.assign(i,r);i[dr]=null}}construct(e={},...t){const i=this,{domSyncCallback:r}=i;if(!globalThis.bryntum.cssVersion){const l=globalThis.bryntum.cssVersion=gs.getCSSVersion(),a=le.getVersion("core");l&&l!==a&&console.warn(`CSS version ${l} doesn't match bundle version ${a}!
Make sure you have imported css from the appropriate product version.`)}i.configureAriaDescription=e.ariaDescription,i._isAnimatingCounter=0,i.alignmentChanges=0,i.byRef=Object.create(null),i.onTargetResize=i.onTargetResize.bind(i),i.onFullscreenChange=i.onFullscreenChange.bind(i),i.domSyncCallback=r.$nullFn?null:r.bind(i),i._isUserAction=!1,super.construct(e,...t);const{recomposeAsync:n}=q;n!=null&&i.recomposeAsync==null&&(i.recomposeAsync=n),i.finalizeInit()}startConfigure(e){super.startConfigure(e);const t=this,{adopt:i,element:r}=t;i&&(t.adoptElement(r,i,e.id),t.updateElement(t._element,r))}finalizeInit(){var e;const t=this,i=t.insertBefore||t.appendTo||t.insertFirst||t.adopt;i&&(t.owner||(e=i.nodeType?i:document.getElementById(i))!=null&&e.isConnected?t.render():(t.onFirstResizeAfterConnect=t.onFirstResizeAfterConnect.bind(t),ce.addResizeListener(i,t.onFirstResizeAfterConnect)))}onFirstResizeAfterConnect(e){ce.removeResizeListener(e,this.onFirstResizeAfterConnect),!this.isDestroyed&&!this.rendered&&this.render()}doDestroy(){var e,t,i,r;const n=this,{preExistingElements:l,element:a,adopt:o,_refListeners:u,_rootElement:c,eventRoot:d}=n;if($e.element===a&&$e.exit(),u&&(Object.values(u,f=>f()),n._refListeners=null),a){const f=!n._tooltip&&c&&((e=q.Tooltip)==null?void 0:e.getSharedTooltip(c,d,!0));if((f==null?void 0:f.owner)===n&&(f.owner=null,f.hide()),n.onExitFullscreen(),n.clearTimeout(n.scrollListenerTimeout),n.clearTimeout(n.resizeListenerTimeout),n.removeTransientListeners(),n.floating||n.positioned?n.hide(!1):n.revertFocus(),ce.removeResizeListener(a.parentElement,n.onParentElementResize),ce.removeResizeListener(a,n.onElementResize),o){for(let g=Array.from(a.childNodes),h=0,{length:p}=g;h<p;h++){const m=g[h];!l.includes(m)&&m!==n.floatRoot&&m.remove()}a.className=n.adoptedElementClassName,a.style.cssText=n.adoptedElementCssText}(t=n.dragEventDetacher)==null||t.call(n),(i=n.dragOverEventDetacher)==null||i.call(n),n.dragGhost.remove()}(r=n.connectedObserver)==null||r.disconnect(),super.doDestroy(),d&&!Object.values(q.identifiable.idMap).some(Kc)&&be.detachFocusListeners(d),o||a.remove()}get assignValueDefaults(){return ra}get valueName(){return this.name||this.ref||this.id}getValueName(e){return e=e&&typeof e=="object"?e.onlyName:e,e?this.name:this.valueName}assignFieldValue(e,t,i){const r=this,n=r.defaultBindProperty;n in r&&(r[n]=i)}assignValue(e,t=ra){const i=this,r=i[Cs],n=i.getValueName(t);n&&(!e||n in e)&&(t.highlight===!1&&(i[Cs]=!1),i.assignFieldValue(e,n,e?e[n]:null),i[Cs]=r)}gatherValue(e){const t=this,i=t.defaultBindProperty;t.constructor!==q&&i in t&&(e[t.name||t.ref||t.id]=t[i])}gatherValues(e){this.eachWidget(t=>t.gatherValue(e),!1)}get forwardTwinEvents(){const e=this._forwardTwinEvents;return e&&w.getTruthyKeys(e)}configureOverflowTwin(e){var t;const i=this;let r=w.clone(i.initialConfig);return delete r.id,r.hidden=!1,r.type=i.type,r._overflowTwinOrigin=i,r.disabled=i.disabled,"value"in i&&(r.value=i.value),(t=i.forwardTwinEvents)==null||t.forEach(n=>{delete r[`on${k.capitalize(n)}`]}),e&&(r=typeof e=="function"?e(r)||r:w.assign(r,e)),r}createOverflowTwin(e){var t;const i=this,r=i.configureOverflowTwin(e),n=q.create(r);return(t=i.forwardTwinEvents)==null||t.forEach(l=>{n.ion({[l]:a=>{i.overflowTwin===a.source&&(a=w.assign({},a),delete a.source,i.trigger(a.eventName,a))}})}),n}ensureOverflowTwin(e,t){let{overflowTwin:i}=this;return i||(this.overflowTwin=i=this.createOverflowTwin(e),t==null||t(i)),i}get isComposable(){return!this.compose.$nullFn}adoptElement(e,t,i){var r;const n=this,l=typeof t=="string"?document.getElementById(t):t,a=q.fromElement(l);a&&a.adopt&&a!==n&&(typeof a.adopt=="string"?document.getElementById(a.adopt):a.adopt)===l&&a.destroy(),n.preExistingElements=Array.from(l.childNodes),n.adoptedElementClassName=l.className,n.adoptedElementCssText=l.style.cssText,l.id&&!i&&(n.id=e.id=l.id),v.syncAttributes(e,l);for(let c=0,{length:d}=e.childNodes;c<d;c++)l.appendChild(e.childNodes[0]);delete n._contentRange,n._element=l;const o=e.lastDomConfig,u=o==null?void 0:o.listeners;u&&n.isComposable&&((r=u.un)==null||r.call(u),Ss(n,l,o)),l.lastDomConfig=o||l.lastDomConfig,l.$refOwnerId=n.id,n.scaleToFitWidth||n.getConfig("monitorResize")}addRefAccessor(e,t){const{prototype:i}=this.constructor;na(i,t,{writable:!0,value:null}),na(i,e,{get(){return this.recompose.flush(),this[t]},set(r){this[t]=r}})}attachRef(e,t,i){const r=this,n="_"+e;t.dataset&&(t.dataset.ownerCmp=r.id),r.isComposable&&(n in r||r.addRefAccessor(e,n),Ss(r,t,i,e)),r.byRef[e]=t,r[e]=t}detachRef(e,t,i){const r=this,n=r._refListeners;n!=null&&n[e]&&(n[e](),delete n[e]),r[e]=null,delete r.byRef[e]}afterRecompose(){}compose(){return{class:Z.normalize(this.widgetClassList,"object")}}doCompose(){const e=this,{$meta:t}=e,i=t.hierarchy,r=t.renderConfigs||t.getInherited("renderConfigs");let{composers:n}=t,l=null,a,o,u,c;if(e.recompose.suspend(),!n){for(t.composers=n=[],u=i.indexOf(q);u<i.length;++u)c=i[u].prototype,wt(c,"compose")&&n.push(c);wt(r,dr)||(r[dr]={get(d){r[d]=!0}})}for(e.configObserver=r[dr],u=0;u<n.length;++u)a=n[u].compose.call(e,l),l=l?v.merge(l,a):a;return wt(e,"compose")&&(a=e.compose)&&(a=a.call(e,l),v.merge(l,a)),e.configObserver=null,v.normalizeChildren(l,(d,f)=>{f&&(o="_"+d,o in e||e.addRefAccessor(d,o))})}get element(){return this.isComposable&&!this.isDestroying&&this.recompose.flush(),this._element}domSyncCallback(e){}changeElement(e){const t=this,i=t.isComposable;return i&&(e=t.doCompose()),typeof e=="string"?e=v.createElementFromTemplate(e):w.isObject(e)?(e=v.createElement(e,{refOwner:t,callback:t.domSyncCallback}),t.recompose.resume(),i&&Ss(t,e,e.lastDomConfig)):v.isReactElement(t.peekConfig("html"))?e=document.createElement("div"):e.nodeType!==1&&(e=v.createElementFromTemplate(t.template(t))),e.id=t.id,t.elementAttributes&&v.setAttributes(e,t.elementAttributes),e}updateElement(e){const t=this,{className:i}=e,{contentElement:r,contentElementCls:n,isComposable:l}=t,a=r!==e,o=!l&&e.querySelectorAll("[data-reference]"),u=l?[]:t.widgetClassList;let c=(a||!l)&&t.uiClasses;if(i&&u.unshift(i),t._hidden&&u.push("b-hidden"),t._readOnly&&u.push("b-readonly"),re.noThrow(e,"remove"),c?(n!=null&&n.value&&(c=c.slice(),c.push(n.value)),c=c.join(" ")):c=n==null?void 0:n.value,c&&(a?r.className+=" "+c:u.push(c)),!t.parent){const{defaultCls:d}=t,{outerCls:f}=q;u.push(...d?f.filter(g=>!(g in d)||d[g]):f)}if(e.className=u.join(" "),o)for(let d,f=0;f<o.length;++f)d=o[f],t.attachRef(d.getAttribute("data-reference"),d),d.removeAttribute("data-reference");!t.adopt&&!t.scaleToFitWidth&&t.getConfig("monitorResize"),t.getConfig("role"),t.getConfig("ariaLabel"),t.getConfig("ariaDescription"),t._html&&t.getConfig("htmlMutationObserver"),t.trigger("elementCreated",{element:e})}updateAriaDescription(e){const{ariaElement:t}=this,i=`${this.id}-aria-desc-el`;if(e){const r=this._ariaDescEl||(this._ariaDescEl=v.createElement({className:"b-aria-desc-element",id:i,parent:t}));r.innerText=e.match(fr)?this.L(e,this):e,t.setAttribute("aria-describedBy",r.id)}else t.getAttribute("aria-describedby")===i&&t.removeAttribute("aria-describedBy")}updateAriaLabel(e){v.setAttributes(this.ariaElement,{"aria-label":e!=null&&e.match(fr)?this.L(e,this):e})}updateAriaHasPopup(e){v.setAttributes(this.ariaElement,{"aria-haspopup":e})}updateRole(e){var t,i;e?(t=this.ariaElement)==null||t.setAttribute("role",e):(i=this.ariaElement)==null||i.removeAttribute("role")}get ariaElement(){this.getConfig("element");const{_ariaElement:e}=this;return e.nodeType===Node.ELEMENT_NODE?e:w.getPath(this,e)}isCollapsified({collapsed:e,alt:t}){const{collapsify:i}=this,r=i==="hide",n=i===!1,l=i==null;return t?i==="overlay"||l&&e:n||r||l&&!e}async recompose(){const e=this,t={targetElement:e.element,domConfig:e.doCompose(),refOwner:e,callback:e.domSyncCallback,strict:!0};if(e.transitionRecompose){if(e.isTransitioningDom=!0,await v.transition(w.assign({element:e.element,action(){bt.sync(t)}},e.transitionRecompose)),e.isDestroyed)return;e.isTransitioningDom=!1,e.trigger("transitionedRecompose")}else bt.sync(t);t.changed&&(e.afterRecompose(),e.trigger("recompose")),e.resumeRecompose()}resumeRecompose(){this.recompose.resume()}changeElementRef(e){if(typeof e=="string"){const t=e;if(!(e=document.getElementById(t)))throw new Error(`No element found with id '${t}'`)}return e}changeAppendTo(e){return this.changeElementRef(e)}updateAppendTo(e){!this.isConfiguring&&e&&this.render()}changeInsertBefore(e){return this.changeElementRef(e)}updateInsertBefore(e){!this.isConfiguring&&e&&this.render()}changeInsertFirst(e){return this.changeElementRef(e)}updateInsertFirst(e){!this.isConfiguring&&e&&this.render()}getRenderContext(e=this,t){let i=t||e.appendTo,{insertFirst:r,insertBefore:n}=e;return r&&(i=r,n=i.firstChild),n&&(i||(i=n.parentElement)),[i,n||void 0]}render(e,t=!0){const i=this,{element:r}=i,[n,l]=i.getRenderContext(i,e);i.emptyCache(),i.syncElement&&i.currentElement?v.sync(r,i.currentElement):(n==null||n.insertBefore(r,l),i.currentElement=r),q.fromElement(r.parentElement)&&r.classList.remove(...q.outerCls),super.render(n,t),i.rendered=!0,i.getConfig("role"),t&&(i.getConfig("contentRange"),i.triggerPaint()),i.setupFocusListeners()}template({tag:e,html:t,htmlCls:i,name:r}){const n=this;typeof t=="string"&&qc.test(t)&&n.resolveCallback(t,n,!1)&&(t=n.callback(t,n,[n]));const l=t!=null&&t.call?t.call(n,n):t;return`<${e} class="${l?i:""}" ${r?`data-name="${r}"`:""}>${l||""}</${e}>`}updateRecomposeAsync(e){this.recompose.immediate=!e}onConfigChange({name:e}){var t;this._element&&!this.isDestroying&&((t=this.$meta.renderConfigs)!=null&&t[e])&&this.recompose()}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.parent}getConfigValue(e,t){return e==="style"?this._style:super.getConfigValue(e,t)}getCurrentConfig(e){const t=super.getCurrentConfig(e);return(e==null?void 0:e.depth)>0&&(t.type=this.type),t}get dataset(){return this.element.dataset}changeDataset(e){w.assign(this.dataset,e)}get dragGhost(){return this.constructor._dragGhost||(this.constructor._dragGhost=v.createElement({html:"\xA0",style:"position:absolute;top:-10000em;left:-10000em"}))}updateParent(e){const{_element:t}=this;t&&t.classList[e?"remove":"add"](...q.outerCls)}get constrainTo(){let e=this._constrainTo;if(e=e===void 0?globalThis:(e==null?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE?e.host||e.ownerDocument:e,this.positioned){const{offsetParent:t}=this.element;if(t&&v.getStyleValue(t,"overflow")==="hidden")e=K.from(t).moveTo(0,0);else if(e&&!e.isRectangle){const i=e===document||e===globalThis;e=K.from(e,t),i&&e.translate(globalThis.pageXOffset,globalThis.pageYOffset)}}return e}updateCentered(e){const{element:t,_anchorElement:i}=this;if(e&&!this.floating&&!this.positioned)throw new Error("`centered` is only relevant when a Widget is `floating` or `positioned`");e?(t.classList.add("b-centered"),t.style.transform=t.style.left=t.style.top="",i==null||i.classList.add("b-hide-display"),t.classList.remove("b-anchored")):t.classList.remove("b-centered")}get contentElement(){return this.element}get contentRange(){const e=this,{contentElement:t}=e,i=e._contentRange||(e._contentRange=new Range);return i.collapsed&&(i.setStart(t,e.contentRangeStartOffset||0),i.setEnd(t,e.contentRangeEndOffset||t.childNodes.length)),i}fixRefOwnerId(e,t,i){if(e.$refOwnerId===i){e.$refOwnerId=t;for(let{childNodes:r}=e,n=r.length;n-- >0;)this.fixRefOwnerId(r[n],t,i)}}get placement(){var e;const t=this,{element:i}=t;let r,n,l;if(i!=null&&i.offsetParent&&!Bc.test(v.getStyleValue(i,"position"))){const a=i.nextElementSibling,o=i.previousElementSibling,u=!a&&o;n=v.getStyleValue(i.parentElement,"flex-direction"),n?n=n.startsWith("row")?"h":"v":(r=(e=a||o)==null?void 0:e.getBoundingClientRect(),l=r&&i.getBoundingClientRect(),n=r&&Math.abs(r.top-l.top)<Math.abs(r.left-l.left)?"h":"v"),n+=n==="h"?u?"r":"l":u?"b":"t"}return n}updateId(e,t){if(super.updateId(e,t),t){const{byRef:i,element:r}=this;for(const n in i)i[n].dataset&&(i[n].dataset.ownerCmp=e);r.id=e,this.fixRefOwnerId(r,e,t)}}get style(){const{element:e}=this;return(e==null?void 0:e.ownerDocument.defaultView.getComputedStyle(e))||this._style}updateStyle(e){this.element&&v.applyStyle(this.element,e)}updateTitle(e){this.titleElement&&(this.titleElement.innerHTML=e)}beforeAlignTo(e){}alignTo(e){var t;const i=this,{lastAlignSpec:r,element:n}=i,{offsetParent:l,style:a,classList:o}=n;if(r&&(r.monitorIntersection&&i.intersectionObserver.unobserve(r.target),isFinite(r.zone)&&n.classList.remove(aa[r.zone])),!e){i.removeTransientListeners(),i.anchor=i.lastAlignSpec=null;return}i.beforeAlignTo(e),(e.nodeType===Element.ELEMENT_NODE||e.isWidget||e.$$name==="Point")&&(e={target:e}),i.releaseSizeConstraints();const{scrollable:u,constrainTo:c}=i,d=v.measureSize(v.getStyleValue(n,"minHeight"),n),f=v.measureSize(v.getStyleValue(n,"minWidth"),n),g=i.positioned&&v.getStyleValue(n,"position")!=="fixed",h=i.scale||1,p=e.target,m=e.domEvent||e.event||p,y=p!=null&&p.isRectangle?p:(p==null?void 0:p.element)||p,b=(y==null?void 0:y.nodeType)===Element.ELEMENT_NODE,S=((t=m==null?void 0:m.target)==null?void 0:t.nodeType)===Element.ELEMENT_NODE;e=e.realignTarget?e:w.assign({aligningToEvent:S,aligningToElement:b,constrainTo:c,align:"b-t",axisLock:i.axisLock,anchor:i.anchor},i.align,e);const C=e.minWidth||f,T=e.minHeight||d;if(i.lastAlignSpec=e,S)delete e.target,e.domEvent=m,e.anchoredTo=m.target,e.position=new nt(m.clientX+1,m.clientY+1);else if(b&&(e.target=y,rt(y instanceof SVGElement?y.closest("svg"):y))){if(e=Object.setPrototypeOf({},e),e.target=i.lastAlignSpec.targetRect=e.realignTarget||(e.allowTargetOut?K.from(y,g?l:null,!g):v.isInView(y,!1,i)),!e.target){const A=i.hide();return i.isDestroyed||(i.lastAlignSpec.targetOutOfView=!0),A}e.target.height=Math.max(e.target.height,1),e.target.width=Math.max(e.target.width,1),i.lastAlignSpec.anchoredTo=y}e.anchor&&(e.anchorSize=i.anchorSize,n.contains(i.anchorPathElement)||n.appendChild(i.anchorElement)),i.isAligning=!0,i.trigger("beforeAlign",e);const _=K.from(n,g?l:null,!0),{width:L,height:F}=_;_.isAlignRectangle=!0,C&&(_.minWidth=C*h),T&&(_.minHeight=T*h),i.isAligning=!1,e.rtl=i.rtl,(e.align.includes("s")||e.align.includes("e"))&&(i.rtl?e.align=e.align.replace(/s/g,"r").replace(/e/g,"l"):e.align=e.align.replace(/s/g,"l").replace(/e/g,"r"));const O=i.lastAlignSpec.result=_.alignTo(e);let{align:M,anchor:P,x:W,y:H,width:I,height:Y,overlap:G}=O;if(i.lastAlignSpec.zone=O.zone,Y!=F){const A=Y<F;i.alignmentChanges=i.alignmentChanges|(A?1:2),a[i.alignedHeightStyle=ua[i.alignmentChanges&3]]=`${Y/h}px`,A&&!i._minHeight&&d&&(a.minHeight=`${Math.min(Y,d)/h}px`),u&&(u.overflowY=A)}if(I!=L){const A=I<L;i.alignmentChanges=i.alignmentChanges|(A?4:8),a[i.alignedWidthStyle=ua[i.alignmentChanges&12]]=`${I/h}px`,A&&!i._minWidth&&f&&(a.minWidth=`${Math.min(I,f)/h}px`),u&&(u.overflowX=A)}if(M&&i.alignmentChanges){const A=K.from(n,g?l:null,!0);e.align=M;const X=i.lastAlignSpec.result=A.alignTo(e);P=X.anchor,W=X.x,H=X.y,I=X.width,Y=X.height}if(i.centered||i.setXY(W,H),!O.overlap&&isFinite(O.zone)&&o.add(aa[O.zone]),P!=null&&P.edge){const{edge:A}=P,{anchorElement:X}=i,{style:U}=X,te=K.from(n),de=[];A==="top"||A==="bottom"?(de[0]=P.x,de[1]=A==="top"?1:te.height-1):(de[0]=A==="left"?1:te.width-1,de[1]=P.y),U.display="none";let fe=v.childFromPoint(n,...de);if((fe!=null&&fe.matches(":focus")||fe===be.currentOverElement)&&n.compareDocumentPosition(fe)&Node.DOCUMENT_POSITION_CONTAINED_BY&&(fe=fe.parentNode),fe&&fe!==document){let Ze=v.getStyleValue(fe,"background-color");for(;Ze.match(ws)&&v.getStyleValue(fe,"position")!=="absolute"&&(fe=fe.parentNode,fe!==document);)Ze=v.getStyleValue(fe,"background-color");Ze.match(ws)?i.anchorPathElement.setAttribute("fill",i.defaultAnchorBackgroundColor):i.anchorPathElement.setAttribute("fill",Ze)}U.transform=U.display="",X.className=`b-anchor b-anchor-${A}`,P.x&&(P.x/=h),P.y&&(P.y/=h),v.setTranslateXY(X,P.x,P.y),o.add("b-anchored")}else i._anchorElement&&(i.anchorElement.classList.add("b-hide-display"),o.remove("b-anchored"));if(!b){a.pointerEvents="none";const A=v.elementFromPoint(W,H);i.owns(A)||(i.lastAlignSpec.anchoredTo=A),a.pointerEvents=""}if((i.scrollAction==="realign"&&b||i.scrollAction==="hide")&&!i.documentScrollListener&&(i.clearTimeout(i.scrollListenerTimeout),e.monitorTargetMutation&&!i.targetObserver&&(i.targetObserver||(i.targetObserver=new MutationObserver(i.onTargetParentMutation.bind(i)))).observe(v.getRootElement(y),{childList:!0,attributes:!0,subtree:!0}),i.scrollListenerTimeout=i.setTimeout(()=>{var A,X;const U=(X=(A=b?y:i.lastAlignSpec.anchoredTo).getRootNode)==null?void 0:X.call(A);i.documentScrollListener=B.addListener(document,"scroll","doHideOrRealign",{capture:!0,thisObj:i}),U!=null&&U.mode&&(i.targetRootScrollListener=B.addListener(U,"scroll","doHideOrRealign",{capture:!0,thisObj:i}))},i.scrollAction==="hide"?i.ignoreScrollDuration:0)),b&&(e.monitorResize&&!i.targetResizeListener&&(ce.addResizeListener(y,i.onTargetResize),i.targetResizeListener=!0),e.monitorIntersection&&!(G||y.contains(n)||y.ownerSVGElement)&&i.intersectionObserver.observe(y)),!j.isAndroid&&!i.constrainListeners){const A=c!=null&&c.isRectangle?globalThis:c;i.clearTimeout(i.resizeListenerTimeout),i.resizeListenerTimeout=i.setTimeout(()=>{i.constrainListeners=!0,ce.addResizeListener(A||globalThis,i.onAlignConstraintChange)},i.ignoreScrollDuration)}}onTargetParentMutation(e){var t;const{element:i,lastAlignSpec:r}=this;r!=null&&r.aligningToElement&&((t=r.target)!=null&&t.isConnected?e.some(({target:n})=>n.contains(r.target)&&!i.contains(n))&&this.realign():this.hide())}get intersectionObserver(){return this._intersectionObserver||(this._intersectionObserver=new IntersectionObserver(this.onTargetIntersectionchange.bind(this),{root:j.isSafari?this.rootElement:this.rootElement.ownerDocument}))}onTargetIntersectionchange(e){if(!this.isDestroyed){const t=e[e.length-1];t.isIntersecting||this.onAlignTargetOutOfView(t.target)}}onTargetResize(){const{lastAlignSpec:e}=this;if(e){const{width:t,height:i}=e.targetRect,{width:r,height:n}=e.target.getBoundingClientRect();(r!==t||n!==i)&&this.onAlignConstraintChange(...arguments)}}onAlignTargetOutOfView(e){this.hide(),this.lastAlignSpec&&(this.lastAlignSpec.targetOutOfView=!0)}onAlignConstraintChange(e,t,{height:i}){const{style:r}=this.contentElement,{overflowY:n}=r;this.setTimeout(this.realign,50),t&&i>t.height&&(r.overflowY="hidden",this.requestAnimationFrame(()=>r.overflowY=n))}realign(){const e=this,{lastAlignSpec:t}=e;if((e.floating||e.positioned)&&t&&e.isVisible){if(t.aligningToElement){const i=t.target.contains(this.element),r=v.isInView(t.target,!1,e);if(!t.allowTargetOut&&(!rt(t.target)||!r)){e.hide(),e.isDestroyed||(e.lastAlignSpec.targetOutOfView=!0);return}t.realignTarget=i?null:r}v.addTemporaryClass(e.element,"b-realigning",e.realignTimeout,e),e.alignTo(t)}}rectangle(e,t,i){return this.rectangleOf("element",e,t,i)}rectangleOf(e,t,i,r){return typeof t!="string"?(r=i,i=t,t=""):t==="border"&&(t=""),typeof i=="boolean"&&(r=i,i=void 0),e!=="element"&&i===void 0&&(i=this.element),i=i!=null&&i.isWidget?i.element:i,K[t||"from"](this[e],i,r)}releaseSizeConstraints(){const e=this,{scrollable:t,element:i,alignmentChanges:r}=e,{style:n}=i;r&12&&(v.setLength(i,e.alignedWidthStyle,e[`_last${k.capitalize(e.alignedWidthStyle)}`]||""),n.minWidth=e._minWidth||"",t&&(t.overflowY=t.config.overflowY)),r&3&&(v.setLength(i,e.alignedHeightStyle,e[`_last${k.capitalize(e.alignedHeightStyle)}`]||""),n.minHeight=e._minHeight||"",t&&(t.overflowX=t.config.overflowX)),e.alignmentChanges=0}toFront(){const{element:e}=this,t=this.floating?this.floatRoot:this.positioned?e==null?void 0:e.parentNode:null,i=document.createDocumentFragment();if(this.containsFocus){for(let r=e.nextSibling,n;r;r=n)n=r.nextSibling,t.contains(r)&&!this.owns(r)&&i.appendChild(r);t.insertBefore(i,e)}else t.appendChild(e)}updateRef(e){this.element.dataset.ref=e}get overflowElement(){return this.contentElement}get maxHeightElement(){return this.element}changeAlign(e){return typeof e=="string"?{align:e}:e}changeScrollable(e,t){return typeof e=="boolean"&&(e={overflowX:e,overflowY:e}),e?(e.element=this.overflowElement,e.widget=this,e.isScroller||(e=t?t.setConfig(e):new this.scrollerClass(e)),e.syncOverflowState()):t==null||t.destroy(),e}handleReactElement(e){const t=this.closest(i=>i.reactComponent);t!=null&&t.reactComponent&&t.reactComponent.processWidgetContent({reactElement:e,widget:this,reactComponent:t.reactComponent})}get html(){return this.initializingElement||!this.element?this.content||this._html:this.contentElement.innerHTML}updateHtml(e){const t=this,i=e==null,{element:r,contentElement:n,htmlCls:l}=t;if(!r&&v.isReactElement(e)){t.whenVisible(()=>t.handleReactElement(e));return}if(r){t.updatingHtml=!0;const a=n===r&&t._anchorElement;l&&l.values.forEach(o=>r.classList[i?"remove":"add"](o)),a&&r.removeChild(a),e&&typeof e=="object"?v.isReactElement(e)?t.handleReactElement(e):bt.sync({domConfig:{...e,onlyChildren:!0},targetElement:t.contentElement}):t.contentElement.innerHTML=i?"":e,t.getConfig("htmlMutationObserver"),a&&r.appendChild(a),t.isComposable?t.recompose():(t.floating||t.positioned)&&(t.isAligning||t.realign())}}changeHtmlMutationObserver(e,t){const i=this,{contentElement:r}=i;if(t==null||t.disconnect(),e){const n=new MutationObserver(()=>{i.updatingHtml?i.updatingHtml=!1:i._html=r.innerHTML});return n.observe(r,e),n}}updateContent(e){const t=this,i=e==null,{element:r,htmlCls:n}=t;if(r){const{contentRange:l}=t;n&&n.values.forEach(a=>r.classList[i?"remove":"add"](a)),r.isConnected?(l.deleteContents(),i||l.insertNode(v.createElementFromTemplate(e,{fragment:!0}))):t.contentElement.innerHTML=e,t.contentRangeStartOffset=l.startOffset,t.contentRangeEndOffset=l.endOffset,(t.floating||t.positioned)&&!t.isAligning&&t.realign()}}onThemeChange(){var e;(e=this.anchorElement)!=null&&e.offsetParent&&(this._anchorSize=null,this.realign())}get anchorSize(){const e=this;let t=this._anchorSize;if(!t){const i=parseFloat(v.getStyleValue(e.element,"border-top-width")),r=v.getStyleValue(e.element,"border-top-color"),n=e.anchorElement,{className:l}=n,a=n.firstElementChild,o=e.anchorPathElement=a.lastElementChild,u=e._hidden;n.className="b-anchor b-anchor-top";let c=v.getStyleValue(e.contentElement,"background-color");c.match(ws)&&(c=v.getStyleValue(e.element,"background-color")),e.defaultAnchorBackgroundColor=c,t=n.getBoundingClientRect();const[d,f]=t=e._anchorSize=[t.width,t.height];n.className=l,a.setAttribute("height",f+i),a.setAttribute("width",d),o.setAttribute("d",`M0,${f}L${d/2},0.5L${d},${f}`),i&&(o.setAttribute("stroke-width",i),o.setAttribute("stroke",r)),t[1]-=i,u&&e.element.classList.add("b-hidden"),e.themeChangeListener||(e.themeChangeListener=be.ion({theme:"onThemeChange",thisObj:e})),e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}return t}get anchorElement(){const e=this;if(!e._anchorElement){const t=e.floating,i=`${e.id}-shadow-filter`;e._anchorElement=v.createElement({parent:e.element,className:"b-anchor b-anchor-top",children:[{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",class:"b-pointer-el",children:[t?{tag:"defs",children:[{tag:"filter",id:i,children:[{tag:"feDropShadow",dx:0,dy:-1,stdDeviation:1,"flood-opacity":.2}]}]}:null,{tag:"path",[t?"filter":""]:`url(#${i})`}]}]})}return e._anchorElement}updateAnchor(e){this._anchorElement&&this._anchorElement.classList[e?"remove":"add"]("b-hide-display")}updateDraggable(e){var t,i,r;const n=this,{element:l}=n;e?(n.dragEventDetacher=B.addListener({element:l,dragstart:"onWidgetDragStart",dragend:"onWidgetDragEnd",thisObj:n}),n.dragDetacher=B.on({element:l,mousedown(a){const{target:o}=a,u=q.fromElement(o);(!a.target.closest(".b-field-inner")&&u===this||this.strips&&Object.values(this.strips).includes(u))&&l.setAttribute("draggable","true")},thisObj:n})):((t=n.dragEventDetacher)==null||t.call(n),(i=n.dragOverEventDetacher)==null||i.call(n),(r=n.dragDetacher)==null||r.call(n))}onWidgetDragStart(e){var t;const i=this;if(!i.validateDragStartEvent(e))return;const{element:r,align:n,constrainTo:l}=i,a=i.positioned&&v.getStyleValue(r,"position")!=="fixed",o=a?r.parentElement:i.rootElement,u=K.from(r,a?o:null),c=e.clientX,d=e.clientY,f=document.scrollingElement||document.body,[g,h]=a?v.getOffsetXY(r,o):i.getXY(),p=(t=a?K.content(o).moveTo(0,0):l&&(l!=null&&l.isRectangle?l:K.from(l)))==null?void 0:t.deflate(n.constrainPadding||0),m={element:o,dragover:y=>{r.classList.remove("b-centered"),u.moveTo(g+y.clientX-c-(a?0:f.scrollLeft),h+y.clientY-d-(a?0:f.scrollTop)),p&&u.constrainTo(p),v.setTranslateXY(r,u.x,u.y)}};j.isTouchDevice&&(m.touchmove=y=>y.preventDefault()),i.floatRoot.appendChild(i.dragGhost),i.setDragImage(e),e.dataTransfer.effectAllowed="none",i.dragOverEventDetacher=B.addListener(m),i.alignTo()}validateDragStartEvent(e){var t;const i=this,{element:r}=i,n=v.elementFromPoint(e.clientX,e.clientY),{handleSelector:l}=i.draggable;if(l){const a=(t=zc.exec(l))==null?void 0:t[1];if(a){if(n.closest(`#${r.id} ${a}`))return e.preventDefault(),!1}else if(!n.closest(`#${r.id} ${l}`))return e.preventDefault(),!1}return!0}setDragImage(e){e.dataTransfer.setDragImage&&(e.dataTransfer.setData("application/node type",""),e.dataTransfer.setDragImage(this.dragGhost,-9999,-9999))}setStyle(e,t){return v.applyStyle(this.element,w.isObject(e)?e:{[e]:t}),this}onWidgetDragEnd(){this.dragGhost.remove(),this.dragOverEventDetacher(),this.element.removeAttribute("draggable")}changeFloating(e){return!!e}changePositioned(e){return!!e}updatePositioned(e){this.element.classList[e?"add":"remove"]("b-positioned")}getXY(){return[v.getPageX(this.element),v.getPageY(this.element)]}setXY(e,t){const i=this,{element:r}=i;if(i.floating||i.positioned){if(e!=null&&(i._x=e),t!=null&&(i._y=t),v.getStyleValue(r,"position")==="fixed"){const n=r.getBoundingClientRect(),[l,a]=v.getTranslateXY(r),o=e-n.x,u=t-n.y;v.setTranslateXY(r,l+o,a+u)}else v.setTranslateXY(r,i._x||0,i._y||0);i.isConstructing?i.centered=!1:r.classList.remove("b-centered")}}get x(){return this.getXY()[0]}changeX(e){this.setXY(e)}get y(){return this.getXY()[1]}changeY(e){this.setXY(null,e)}get width(){const e=this,t=e.element;return e.monitorResize?(e._width==null&&(e._width=t.offsetWidth),e._width):t.offsetWidth}changeWidth(e){const t=this;v.setLength(t.element,"width",e),t._lastWidth=e,t._oldWidth=t._width,t._width=null,t._flex=null,t.element.style.flex=""}clearWidthCache(){this._width=null}get maxWidth(){return v.measureSize(this.element.style.maxWidth,this.element)}updateMaxWidth(e){this._lastMaxWidth=e,v.setLength(this.element,"maxWidth",e)}get minWidth(){return v.measureSize(this.element.style.minWidth,this.element)}updateMinWidth(e){v.setLength(this.element,"minWidth",e)}updateFlex(e){this.getConfig("width"),(typeof e=="number"||!isNaN(e))&&(e=`${e} ${e}`),this.element.style.flex=e,this.element.style.width=""}updateAlignSelf(e){this.element.style.alignSelf=e}updateMargin(e){this.element.style.margin=this.parseTRBL(e).join(" ")}updateTextAlign(e,t){t&&this.element.classList.remove(`b-text-align-${t}`),this.element.classList.add(`b-text-align-${e}`)}updatePlaceholder(e){this.input&&(e==null?this.input.removeAttribute("placeholder"):this.input.placeholder=e)}get height(){const e=this,t=e.element;return e.monitorResize?(e._height==null&&(e._height=t.offsetHeight),e._height):t.offsetHeight}changeHeight(e){v.setLength(this.element,"height",e),this._lastHeight=e,this._height=null}get maxHeight(){return v.measureSize(this.maxHeightElement.style.maxHeight,this.element)}updateMaxHeight(e){this._lastMaxHeight=e,v.setLength(this.maxHeightElement,"maxHeight",e)}get minHeight(){return v.measureSize(this.element.style.minHeight,this.element)}updateMinHeight(e){v.setLength(this.element,"minHeight",e)}updateDisabled(e=!1){const{element:t,focusElement:i,ariaElement:r}=this;this.trigger("beforeUpdateDisabled",{disabled:e}),!(e&&(this.revertFocus(),this._disabled!==e))&&(t&&(t.classList[e?"add":"remove"]("b-disabled"),i&&(i.disabled=e),r&&r.setAttribute("aria-disabled",e)),this.onDisabled(e))}onDisabled(e){}disable(){this.disabled=!0}enable(){this.disabled=!1}requestFullscreen(){const e=this,t=$e.request(e.floating?e.floatRoot:e.element);return $e.onFullscreenChange(e.onFullscreenChange),e.element.classList.add("b-fullscreen"),t}exitFullscreen(){return $e.exit()}onFullscreenChange(){$e.isFullscreen||this.onExitFullscreen()}onExitFullscreen(){$e.unFullscreenChange(this.onFullscreenChange),this.element.classList.remove("b-fullscreen")}get tooltip(){var e;const t=this;if(t._tooltip)return t._tooltip;{const i=(e=q.Tooltip)==null?void 0:e.getSharedTooltip(t.rootElement,t.eventRoot);if(i&&i.activeTarget===t._element&&i.isVisible)return i}}changeTooltip(e,t){var i;const r=this,{element:n}=r;if(e){if(!(r.preventTooltipOnTouch&&j.isTouchDevice))if(!e.isTooltip&&e.constructor.name!=="Object"&&(e={html:typeof e=="string"?e:r.placeholder,textContent:!0}),r.configureAriaDescription||(r.ariaDescription=(i=e.html)!=null&&i.match(fr)?e.html.replace(fr,Wc):e.html),t!=null&&t.isTooltip||e.newInstance)e.type="tooltip",e.forElement||(e.forElement=n),!("showOnHover"in e)&&!e.forSelector&&(e.showOnHover=!0),"autoClose"in e||(e.autoClose=!0),e=q.reconfigure(t,e,r),r.detachListeners("tooltipValueListener"),r.configureAriaDescription||e.ion({name:"tooltipValueListener",innerHtmlUpdate:"onTooltipValueChange",thisObj:r});else{n.dataset.btip=!0,r.tipConfig=e;return}}else if(t)if(e==null&&t.isTooltip)t.destroy();else{t.html=null;return}else delete n.dataset.btip;return e}onTooltipValueChange({value:e,source:t}){this.ariaDescription=typeof e=="string"?e:t.contentElement.innerText}get tooltipText(){const e=this._tooltip;if(e)return e.isTooltip?e.contentElement.innerText:typeof e=="string"?e:e.html;if(this.tipConfig)return this.tipConfig.html}get isVisible(){const e=this,{element:t}=e;let i;return!!(t&&!e._hidden&&!e.isDestroying&&t.isConnected&&(!e.requireSize||rt(t))&&(!(i=e.containingWidget)||i.isVisible))}whenVisible(e,t=this,i,r=e.toString()){var n;const l=this;l.isVisible&&l.isPainted?((n=l.toCallWhenVisible)==null||n.delete(r),l.callback(e,t,i)):(l.toCallWhenVisible||(l.toCallWhenVisible=new Map)).set(r,{callback:e,thisObj:t,args:i})}focus(){this.isFocusable&&v.focusWithoutScrolling(this.focusElement)}get focusElement(){}get isFocusable(){const e=!this.isDestroying&&this.isVisible&&!this.disabled&&this.focusElement;return e&&(e===document.body||e.offsetParent)}async show({align:e,animate:t=!0}={}){const i=this,{element:r,floating:n}=i,{style:l}=r,a=t&&i.showAnimation;let o,u,c=!i.isVisible;return c&&(c=i.trigger("beforeShow"),w.isPromise(c)&&(c=await c)),c!==!1&&(!i.internalBeforeShow||i.internalBeforeShow()!==!1)?new Promise(d=>{if(i.cancelHideShowAnimation(),i.updateCentered(i._centered),n){const f=i.floatRoot;f.contains(r)||(i.rendered?f.appendChild(i.element):i.render(f,!1)),l.transform.includes("scale")&&(i.scale=null,l.transform=l.transformOrigin="");const g=i.closest(jc);if(g){const{scale:h}=g;i.scale=h,l.transform=`scale(${h})`,l.transformOrigin="0 0"}}if(i._hidden=!1,r.classList.remove("b-hidden"),n&&!Qr(r)&&(i.hide(!1),d()),i.onConfigChange({name:"hidden",value:!1,was:!0,config:i.$meta.configs.hidden}),a){o=Object.keys(a)[0],u=a[o];const f=i.currentAnimation={showing:!0,styleProp:o,resolve:d};i.isAnimating=!0,l.transition="none",l[o]=u.from,v.getStyleValue(r,o),i.currentAnimation.detacher=B.onTransitionEnd({element:r,property:o,duration:la(u.duration)+20,handler:()=>i.afterHideShowAnimate(f),thisObj:i}),l.transition=`${o} ${u.duration} ease ${u.delay}`,l[o]=u.to}i.afterShow(e,a?null:d)}):Promise.resolve()}async showBy(e,t,i){const r=this,n=Array.isArray(e);if(n||typeof e=="number"){const l=n?e:[e,t];e=Object.assign({target:new nt(l[0]+1,l[1]+1),matchSize:!1,align:"t0-b0"},n?t:i)}if(r.requireSize=!0,r.isVisible)v.addTemporaryClass(r.element,"b-realigning",300,r),r.alignTo(e);else return r.show({align:e})}async showByPoint(){return le.deprecate("Core","6.0.0","Widget.showByPoint() replaced by Widget.showBy() with the same signature"),this.showBy(...arguments)}afterShow(e,t){var i,r;const n=this;n.trigger("show"),n._configuredAnchorState=n.anchor,(r=(i=n.owner)==null?void 0:i.onChildShow)==null||r.call(i,n),n.triggerPaint(),(n.floating||n.positioned)&&(e?n.alignTo(e):n.centered?n.alignTo({target:n.constrainTo,align:"c-c"}):n.forElement&&n.alignTo(n.forElement)),t==null||t()}onChildHide(e){e.floating&&this.ariaElement.removeAttribute("aria-owns")}onChildShow(e){e.floating&&(this.ariaHasPopup=e.role,this.ariaElement.setAttribute("aria-owns",e.id))}triggerPaint(){const e=this,{element:t,toCallWhenVisible:i}=e,r=!e.isPainted;if(e.isVisible){if(r&&(e.getConfig("scrollable"),e.scaleToFitWidth&&!e.monitorResize&&(e.onParentElementResize=e.onParentElementResize.bind(e),ce.addResizeListener(t.parentElement,e.onParentElementResize),e.updateScale()),!e.hideBryntumDomMessage&&(e.isTaskBoardBase||e.isGridBase||e.isCalendar)&&t.insertBefore(new Comment("POWERED BY BRYNTUM (https://bryntum.com)"),t.firstChild),e.onConnectedCallback&&globalThis.ResizeObserver&&(e.connectedObserver=new ResizeObserver(()=>{e.isElementConnected&&!t.isConnected?(e.onConnectedCallback(!1),e.isElementConnected=!1):!e.isElementConnected&&t.isConnected&&(e.onConnectedCallback(!0,e.isElementConnected==null),e.isElementConnected=!0)}),e.connectedObserver.observe(t))),e.eachWidget(Vc,!1),r&&(e.getConfig("tooltip"),!q.Ripple&&q.RippleClass&&(q.Ripple=new q.RippleClass({rootElement:e.rootElement})),globalThis.DocsBrowser&&e.floating&&e.closest(n=>{var l;return(l=n.element)==null?void 0:l.closest(".fiddlePanelResult,.b-owned-by-fiddle")})&&t.classList.add("b-owned-by-fiddle")),e.isPainted=!0,r&&e.triggerConfigs("paint"),e.onInternalPaint({firstPaint:r}),e.trigger("paint",{firstPaint:r}),i!=null&&i.size){for(const{callback:n,thisObj:l,args:a}of i.values())e.callback(n,l,a);i.clear()}r&&e.monitorResize&&!e.scaleToFitWidth&&ce.onElementResize([{target:t}])}}onInternalPaint(){}cancelHideShowAnimation(){const e=this,{currentAnimation:t,element:i}=e;t&&(e.isAnimating=!1,i.classList.contains("b-hiding")&&(i.classList.remove("b-hiding"),e._hidden=!1),t.detacher(),t.resolve(),i.style.transition=i.style[t.styleProp]="",e.currentAnimation=null,e.trigger(`${t.showing?"show":"hide"}AnimationEnd`))}afterHideShowAnimate(e){const t=this;e===t.currentAnimation&&(t.element.classList.remove("b-hiding"),t.cancelHideShowAnimation(),t._hidden&&t.afterHideAnimation())}suspendVisibility(){this._visibilitySuspended=(this._visibilitySuspended||0)+1,Object.defineProperty(this,"isVisible",Hc)}resumeVisibility(e=!0){--this._visibilitySuspended||(delete this.isVisible,e&&this.triggerPaint())}hide(e=!0){return new Promise(t=>{const i=this,{element:r,lastAlignSpec:n}=i,{style:l}=r,a=e&&i.hideAnimation;if(i.clearTimeout(i.scrollListenerTimeout),i.clearTimeout(i.resizeListenerTimeout),!i._hidden&&i.trigger("beforeHide",{animate:e})!==!1){if(i._hidden=!0,n&&(n.targetOutOfView=null,n.monitorIntersection&&(i.intersectionObserver.takeRecords(),i.intersectionObserver.unobserve(n.target))),i.onConfigChange({name:"hidden",value:!0,was:!1,config:i.$meta.configs.hidden}),!r){t();return}if(r.contains(v.getActiveElement(r))&&i.revertFocus(!0),i.isDestroyed){t();return}if(i.cancelHideShowAnimation(),a){const o=Object.keys(a)[0],u=a[o];if(Number(getComputedStyle(i.element)[o])!==u.to){const c=i.currentAnimation={hiding:!0,styleProp:o,resolve:t};r.classList.add("b-hiding"),i.isAnimating=!0,i.currentAnimation.detacher=B.onTransitionEnd({element:r,property:o,duration:la(u.duration)+20,handler:()=>i.afterHideShowAnimate(c),thisObj:i}),l[o]=u.from,v.getStyleValue(r,o),l.transition=`${o} ${u.duration} ease ${u.delay}`,l[o]=u.to}else r.classList.add("b-hidden")}else r.classList.add("b-hidden");i.afterHide(!a&&t,a)}})}doHideOrRealign({target:e,isTrusted:t}){const i=this,{lastAlignSpec:r,element:n}=i,l=r==null?void 0:r.anchoredTo,a=r==null?void 0:r.target,o=r==null?void 0:r.position,u=v.getActiveElement(i);if(!t||!rt(n)||e&&(n.contains(e)||e.nodeType===Element.ELEMENT_NODE&&i.owns(e)||e.nodeType===Element.DOCUMENT_NODE&&n.contains(u)&&Nc[u]&&globalThis.innerHeight<document.body.offsetHeight))return;if(r.aligningToElement){const d=v.isInView(a,!1,i);if(d&&d.equals(r.targetRect))return}const c=i.scrollAction==="hide"&&i.getXY();if(i.realign(),!i.isDestroyed&&Qr(n)&&i.scrollAction==="hide"){const[d,f]=i.getXY(),g=d!==c[0]||f!==c[1];(r!=null&&r.aligningToEvent||(g||(a==null?void 0:a.$$name)==="Point"||o)&&(!l||!rt(l)||e&&v.isDescendant(e,l)))&&i.hide()}}afterHide(e=null,t=this.hideAnimation){var i,r;const n=this;n._anchor=n._configuredAnchorState,n.removeTransientListeners(),t||n.afterHideAnimation(),n.trigger("hide"),(r=(i=n.owner)==null?void 0:i.onChildHide)==null||r.call(i,n),e&&e()}removeTransientListeners(){var e,t,i;const r=this,{targetObserver:n,lastAlignSpec:l}=r;if(r.clearTimeout(r.resizeListenerTimeout),r.clearTimeout(r.scrollListenerTimeout),n&&(n.disconnect(),delete r.targetObserver),r.documentScrollListener=(e=r.documentScrollListener)==null?void 0:e.call(r),r.targetRootScrollListener=(t=r.targetRootScrollListener)==null?void 0:t.call(r),r.targetResizeListener&&(ce.removeResizeListener(l.target,r.onTargetResize),r.targetResizeListener=!1),r.constrainListeners){const a=(i=l.constrainTo)!=null&&i.isRectangle?globalThis:l.constrainTo;ce.removeResizeListener(a||globalThis,r.onAlignConstraintChange),r.constrainListeners=!1}}afterHideAnimation(){const e=this,{element:t}=e;e.floating&&e.floatRoot.contains(t)?t.remove():t.classList.add("b-hidden"),e.defaultAnchorBackgroundColor&&e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}changeHidden(e){const t=this;let i;return t.isConfiguring?(i=!!e,t.element.classList[e?"add":"remove"]("b-hidden")):(t.trigger("beforeChangeHidden",{hidden:e}),e?t.hide():t.show()),i}get assignedId(){return this.hasGeneratedId?null:this.id}get owner(){return this.parent||this._owner||this.containingWidget}get containingWidget(){var e,t;let i=this.parent;if(!i){const r=((e=this.forElement)==null?void 0:e.nodeType)===Element.ELEMENT_NODE?this.forElement:(t=this.element)==null?void 0:t.parentNode;i=(r==null?void 0:r.closest(".b-widget"))&&q.fromElement(r)}return i}get previousSibling(){return this.getSibling(-1)}get nextSibling(){return this.getSibling(1)}getSibling(e){const t=this,{parent:i}=t,r=i?i.childItems:Array.from(t.element.parentElement.querySelectorAll(".b-widget"));return i?r[r.indexOf(t)+e]:q.fromElement(r[r.indexOf(t.element)+e])}up(e,t,i){var r;const{owner:n}=this;return e?(r=n==null?void 0:n.closest)==null?void 0:r.call(n,e,t,i):n}closest(e,t,i){const r=typeof i,n=r==="number",l=r==="string";for(let a=this,o=1;a;a=a.owner,o++){if(q.widgetMatches(a,e,t))return a;if(n&&o>=i)return;if(l&&q.widgetMatches(a,i,t))return;if(a===i)return}}owns(e){if(e){if("eventPhase"in e&&(e=e.target),e.nodeType===Element.ELEMENT_NODE){if(this.element.contains(e))return!0;e=q.fromElement(e)}for(;e;){if(e===this)return!0;e=e.owner}}return!1}eachAncestor(e){let t=this.owner;for(;t;){if(e(t)===!1)return!1;t=t.owner}return!0}changeMaximizeOnMobile(e){const t=this;if(t.floating&&j.isMobile){const{initialConfig:i}=t;e?(t.centered=t.modal=!1,t.maximized=!0):(t.centered=i.modal,t.modal=i.centered,t.maximized=i.maximized)}}changeMonitorResize(e,t){const i=this.scaleToFitWidth?!1:!!e;if(i!==!!t)return i}updateMonitorResize(e){const t=this;wt(t,"onElementResize")||(t.onElementResize=t.onElementResize.bind(t)),ce[e?"addResizeListener":"removeResizeListener"](t.element,t.onElementResize)}changeReadOnly(e){if(e=!!e,!!this._readOnly!==e)return e}updateReadOnly(e){var t;(t=this.element)==null||t.classList[e?"add":"remove"]("b-readonly"),this.isConfiguring||(this.eachWidget(i=>{i.ignoreParentReadOnly||("_originalReadOnly"in i||(i._originalReadOnly=i.config.readOnly||!1),i.readOnly=e||i._originalReadOnly)},!1),this.trigger("readOnly",{readOnly:e}))}eachWidget(e,t=!0){const i=this.childItems,r=(i==null?void 0:i.length)||0,n={};for(let l=0;l<r;l++){const a=i[l];if(n.down=t,e(a,n)===!1||n.down&&a.eachWidget&&a.eachWidget(e,t)===!1)return!1}return!0}queryAll(e){const t=[];return this.eachWidget(i=>{e(i)&&t.push(i)}),t}query(e){let t=null;return this.eachWidget(i=>{if(e(i))return t=i,!1}),t}getWidgetByRef(e){var t,i;return e instanceof q?e:((t=this==null?void 0:this.widgetMap)==null?void 0:t[e])||((i=this==null?void 0:this.owner)==null?void 0:i.getWidgetByRef(e))}onFocusIn(e){const t=this,{element:i}=t;t.containsFocus=!0,t.focusInEvent=e,(t.floating||t.positioned)&&t.toFront(),i.classList.add("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),i.contains(e._target)&&t.onInternalKeyDown&&!t.keyDownListenerRemover&&(t.keyDownListenerRemover=B.on({element:i,keydown:"onInternalKeyDown",thisObj:t})),t.trigger("focusin",e)}onFocusOut(e){const t=this;t.keyDownListenerRemover&&(t.keyDownListenerRemover(),t.keyDownListenerRemover=null),t.isDestroyed||(e.relatedTarget||t.revertFocus(!t.isVisible),t.containsFocus=!1,t.element.classList.remove("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),t.trigger("focusout",e))}captureFocus(){const e=this,t=v.getActiveElement(e),i=e.contains(t)&&e.captureFocusItem(t);return(r,n)=>{i&&!e.isDestroying&&(v.getActiveElement(e)!==t||n)&&i(r)}}captureFocusItem(e){return(t=!0)=>{this.contains(e)&&(t?e.focus():v.focusWithoutScrolling(e))}}contains(e,t){const{element:i}=this;if(e&&i)return e.isWidget&&(e=e.element),i.contains(e)&&(!t||i!==e)}revertFocus(e){var t;const i=this,r=v.getActiveElement(i);let n=(t=i.focusInEvent)==null?void 0:t.relatedTarget;(e||i.containsFocus&&(n==null?void 0:n.nodeType)===Element.ELEMENT_NODE&&i.element.contains(r))&&((!n||!v.isFocusable(n))&&(n=i.getFocusRevertTarget()),i._isRevertingFocus=!0,n&&v.isFocusable(n)?(n._isRevertingFocus=!0,v.focusWithoutScrolling(n),n._isRevertingFocus=!1):r==null||r.blur(),i._isRevertingFocus=!1)}getFocusRevertTarget(){var e;const t=this,{owner:i,focusInEvent:r}=t,n=r&&r.backwards?1:-1;let l=r&&r.relatedTarget;const a=l&&q.fromElement(l);if(i&&!i.isDestroyed&&(!l||!v.isFocusable(l)||a&&!a.isFocusable)){if(l=null,i.eachWidget){const o=[];if(i.eachWidget(u=>{(u===t||u.isFocusable)&&o.push(u)},!1),o.length>1){const u=o.indexOf(t);l=o[u+n]||o[u-n]}}!l&&i.isFocusable&&(l=i),l=l?l.focusElement:(e=i.getFocusRevertTarget)==null?void 0:e.call(i)}return l}getStaticWidgetClasses(e,t){const i=new Z,r=this.$meta.hierarchy;let n,l,a,o,u;for(l=r.indexOf(e);l<r.length;++l)n=r[l],u=Reflect.getOwnPropertyDescriptor(n.prototype,"widgetClass"),u!=null&&u.get?o=u.get.call(this):(a=wt(n,"$$name")||wt(n,"$name")||wt(n,"_$name")?n.$$name:n.name,(a.length<3||a.includes("$"))&&console.warn(`Class "${a}" extending "${n.$name}" should have "$name" static getter with no less than 3 chars.`),o=`b-${a.toLowerCase()}`),o&&i.add(t?o+t:o);return i}get rootUiClass(){return q}get staticClassList(){const{$meta:e}=this;let t=e.staticClassList;return t||(e.staticClassList=t=this.getStaticWidgetClasses(q),j.isTouchDevice&&t.add("b-touch")),t}get uiClasses(){return this.getConfig("ui"),this._uiClasses}get uiClassList(){return this.getConfig("ui"),this._uiClassList}get widgetClassList(){const e=this,{cls:t,defaultCls:i,uiClasses:r}=e;let{staticClassList:n}=e;(i||t)&&(n=n.clone(),i&&n.assign(i),t&&n.assign(t));const l=n.values;return r&&l.push(...r),e.floating&&l.push("b-floating"),e.collapsify==="hide"&&l.push("b-collapsify-hide"),l}changeCls(e){return Z.from(e)}updateCls(e,t){if(!this.isConfiguring&&!this.isComposable){const{element:i}=this;t&&w.getTruthyKeys(t).forEach(r=>i.classList.remove(r)),e.assignTo(i)}}changeContentElementCls(e){return Z.from(e)}changeHtmlCls(e){return Z.from(e)}changeDefaultCls(e){return Z.from(e,!0)}changeUi(e){return Z.from(e)}updateUi(e){let t=null,i,r;if(e){const n=this.getStaticWidgetClasses(this.rootUiClass);for(r in e)if(e[r])for(i in n)n[i]&&((t||(t=new Z))[`${i}-ui-${r}`]=1)}this._uiClasses=t==null?void 0:t.values,this._uiClassList=t}fromCache(e,t=!1,i=this.element){if(!i)return null;const r=this;return r.cache[e]||(r.cache[e]=t?v.children(i,e):v.down(i,e)),r.cache[e]}emptyCache(){this.cache={}}changeMasked(e,t){var i;if(((i=this.masked)==null?void 0:i.type)!=="trial"){if((e===!0||e==="")&&(e="\xA0"),t&&!t.isDestroyed)typeof e=="string"?(t.text=e,e=t):e?(t.setConfig(e),e=t):t.destroy();else if(e){const r=q.resolveType("mask");e=r.mergeConfigs(this.maskDefaults,e),e.owner=this,e=r.mask(e)}return e||null}}onMaskAutoClose(e){e.isDestroyed&&e===this.masked&&(this.masked=null)}mask(e){return this.masked=e,this.masked}unmask(){this.masked=null}onInternalResize(e,t,i,r,n){this._width=e.offsetWidth,this._height=e.offsetHeight}onElementResize(e,t){var i;const r=this,{element:n}=r,l=(i=r._width)!=null?i:r._oldWidth,a=r._height,o=n.offsetWidth,u=n.offsetHeight;r.floating&&t&&r.onFloatingWidgetResize(...arguments),!r.suspendResizeMonitor&&(l!==o||a!==u)&&(r.onInternalResize(n,o,u,l,a),r.trigger("resize",{width:o,height:u,oldWidth:l,oldHeight:a}))}onFloatingWidgetResize(e,t,i){const r=this,{lastAlignSpec:n,constrainTo:l}=r;if(r.isVisible&&n&&n.target){const a=!t||i.height!==t.height,o=!t||i.width!==t.width,u=l&&!K.from(l).contains(K.from(r.element,null,!0));(a&&n.zone!==2||o&&n.zone!==1||u)&&r.requestAnimationFrame(()=>r.realign())}}updateScale(){const e=this,t=e.element,i=t.parentElement;e.configuredWidth||(e.configuredWidth=e.width),t.style.display="none";const r=K.client(i),n=r.width/e.configuredWidth,l=e.scale=e.allowGrowWidth?Math.min(n,1):n;t.style.transform=`scale(${l})`,t.style.transformOrigin="top left",t.style.display="",e.allowGrowWidth&&n>1&&(e.width=e.configuredWidth*n)}onParentElementResize(e){this.updateScale()}parseTRBL(e,t="px"){if(e=e||0,typeof e=="number")return[`${e}${t}`,`${e}${t}`,`${e}${t}`,`${e}${t}`];const i=e.split(" "),r=i.length;return r===1?i[1]=i[2]=i[3]=i[0]:r===2?(i[2]=i[0],i[3]=i[1]):r===3&&(i[3]=i[1]),[isFinite(i[0])?`${i[0]}${t}`:i[0],isFinite(i[1])?`${i[1]}${t}`:i[2],isFinite(i[2])?`${i[2]}${t}`:i[3],isFinite(i[3])?`${i[3]}${t}`:i[4]]}get documentRoot(){var e;return((e=this.owner)==null?void 0:e.documentRoot)||this.element.getRootNode()}get eventRoot(){var e,t;return(e=this.element)!=null&&e.isConnected?v.getRootElement(this.element):((t=this.owner)==null?void 0:t.eventRoot)||this._rootElement}get rootElement(){var e,t;const i=this;if(!i._rootElement){let r=((e=i.owner)==null?void 0:e.rootElement)||v.getRootElement(i.forElement||((t=i.element)!=null&&t.isConnected?i.element:i.getRenderContext()[0]||i.element));r||(r=document.body),i._rootElement=r}return i._rootElement}get floatRoot(){var e;const t=this,{rootElement:i}=t;let{floatRoot:r}=i;if(r)i.contains(r)||i.appendChild(r);else{const{outerCls:n}=q,l=(e=v.getThemeInfo(null,i))==null?void 0:e.name;if(!v.isValidFloatRootParent(i))throw new Error("Attaching float root to wrong root");l&&n.push(`b-theme-${l.toLowerCase()}`),r=i.floatRoot=v.createElement({className:`b-float-root ${n.join(" ")}`,parent:i}),Ei.push(r),j.isAndroid&&(r.style.height=`${screen.height}px`,B.on({element:globalThis,orientationchange:()=>r.style.height=`${screen.height}px`,thisObj:this})),be.ion({theme:({theme:a,prev:o})=>{r.classList.add(`b-theme-${a.toLowerCase()}`),r.classList.remove(`b-theme-${o.toLowerCase()}`)}})}return r}get floatRootMaxZIndex(){let e=1;return Array.from(this.floatRoot.children).forEach(t=>{const i=parseInt(getComputedStyle(t).zIndex||0,10);i>e&&(e=i)}),e}static resetFloatRootScroll(){Ei.forEach(e=>e.scrollTop=e.scrollLeft=0)}static get floatRoots(){return Ei}static removeFloatRoot(e){Ei.splice(Ei.indexOf(e),1)}static get outerCls(){const e=["b-outer"],{platform:t}=j;return t&&e.push(`b-${t}`),j.isTouchDevice&&e.push("b-touch-events"),j.isMobile&&e.push("b-mobile"),v.scrollBarWidth?e.push("b-visible-scrollbar"):e.push("b-overlay-scrollbar"),j.isChrome?e.push("b-chrome"):j.isSafari?e.push("b-safari"):j.isFirefox&&e.push("b-firefox"),j.isPhone&&e.push("b-phone"),globalThis.ResizeObserver||e.push("b-no-resizeobserver"),e}get isAnimating(){return this._isAnimatingCounter>0}set isAnimating(e){const t=this,{_isAnimatingCounter:i}=t;t._isAnimatingCounter=Math.max(0,i+(e?1:-1)),i===0&&e?(t.element.classList.add("b-animating"),t.trigger("animationStart")):i===1&&!e&&(t.element.classList.remove("b-animating"),t.trigger("animationEnd"))}async waitForAnimations(){this.isAnimating&&await this.await("animationend",{checkLog:!1})}static query(e,t=!1){const{idMap:i}=q.identifiable;for(const r in i)if(q.widgetMatches(i[r],e,t))return i[r];return null}static queryAll(e,t=!1){const{idMap:i}=q.identifiable,r=[];for(const n in i)q.widgetMatches(i[n],e,t)&&r.push(i[n]);return r}static fromElement(e,t,i){const r=typeof t;e&&!e.nodeType&&(e=e.target),(r==="number"||t&&t.nodeType===Element.ELEMENT_NODE)&&(i=t,t=null);let n=e,l=0,a,o,u;for(typeof i!="number"&&(a=i,i=Number.MAX_VALUE),r==="string"&&(t=t.toLowerCase());n&&n.nodeType===Element.ELEMENT_NODE&&l<i&&n!==a;){if(o=n.dataset&&n.dataset.ownerCmp||n.id,o){if(u=q.getById(o),u)if(t){if(r==="function"){if(t(u))return u}else if(q.widgetMatches(u,t,!0))return u}else return u;l++}n=n.parentNode}return null}static fromSelector(e){const t=document.querySelector(e);return t?q.fromElement(t):null}triggerFieldChange(e,t=!0){var i;t&&this.trigger("change",e),(i=this.eachAncestor)==null||i.call(this,r=>{var n,l;if((n=r.onFieldChange)==null||n.call(r,e),(l=r.isolateFieldChange)!=null&&l.call(r,this))return!1})}isolateFieldChange(e){return this.isolateFields}setupFocusListeners(){be.setupFocusListenersOnce(this.eventRoot,B)}static widgetMatches(e,t,i){return t==="*"?!0:typeof t=="function"?t(e):q.isType(e,t,i)}static attachTooltip(e,t){return typeof t=="string"&&(t={html:t}),q.create(Object.assign({forElement:e},t),"tooltip"),e}changeDock(e){return e==="start"?"left":e==="end"?"right":e}updateRtl(e){super.updateRtl(e),this.eachWidget(t=>{"rtl"in t.initialConfig||(t.rtl=e)})}},Yc=N.prototype;["compose","domSyncCallback"].forEach(s=>Yc[s].$nullFn=!0),N.initClass(),N.register("mask",Si),v.Widget=N,be.Widget=N,Si.identifiable.idMap=N.identifiable.idMap,Object.assign(globalThis.bryntum||(globalThis.bryntum={}),{get:N.getById.bind(N),query:N.query,queryAll:N.queryAll,fromElement:N.fromElement,fromSelector:N.fromSelector}),N._$name="Widget";var Ue=class extends R.mixin(De,Vt){get contentElement(){var s;return(s=this.owner)==null?void 0:s.contentElement}onChildAdd(s){}onChildRemove(s){}renderChildren(){const s=this,{owner:e,itemCls:t}=s,{contentElement:i,items:r}=e,n=e.itemCls,l=r==null?void 0:r.length;if(l){e.textContent=!1;for(let a=0;a<l;a++){const o=r[a],{element:u}=o,{classList:c}=u;u.dataset.itemIndex=a,c.contains("b-outer")&&c.remove(...N.outerCls),t&&c.add(t),n&&c.add(n),o.render(i,!!e.isPainted)}}s.syncPendingConfigs(),s.syncChildCount()}removeChild(s){const e=this,{element:t}=s,{owner:i,itemCls:r}=e,{contentElement:n}=i,l=i.itemCls;n.contains(t)&&t.remove(),delete t.dataset.itemIndex,r&&t.classList.remove(r),l&&t.classList.remove(l),e.fixChildIndices(),e.syncChildCount()}appendChild(s){const{element:e}=s,{owner:t,itemCls:i}=this,{contentElement:r}=t,n=t.itemCls;e.dataset.itemIndex=t.indexOfChild(s),t.textContent=!1,i&&e.classList.add(i),n&&e.classList.add(n),s.render(r,!!t.isPainted),this.syncChildCount()}insertChild(s,e){const t=this,{element:i}=s,{owner:r,itemCls:n}=t,{contentElement:l}=r,a=v.getChild(l,`[data-item-index="${e}"]`),o=r.itemCls;r.textContent=!1,n&&i.classList.add(n),o&&i.classList.add(o),l.insertBefore(i,a),s.render(null,!!r.isPainted),t.fixChildIndices(),t.syncChildCount()}fixChildIndices(){this.owner.items.forEach((s,e)=>{s.element.dataset.itemIndex=e})}syncChildCount(){var s;const{owner:e}=this,{length:t}=e.items;(s=e.contentElement)==null||s.classList[t===1?"add":"remove"]("b-single-child")}syncConfigLater(s){const e=this.pendingConfigs||(this.pendingConfigs=[]);e.includes(s)||e.push(s)}syncConfigStyle({name:s,style:e,classes:t,map:i}){const r=this,n=`b-box-${s}-`,{contentElement:l}=r,a=r[s];let o=(i==null?void 0:i[a])||a;if(l){if(t){const{classList:u}=l;t.forEach(c=>{c!==o&&u.remove(n+c)}),t.includes(o)&&(u.add(n+o),o="")}l.style[e]=o}else r.syncConfigLater(s)}syncPendingConfigs(){const s=this,{pendingConfigs:e}=s;let t;if(e)for(s.pendingConfigs=null;t=e.pop();)s[s.$meta.configs[t].updater](s[t])}};x(Ue,"type","default"),x(Ue,"configurable",{owner:null,containerCls:"b-auto-container",itemCls:null}),x(Ue,"factoryable",{defaultType:"default"}),Ue.initClass(),Ue._$name="Layout";var ca=0,Gc=s=>s.ripple,Ti=class extends N{static get defaultConfig(){return{old_element:{children:[{className:"b-ripple-inner",reference:"rippleElement"}]},element:{children:[{tag:"svg",class:"b-ripple-inner",reference:"rippleElement",ns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 100 100",children:[{reference:"circleElement",tag:"circle",cx:"0",cy:"0",r:10}]}]},floating:!0,hideAnimation:!1,showAnimation:!1,scrollAction:"realign",color:"rgba(0,0,0,.3)",startRadius:10,radius:100}}afterConstruct(){super.afterConstruct(),B.on({element:this.rootElement,mousedown:"onRippleControllingEvent",thisObj:this,capture:!0,once:!0})}onRippleControllingEvent(s){var e;const t=this;t.show();const i=v.getStyleValue(t.circleElement,"animationName");t.hide(),(e=t.listenerDetacher)==null||e.call(t),i&&i!=="none"&&(t.listenerDetacher=B.on({mousedown:{element:t.rootElement,capture:!0,handler:"onMousedown"},touchstart:{element:t.rootElement,capture:!0,handler:"onTouchStart"},animationend:{element:t.circleElement,handler:"onAnimationEnd"},thisObj:t}),s.type==="mousedown"&&(t.onMousedown(s),be.ion({theme:"onRippleControllingEvent",thisObj:this})))}onTouchStart(s){ca=performance.now(),this.handleTriggerEvent(s)}onMousedown(s){performance.now()-ca>200&&this.handleTriggerEvent(s)}handleTriggerEvent(s){const e=N.fromElement(s.target,Gc);if(e){const t=e.ripple,i=t.delegate?s.target.closest(t.delegate):e.focusElement||e.element;if(i){const r=w.assign({event:s,target:i,radius:this.radius},t);if(typeof r.clip=="string"&&(r.clip=e[r.clip]||s.target.closest(r.clip),!r.clip))return;this.ripple(r)}}}ripple({event:s,point:e=B.getClientPoint(s),target:t=s.target,clip:i=t,radius:r=this.radius,color:n=this.color}){this.clip=i,i=K.from(i,null,!0);const l=this,a=i.getDelta(e),o=l.rippleElement.style,u=l.circleElement,c=v.getStyleValue(t,"border-radius");l.hide(),o.transform=`translateX(${a[0]}px) translateY(${a[1]}px)`,o.height=o.width=`${r}px`,l.element.style.borderRadius=c,u.setAttribute("r",r),u.setAttribute("fill",n),l.showBy({target:i,align:"c-c",matchSize:!0})}onAnimationEnd(s){s.animationName==="b-ripple-expand"&&this.hide()}};x(Ti,"$name","Ripple"),x(Ti,"type","ripple"),N.RippleClass=Ti,Ti._$name="Ripple";var Xc=Object.freeze({}),{isArray:Wt}=Array,Jc=s=>s.weight,da=({weight:s},{weight:e})=>typeof s=="string"||typeof e=="string"?String(s).localeCompare(String(e)):(s!=null?s:Number.MAX_SAFE_INTEGER)-(e!=null?e:Number.MAX_SAFE_INTEGER),fa=s=>s&&!s.hidden,Zc=["display","flex-direction"],Qc={default:1,box:1},qe=class extends N{static get configurable(){return{items:null,lazyItems:{$config:["lazy"],value:null},defaults:null,defaultType:"widget",layoutStyle:null,itemCls:null,layout:{type:"default"},namedItems:null,overflowable:{value:null,default:!1,$config:null},textContent:!0,record:null,strictRecordMapping:null,autoUpdateRecord:null,autoUpdateFields:null,hideWhenEmpty:null,contentElMutationObserver:{$config:["lazy","nullify"],value:!0},isolateFields:!1,focusDescendant:!1,defaultBindProperty:null,defaultFocus:null}}static get prototypeProperties(){return{flexRowCls:"b-flex-row",flexColCls:"b-flex-column",initialItems:!0}}startConfigure(s){const e=s.items||s.lazyItems;(this.hasItems=!!(e&&(Wt(e)?e:Object.keys(e)).length))||(this.initialItems=!1),super.startConfigure(s)}get firstItem(){return this.getAt(0)}get lastItem(){return this.getAt(-1)}getAt(s){return this.ensureItems().at(s)}remove(...s){let e=!0;s.length===1&&(Wt(s[0])?s=s[0]:e=!1);const t=this,{_items:i}=t,r=[];for(let n=0;n<s.length;n++){const l=s[n];i.includes(l)&&(i.remove(l),t.layout.removeChild(l),r.push(l),t.onChildRemove(l))}return e?r:r[0]}removeAll(){return this.remove(this.items)}add(...s){const e=this,t=e.ensureItems(),i=[];let r=!0,n,l,a;for(s.length===1&&(Wt(s[0])?s=s[0]:r=!1),l=0;l<s.length;l++)n=s[l],n.isWidget?n.parent=e:n=e.createWidget(n),(n==null?void 0:n.weight)!=null?(a=V.findInsertionIndex(n,t.values,da),i.push(e.insert(n,a))):n&&(t.includes(n)||(t.add(n),e.onChildAdd(n),e.layout.appendChild(n),i.push(n)));return r?i:i[0]}ensureItems(){const s=this;return s.getConfig("items"),s.getConfig("lazyItems"),s._items||(s.items=[]),s._items}insert(s,e){const t=this,i=t.ensureItems();s instanceof N?s.parent=t:s=t.createWidget(s),i.includes(e)&&(e=t.indexOfChild(e)),e=Math.min(e,i.count);const r=i.values;return r.splice(e,0,s),i.values=r,t.onChildAdd(s),t.layout.insertChild(s,e),s}indexOfChild(s){return this.items.indexOf(s)}changeLazyItems(s){this.items=s,this.layout.renderChildren()}changeItems(s,e){const t=this,i=[],r=new yi;return Wt(s)?t.processItemsArray(s,i):s&&t.processItemsObject(s,t.namedItems,i),i.some(Jc)&&i.sort(da),r.add(i),e&&e.forEach(n=>{t.remove(n),!r.includes(n)&&n._createdBy===t&&n.destroy()}),r}afterConstruct(){const{rtl:s}=this,{classList:e}=this.contentElement;e.toggle("b-rtl",s===!0),e.toggle("b-ltr",s===!1)}updateRtl(s){super.updateRtl(s);const{contentElement:e}=this;e&&(e.classList.toggle("b-rtl",s===!0),e.classList.toggle("b-ltr",s===!1))}updateItems(s,e){let t=0;s.forEach(i=>{this.onChildAdd(i),e&&!e.temporary&&this.layout.insertChild(i,t),++t}),this.initialItems=!1}updateHideWhenEmpty(){this.syncChildCount(this.rendered)}get items(){const s=this;if(s.getConfig("lazyItems"),!s._items){if(s.initializingItems)return[];s._items=new yi,s._items.temporary=!0}return s._items.values}processItemsArray(s,e){const t=s.length;let i,r;for(i=0;i<t;i++)r=s[i],r instanceof N?(r.parent=this,r.element.classList.remove(...N.outerCls)):r=this.createWidget(r),r&&((r.ref||r.id)&&this.addDescendant(r),e.push(r))}processItemsObject(s,e,t){let i,r;for(r in s)i=s[r],i&&(e&&r in e&&(i=typeof i=="object"?w.merge(w.clone(e[r]),i):e[r]),i&&(i instanceof N?i.parent=this:(i instanceof Object&&(i.ref=r),i=this.createWidget(i)),i&&(i.ref=r,this.addDescendant(i),t.push(i))))}onChildAdd(s){if(s.innerItem&&this.readOnly&&!s.ignoreParentReadOnly&&(s.readOnly=!0),this.onChildAddLayout(s),s.ref||s.id)for(let e=this;e;e=e.parent)e.addDescendant(s);this.syncChildCount(!0)}onChildAddLayout(s){s.innerItem&&this.layout.onChildAdd(s)}onChildHide(s){var e;super.onChildHide(s),(e=this._items)!=null&&e.includes(s)&&this.syncChildCount(!0)}onChildShow(s){var e;super.onChildShow(s),(e=this._items)!=null&&e.includes(s)&&this.syncChildCount(!0)}syncChildCount(s){if(!this.isConfiguring){const e=this,{items:t,hasItems:i}=e,r=t.filter(fa),{length:n}=r;if(e.visibleChildCount=n,e.hideWhenEmpty&&s){const l=!n;!!e._hidden!==l&&(e.hidden=l)}t.forEach(l=>l.element.classList.remove("b-last-visible-child","b-first-visible-child")),n&&(r[0].element.classList.add("b-first-visible-child"),r[n-1].element.classList.add("b-last-visible-child")),e.hasItems=!!e.childItems.length,e.contentElement.classList[n?"remove":"add"]("b-no-visible-children"),e.isComposable?i!==e.hasItems&&e.recompose():e.updateTextContent(e._textContent)}}syncFlexDirection(){const s=this,{contentElement:e,flexColCls:t,flexRowCls:i}=s,r=new Z(e.className),n=v.getStyleValue(e,Zc);r[i]=r[t]=0,n.display==="flex"&&(r[n["flex-direction"]==="row"?i:t]=1),v.syncClassList(e,r)}addDescendant(s){const e=s.ref||s.id,t=this._widgetMap||(this._widgetMap={});t[e]||(t[e]=s)}onChildRemove(s){const e=this,t=s.ref||s.id;if(t)for(let i=e;i;i=i.parent)i.widgetMap[t]===s&&delete i.widgetMap[t];e.layout.onChildRemove(s),e.syncChildCount(!0)}get widgetMap(){return this._widgetMap||(this._widgetMap={}),this.initializingItems||this.getConfig("items"),this._widgetMap}changeRecord(s){return this._record=s==null?Xc:null,s}updateRecord(s){var e;const t=this;(e=t.recordUpdateDetacher)==null||e.call(t),t.trigger("beforeSetRecord",{record:s}),t.setValues(s,{onlyName:t.strictRecordMapping,highlight:!!t.$highlight}),t.autoUpdateFields&&(s!=null&&s.firstStore)&&(t.recordUpdateDetacher=s.firstStore.ion({update:t.onRecordUpdated,thisObj:t}))}setRecord(s,e){this.$highlight=e,this.record=s,this.$highlight=!1}onRecordUpdated({record:s}){s===this.record&&this.setValues(this.record,!0,!0)}onFieldChange({source:s,userAction:e}){if(this.autoUpdateRecord&&e){const{record:t,strictRecordMapping:i}=this,{name:r,ref:n,isValid:l=!0,value:a}=s,o=i?r:r||n;t&&o&&l&&(t.isModel?t.setValue(o,a):t[o]=a)}}getValues(s){const e={};return this.eachWidget((t,i)=>{t.isolateFields?i.down=!1:"name"in t&&(!s||s(t))&&(e[t.name]=t.value)},!0),e}get values(){const s={};return this.gatherValue(s),s}set values(s){this.assignValue(s)}get isSettingValues(){return!!this.assigningValues}get assigningValues(){var s;return this._assigningValues||((s=this.parent)==null?void 0:s.assigningValues)}set assigningValues(s){this._assigningValues=s}assignValue(s,e){super.assignValue(s,e),this.isolateFields||this.setValues(s,e)}gatherValue(s){super.gatherValue(s),this.isolateFields||this.gatherValues(s)}setValues(s,e=this.assignValueDefaults){this.assigningValues=e,this.eachWidget(t=>t.assignValue(s,e),!1),this.assigningValues=!1}get hasNoChildren(){const s=this,{items:e,lazyItems:t}=s.initialConfig,i=e&&(Wt(e)?e:w.values(e)),r=t&&(Wt(t)?t:w.values(t)),n=s.isConfiguring?r||i:s.items;return!(n!=null&&n.filter(fa).length)}afterRecompose(){super.afterRecompose(),this.realign()}updateTextContent(s){const e=this;if(!e.isComposable){const t=!!(s&&e.hasNoChildren),{classList:i}=e.contentElement;t!==i.contains("b-text-content")&&(i[t?"add":"remove"]("b-text-content"),e.rendered&&e.realign())}}updateLayoutStyle(s){v.applyStyle(this.contentElement,s)}updateElement(s){if(super.updateElement(...arguments),s){const{classList:e}=this.contentElement,{containerCls:t}=this.layout;e.add("b-content-element"),t&&e.add(t)}}onInternalPaint(){var s;(s=super.onInternalPaint)==null||s.call(this,...arguments),this.getConfig("contentElMutationObserver")}changeContentElMutationObserver(s,e){if(e&&(e.takeRecords(),e.disconnect()),s){const t=this,{element:i,contentElement:r}=t;s=new MutationObserver(n=>t.onContentElMutation(n)),s.observe(r,{attributes:!0}),r!==i&&s.observe(i,{attributes:!0}),t.syncFlexDirection()}return s}onContentElMutation(s){Qc[this.layout.type]&&this.isVisible&&s.some(e=>this.contentElement.contains(e.target))&&this.syncFlexDirection()}changeLayout(s,e){return Ue.reconfigure(e,s,{owner:this,defaults:{owner:this}})}get childItems(){return this.items}getWidgetById(s){return this.widgetMap[s]}processWidgetConfig(s){}setupWidgetConfig(s,e){const t=this;typeof s=="string"?s={html:s}:s.nodeType===Element.ELEMENT_NODE&&(s={element:s,id:s.id}),(typeof e=="string"||!e&&(e=s.type))&&(e==="checkbox"&&j.isMobile&&N.resolveType("slidetoggle",!0)&&(e=s.type="slidetoggle"),e=N.resolveType(e,!0)),s=(e||N).mergeConfigs(t.defaults,s,{parent:t});for(let i=s.parent;i;i=i.parent)if(i.processWidgetConfig(s)===!1)return null;return t.trigger("beforeWidgetCreate",{widgetConfig:s})===!1?null:s}createWidget(s){const e=N.create(this.setupWidgetConfig(s),this.defaultType);return e&&(e._createdBy=this),e}updateDefaults(s,e){if(!this.isConfiguring&&s){const t=Object.entries(s);this.eachWidget(i=>{t.forEach(([r,n])=>{(!e||i[r]===e[r])&&(i[r]=n)})},!1)}}render(){this.getConfig("lazyItems"),this.layout.renderChildren(),this.syncChildCount(),super.render(...arguments)}get focusElement(){const s=this.query(this.defaultFocus||(e=>{var t;return e.isFocusable&&e.ref!=="close"&&!((t=e.ref)!=null&&t.endsWith("collapse"))}));return s?s.focusElement:super.focusElement}doDestroy(){var s;(s=this._items)==null||s.forEach(e=>{var t;return(t=e.destroy)==null?void 0:t.call(e)}),this.layout.destroy(),super.doDestroy()}get isValid(){let s=!0;return this.eachWidget(e=>{e.isVisible&&"isValid"in e&&!e.isValid&&(s=!1)},!0),s}};x(qe,"$name","Container"),x(qe,"type","container"),qe.initClass(),qe._$name="Container";var{assign:xi}=w,ha=()=>performance.now(),ed={start:!1},td=/^[.\d]+([^\d].*)?$/,ga=s=>{const e=s.$bryntum||(s.$bryntum={});return e.transitions||(e.transitions=Object.create(null))},pa=(s,e)=>{var t;return typeof s=="string"&&(e=(t=td.exec(s))==null?void 0:t[1],s=parseFloat(s)),s&&s*(e==="s"||!e&&s<10?1e3:1)},Es=s=>{const e=w.values(ga(s)).filter(t=>t.completed==null).map(t=>t.toString());s.style.transition=e.join(", ")},ma=s=>class extends s{static get prototypeProperties(){return{_delay:null,_duration:null,_retain:null,_timing:null,_unit:null,owner:null,reverting:null}}constructor(...t){super(...t),this.id=++id}start(){this.startTime=ha()}get delay(){var t,i,r;return pa((r=(i=this._delay)!=null?i:(t=this.owner)==null?void 0:t.delay)!=null?r:0,this.unit)}set delay(t){this._delay=t}get duration(){var t;const{owner:i,unit:r}=this;return pa((t=this._duration)!=null?t:i?i.duration:Se.defaultDuration,r)}set duration(t){this._duration=t}get elapsed(){return ha()-this.startTime}get remaining(){return this.duration-this.elapsed}get retain(){var t,i;return(i=this._retain)!=null?i:(t=this.owner)==null?void 0:t.retain}set retain(t){this._retain=t}get timing(){var t,i;return(i=this._timing)!=null?i:(t=this.owner)==null?void 0:t.timing}set timing(t){this._timing=t}get unit(){var t,i;return(i=this._unit)!=null?i:(t=this.owner)==null?void 0:t.unit}set unit(t){this._unit=t}},id=0,Ts=class Ya extends R.mixin(ma){static get $name(){return"AnimatorTransition"}static get prototypeProperties(){return{element:null,property:null,from:null,to:null,completed:null,promissory:null,reverting:null}}afterConstruct(){super.afterConstruct();const e=this,{element:t,transitions:i}=e;let{property:r}=e;[r,e.to]=v.unitize(r,e.to),e.from=v.unitize(r,e.from)[1],e.promissory=new cr,e.property=r;const n=i[r];i[r]=e;let{from:l}=e;n&&(e.from=n.to,l=null,n.destroy()),l===null&&(l=e.getCurrentStyleValue(),n||(e.from=l)),t.style[r]=l,e.getCurrentStyleValue()}doDestroy(){const e=this;e.finish(!1),e.completed&&!e.retain&&e.clearStyle(),super.doDestroy()}get promise(){var e;return(e=this.promissory)==null?void 0:e.promise}get transitions(){return ga(this.element)}clearStyle(){this.setStyle("")}finish(e){const t=this,{transitions:i,promissory:r,property:n}=t;r&&(t.completed=e,t.promissory=null,r.resolve(e),i[n]===t?(delete i[n],e||(Es(t.element),t.clearStyle())):t.completed=!1)}getCurrentStyleValue(){return v.getStyleValue(this.element,this.property)}revert(){const{duration:e,elapsed:t,element:i,from:r,property:n,_retain:l,_timing:a}=this;return new Ya({element:i,property:n,retain:l,timing:a,duration:Math.round(Math.min(e,t)),reverting:this,to:r,unit:"ms"})}setStyle(e){this.element.style[this.property]=e}start(){const e=this,{delay:t,duration:i,element:r,property:n}=e;B.onTransitionEnd({element:r,property:n,duration:t+i+20,thisObj:e.owner,handler:()=>{var l;return(l=e.finish)==null?void 0:l.call(e,!0)}}),super.start(),e.setStyle(e.to)}toString(){const{delay:e,duration:t,property:i,timing:r}=this;return`${i} ${t}ms ${r||"ease-in-out"}${e?` ${e}ms`:""}`}};Ts.initClass();var Se=class Le extends R.mixin(ma){static get $name(){return"Animator"}static get prototypeProperties(){return{element:null,finalize:null,prefinalize:null,completed:null,items:null}}static register(e,t){if(w.isObject(e)){w.entries(e).forEach(i=>Le.register(...i));return}Le.fx[e]=t,Le[e]=i=>(v.isElement(i)?i={element:i,[e]:{}}:(i={element:i.element,[e]:i},delete i[e].element),Le.run(i))}static run(e){return new Le(e).start()}constructor(e){var t;super(null);const i=this,r=[],n={};let l,a,o,u;if(Array.isArray(e))i.items=e;else for(o in e)(Le.specialPropsRe.test(o)?i:n)[o]=e[o];w.keys(n).forEach(c=>{u=n[c],u!=null&&u!==!1&&u===u&&((a=Le.fx[c])?(u=xi(i.defaults,a(u,i,c)),u.owner=i,l=new Le(u)):(u=xi(i.defaults,typeof u=="object"?u:{to:u}),u.owner=i,u.property=c,l=new Ts(u)),r.push(l))}),(t=i.items)==null||t.forEach(c=>{w.isInstantiated(c)?c.owner=i:(c=xi(i.defaults,c),c.owner=i,c=new Le(c)),r.push(c)}),i.items=r,i.promise=(r.length===1?r[0].promise:Promise.all(r.map(c=>c.promise))).then(c=>{var d;return(d=i.finish)==null||d.call(i,c),i.completed||!1})}doDestroy(){this.items.forEach(e=>e.destroy()),super.doDestroy()}get defaults(){return{element:this.element}}get retain(){const{_retain:e,finalize:t,owner:i}=this;return e!=null?e:t?!1:i?i.retain:!0}set retain(e){super.retain=e}done(){return this.promise}finish(e){var t,i;const r=this,{items:n}=r;for(Es(r.element),r.completed=typeof e=="boolean"?e:!e.some(l=>!l),(t=r.prefinalize)==null||t.call(r,r.completed,r);n.length;)n.pop().destroy();(i=r.finalize)==null||i.call(r,r.completed,r)}revert(e){var t;const i=this,{reverting:r}=i,n=!e||((t=e.start)!=null?t:!0);let l=i.defaults;return r&&(r.finalize&&(l.finalize=r.finalize),r.prefinalize&&(l.prefinalize=r.prefinalize),l.retain=r._retain),l=xi(l,e,{items:i.items.map(a=>a.revert(ed)),reverting:i}),l=new Le(l),n&&l.start(),l}start(){const{element:e,items:t}=this;return super.start(),t.length&&(Es(e),t.forEach(i=>i.start())),this}};Se.initClass().Transition=Ts,Se.specialPropsRe=new RegExp(`^(?:${Object.keys(Se.prototypeProperties).concat(Object.keys(Se.superclass.prototypeProperties)).map(s=>s[0]==="_"?s.substr(1):s).join("|")})$`),Se.defaultDuration=200,Se.fx={},Se.register({puff(s){return s===!0?s={}:typeof s!="object"?s={transform:`scale(${s})`}:s.scale&&(s=w.clone(s),s.transform=`scale(${s.scale})`,delete s.scale),xi({opacity:0,transform:"scale(8)"},s)}}),Se._$name="Animator";var hr=class extends R.mixin(lt){static get configurable(){return{element:null,delegate:null,delay:500,startRate:2,endRate:20,accelerateDuration:4e3,pressedCls:"b-pressed"}}doDestroy(){var s;(s=this.mousedownRemover)==null||s.call(this),this.cancel(),super.doDestroy()}cancel(){var s,e,t;const i=this;(s=i.activeElement)==null||s.classList.remove(i.pressedCls),i.activeElement=null,(e=i.acceleration)==null||e.cancel(),i.activeListenerRemover=(t=i.activeListenerRemover)==null?void 0:t.call(i),i.clearTimeout(i.autoRepeatTimer),i.clearTimeout(i.repeatTimer)}updateElement(s){var e;(e=this.mousedownRemover)==null||e.call(this),this.mousedownRemover=B.on({element:s,mousedown:"onMouseDown",thisObj:this})}onMouseDown(s){const e=this,t=e.delegate?s.target.closest(e.delegate):e.element;e.cancel(),t&&(e.activeElement=t,e.triggerEvent=s,t.classList.add(e.pressedCls),e.activeListenerRemover=B.on({mouseup:{element:document,capture:!0,handler:"onMouseUp"},mousemove:{element:t,handler:"onTargetMouseMove"},mouseleave:{element:t,handler:"onTargetMouseLeave"},mouseenter:{element:t,handler:"onTargetMouseEnter"},thisObj:e}),e.autoRepeatTimer=e.setTimeout("startAutoRepeat",e.delay))}onMouseUp(){this.cancel()}onTargetMouseLeave(){this.activeElement.classList.remove(this.pressedCls),this.clearTimeout(this.repeatTimer)}onTargetMouseEnter(s){const e=this;s.buttons?(e.activeElement.classList.add(e.pressedCls),e.triggerEvent=s,e.fireClick()):e.cancel()}onTargetMouseMove(s){this.triggerEvent=s}startAutoRepeat(){const s=this;s.interval=s.startInterval=1e3/s.startRate,s.accelerationDelta=s.startInterval-1e3/s.endRate,s.fireClick(),s.acceleration=re.animate(s.accelerateDuration,s.nextTick,s,"easeOutQuad")}nextTick(s){this.interval=this.startInterval-this.accelerationDelta*s}fireClick(){const s=this,e=new MouseEvent("click",s.triggerEvent);s.triggerEvent.target.dispatchEvent(e),s.repeatTimer=s.setTimeout(s.fireClick,s.interval)}};hr._$name="ClickRepeater";var rd=/^(?:undefined|null|LEFT|RIGHT)$/,sd={TOP:"BOTTOM",RIGHT:"LEFT",BOTTOM:"TOP",LEFT:"RIGHT"},ya=s=>{const e=s==null?void 0:s.toUpperCase();return[e,e==="LEFT"||e==="RIGHT"]},xs=s=>{var e;return e=class extends(s||R){static get configurable(){return{rotate:null,invertRotate:null}}compose(){const{rotate:t}=this;return{class:{[`b-rotate-${(t||"").toLowerCase()}`]:t,"b-rotate-vertical":t}}}syncRotationToDock(t){if(rd.test(String(this.rotate))){const[i,r]=ya(t);this.rotate=r?this.invertRotate?sd[i]:i:null}}get widgetClass(){return null}},x(e,"$name","Rotatable"),e},St=class extends N.mixin(xs){compose(){const{align:s,href:e}=this;return{tag:e!=null?"a":"button",class:{[`b-align-${s||"end"}`]:1,"b-icon":1},listeners:{click:"onInternalClick"}}}get focusElement(){return this.element}get panel(){var s,e;if((s=this.parent)!=null&&s.isPanel&&((e=this.element)!=null&&e.parentNode.matches(".b-panel-header")))return this.parent}changeAlign(s){return s}onInternalClick(s){const e=this,{handler:t,panel:i}=e,r={domEvent:s,tool:e};e.disabled||(e.trigger("click",r),e.isDestroyed||(e.trigger("action",r),!e.isDestroyed&&(i==null?void 0:i.trigger("toolClick",r))!==!1&&t&&e.callback(t,i,[s,i,e])))}onInternalKeyDown(s){(s.key.trim()||s.code)==="Enter"&&(s.cancelBubble=!0,s.stopPropagation())}updateDisabled(s,e){var t;super.updateDisabled(s,e),s&&((t=this.repeat)==null||t.cancel())}changeRepeat(s,e){return e==null||e.destroy(),s&&hr.new({element:this.element},s)}};x(St,"$name","Tool"),x(St,"type","tool"),x(St,"configurable",{align:{value:null,$config:{merge:"replace"}},href:null,repeat:null,defaultBindProperty:null}),St.initClass(),St._$name="Tool";var nd=/right/i,ld=s=>(s.collapsed||s.collapsing)&&s.owner.expandedHeaderDock==="top"&&s.owner.collapsible.direction.match(nd)?"start":"end",Di=class extends St{static get configurable(){return{autoAlign:!0,collapsed:null,collapsing:null,collapsify:!1,direction:"up",defaultBindProperty:null}}compose(){const{collapsed:s,direction:e}=this;return{class:{[`b-icon-collapse-${e}`]:1,"b-collapsed":s}}}changeAutoAlign(s){return s===!0?ld:s}syncAutoAlign(){const{autoAlign:s}=this;s&&(this.align=s(this))}updateAutoAlign(){this.syncAutoAlign()}updateCollapsed(){this.syncAutoAlign()}updateCollapsing(){this.syncAutoAlign()}updateDirection(){this.syncAutoAlign()}};x(Di,"$name","CollapseTool"),x(Di,"type","collapsetool"),Di.initClass(),Di._$name="CollapseTool";var va=/^(?:UP|DOWN|LEFT|RIGHT)$/,ad=/^(left|top)$/i,od={},ba=/^b-dock-(top|left|right|bottom)$/,Ds="b-panel-collapse-revealer",ud=/^(?:left|right)$/i,gr="b-collapse-unflex",{round:at}=Math,Ca=["up","down","left","right"].reduce((s,e)=>(s[e.toUpperCase()]=s[e]=e,s),{}),_s={top:["top","bottom"],right:["right","left"],bottom:["bottom","top"],left:["left","right"]},cd={hl:"LEFT",hr:"RIGHT",vb:"DOWN",vt:"UP"},dd={h:"w",w:"h"},wa={up:"top",right:"right",down:"bottom",left:"left"},pr={top:!1,right:!0,bottom:!1,left:!0},fd={top:"UP",right:"RIGHT",bottom:"DOWN",left:"LEFT"},Sa={top:s=>`translate(0, -${at(s.height||0)}px)`,bottom:s=>`translate(0, ${at(s.height||0)}px)`,right:s=>`translate(${at(s.width||0)}px, 0)`,left:s=>`translate(-${at(s.width||0)}px, 0)`},hd=0,Et=class extends R.mixin(Vt){static get configurable(){return{animation:{duration:200},collapsed:{value:null,$config:null,default:!1},direction:null,collapseTooltip:"L{Collapse}",expandTooltip:"L{Expand}",panel:{value:null,$config:"nullify"},supportAxis:null,tool:{type:"collapsetool",handler(s){var e;(e=this.collapsible)==null||e.onCollapseClick(s)}}}}static get factoryable(){return{defaultType:"inline"}}get collapsing(){return this.collapsingExpanding==="collapsing"}get collapsingExpanding(){var s;const e=(s=this.currentOperation)==null?void 0:s.collapsing;return e==null?null:e?"collapsing":"expanding"}get currentDock(){var s,e,t,i;return(i=(t=(e=(s=this.panel)==null?void 0:s.header)==null?void 0:e.dock)==null?void 0:t.toLowerCase())!=null?i:"top"}get expanding(){return this.collapsingExpanding==="expanding"}get collapseTool(){var s,e;return(e=(s=this.panel)==null?void 0:s.tools)==null?void 0:e.collapse}get collapseDim(){return ud.test(this.collapseDir)?"width":"height"}getCollapseDir(s){var e;let{direction:t,panel:i}=this;if(!t||va.test(t)){const r=i==null?void 0:i.placement;r?t=cd[r]:t=fd[((e=i==null?void 0:i.header)==null?void 0:e.dock)||"top"]}return s?Ca[t]:t}get collapseDir(){return this.getCollapseDir(!0)}get collapseDock(){return this.collapseInfo[0]}get collapseInfo(){const{panel:s}=this,e=s.hasHeader&&s.expandedHeaderDock;let t=wa[this.collapseDir],i=!1;return e&&((i=pr[t]!==pr[e])||(t=e)),[t,i]}get toolsConfig(){const{direction:s,tool:e}=this;return e&&{collapse:w.assign({direction:s.toLowerCase()},e)}}beforeCollapse(s){const{panel:e}=this,{element:t}=e;t.contains(v.getActiveElement(t))&&e.revertFocus(!0)}changeTool(s){const e=this,{panel:t}=e;if(e.isConfiguring||e.isDestroying||!t||t.isDestroying)return s;t.tools={collapse:s}}collapse(s){var e,t;const i=this,{panel:r}=i,n={id:++hd,completed:!1,panel:r};let{currentOperation:l}=i;return s=s!=null?s:!0,w.isObject(s)&&(n.collapsed=!0,w.assign(n,s),s=n.collapsed,delete n.collapsed),n.collapsing=s,n.previous=l!=null?l:null,s!==i.collapsed?l?l.collapsing!==s&&(n.animation=l.animation.revert({finalize(){var a;(a=i.collapseFinalize)==null||a.call(i,n,!0)}}),n.collapsing=s,l=n):(n.animation=w.clone(("animation"in n?n:i).animation),i.beforeCollapse(n)!==!1&&(n.animation&&(n.animation.finalize=a=>{var o;return(o=i.collapseFinalize)==null?void 0:o.call(i,n,a)}),r.changingCollapse=!0,i[s?"collapseBegin":"expandBegin"](n),n.animation?l=n:(n.completed=!0,i[s?"collapseEnd":"expandEnd"](n)),r.changingCollapse=!1,n.animation||i.onComplete(s?"collapse":"expand"))):l&&l.collapsing!==s&&(i[s?"expandRevert":"collapseRevert"](n),n.animation=l.animation.revert({finalize(){var a;(a=i.collapseFinalize)==null||a.call(i,n,!1)}}),l=n),i.currentOperation=l,(t=(e=l==null?void 0:l.animation)==null?void 0:e.done())!=null?t:Promise.resolve(s===i.collapsed)}collapseFinalize(s,e){const t=this,{currentOperation:i,panel:r}=t,n=r.collapsed?"expand":"collapse";i===s&&(t.currentOperation=null,s.completed=e,r.changingCollapse=!0,t[n+"End"](s),r.changingCollapse=!1,e&&t.onComplete(n))}applyHeaderDock(s,e=!0){const t=this,{currentDock:i,panel:r}=t,n=s?t.collapseDock:r.expandedHeaderDock;n!==i&&r.hasHeader&&(r.header={dock:n},e&&r.recompose.flush())}composeHeader(s){const{panel:e}=this,{class:t}=s,i=e.expandedHeaderDock||Object.keys(t).filter(r=>t[r]&&ba.test(r)).map(r=>ba.exec(r)[1][0]);return t[Ds]=1,t[`b-collapsible-${i[0]}${this.collapseDir[0]}`]=1,s}composeTitle(s){return s.class[Ds]=1,s}collapseBegin(s){var e;const t=this,{animation:i}=s,{collapseDim:r,collapseTool:n,panel:l}=t,{element:a,placement:o}=l,[u,c]=t.collapseInfo,d=n==null?void 0:n.element.classList,f=!o||o[0]==="h"&&r==="width"||o[0]==="v"&&r==="height";t.configuredWidth=l._lastWidth,t.configuredHeight=l._lastHeight,t.transverseCollapse=c,t.applyHeaderDock(!0);const g=l.rectangle(),h=t.lockInnerSize().moveTo(0,0),p=h.clone(),m=_s[u],y=(e=l.headerElement)==null?void 0:e.getBoundingClientRect(),b=at((y==null?void 0:y[r])||0);a.classList.toggle(gr,f),i?(p[m[0]]=p[m[1]],a.classList.add("b-collapsing"),d==null||d.add("b-collapsed","b-collapsing"),n&&(n.collapsing=!0),d&&(d.remove("b-collapsed"),l.rectangle(),d.remove("b-collapsing"),d.add("b-collapsed")),i.element=a,i.retain=!0,i[r]={from:at(g[r]),to:b},i.items=[{element:t.innerElement,retain:!1,clip:{from:`rect(${h})`,to:`rect(${p})`}}],c&&i.items.push({element:l.headerElement,duration:i.duration,retain:!1,transform:{from:Sa[u](y),to:"translate(0, 0)"}}),s.animation=Se.run(i)):(a.style[r]=`${b}px`,n&&(d.add("b-collapsing","b-collapsed"),n.rectangle(),d.remove("b-collapsing")))}collapseEnd(s){const e=this,{collapseTool:t}=e;e.panel.element.classList.remove("b-collapsing"),t&&(t.collapsing=!1),s.completed?e.collapsed=!0:(e.applyHeaderDock(!1),e.restoreConfiguredSize(),e.lockInnerSize(!1))}collapseRevert(s){var e;(e=this.collapseTool)==null||e.element.classList.remove("b-collapsed")}expandBegin(s){const e=this,{animation:t}=s,{collapseDim:i,collapseTool:r,panel:n}=e,[l,a]=e.collapseInfo,{element:o}=n,u=o.classList,c=u.contains(gr),d=n.rectangle();u.remove("b-collapsed","b-collapsing"),n.element.style[i]="",e.restoreConfiguredSize(),e.lockInnerSize(!1);const f=n.rectangle(),g=e.lockInnerSize().moveTo(0,0),h=g.clone(),p=_s[e.collapseDock];r==null||r.element.classList.remove("b-collapsed"),t&&(h[p[0]]=h[p[1]],u.add("b-collapsed","b-expanding"),c&&u.add(gr),t.element=o,t[i]={from:at(d[i]),to:at(f[i])},t.items=[{element:e.innerElement,retain:!1,clip:{from:`rect(${h})`,to:`rect(${g})`}}],a&&t.items.push({element:n.headerElement,duration:t.duration,retain:!1,transform:{from:"translate(0, 0)",to:Sa[l](d)}}),s.animation=Se.run(t))}expandEnd(s){const e=this;e.panel.element.classList.remove("b-expanding"),s.completed&&(e.collapsed=!1,e.applyHeaderDock(!1),e.restoreConfiguredSize(),e.lockInnerSize(!1))}expandRevert(s){var e;(e=this.collapseTool)==null||e.element.classList.add("b-collapsed")}get innerElement(){return this.panel.collapseWrapElement||this.panel.bodyWrapElement}get innerSizeElement(){return this.transverseCollapse?this.panel.element:this.innerElement}get supportAxis(){let{_supportAxis:s}=this;const e=s===!0;return(e||s==null)&&(s=this.collapseDim[0],(e||v.getStyleValue(this.panel.element,"position")==="absolute")&&(s+=dd[s])),s||""}lockInnerSize(s=!0){const e=this,{innerElement:t,panel:i}=e,r=s?e.supportAxis:"",n=i.element,l=i.headerElement,a=s&&l&&K.from(l,n),o=s&&K.from(e.innerSizeElement,n),u=t.style;return l&&(l.style.minWidth=r.includes("w")?`${a.width}px`:"",l.style.minHeight=r.includes("h")?`${a.height}px`:""),u.width=s?`${o.width}px`:"",u.height=s?`${o.height}px`:"",t.classList[s?"add":"remove"]("b-panel-collapse-size-locker"),o}onCollapseClick(s){let e=this.collapsing?!1:this.expanding?!0:!this.collapsed;s.altKey&&(e={animation:null,collapsed:e}),this.collapse(e)}onComplete(s){var e;(e=this.panel)==null||e.trigger(s)}onHeaderClick({event:s}){s.button===0&&this.panel.collapsed&&s.target.classList.contains(Ds)&&this.onRevealerClick()}onPanelConfigChange({name:s,value:e}){const t=this,{panel:i}=t;s==="collapsed"?i.isPainted&&(t.collapsed=e):s==="header"&&!i.changingCollapse&&t.syncDirection()}onPanelPaint(){this.syncDirection(),this.panel.collapsed&&!this.collapsed&&this.collapse({animation:null,collapsed:!0})}onRevealerClick(){this.panel._collapse({collapsed:!1})}restoreConfiguredSize(s){const{configuredHeight:e,configuredWidth:t,panel:i}=this;s=s!=null?s:"wh",i.element.classList.remove(gr),t!=null&&s.includes("w")&&(i.width=t),e!=null&&s.includes("h")&&(i.height=e)}splitHeaderItems({as:s,dock:e}=od){var t;return(t=this.panel)==null?void 0:t.splitHeaderItems({as:s,dock:e,alt:!0})}syncDirection(){const s=this,{direction:e}=s;(!e||va.test(e))&&(s.direction=s.getCollapseDir())}changeCollapsed(s){return!!s}updateCollapsed(s){const{collapseTool:e,panel:t}=this;t&&(t.collapsed=s,t.element.classList[s?"add":"remove"]("b-collapsed")),e&&(e.collapsed=s)}updateDirection(s){const{collapseTool:e,panel:t}=this;e&&(e.direction=Ca[s]),t!=null&&t.rendered&&t.recompose()}updatePanel(s){var e;const t=this;t.syncDirection(),(e=t.panelChangeDetacher)==null||e.call(t),t.panelChangeDetacher=s&&re.after(s,"onConfigChange","onPanelConfigChange",t,{return:!1})}wrapCollapser(s,e){var t;const i=this,[r,n]=i.collapseInfo;if(!n)return[s,e];const{collapseDir:l,panel:a}=i,{expandedHeaderDock:o,header:u,uiClassList:c}=a,d=(t=a.tools)==null?void 0:t.recollapse,[f,g]=i.splitHeaderItems({as:"element",dock:r}),h=a.hasHeader?a.title||(u==null?void 0:u.title)||"\xA0":null,p=h&&{tag:"header",class:new Z({...c,[`b-dock-${o}`]:1,"b-panel-header":1,"b-panel-collapser-header":1},u==null?void 0:u.cls),children:[...f,{reference:"collapserTitleElement",html:h,class:{...c,[`b-align-${(u==null?void 0:u.titleAlign)||"start"}`]:1,"b-header-title":1}},...g]};return d&&(d.direction=l),["collapseWrapElement",{class:{...c,[`b-panel-collapser-header-${o}`]:1,[`b-panel-collapser-${l}`]:1,[`b-${pr[o]?"h":"v"}box`]:1,"b-panel-collapser":1,"b-box-center":1},children:ad.test(o)?{collapserHeaderElement:p,[s]:e}:{[s]:e,collapserHeaderElement:p}}]}};x(Et,"$name","PanelCollapser"),x(Et,"type","inline"),Et.maps={clipByDock:_s,dockByDirection:wa,dockIsHorz:pr},Et.initClass(),Et._$name="PanelCollapser";var _i=Symbol("pendingCreate"),Ut=class extends R{static get prototypeProperties(){return{cleanup:null,configName:null,created:null,factory:null,inferType:"name",owner:null,ownerName:null,proxyable:typeof Proxy!="undefined",setup:null,transform:null}}static get properties(){return{defaults:{},instances:{},object:Object.create({})}}get proxy(){const s=this;let e=null;return s.proxyable&&(e=new Proxy(s.instances,{get(t,i){return s.get(i)},set(t,i,r){return s.set(i,r),!0},deleteProperty(t,i){return s.set(i,null),!0}})),Reflect.defineProperty(s,"proxy",{configurable:!0,value:e}),e}get target(){return this.proxy||this.object}define(s,e){const t=this,{transform:i}=t,r=i?i(e,s):e,n=w.isInstantiated(r);t.instances[s]=_i,n||t.setDefaults(s,r),t.defineProp(s,!0),n&&t.set(s,r)}defineProp(s,e){const t=this,{object:i}=t;t.proxy||Reflect.defineProperty(e?Object.getPrototypeOf(i):i,s,{configurable:!e,enumerable:!0,get(){return t.get(s)},set(r){return t.set(s,r)}})}flush(){var s;const e=this;try{e.updating=!0;for(const t in e.defaults)e.get(t);e.afterConfigureOwner=(s=e.afterConfigureOwner)==null?void 0:s.call(e)}finally{e.updating=!1}}get(s){const{defaults:e,instances:t}=this;return t[s]===_i&&this.set(s,_i),t[s]||e[s]&&null}set(s,e){var t;const i=this,{cleanup:r,configName:n,defaults:l,factory:a,instances:o,owner:u,setup:c,transform:d,updating:f}=i,g=u&&n&&!f,h=o[s]===_i?null:o[s],p=a.reconfigure(h,e===_i?{}:e||null,{cleanup:r&&(m=>r(m,s)),defaults:l[s]||i.setDefaults(s,{}),owner:i.owner,setup:c&&((m,y,b)=>c(m,s,y,b)),transform:d&&(m=>d(m,s))});if(p!==h){const m=g&&{...o};o[s]=p,p?(i.defineProp(s),(t=i.created)==null||t.call(i,p,s)):(delete i.object[s],delete o[s]),g&&u.onConfigChange({name:n,config:u.$meta.configs[n],value:i.target,was:m})}}setDefaults(s,e){const{defaults:t,factory:i,inferType:r,instances:n,owner:l,ownerName:a}=this,{typeKey:o}=i.factoryable;return e=e===!0?{}:w.assign({},e),(r==="name"||r===!0&&!e[o])&&(e[o]=s),a&&(e[a]=l),e.beforeConfigure=u=>{n[s]=u},t[s]=e}update(s){const e=this,{owner:t}=e;let i,r;try{if(e.updating=!0,s)for(i in s)r=s[i],e.defaults[i]?e.set(i,r):r&&e.define(i,r);else for(i in e.instances)e.set(i,null)}finally{e.updating=!1}t&&(t.isConfiguring?e.afterConfigureOwner||(e.afterConfigureOwner=re.before(t,"afterConfigure","flush",e)):e.flush())}};Ut.initClass(),Ut._$name="DynamicObject";var gd=[],Ms={},pd={align:1,weight:1},Is=s=>{var e;return e=class extends(s||N){static get configurable(){return{tools:{value:null,$config:{nullify:!0}},toolDefaults:{"*":{type:"tool",align:"end"}}}}byWeightSortFn(t,i){return(t.weight||0)-(i.weight||0)}byWeightReverseSortFn(t,i){return(i.weight||0)-(t.weight||0)}gatherTools({align:t,alt:i,refs:r}=Ms){var n,l,a;const{collapsed:o,tools:u}=this,c={collapsed:o,alt:i};let d=[],f,g,h,p,m;for(g in u)m=u[g],f=(a=(l=(n=m==null?void 0:m.align)==null?void 0:n.align)!=null?l:m==null?void 0:m.align)!=null?a:"end",f===t&&m.isCollapsified(c)&&d.push(m);if(d.sort(this[t==="end"?"byWeightReverseSortFn":"byWeightSortFn"]),r){const y=r==="widget",b={};for(h=0;h<d.length;++h)p=d[h],b[p.ref]=y?p:p.element;d=b}return d}getEndTools({alt:t,refs:i}=Ms){return this.gatherTools({align:"end",alt:t,refs:i})}getStartTools({alt:t,refs:i}=Ms){return this.gatherTools({align:"start",alt:t,refs:i})}get childItems(){return[...this.getStartTools(),...this._items||gd,...this.getEndTools()]}changeTools(t,i){const r=this,n=r.$tools||(r.$tools=new Ut({configName:"tools",factory:N,inferType:!1,owner:r,created(l){var a,o;l.innerItem=!1,(o=l.syncRotationToDock)==null||o.call(l,(a=r.header)==null?void 0:a.dock),re.after(l,"onConfigChange",(u,{name:c})=>{pd[c]&&r.onConfigChange({name:"tools",value:n.target})}),r.onChildAdd(l)},setup(l,a){return l=w.merge({},r.toolDefaults["*"],r.toolDefaults[a],l),l.parent=r,l.ref=a,l}}));if(n.update(t),!i)return n.target}get widgetClass(){}},x(e,"$name","Toolable"),e},Os=s=>{var e;return e=class extends(s||R){static get configurable(){return{badge:null}}compose(){const{badge:t}=this;return{dataset:{badge:t},class:{"b-badge":t!=null&&t!==""}}}},x(e,"$name","Badge"),e},Ea=/(?:^|\s)b-icon-/,Ta=/(?:^|\s)b-fa-/,xa=Symbol("defaultToggleable"),md=["items","type","widgets","html","listeners"],Da=Symbol("defaultListener"),Mi=class extends N.mixin(Os,xs){static get configurable(){return{icon:null,menuIcon:"b-icon-picker",pressedIcon:null,iconAlign:"start",behaviorType:"button",text:{value:null,$config:null,default:""},color:null,toggleable:xa,pressed:!1,toggleGroup:null,supportsPressedClick:!1,ripple:{radius:75},forwardTwinEvents:["action","toggle"],localizableProperties:["text"],menu:{$config:["lazy","nullify"],value:null},menuDefaults:{type:"menu",autoShow:!1,autoClose:!0,floating:!0,scrollAction:"realign",align:"t0-b0"},href:null,target:null,defaultBindProperty:null}}updateElement(s,e){var t,i,r;const n=this,{constructor:l}=n,a=super.updateElement(s,e),o=n.peekConfig("menu"),u=o?o.isWidget?o.role:((i=(t=l.resolveType(o.type))==null?void 0:t.configurable)==null?void 0:i.role)||((r=l.configurable.menuDefaults)==null?void 0:r.type)||"menu":!1;return n.ariaHasPopup=u,a}compose(){const{color:s,href:e,icon:t,iconAlign:i,pressed:r,pressedIcon:n,target:l,text:a,toggleable:o,toggleGroup:u,menuIcon:c,behaviorType:d}=this,f=this.hasConfig("menu"),g=r&&n?n:t;return{tag:e?"a":"button",href:e,target:l,type:d,class:{[`b-icon-align-${i}`]:t,[s]:!!s,"b-pressed":r&&o,"b-text":!!a,"b-has-menu":f},[o&&!f?"aria-pressed":""]:r,dataset:{group:u},listeners:{click:"onInternalClick",mousedown:"onInternalMousedown"},children:{iconElement:(t||n)&&{"aria-hidden":!0,tag:"i",class:{...Z.normalize(g,"object"),"b-icon":Ea.test(g),"b-fa":Ta.test(g)}},label:a&&{tag:"label",for:this.id,text:a},menuIconElement:f&&c&&{tag:"i",class:{"b-icon":Ea.test(c),"b-fa":Ta.test(c),"b-button-menu-icon":1,[c]:1}}}}}configureOverflowTwin(s){const e=this,t=super.configureOverflowTwin(s);return t.text||(t.text=e.text||e.tooltipText),t}onHide(){var s;(s=this._menu)==null||s.hide()}get childItems(){return this._menu&&[this.menu]}onFocusOut(s){var e;super.onFocusOut(s),(e=this.menu)==null||e.hide()}get focusElement(){return this.element}changeText(s){return s==null?"":s}changeToggleable(s){return s===xa?this.toggleGroup||this.config.menu:s}changeMenu(s,e){const t=this,{element:i}=t;return s?(s.isWidget?(s.forElement=i,s.owner=t,s.constrainTo=t.rootElement):(typeof s=="object"&&!md.some(r=>r in s)&&(s={lazyItems:s}),s=N.reconfigure(e,s?w.merge({owner:t,constrainTo:t.rootElement,forElement:i},t.menuDefaults,s):null,t)),s.align.constrainPadding=10,t.detachListeners(Da),s.ion({name:Da,beforeShow:"onMenuBeforeShow",hide:"onMenuHide",show:"onMenuShow",thisObj:this})):e==null||e.destroy(),s}onMenuBeforeShow({source:s}){return this.trigger("beforeShowMenu",{menu:s})}onMenuShow(){this.ariaElement.setAttribute("aria-expanded",!0)}onMenuHide(){this.ariaElement.setAttribute("aria-expanded",!1),this.toggle(!1)}updateMenu(s){this.toggleable=!!s}updatePressed(s){var e,t;const i=this;if(!i.toggleable||i.isConfiguring)return;const{menu:r}=i;s&&v.forEachSelector(i.rootElement,`button[data-group=${i.toggleGroup}]`,n=>{n!==i.element&&(N.getById(n.id).pressed=!1)}),r&&(r.initialConfig.minWidth||(r.minWidth=i.width),r.align.minHeight=(e=r._minHeight)!=null?e:100,r.align.minWidth=(t=r._minWidth)!=null?t:100,r[s?"show":"hide"]()),i.trigger("toggle",{pressed:s,userAction:i._isUserAction})}onInternalMousedown(s){var e;(e=this._menu)!=null&&e.containsFocus&&this.pressed&&s.preventDefault()}onInternalClick(s){const e=this,t={event:s};e.disabled||(e._isUserAction=!0,!(e.toggleable&&(e.toggleGroup&&e.pressed&&!e.supportsPressedClick||((!e.toggleGroup||!e.pressed)&&e.toggle(!e.pressed),e.isDestroyed)))&&(e.trigger("click",t),e.isDestroyed||e.trigger("action",t),e.href||(s.preventDefault(),s.stopPropagation()),e._isUserAction=!1))}toggle(s=!this.pressed){this.trigger("beforeToggle",{pressed:s,userAction:this._isUserAction})!==!1&&(this.pressed=s)}};x(Mi,"$name","Button"),x(Mi,"type","button"),Mi.initClass(),Mi._$name="Button";var _a=["b-hbox","b-vbox"],yd={name:"align",style:"alignItems"},vd={name:"contentAlign",style:"alignContent"},bd={name:"direction",style:"flexDirection"},Cd={name:"justify",style:"justifyContent",classes:["stretch"]},wd={name:"wrap",style:"flexWrap",map:{false:"nowrap",true:"wrap",reverse:"wrap-reverse"}},Tt=class extends Ue{get vertical(){return this.horizontal===!1}set vertical(s){return this.horizontal=!s}updateAlign(){this.syncConfigStyle(yd)}updateContentAlign(){this.syncConfigStyle(vd)}updateDirection(){this.syncConfigStyle(bd)}updateHorizontal(){var s;const e=this,t=(s=e.contentElement)==null?void 0:s.classList,i=Number(e.vertical);t?(t.remove(_a[1-i]),t.add(_a[i])):e.syncConfigLater("horizontal"),e.syncDirection()}updateJustify(){this.syncConfigStyle(Cd)}updateReverse(){this.syncDirection()}updateWrap(){this.syncConfigStyle(wd)}syncDirection(){const s=this,{reverse:e}=s;s.direction=e?`${s.vertical?"column":"row"}${e?"-reverse":""}`:null}};x(Tt,"$name","Box"),x(Tt,"type","box"),x(Tt,"alias","hbox"),x(Tt,"configurable",{containerCls:"b-box-container",itemCls:"b-box-item",align:null,contentAlign:null,direction:null,horizontal:!0,justify:null,reverse:null,wrap:null}),Tt.initClass(),Tt._$name="Box";var Ii=class extends Tt{};x(Ii,"$name","VBox"),x(Ii,"type","vbox"),x(Ii,"configurable",{horizontal:!1}),Ii.initClass(),Ii._$name="VBox";var Ma={refs:"element"},Sd=s=>s.element.style.margin="",Ed=s=>s.isToolbar,Ia=s=>s[0]+(s[1].minifiable?0:9e9),Oa={hidden:!1,width:""},Td={...Oa,flex:""},xd=[{box:"hbox",clientSizeProp:"clientWidth",edgeProp:"right",flexDir:"row",horizontal:!0,max:"maxX",overflow:"overflowX",pos:"x",scrollSize:"scrollWidth",sizeProp:"width"},{box:"vbox",clientSizeProp:"clientHeight",edgeProp:"bottom",flexDir:"column",horizontal:!1,max:"maxY",overflow:"overflowY",pos:"y",scrollSize:"scrollHeight",sizeProp:"height"}],Dd={delay:0,startRate:40,endRate:200,accelerateDuration:500},_d={menu:1,pressed:1},Fs=class Ga extends qe.mixin(Is){static get delayable(){return{syncOverflowVisibility:{type:"raf",cancelOutstanding:!0}}}static get configurable(){return{defaultType:"button",dock:"top",layout:{type:"box"},overflow:{$config:["lazy","nullify"],value:{type:"menu"}},toolDefaults:{overflowMenuButton:{type:"button",hidden:!0,icon:"b-icon-menu",menuIcon:null,ariaLabel:"Show overflowing items",defaultCls:{"b-overflow-button":1}},overflowScrollEnd:{handler:"up.onEndScrollClick",hidden:!0,defaultCls:{"b-icon-angle-right":1,"b-overflow-button":1,"b-icon":1}},overflowScrollStart:{align:"start",handler:"up.onStartScrollClick",hidden:!0,defaultCls:{"b-icon-angle-left":1,"b-overflow-button":1,"b-icon":1}}},widgetCls:null,ignoreParentReadOnly:!0}}static get prototypeProperties(){return{flexRowCls:"b-hbox",flexColCls:"b-vbox"}}static getEvictionList(e){const t=e.filter(i=>i.overflowable!=="none");return t.forEach((i,r)=>t[r]=[r,i]),t.sort((i,r)=>Ia(r)-Ia(i)),t}compose(){const e=this,{axisProps:t,dock:i}=e,r=e.getEndTools(Ma),n=e.getStartTools(Ma);return{class:{[`b-dock-${i}`]:1,[`b-${i}-toolbar`]:1,[`b-${t.box}`]:1},children:{...n,toolbarContent:{class:{"b-box-center":1,"b-toolbar-content":1}},...r}}}get axisProps(){return xd[this.layout.horizontal?0:1]}get contentElement(){return this.toolbarContent}get overflowMenuButton(){var e;return(e=this.tools)==null?void 0:e.overflowMenuButton}get overflowType(){const{overflow:e}=this;return typeof e=="string"?e:e==null?void 0:e.type}onChildAdd(e){var t;super.onChildAdd(e),this.processAddedLeafItem(e),(t=e.syncRotationToDock)==null||t.call(e,this.dock)}onChildRemove(e){super.onChildRemove(e),this.syncOverflowVisibility()}processAddedLeafItem(e){re.after(e,"onConfigChange",this.onLeafItemConfigChange,e),e.isContainer&&e.eachWidget(t=>this.processAddedLeafItem(t))}onInternalPaint({firstPaint:e}){var t;(t=super.onInternalPaint)==null||t.call(this,...arguments),e&&this.getConfig("overflow")}updateDock(e){var t;const i=this,{layout:r}=i,{vertical:n}=r;if(r.vertical=ya(e)[1],!i.initialItems){n!==r.vertical&&i.updateOverflow(i.overflow);for(const l of i.childItems)(t=l.syncRotationToDock)==null||t.call(l,e)}}updateOverflow(e,t){var i,r;const n=this,{axisProps:l,contentElement:a,overflowType:o}=n,{flexDir:u}=l,c=(i=n.overflowMenuButton)==null?void 0:i._menu,d={};if(c&&(e?c==null||c.removeAll():c.eachWidget(f=>{f._overflowTwinOrigin.overflowTwin=null})),t==="menu"?d.overflowMenuButton=null:t==="scroll"&&(d.overflowScrollStart=d.overflowScrollEnd=null),o==="menu")(r=n.scrollable)==null||r.destroy(),a.style.overflow=a.style.overflowX=a.style.overflowY="",d.overflowMenuButton={cls:{[`b-${u}-menu`]:1}};else if(o==="scroll"){const f=typeof e=="object"&&(e==null?void 0:e.repeat)||Dd;n.scrollable={[l.overflow]:"hidden-scroll",element:a,internalListeners:{scroll:"onContentScroll",thisObj:n}},d.overflowScrollStart={repeat:f,invertRotate:!0,cls:{[`b-${u}-start-scroller`]:1}},d.overflowScrollEnd={repeat:f,invertRotate:!0,cls:{[`b-${u}-end-scroller`]:1}}}n.tools=d,o?(a.classList.add("b-overflow"),n.monitorResize=!0,n.syncOverflowVisibility()):(a.classList.remove("b-overflow"),n.monitorResize=!1)}onContentScroll(){this.syncScrollerState()}onStartScrollClick(){this.scrollable[this.axisProps.pos]-=2}onEndScrollClick(){this.scrollable[this.axisProps.pos]+=2}onInternalResize(){super.onInternalResize(...arguments),this.isPainted&&this.syncOverflowVisibility()}syncOverflowVisibility(){const e=this,{overflowType:t,contentElement:i,isVisible:r}=e,{clientSizeProp:n,edgeProp:l,sizeProp:a}=e.axisProps,{overflowMenuButton:o,overflowScrollStart:u,overflowScrollEnd:c}=e.tools,d=e.rtl&&e.layout.horizontal,f=t==="menu",g=()=>Math.ceil(i[n]+(!u||u.hidden?0:u.rectangle("outer")[a])+(!c||c.hidden?0:c.rectangle("outer")[a])),h=()=>{if(M.length===0)return 0;const P=M[M.length-1].rectangle(i);return Math.floor(d?i[n]-P.left:P[l])};let p,m,y,b,S,C,T,_,L,F,O,M;if(!(!r||!t||e.items.length===0)){if(e.inSyncOverflowVisibility=!0,o==null||o.hide(),e.eachWidget((P,W)=>{T=P.minifiable,F=P.overflowable,F=T?F||T:F,P.floating?W.down=!1:(W.down=!F,P.innerItem&&(P._toolbarOverflow&&(P.hidden=P._toolbarOverflow=!1),P._toolbarMinified&&(P.minified=P._toolbarMinified=!1),P.isVisible&&(T&&(_||(_=[])).push(P),F&&(M||(M=[])).push(P))))}),M&&(p=g(),m=h()),M&&m>p)if(f){for(;m>p&&(S=_==null?void 0:_.pop());)C=m,S._toolbarMinified=!0,S.minified=!0,m=h(),C-=m,(L||(L=[])).push([S,C]);if(m>p){o.show(),p=g(),b=Ga.getEvictionList(M);for(y of b)m>p&&(S=y[1],S._toolbarOverflowWidth=S.width,S._toolbarOverflow=!0,S.hidden=!0,M.splice(M.indexOf(S),1),(O||(O=[])).push(y),m=h());if(O){for(O.sort((P,W)=>P[0]-W[0]).forEach((P,W)=>O[W]=P[1]);L!=null&&L.length;)[S,C]=L.pop(),m+C<=p&&!S._toolbarOverflow&&(m+=C,S.minified=S._toolbarMinified=!1);e.syncOverflowMenuButton(O)}else o.hide()}}else c.show(),u.show(),e.syncScrollerState();else f||(c==null||c.hide(),u==null||u.hide());e.inSyncOverflowVisibility=!1}}syncOverflowMenuButton(e){var t;const i=this,{axisProps:r,overflowMenuButton:n}=i,l={cls:"b-toolbar-overflow-menu",minWidth:280,items:[],align:{align:r.horizontal?"t100-b100":"r100-l100",axisLock:"flexible"}};if(i.addToMenu(l,e.filter(a=>i.overflowItemFilter(a))),(t=n._menu)!=null&&t.isMenu){const a=n.menu,{toAdd:o,toRemove:u}=V.delta(l.items,a.items,1);if(a.remove(u),a.items.length)for(let c=o.length-1;c>=0;c--)a.insert(o[c],0);else a.add(o)}else n.menu=l}syncScrollerState(){const e=this,{axisProps:t,scrollable:i}=e,{overflowScrollStart:r,overflowScrollEnd:n}=e.tools,l=i[t.pos],a=i[t.max];r.disabled=!l,n.disabled=Math.abs(Math.ceil(l))>=Math.abs(a)}overflowItemFilter(e){const{filter:t}=this.overflow;return!!(t?t.call(this,e):v.getChildElementCount(e.element))}addToMenu(e,t){const i=this.horizontal?Td:Oa;for(const r of t){const n=r.ensureOverflowTwin(i,Sd);e.items.push(n)}}onLeafItemConfigChange(e,{name:t,value:i}){const r=this,n=r.up(Ed),l=n.hasConfig("overflow"),{overflowTwin:a}=r;!l||n!=null&&n.inSyncOverflowVisibility||t==="hidden"&&i===r._toolbarOverflow||(a&&!_d[t]&&(a[t]=i),n!=null&&n.isPainted&&r.ref!=="overflowMenuButton"&&(r.isTextField&&t==="value"&&(r.containsFocus||a!=null&&a.containsFocus)||n.syncOverflowVisibility()))}createWidget(e){e==="->"?e={type:"widget",cls:"b-toolbar-fill"}:e==="|"?e={type:"widget",cls:"b-toolbar-separator"}:typeof e=="string"&&(e={type:"widget",cls:"b-toolbar-text",html:e});const t=super.createWidget(e);return this.widgetCls&&t.element.classList.add(this.widgetCls),t}};x(Fs,"$name","Toolbar"),x(Fs,"type","toolbar");var Ls=Fs;Ls.initClass(),Ls._$name="Toolbar";var Md=s=>!s.classList.contains("b-focus-trap")&&v.isFocusable(s)?v.NodeFilter.FILTER_ACCEPT:v.NodeFilter.FILTER_SKIP,ks=[],Id={},Fa=[ks,ks],La=(s,e,t)=>{const{vertical:i}=s;return delete s.vertical,{...s,class:{...e,[`b-${i?"v":"h"}box`]:1,"b-box-center":1,"b-panel-bar-wrap":!t}}},As=(s,e,t=!1)=>{const i={vertical:t,children:s?[s]:[]};return e&&(i.tag=e),i},mr=(s,e)=>{s!=null&&s.classList?s==null||s.classList.add(e):s!=null&&s.class&&(typeof s.class=="string"&&(s.class={[s.class]:1}),s.class[e]=1)},Od={dock:1,hidden:1,weight:1},xt={top:[!0,!0],bottom:[!0,!1],left:[!1,!0],right:[!1,!1]},ka={header:1,"pre-header":1},Ps=class Er extends qe.mixin(ns,Is){static get configurable(){return{localizableProperties:["title"],collapsed:{value:null,$config:null,default:!1},collapsible:{value:null,$config:"nullify"},bodyCls:{$config:{merge:"classList"},value:null},bodyTag:null,bodyWrapTag:null,trapFocus:null,title:null,header:null,stateful:["collapsed"],stripDefaults:{"*":{type:"toolbar",dock:"top"},bbar:{dock:"bottom",weight:-1e3},tbar:{weight:-1e3}},strips:{value:null,$config:"nullify"},toolDefaults:{close:{weight:-1e3},collapse:{weight:-990}},footer:null,revealed:null,tbar:null,bbar:null,role:"region"}}updateElement(e,t){const i=super.updateElement(e,t);return this.titleElement&&v.setAttributes(this.ariaElement,{"aria-describedby":this.titleElement.id}),i}compose(){const e=this,{collapsible:t,focusable:i,hasItems:r,revealed:n,tools:l}=e,a=e.composeHeader(),o=(a==null?void 0:a.class["b-dock-left"])||(a==null?void 0:a.class["b-dock-right"]);let u=e.composeBody(),c="bodyWrapElement";return t&&([c,u]=t.wrapCollapser(c,u)),{tabIndex:r&&i!==!1||i?0:null,class:{[`b-panel-collapsible-${t==null?void 0:t.type}`]:t,[`b-panel-collapse-${t==null?void 0:t.collapseDir}`]:t,[`b-${o?"h":"v"}box`]:1,"b-panel-collapsible":t,"b-panel-has-header":a,"b-panel-has-tools":l?1:0,"b-panel-overlay-revealed":n},children:{topFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1}},headerElement:a,[c]:u,bottomFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1,"b-end-focus-trap":1}}}}}composeBody(){var e,t;const i=this,{bodyCls:r,bodyConfig:n,bodyWrapTag:l,footer:a,uiClassList:o}=i,u=w.values(i.strips,(S,C)=>!xt[C==null?void 0:C.dock]).sort(i.byWeightSortFn),c={top:null,right:null,bottom:null,left:null};let d,f,g,h,p,m,y;for(a&&(g=a.dock||"bottom",u.unshift({dock:g,element:{tag:"footer",reference:"footerElement",html:typeof a=="string"?a:a.html,class:{...o,[`b-dock-${g}`]:1,[`${a.cls||""}`]:1}}})),r&&(n[p="className"]||(p="class"),n[p]=new Z(n[p]).assign(r)),h=u.length;h-- >0;)d=u[h],[m,f]=xt[d.dock],y?y.vertical!==m&&(y=As(La(y,o),"",m)):y=As(n,l,m),y.children[f?"unshift":"push"](d.element),c[d.dock]=d;mr(c.top,"b-innermost"),mr(c.right,"b-innermost"),mr(c.bottom,"b-innermost"),mr(c.left,"b-innermost");const b=La(y||As(n,l),o,!0);return b.class[`${(e=i.layout)==null?void 0:e.containerCls}-panel`]=!!((t=i.layout)!=null&&t.containerCls),b.class["b-panel-body-wrap"]=1,b.class[`b-${i.$$name.toLowerCase()}-body-wrap`]=1,b}get hasHeader(){if(this.header===!1)return!1;const{header:e,title:t,tools:i,parent:r}=this,n=this.maximizable||Object.values(i||{}).some(l=>!l.hidden);return e||!(r!=null&&r.suppressChildHeaders)&&(t||n)}get rootUiClass(){return Er}composeHeader(e){var t;const i=this;if(!i.hasHeader&&!e)return;const r=i.header||{},n=r.dock||"top",[l,a]=i.splitHeaderItems({as:"element",dock:n}),o=i.$meta.hierarchy,u=i.composeTitle(r),c=new Z({[`b-dock-${n}`]:1,...i.uiClassList},r.cls);let d,f;for(d=o.indexOf(Er);d<o.length;++d)f=o[d].$$name,f!=="Grid"&&(c[`b-${f.toLowerCase()}-header`]=1);const g={tag:"header",class:c,children:[...l,u,...a]};return((t=i.collapsible)==null?void 0:t.composeHeader(g))||g}composeTitle(e){var t;const i=typeof e=="string"?e:this.title||e.title,r={reference:"titleElement",id:`${this.id}-panel-title`,html:i!=null?i:"\xA0",class:{[`b-align-${e.titleAlign||"start"}`]:1,"b-header-title":1,...this.uiClassList}};return w.isObject(i)&&(delete r.html,w.merge(r,i)),((t=this.collapsible)==null?void 0:t.composeTitle(r))||r}updateTitle(){}afterRecompose(){var e;super.afterRecompose();const t=this,{headerElement:i}=t;(e=t._headerClickDetacher)==null||e.call(t),t._headerClickDetacher=i&&B.on({element:i,click:r=>{var n;return(n=t.trigger)==null?void 0:n.call(t,"headerClick",{event:r})}})}onHeaderClick(e){var t;(t=this.collapsible)==null||t.onHeaderClick(e)}onInternalPaint(){var e;super.onInternalPaint(...arguments),(e=this.collapsible)==null||e.onPanelPaint(this)}splitHeaderItems({as:e,dock:t,alt:i}=Id){var r,n,l,a;const o=this,u=e==="element",{collapsed:c}=o,d=o.getEndTools({alt:i}),f=o.getStartTools({alt:i}),g=w.values(o.strips,(b,S)=>!ka[S==null?void 0:S.dock]&&S.isCollapsified({collapsed:c,alt:i}));let h=Fa,p,m,y;if(g.length+d.length+f.length){for(h=[m=[...f,...g.filter(b=>b.dock==="pre-header").sort(o.byWeightSortFn)],p=[...g.filter(b=>b.dock==="header").sort(o.byWeightReverseSortFn),...d]],y=0;y<m.length;++y)t&&((n=(r=m[y]).syncRotationToDock)==null||n.call(r,t)),u&&(m[y]=m[y].element);for(y=0;y<p.length;++y)t&&((a=(l=p[y]).syncRotationToDock)==null||a.call(l,t)),u&&(p[y]=p[y].element)}return h}set bodyConfig(e){this._bodyConfig=e}get bodyConfig(){const e=this,{bodyTag:t}=e,i=w.merge({reference:"bodyElement",className:{...e.getStaticWidgetClasses(Er,"-content"),"b-box-center":1,"b-text-content":e.textContent&&e.hasNoChildren}},e._bodyConfig);return t&&(i.tag=t),(e.initializingElement||!e._element)&&(i.html=e.content||e._html),i}changeBodyCls(e){return Z.from(e)}changeTbar(e){return this.getConfig("strips"),this.strips={tbar:e},this.strips.tbar}changeBbar(e){return this.getConfig("strips"),this.strips={bbar:e},this.strips.bbar}get childItems(){var e;const t=this,i=w.values(t.strips,(o,u)=>!xt[u==null?void 0:u.dock]).sort(t.byWeightSortFn),[r,n]=t.splitHeaderItems(),[l,a]=((e=t.collapsible)==null?void 0:e.splitHeaderItems())||Fa;return[...r,...l,...n,...a,...i.filter(o=>xt[o.dock][1]),...t._items||ks,...i.filter(o=>!xt[o.dock][1]).reverse()]}changeStrips(e,t){const i=this,r=i.$strips||(i.$strips=new Ut({configName:"strips",factory:N,inferType:!1,owner:i,created(n){var l;const{dock:a}=n;if(!ka[a]&&!xt[a])throw new Error(`Invalid dock value "${a}"; must be: top, left, right, bottom, header, or pre-header`);re.after(n,"onConfigChange",(o,{name:u})=>{Od[u]&&i.onConfigChange({name:"strips",value:r.target})}),n.innerItem=!1,i.onChildAdd(n),n.parent=i,(l=n.layout)==null||l.renderChildren(),n.hasItems&&(i.hasItems=!0)},setup(n,l){return n=w.merge(w.clone(i.stripDefaults["*"]),i.stripDefaults[l],n),n.parent=i,n.ref=l,n},transform(n){return Array.isArray(n)&&(n={items:n}),n||null}}));if(r.update(e),!t)return r.target}get collapsing(){var e;return(e=this.collapsible)==null?void 0:e.collapsing}get collapsingExpanding(){var e;return(e=this.collapsible)==null?void 0:e.collapsingExpanding}get expanding(){var e;return(e=this.collapsible)==null?void 0:e.expanding}changeCollapsed(e){const t=this,{collapsible:i}=t;if(t.recompose.flush(),e=!!e,!i||t.changingCollapse||!t.isPainted)return e;i==null||i.collapse({animation:null,collapsed:e})}changeCollapsible(e,t){const i=this;return i.getConfig("tools"),e&&(e===!0?e={}:typeof e=="string"&&(e={[xt[e]?"direction":"type"]:e})),Et.reconfigure(t,e,{owner:i,defaults:{panel:i},cleanup(){i.collapsed&&(t.collapse({animation:null,collapsed:!1}),i._collapsed=1)}})}updateCollapsible(e){const t=this,i=e==null?void 0:e.toolsConfig;t.tools={collapse:(i==null?void 0:i.collapse)||null,recollapse:(i==null?void 0:i.recollapse)||null},e&&t.isPainted&&t.collapsed&&(t._collapsed=1),t.collapsed===1&&(t.collapsed=!0)}_collapse(e,t){var i;return t!==!0&&t!==void 0&&(t===!1?e.collapsed=!e.collapsed:typeof t=="number"?e.animation={duration:t}:t===null?e.animation=t:t===!0||("animation"in t?w.merge(e,t):e.animation=t)),(i=this.collapsible)==null?void 0:i.collapse(e)}collapse(e){return this._collapse({collapsed:!0},e)}expand(e){return this._collapse({collapsed:!1},e)}toggleCollapsed(e){return this.collapsed?this.expand(e):this.collapse(e)}get expandedHeaderDock(){var e,t,i;return(i=(t=this._expandedHeaderDock)!=null?t:(e=this.initialConfig.header)==null?void 0:e.dock)!=null?i:"top"}set expandedHeaderDock(e){this._expandedHeaderDock=e==null?void 0:e.toLowerCase()}updateHeader(e){this.changingCollapse||(this.expandedHeaderDock=e==null?void 0:e.dock)}updateTrapFocus(e){var t;const i=this;i.element.classList[e?"add":"remove"]("b-focus-trapped"),i.focusTrapListener=(t=i.focusTrapListener)==null?void 0:t.call(i),e&&(i.focusTrapListener=B.on({element:i.element,focusin:"onFocusTrapped",delegate:".b-focus-trap",thisObj:i}),i.treeWalker||(i.treeWalker=this.setupTreeWalker(i.element,v.NodeFilter.SHOW_ELEMENT,Md)))}setupTreeWalker(e,t,i){return document.createTreeWalker(e,t,i)}onFocusTrapped(e){const t=this,i=t.treeWalker;if(e.target===t.bottomFocusTrap)i.currentNode=t.topFocusTrap,i.nextNode();else if(e.target===t.topFocusTrap)i.currentNode=t.bottomFocusTrap,i.previousNode();else return;t.requestAnimationFrame(()=>i.currentNode.focus())}get focusElement(){return this.hasItems&&(super.focusElement||this.element)}get contentElement(){return this.element&&this.bodyElement}get widgetClassList(){var e;const t=this,i=super.widgetClassList;return t.hasHeader&&i.push("b-panel-has-header",`b-header-dock-${((e=t.header)==null?void 0:e.dock)||"top"}`),t.tbar&&i.push("b-panel-has-top-toolbar"),t.bbar&&i.push("b-panel-has-bottom-toolbar"),i}};x(Ps,"$name","Panel"),x(Ps,"type","panel");var yr=Ps;yr.initClass(),yr._$name="Panel";var Rs=class kt extends yr{static get configurable(){return{autoShow:!0,autoClose:!0,showOnClick:!1,forElement:null,monitorResize:!0,floating:!0,hidden:!0,axisLock:!0,hideAnimation:{opacity:{from:1,to:0,duration:".3s",delay:"0s"}},showAnimation:{opacity:{from:0,to:1,duration:".4s",delay:"0s"}},stripDefaults:{bbar:{layout:{justify:"flex-end"}}},testConfig:{hideAnimation:null,showAnimation:null},closeAction:"hide",trapFocus:!0,focusOnToFront:!0,closable:null,maximizable:null,modal:null,maximized:null,tools:{close:{cls:"b-popup-close",handler:"close",weight:-1e3,ariaLabel:"L{Popup.close}",hidden:!0},maximize:{cls:"b-popup-expand",handler:"toggleMaximized",weight:-999,hidden:!0}},highlightReturnedFocus:!0,role:"dialog"}}finalizeInit(){const e=this,{forElement:t}=e;e.anchoredTo=t,e.initialAnchor=e.anchor,t&&e.showOnClick&&(e.initialConfig.autoShow||(e.autoShow=!1),B.on({element:t,click:"onElementUserAction",thisObj:e})),super.finalizeInit(),e.autoShow&&(!t||v.isVisible(t))&&(e.autoShow===!0?e.show():e.setTimeout(()=>e.show(),e.autoShow))}onInternalPaint({firstPaint:e}){var t;(t=super.onInternalPaint)==null||t.call(this,...arguments);const i=this;e&&i.headerElement&&B.on({element:i.headerElement,dblclick:i.onHeaderDblClick,thisObj:i})}doDestroy(){this.syncModalMask(),super.doDestroy()}compose(){const{hasNoChildren:e,textContent:t}=this;return{class:{"b-text-popup":!!(t&&e)}}}close(){const e=this;if(!e._hidden&&e.trigger("beforeClose")!==!1||e._hidden&&e.closeAction==="destroy")return e.modal&&e.closeAction==="destroy"&&e.revertFocus(),e.unmask(),e.containsFocus&&e.highlightReturnedFocus&&e.setTimeout(()=>e.element.classList.add("b-using-keyboard"),0),e[e.closeAction]()}toggleMaximized(){this.maximized=!this.maximized}updateMaximized(e){v.toggleClasses(this.element,["b-maximized"],e)}onInternalKeyDown(e){const t=this;e.key==="Escape"&&(e.stopImmediatePropagation(),t.floating||t.positioned?t.close(!0):t.collapsible&&(t.revealed?t.collapsible.toggleReveal():t.collapse()))}onDocumentMouseDown({event:e}){const t=this,{owner:i}=t,{target:r}=e;if(e.type!=="touchend"&&(i!=null&&i.isButton)&&i._menu===t&&i.element.contains(r))return e.preventDefault(),!1;t.modal&&r===kt.modalMask?(e.preventDefault(),t.modal.closeOnMaskTap?t.close():t.containsFocus||t.focus()):!t.owns(r)&&t.autoClose&&!t.containsFocus&&t.close()}get isTopModal(){return v.isVisible(kt.modalMask)&&this.element.previousElementSibling===kt.modalMask}onFocusIn(e){const t=v.getActiveElement(this);super.onFocusIn(e),v.getActiveElement(this)===t&&e.target===this.element&&this.focus()}onFocusOut(e){!(globalThis.visualViewport&&globalThis.visualViewport.height<document.documentElement.clientHeight-1)&&!this.modal&&this.autoClose&&this.close(),super.onFocusOut(e)}onShow(){var e;const t=this;(t.autoClose||t.modal)&&t.addDocumentMouseDownListener(),t.focusOnToFront&&t.focus(),(e=super.onShow)==null||e.call(this),t.syncModalMask()}addDocumentMouseDownListener(){this.mouseDownRemover||(this.mouseDownRemover=be.ion({globaltap:"onDocumentMouseDown",thisObj:this}))}updateModal(e){e&&(this.floating=!0)}syncModalMask(){const e=this,{modal:t,element:i}=e;if(i.setAttribute("aria-modal",!!t),t&&e.isVisible)typeof e._x!="number"&&typeof e._y!="number"&&(e.centered=!0,e.anchor=!1),e.modalMask.classList.remove("b-hide-display"),e.modalMask.classList.toggle("b-modal-transparent",!!t.transparent),i.classList.add("b-modal");else if(e.isPainted){i.classList.remove("b-modal");const r=e.floatRoot.querySelectorAll(".b-modal"),n=r.length?kt.fromElement(r[r.length-1],"popup"):null;n?n.syncModalMask():kt.modalMask.classList.add("b-hide-display")}}onHide(){var e,t;const i=this;(e=i.mouseDownRemover)==null||e.call(i),i.mouseDownRemover=null,(t=super.onHide)==null||t.call(this),i.syncModalMask()}onElementUserAction(){this.show()}onHeaderDblClick(){this.maximizable&&this.toggleMaximized()}updateClosable(e){this.tools.close.hidden=!e}updateMaximizable(e){this.tools.maximize.hidden=!e}get modalMask(){const{modalMask:e}=kt;return e.nextElementSibling!==this.element&&this.floatRoot.insertBefore(e,this.element),e}static get modalMask(){return this._modalMask||(this._modalMask=v.createElement({className:"b-modal-mask b-hide-display"}),B.on({element:this._modalMask,wheel:e=>e.preventDefault()})),this._modalMask}};x(Rs,"$name","Popup"),x(Rs,"type","popup");var Oi=Rs;Oi.initClass(),Oi._$name="Popup";var Fd={ArrowUp:1,ArrowDown:1,ArrowRight:1,ArrowLeft:1,Enter:1,Escape:1},ot=class extends Oi{static get configurable(){return{layout:"vbox",focusable:!0,align:"t-b",scrollAction:"hide",focusOnHover:null,scrollable:!1,defaultType:"menuitem",tools:{close:!1},role:"menu",ariaElement:"bodyElement"}}construct(s){Array.isArray(s)&&(s={lazyItems:s}),super.construct(s),B.on({element:this.element,click:"onMouseClick",mouseover:"onMouseOver",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",thisObj:this})}afterShow(){const{items:s,element:e}=this;s.some(r=>!!r._menu)&&e.classList.add("b-menu-with-submenu"),s.some(r=>r.icon)&&e.classList.add("b-menu-with-icon"),super.afterShow(...arguments)}createWidget(s){return typeof s=="string"&&(s={text:s}),super.createWidget(s)}get focusElement(){var s;const e=this,t=(s=e.parentMenu)==null?void 0:s.element.contains(v.getActiveElement(e.parentMenu)),i=e.items[0];return t||v.usingKeyboard||!(i instanceof Dt)?super.focusElement:e.element}onDocumentMouseDown({event:s}){if(!this.parentMenu||!this.parentMenu.owns(s.target))return super.onDocumentMouseDown(...arguments)}hide(s){var e,t;const i=this;super.hide(s),i.isVisible||((t=(e=i.currentSubMenu)==null?void 0:e.hide)==null||t.call(e,s),i.parentMenu&&(i.parentMenu.currentSubMenu=null))}show(){super.show(...arguments);const{parentMenu:s}=this;this.isVisible&&s&&(s.currentSubMenu=this)}onMouseClick(s){const e=s.target.closest(".b-menuitem");e&&this.triggerElement(e,s)}onMouseOver(s){var e;if(this.focusOnHover!==!1){const t=(e=s.relatedTarget)==null?void 0:e.closest(".b-widget"),i=s.target.closest(".b-widget"),r=N.fromElement(i);!v.isTouchEvent&&i&&i!==t&&r.parent===this&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[r],cancelOutstanding:!0})}}handleMouseOver(s){s.focus()}onMouseEnter(){this.clearTimeout(this.closeTimer)}onMouseLeave(s){const e=this,{relatedTarget:t}=s,i=t&&e.owns(t);let r=t instanceof HTMLElement&&N.fromElement(t),n=!i;if(r){for(;r.ownerCmp;)r=r.ownerCmp;n&=!v.getAncestor(r.element,[s.target])}!i&&n&&(e.currentSubMenu&&!e.currentSubMenu.closeTimer&&e.currentSubMenu.hide(),e.element.contains(v.getActiveElement(e))&&v.getActiveElement(e).matches(".b-menuitem")&&e.focusElement.focus())}onInternalKeyDown(s){const e=N.fromElement(s),t=e&&e!==this&&!(e instanceof Dt);if(s.key==="Escape"){(t?this:this.rootMenu).close();return}if(super.onInternalKeyDown(s),t)return;Fd[s.key]&&s.preventDefault();const i=this.element,r=v.getActiveElement(i);this.navigateFrom(r!==i&&i.contains(r)?r:null,s.key,s)}navigateFrom(s,e,t){const i=this,{treeWalker:r}=i,n=s&&i.getItem(s),l=i.rtl?"ArrowLeft":"ArrowRight",a=i.rtl?"ArrowRight":"ArrowLeft";let o;switch(e){case"ArrowUp":r.currentNode=s||(s=i.bottomFocusTrap),r.previousNode(),o=r.currentNode;break;case"ArrowDown":r.currentNode=s||(s=i.topFocusTrap),r.nextNode(),o=r.currentNode;break;case" ":s&&!s.classList.contains("b-disabled")&&(n!=null&&n.menu?i.openSubMenu(s,n):i.triggerElement(s,t));break;case l:if(s&&(n!=null&&n.menu)&&!s.classList.contains("b-disabled")){const u=i.openSubMenu(s,n);u==null||u.focus()}else r.currentNode=s||(s=i.topFocusTrap),r.nextNode(),o=r.currentNode;break;case a:i.isSubMenu?i.hide():s||(r.currentNode=s||(s=i.topFocusTrap),r.nextNode(),o=r.currentNode);break;case"Enter":s&&!s.classList.contains("b-disabled")&&i.triggerElement(s,t);break}o&&(o===i.element?i.navigateFrom(i.bottomFocusTrap,"ArrowUp",t):o===s?i.navigateFrom(i.topFocusTrap,"ArrowDown",t):o.focus())}getItem(s){if(s!=null)return typeof s=="number"?this.items[s]:s.nodeType===Element.ELEMENT_NODE?N.fromElement(s,"menuitem",this.contentElement):this.items.find(e=>e.id==s)}triggerElement(s,e){const t=this.getItem(s);t&&!t.disabled&&t.doAction(e)}get isSubMenu(){var s;return this===((s=this.owner)==null?void 0:s.menu)}openSubMenu(s,e){var t;const i=this,r=e.menu;if(r){if(!r.isVisible){const n={item:e,element:s};if(i.trigger("beforeSubMenu",n)===!1||((t=e.onBeforeSubMenu)==null?void 0:t.call(e,n))===!1)return;r.show()}return i.currentSubMenu=r}}set selectedElement(s){const e=this,t=e._selectedElement;if(t){const i=e.getItem(t),r=i==null?void 0:i.menu;r==null||r.hide(),t.classList.remove("b-active")}if(e._selectedElement=s,s){const i=v.isFocusable(s);s.classList.add("b-active"),e.scrollable.scrollIntoView(s,{animate:!i,focus:i})}}get selectedElement(){return this._selectedElement}selectFirst(){const s=this.treeWalker;s.currentNode=this.topFocusTrap,s.nextNode(),this.requestAnimationFrame(()=>s.currentNode.focus())}get parentMenu(){var s;const e=this.owner;return e&&(e.isMenu?e:(s=e.up)==null?void 0:s.call(e,"menu"))}get rootMenu(){let s=this;for(;s.parentMenu instanceof this.constructor;)s=s.parentMenu;return s}};x(ot,"$name","Menu"),x(ot,"type","menu"),ot.initClass(),ot._$name="Menu";var Ld=/^b-icon-/,kd=/^b-fa-/,Dt=class extends N{static get configurable(){return{checked:null,separator:null,toggleGroup:null,menu:{value:null,$config:["lazy","nullify"]},icon:null,closeParent:null,href:null,target:null,localizableProperties:["text"],role:"menuitem",closeMenuDelay:200}}updateElement(s,e){const t=super.updateElement(s,e);return typeof this.checked=="boolean"&&(this.role="menuitemcheckbox"),this.ariaHasPopup=this.hasMenu?"menu":!1,t}compose(){var s;const e=this,{checked:t,href:i,hasMenu:r,separator:n,target:l,text:a,toggleGroup:o}=e,u=typeof t=="boolean",c=e.icon||(u?"b-fw-icon":""),d=`b-icon-${o?"radio-":""}`,f=typeof a=="object";return{tag:i?"a":"div",tabIndex:-1,href:i,target:l,class:{"b-has-submenu":r,"b-checked":t,"b-separator":n||((s=e.cls)==null?void 0:s["b-separator"])},dataset:{group:e.toggleGroup},[u?"aria-checked":""]:t,[r?"aria-expanded":""]:!1,children:{iconElement:c&&{"aria-hidden":!0,tag:"i",class:{"b-fa":kd.test(c),"b-icon":Ld.test(c),"b-menuitem-icon":1,[`${d}checked`]:t===!0,[`${d}unchecked`]:t===!1,...Z.normalize(c,"object")}},textElement:{tag:"span",html:f?null:a,class:{"b-menu-text":1,"b-menu-custom-content":f},children:f?[a]:null},subMenuIcon:r&&{"aria-hidden":!0,tag:"i",class:{"b-fw-icon":1,"b-icon-sub-menu":1}}}}}doAction(s){const e=this,t=this.parent,i={menu:t,item:e,element:e.element,bubbles:!0,domEvent:s};if(typeof e.checked=="boolean"){const r=!e.checked;(!e.toggleGroup||r)&&(e.checked=!e.checked)}else e.href&&s.key&&e.element.click();e.trigger("beforeItem",i),e.trigger("item",i),e.closeParent&&t&&(t.rootMenu.close(),s&&!e.href&&s.preventDefault())}get focusElement(){return this.element}get contentElement(){return this.textElement}get isFocusable(){const{focusElement:s}=this;return s&&this.isVisible&&(s===document.body||s.offsetParent)}get hasMenu(){return this.hasConfig("menu")}get childItems(){const{_menu:s}=this;return s?[s]:[]}get text(){return this.html}set text(s){this.html=s}onFocusIn(s){super.onFocusIn(s),!this.disabled&&this.menu&&this.delay("openMenu",200)}onFocusOut(s){this.clearTimeout("openMenu"),super.onFocusOut(s),this._menu&&(this.menu.closeTimer=this.menu.setTimeout(()=>this.closeMenu(),this.closeMenuDelay))}openMenu(s){const{menu:e}=this;!this.disabled&&e&&(e.focusOnToFront=s,e.show())}onChildShow(s){super.onChildShow(s),this.ariaElement.setAttribute("aria-expanded",!0)}closeMenu(){this._menu instanceof N&&this.menu.close()}onChildHide(s){super.onChildHide(s),this.ariaElement.setAttribute("aria-expanded",!1)}changeToggleGroup(s){return s&&typeof this.checked!="boolean"&&(this.checked=!1),s}changeChecked(s,e){if(this.isConfiguring||typeof e=="boolean")return!!s}updateChecked(s){const e=this;e.isConfiguring||(e.toggleGroup&&e.uncheckToggleGroupMembers(),e.element.setAttribute("aria-checked",s),e.trigger("toggle",{menu:e.owner,item:e,element:e.element,bubbles:!0,checked:s}))}getToggleGroupMembers(){const s=this,{checked:e,toggleGroup:t,element:i}=s,r=[];return e&&t&&v.forEachSelector(s.rootElement,`[data-group=${t}]`,n=>{if(n!==i){const l=N.fromElement(n);l&&r.push(l)}}),r}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach(s=>s.checked=!1)}get closeParent(){return(typeof this.checked=="boolean"?this._closeParent:this._closeParent!==!1)&&!this.hasMenu}changeMenu(s,e){const t=this,{constrainTo:i,scrollAction:r}=t.owner;return s&&typeof s=="object"&&!("items"in s)&&!("widgets"in s)&&!("html"in s)&&(s={lazyItems:s}),ot.reconfigure(e,s,{owner:t,defaults:{type:"menu",align:"s0-e0",anchor:!0,autoClose:!0,autoShow:!1,cls:"b-sub-menu",forElement:t.element,owner:t,ariaLabel:t.text,constrainTo:i,scrollAction:r}})}};x(Dt,"$name","MenuItem"),x(Dt,"type","menuitem"),Dt.initClass(),Dt._$name="MenuItem";var vr,Aa=class extends $t{static get $name(){return"ContextMenuBase"}static get configurable(){return{type:null,menu:{$config:["lazy","nullify"],value:{type:"menu",autoShow:!1,closeAction:"hide",scrollAction:"hide",constrainTo:globalThis}},items:{},triggerEvent:!1,clickTriggerSelector:null,keyMap:{" ":{handler:"showContextMenuByKey",weight:100},"Ctrl+Space":"showContextMenuByKey"}}}static get pluginConfig(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick"]}}construct(...s){var e;if(super.construct(...s),!((e=this.type)!=null&&e.length))throw new Error("Config 'type' is required to be specified for context menu")}onElementContextMenu(s){this.onElementEvent(s)}onElementClick(s){this.onElementEvent(s)}onElementDblClick(s){this.onElementEvent(s)}onElementEvent(s){if(!s.handled&&this.triggerEvent===s.type){if(s.ctrlKey===!0&&!j.isMac){s.preventDefault();return}const e=s;if(vr){const{target:t}=vr;s=B.fixEvent(new MouseEvent(s.type,s)),Object.defineProperty(s,"target",{get:()=>t,configurable:!0}),s.preventDefault=function(){e.preventDefault(),e.handled=!0}}this.internalShowContextMenu(s)}else s.type==="click"&&this.clickTriggerSelector&&s.target.matches(this.clickTriggerSelector)&&this.internalShowContextMenu(s,{align:"l-r",target:s.target})}showContextMenuByKey(s){if(!v.isEditable(s.target)){const e=this.getKeyboardContextMenuTarget(s.target);if(e)return vr=s,v.triggerMouseEvent(e,this.triggerEvent),s.handled=!0,s.preventDefault(),s.stopImmediatePropagation(),vr=null,!0}return!1}getKeyboardContextMenuTarget(s){const e=v.isInView(s);return s.children.length?v.childFromPoint(s,e.width/2,e.height/2):s}internalShowContextMenu(s,e){const t=this;if(t.disabled)return;const i=t.getDataFromEvent(s);!s.handled&&!s.defaultPrevented&&i&&t.shouldShowMenu(i)&&(s.type==="contextmenu"&&j.isSafari&&s.ctrlKey&&!s.metaKey&&B.on({element:s.target,capture:!0,once:!0,thisObj:this,click(r){r.preventDefault(),r.stopImmediatePropagation()}}),i.domEvent=s,t.showContextMenu(i,e))}getDataFromEvent(s){return{event:s,targetElement:this.getTargetElementFromEvent(s)}}getTargetElementFromEvent(s){return s.target}async showContextMenu(s,e){var t,i;const r=this,n=v.isDOMEvent(s),l=n?r.getDataFromEvent(s):s,a=n?s:l.domEvent;if((t=r._menu)==null||t.hide(),r.disabled)return;r.menuContext=l;const{type:o,client:u,processItems:c}=r,d=v.isInView(l.targetElement).center;if($.assign(l,{feature:r,point:a!=null&&a.clientX?[a.clientX+1,a.clientY+1]:[d.x,d.y],menu:r,items:{},selection:u.selectedRecords}),r.callChainablePopulateMenuMethod(l),$.merge(l.items,r.baseItems),r.preventDefaultEvent(l),(!c||await r.callback(c,u,[l])!==!1)&&r.hasActiveMenuItems(l)&&(r.populateItemsWithData(l),r.beforeContextMenuShow(l)!==!1)){const{menu:f}=r;let g=u.trigger(`${o}MenuBeforeShow`,l);w.isPromise(g)&&(a.handled=!0,g=await g),g!==!1&&(f.items=l.items,f.showBy(e||{target:l.domEvent}),(i=r.touchMoveDetacher)==null||i.call(r),r.touchMoveDetacher=B.on({element:u.element,touchmove:()=>f.hide(),thisObj:f,once:!0}),a&&(a.preventDefault(),a.handled=!0))}}get baseItems(){if(!this._baseItems){const s=this,{namedItems:e}=s,t=s._baseItems=$.assign({},s.items);for(const i in t){const r=t[i];r&&(e&&i in e?t[i]=typeof r=="object"?$.merge($.clone(e[i]),r):e[i]:r===!0&&delete t[i])}}return this._baseItems}hideContextMenu(s){var e;(e=this.menu)==null||e.hide(s)}callChainablePopulateMenuMethod(s){var e,t;(t=(e=this.client)[`populate${k.capitalize(this.type)}Menu`])==null||t.call(e,s)}hasActiveMenuItems(s){return Object.values(s.items).some(e=>e&&!e.hidden)}shouldShowMenu(){return!0}beforeContextMenuShow(s){}populateItemsWithData(s){}preventDefaultEvent(s){var e;(e=s.event)==null||e.preventDefault()}changeTriggerEvent(s){return s||this.client.contextMenuTriggerEvent}changeMenu(s,e){const t=this,{client:i,type:r}=t;if(s)return ot.reconfigure(e,s?ot.mergeConfigs({owner:i,rootElement:i.rootElement,onItem(n){i.trigger(`${r}MenuItem`,n)},onToggle(n){i.trigger(`${r}MenuToggleItem`,n)},onDestroy(){t.menu=null},onBeforeItem(n){Object.assign(n,t.menuContext)},onShow({source:n}){t.menuContext.menu=n,i.trigger(`${r}MenuShow`,t.menuContext)}},s):null,t);e!=null&&e.isWidget&&e.destroy()}};Aa._$name="ContextMenuBase";var Pa=/>[ \t\r\n]+</g,Ad=/\s\s+/g,qt=class Xa{static tpl(e,...t){let i=0,r=t.map((n,l)=>{let a=e[l];return Array.isArray(n)?a+=n.reduce((o,u)=>o+=(typeof u=="string"?u.trim():u)+`
`,""):(n===void 0&&(n=""),a+=typeof n=="string"?n.trim():n),i++,a}).join("");return i<=e.length&&(r+=e[e.length-1]),r.replace(Pa,"><").replace(Ad," ").trim()}static docsTpl(e,...t){let i=0,r=t.map((n,l)=>{let a=e[l];return Array.isArray(n)?a+=n.reduce((o,u)=>o+=(typeof u=="string"?u.trim():u)+`
`,""):(n===void 0&&(n=""),a+=typeof n=="string"?n.trim():n),i++,a}).join("");return i<=e.length&&(r+=e[e.length-1]),r.replace(Pa,"><").trim()}static repeat(e){return function(...t){return Xa.tpl(...t).repeat(e)}}static loop(e){}};qt._$name="TemplateHelper";var Pd=class extends Array{constructor(s,e){super(),this.timeZone=s,this.year=e}},Rd=class{constructor(s,e){this.asString=s,this.timeZone=e,this.asArray=Nd(s)}get asLocalDate(){return this._asLocalDate||(this._asLocalDate=new Date(...this.asArray)),this._asLocalDate}get asTicksUtc(){return this._asTicksUtc||(this._asTicksUtc=new Date(Date.UTC(...this.asArray)).getTime()),this._asTicksUtc}},Ra=(s,e)=>{const t=s.toLocaleString("sv-SE",{timeZone:e});return new Rd(t,e)},$d=(s,e)=>{const{asTicksUtc:t,asString:i}=Ra(new Date(s),e);return{offset:(s-t)/6e4,tzTicksUtc:t,tzString:i}},Nd=s=>{const e=s.split(/[\s-:]/).map(t=>t*1);return e[1]-=1,e},Vd=-6e4,zd=36e5,$a=-864e5,Fi=2592e6,Na=(s,e)=>{const t=Va.get(s,e);if(t)return t;const i=new Pd(s,e),r=new Date(Date.UTC(e,0,1)).getTime();let n=r,l=Fi,a=0,o=[],u=null,c,d,f,g;for(;!g;)({offset:f,tzTicksUtc:c,tzString:d}=$d(n,s)),u==null?(u=f,i.push({offset:f})):l>0&&f!==u?l=l===Fi?$a:Vd:l<0&&f===u&&(l===$a?l=zd:(i.length===1?(i.push(o),u=o.offset):(i[0].startTicks=o.startTicks,i[0].startDateString=o.startDateString,g=!0),l=Fi)),o={offset:f,startDateString:d,startTicks:c},l===Fi&&(n=r,n+=a*Fi,a+=1),n+=l,a>11&&(g=!0);return Va.set(i),i},Va={_cache:{},get(s,e){var t;return(t=this._cache[s])==null?void 0:t[e]},set(s){const{timeZone:e}=s,{_cache:t}=this;t[e]||(t[e]={}),t[e][s.year]=s}},$s=class{static get $name(){return"TimeZoneHelper"}static toTimeZone(s,e){if(typeof e=="number")return this.toUtcOffset(s,e);const t=Ra(s,e);return t.asArray[3]!==t.asLocalDate.getHours()&&console.warn("Incorrect time zone conversion due to local DST-switch detected"),t.asLocalDate}static fromTimeZone(s,e){if(typeof e=="number")return this.fromUtcOffset(s,e);const t=this.dateAsArray(s),i=Na(e,s.getUTCFullYear());let r=i[0].offset;if(i.length===2){const n=Date.UTC(...t);n>=i[1].startTicks&&n<i[0].startTicks&&(r=i[1].offset)}return t[4]+=r,new Date(Date.UTC(...t))}static toUtcOffset(s,e){const t=s.getTimezoneOffset()+e;return new Date(s.getTime()+t*60*1e3)}static fromUtcOffset(s,e){const t=-s.getTimezoneOffset()-e;return new Date(s.getTime()+t*60*1e3)}static dateAsArray(s){return[s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()]}};$s.findOffsetDates=Na,$s._$name="TimeZoneHelper";var Kt=class extends R.mixin(De,Vt){static get $name(){return"Navigator"}static get type(){return"navigator"}static get configurable(){return{ownerCmp:null,itemsTabbable:null,target:null,keyEventTarget:null,processEvent:null,itemSelector:null,activeItem:null,focusCls:"b-active",keys:null,allowCtrlKey:null,allowShiftKey:null,scrollDuration:50,disabled:null,datasetIdProperty:"id",testConfig:{scrollDuration:1}}}static get factoryable(){return{defaultType:"navigator"}}get activeItem(){const{_activeItem:s}=this;if(this.target.contains(s))return s;this._activeItem=null}updateOwnerCmp(s){this.itemSelector||(this.itemSelector=`.${this.ownerCmp.itemCls}`),v.setAttributes(this.keyEventTarget,{"aria-activedescendant":`${this.owner.id}-active-descendant`})}set navigationEvent(s){const{owner:e}=this;this._navigationEvent=e.navigationEvent=s,s&&Promise.resolve(1).then(()=>this.navigationEvent=null)}get navigationEvent(){return this._navigationEvent}static getComposedKeyName(s){const e=(s.key||"").trim()||s.code;return`${s.ctrlKey?"CTRL+":""}${s.shiftKey?"SHIFT+":""}${s.altKey?"ALT+":""}${e}`}onKeyDown(s){var e;const t=this,{ownerCmp:i,itemSelector:r,activeItem:n,itemsTabbable:l}=t,{target:a}=s,o=t.target.querySelector(r),u=(s.key||"").trim()||s.code,c=t.constructor.getComposedKeyName(s),d=a.matches(r)||a===t.keyEventTarget;if(!t.disabled&&t.processEvent&&(s=t.processEvent.call(i,s)),s&&!t.disabled&&o&&t.target.offsetParent&&d){if(!l){if(t.inlineFlow==null){const f=o.parentNode,g=v.getStyleValue(o,"position"),h=v.getStyleValue(o,"display"),p=v.getStyleValue(o,"float");t.inlineFlow=g==="absolute"||h==="inline"||h==="inline-block"||p==="left"||p==="right"||v.getStyleValue(f,"display")==="flex"&&v.getStyleValue(f,"flex-direction")==="row"}t.prevKey||(t.inlineFlow?(t.prevKey="ArrowLeft",t.nextKey="ArrowRight"):(t.prevKey="ArrowUp",t.nextKey="ArrowDown"))}if(t.navigationEvent=s,n)switch(u){case t.prevKey:if(t.disabled||s.ctrlKey&&!t.allowCtrlKey||s.shiftKey&&!t.allowShiftKey)return;s.preventDefault(),s.handled=!0,t.navigatePrevious(s);break;case t.nextKey:if(t.disabled||s.ctrlKey&&!t.allowCtrlKey||s.shiftKey&&!t.allowShiftKey)return;s.preventDefault(),s.handled=!0,t.navigateNext(s);break;default:{const f=(e=t.keys)==null?void 0:e[c];if(f&&!t.disabled){if(t.callback(f,t.thisObj||i,[s])===!1)return}else i.onInternalKeyDown&&i.onInternalKeyDown(s);if(v.getActiveElement(a)!==a&&s.preventDefault(),l)return}}else{if(l)return;(u===t.nextKey||u===t.prevKey)&&(t.activeItem=t.getDefaultNavigationItem(s))}t.activeItem!==n&&t.triggerNavigate(s)}}getDefaultNavigationItem(s){const{target:e,itemSelector:t,prevKey:i,nextKey:r}=this;if(e.compareDocumentPosition(s.target)&4&&s.key===i)return e.querySelector(`${t}:last-of-type`);if(e.compareDocumentPosition(s.target)&2&&s.key===r)return e.querySelector(`${t}`)}navigatePrevious(s){const e=this,t=e.previous;s.preventDefault(),t&&e.ownerCmp.scrollable.scrollIntoView(t,{animate:e.scrollDuration}).then(()=>{e.activeItem=t,e.triggerNavigate(s)})}navigateNext(s){const e=this,t=e.next;s.preventDefault(),t&&e.ownerCmp.scrollable.scrollIntoView(t,{animate:e.scrollDuration}).then(()=>{e.activeItem=t,e.triggerNavigate(s)})}get owner(){return this.ownerCmp}get previous(){return this.getAdjacent(-1)}get next(){return this.getAdjacent(1)}getAdjacent(s=1,e=this.activeItem){const t=this.treeWalker;if(t.currentNode=e,t[s<0?"previousNode":"nextNode"](),t.currentNode!==this.activeItem)return t.currentNode}onTargetFocusIn(s){var e;const t=this,{target:i,relatedTarget:r}=s,{owner:n,itemsTabbable:l,skipScrollIntoView:a,previousActiveItem:o}=t;i.matches(".b-focus-trap")||(i.matches(t.itemSelector)?(t.skipScrollIntoView=!0,t.activeItem=i,t.skipScrollIntoView=a,t.activeItem&&l&&t.triggerNavigate(s)):i===t.target&&((r?i.compareDocumentPosition(r):0)&Node.DOCUMENT_POSITION_CONTAINED_BY?(e=n.previousSibling)==null||e.focus():t.activeItem=o&&t.target.contains(o)?o:0))}onTargetFocusOut(s){const e=this,{relatedTarget:t}=s;t!=null&&t.matches(".b-focus-trap")||(!t||!e.target.contains(t)||!t.matches(e.itemSelector))&&e.activeItem&&(e.activeItem=null,e.itemsTabbable&&e.triggerNavigate(s))}onTargetMouseDown(s){const e=this,t=s.target.closest(e.itemSelector);e.navigationEvent=s,e.itemsTabbable?t===e.activeItem&&e.triggerNavigate(s):e.ownerCmp.itemsFocusable===!1?e.onFocusGesture(s):t&&(s.preventDefault(),v.focusWithoutScrolling(t))}onTargetClick(s){var e;const t=this,{skipScrollIntoView:i}=t;if(t.skipNextClick||(e=t.navigationEvent)!=null&&e.ignoreNavigation){t.skipNextClick=!1;return}t.disabled||(t.skipScrollIntoView=!0,t.processEvent&&(s=t.processEvent.call(t.ownerCmp,s)),s&&(t.activeItem=s.target.closest(t.itemSelector),t.triggerNavigate(s)),t.skipScrollIntoView=i)}onFocusGesture(s){(s.target===this.ownerCmp.contentElement||s.target.closest(this.itemSelector)&&this.ownerCmp.itemsFocusable===!1)&&s.preventDefault()}acceptNode(s){return s.offsetParent&&s.matches&&s.matches(this.itemSelector)?v.NodeFilter.FILTER_ACCEPT:v.NodeFilter.FILTER_SKIP}changeActiveItem(s){return s!=null&&this.ownerCmp.getItem&&(s=this.ownerCmp.getItem(s)),s}updateActiveItem(s,e){var t;const i=this,{ownerCmp:r}=i,n=e&&i.target.contains(e),l=s&&v.isFocusable(s)&&s!==v.getActiveElement(s);if(n&&(i.previousActiveItem=e),e&&(e.classList.remove(i.focusCls),e.removeAttribute("id")),s!=null){if(i.skipScrollIntoView?l&&v.focusWithoutScrolling(s):(t=r.scrollable)==null||t.scrollIntoView(s,{block:"nearest",focus:l,silent:i.scrollSilently}),s===e&&n)return;s.classList.add(i.focusCls),s.id=`${i.owner.id}-active-descendant`,i._activeItem=s}else i._activeItem=null,e===v.getActiveElement(e)&&r.revertFocus()}updateTarget(s,e){const t=this,i={element:s,thisObj:t,focusin:"onTargetFocusIn",focusout:"onTargetFocusOut",mousedown:{handler:"onTargetMouseDown",delegate:t.itemSelector}};!t.itemsTabbable&&!t.itemsFocusable&&(i.click="onTargetClick"),Object.prototype.hasOwnProperty.call(t,"acceptNode")||(t.acceptNode=t.acceptNode.bind(t),t.acceptNode.acceptNode=t.acceptNode),B.on(i),t.treeWalker=t.setupTreeWalker(s,v.NodeFilter.SHOW_ELEMENT,t.acceptNode),t.keyEventTarget||(t.keyEventTarget=s),(t.targetMutationMonitor=new MutationObserver(t.onTargetChildListChange.bind(t))).observe(s,{childList:!0,subtree:!0})}setupTreeWalker(s,e,t){return document.createTreeWalker(s,e,t)}onTargetChildListChange(){var s;const e=this,{activeItem:t,datasetIdProperty:i}=e;t&&(e.target.contains(t)?t.classList.contains(e.focusCls)||t.classList.add(e.focusCls):e.activeItem=e.target.querySelector(`${e.itemSelector}.${e.focusCls}[data-${k.hyphenate(i)}="${t.dataset[i]}"]`)||((s=e.target.querySelector(`${e.itemSelector}.${e.focusCls}`))==null?void 0:s[t.dataset.index])||null)}changeKeyEventTarget(s){this._keyEventTarget=s,B.on({element:s,keydown:"onKeyDown",thisObj:this})}triggerNavigate(s,e=this.activeItem){var t;const i={event:s,item:e,oldItem:this.previousActiveItem};this.trigger("navigate",i),(t=this.ownerCmp)==null||t.trigger("navigate",i)}};Kt._$name="Navigator";var Bd=s=>{var e;return e=class extends s{static get configurable(){return{loadMaskDefaults:{useTransition:!0,showDelay:1e3},loadMaskError:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},loadMask:{text:"L{GridBase.loadMask}"},syncMask:{text:"L{GridBase.syncMask}"},localizableProperties:["loadMask.text","syncMask.text"],testConfig:{loadMaskError:{icon:"b-icon b-icon-warning",autoClose:500,showDelay:0}}}}applyLoadMask(){const t=this,{loadMask:i}=t;return i&&(t.masked=Si.mergeConfigs(t.loadMaskDefaults,i)),t.masked}applyMaskError(t){const{loadMaskError:i,masked:r}=this;return i===!1?r.hide():r&&(w.assign(r.errorDefaults,i),r.error=t),r}get widgetClass(){}},x(e,"$name","LoadMaskable"),e},br=60*1e3,_t=60*br,Ke=24*_t,jd=/(\d+)?:?(\d*)/,Mt=class Xe{static format(e){const t=Math.floor(e/_t),i=Math.floor(e/br)%60;return`${t}:${i<10?"0":""}${i}`}static parse(e){const t=typeof e;if(t==="string"){const i=jd.exec(e);e=Number(i[1]||0)*_t+Number(i[2]||0)*br}else t!=="number"?e=z.getTimeOfDay(e):e<=24&&(e*=_t);return Math.min(Math.max(Math.floor(e),0),Ke)}constructor(e){let t=0,i,r;e!=null&&e.isDayView?(t=e.dayStartShift,i=e.dayStartTime,r=e.dayEndTime):typeof e=="number"?t=i=r=e:e&&(t=e.startShift,i=e.timeStart,r=e.timeEnd),this.startShift=t=Xe.parse(t||0),this.timeEnd=(r==null?(t+Ke)%Ke:Xe.parse(r))||Ke,this.timeStart=i==null?t:Xe.parse(i)}get startHour(){return Math.floor(this.timeStart/_t)}get endHour(){return Math.floor(this.timeEnd/_t)}get startTimeOffsetMs(){const{startShift:e,timeStart:t}=this;return t<e?Ke-e+t:t-e}get today(){return this.startOfDay(new Date)}ceil(e){const t=this.startOfDay(e);return t<e&&t.setDate(t.getDate()+1),t}contains(e){return!this.outside(e)}dateKey(e){return e=this.shiftDate(e,-1),z.makeKey(e)}dayOfDate(e){return this.shiftDate(z.clearTime(e))}dayOfWeek(e){return e=this.shiftDate(e,-1),e.getDay()}delta(e,t="ms"){const{timeStart:i}=this,r=Xe.parse(e),n=(this.startShift&&r<i?r+Ke:r)-i;return t==="ms"?n:z.as(t,n,"ms")}duration(e="ms"){const{timeStart:t,timeEnd:i}=this,r=t<i?i-t:Ke-t+i;return e==="ms"?r:z.as(e,r,"ms")}equals(e){return this.startShift===(e==null?void 0:e.startShift)&&this.timeStart===e.timeStart&&this.timeEnd===e.timeEnd}intersects(e,t){const i=this,{timeStart:r,timeEnd:n}=i,[l,a]=i._dateRangeArgs(e,t),[o,u]=i.timeRange(l,a);return r<n?o<u?o<n&&r<=u:o<n||r<=u:!(o<u)||o<n||r<=u}isIntraDay(e,t){const i=this,[r,n]=i._dateRangeArgs(e,t),l=i.startOfDay(r),a=Ke-z.diff(l,n,"ms");return a<0?!1:a>0||l<r}isInterDay(e){return e.allDay||!this.isIntraDay(...arguments)}outside(e){const{startShift:t,timeStart:i,timeEnd:r}=this,n=Xe.parse(e);return i<r?n<i?n<t?1:-1:n<r?0:n<t?-1:1:n<r||n>=i?0:n<t?1:-1}parseKey(e){return this.dayOfDate(z.parseKey(e))}shiftDate(e,t=1){const{startShift:i}=this,r=typeof e;return e=r==="number"?new Date(e):r==="string"?z.parse(e):new Date(e.getTime()),t&&i&&e.setMilliseconds(t>0?i:-i),e}sortEvents(e,t){const i=this.startOfDay(e);return t==null?void 0:t.sort((r,n)=>{r=r.eventRecord||r,n=n.eventRecord||n;let{startDate:l}=r,{startDate:a}=n;return l?a?(l=l<i?i:l,a=a<i?i:a,l-a||n.endDate-a-(r.endDate-l)):1:-1})}startOfDay(e){return e=this.shiftDate(e,-1),e=z.clearTime(e),e=this.shiftDate(e),e}timeRange(e,t){const[i,r]=this._dateRangeArgs(e,t);return[z.getTimeOfDay(i),z.getTimeOfDay(r)]}toString(){const{startShift:e,timeEnd:t,timeStart:i}=this,r=e?`@${Xe.format(e)}`:"",n=Xe.format(i);return i===t?e?r:n:`${n}-${Xe.format(t)}${r}`}_dateRangeArgs(e,t){return e.isModel?[e.startDate,e.endingDate]:[e,t]}};Mt.MIDNIGHT=new Mt({startShift:0,timeStart:0,timeEnd:24}),Mt.MILLIS_PER_MINUTE=br,Mt.MILLIS_PER_HOUR=_t,Mt.MILLIS_PER_DAY=Ke,Mt._$name="DayTime";var za=class extends lt(R){static get configurable(){return{element:null,zoneWidth:50,scrollSpeed:5,direction:"both",startScrollDelay:500,stopScrollWhenPointerOut:!1,testConfig:{scrollSpeed:2,startScrollDelay:100},activeScroll:{$config:["lazy"],value:{}},monitoring:{$config:["lazy","nullify"],value:!0},owner:null}}changeMonitoring(s,e){return e==null||e.clear(),new Map}doDestroy(){this.stopMonitoring(),super.doDestroy()}get isScrolling(){return Object.keys(this.activeScroll).length!==0}get rtl(){var s;return(s=this.owner)==null?void 0:s.rtl}startMonitoring(s={}){const e=this,{element:t,direction:i}=e,{scrollables:r=[],direction:n=i,callback:l}=s,a=[];return r.length||r.push({element:t}),r.forEach(o=>{const u=o.element;typeof u=="string"?v.forEachSelector(t,u,c=>{e.createMonitor(c,o.direction||n,o.callback||l),a.push(c)}):(e.createMonitor(u,o.direction||n,o.callback||l),a.push(u))}),function(){var u;(u=e.stopMonitoring)==null||u.call(e,a)}}createMonitor(s,e,t){const{monitoring:i}=this;i.has(s)||i.set(s,new Hd({scrollManager:this,element:s,direction:e,callback:t}))}stopMonitoring(s){const e=this,{monitoring:t}=e;if(s=V.asArray(s),t){if(!s){t.forEach(i=>e.stopMonitoring(i.element));return}s.forEach(i=>{const r=t.get(i);i.classList.remove("b-scrolling"),r&&(r.destroy(),t.delete(i))})}}requestScroll(s,e){const{activeScroll:t}=this;return s in t&&t[s]!==e?!1:(t[s]=e,!0)}releaseScroll(s){const{activeScroll:e={}}=this;Object.keys(e).forEach(t=>{e[t]===s&&delete e[t]})}getRelativeScroll(s,e="left"){let t=0;return this.monitoring.forEach((i,r)=>{v.isDescendant(r,s)&&(t+=e==="left"?i.scrollRelativeLeft:i.scrollRelativeTop)}),t}},Hd=class extends R{construct(s){const e=this,{element:t}=s,i=t.scrollLeft,r=t.scrollTop;Object.assign(s,{startScrollLeft:i,startScrollTop:r}),super.construct(s),B.on({element:t,scroll:"onElementScroll",pointermove:"onMouseMove",capture:!0,thisObj:e}),B.on({element:t,pointerleave:"onPointerLeave",thisObj:e})}doDestroy(){this.stopScroll(),super.doDestroy()}startScroll(){const s=this;s.pendingScrollFinalize&&(s.scrollManager.releaseScroll(s),s.pendingScrollFinalize=!1),s.scrolling=!0,s.performScroll()}stopScroll(s=null){const e=this,t=()=>{e.pendingScrollFinalize=!1,e.isDestroyed||(e.scrollManager.releaseScroll(e),e.scrolling=!1)};e.scrollRequested&&(e.scrollManager.cancelAnimationFrame(e.frameId),e.scrollRequested=!1),e.scrollManager.clearTimeout(e.scrollTimeout),e.scrollTimeout=null,!s&&(e.ongoingScrollTop||e.ongoingScrollLeft)?(e.pendingScrollFinalize=!0,Promise.all([e.ongoingScrollTop,e.ongoingScrollLeft].filter(Boolean)).then(()=>e.pendingScrollFinalize&&t())):(e.ongoingScrollTop=e.ongoingScrollLeft=null,t())}onPointerLeave(){this.scrollManager.stopScrollWhenPointerOut&&this.stopScroll()}onMouseMove(s){const e=this,{scrollManager:t}=e,i=e.element.getBoundingClientRect(),r=t.zoneWidth,n=t.scrollSpeed;if(e.scrollDeltaX=e.scrollDeltaY=0,e.direction!=="vertical"){const{scrollLeft:l,scrollWidth:a,clientWidth:o}=e.element;t.rtl?s.clientX<i.left+r&&a+l-o>=1?e.scrollDeltaX=-Math.round((r+(i.left-s.clientX))/n)-1:s.clientX>i.right-r&&l<0&&(e.scrollDeltaX=Math.round((r-(i.right-s.clientX))/n)+1):s.clientX>i.right-r&&a-l-o>=1?e.scrollDeltaX=Math.round((r-(i.right-s.clientX))/n)+1:s.clientX<i.left+r&&l>0&&(e.scrollDeltaX=-Math.round((r+(i.left-s.clientX))/n)-1)}if(e.direction!=="horizontal"){const{scrollTop:l,scrollHeight:a,clientHeight:o}=e.element;s.clientY>i.bottom-r&&a-l-o>=1?e.scrollDeltaY=Math.round((r-(i.bottom-s.clientY))/n)+1:s.clientY<i.top+r&&l>0&&(e.scrollDeltaY=-Math.round((r+(i.top-s.clientY))/n)-1)}e.scrollDeltaX!==0&&!t.requestScroll("horizontal",e)&&(e.scrollDeltaX=0),e.scrollDeltaY!==0&&!t.requestScroll("vertical",e)&&(e.scrollDeltaY=0),e.scrollDeltaX===0&&e.scrollDeltaY===0?e.scrolling&&e.stopScroll():e.scrollTimeout||(e.scrollTimeout=t.setTimeout(()=>e.startScroll(),t.startScrollDelay))}performScroll(){const s=this,{element:e}=s;if(s.scrolling&&!s.scrollRequested){if(s.scrollDeltaX!==0){const t=e.scrollLeft,i=Math.min(t+s.scrollDeltaX,e.scrollWidth-e.clientWidth);e.scrollLeft=i,e.scrollLeft!==t?s.ongoingScrollLeft=new Promise(r=>e.addEventListener("scroll",r,{once:!0})):(s.ongoingScrollLeft=null,s.scrollDeltaX=0)}if(s.scrollDeltaY!==0){const t=e.scrollTop,i=Math.min(t+s.scrollDeltaY,e.scrollHeight-e.clientHeight);e.scrollTop=i,e.scrollTop!==t?s.ongoingScrollTop=new Promise(r=>e.addEventListener("scroll",r,{once:!0})):(s.ongoingScrollTop=null,s.scrollDeltaY=0)}s.scrollDeltaX!==0||s.scrollDeltaY!==0?(s.scrollRequested=!0,s.frameId=s.scrollManager.requestAnimationFrame(()=>{s.scrollRequested=!1,s.performScroll(s)})):s.stopScroll()}}onElementScroll(){var s,e;(e=(s=this.config)==null?void 0:s.callback)==null||e.call(this.thisObj||this.scrollManager,this)}get scrollLeft(){return this.element.scrollLeft}get scrollTop(){return this.verticalElement?this.verticalElement.scrollTop:this.element.scrollTop}get scrollRelativeLeft(){return this.scrollLeft-this.startScrollLeft}get scrollRelativeTop(){return this.scrollTop-this.startScrollTop}getRelativeLeftScroll(s){return this.scrollManager.getRelativeScroll(s,"left")}getRelativeTopScroll(s){return this.scrollManager.getRelativeScroll(s,"top")}};za._$name="ScrollManager";var Wd={left:!0,right:!0,top:!0,bottom:!0,transform:!0},Ud={true:1,false:1},qd=Promise.resolve(),Ns=class Je extends Oi{static get configurable(){return{autoHide:!0,mouseOffsetX:15,mouseOffsetY:15,html:{$config:{equals:()=>!1}},getHtml:null,forElement:null,trackMouse:null,updateContentOnMouseMove:!1,forSelector:null,hideOnDelegateChange:null,anchorToTarget:!0,showOnHover:null,hoverDelay:500,autoShow:!1,dismissDelay:0,hideDelay:500,loadingMsg:"Loading...",allowOver:null,anchor:!0,align:{align:"b-t",minHeight:300},axisLock:!0,activeTarget:null,testConfig:{hideDelay:100,hoverDelay:100,showAnimation:null,hideAnimation:null}}}afterConfigure(){const e=this,{forSelector:t}=e;t&&(e.showOnHover=e.showOnHover!==!1,e.forElement||(e.anchorToTarget||(e.trackMouse=!0),e.forElement=e.rootElement.host||e.rootElement)),super.afterConfigure(),e.forElement&&e.showOnHover&&(e.pointerOverOutDetacher=B.on({element:e.forElement,pointerover:"internalOnPointerOver",pointerout:"internalOnPointerOut",thisObj:e}))}doDestroy(){var e;(e=this.pointerOverOutDetacher)==null||e.call(this),super.doDestroy()}set focusOnToFront(e){super.focusOnToFront=e}get focusOnToFront(){return super.focusOnToFront&&v.usingKeyboard}get focusElement(){const e=super.focusElement;if(e!==this.element)return e}get anchorToTarget(){return this._anchorToTarget&&!this.trackMouse}get anchor(){return super.anchor&&!this.trackMouse}set anchor(e){super.anchor=e}onDocumentMouseDown({event:e}){const t=this,{triggeredByEvent:i}=t;i&&v.isTouchEvent&&e.pageX===i.pageX&&e.pageY===i.pageY&&t.activeTarget.contains(e.target)&&performance.now()-i.timeStamp<500||(t.abortDelayedShow(),super.onDocumentMouseDown({event:e}))}internalOnPointerOver(e){const t=this,{target:i,relatedTarget:r}=e,{forElement:n,forSelector:l,activeTarget:a}=t;let o;if(!(t.disabled||t.owner&&!t.owner.showTooltipWhenDisabled&&t.owner.disabled)&&!(t.allowOver&&t.element.contains(i))){if(l){if(o=t.filterTarget(i),a!=null&&a.contains(i)&&a.contains(r)&&o===a||o&&(r==null?void 0:r.closest(l))===o)return}else if(!n.contains(r))o=n;else return;o?t.handleForElementOver(e,o):a&&t.handleForElementOut()}}filterTarget(e){return e.closest(this.forSelector)}onTransitionEnd(e){var t;const i=this,{currentOverElement:r}=Je;if(Wd[e.propertyName]){if(i.allowOver&&i.element.contains(r))return;(t=i.activeTarget)!=null&&t.contains(r)&&!i.trackMouse&&i.realign()}}async handleForElementOver(e,t){const i=this,{activeTarget:r,hideOnDelegateChange:n,anchorToTarget:l}=i,a=t!==r,o=a&&n;if(i.trigger("pointerOver",{event:e,target:t})===!1)i.internalOnPointerOut(e);else{if(i.triggeredByEvent=e,i.hasTimeout("hide")&&(i.abortDelayedHide(),!a))return;if(!n&&i.element.classList.contains("b-hiding")&&i.cancelHideShowAnimation(),!i._hidden&&o&&i.hide(!1),i.activeTarget=t,i.isVisible){const u=i.updateContent();if($.isPromise(u)&&!i.loadingMsg&&await u,i.trigger("beforeShow")===!1)return i.hide();i.alignTo({[l?"target":"position"]:l?t:"mouse",overlap:!(l&&i.anchor)}),i.trigger("show"),i.afterShowByTarget()}else i.delayShow(t)}}async delayShow(e){var t;const i=this;if((t=i.currentAnimation)!=null&&t.showing&&i.cancelHideShowAnimation(),!i.isVisible&&!i.hasTimeout("show"))if(!i.hoverDelay||i.forSelector&&Date.now()-i.lastHidden<i.quickShowInterval){const r=i.updateContent();$.isPromise(r)&&!i.loadingMsg&&await r,i.showByTarget(e)}else i.addDocumentMouseDownListener(),!i.listeningForMouseMove&&!i.anchorToTarget&&(i.mouseMoveRemover=B.on({element:i.rootElement,mousemove:"onMouseMove",thisObj:i})),i.setTimeout(async()=>{if(i.activeTarget===e&&e.isConnected){const r=i.updateContent();$.isPromise(r)&&!i.loadingMsg&&await r,i.showByTarget(e)}},!i.triggeredByEvent||i.triggeredByEvent.type==="pointerover"?i.hoverDelay:0,"show");else i.isVisible&&i.showByTarget(e)}changeAllowOver(e){return this.inAfterShow||(this.configuredAllowOver=e),e}updateAllowOver(e){var t;const i=this,{element:r}=i;r.classList.toggle("b-allow-over",!!e),e?i.allowOverlisteners=B.on({element:r,mouseenter:"onOwnElementMouseEnter",mouseleave:"internalOnPointerOut",thisObj:i}):(t=i.allowOverlisteners)==null||t.call(i)}updateContent(){const e=this;if(e.getHtml){const t=e.callback(e.getHtml,e,[{tip:e,element:e.element,activeTarget:e.activeTarget,event:e.triggeredByEvent}]);return e.html=t,t}}get hasContent(){return!!(v.isReactElement(this._html)||this._html!==""&&typeof this.html=="string"&&this.html.length||this.items.length)}internalBeforeShow(){return(this.updateContentOnMouseMove||this.hasContent)&&!this.disabled}showAsyncMessage(e=this.optionalL(this.loadingMsg)){e&&(this.html=`
                <div class="b-tooltip-loading">
                    <i class="b-icon b-icon-spinner"></i>
                    ${e}
                </div>
            `)}showByTarget(e){var t;const i=this,{anchorToTarget:r}=i;i.mouseMoveRemover=(t=i.mouseMoveRemover)==null?void 0:t.call(i),i.showBy({[r?"target":"position"]:r?e:"mouse",overlap:!(r&&i.anchor)})}afterShowByTarget(){const e=this,{dismissDelay:t}=e;e.abortDelayedShow(),t&&e.setTimeout("hide",t),e.element.parentNode&&e.toFront(),!e.mouseMoveRemover&&(e.trackMouse||e.updateContentOnMouseMove)&&(e.mouseMoveRemover=B.on({element:e.rootElement,pointermove:"onMouseMove",thisObj:e})),e.inAfterShow=!0,e.allowOver=e.allowOver||e.configuredAllowOver!=!1&&e.childItems.some(i=>i.isVisible&&!i.disabled&&i.focusElement),e.inAfterShow=!1}updateActiveTarget(e,t){e&&!this.isConfiguring&&this.trigger("overTarget",{newTarget:e,lastTarget:t})}internalOnPointerOut(e){var t;const i=this,r=e.relatedTarget;i.allowOver&&i.element.contains(r)||i.element.contains(e.target)&&((t=i.activeTarget)!=null&&t.contains(r))||i.activeTarget&&!i.activeTarget.contains(r)&&i.handleForElementOut()}handleForElementOut(){const e=this,{hideDelay:t}=e;if(e.trigger("pointerOut")===!1)return e.activeTarget=null,!0;e.abortDelayedShow(),e.isVisible&&t!==!1&&(e.abortDelayedHide(),t>0?e.setTimeout("hide",t):e.hide())}show(e){const t=this;!e&&t.forElement&&t.anchorToTarget&&!t.forSelector?t.showByTarget(t.forElement):super.show(...arguments),t.isVisible&&(t.afterShowByTarget(),t.forElement&&!t.transitionEndDetacher&&!t._hidden&&(t.transitionEndDetacher=B.on({element:t.forElement,transitionend:"onTransitionEnd",thisObj:t})))}get hideDelay(){return this.autoHide?this._hideDelay:!1}hide(){var e,t;const i=this;if(i.abortDelayedShow(),i._hidden)return qd;{i.abortDelayedHide();const r=super.hide(...arguments);return i.lastHidden=Date.now(),i.activeTarget=null,(e=i.mouseMoveRemover)==null||e.call(i),i.mouseMoveRemover=null,(t=i.transitionEndDetacher)==null||t.call(i),i.transitionEndDetacher=null,r}}abortDelayedShow(){var e,t,i;const r=this;r.hasTimeout("show")&&((e=r.mouseDownRemover)==null||e.call(r),r.mouseDownRemover=null,r.clearTimeout("show"),(t=r.mouseMoveRemover)==null||t.call(r),r.mouseMoveRemover=null,(i=r.transitionEndDetacher)==null||i.call(r),r.transitionEndDetacher=null)}abortDelayedHide(){this.clearTimeout("hide")}realign(){const e=this,t=e.lastAlignSpec;!e.isConfiguring&&!e.isVisible&&(t!=null&&t.targetOutOfView)&&(t.allowTargetOut||v.isInView(t.target,!1,e))&&(e.show(),t.targetOutOfView=!1),super.realign()}alignTo(e){const t=this,i=(t.mouseOffsetX||1)*(t.rtl?-1:1),r=t.mouseOffsetY||1,n=Math.max(Math.min(i,5),0),l=Math.max(Math.min(r,5),0);if(!t.isVisible)return;let a;!t.anchorToTarget&&e.position==="mouse"&&(a=new nt(t.triggeredByEvent.pageX-globalThis.scrollX,t.triggeredByEvent.pageY-globalThis.scrollY),e.position=new nt(a.x+(i||1)-(i<0?t.width:0),a.y+(r||1)-(r<0?t.height:0))),e&&!(t.triggeredByEvent&&t.element.contains(t.triggeredByEvent.target))&&e.nodeType===Node.ELEMENT_NODE&&(e={target:e}),super.alignTo(e),a&&t.lastAlignSpec.result.inflate(l,n).contains(a)&&(t.lastAlignSpec.position="mouse",t.mouseOffsetY=-r,t.mouseOffsetX=-i,t.realign(),t.mouseOffsetY=r,t.mouseOffsetX=i)}changeHtml(e){const t=this;if($.isPromise(e)){t.showAsyncMessage(),e.target=t.activeTarget,e.then(i=>{e.target===t.activeTarget&&(t.html=i)});return}return typeof e!="object"&&(e=e!=null?t.optionalL(String(e)):""),e}updateHtml(e,t){const i=this;let r=e==="";r||(super.updateHtml(e,t),i.hasContent?(i.isVisible&&i.realign(),$.isPromise(e)||i.trigger("innerHtmlUpdate",{value:e})):r=!0),r&&i.hide()}onMouseMove(e){const t=this,{forElement:i,activeTarget:r}=t,n=t.hasTimeout("hide"),l=e.target;if(t.triggeredByEvent=e,!t._hidden){let a;const o=r==null?void 0:r.contains(l),u=!o&&t.forSelector&&r&&!n&&l.nodeType===Node.ELEMENT_NODE&&!l.matches(t.forSelector)&&!(t.allowOver&&t.element.contains(l)),c=i!=null&&i.document?i.document.documentElement:i,d=c&&(c.contains?c.contains(l):c.compareDocumentPosition(l)&16);if(u&&(a=t.handleForElementOut()),a||!n||d){if(t.dismissDelay&&!n&&t.setTimeout("hide",t.dismissDelay),t.updateContentOnMouseMove&&t.getHtml&&(t.html=t.callback(t.getHtml,t,[{tip:t,element:t.element,forElement:r,event:e}]),!t.html)){t.hide();return}t.trackMouse&&t.alignTo({position:"mouse",ignorePageScroll:!0})}}}onElementUserAction(e){this.internalOnPointerOver(e)}onOwnElementMouseEnter(e){this.abortDelayedHide()}static getSharedTooltip(e,t,i){var r,n,l;let a=(n=(r=t.bryntum)==null?void 0:r.tooltip)==null?void 0:n.get(Je);if(!a&&!i){(l=t.bryntum)!=null&&l.tooltip||w.setPath(t,"bryntum.tooltip",new Map);const o=t.bryntum.tooltip;o.set(Je,!0),a=new Je({forElement:t,rootElement:e,forSelector:"[data-btip]",resetCfg:{},isSharedTooltip:!0,cls:"b-tooltip-shared",internalListeners:{pointerOver({source:u,target:c}){for(const g in u.resetCfg)g==="listeners"?u.un(u.resetCfg[g].set):g!=="html"&&(u[g]=u.resetCfg[g].was);u.resetCfg={};const d=N.getById(c.id),f=(d==null?void 0:d.tipConfig)||u.gatherDataConfigs(c.dataset);if(d&&d.element!==c||!d&&c.matches(".b-widget")||d!=null&&d.disabled&&!d.showTooltipWhenDisabled)return!1;u.owner=d;for(const g in f)u.resetCfg[g]={set:f[g],was:u[g]},g==="listeners"?u.ion(f[g]):u[g]=f[g]},hide({source:u}){u.owner=null}},gatherDataConfigs(u){const c=this,d={};for(const f in u)if(f.startsWith("btip"))if(f.length>4){const g=k.uncapitalize(f.substr(4));if(g in c.getDefaultConfiguration()){const h=u[f];d[g]=Ud[h]?h==="true":isNaN(h)?h:parseInt(h,10)}}else d.html=u[f];return d},filterTarget(u){const c=u.closest(this.forSelector);if(c)return c;if(Je.showOverflow&&u.closest(".b-widget"))for(;(u==null?void 0:u.nodeType)===Element.ELEMENT_NODE;){if(v.getStyleValue(u,"text-overflow")==="ellipsis"&&u.clientWidth<u.scrollWidth)return this.html=k.encodeHtml(u.textContent),u;u=u.parentNode}}}),B.on({element:t,mouseenter:u=>Je.currentOverElement=u.target,keydown:u=>Je.currentOverElement=u.target,capture:!0,thisObj:a}),o.set(Je,a)}return a}static encodeConfig(e){const t={};if(typeof e=="string")t.btip=e;else for(const i in e)t[`btip${i==="html"?"":k.capitalize(i)}`]=e[i];return t}};x(Ns,"$name","Tooltip"),x(Ns,"type","tooltip");var It=Ns;It.initClass(),Object.defineProperty(N,"tooltip",{get(){return It.getSharedTooltip(document.body,document.body)}}),N.Tooltip=It,It._$name="Tooltip";var Ba=s=>{var e;return e=class extends(s||R){static get configurable(){return{label:null,labelPosition:"before",labelCls:null,labelWidth:{value:null,$config:{localeKey:"L{labelWidth}"}}}}get hasLabel(){return!!this.label}compose(){const{hasLabel:t,labelPosition:i}=this;return{class:{[`b-label-${i}`]:t,"b-has-label":t}}}changeLabel(t){return t||""}setupLabel(t){return w.assign({tag:"label",for:`${this.id}-input`,class:`b-label b-align-${t.align||"start"}`},t)}updateLabelWidth(t){this.labelElement&&(this.labelElement.style.flex=`0 0 ${v.setLength(t)}`,this.inputWrap.style.flexBasis=t==null?"":"auto")}get widgetClass(){}},x(e,"$name","Labelable"),e},Li=class extends qe{static get configurable(){return{animation:{duration:300},collapsed:null,collapser:{value:null,$config:"nullify"},syncableConfigs:null,syncConfigTriggers:{$config:{merge:"classList"},value:null},testConfig:{animation:{duration:10}}}}static get delayable(){return{syncChildConfigs:"raf"}}get inline(){var s;return(s=this.owner.inline)!=null?s:this.ensureItems().count===1}changeCollapsed(s){if(this.togglingCollapse)return this.togglingCollapse=!1,s;this.toggleCollapse(!!s)}updateCollapsed(s){var e;this.collapser=(e=this.collapser)==null?void 0:e.destroy(),this.setCollapsedCls(s)}updateCollapser(s,e){e&&e.completed==null&&(!e.reverting||!s)&&e.destroy(),this.setOwnerCls("b-collapsing",s)}get collapsing(){const{collapser:s}=this;return s!=null&&s.collapsed}get collapsingExpanding(){return this.collapser!=null}get expanding(){const{collapser:s}=this;return s!=null&&!s.collapsed}collapse(s){this.toggleCollapse(!0,s)}expand(s){this.toggleCollapse(!1,s)}setCollapsedCls(s){this.setOwnerCls("b-collapsed",s)}setOwnerCls(s,e){var t,i;(i=(t=this.owner)==null?void 0:t.element)==null||i.classList[e?"add":"remove"](s)}syncChildConfigs(){const s=this,{owner:e,syncableConfigs:t}=s;if(t){let i,r;for(i in t)r=t[i](e),s.eachWidget(n=>{n[i]=r},!1)}e.afterSyncChildConfigs(s)}syncContainer(){const{inline:s,layout:e}=this;this.autoLayout&&(e.horizontal=s,e.justify=s?"center":"stretch")}toggleCollapse(s,e){const t=this,{animation:i,collapser:r,inline:n}=t,{containerWrapElement:l}=t.owner,a=o=>{o&&(t.element.style.height="",t.togglingCollapse=!0,t.collapsed=s,t.collapser=null)};if(s==null&&(s=!t.collapsed),e!==!1&&e!==null&&(!l||!t.isVisible?e=null:(e===!0?e={}:typeof e=="number"&&(e={duration:e}),e=i||e?w.merge({},i,e):null)),!e)t.togglingCollapse=!0,t.collapsed=s;else if(r&&s!==r.collapsed)t.collapser=r.revert({finalize:a}),t.collapser.collapsed=s;else if(!r&&s!==t.collapsed){!s&&t.setCollapsedCls(!1);const{element:o}=t,{height:u}=o.getBoundingClientRect(),c=n?1:u;!s&&t.setCollapsedCls(!0),o.style.height=`${u}px`,t.collapser=Se.run(w.merge({finalize:a,element:l,[n?"opacity":"height"]:{from:s?c:0,to:s?0:c}},e)),t.collapser.collapsed=s}}};x(Li,"$name","FieldContainer"),x(Li,"type","fieldcontainer"),Li.initClass(),Li._$name="FieldContainer";var Kd=(s,e)=>(s.weight||0)-(e.weight||0),Yd=(s,e)=>(e.weight||0)-(s.weight||0),Vs=[],Gd={align:!0,weight:!0},zs=class Tr extends N.mixin(Os,Ba){static get configurable(){return{defaultBindProperty:"value",placeholder:null,value:"",name:null,labels:null,required:null,clearable:null,revertOnEscape:null,hint:null,hintHtml:null,inputWidth:null,keyStrokeChangeDelay:0,readOnly:null,editable:!0,defaultAction:"change",triggers:null,highlightExternalChange:!0,localizableProperties:["label","title","placeholder","labelWidth"],autoSelect:!1,autoComplete:"off",spellCheck:null,validateOnInput:!0,inputAttributes:null,inputType:"text",inputAlign:null,attributes:{value:["placeholder","autoComplete","spellCheck","minLength","maxLength","pattern","tabIndex","min","max"],$config:{merge:"distinct"}},nullValue:{$config:null,value:null,default:null},updatedClsDuration:500,inputReadOnly:!1,ariaElement:"input",container:{$config:"nullify",value:null},containerDefaults:{type:"fieldcontainer",syncableConfigs:{disabled:e=>e.disabled},syncConfigTriggers:{disabled:1}},containValues:null,inline:null,testConfig:{updatedClsDuration:10},keyMap:{}}}static get delayable(){return{highlightChanged:"raf"}}doDestroy(){var e,t,i;const r=this,{triggers:n}=r,l=r.isPainted&&Tr.getSharedErrorTooltip(r.rootElement,!0);if((e=r.inputListenerRemover)==null||e.call(r),(t=r.keyListenerRemover)==null||t.call(r),(i=r.container)==null||i.destroy(),super.doDestroy(),n)for(const a of Object.values(n))a.destroy();(l==null?void 0:l.field)===r&&l.hide()}get childItems(){const{container:e,triggers:t}=this,i=t?Object.values(t):[];return e?[...i,...e.childItems]:i}get invalidValueError(){return"L{invalidValue}"}get errorTip(){return this.constructor.getSharedErrorTooltip(this.rootElement)}static getSharedErrorTooltip(e,t){var i;let r=(i=e.bryntum)==null?void 0:i.errorTooltip;return!r&&!t&&(e.bryntum=e.bryntum||{},r=new It({cls:"b-field-error-tip",forSelector:".b-field.b-invalid .b-field-inner",align:{align:"l-r",monitorTargetMutation:!0},scrollAction:"realign",trapFocus:!1,rootElement:e,onBeforeShow(){const n=this,l=N.fromElement(n.activeTarget);if(l){const a=l.getErrors();if(a)return n.html=a.join("<br>"),n.field=l,!0}return!1}}),e.bryntum.errorTooltip=r),r}static get errorTip(){return this.getSharedErrorTooltip(document.body)}construct(e){super.construct(e);const t=this;t.keyStrokeChangeDelay&&(t.changeOnKeyStroke=t.buffer(t.internalOnChange,t.keyStrokeChangeDelay))}changeKeyMap(e){var t;const i=this;let r={};e&&(i._fieldKeyMap?w.assign(r,i._fieldKeyMap):(i._fieldKeyMap=e,w.assign(r,e)));for(const n in i.triggers)(t=i.triggers[n])!=null&&t.keyMap&&(r=i.mergeKeyMaps(r,i.triggers[n].keyMap,n));return r}get keyMapSubComponents(){return this.triggers}onFocusIn(e){const t=this;t.valueOnFocus=w.clone(t.value),t.validOnFocus=!(t.errors&&Object.keys(t.errors).length),super.onFocusIn(e),t.focusing=!0,t.syncInvalid(),t.focusing=!1}onFocusOut(e){super.onFocusOut(e),this.syncRequired(),this.onEditComplete()}onEditComplete(){}get rootUiClass(){return Tr}compose(){this.getConfig("clearable");const e=this,{container:t,innerElements:i,label:r,labels:n,labelCls:l,readOnly:a,triggers:o}=e,u=w.values(o,(h,p)=>!p),c=u.filter(h=>h.align==="start").sort(Kd),d=u.filter(h=>h.align!=="start").sort(Yd),f=e.setupLabel.bind(e),g=[...c.map(h=>h.element),...i,...d.map(h=>h.element)];return{class:{"b-has-start-trigger":c.length,"b-no-input":!i.length,"b-readonly":a,"b-field-container":!!t,"b-field-container-inline":t==null?void 0:t.inline},children:[...(n||Vs).filter(h=>h&&h.align!=="end").map(f),(r||null)&&f({reference:"labelElement",class:`b-label b-align-start ${l||""}`,html:r}),g.length?{class:"b-field-inner",reference:"inputWrap",children:g}:null,...(n||Vs).filter(h=>(h==null?void 0:h.align)==="end").map(f),...t?[{reference:"containerWrapElement",children:[t.element],class:{"b-field-container-wrap":1}}]:Vs]}}updateElement(e,t){var i;const r=this,n=r.initialConfig.value,{input:l}=r;super.updateElement(e,t),n!=null&&(r.value=n),r.syncEmpty(),r.updateInputReadOnly(r.inputReadOnly),r.syncInvalid();const a=l||r.focusElement;(i=r.keyListenerRemover)==null||i.call(r),r.keyListenerRemover=a&&B.on({element:a,thisObj:r,keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}get innerElements(){return[this.inputElement]}get inputElement(){const{attributes:e,inputAttributes:t,id:i,inputCls:r,inputType:n,name:l}=this,a=w.assign({reference:"input",tag:"input",type:n,name:l||i,id:`${i}-input`,retainElement:!0},t);r&&(a.class=r);for(let o,u,c=e.length;c-- >0;)o=e[c],u=this[o],u!=null&&(a[o]=u);return a}get caretPos(){return this.textSelection[0]}set caretPos(e){this.textSelection=e}get focusElement(){return this.input}get textSelection(){var e;const t=this.input;let i;try{i=[t.selectionStart,t.selectionEnd,t.selectionDirection]}catch(r){i=((e=t.value)==null?void 0:e.length)||0,i=[i,i]}return i}set textSelection(e){typeof e=="number"?this.select(e,e):this.select(...e)}get hasTextSelection(){const[e,t]=this.textSelection;return e&&t-e>0}getAfterValue(e){const[t,i]=this.textSelection,r=this.input.value;return`${r.substr(0,t)}${e}${r.substr(i||t)}`}select(e,t){const i=this.focusElement;if(i.value.length){if(arguments.length===0){this.selectAll();return}if(!this.supportsTextSelection)return;i.setSelectionRange(e,t)}}moveCaretToEnd(){const e=this.input;if(e.createTextRange){const t=e.createTextRange();t.collapse(!1),t.select()}else this.supportsTextSelection&&this.select(e.value.length,e.value.length)}selectAll(){this.focusElement.select()}syncEmpty(){var e;const{isEmptyInput:t,isEmpty:i,element:r}=this,n=(e=this.triggers)==null?void 0:e.clear,l=t&&i;r&&(n&&n[l?"hide":"show"](),r.classList.toggle("b-empty",l))}updateHint(){this.syncHint()}updateHintHtml(){this.syncHint()}syncHint(){const e=this,{input:t,hint:i,hintHtml:r}=e,n=t==null?void 0:t.parentElement;if(t){let l=r||i;const a=e.hintElement||l&&(e.hintElement=v.createElement({parent:n,className:"b-field-hint",nextSibling:t.nextSibling,children:[{className:"b-field-hint-content"}]}));a&&(typeof l=="function"&&(l=l({source:e,value:e.value})),a.firstChild[r?"innerHTML":"textContent"]=l||""),e.element.classList[l?"remove":"add"]("b-field-no-hint")}}syncInvalid(){const e=this,{isPainted:t}=e;if(e.updatingInvalid=!0,t){const{isValid:i,element:r,inputWrap:n}=e;if(r.classList[i?"remove":"add"]("b-invalid"),i){const l=e.constructor.getSharedErrorTooltip(e.rootElement,!0);l!=null&&l.isVisible&&l.field===e&&l.hide()}else{const l=e.errorTip;l&&(e.containsFocus||e.isVisible&&n.contains(It.currentOverElement))&&(l.activeTarget===n&&l.isVisible?l.onBeforeShow():(l.activeTarget=n,l.showBy(n)))}}e.updatingInvalid=!1}updateEditable(){this.syncInputReadOnly()}syncInputReadOnly(){this.getConfig("readOnly"),this.inputReadOnly=this._readOnly||this.editable===!1}updateInputReadOnly(e){const t=this,{input:i,inputListenerRemover:r}=t;i&&(i.readOnly=e?"readOnly":null,e?t.inputListenerRemover=r==null?void 0:r():r||(t.inputListenerRemover=B.on({element:i,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput"})))}changeReadOnly(e){return!!e}updateReadOnly(e){this.syncInputReadOnly()}updateClearable(e){const t=this;t.getConfig("triggers"),t.triggers={clear:e&&w.assign({cls:"b-icon-remove",weight:1e3,key:"Shift+backspace",handler(){t._isUserAction=!0,t.clear(...arguments),t._isUserAction=!1}},e)||null}}changeTriggers(e,t){const i=this,r=i.$triggers||(i.$triggers=new Ut({configName:"triggers",factory:Tr.Trigger,inferType:!1,owner:i,created(n){re.after(n,"onConfigChange",(l,{name:a})=>{Gd[a]&&i.onConfigChange({name:"triggers",value:r.target})})},setup(n,l){n.reference=n.ref=l,n.parent=i}}));if(i.stepTriggers===!1&&(e.back||e.forward)&&(e=w.assign({},e),delete e.back,delete e.forward),r.update(e),i.element&&(i.keyMap=i.keyMap),!t)return r.target}updateInputWidth(e){this.input.style.width=v.setLength(e),this.element.classList.add("b-has-width")}updateInputAlign(e){this.input.style.textAlign=e}get isValid(){const e=this;if(!e.disabled){if(e.syncRequired(),e.errors&&Object.keys(e.errors).length)return!1;const t=e.validity;if(t)return t.valid}return!0}get isEmpty(){return this.value==null||this.value===""}get isEmptyInput(){return!this.input||this.input.value==null||this.input.value===""}get validity(){const e=this.input;return e==null?void 0:e.validity}async setValue(e){this.value=e}changeValue(e,t){return e==null&&(e=this.nullValue),this.hasChanged(t,e)?e:(e===""&&this.syncRequired(),t)}updateValue(e,t){const i=this;i.isConfiguring||(i.syncRequired(),i.inputting||i.triggerChange()),i.inputting||(i._lastValue=e),i.syncInputFieldValue(),i.overflowTwin&&!i._overflowTwinSync&&(i._overflowTwinSync=!0,i.overflowTwin.value=e,i._overflowTwinSync=!1)}hasChanged(e,t){return t!==e}syncInputFieldValue(e=!1){const t=this,{input:i,parent:r,inputValueAttr:n,inputValue:l}=t;if(i&&!t.inputting&&i[n]!==l&&(i[n]=l,!t.isConfiguring&&!t.containsFocus&&t.highlightExternalChange)){if(i.classList.remove("b-field-updated"),t.clearTimeout("removeUpdatedCls"),r){const{assigningValues:a}=r;(a===!0||(a==null?void 0:a.highlight)===!1)&&(e=!0)}e||t.highlightChanged()}t.syncEmpty(),t.syncInvalid()}highlightChanged(){this.input.classList.add("b-field-updated"),this.setTimeout("removeUpdatedCls",this.updatedClsDuration)}removeUpdatedCls(){this.input.classList.remove("b-field-updated")}get inputValue(){return this.value==null?"":this.value}get inputValueAttr(){return"value"}get supportsTextSelection(){const e=this.focusElement;return e&&(e.tagName.toLowerCase()==="textarea"||e.type&&/text|search|password|tel|url/.test(e.type))}internalOnInputFocus(){this.autoSelect&&this.selectAll()}internalOnChange(e){const t=this;t.hasChanged(t._lastValue,t.value)&&t.isValid&&(t.triggerChange(e,!0),t._lastValue=t.value)}triggerChange(e,t=!!this._isUserAction){const i=this,{value:r,_lastValue:n,isValid:l}=i;i.syncHint(),i.triggerFieldChange({value:r,oldValue:n,event:e,userAction:t,valid:l}),i.defaultAction==="change"&&i.trigger("action",{value:r,oldValue:n,event:e,userAction:t,valid:l})}fetchInputValue(){this.value=this.input[this.inputValueAttr]}internalOnInput(e){var t;const i=this;i.validateOnInput||i.errorTip.hide(),i.inputting=!0,i.fetchInputValue(),i.inputting=!1,i.trigger("input",{value:i.value,event:e}),(t=i.changeOnKeyStroke)==null||t.call(i,e)}get needsInputSync(){var e;return this.input[this.inputValueAttr]!==String((e=this.inputValue)!=null?e:"")}internalOnKeyEvent(e){const t=this,{value:i}=t;let r=!1;if(e.type==="keydown"&&e.key==="Escape"&&!(t.readOnly||t.disabled)){const n=t.isValid,l="initialValue"in t?t.initialValue:t.valueOnFocus,a=t.hasChanged(l,i),{needsInputSync:o}=t;t.revertOnEscape&&(!n||a||o)&&(a&&(t.value=l),o&&t.syncInputFieldValue(!0),t.clearError(),r=(a||o)&&t.isValid||n!==t.validOnFocus)}t.isDestroyed||(r&&e.stopImmediatePropagation(),t.trigger(e.type,{event:e}))}clear(e){const t=this,{value:i}=t;(i!==t.nullValue||t.input.value.length>0)&&(t.value=t.nullValue,t.clearError(),t.syncInvalid(),t.trigger("clear",{event:e}))}onDisabled(){this.syncInvalid()}syncRequired(){var e;const t=this;!t.isConfiguring&&!t.focusing&&t.required&&t.isEmpty&&!((e=t.parent)!=null&&e.isSettingValues)?t.setError("L{fieldRequired}",t.updatingInvalid):t.clearError("L{fieldRequired}",t.updatingInvalid)}setError(e,t,i){const r=this;if((r.errors||(r.errors={}))[r.optionalL(e)]=1,t||r.syncInvalid(),i){const n=()=>{r.clearError(e),l()},l=r.ion({keydown:n,focusOut:n})}}clearError(e,t){const i=this;i.errors&&(e?delete this.errors[this.optionalL(e)]:i.errors={}),t||i.syncInvalid()}getErrors(){const e=this;if(!e.isValid){const t=e.validity,i=w.keys(t).find(l=>l!=="valid"&&l!=="customError"&&t[l]),r=e.errors&&Object.keys(e.errors);let n;if(r!=null&&r.length?n=r:t.customError?n=[e.input.validationMessage]:i?n=[e.L(i,{min:e.min,max:e.max})]:n=[e.L(e.invalidValueError)],(n==null?void 0:n.length)>0)return n}}createOverflowTwin(e){const t=this,i=super.createOverflowTwin(e);return i.ion({change({value:r}){t._overflowTwinSync=!0,t.value=r,t._overflowTwinSync=!1}}),i}get containerCollapsed(){var e;return(e=this.container)==null?void 0:e.collapsed}set containerCollapsed(e){const{container:t}=this;t&&(t.collapsed=e)}afterSyncChildConfigs(e){}changeContainer(e,t){e&&(Array.isArray(e)||!("type"in e||"items"in e))&&(e={items:e});const i=this,r=e&&w.merge({owner:i,layout:"box"},i.containerDefaults),n=N.reconfigure(t,e,{owner:i,defaults:r});if(n&&(n.autoLayout=(r==null?void 0:r.layout)==="box",n===t)){n.syncContainer();return}return n}onConfigChange(e){var t,i;super.onConfigChange(e),(i=(t=this.container)==null?void 0:t.syncConfigTriggers)!=null&&i[e.name]&&this.container.syncChildConfigs()}assignValue(e,t){const i=this,{container:r,containValues:n}=i,l=i.getValueName(t),a=e&&l in e;r&&n!==!1?e&&n==="nested"?a&&(e=w.clone(e[l]),super.assignValue({[l]:e&&!("value"in e)||e.value},t),e&&delete e.value,r.assignValue(e,t)):(super.assignValue(e,t),r.assignValue(e,t)):super.assignValue(e,t)}gatherValue(e){super.gatherValue(e),this.gatherValues(e)}gatherValues(e,t){const i=this,{container:r,containValues:n,valueName:l}=i,a=typeof n;t=t!=null?t:l in e,r&&n!==!1&&(n==="nested"?t&&(e[l]={value:e[l],...r.values}):(n===!0||n==null&&t||a==="string"&&i[n]||a==="function"&&n(i))&&r.gatherValues(e))}updateContainer(e,t){t&&this.detachListeners(t.id),e&&(e.rendered||e.render(),e.syncContainer(),e.syncChildConfigs())}};x(zs,"$name","Field"),x(zs,"type","field");var Ee=zs;Ee.Trigger=class extends N{static get $name(){return"FieldTrigger"}static get factoryable(){return{defaultType:Ee.Trigger,extends:null}}static get type(){return"trigger"}static get configurable(){return{align:null,weight:null,role:void 0}}get field(){return this.parent}construct(){super.construct(...arguments),this.key&&(this.keyMap={[this.key]:"onClick"})}compose(){return{"aria-hidden":!0,class:{[`b-align-${this.align||"end"}`]:1,"b-icon":1},listeners:{click:"onClick",mousedown:"onMousedown"}}}changeAlign(e){return e}onClick(e){const t=this,{field:i}=t;i.disabled||i.readOnly||(e.key&&e.preventDefault(),i.trigger("trigger",{trigger:t})!==!1&&t.handler&&i.callback(t.handler,i,[e,t]))}onMousedown(e){const t=this.field;!("key"in e)&&v.isTouchEvent&&t.editable&&(t.editable=!1,t.setTimeout(()=>t.editable=!0,500)),e.preventDefault(),v.getActiveElement(t.input)!==t.input&&t.focus()}},Ee.SpinTrigger=class extends Ee.Trigger{static get $name(){return"SpinTrigger"}static get type(){return"spintrigger"}static get configurable(){return{repeat:{$config:["nullify"],value:!0}}}compose(){return{children:{upButton:{class:{"b-icon":1,"b-spin-up":1}},downButton:{class:{"b-icon":1,"b-spin-down":1}}}}}updateRepeat(e){var t;(t=this.clickRepeater)==null||t.destroy(),this.clickRepeater=e?hr.new({element:this.element},e):null}onClick(e){const t=this,{field:i}=t;i.disabled||i.readOnly||(e.target===t.upButton?i.doSpinUp(e.shiftKey):e.target===t.downButton&&i.doSpinDown(e.shiftKey))}},Ee.Trigger.initClass(),Ee.SpinTrigger.initClass(),N.register(Ee.Trigger,"trigger"),N.register(Ee.SpinTrigger,"spintrigger"),Ee._$name="Field";var Ot=class extends Ee{static get configurable(){return{nullValue:""}}construct(s){(s==null?void 0:s.inputType)==="hidden"&&(s.hidden=!0),super.construct(...arguments)}};x(Ot,"$name","TextField"),x(Ot,"type","textfield"),x(Ot,"alias","text"),Ot.initClass(),Ot._$name="TextField";var ki=class extends Ot{static get configurable(){return{editable:!0,pickerAlignElement:"inputWrap",value:null,triggers:{expand:{cls:"bars"}},autoClose:!0,autoExpand:null,picker:{value:{floating:!0},$config:["lazy","nullify"]},inputType:"text",monitorResize:!0,nullValue:null}}doDestroy(){var s;(s=this.globalTapListener)==null||s.call(this),super.doDestroy()}changeEditable(s){return j.isMobile&&this.initialConfig.editable!==!0&&(s=!1),s}updateAutoClose(s){!s&&le.deprecate("Core","6.0.0","PickerField.autoClose is no longer supported")}updateEditable(s){var e;const t=this,{element:i,ariaElement:r,nonEditableClickTarget:n}=t,{expand:l}=t.triggers,a=globalThis.matchMedia("(max-width: 410px)").matches;super.updateEditable(...arguments),i.classList.toggle("b-not-editable",!s),s===!1?(j.isMobile&&a&&(l==null||l.hide()),r.removeAttribute("aria-autocomplete"),(e=t.globalTapListener)==null||e.call(t),B.on({element:n,click:o=>{const u=n.getRootNode().elementFromPoint(o.clientX,o.clientY);o.target===n&&u===n&&t.onTriggerClick(o)},thisObj:t})):(l==null||l.show(),r.setAttribute("aria-autocomplete","list"),t.globalTapListener=be.ion({globaltap:"showKeyboard",thisObj:t}))}get nonEditableClickTarget(){return this.input}updateElement(s,e){var t;const i=super.updateElement(s,e),r=this.peekConfig("picker"),n=r?r.isWidget?r.role:(t=this.constructor.resolveType(r.type))==null?void 0:t.$meta.config.role:!1;return v.setAttributes(this.ariaElement,{"aria-expanded":!1}),this.ariaHasPopup=n,i}changePicker(s,e){throw new Error("changePicker(oldPicker, newPicker) must be implemented in PickerField subclass implementations")}get childItems(){const s=super.childItems;return this._picker&&s.push(this.picker),s}onEditComplete(){super.onEditComplete(),this.autoClosePicker()}onElementResize(s){const e=this;e.pickerVisible&&e.picker.requestAnimationFrame(e.picker.realign,null,e.picker),super.onElementResize(s)}internalOnKeyEvent(s){const e=this;let t=!0;if(s.type==="keydown"&&!e.disabled&&!s.shiftKey&&!s.ctrlKey)if(e.pickerVisible){const{picker:i}=e;s.key==="Escape"?(s.preventDefault(),s.stopImmediatePropagation(),e.hidePicker(),t=!1):i.onInternalKeyDown?i.onInternalKeyDown(s):s.key==="ArrowDown"&&i.focusable&&i.focus()}else s.key==="ArrowDown"&&(s.stopImmediatePropagation(),s.preventDefault(),e.onTriggerClick(s));t&&super.internalOnKeyEvent(s)}onFocusIn(s){const e=this;super.onFocusIn(s),e.autoExpand&&(e.minChars=0,e.onTriggerClick(s),e.ignoreTriggerClick=!0,e.setTimeout(()=>e.ignoreTriggerClick=!1,100))}onTriggerClick(s){this.disabled||this.togglePicker("key"in s)}showKeyboard({event:s}){const e=this.input;v.isTouchEvent&&v.getActiveElement(e)===e&&s.target===e&&(be.suspendFocusEvents(),e.blur(),e.focus(),be.resumeFocusEvents())}togglePicker(s){this.pickerVisible?this.hidePicker():this.showPicker(s)}showPicker(s){const e=this,{picker:t}=e;e.pickerHideShowListenersAdded||(t.ion({show:"onPickerShow",hide:"onPickerHide",thisObj:e}),e.pickerHideShowListenersAdded=!0),v.setAttributes(e.ariaElement,{"aria-controls":t.id,"aria-expanded":!0}),t.autoClose=e.autoClose,t.show(),t.isVisible&&s&&e.focusPicker()}onPickerShow(){const s=this;s.pickerVisible=!0,s.element.classList.add("b-open"),s.trigger("togglePicker",{show:!0}),s.pickerTapOutRemover=be.ion({globaltap:"onPickerTapOut",thisObj:s}),s.pickerKeyDownRemover=B.on({element:s.picker.element,keydown:"onPickerKeyDown",thisObj:s})}onPickerHide(){var s,e;const t=this;t.ariaElement.setAttribute("aria-expanded",!1),t.pickerVisible=!1,t.element.classList.remove("b-open"),t.trigger("togglePicker",{show:!1}),(s=t.pickerTapOutRemover)==null||s.call(t),(e=t.pickerKeyDownRemover)==null||e.call(t)}onPickerTapOut({event:s}){!this.containsFocus&&!this.owns(s.target)&&this.autoClosePicker()}onPickerKeyDown(s){if(s.key==="Tab"&&!this.picker.trapFocus){const e=v.getActiveElement(this.input),t=new KeyboardEvent("keydown",s);this.input.dispatchEvent(t),t.defaultPrevented&&s.preventDefault(),v.getActiveElement(this.input)===e?this.input.focus():s.preventDefault(),this.isDestroyed||this.hidePicker()}}autoClosePicker(){this.autoClose&&this.hidePicker()}hidePicker(){this.pickerVisible&&this.picker.hide()}focusPicker(){}focus(){const s=this.input;v.isTouchEvent&&this.editable&&(s.readOnly=!0,this.setTimeout(()=>s.readOnly=!1,500)),super.focus()}};x(ki,"$name","PickerField"),x(ki,"type","pickerfield"),ki._$name="PickerField";var ut=document.createRange(),Ne=class extends N{static get configurable(){return{itemCls:"b-list-item",selectedCls:"b-selected",selectIconCls:"b-icon-check",tag:"ul",items:null,displayField:"text",store:null,navigator:!0,scrollable:{overflowX:!1,overflowY:!0},itemsFocusable:!0,multiSelect:!1,toggleAllIfCtrlPressed:!1,collapsibleGroups:!1,selectAllItem:!1,itemTpl(s){let e=k.encodeHtml(s.getValue(this.displayField));return(e==null||e==="")&&(e="&nbsp;"),e},getItemStyle:null,getItemCls:null,groupHeaderTpl(s,e){let t=k.encodeHtml(e);return(t==null||t==="")&&(t="&nbsp;"),`${this.allowGroupSelect?this.itemIconTpl(s):""}${t}`},allowGroupSelect:!0,clearSelectionOnEmptySpaceClick:!1,selected:{$config:["nullify","lazy"],value:[]},activateOnMouseover:null,role:"listbox",keyMap:{"Ctrl+a":"selectAll"}}}construct(s,...e){var t;const i=this;Array.isArray(s)&&(s={items:s}),super.construct(s,...e);const{element:r}=i,{classList:n}=r;i.multiSelect&&n.add("b-multiselect"),(t=i.store)!=null&&t.count?i.refresh():n.add("b-empty"),B.on({element:r,delegate:i.itemSelector,mouseover:"onMouseOver",thisObj:i}),B.on({element:r,click:"onClick",thisObj:i})}doDestroy(){var s;this.detachListeners("store"),(s=this.navigator)==null||s.destroy(),super.doDestroy()}onFocusIn(s){var e;this.restoreActiveItem((e=s._target)==null?void 0:e.closest(this.itemSelector)),super.onFocusIn(s)}contentTpl(){const s=this,e=s.store.records.map((t,i)=>s.itemWrapperTpl(t,i));return s.multiSelect&&s.selectAllItem!==!1&&e.unshift(s.selectAllItemTpl()),qt.tpl`${e}`}itemWrapperTpl(s,e){const{selected:t,getItemStyle:i,store:r}=this,n=i?`style="${this.callback(i,this,[s])}"`:"";return r.isGrouped&&!s.isGroupHeader&&s.groupParent.get(r.id).meta.collapsed?"":qt.tpl`<li ${n} class="${this.getItemClasses(s,e)}" role="option" aria-selected="${t.includes(s)}" data-index="${e}" data-id="${k.encodeHtml(s.id)}" ${this.itemsFocusable?'tabindex="-1"':""}>${this.itemContentTpl(s,e)}</li>`}itemContentTpl(s,e){if(s.isGroupHeader){let t=this.groupHeaderTpl(s,k.capitalize(s.meta.groupRowFor));if(this.collapsibleGroups){const i=s.meta.collapsed?"right":"down";t+=`<button class="b-button b-tool b-icon b-icon-collapse-${i} b-list-expander-icon" data-noselect></button>`}return t}return`${this.itemIconTpl(s,e)}${this.itemTpl(s,e)}`}itemIconTpl(s,e){return this.multiSelect?`<i class="b-selected-icon b-icon ${this.selectIconCls}"></i>`:""}selectAllItemTpl(){const s=this.allSelected?"b-selected":"";return`<li class="${this.itemCls} b-select-all-item ${s}" data-noselect data-select-all data-id="select-all">${this.itemIconTpl({})}<div>${this.L("selectAll")}</div></li>`}getItemClasses(s){var e;const t=this,{getItemCls:i}=t,r=(e=t._navigator)==null?void 0:e.activeItem,n=(r==null?void 0:r.dataset.id)==s.id,l="groupRowFor"in s.meta?"b-list-item-group-header":"",a=t.selected.includes(s)||s.isSpecialRow&&s.groupChildren.every(u=>t.selected.includes(u)),o=i?this.callback(i,this,[s]):"";return`${t.itemCls} ${s.cls||""} ${o} ${a?t.selectedCls:""} ${n?t.navigator.focusCls:""} ${l}`}onBeforeStoreLoad(){this.mask(this.L("L{loading}"))}onAfterStoreRequest(){this.unmask()}onStoreChange({source:s,action:e,records:t,record:i,changes:r}){const n=this,{selected:l}=n;switch(e){case"dataset":{l.match(s.storage,!n._externallyOwnedSelection);break}case"remove":l.remove(t);break;case"clear":n.deselectAll();break;case"update":{const{id:a}=r;a&&v.setAttributes(n.contentElement.querySelector(k.encodeAttributeSelector("data-id",a.oldValue)),{"data-id":a.value}),n.refreshItem(i);return}}n.refresh()}onStoreRefresh(){this._selected?this.refresh():this.getConfig("selected")}refresh(){var s;const e=this;if(e.isVisible&&e.store){const t=(s=e.navigator)==null?void 0:s.activeItem;e.paintListener=null;const i=v.createElementFromTemplate(e.contentTpl(),{fragment:!0});e.clearItems().insertNode(i),t&&e.restoreActiveItem(t),e.refreshCount=(e.refreshCount||0)+1,e.element.classList[e.store.count>0?"remove":"add"]("b-empty"),e.updateSelectAllState()}else e.paintListener||(e.paintListener=e.ion({paint:"refresh",thisObj:e,once:!0}))}clearItems(){const s=this,e=s.contentElement.querySelector(s.itemSelector),t=s.contentElement.lastChild;if(e){const i=s.contentElement.querySelectorAll(`${s.itemSelector}:not(.b-mask)`);ut.setStartBefore(e),ut.setEndAfter(i[i.length-1]),ut.deleteContents()}else t?(ut.setStartAfter(t),ut.setEndAfter(t)):(ut.setStart(s.contentElement,0),ut.setEnd(s.contentElement,0));return ut}refreshItem(...s){for(const e of s){const t=this.getItem(e);if(t){const i=this.store.indexOf(e),r=v.createElementFromTemplate(this.itemWrapperTpl(e,i));v.sync(r,t)}}}getItem(s){if(s!=null)return typeof s=="number"?this.contentElement.querySelector(`[data-index="${s<0?this.store.count+s:s}"]`):(s.nodeType===Element.ELEMENT_NODE&&(s=s.dataset.id),(s==null?void 0:s.id)!=null&&(s=s.id),this.contentElement.querySelector(k.encodeAttributeSelector("data-id",s)))}getRecordFromElement(s){return s.target&&(s=s.target),s=s.closest(this.itemSelector),this.store.getAt(parseInt(s.dataset.index))}updateItems(s){var e;const t=this,i=Ce.getStore(V.asArray(s));(e=t.store)!=null&&e.autoCreated?t.store.data=(i==null?void 0:i.records)||[]:t.store=i}updateDisabled(s){super.updateDisabled(...arguments),this.navigator&&(this.navigator.disabled=s)}changeSelected(s,e){const t=this,i={change:"onInternalSelectionChange",thisObj:t};if(e==null||e.un(i),s)if(s.isCollection)t._externallyOwnedSelection=!0,s.ion(i);else if(t._externallyOwnedSelection=!1,s=V.asArray(s).reduce((r,n)=>(n=n.isModel?n:t.store.getById(n),n&&r.push(n),r),[]),e)e.splice(0,e.count,s),s=e,t.refresh();else{const r=s;s=t._selected=new vt({internalListeners:i}),s.add(r)}else e==null||e.destroy();return s}updateSelected(s){s&&this.refresh()}get itemSelector(){return`.${this.itemCls}`}get selected(){return this._selected}updateMultiSelect(s,e){!s&&e&&this.selected.count>1&&this.deselect(this.selected.allValues.slice(1))}get store(){return this.getConfig("items"),this._store}changeStore(s){const e=this;if(s instanceof Ce||(Array.isArray(s)&&(s={data:s}),s=new Ce(s)),e.detachListeners("store"),s){const t={name:"store",change:"onStoreChange",refresh:"onStoreRefresh",thisObj:e};s.readUrl&&(t.beforeLoad="onBeforeStoreLoad",t.afterRequest="onAfterStoreRequest"),s.isGrouped&&(e.element.classList.add("b-grouped"),t.groupchange="onStoreRefresh"),s.ion(t)}return s}updateStore(s){s!=null&&s.records.length&&this.getConfig("selected"),this.refreshCount||this.refresh()}changeNavigator(s,e){const t=this,{element:i}=t;return i&&(s=Kt.reconfigure(e,s?Kt.mergeConfigs({ownerCmp:t,disabled:t.disabled,target:i,keyEventTarget:i},s):null,t),(s==null?void 0:s.keyEventTarget)===i&&!t.itemsTabbable&&(i.tabIndex=0)),s}get minAlignHeight(){const s=this.element.lastElementChild,e=this.minHeight;if(e!=null)return s?Math.min(s.offsetTop+s.offsetHeight,e):0}alignTo(...s){super.minHeight=this.minAlignHeight,super.alignTo(...s)}hide(...s){return this.navigator&&(this.navigator.activeItem=null),super.hide(...s)}show(){const{refreshCount:s}=this,{previousActiveItem:e}=this.navigator;super.minHeight=this._minHeight;const t=super.show(...arguments);return this.refreshCount===s&&this.restoreActiveItem(e,!0),t}restoreActiveItem(s=this.navigator.previousActiveItem,e="nearest"){const t=this,{navigator:i,lastAlignSpec:r}=t;if(s!=null){if(typeof e!="string"){const n=r?r.zone:1;e=n&1?"nearest":n?"start":"end"}s=t.getItem(s),s&&!t.disabled&&(t.scrollable.scrollIntoView(s,{block:e}),i.activeItem=s)}}onMouseOver(s){const e=this,t=s.currentTarget;!v.isTouchEvent&&t&&e.navigator&&e.activateOnMouseover&&e.setTimeout({fn:"handleMouseOver",delay:30,args:[t],cancelOutstanding:!0})}handleMouseOver(s){this.navigator.activeItem=s}onClick(s){const e=s.target.closest(this.itemSelector);e?this.onItemClick(e,s):this.clearSelectionOnEmptySpaceClick&&this.deselectAll()}onSpaceKey(s){(s.target.nodeName.toUpperCase()!=="INPUT"||s.target.readOnly)&&this.onEnterKey(s)}onEnterKey(s){const e=this.navigator.activeItem;e&&!this.disabled&&(this.onItemClick(e,s),s.stopImmediatePropagation(),s.preventDefault())}onInternalKeyDown(s){const e=this;switch(s.key){case"ArrowLeft":e.collapseItem();break;case"ArrowRight":e.expandItem();break;case" ":e.onSpaceKey(s);break;case"Enter":e.onEnterKey(s);break}}collapseItem(){const{activeItem:s}=this.navigator;s&&this.toggleCollapse(this.getRecordFromElement(s),!0)}expandItem(){const{activeItem:s}=this.navigator;s&&this.toggleCollapse(this.getRecordFromElement(s),!1)}onItemClick(s,e){var t;const i=this,{allowGroupSelect:r}=i,n=parseInt(s.dataset.index),l=i.store.getAt(n),a=l==null?void 0:l.isSpecialRow,o=s.contains(e.target.closest("[data-noselect]"));if(!(i.disabled||i.trigger("beforeItem",{item:s,record:l,index:n,event:e,userAction:!0})===!1)){if(i._isUserAction=!0,s.contains(e.target.closest("[data-select-all]")))i.onSelectAllClick(s,e);else if(e.target.matches(".b-list-expander-icon")){i.toggleCollapse(l);return}else if(l&&!o&&(!a||r)){const{selected:u}=i,c=(t=l.groupParent)==null?void 0:t.get(i.store.id);if(i.multiSelect){let d=u.includes(l),f=l;i.toggleAllIfCtrlPressed&&e.ctrlKey?f=i.store.records:r&&a&&(d=!l.groupChildren.some(g=>!u.includes(g)),s.classList.toggle("b-selected",!d),f=l.groupChildren),u[d?"remove":"add"](f),!a&&c&&r&&i.getItem(c).classList.toggle("b-selected",c.groupChildren.every(h=>u.includes(h)))}else u.splice(0,u.count,l)}i.isDestroyed||(i.lastClicked=l,i.trigger("item",{item:s,record:l,index:n,event:e,userAction:!0}),i._isUserAction=!1)}}onInternalSelectionChange({action:s,removed:e,added:t,replaced:i}){const r=this,{selectedCls:n,unselectedCls:l}=r;let a,o;if(s==="clear")for(o of r.element.querySelectorAll(`.${n}`))o.classList.remove(n),o.setAttribute("aria-selected",!1),l&&o.classList.remove(l);else if(s!=="replaceValues"){for(a of e)o=r.getItem(a),o&&(o.classList.remove(n),o.setAttribute("aria-selected",!1));for(a of t)o=r.getItem(a),o&&(o.classList.add(n),o.setAttribute("aria-selected",!0))}r.selectAllItem&&r.updateSelectAllState(),r.trigger("selectionChange",{selected:r.selected.values})}onSelectAllClick(s){s.classList.contains(this.selectedCls)?this.deselectAll():this.selectAll()}updateSelectAllState(){var s;(s=this.element.querySelector(".b-select-all-item"))==null||s.classList.toggle(this.selectedCls,this.allSelected)}get allSelected(){const{selected:s,store:e}=this;return s.count&&(e.isFiltered?e.records.every(t=>s.includes(t)):e.count===s.count)}selectAll(s){const e=this;(e.multiSelect||!s)&&(e.selected.add(e.store.records),s&&!e.navigator.activeItem&&(e.navigator.activeItem=e.getItem(-1)))}deselectAll(){this.selected.clear()}select(s){const{store:e}=this,{modelClass:t}=e;s=V.asArray(s).reduce((i,r)=>(r=e.getById(t.asId(r)),r&&i.push(r),i),[]),this.selected.add(s)}deselect(s){const{modelClass:e}=this.store;s=V.asArray(s).reduce((t,i)=>(i=this.selected.get(e.asId(i)),i&&t.push(i),t),[]),this.selected.remove(s)}toggleCollapse(s,e){s.isGroupHeader&&(e=e===void 0?!s.meta.collapsed:e,this.store[e?"collapse":"expand"](s),this.refresh(),this.trigger("toggleGroup",{groupRecord:s,collapse:e}))}updateCollapsibleGroups(s,e){if(e&&!s){const{store:t}=this;t.groupRecords.forEach(i=>t.expand(i))}this.refresh()}};x(Ne,"$name","List"),x(Ne,"type","list"),Ne.initClass(),Ne.prototype.navigatorClass=Kt,Ne._$name="List";var Yt=class extends Ne{static get configurable(){return{itemCls:"b-chip",multiSelect:!1,closable:!0,iconTpl:null,closeHandler:null}}itemContentTpl(s,e){const t=this;return qt.tpl`${t.iconTpl?this.iconTpl(s):""}
            ${t.itemTpl(s,e)}
            ${t.closable?'<div class="b-icon b-close-icon b-icon-clear" data-noselect></div>':""}`}onInternalKeyDown(s){const e=this;e.closable&&e.selected.count&&(s.key==="Delete"||s.key==="Backspace")?e.callback(e.closeHandler,e.owner,[e.selected.values,{isKeyEvent:!0}]):super.onInternalKeyDown(s)}updateClosable(s){this.element.classList[s?"add":"remove"]("b-chips-closable"),this.navigator&&(this.navigator.disabled=!s),this.isConfiguring||this.refresh()}onClick(s){const e=this,t=s.target.closest(`.${e.itemCls}`);if(e.closable&&s.target.classList.contains("b-close-icon")){const i=e.store.getAt(parseInt(t.dataset.index));e.closeHandler?e.callback(e.closeHandler,e.owner,[[i]]):e.store.remove(i)}else super.onClick(s)}};x(Yt,"$name","ChipView"),x(Yt,"type","chipview"),Yt.initClass(),Yt._$name="ChipView";var Bs="L{Field.fieldRequired}",Gt="L{Field.validateFilter}",Xd="L{Combo.recordNotCommitted}",Jd=/[\w\s]/,Ft=class extends ki{static get configurable(){return{primaryFilter:{},picker:{type:"list",floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,align:{align:"t0-b0",axisLock:!0},maxHeight:324,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},multiSelect:null,items:null,store:null,valueField:void 0,displayField:"text",pickerWidth:null,minChars:null,selected:null,listItemTpl:null,displayValueRenderer:null,listCls:null,triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},filterParamName:null,encodeFilterParams:s=>s.map(e=>e.value),filterOnEnter:!1,hideTrigger:null,overlayAnchor:null,keyStrokeFilterDelay:null,defaultAction:"select",triggerAction:"all",filterOperator:"startsWith",caseSensitive:!1,hidePickerOnSelect:null,chipView:{$config:["lazy","nullify"],value:{type:"combochipview"}},chipStore:{$config:["lazy","nullify"],value:{}},filterSelected:null,emptyText:null,value:null,valueCollection:{$config:["nullify","lazy"],value:{}},validateFilter:!0,clearTextOnPickerHide:!0,destroyStore:!1,multiValueSeparator:",",createOnUnmatched:null,role:"combobox",inlinePicker:null,testConfig:{keyStrokeFilterDelay:0},localizeDisplayFields:!1,buildItems:null}}static get queryLast(){return"last"}construct(s){super.construct(...arguments),this.store||(this.items=[]),this.filterOnEnter&&(this.hideTrigger=!0)}startConfigure(s){this.usingRecordAsValue=s.valueField===null,super.startConfigure(...arguments)}afterConfigure(){super.afterConfigure();const s=this;w.hasOwn(s,"_value")||(s._value=s.valueField===s.displayField?"":null,s._lastValue=s._lastValue||s._value)}get childItems(){const{_chipView:s,_picker:e}=this,t=super.childItems;return s&&t.push(s),e&&t.push(e),t}get innerElements(){var s;const e=(s=this._chipView)==null?void 0:s.element,{input:t,inputElement:i}=this;return e&&bt.sync({targetElement:t,domConfig:i}),[e||i]}updateInlinePicker(s){s&&(this.element.classList.add("b-inline-picker"),this.getConfig("picker"),this.triggers.expand=null,this.pickerVisible=!0)}hidePicker(){if(!this.inlinePicker)return super.hidePicker(...arguments)}changeChipStore(s){return s&&!(s instanceof Ce)&&(s=new Ce(Ce.mergeConfigs({storage:this.valueCollection},s))),s}updateChipStore(s,e){e==null||e.destroy()}changeChipView(s,e){const t=this;if(t.element.classList[s?"add":"remove"]("b-uses-chipview"),s){const{input:i}=t;return t.chipStore||(t.chipStore={}),ja.reconfigure(e,s,{defaults:{parent:t,insertBefore:i,store:t.chipStore,closable:!t.readOnly,navigator:{type:"combochipnavigator",keyEventTarget:i}}})}e==null||e.destroy()}updateChipView(s){var e;const t=this;t._chipViewEventDetacher=(e=t._chipViewEventDetacher)==null?void 0:e.call(t),t.chipStore=s==null?void 0:s.store,s&&(s.element.appendChild(t.input),t._chipViewEventDetacher=B.on({element:s.element,mousedown:"onChipViewMousedown",thisObj:t}))}updateMultiSelect(s,e){const t=this,{input:i,element:r}=t,n=!t.isConfiguring;let{value:l}=t;if(r.classList[s?"add":"remove"]("b-multiselect"),s){const{chipView:a}=t,{parentNode:o}=i,u=a==null?void 0:a.element;u&&u!==o&&(o.insertBefore(u,i),u.appendChild(i),t.chipView.refresh()),i.value="",n&&(l=V.asArray(l))}else{const a=t._chipView,{parentNode:o}=i,u=a==null?void 0:a.element;u===o&&(u.parentNode.insertBefore(i,u),u.remove(),r.classList.remove("b-uses-chipview")),n&&typeof l!="string"&&(l=l!=null&&l.length?l[0]:null)}n&&(t.value=l)}onChipViewMousedown(s){s.preventDefault(),this.containsFocus||this.focus()}onChipClose(s,e={}){(e.isKeyEvent&&this.input.value===""||!e.isKeyEvent)&&(this._isUserAction=!0,this.valueCollection.remove(s),this._isUserAction=!1)}updateFilterParamName(s){this.hideTrigger!==!1&&(this.hideTrigger=!!s)}updateHideTrigger(s){this.element.classList[s?"add":"remove"]("b-hide-trigger")}updateKeyStrokeFilterDelay(s){this.filterOnInput.delay=s}updateReadOnly(s){super.updateReadOnly(...arguments),this._chipView&&(this._chipView.closable=!s)}updateDisabled(s){super.updateDisabled(...arguments),this._chipView&&(this._chipView.closable=!s)}updateFilterOperator(s){this.primaryFilter&&(this.primaryFilter.operator=s)}get minChars(){const s=this._minChars;return s!=null?s:this.remoteFilter?4:1}get validateFilter(){return this._validateFilter&&!this.createOnUnmatched}get items(){return this.store.allRecords}updateBuildItems(s){s&&(this.items=s.call(this))}changeItems(s){const e=this;if(s==null){if(e.store&&!e.store.isItemStore)return;s=[]}if(e.buildItems&&!(s!=null&&s.length)&&(s=e.buildItems()),s instanceof Ce){e.store=s;return}const t=e.displayField;let i,r=e.valueField,n;if(Array.isArray(s)?n=s.map(l=>{let a=l;return l instanceof ue?(i=l.constructor,r||(e.valueField=r=i.idField)):typeof l=="string"||typeof l=="number"?(r||(e.valueField=r=e.displayField),a={[r]:l,[t]:l}):(r||(e.valueField=r="value"),Array.isArray(l)&&(a={[r]:l[0],[t]:l[1]})),l.selected&&(e.value=a),a}):(r||(e.valueField=r="value"),n=[],Object.entries(s).forEach(([l,a])=>{n.push({[r]:l,[t]:a})})),e.store)e.store.data=n;else{const l=r===t?{name:"value",dataSource:t}:r;if(!i){class a extends ue{static get idField(){return e.valueField}static set idField(u){super.idField=u}static get fields(){return[l,t]}}i=a}e.store=new Ce({isItemStore:!0,data:n,idField:r,verifyNoGeneratedIds:!1,modelClass:i})}}get value(){const s=this,{valueCollection:e,valueField:t}=s;if(t==null)return s.multiSelect?e.values.slice():e.first;let i;return s.multiSelect?i=e.count?e.map(r=>r[t]):s._lastValue||[]:i=e.count?e.first[t]:s._lastValue,i}set value(s){super.value=s}get needsInputSync(){return this.usesChipView?!1:!this.editable}changeValue(s,e){var t,i;const r=this;if(s===e){r.syncInputFieldValue(!0);return}if(!r.multiSelect&&Array.isArray(s)&&s.length>1)throw new Error("Multiple values cannot be set to a non-multiSelect Combo");r.triggerConfig("items"),r.inputting||(t=r._chipView)==null||t.selected.clear(),r.store||(r.items=[]);const{valueField:n,displayField:l,store:a,valueCollection:o,_picker:u}=r,{storage:c}=a,d=(i=r.hidePickerOnSelect)!=null?i:!r.multiSelect,f=r._isUserAction||(u==null?void 0:u._isUserAction)||d&&r.pickerVisible||!1;if(!r.remoteFilter&&a.isAjaxStore&&!a.count){a.ion({load:()=>r.value=s,once:!0,thisObj:r}),r._lastValue=s;return}let g;if(s!=null){const h=Array.isArray(s),p=h?s.slice():[s];if(r.remoteFilter){if(s!=null){if(w.isObject(s)||s.isModel)r.store.data=[s],r.valueCollection.splice(0,r.valueCollection.count,r.store.first);else{const b=r.isConfiguring;r.primaryFilter.setConfig({value:s,disabled:!1}),a.performFilter(!0).then(()=>{if(r.isDestroyed)return;const{isConfiguring:S}=r;r.isConfiguring=b,o.splice(0,o.count,a.allRecords),r.isConfiguring=S})}return}}else a.isFiltered&&(r.primaryFilter.disabled=!0,a.filter());for(let b=0,S=p.length;b<S;b++){let C=p[b];if(C instanceof ue)c.includes(C,!0)||a.add(C);else{const T=w.isObject(C);T&&(C=C[a.modelClass.fieldMap[n].dataSource]),g=c.getBy(l,C)||c.getBy(n,C)||o.getBy(l,C)||o.getBy(n,C),g instanceof Set&&(g=[...g][0]),g?(T&&g.set(p[b]),p[b]=g):(p.splice(b,1),S--,b--)}}const m=!p.length,y=o.generation;o.splice(0,o.count,p),m&&(r._value=h&&s.length===0?null:s,r._lastValue=r._value),(m||o.generation===y)&&r.syncInputFieldValue(),r.syncEmpty(),m&&!r.isConfiguring&&r.triggerFieldChange({value:s,oldValue:e,userAction:f,valid:r.isValid})}else if(o.count)o.clear();else{const h=r._value;r._value=null,r.syncInputFieldValue(),r.syncEmpty(),r.isConfiguring||r.triggerFieldChange({value:s,oldValue:h,userAction:f,valid:r.isValid})}r._lastValue=r._value}hasChanged(s,e){return this.multiSelect?!w.isEqual(s,e):super.hasChanged(...arguments)}onComboStoreChange({action:s}){s!=="filter"&&this.syncInputFieldValue(!0)}syncInputFieldValue(s){var e;this.usesChipView?(e=this.chipView)==null||e.refresh():super.syncInputFieldValue(s)}get usesChipView(){return!!(this.multiSelect&&this._chipView)}get isEmpty(){return this.valueCollection.count===0}get inputValue(){const s=this;let e=s.selected?s.selected[s.displayField]:s.value;return s.displayValueRenderer&&(e=s.callback(s.displayValueRenderer,s,[s.selected,s])),e==null?"":e}get nonEditableClickTarget(){var s;return this.multiSelect&&((s=this.chipView)==null?void 0:s.element)||super.nonEditableClickTarget}changeValueCollection(s,e){if(e==null||e.destroy(),s)return s.isCollection||(s=new vt({internalListeners:{noChange:"onValueCollectionNoChange",change:"onValueCollectionChange",prio:-1e3,thisObj:this}})),s}changePrimaryFilter(s){return s.isCollectionFilter?s.setConfig({disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive}):(typeof s=="function"&&(s={filterBy:s}),s=new me({id:"primary",disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive,...s})),s}changeStore(s){const e=this,t=[],{valueCollection:i,keyStrokeFilterDelay:r,filterParamName:n}=e;if(Array.isArray(s)){e.items=s;return}let l;if(s){if(s.isStore){const a=s.filters.get("primary");e.remoteFilter&&(s.filterParamName=n),l=s.remoteFilter||s.restfulFilter,a?e.primaryFilter=a:t.push(e.primaryFilter)}else typeof s=="string"?s=Ce.getStore(s):(s=new(s.readUrl?Ci:Ce)(s),e.destroyStore=!0),l=e.remoteFilter||s.restfulFilter,l&&n&&(s.filterParamName=n,e.encodeFilterParams&&(s.encodeFilterParams=e.encodeFilterParams)),t.push(e.primaryFilter);if(!e.valueField&&!e.usingRecordAsValue&&(e.valueField=s.modelClass.idField),e.filterSelected){const a=o=>!e.containsFocus||!i.includes(o);l?(s.storage.autoFilter=!0,s.storage.addFilter({id:`${e.id}-selected-filter`,filterBy:a})):(t.push(a),s.reapplyFilterOnAdd=!0)}i.addIndex({property:e.displayField,unique:!1}),i.addIndex({property:e.valueField,unique:!0}),t.forEach(a=>s.addFilter(a,!0)),l?e.keyStrokeFilterDelay=Math.max(300,r||0):e.keyStrokeFilterDelay=r!=null?r:10}return s}updateStore(s,e){const t=this,{_picker:i}=t;let r;t.destroyStore&&e&&e.destroy(),i&&(i.store=s),s.storage.addIndex({property:t.displayField,unique:!1}),s.storage.addIndex({property:t.valueField,unique:!0}),r={filter:"onStoreFilter"},t.displayValueRenderer&&((r||(r={})).change="onComboStoreChange"),t.detachListeners("store"),s!=null&&s.storage&&t.valueCollection.match(s.storage),t.syncInputFieldValue(),r&&(r.name="store",r.thisObj=t,s.ion(r))}get remoteFilter(){var s;return!!(this.filterParamName||(s=this._store)!=null&&s.restfulFilter)}get record(){return this.selected}get records(){return this.valueCollection.values.slice()}get selected(){const{store:s}=this;return this.multiSelect?this.valueCollection.values.slice().sort((e,t)=>s.indexOf(e)-s.indexOf(t))[0]:this.valueCollection.first}onEditComplete(){const s=this,e=s.valueCollection.count;super.onEditComplete(),e&&(s.clearError(Gt),s.syncInputFieldValue()),s.required&&!e&&s.setError(Bs)}onTriggerClick(s){var e;const t=this,i="key"in s;if(!(t.ignoreTriggerClick||t.remoteFilter&&t.filterOnEnter)){if(t.pickerVisible)t.hidePicker();else if(!t.readOnly&&!t.disabled)switch((e=t.triggerAction)==null?void 0:e.toLowerCase()){case"all":t.doFilter(null,i);break;case"last":t.doFilter(t.lastQuery,i);break;default:t.doFilter(t.input.value,i)}}}internalOnInput(s){const e=this;e.syncEmpty(),e.syncInputWidth(),e.filterOnInput(s),e.trigger("input",{value:e.input.value,event:s})}filterOnInput(s){const e=this,{value:t}=s.type==="input"?s.target:e.input,i=t.length;e.inputting=!0,e.inlinePicker||i>=e.minChars&&(!e.filterOnEnter||s.key==="Enter")?e.doFilter(t):(e.validateFilter&&!e.remoteFilter&&e[i?"setError":"clearError"](Gt),e.hidePicker()),e.inputting=!1}syncInputWidth(){const s=this;if(s.usesChipView){const e=s.input,t=s._inputPadding||(s._inputPadding=v.getEdgeSize(e,"padding","lr")),i=e.value||"",r=v.measureText(i+"W",e,!1,s.element)+t.width;e.style.flex=`1 1 ${Math.ceil(r)}px`}}doFilter(s,e){var t;const i=this,{store:r,picker:n}=i,l=s==null||s==="";i.lastQuery=s,i.primaryFilter.setConfig({value:s,disabled:l}),i.remoteFilter&&r.clear(!0);const a=()=>{const{navigator:o,isVisible:u}=n;r.count?!l&&o&&(o.activeItem=0):!i.remoteFilter&&!l&&(o&&(o.activeItem=null),i.validateFilter&&i.setError(Gt)),u&&n.realign()};(t=i.filterPromise=r.filter())==null||t.then(()=>{i.filterPromise=null,a()}),i.inlinePicker||(n!=null&&n.isVisible?n.lastAlignSpec.zone===0&&n.realign():i.showPicker(e)),i.filterPromise||a()}onStoreFilter({source:s}){const e=this,t=e._picker,i=t==null?void 0:t.element.dataset,{count:r}=s;e.remoteFilter&&(r?t&&(t.navigator.activeItem=0):e.validateFilter&&e.setError(Gt),e.filterSelected&&e.valueCollection.count&&(s.storage.onFiltersChanged({action:"splice",oldCount:1}),t&&t.refresh())),i&&(e.createOnUnmatched&&!r&&e.primaryFilter.value!=null?i.addNewValue=e.L("L{addNewValue}")(e.primaryFilter.value):i==null||delete i.addNewValue)}onValueCollectionChange({source:s}){var e,t,i,r;const n=this,{multiSelect:l,_picker:a}=n,o=(e=n.hidePickerOnSelect)!=null?e:!l,u=l?s.values.slice():s.first,c=s.values.slice(),d=n._isUserAction||(a==null?void 0:a._isUserAction)||o&&n.pickerVisible||!1,f=n._value;if(o&&n.hidePicker(),!s.count&&n.required?n.setError(Bs):(n.clearError(Bs),n.clearError(Gt)),n.validateFilter&&u&&n.clearError(Gt),n.filterSelected){const h=a==null?void 0:a.navigator,p=Number((i=(t=h==null?void 0:h.activeItem)==null?void 0:t.dataset)==null?void 0:i.index);n.remoteFilter?(n.store.storage.onFiltersChanged({action:"splice",oldCount:1}),n._picker&&n._picker.refresh()):n.store.filter(),isNaN(p)||(h.activeItem=Math.min(a.store.count,p))}n._value=null,n._lastValue=null;const g=n.cacheCurrentValue(n.value);n.syncInputFieldValue(),n.syncEmpty(),n.isConfiguring||(n.triggerFieldChange({value:g,oldValue:f,userAction:d,valid:n.isValid}),(r=n.trigger)==null||r.call(n,"select",{record:u,records:c,userAction:d}),n.defaultAction==="select"&&n.trigger("action",{value:g,record:u,records:c,userAction:d}))}cacheCurrentValue(s){return this._value=s}onValueCollectionNoChange({toAdd:s}){!this.inlinePicker&&!this.multiSelect&&s.length&&this.pickerVisible&&(this.picker.hide(),this.syncInputFieldValue())}showPicker(){var s;const e=this,{picker:t}=e;e.readOnly||e.inlinePicker||(t.multiSelect=e.multiSelect,super.showPicker(...arguments),e.overlayAnchor&&!t.align.offset&&(t.align.offset=-t.anchorSize[1],t.realign()),t.restoreActiveItem&&(e.multiSelect?t.restoreActiveItem(((s=t.navigator)==null?void 0:s.previousActiveItem)||e.selected||0,!0):t.restoreActiveItem(e.selected||0,!0)),e.input.focus())}changePicker(s,e){if(s){const t=this,i=t.pickerWidth||(s==null?void 0:s.width),r=Ne.mergeConfigs({owner:t,store:t.store,selected:t.valueCollection,multiSelect:t.multiSelect,cls:t.listCls,displayField:t.displayField,forElement:t[t.pickerAlignElement],align:{matchSize:i==null,anchor:t.overlayAnchor,target:t[t.pickerAlignElement],minHeight:t.inlinePicker?null:Math.min(3,t.store.count)*40},[t.listItemTpl?"itemTpl":void 0]:t.listItemTpl,width:i,navigator:{keyEventTarget:t.input}},s);t.inlinePicker&&Object.assign(r,{floating:!1,align:null,activateOnMouseover:!1,maxHeight:null,appendTo:t.element}),s=Ne.reconfigure(e,s?r:null,t),s.element.classList.add("b-combo-picker"),s.element.dataset.emptyText=t.emptyText?t.L(t.emptyText):t.L("L{noResults}"),s.ion({navigate:"onPickerNavigate",thisObj:t}),B.on({element:s.element,pointerdown:n=>t.onPickerNavigate({event:n}),thisObj:t})}else e==null||e.destroy();return s}onPickerNavigate({event:s}){s.target.matches("[data-add-new-value]")&&this.addNewRecord(this.primaryFilter.value)}onPickerHide(){const s=this;super.onPickerHide(),s.multiSelect&&s.clearTextOnPickerHide&&(s.input.value="")}async internalOnKeyEvent(s){var e;const t=this,i=t.input[t.inputValueAttr],r=i.length,{key:n}=s,{primaryFilter:l,store:a,_picker:o,multiSelect:u}=t;if(s.type==="keydown"&&(o!=null&&o.isVisible)&&o.navigator){const{activeItem:c}=o.navigator;if(c&&u&&n===t.multiValueSeparator){t.input.value="",l.setConfig({value:"",disabled:!0}),a.filter(),o.onItemClick(c,s),o.hide(),s.preventDefault();return}if(!c&&t.createOnUnmatched&&(u&&n===t.multiValueSeparator||n==="Enter")){s.preventDefault(),await t.addNewRecord(i);return}}!t.editable&&t.pickerVisible&&(n==="Backspace"&&((e=l.value)!=null&&e.length)?(l.value=l.value.substring(0,l.value.length-1),t.store.filter(),o.restoreActiveItem(0)):s.type=="keypress"&&n.match(Jd)&&((!t.lastFilterKepressTime||s.timeStamp-t.lastFilterKepressTime>2e3)&&(l.value=""),l.setConfig({value:(l.value||"")+n,disabled:!1}),t.store.filter(),o.restoreActiveItem(0)),t.lastFilterKepressTime=s.timeStamp),super.internalOnKeyEvent(...arguments),s.type==="keydown"&&n==="Enter"&&t.filterOnEnter&&r>=t.minChars&&(s.stopPropagation(),t.filterOnInput.now(s))}async addNewRecord(s){var e,t;const i=this,{store:r,_picker:n,valueCollection:l,multiSelect:a,primaryFilter:o}=i,u=r.remoteFilter&&r.autoCommit;i.filterPromise&&await i.filterPromise,u||(o.setConfig({value:"",disabled:!0}),r.filter());const[c]=r.add(i.callback(i.createOnUnmatched,i,[s,i]));if(r.isCommitting){let d;try{await r.commitPromise}catch(f){d=(t=(e=f.response)==null?void 0:e.parsedJson)==null?void 0:t.error}c.isPhantom&&(i.clearError(),i.setError(d||Xd,!1,!0),r.remove(c),r.removed.remove(c))}u&&(o.setConfig({value:"",disabled:!0}),r.filter()),i.input.value="",r.includes(c)&&l.splice(a?l.count:0,a?0:l.count,c),n==null||n.hide()}changeCreateOnUnmatched(s){return s===!0&&(s=this.defaultRecordCreater),s}defaultRecordCreater(s){return this.store.createRecord({[this.displayField]:s})}updateLocalization(){var s;super.updateLocalization();const e=this,{displayField:t}=e;let{localizedDisplayFieldsMap:i}=e;if(e.localizeDisplayFields===!0){i||(e.localizedDisplayFieldsMap=i=new Map),!e.store&&e.buildItems&&(e.items=e.buildItems());for(const r of e.items)if(r.id){let n=i.get(r.id);!n&&((s=r[t])!=null&&s.startsWith("L{"))&&(n=r[t],i.set(r.id,n)),n&&(r[t]=e.L(n))}e.syncInputFieldValue()}}};x(Ft,"$name","Combo"),x(Ft,"type","combo"),x(Ft,"alias","combobox,dropdown"),x(Ft,"delayable",{filterOnInput:0});var ja=class extends Yt{static get $name(){return"ComboChipView"}static get type(){return"combochipview"}static get defaultConfig(){return{closeHandler:"up.onChipClose",itemsFocusable:!1,multiSelect:!0,itemTpl(s){return k.encodeHtml(s.getValue(this.owner.displayField))},scrollable:{overflowY:"auto"}}}},Zd=class extends Kt{static get $name(){return"ComboChipNavigator"}static get type(){return"combochipnavigator"}static get configurable(){return{allowShiftKey:!0}}onTargetClick(s){const e=this,t=s.target.closest(e.itemSelector);t&&!s.target.classList.contains("b-close-icon")&&(!s.shiftKey&&!t.contains(s.target.closest("[data-noselect]"))&&e.ownerCmp.selected.clear(),e.inClickHandler=!0,e.activeItem=t,e.inClickHandler=!1)}onKeyDown(s){s.key!=="Enter"&&!s.target.selectionStart&&!s.target.selectionEnd&&super.onKeyDown(s)}updateActiveItem(s,e){const t=this.ownerCmp;super.updateActiveItem(s,e),s&&!this.inClickHandler&&t.selected.add(t.getRecordFromElement(s))}navigatePrevious(s){const e=this.ownerCmp;e.navigator.activeItem&&!s.shiftKey&&e.selected.clear(),this.previous?super.navigatePrevious(s):this.activeItem=null}navigateNext(s){const e=this.ownerCmp;e.navigator.activeItem&&!s.shiftKey&&e.selected.clear(),this.next?super.navigateNext(s):this.activeItem=null}};Ft.initClass(),ja.initClass(),Zd.initClass(),Ft._$name="Combo";var Qd=s=>!s.value,Xt=class extends Ee{static get configurable(){return{inputType:"checkbox",autoCollapse:null,containerDefaults:{syncableConfigs:{disabled:s=>s.disabled||!s.value},syncConfigTriggers:{autoCollapse:1,value:1}},text:"",checkedValue:!0,uncheckedValue:!1,color:null,value:"",toggleGroup:null,localizableProperties:["label","text"]}}construct(s){"checked"in s&&(s=w.assign({},s),s.value=s.checked,delete s.checked),super.construct(s),this.syncHasText()}get textLabelCls(){return"b-checkbox-label"}get innerElements(){return[this.inputElement,{tag:"label",class:this.textLabelCls,for:`${this.id}-input`,reference:"textLabel",html:this.text||""}]}get inputElement(){const s=super.inputElement;return this.toggleGroup&&(s.dataset={group:this.toggleGroup}),s.listeners={click:"internalOnClick",change:"internalOnChange",input:"internalOnInput"},s}get checked(){return this.value}set checked(s){this.value=s}syncHasText(){this.element.classList[this.text?"add":"remove"]("b-text")}updateText(s){this.textLabel&&(this.syncHasText(),this.textLabel.innerHTML=s)}afterSyncChildConfigs(s){super.afterSyncChildConfigs(s);let{autoCollapse:e}=this;e&&(e=e===!0?Qd:e,s.collapsed=e(this))}assignFieldValue(s,e,t){this.value=t===this.checkedValue||(t===this.uncheckedValue?!1:null)}fetchInputValue(){this.readOnly||(this.value=this.input.checked)}gatherValue(s){var e;const t=this,i=t.value?t.checkedValue:t.uncheckedValue,r=i!==void 0,{valueName:n}=t;r&&(s[n]=i),t.gatherValues(s,r),i===!0&&((e=s[n])==null?void 0:e.value)===i&&delete s[n].value}changeValue(s){return s==="false"?!1:!!s}updateValue(s){var e;const t=this,i=t.input.checked!==s;t.input.checked=s,(e=t.container)==null||e.syncChildConfigs(),i&&!t.inputting&&!t.isConfiguring&&(t.uncheckToggleGroupMembers(),t.triggerChange(!1,null))}get inputValueAttr(){return"checked"}updateColor(s,e){const t=this.element.classList;e&&t.remove(e),s&&t.add(s)}getToggleGroupMembers(){const s=this,{checked:e,toggleGroup:t,input:i,type:r}=s,n=[];return e&&t&&v.forEachSelector(s.rootElement,`input[type=${r}][data-group=${t}]`,l=>{if(l!==i){const a=N.fromElement(l);a&&n.push(a)}}),n}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach(s=>s.checked=!1)}check(){this.checked=!0}uncheck(){this.checked=!1}toggle(){this.checked=!this.checked}internalOnClick(s){return this.readOnly?(s.preventDefault(),!1):this.trigger("click",{event:s})}internalOnChange(s){const e=this;if(e.readOnly&&e.value!==e.input.checked){e.input.checked=e.value;return}e.value=e.input.checked,e.inputting||(e.inputting=!0,e.triggerChange(!0,s),e.inputting=!1)}updateInputReadOnly(s){}triggerChange(s,e){const t=this,{checked:i}=t.input,r={checked:i,value:i,oldValue:!i,userAction:s,valid:!0,event:e};if(!i&&s&&t.toggleGroup&&t.getToggleGroupMembers().filter(l=>l.isVisible&&!l.disabled).length||t.trigger("beforeChange",r)===!1)t.input.checked=t._value=!i;else return t.triggerFieldChange(r,!1),s&&t.uncheckToggleGroupMembers(),t.trigger("action",r),t.trigger("change",r),!0}};x(Xt,"$name","Checkbox"),x(Xt,"type","checkbox"),x(Xt,"alias","check"),Xt.initClass(),Xt._$name="Checkbox";var Jt=class extends Ne{configure(s){super.configure(s),this.setItems(),this.ion({item:"onColorSelect"})}setItems(){const s=this,{colors:e,colorClasses:t}=s;let i=t||e;s.addNoColorItem&&(i=[...i],i.push(null)),s.items=i.map(r=>!r||typeof r=="string"?{color:r,text:(t?k.capitalize(r):r)||s.L("L{noColor}")}:r)}afterConfigure(){var s;super.afterConfigure(...arguments),(this.addNoColorItem||this.value)&&this.select((s=this.value)!=null?s:null)}updateColors(){this.isConfiguring||this.setItems()}updateAddNoColorItem(){this.isConfiguring||this.setItems()}onColorSelect({record:s}){var e;this.refresh();const t={color:s.color,record:s,bubbles:!0};(e=this.colorSelected)==null||e.call(this,t),this.trigger("colorSelected",t)}select(s){(!s||typeof s=="string")&&(s=this.store.findRecord("color",s!=null?s:null)),s&&super.select(s)}updateColumns(s){this.style=`grid-template-columns:repeat(${s}, 1fr);`}getColorClassName(s){var e,t;return(e=this.colorClasses)!=null&&e.includes(s)||(t=this.colorClasses)!=null&&t.find(i=>i&&i.color===s)?this.colorClassPrefix+s:s?"":"b-no-color"}};x(Jt,"$name","ColorPicker"),x(Jt,"type","colorpicker"),x(Jt,"configurable",{itemsFocusable:!1,navigator:{focusCls:"b-color-active"},itemWrapperTpl(s,e){const{selected:t}=this,{color:i,text:r}=s,n=this.getColorClassName(i);return qt.tpl`
                    <li
                        class="${this.getItemClasses(s,e)} ${n}"
                        role="option"
                        aria-selected="${t.includes(s)}"
                        data-index="${e}"
                        data-id="${k.encodeHtml(i)}"
                        data-btip="${r}"
                        ${this.itemsFocusable?'tabindex="-1"':""}
                        style="${n?"":"background-color: "+i}"
                    ></li>`},colorClasses:null,colorClassPrefix:null,colors:["#45171D","#F03861","#FF847C","#FECEA8","#A5F2E7","#AA83F3","#8983F3","#A10054","#073059","#2866AB","#5FBDC5","#D8D95C","#FFDEDE","#F7F3CE","#C5ECBE","#3E3E3E","#405559","#68868C","#EDEDED","#D3D6DB","#3A4750","#303841","#BE3144"],addNoColorItem:!0,columns:6,colorSelected:null}),Jt.initClass(),Jt._$name="ColorPicker";var Ai=class extends Ue{};x(Ai,"$name","Fit"),x(Ai,"type","fit"),x(Ai,"configurable",{containerCls:"b-fit-container",itemCls:"b-fit-item"}),Ai.initClass(),Ai._$name="Fit";var Zt=class extends qe{afterConfigure(){const s=this;super.afterConfigure(),s.onTargetSizeChange=s.onTargetSizeChange.bind(s),B.on({element:s.element,keydown:"onKeyDown",contextmenu:"stopMouseEvents",mousedown:"stopMouseEvents",mouseover:"stopMouseEvents",mouseout:"stopMouseEvents",mouseup:"stopMouseEvents",click:"stopMouseEvents",dblclick:"stopMouseEvents",thisObj:s}),s.ion({beforeHide:"beforeEditorHide",hide:"afterEditorHide",thisObj:s}),ge.ion({locale:"onLocaleChange",thisObj:s})}onLocaleChange(){const{inputField:s}=this;s&&!s.isDestroyed&&(s.syncInputFieldValue?s.syncInputFieldValue(!0):s instanceof Ee)}render(s){const e=this.element.parentNode,[t]=this.getRenderContext(this,s);t.classList.add("b-editing"),super.render(...arguments),e!=null&&e.classList&&t!==e&&e.classList.remove("b-editing")}async startEdit(s){var e,t,i;const r=this;if(s=w.assignIf(s,{align:r.align,hideTarget:r.hideTarget,matchSize:r.matchSize,matchFont:r.matchFont,fitTargetContent:r.fitTargetContent,focus:!0}),r.trigger("beforeStart",s)!==!1){const{target:n,hideTarget:l,matchSize:a,matchFont:o,fitTargetContent:u,record:c,field:d=r.inputField.name,focus:f}=s,{inputField:g}=r,{input:h}=g,p=v.getStyleValue(n,"font-size"),m=v.getStyleValue(n,"font-family");let{value:y,align:b}=s;if(c&&d&&(r.record=c,r.dataField=d,y===void 0&&(y=c.getValue(d))),a&&(n instanceof HTMLElement&&r.updateSize(n,a),n instanceof HTMLElement&&ce.addResizeListener(n,r.onTargetSizeChange)),h&&(o?(h.style.fontSize=p,h.style.fontFamily=m):h.style.fontSize=h.style.fontFamily=""),r.assigningValues=!0,(e=g.clearError)==null||e.call(g),"setValue"in g?await g.setValue(y):g.value=y,r.assigningValues=!1,typeof b=="string"&&(b={align:b}),await r.showBy({target:n,allowTargetOut:!0,...b}),u){const C=h.scrollWidth-h.clientWidth;C>0&&(r.width+=C+v.scrollBarWidth)}f&&((t=g.focus)==null||t.call(g)),n.nodeType===Element.ELEMENT_NODE&&l&&n.classList.add("b-hide-visibility"),r.editing=!0;const S=g.value;return r.trigger("start",{value:S}),Array.isArray(S)&&g.editingRecords&&((i=S[0])!=null&&i.isModel)?r.oldValue=S.map(C=>C.copy(C.id)):(r.oldValue=S,Array.isArray(r.oldValue)&&(r.oldValue=r.oldValue.slice())),g.initialValue=r.oldValue,!0}return!1}async refreshEdit(){if(this.isVisible){const{record:s,dataField:e,inputField:t}=this;if(s&&e){const i=s.getValue(e);w.isEqual(t.value,i)||await t.setValue(i)}}}finishEdit(){const{target:s,aligningToElement:e}=this.lastAlignSpec;e&&(s.classList.remove("b-editing"),s.classList.remove("b-hide-visibility")),this.editing=!1,this.trigger("finishEdit")}onKeyDown(s){var e;const t=this;switch(s.key){case t.completeKey:t.completeEdit(null,s),s.stopImmediatePropagation();break;case t.cancelKey:t.cancelEdit(s),s.stopImmediatePropagation();break}(e=t.trigger)==null||e.call(t,"keydown",{event:s})}stopMouseEvents(s){this.allowMouseEvents||s.stopPropagation()}onFocusOut(s){super.onFocusOut(s);const e=this;if(!e.isFinishing&&e.editing)switch(e.blurAction){case"cancel":e.cancelEdit(s);break;case"complete":e.completeEdit(null,s)}}async completeEdit(s,e){var t,i,r,n;const l=this,{inputField:a,oldValue:o,record:u}=l,c=a.invalidAction||(a.allowInvalid===!1?"block":l.invalidAction),{value:d}=a;if(l.isVisible){if(!a.isValid&&c!=="allow"){if(c==="block")return(t=a.focus)==null||t.call(a),!1;if(c==="revert")return l.cancelEdit(e)!==!1}else{if(w.isEqual(d,o))return l.cancelEdit(e)!==!1;{const f={inputField:a,record:u,value:d,oldValue:o};if(l.trigger("beforeComplete",f)===!1)(i=a.focus)==null||i.call(a);else if(s||(s=f.finalize||((r=f.editorContext)==null?void 0:r.finalize)),s){let g=await s(f);if(g===!0)l.onEditComplete();else{if(a.setError){const h=g||a.invalidValueError,p=()=>{m(),a.clearError(h)},m=a.ion({change:p,input:p});a.setError(h)}c==="block"?(n=a.focus)==null||n.call(a):c==="revert"&&(await a.setValue(o),g=!0),g=!1}return g}else return l.onEditComplete(),!0}}return!1}}cancelEdit(s){var e;const t=this,{inputField:i,oldValue:r}=t,{value:n}=i;if(t.editing&&!t.isFinishing&&t.trigger("beforeCancel",{value:n,oldValue:r,event:s})!==!1)(e=i.clearError)==null||e.call(i),t.isFinishing=!0,t.hide(),t.trigger("cancel",{value:n,oldValue:r,event:s}),t.finishEdit(),t.isFinishing=!1;else return!1}onEditComplete(){const s=this,{record:e,dataField:t,inputField:i,oldValue:r}=s,{value:n}=i;if(!s.isFinishing){if(s.isFinishing=!0,s.hide(),e){const l=`set${k.capitalize(t)}`;e[l]?e[l](n):e.setValue(t,n)}s.trigger("complete",{value:n,oldValue:r}),s.finishEdit(),s.isFinishing=!1}}doDestroy(){this.createdInputField&&this.inputField.destroy(),super.doDestroy()}set owner(s){this._owner=s}get owner(){return this._owner||N.fromElement(this.element.parentNode)}changeInputField(s,e){const t=this;return e&&e.destroy(),typeof s=="string"&&(s={type:s}),s instanceof N||(s=N.create(s),t.createdInputField=!0),t.completeOnChange&&s.ion({change:"onInputFieldChange",thisObj:t}),s.parent=t,s}updateInputField(s){this.removeAll(),this.add(s)}get inputField(){return this.items[0]}onInputFieldChange(){this.containsFocus&&this.completeEdit()}onTargetSizeChange(s,e,t){e&&t&&this.updateSize(s)}updateSize(s,e=this.lastMatchSize){const t=this,i=K.inner(s);t.width=e.width===!1?"auto":i.width-t.align.offset[0],t.height=e.height===!1?"auto":i.height,t.lastMatchSize=e}beforeEditorHide(){if(this.editing&&!this.isFinishing)return this.cancelEdit(),!1}afterEditorHide(){this.positioned&&this.element.remove(),ce.removeResizeListener(this.lastAlignSpec.target,this.onTargetSizeChange)}};x(Zt,"$name","Editor"),x(Zt,"type","editor"),x(Zt,"configurable",{positioned:!0,hidden:!0,layout:"fit",align:{align:"t0-t0",offset:[0,0]},hideTarget:!1,matchSize:!0,matchFont:!0,fitTargetContent:!1,inputField:"textfield",blurAction:"complete",completeKey:"Enter",cancelKey:"Escape",invalidAction:"block",completeOnChange:null,isolateFields:!0}),Zt.initClass(),Zt._$name="Editor";export{ht as AjaxHelper,Ci as AjaxStore,Se as Animator,fi as ArrayDataField,V as ArrayHelper,zr as AsyncHelper,Os as Badge_default,yi as Bag,R as Base,zt as BooleanDataField,j as BrowserHelper,Mi as Button,gs as CSSHelper,Xt as Checkbox,Yt as ChipView,hr as ClickRepeater,Di as CollapseTool,vt as Collection,me as CollectionFilter,pi as CollectionSorter,Jt as ColorPicker,Ft as Combo,ie as Config,qe as Container,Aa as ContextMenuBase,Me as DataField,os as DateDataField,z as DateHelper,Mt as DayTime,lt as Delayable_default,Z as DomClassList,Hl as DomDataStore,v as DomHelper,bt as DomSync,rr as Duration,Ut as DynamicObject,Zt as Editor,B as EventHelper,De as Events_default,Vt as Factoryable_default,Ee as Field,Li as FieldContainer,$e as Fullscreen,re as FunctionHelper,be as GlobalEvents_default,sr as IdHelper,di as Identifiable_default,$t as InstancePlugin,Bt as IntegerDataField,ta as KeyMap_default,Ba as Labelable_default,Ue as Layout,Ne as List,Bd as LoadMaskable_default,_e as LocaleHelper,ge as LocaleManager_default,ti as Localizable_default,Si as Mask,ot as Menu,Dt as MenuItem,ue as Model,ir as ModelDataField,pl as ModelLink_default,fl as ModelStm_default,Kt as Navigator,jt as NumberDataField,us as ObjectDataField,w as ObjectHelper,$ as Objects,yr as Panel,Et as PanelCollapser,ki as PickerField,sl as Pluggable_default,nt as Point,Oi as Popup,cr as Promissory,ia as RTL_default,K as Rectangle,wi as Renderable,ce as ResizeMonitor,Ti as Ripple,xs as Rotatable_default,za as ScrollManager,vs as Scroller,ci as StateProvider,Nt as StateStorage,ns as State_default,Ce as Store,Dl as StoreCRUD_default,$l as StoreChained_default,_l as StoreChanges_default,hi as StoreDataField,Ml as StoreFilter_default,Il as StoreGroup_default,Ol as StoreProxy_default,Fl as StoreRelation_default,Al as StoreSearch_default,Pl as StoreSort_default,Nl as StoreState_default,jl as StoreStm_default,Ll as StoreSum_default,zl as StoreSync_default,Vl as StoreTree_default,tr as StringDataField,k as StringHelper,qt as TemplateHelper,Ot as TextField,$s as TimeZoneHelper,St as Tool,Is as Toolable_default,Ls as Toolbar,It as Tooltip,hl as TreeNode_default,le as VersionHelper,lr as WalkHelper,nr as Wbs,N as Widget,eo as __privateAdd,Qa as __privateGet,to as __privateSet,x as __publicField,rl as parseAlign,We as unitMagnitudes};
//# sourceMappingURL=chunk-MZVS5JQA.js.map
