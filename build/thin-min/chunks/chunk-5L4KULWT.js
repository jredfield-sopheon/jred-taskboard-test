/*!
 *
 * Bryntum TaskBoard 5.6.2
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
import{Splitter as F}from"./chunk-PKK32ALQ.js";import{SummaryFormatter_default as W}from"./chunk-JZO6LOO7.js";import{Column as k,ColumnStore as N,GridFeatureManager as G}from"./chunk-GGOYEX2W.js";import{ResizeHelper as U}from"./chunk-6ZLMCHE5.js";import{ArrayHelper as Y,AsyncHelper as M,Base as q,BrowserHelper as X,DateHelper as J,DomHelper as v,EventHelper as K,InstancePlugin as B,Menu as Q,ObjectHelper as y,Rectangle as C,__privateAdd as Z,__privateGet as ee,__privateSet as I,__publicField as b}from"./chunk-MZVS5JQA.js";var S=class extends k{construct(){var e;super.construct(...arguments);const t=this,{grid:i}=t;t.menu=new Q({owner:i,rootElement:i.rootElement,autoShow:!1,align:"t50-b50",anchor:!0,internalListeners:{hide(){t.picker.navigator.activeItem=null,delete t._editingRecord}},items:[Object.assign({type:t.colorEditorType,ref:"list",addNoColorItem:t.addNoColorItem,colorSelected({color:r}){var l;(l=t._editingRecord)==null||l.set(t.field,r),t.menu.hide()}},(e=t.colors)!=null&&e.length?{colors:t.colors}:{})]})}applyValue(e,t,i){if(!this.isConstructing){const{picker:r}=this;t==="colors"?r.colors=i:t==="addNoColorItem"&&(r.addNoColorItem=i)}super.applyValue(...arguments)}get picker(){return this.menu.widgetMap.list}renderer({value:e}){let t="b-empty",i=e;if(e){const r=this.picker.getColorClassName(e);r?(t=r,i=null):t=""}return{className:"b-color-cell-inner "+t,style:{backgroundColor:i},"data-btip":e}}onCellClick({grid:e,record:t,target:i}){if(i.classList.contains("b-color-cell-inner")&&!this.readOnly&&!e.readOnly&&!t.isSpecialRow&&!t.readOnly){const{picker:r,menu:l}=this,s=t.get(this.field);this._editingRecord=t,r.deselectAll(),r.select(s),r.refresh(),l.showBy(i)}}};b(S,"$name","ColorColumn"),b(S,"type","color"),b(S,"fields",[{name:"colorEditorType",defaultValue:"colorpicker"},"colors",{name:"addNoColorItem",defaultValue:!0}]),b(S,"defaults",{align:"center",editor:null}),N.registerColumnType(S),S._$name="ColorColumn";var V=class extends W(B){static get $name(){return"GroupSummary"}static get configurable(){return{collapseToHeader:null,target:"footer"}}construct(e,t){if(this.grid=e,super.construct(e,t),!e.features.group)throw new Error("Requires Group feature to work, please enable");this.bindStore(e.store),e.rowManager.ion({beforeRenderRow:"onBeforeRenderRow",renderCell:"renderCell",prio:1e3,thisObj:this})}bindStore(e){this.detachListeners("store"),e.ion({name:"store",update:"onStoreUpdate",prio:1,thisObj:this})}get store(){return this.grid.store}doDisable(e){this.updateTarget(this.target),super.doDisable(e)}changeTarget(e){return y.assertString(e,"target"),e}updateTarget(e){this.store.useGroupFooters=!this.disabled&&e==="footer",this.isConfiguring||this.store.group()}changeCollapseToHeader(e){return y.assertBoolean(e,"collapseToHeader"),e}updateCollapseToHeader(){this.isConfiguring||this.store.group()}static get pluginConfig(){return{chain:["bindStore"]}}onBeforeRenderRow({row:e,record:t}){e.isGroupFooter&&!("groupFooterFor"in t.meta)?(e.isGroupFooter=!1,e.forceInnerHTML=!0):e.isGroupHeader&&!t.meta.collapsed&&e.eachElement(this.removeSummaryElements)}removeSummaryElements(e){}renderCell({column:e,cellElement:t,row:i,record:r,size:l,isFirstColumn:s}){const n=this,{meta:a}=r,{rowHeight:o}=n.grid,d="groupRowFor"in a,c="groupFooterFor"in a,u=n.target==="header",h={"b-group-footer":0,"b-header-summary":0},m=d&&(u||n.collapseToHeader&&a.collapsed)&&!s||c&&!u;if((d||c)&&(l.height=d&&l.height||o),n.store.isGrouped&&m&&!n.disabled){e.clearCell(t);const w=d?r:a.groupRecord;i.isGroupFooter=c,i.isGroupHeader=d,c?h["b-group-footer"]=1:h["b-header-summary"]=1;const g=n.updateSummaryHtml(t,e,w),H=typeof g=="number"?g:g.count;H>1&&(l.height+=a.collapsed&&!u?0:H*o*.1),g.height&&(l.height+=g.height)}i.assignCls(h)}updateSummaryHtml(e,t,i){const r=i.groupChildren.slice();r[r.length-1].isGroupFooter&&r.pop();const l=this.generateHtml(t,r,"b-grid-group-summary",i,i.meta.groupField,i.meta.groupRowFor);return e.children.length?v.sync(l,e.firstElementChild):e.innerHTML=l,t.summaries?t.summaries.length:t.sum?1:0}onStoreUpdate({source:e,changes:t}){if(!this.disabled&&e.isGrouped){if(t&&e.groupers.find(r=>r.field in t))return;Object.keys(t).some(r=>{const l=this.grid.columns.get(r);return!!l&&(!!l.sum||!!l.summaries)})&&(this.grid.forceFullRefresh=!0)}}refresh(){this.grid.columns.visibleColumns.forEach(e=>{this.hasSummary(e)&&this.grid.refreshColumn(e)})}hasSummary(e){return e.sum||e.summaries}};V.featureClass="b-group-summary",V._$name="GroupSummary",G.registerFeature(V);var _=class extends B{construct(e,t){const i=this;super.construct(...arguments),i.resizer=new U({name:"rowResize",targetSelector:".b-grid-row:not(.b-group-header)",handleContainerSelector:".b-grid-row",outerElement:e.element,direction:"vertical",dragThreshold:1,handleSize:Math.min(5,e.rowHeight*.1),internalListeners:{beforeresizestart:i.onBeforeResizeStart,resizestart:i.onResizeStart,resizing:i.onResizing,resize:i.onResize,cancel:i.onCancel,thisObj:i},allowResize(r,l){var s;return(s=e.hoveredCell)==null?void 0:s.matches(i.cellSelector)},overTopHandle(r,l){if(this.canResize(l,r)&&l.dataset.index!=="0"){const s=C.from(l);return s.height=this.handleSize,s.height>0&&Math.abs(s.top-K.getPagePoint(r).top)<this.handleSize}return!1},internalBeforeStart(r){const{edge:l,element:s}=r;if(l==="top")return{edge:"bottom",element:s.previousElementSibling}},onResizeHandlePointerDown(r){e.selectionDisabled=!0,e.features.rowReorder&&(i._oldReorderDisabled=e.features.rowReorder.disabled,e.features.rowReorder.disabled=!0),e.setTimeout(()=>{e.selectionDisabled=!1},10)}})}doDestroy(){var e;(e=this.resizer)==null||e.destroy(),super.doDestroy()}onBeforeResizeStart(){return!this.disabled}onResizeStart({source:e,context:t}){const{client:i}=this,r=this.applyToAllRows||i.fixedRowHeight;t.record=i.store.getById(t.element.dataset.id),t.oldHeight=t.record.rowHeight,i.store.suspendAutoCommit(),Object.assign(e,{minHeight:this.minHeight,maxHeight:this.maxHeight,skipUpdatingElement:!r}),i.element.classList.add("b-row-resizing")}onResizing({context:e}){!this.applyToAllRows&&!this.client.fixedRowHeight&&e.valid&&(e.record.rowHeight=e.newHeight)}onResize({context:e}){const{client:t}=this;this.applyToAllRows||t.fixedRowHeight?t.rowHeight=e.newHeight:t.selectionMode.multiSelect&&t.selectedRecords.includes(e.record)&&t.selectedRecords.forEach(i=>i.rowHeight=e.newHeight),this.cleanup()}onCancel({context:e}){!this.applyToAllRows&&!this.client.fixedRowHeight&&(e.record.rowHeight=e.oldHeight),this.cleanup()}cleanup(){const{client:e}=this;e.element.classList.remove("b-row-resizing"),e.store.resumeAutoCommit(),typeof this._oldReorderDisabled=="boolean"&&(e.features.rowReorder.disabled=this._oldReorderDisabled)}};b(_,"$name","RowResize"),b(_,"configurable",{applyToAllRows:null,cellSelector:".b-grid-cell",minHeight:20,maxHeight:0}),_._$name="RowResize",G.registerFeature(_,!1);var z=Object.freeze({animate:!1,block:"start"}),j=Object.freeze({animate:!1,block:"end"}),T=7,A={split:1,unsplit:1},x,R=class extends B{constructor(){super(...arguments),Z(this,x,!1),b(this,"restorers",[])}doDestroy(){this.unsplit(!0),super.doDestroy()}doDisable(e){const t=this;t.isConfiguring||(e?(t._disabledSplitOptions=t._splitOptions,t.unsplit()):t._disabledSplitOptions&&(t.split(t._disabledSplitOptions),t._disabledSplitOptions=null))}get isSplit(){var e;return!!((e=this.widgets)!=null&&e.length)}getClientConfig(e,t,i,r={}){const{client:l}=this,{subGrids:s,regions:n}=l,a=l.columns.records.slice(),o=y.assign({},l.subGridConfigs);if(l.eachSubGrid(u=>{const h=o[u.region];u.flex?h.flex=u.flex:h.width=u.element.style.width}),i.atColumn&&n.length>1&&t>0){const u=n.indexOf(i.atColumn.region);for(let h=0;h<u;h++){const m=s[n[h]];Y.remove(a,...m.columns.records),delete o[n[h]]}}const d=y.assign({},l.initialConfig,{appendTo:e,insertFirst:null,insertBefore:null,splitFrom:l,owner:l.owner,tbar:l.initialConfig.tbar&&t===1?{height:l.tbar.height,items:[" "]}:null,store:l.store,selectedRecordCollection:l.selectedRecordCollection,subGridConfigs:o,columns:this.cloneColumns(a),minHeight:0,minWidth:0},r);for(const u of y.keys(this.relayProperties))d[u]=l[u];const c={};for(const u in l.listeners)if(!A[u]){const h=l.listeners[u].filter(m=>!m.$internal);h.length&&(c[u]=h)}return d.listeners=c,(i.direction==="horizontal"||i.direction==="both"&&t!==1)&&(d.hideHeaders=!0),delete d.data,delete d.adopt,d}cloneColumns(e){return e.flatMap(t=>{if(t.meta.isSelectionColumn||t.field==="expanderActionColumn")return[];const i={...t.data};return t.children&&(i.children=t.children.map(r=>({...r.data}))),delete i.headerRenderer,delete i.parentId,i})}cloneClient(e,t,i,r){const l=this.getClientConfig(e,t,i,r),s=new this.client.constructor(l);return s.element.classList.add("b-split-clone"),s}processOptions(e){var t;const{client:i}=this,{atRecord:r,atColumn:l,direction:s}=e;if(!s)r&&l?e.direction="both":l?e.direction="vertical":e.direction="horizontal";else{if(s!=="vertical"&&!r&&i.store.count){const n=i._bodyRectangle.height/2+i.scrollable.y,a=(t=i.rowManager.getRowAt(n,!0))!=null?t:i.rowManager.rows[Math.ceil(i.rowManager.rows.length/2)];e.atRecord=i.store.getById(a.id)}if(s!=="horizontal"&&!l){const n=C.from(i.element);let a=n.center.x-n.x,o=i.subGrids[i.regions[0]],d=0,c=null;for(;a>o.width;)a-=o.width,o=i.subGrids[i.regions[++d]];a+=o.scrollable.x;const{visibleColumns:u}=o.columns;let h=0,m=0;for(;h<a&&m<u.length;)c=u[m++],h+=c.element.offsetWidth;e.atColumn=c}}return e}createSplitContainer({direction:e}){const{client:t}=this,{element:i}=t;return this.splitContainer=v.createElement({parent:i.parentElement,className:{"b-split-container":1,[`b-split-${e}`]:1,"b-rtl":t.rtl},style:{width:i.style.width,height:i.style.height},children:[e!=="both"&&i,e==="both"&&{className:"b-split-top",children:[i]},e==="both"&&{className:"b-split-bottom"}]})}syncHeaderHeights(){let e=0;for(const t of this.subViews)t.eachSubGrid(i=>{i.header.height>e&&(e=i.header.height)});for(const t of this.subViews)t.eachSubGrid(i=>{i.header.height=e})}toggleOriginalSubGrids(e){const t=this,{client:i}=t,{regions:r}=i;if(e.atColumn&&r.length>1){const l=r.indexOf(e.atColumn.region),s=[i];e.direction==="both"&&s.push(t.subViews[2]);for(const n of s)if(l+1<r.length){const a=n===i,o=n.subGrids[r[l]];o.hideSplitter(),a&&t.restorers.push(()=>o.showSplitter()),o.flex||(i.inForEachOther=!0,o.flex=1,i.inForEachOther=!1,a&&t.restorers.push(()=>{o.flex=null,o.width=o._initialWidth}));for(let d=l+1;d<r.length;d++){const c=n.subGrids[r[d]];c.hide(),a&&t.restorers.push(()=>{c.show()})}r.length===2&&(n._initialWidth=n.element.style.width,n._initialFlex=n.flex,n.width=o._initialWidth,a&&t.restorers.push(()=>{n._initialFlex!==null?n.flex=n._initialFlex:n._initialWidth!==null&&(n.width=n._initialWidth)}))}}}async split(e={}){const t=this,{client:i}=t;if(i.splitFrom)return;t.isSplit&&await t.unsplit(!0);const{rtl:r}=i,{atRecord:l,atColumn:s,direction:n}=t.processOptions(e);let{splitX:a,remainingWidth:o}=e,d=null,c=null;if(l){await i.scrollRowIntoView(l);const p=i.getRowFor(l);if(!p)throw new Error(`Could not find row for record ${l.id}`);d=C.from(p.cells[0],i.element).bottom,c=C.from(i.element).height-d}if(s&&!a&&(a=C.from(s.element,i.element).getEnd(r),o=C.from(i.element).width-a-v.scrollBarWidth,r)){const p=a;a=o+v.scrollBarWidth,o=p-v.scrollBarWidth}const u=[],h=t.createSplitContainer(e),{visibleColumns:m}=i.columns,w=s?m[m.indexOf(s)+1]:null,g=l?i.store.getNext(l):null;if(i.eachSubGrid(p=>p._initialWidth=p.width),i.columns.commit(),n!=="both"){const p={flex:`0 0 ${(d!=null?c:o)-T}px`,height:null},[,f]=t.widgets=[new F({appendTo:h}),t.cloneClient(h,n==="vertical"?1:0,e,p)];a!=null&&(i.renderRows(),e.atDate||(u.push(i.scrollColumnIntoView(s,j)),w&&u.push(f.scrollColumnIntoView(w,z)))),d!=null&&u.push(f.scrollRowIntoView(g,z)),i.element.classList.add("b-split-start"),f.element.classList.add("b-split-end"),i.scrollable.addPartner(f.scrollable,{x:n==="horizontal",y:n!=="horizontal"})}else{const p={flex:`0 0 ${o-T}px`};h.lastElementChild.style.flex=`0 0 ${c-T}px`,t.widgets=[new F({insertBefore:h.lastElementChild}),t.topSplitter=new F({appendTo:h.firstElementChild}),t.cloneClient(h.firstElementChild,1,e,p),t.cloneClient(h.lastElementChild,0,e),t.bottomSplitter=new F({appendTo:h.lastElementChild}),t.cloneClient(h.lastElementChild,2,e,p)];const f=i,D=t.widgets[2],E=t.widgets[3],O=t.widgets[5];f.element.classList.add("b-split-top-start"),D.element.classList.add("b-split-top-end"),E.element.classList.add("b-split-bottom-start"),O.element.classList.add("b-split-bottom-end"),a!=null&&(f.renderRows(),E.renderRows(),s&&!e.atDate&&(u.push(i.scrollColumnIntoView(s,j)),w&&u.push(D.scrollColumnIntoView(w,z)))),d!=null&&u.push(E.scrollRowIntoView(g,z),O.scrollRowIntoView(g,z)),f.scrollable.addPartner(D.scrollable,"y"),f.scrollable.addPartner(E.scrollable,"x"),D.scrollable.addPartner(O.scrollable,"x"),E.scrollable.addPartner(O.scrollable,"y"),t.topSplitter.ion({splitterMouseDown:"onSplitterMouseDown",drag:"onSplitterDrag",drop:"onSplitterDrop",thisObj:t}),t.bottomSplitter.ion({splitterMouseDown:"onSplitterMouseDown",drag:"onSplitterDrag",drop:"onSplitterDrop",thisObj:t})}t.subViews=[i,...t.widgets.filter(p=>p.isGridBase)],t.toggleOriginalSubGrids(e),t.syncHeaderHeights(),t._splitOptions=e,await Promise.all(u);const H=C.from(i.element);return i.onInternalResize(i.element,H.width,H.height),i.eachSubGrid(p=>{const f=C.from(p.element);p.onInternalResize(p.element,f.width,f.height)}),i.scrollable.x+=.5,i.scrollable.y+=.5,t.startSyncingColumns(),i.trigger("split",{subViews:t.subViews,options:e}),t.subViews}async unsplit(e=!1){var t;const i=this,{client:r}=i,{element:l}=r;if(i.isSplit&&(i.stopSyncingColumns(),(t=i.widgets)==null||t.forEach(s=>s.destroy()),i.widgets=null,r.eachSubGrid(s=>s.scrollable.x),r.scrollable.y,i.splitContainer.parentElement.appendChild(l),i.splitContainer.remove(),i.splitContainer=null,l.style.flexBasis=l.style.flexGrow="",l.classList.remove("b-split-top-start","b-split-start"),i.subViews.length=0,!i.isDestroying)){r.renderRows(),i.unsplitCleanup();for(const s of i.restorers)s();if(i.restorers.length=0,await M.animationFrame(),await M.animationFrame(),i.isDestroyed)return;!e&&r.trigger("unsplit"),i._splitOptions=null}}unsplitCleanup(){}populateCellMenu({record:e,column:t,items:i}){const r=this,{isSplit:l}=r,{splitFrom:s}=r.client;r.disabled||(i.splitGrid={text:"L{split}",localeClass:r,icon:"b-icon b-icon-split-vertical",weight:500,separator:!0,hidden:l||s,menu:{splitHorizontally:{text:"L{horizontally}",icon:"b-icon b-icon-split-horizontal",localeClass:r,weight:100,onItem(){r.split({atRecord:e})}},splitVertically:{text:"L{vertically}",icon:"b-icon b-icon-split-vertical",localeClass:r,weight:200,onItem(){r.split({atColumn:t})}},splitBoth:{text:"L{both}",icon:"b-icon b-icon-split-both",localeClass:r,weight:300,onItem(){r.split({atColumn:t,atRecord:e})}}}},i.unsplitGrid={text:"L{unsplit}",localeClass:r,icon:"b-icon b-icon-clear",hidden:!(l||s),weight:400,separator:!0,onItem(){(s||r).unsplit()}})}startSyncingColumns(){for(const e of this.subViews)e.columns.ion({name:"columns",change:"onColumnsChange",thisObj:this})}stopSyncingColumns(){this.detachListeners("columns")}onColumnsChange({source:e,isMove:t,action:i,parent:r,records:l,changes:s}){var n,a;const o=this;if(!ee(o,x)){I(o,x,!0);for(const d of o.subViews){const{columns:c}=d;if(e!==c){if(i==="update"&&s.region&&Object.keys(s).length===1){if(c.getById(l[0].id))c.remove(l[0].id);else{const[u]=l,h=(n=c.getById(o.$before.parent.id))!=null?n:c.rootNode,m=o.$before.id!==null&&c.getById(o.$before.id);h.insertChild(u.data,m)}o.$before=null}else if(!(t!=null&&t[l[0].id])&&t!==!0)if(i==="add"){const u=l.filter(h=>d.getSubGridFromColumn(h));c.add(o.cloneColumns(u))}else c.applyChangesFromStore(e);else if(i==="add"){const u=l[0],h=u.nextSibling,m=c.getById(u.id);if(!m){o.$before={id:h==null?void 0:h.id,parent:r},I(o,x,!1);continue}if(u.meta.isSelectionColumn){I(o,x,!1);continue}const w=(a=c.getById(r.id))!=null?a:c.rootNode,g=h&&c.getById(h.id);w.insertChild(m,g)}c.commit()}}e.commit(),I(o,x,!1)}}getOtherSplitter(e){return e===this.topSplitter?this.bottomSplitter:this.topSplitter}onSplitterMouseDown({source:e,event:t}){t.handled||(t.handled=!0,this.getOtherSplitter(e).onMouseDown(t))}onSplitterDrag({source:e,event:t}){t.handled||(t.handled=!0,this.getOtherSplitter(e).onMouseMove(t))}onSplitterDrop({source:e,event:t}){t.handled||(t.handled=!0,this.getOtherSplitter(e).onMouseUp(t))}afterConfigChange({name:e,value:t}){this.isSplit&&this.relayProperties[e]&&this.syncSplits(i=>{i[e]=t})}afterAddListener(e,t){this.isSplit&&!t.$internal&&!A[e]&&this.syncSplits(i=>i.on(e,t))}afterRemoveListener(e,t){t.$internal||this.syncSplits(i=>i.un(e,t))}forEachOther(e){const t=this.client.splitFrom||this.client;if(t.features.split.enabled&&!t.inForEachOther){t.inForEachOther=!0;for(const i of t.subViews)i!==this.client&&e(i);t.inForEachOther=!1}}syncSplits(e){this.forEachOther(e)}};x=new WeakMap,b(R,"$name","Split"),b(R,"featureClass",""),b(R,"configurable",{subViews:[],relayProperties:{value:{readOnly:1,rowHeight:1},$config:{merge:"merge"}}}),b(R,"pluginConfig",{chain:["populateCellMenu","afterConfigChange","afterAddListener","afterRemoveListener"],assign:["split","unsplit","subViews","syncSplits"]}),R._$name="Split",G.registerFeature(R,!1);var $=class extends q{static get defaultConfig(){return{target:null,defaultColumnWidth:100,exportDateAsInstance:!0,showGroupHeader:!0,columns:null,indent:!0,indentationSymbol:"\xA0\xA0\xA0\xA0"}}export(e={}){const t=this;return e=y.assign({},t.config,e),t.normalizeColumns(e),t.generateExportData(e)}generateExportData(e){const t=this,i=t.generateColumns(e);return{rows:t.generateRows(e),columns:i}}normalizeColumns(e){const t=e.columns||this.target.columns.visibleColumns.filter(i=>i.exportable!==!1);e.columns=t.map(i=>typeof i=="string"?this.target.columns.find(r=>r.field===i)||{field:i}:i)}generateColumns(e){return e.columns.map(t=>this.processColumn(t,e))}generateRows(e){const{columns:t,rows:i}=e;if(t.length===0||(i==null?void 0:i.length)===0)return[];const r=this,{target:l}=r;return(i||l.store).map(s=>r.processRecord(s,t,e)).filter(s=>s==null?void 0:s.length)}getColumnType(e,t=this.target.store){let i=e.exportedType||"object";if(e.exportedType===void 0&&e.field){const r=t.modelClass.getFieldDefinition(e.field);r&&r.type!=="auto"&&(i=r.type)}return i}processColumn(e,t){const i=this,{target:r}=i,{defaultColumnWidth:l}=t;let{field:s,text:n,width:a,minWidth:o}=e;if(s in r.store.modelClass.fieldMap||(s=""),!n||!a){const d=r.columns.find(c=>c.field===s);n||(n=d&&d.text||s),a==null&&(a=d&&d.width||l)}return a=Math.max(a||l,o||l),{field:s,value:n,width:a,type:i.getColumnType(e)}}processRecord(e,t,i){const{target:r}=this,{showGroupHeader:l,indent:s,indentationSymbol:n}=i;let a;return e?e.isSpecialRow?l&&e.meta.groupRowFor&&(a=t.map(o=>r.features.group.buildGroupHeader({cellElement:v.createElement(),grid:r,record:e,column:o}))):a=t.map(o=>{let d=e.getValue(o.field);const c=o.renderer||o.defaultRenderer;return c&&!(d&&o.isDateColumn&&i.exportDateAsInstance)&&(d=c.call(o,{value:d,record:e,column:o,grid:r,isExport:!0})),s&&o.tree&&(d=`${n.repeat(e.childLevel)}${d}`),d}):a=t.map(()=>""),a}};$._$name="TableExporter";var P=class{constructor(e){this._value=e}get value(){return this._value}toString(){return this.value?"\u2713":""}};P._$name="BooleanUnicodeSymbol";var L=class extends B{static get $name(){return"ExcelExporter"}static get defaultConfig(){return{filename:null,dateFormat:"YYYY-MM-DD",exporterClass:$,exporterConfig:null,zipcelx:null,convertEmptyValueToEmptyString:!0}}processValue(e){return e==null||Number.isNaN(e)||typeof e=="function"||typeof e=="object"&&String(e)==="[object Object]"?"":e}generateExportData(e){const t=this,{rows:i,columns:r}=t.exporter.export(e.exporterConfig);return{rows:i.map(l=>l.map((s,n)=>{var a;s instanceof Date?s=J.format(s,e.dateFormat):typeof s=="boolean"&&(s=new P(s)),t.convertEmptyValueToEmptyString&&(s=t.processValue(s));const o=((a=r[n])==null?void 0:a.type)==="number"?"number":"string";return{value:s,type:o}})),columns:r.map(l=>{let{field:s,value:n,width:a,type:o}=l;return o="string",{field:s,value:n,width:a,type:o}})}}export(e={}){const t=this,i=t.zipcelx||globalThis.zipcelx;if(!i)throw new Error('ExcelExporter: "zipcelx" library is required');if(t.disabled)return;e=y.assign({},t.config,e),e.filename||(e.filename=t.client.$$name);const{filename:r}=e,{rows:l,columns:s}=t.generateExportData(e);if(e.csv){const n=e.csv.columnDelimiter||",",a=e.csv.lineDelimiter||`
`,o=s.map(u=>this.processCsvValue(u.value)).join(n)+a,d=l.map(u=>u.map(h=>this.processCsvValue(h.value)).join(`${n}`)).join(a),c=new Blob([o+d],{type:"text/csv"});return X.downloadBlob(c,r),Promise.resolve()}return i({filename:r,sheet:{data:[s].concat(l),cols:s}})}processCsvValue(e=""){return`"${String(e).replace(/"/g,'""')}"`}construct(e,t){super.construct(e,t),this.zipcelx||typeof zipcelx!="undefined"&&(this.zipcelx=globalThis.zipcelx)}get exporter(){const e=this;return e._exporter||(e._exporter=e.exporterClass.new({target:e.client},e.exporterConfig))}};L._$name="ExcelExporter",G.registerFeature(L,!1,"Grid");export{S as ColorColumn,L as ExcelExporter,V as GroupSummary,_ as RowResize,R as Split,$ as TableExporter};
//# sourceMappingURL=chunk-5L4KULWT.js.map
