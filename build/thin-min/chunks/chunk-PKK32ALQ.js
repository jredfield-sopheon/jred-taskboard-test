/*!
 *
 * Bryntum TaskBoard 5.6.2
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
import{BrowserHelper as m,DomHelper as d,EventHelper as w,Widget as v,__publicField as x}from"./chunk-MZVS5JQA.js";var b=["b-horizontal","b-vertical"],f=t=>d.getStyleValue(t.parentElement,"display")==="flex"&&(parseInt(d.getStyleValue(t,"flex-basis"),10)||parseInt(d.getStyleValue(t,"flex-grow"),10)),y={horizontal:!1,vertical:!0},g=class extends v{static get configurable(){return{orientation:"auto",vertical:null,containerElement:{$config:"nullify",value:null},nextNeighbor:{$config:"nullify",value:null},previousNeighbor:{$config:"nullify",value:null}}}static get delayable(){return{syncState:"raf"}}doDestroy(){var t;(t=this.mouseDetacher)==null||t.call(this),super.doDestroy()}compose(){return{class:{"b-splitter":1},listeners:{pointerdown:"onMouseDown",mouseenter:"syncState",...!m.supportsPointerEvents&&{mousedown:"onMouseDown",touchstart:"onMouseDown"}}}}get currentOrientation(){return this.vertical?"vertical":"horizontal"}getSibling(t=!0){let{element:i}=this,e;for(;!e&&(i=i[`${t?"next":"previous"}ElementSibling`]);)(!i.isConnected||d.isVisible(i))&&(e=i);return e}get nextWidget(){let{element:t}=this,i;for(;!i&&(t=t.nextElementSibling);)i=v.fromElement(t,this.element.parentElement);return i}get previousWidget(){let{element:t}=this,i;for(;!i&&(t=t.previousElementSibling);)i=v.fromElement(t,this.element.parentElement);return i}updateContainerElement(t){var i;const e=this;e.stateDetector=(i=e.stateDetector)==null?void 0:i.disconnect(),t&&(e.stateDetector=new MutationObserver(()=>e.syncState()),e.stateDetector.observe(t,{attributes:!0,childList:!0}))}updateNextNeighbor(t){this.watchNeighbor(t,"next")}updatePreviousNeighbor(t){this.watchNeighbor(t,"previous")}watchNeighbor(t,i){this.detachListeners(i),t==null||t.ion({name:i,thisObj:this,collapse:"syncState",expand:"syncState",hide:"syncState",show:"syncState"})}updateOrientation(){this.syncState.now()}updateVertical(t){var i;const e=(i=this.element)==null?void 0:i.classList;e==null||e.add(b[t?1:0]),e==null||e.remove(b[t?0:1])}syncState(){var t;const i=this,{element:e,nextWidget:l,previousWidget:o}=i;let r=(t=y[i.orientation])!=null?t:null;if(i.nextNeighbor=l,i.previousNeighbor=o,i.disabled=l&&(l.collapsible&&l.collapsed||l.hidden)||o&&(o.collapsible&&o.collapsed||o.hidden),r!==null&&l&&o)i.containerElement=null;else if(i.containerElement=e.parentElement,i.rendered&&e.offsetParent){const a=d.getStyleValue(e.parentElement,"flex-direction");if(a)r=!a.startsWith("column");else{const u=e.previousElementSibling,c=e.nextElementSibling;if(!u||!c)return;const n=u.getBoundingClientRect(),s=c.getBoundingClientRect(),h=n.top<s.top?n:s,p=h===s?n:s;r=h.top===p.top}}i.vertical=r}onMouseDown(t){var i;t.preventDefault(),t.touches&&(t=t.touches[0]);const e=this,{element:l,nextNeighbor:o,previousNeighbor:r}=e,a=r?r.element:e.getSibling(!1),u=o?o.element:e.getSibling(),c=f(a),n=f(u),s=[];(i=e.mouseDetacher)==null||i.call(e);for(const p of l.parentElement.children)f(p)&&p!==l&&s.push({element:p,width:p.offsetWidth,height:p.offsetHeight});e.context={startX:t.pageX,startY:t.pageY,prevWidth:a.offsetWidth,prevHeight:a.offsetHeight,nextWidth:u.offsetWidth,nextHeight:u.offsetHeight,prevHasFlex:c,nextHasFlex:n,flexed:s,prev:a,next:u};const h={element:document,pointermove:"onMouseMove",pointerup:"onMouseUp",thisObj:e};m.supportsPointerEvents||(h.mousemove=h.touchmove="onMouseMove",h.mouseup=h.touchend="onMouseUp"),l.classList.add("b-moving"),e.mouseDetacher=w.on(h),e.trigger("splitterMouseDown",{event:t})}onMouseMove(t){const i=this,{context:e,nextWidget:l,previousWidget:o}=i,r=e.prev.style,a=e.next.style,u=(t.pageX-e.startX)*(i.rtl?-1:1),c=t.pageY-e.startY;if(t.preventDefault(),Object.assign(e,{deltaX:u,deltaY:c}),e.started||(e.started=!0,i.trigger("dragStart",{context:e,event:t}),e.flexed.forEach(n=>{n.element.style.flexGrow=i.vertical?n.width:n.height,n.element.style.flexBasis="0"})),i.vertical){const n=e.prevWidth+u,s=e.nextWidth-u;e.prevHasFlex?r.flexGrow=n:o?o.width=n:r.width=`${n}px`,e.nextHasFlex?a.flexGrow=s:l?l.width=s:a.width=`${s}px`}else{const n=e.prevHeight+c,s=e.nextHeight-c;e.prevHasFlex?r.flexGrow=n:o?o.height=n:r.height=`${n}px`,e.nextHasFlex?a.flexGrow=s:l?l.height=s:a.height=`${s}px`}i.trigger("drag",{context:e,event:t})}onMouseUp(t){var i;const e=this;(i=e.mouseDetacher)==null||i.call(e),e.mouseDetacher=null,e.element.classList.remove("b-moving"),e.context.started&&e.trigger("drop",{context:e.context,event:t}),e.context=null}render(){super.render(...arguments),this.syncState.now(),this.vertical===null&&this.syncState()}};x(g,"$name","Splitter"),x(g,"type","splitter"),g.initClass(),g._$name="Splitter";export{g as Splitter};
//# sourceMappingURL=chunk-PKK32ALQ.js.map
